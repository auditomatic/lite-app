import{j as xe,k as Ee,p as L,a as I,M as Ie,U as De,e as re,u as Ce,d as se}from"./index-BSSvTawe.js";import{d as ue,r as ae,f as F,c as ce,w as pe,o as Ae,n as le,V as b,W as t,k as oe,$ as Q,a2 as O,a5 as ye,X as P,u as fe,a1 as ke,a0 as Z,F as me,Y as Se,_ as p,a8 as $e,G as q,q as M,ab as Fe,ac as ie,b as Oe,a6 as _,m as Ke}from"./vue-vendor-BZxY9vkr.js";import{u as Le}from"./useV4Models-KeDZzJDo.js";import{k as G,M as ge}from"./ui-vendor-DgwC-sRC.js";import"./utils-vendor-X1Ah6TN4.js";import"./data-vendor-CllpzWXw.js";import"./useV4LiveQuery-CfOiSnL_.js";const Ne={class:"secure-api-keys-section"},Ve={class:"section-header"},Be={class:"security-overview"},_e={class:"security-status"},ze={class:"status-text"},qe={class:"security-info-bar"},Ge={key:0,class:"first-time-setup"},je={key:1,class:"security-summary"},We={class:"default-mode"},Je={class:"mode"},Ye={class:"key-counts"},He={key:0,class:"count-item encrypted"},Xe={key:1,class:"count-item session"},Ze={key:2,class:"count-item plaintext"},Qe={key:3,class:"count-item none"},et={key:0,class:"no-providers"},tt={key:1,class:"providers-table"},st={class:"provider-row"},nt={class:"provider-name"},ot={class:"provider-status"},at={class:"security-mode-cell"},lt={class:"api-key-cell"},it={class:"api-key-input-group"},rt={class:"actions-cell"},ut={class:"provider-details-row"},dt={colspan:"5",class:"provider-details"},ct={class:"detail-info"},mt={key:0},pt={key:1},yt={key:2,class:"custom-url-indicator"},vt=ue({__name:"SecureApiKeysSection",props:{onStatusMessage:{type:Function}},setup(ne){const $=xe(),o=Ee(),{modelsByProvider:n}=Le(),u=ae({}),A=ae({}),C=ae({}),x=F(!1),m=F(!1),R=F(!1),j=F(!1),d=F(!1),i=F(""),w=F(null),S=F(null),h=F(null),U=F(0),z=ce(()=>{if(U.value,!x.value)return[];const r=L.getAllGroups(),a=[];for(const v of r){if(v==="deterministic")continue;const E=L.getProvidersInGroup(v);if(E.length===0)continue;const B=E[0];if(!L.requiresApiKey(B.id))continue;const X=$.providers.get(v),g=v.charAt(0).toUpperCase()+v.slice(1),J=E.reduce((ve,he)=>{const we=n.value[he.id]||[];return ve+we.length},0),be=E.reduce((ve,he)=>{const we=n.value[he.id]||[];return ve+we.filter(Ue=>Ue.enabled).length},0);a.push({id:v,name:g,hasApiKey:!!$.getApiKey(v)||y(v),enabled:(X==null?void 0:X.enabled)??!0,endpoints:E.map(ve=>ve.id),baseUrl:X==null?void 0:X.baseUrl,totalModels:J,enabledModels:be})}return a}),k=ce(()=>o.securityStatus.value),N=ce(()=>{const r=localStorage.getItem("v3-settings");if(!r)return{};try{const a=JSON.parse(r);return o.secureStorage.detectPlaintextKeys(a)}catch{return{}}});function W(){return o.hasSetupApiKeySecurity()?!1:(j.value=!0,!0)}function K(r){return o.getEffectiveProviderMode(r)}function y(r){return o.hasApiKey(r)}function T(r){return K(r)==="encrypted"?o.hasApiKey(r)&&!o.isUnlocked.value:!1}function D(r){const a=y(r),v=T(r);return v&&a?"Click to unlock and view encrypted key":v&&!a?"Click to unlock and enter API key":a?"Key configured (hidden)":"Enter API key"}function V(){const{lockedProviderCount:r,sessionProviderCount:a,plaintextProviderCount:v}=k.value,E=r+a+v;return E===0?"none":v===E?"low":r>0?"high":"medium"}function Y(){switch(V()){case"high":return"🔒";case"medium":return"⚠️";case"low":return"📝";default:return"❓"}}function ee(){const{lockedProviderCount:r,sessionProviderCount:a,plaintextProviderCount:v}=k.value;if(r+a+v===0)return"No API keys configured";const B=[];return r>0&&B.push(`${r} encrypted`),a>0&&B.push(`${a} session-only`),v>0&&B.push(`${v} plaintext`),B.join(", ")}function l(r){switch(r){case"encrypted":return"🔒";case"session":return"⚠️";case"plaintext":return"📝";default:return"📝"}}function e(r){switch(r){case"encrypted":return"Encrypted";case"session":return"Session Only";case"plaintext":return"Unencrypted";default:return"Unencrypted"}}function s(r){C[r]=!C[r]}function c(r){T(r)&&(d.value=!0)}async function f(r,a){if(a==="encrypted"&&!o.hasMasterPassword.value){j.value=!0;return}R.value=!0;try{const v=await o.setProviderSecurityMode(r,a);if(!v.success){G.error(`Failed to change security mode: ${v.error}`);return}u[r]="",A[r]="",G.success(`Security mode changed to ${a}`),U.value++,await le()}catch(v){const E=v instanceof Error?v.message:"Unknown error";G.error(`Failed to change security mode: ${E}`)}finally{R.value=!1}}async function H(r){const a=A[r];if(!a||W())return;const v=K(r);if(v==="encrypted"&&!o.isUnlocked.value){d.value=!0,S.value=r,h.value=a;return}m.value=!0;try{const E=await o.setApiKey(r,a,v);E.success?(G.success("API key saved successfully"),A[r]="",U.value++,await le()):G.error(`Failed to save API key: ${E.error}`)}catch(E){const B=E instanceof Error?E.message:"Unknown error";G.error(`Failed to save API key: ${B}`)}finally{m.value=!1}}async function te(r){const a=u[r];if(a){m.value=!0;try{$.setApiKey(r,a),o.updateKeyCounts(),G.success("API key saved successfully"),u[r]="",U.value++,await le()}finally{m.value=!1}}}async function de(r){try{await o.clearApiKey(r),$.setApiKey(r,""),o.updateKeyCounts(),u[r]="",A[r]="",G.success("API key cleared"),U.value++,await le()}catch(a){const v=a instanceof Error?a.message:"Unknown error";G.error(`Failed to clear API key: ${v}`)}}function Pe(){o.lock(),G.info("All encrypted keys have been locked")}async function Me(r){var a,v,E;try{const B=await o.unlock(r.password,r.rememberSession);if(B.success){if(d.value=!1,(a=w.value)==null||a.handleUnlockSuccess(),G.success("API keys unlocked successfully"),S.value&&h.value){const X=S.value,g=h.value;S.value=null,h.value=null,m.value=!0;try{const J=K(X),be=await o.setApiKey(X,g,J);be.success?(G.success("API key saved successfully"),A[X]="",U.value++,await le()):G.error(`Failed to save API key: ${be.error}`)}finally{m.value=!1}}}else(v=w.value)==null||v.handleUnlockFailure(B.error||"Invalid password")}catch(B){const X=B instanceof Error?B.message:"Unknown error";(E=w.value)==null||E.handleUnlockFailure(X)}}function Te(){ge.confirm({title:"Reset Auditomatic Local Store Password",content:"This will delete all encrypted API keys. You will need to re-enter them. Continue?",okText:"Yes, Reset",okType:"danger",onOk:async()=>{try{localStorage.removeItem("v3-security"),window.location.reload()}catch{G.error("Failed to reset password")}}})}async function Re(r){if(I.info("Security setup completed, updating UI:",r),j.value=!1,U.value++,await le(),S.value&&h.value){const a=S.value,v=h.value;S.value=null,h.value=null,m.value=!0;try{const E=K(a),B=await o.setApiKey(a,v,E);B.success?(G.success("API key saved successfully"),A[a]=""):G.error(`Failed to save API key: ${B.error}`)}finally{m.value=!1}}await le()}return pe(()=>z.value,r=>{r.forEach(a=>{a.id in u||(u[a.id]=""),a.id in A||(A[a.id]=""),a.id in C||(C[a.id]=!1)})},{immediate:!0}),Ae(async()=>{await L.waitForReady(),x.value=!0;const r=o.addEventListener(v=>{I.info("Security event received:",v),(v.type==="api_key_added"||v.type==="api_key_removed")&&U.value++}),a=N.value;return Object.keys(a).length>0&&!o.hasMasterPassword.value&&le(()=>{G.info({content:`${Object.keys(a).length} API keys found in insecure storage. Consider setting up encryption for better security.`,duration:10})}),()=>{r()}}),(r,a)=>{const v=ke("a-button"),E=ke("a-select-option"),B=ke("a-select"),X=ke("a-input-password");return p(),b("div",Ne,[t("div",Ve,[a[6]||(a[6]=t("h2",null,"API Keys",-1)),t("div",Be,[t("div",_e,[t("span",{class:ye(["security-indicator",V()])},P(Y()),3),t("span",ze,P(ee()),1)]),fe(o).isUnlocked.value?(p(),Q(v,{key:0,size:"small",onClick:Pe},{default:Z(()=>a[5]||(a[5]=[q(" Lock All ")])),_:1,__:[5]})):O("",!0)])]),t("div",qe,[fe(o).hasSetupApiKeySecurity()?(p(),b("div",je,[t("div",We,[a[10]||(a[10]=t("span",{class:"label"},"New keys will be stored as:",-1)),t("span",Je,P(l(fe(o).getDefaultSecurityMode()))+" "+P(e(fe(o).getDefaultSecurityMode())),1),oe(v,{size:"small",onClick:a[1]||(a[1]=g=>j.value=!0)},{default:Z(()=>a[9]||(a[9]=[q("Change")])),_:1,__:[9]})]),a[12]||(a[12]=t("div",{class:"divider"},"|",-1)),t("div",Ye,[a[11]||(a[11]=t("span",{class:"label"},"Currently stored:",-1)),k.value.lockedProviderCount>0?(p(),b("span",He," 🔒 "+P(k.value.lockedProviderCount)+" encrypted "+P(k.value.lockedProviderCount===1?"key":"keys"),1)):O("",!0),k.value.sessionProviderCount>0?(p(),b("span",Xe," ⚠️ "+P(k.value.sessionProviderCount)+" session-only "+P(k.value.sessionProviderCount===1?"key":"keys"),1)):O("",!0),k.value.plaintextProviderCount>0?(p(),b("span",Ze," 📝 "+P(k.value.plaintextProviderCount)+" unencrypted "+P(k.value.plaintextProviderCount===1?"key":"keys"),1)):O("",!0),k.value.lockedProviderCount+k.value.sessionProviderCount+k.value.plaintextProviderCount===0?(p(),b("span",Qe," No API keys stored yet ")):O("",!0)]),!fe(o).isUnlocked.value&&k.value.lockedProviderCount>0?(p(),Q(v,{key:0,type:"primary",size:"small",onClick:a[2]||(a[2]=g=>d.value=!0)},{default:Z(()=>[q(" Unlock "+P(k.value.lockedProviderCount)+" key"+P(k.value.lockedProviderCount===1?"":"s"),1)]),_:1})):O("",!0)])):(p(),b("div",Ge,[a[8]||(a[8]=t("span",null,"🔧 First time? Set up your default security mode:",-1)),oe(v,{type:"primary",size:"small",onClick:a[0]||(a[0]=g=>j.value=!0)},{default:Z(()=>a[7]||(a[7]=[q("Setup Security")])),_:1,__:[7]})]))]),z.value.length===0?(p(),b("div",et,a[13]||(a[13]=[t("p",null,"No providers requiring API keys are currently configured.",-1)]))):(p(),b("table",tt,[a[20]||(a[20]=t("thead",null,[t("tr",null,[t("th",null,"Provider"),t("th",null,"Status"),t("th",null,"Security"),t("th",null,"API Key"),t("th",null,"Actions")])],-1)),t("tbody",null,[(p(!0),b(me,null,Se(z.value,g=>(p(),b(me,{key:g.id},[t("tr",st,[t("td",nt,[t("strong",null,P(g.name),1)]),t("td",ot,[t("span",{class:ye(["status-badge",{configured:g.hasApiKey}])},P(g.hasApiKey?"✓ Configured":"⚠️ Not set"),3)]),t("td",at,[oe(B,{value:K(g.id),onChange:J=>f(g.id,J),class:"security-mode-select-compact",disabled:R.value,size:"small"},{default:Z(()=>[oe(E,{value:"encrypted"},{default:Z(()=>a[14]||(a[14]=[q(" 🔒 Encrypted ")])),_:1,__:[14]}),oe(E,{value:"session"},{default:Z(()=>a[15]||(a[15]=[q(" ⚠️ Session ")])),_:1,__:[15]}),oe(E,{value:"plaintext"},{default:Z(()=>a[16]||(a[16]=[q(" 📝 Unencrypted ")])),_:1,__:[16]})]),_:2},1032,["value","onChange","disabled"])]),t("td",lt,[t("div",it,[K(g.id)!=="plaintext"?(p(),Q(X,{key:0,value:A[g.id],"onUpdate:value":J=>A[g.id]=J,type:C[g.id]?"text":"password",placeholder:D(g.id),class:"api-key-input-compact",size:"small",onFocus:J=>c(g.id),onKeyup:$e(J=>H(g.id),["enter"])},null,8,["value","onUpdate:value","type","placeholder","onFocus","onKeyup"])):(p(),Q(X,{key:1,value:u[g.id],"onUpdate:value":J=>u[g.id]=J,type:C[g.id]?"text":"password",placeholder:g.hasApiKey?"Key configured":"Enter API key",class:"api-key-input-compact",size:"small",onKeyup:$e(J=>te(g.id),["enter"])},null,8,["value","onUpdate:value","type","placeholder","onKeyup"])),oe(v,{onClick:J=>s(g.id),size:"small",disabled:T(g.id)},{default:Z(()=>[q(P(C[g.id]?"🙈":"👁️"),1)]),_:2},1032,["onClick","disabled"])])]),t("td",rt,[K(g.id)!=="plaintext"?(p(),Q(v,{key:0,onClick:J=>H(g.id),disabled:!A[g.id]||m.value,loading:m.value,type:"primary",size:"small"},{default:Z(()=>a[17]||(a[17]=[q(" Save ")])),_:2,__:[17]},1032,["onClick","disabled","loading"])):(p(),Q(v,{key:1,onClick:J=>te(g.id),disabled:!u[g.id]||m.value,loading:m.value,type:"primary",size:"small"},{default:Z(()=>a[18]||(a[18]=[q(" Save ")])),_:2,__:[18]},1032,["onClick","disabled","loading"])),g.hasApiKey||y(g.id)?(p(),Q(v,{key:2,onClick:J=>de(g.id),disabled:m.value,size:"small"},{default:Z(()=>a[19]||(a[19]=[q(" Clear ")])),_:2,__:[19]},1032,["onClick","disabled"])):O("",!0)])]),t("tr",ut,[t("td",dt,[t("span",ct,[q(P(g.endpoints.length)+" endpoint"+P(g.endpoints.length===1?"":"s")+" · ",1),g.hasApiKey?(p(),b("span",mt,P(g.enabledModels)+"/"+P(g.totalModels)+" models enabled ",1)):(p(),b("span",pt,P(g.totalModels)+" models available ",1)),g.baseUrl?(p(),b("span",yt," · Custom URL configured")):O("",!0)])])])],64))),128))])])),oe(Ie,{open:j.value,"migration-keys":N.value,onClose:a[3]||(a[3]=g=>j.value=!1),onSuccess:Re},null,8,["open","migration-keys"]),oe(De,{open:d.value,"locked-provider-count":k.value.lockedProviderCount,"password-hint":i.value,ref_key:"unlockModalRef",ref:w,onUnlock:Me,onReset:Te,onClose:a[4]||(a[4]=g=>d.value=!1)},null,8,["open","locked-provider-count","password-hint"])])}}}),ft=re(vt,[["__scopeId","data-v-d232a39b"]]),gt={class:"preferences-section"},bt={class:"preferences-content"},kt={class:"preference-item"},St={class:"preference-item environmental-costs"},ht={class:"environmental-options"},wt={class:"checkbox-item mandatory"},xt={class:"checkbox-label disabled"},Ct=["checked"],$t={class:"checkbox-item"},At={class:"checkbox-label"},Pt={class:"checkbox-item"},Mt={class:"checkbox-label"},Tt=ue({__name:"PreferencesSection",props:{onStatusMessage:{type:Function}},setup(ne){const $=Ce(),o=xe(),n=ne,u=ae({theme:"system",showCO2:!0,showWater:!0,showElectricity:!0});pe(()=>$.settings.core.preferences.value,x=>{u.theme=x.theme},{immediate:!0}),pe(()=>o.preferences,x=>{u.showCO2=x.showCO2,u.showWater=x.showWater,u.showElectricity=x.showElectricity},{immediate:!0,deep:!0});async function A(){var m,R;const x=await $.settings.core.setTheme(u.theme);x.ok?(m=n.onStatusMessage)==null||m.call(n,"Theme updated","success"):(R=n.onStatusMessage)==null||R.call(n,`Failed to update theme: ${x.error.message}`,"error")}async function C(){var x,m;try{o.setEnvironmentalDisplaySettings({showCO2:u.showCO2,showWater:u.showWater,showElectricity:u.showElectricity}),(x=n.onStatusMessage)==null||x.call(n,"Environmental display settings updated","success")}catch(R){(m=n.onStatusMessage)==null||m.call(n,`Failed to update settings: ${R}`,"error")}}return(x,m)=>(p(),b("div",gt,[m[11]||(m[11]=t("h2",null,"Preferences",-1)),m[12]||(m[12]=t("p",{class:"tab-description"},"Configure application behavior and appearance.",-1)),t("div",bt,[t("div",kt,[m[4]||(m[4]=t("label",{for:"theme-select"},"Theme:",-1)),M(t("select",{id:"theme-select","onUpdate:modelValue":m[0]||(m[0]=R=>u.theme=R),onChange:A,class:"preference-select"},m[3]||(m[3]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)]),544),[[Fe,u.theme]])]),t("div",St,[m[10]||(m[10]=t("label",null,"Environmental Cost Display:",-1)),t("div",ht,[t("div",wt,[t("label",xt,[t("input",{type:"checkbox",checked:u.showCO2,disabled:"",class:"preference-checkbox"},null,8,Ct),m[5]||(m[5]=t("span",null,"CO₂ Emissions",-1)),m[6]||(m[6]=t("span",{class:"mandatory-badge"},"Always shown",-1))]),m[7]||(m[7]=t("span",{class:"help-text"},"CO₂ tracking cannot be disabled to maintain awareness of climate impact.",-1))]),t("div",$t,[t("label",At,[M(t("input",{type:"checkbox","onUpdate:modelValue":m[1]||(m[1]=R=>u.showWater=R),onChange:C,class:"preference-checkbox"},null,544),[[ie,u.showWater]]),m[8]||(m[8]=t("span",null,"💧 Water Usage",-1))])]),t("div",Pt,[t("label",Mt,[M(t("input",{type:"checkbox","onUpdate:modelValue":m[2]||(m[2]=R=>u.showElectricity=R),onChange:C,class:"preference-checkbox"},null,544),[[ie,u.showElectricity]]),m[9]||(m[9]=t("span",null,"⚡ Electricity Consumption",-1))])])])])])]))}}),Rt=re(Tt,[["__scopeId","data-v-0dac0274"]]),Ut={class:"performance-recorder"},Et={class:"recorder-controls"},It=["disabled"],Dt=["disabled"],Ft=["disabled"],Ot={class:"recorder-status"},Kt={key:0,class:"status recording"},Lt={key:1,class:"status ready"},Nt={key:2,class:"status idle"},Vt={key:0,class:"export-result"},Bt=ue({__name:"PerformanceRecorder",setup(ne){const $=F(!1),o=F(!1),n=F([]),u=F(""),A=F(0),C=F(0),x=ce(()=>n.value.length>0);let m=null,R=null,j=null;function d(){$.value?w():i()}function i(){if($.value=!0,A.value=Date.now(),C.value=0,n.value=[],m=window.setInterval(S,100),R=window.setInterval(()=>{C.value=Math.floor((Date.now()-A.value)/1e3)},1e3),"PerformanceObserver"in window)try{j=new PerformanceObserver(y=>{const T=y.getEntries(),D={};if(T.forEach(V=>{V.entryType==="paint"&&(D[V.name.replace("-","")]=V.startTime),V.entryType==="largest-contentful-paint"&&(D.largestContentfulPaint=V.startTime)}),n.value.length>0){const V=n.value[n.value.length-1];V.paint={...V.paint,...D}}}),j.observe({entryTypes:["paint","largest-contentful-paint"]})}catch{I.warn("Performance Observer not fully supported")}I.info("🔴 Performance recording started")}function w(){$.value=!1,m&&(clearInterval(m),m=null),R&&(clearInterval(R),R=null),j&&(j.disconnect(),j=null),I.info(`🟡 Performance recording stopped. Collected ${n.value.length} samples`)}function S(){try{const y={timestamp:Date.now(),timing:h(),network:U(),userAgent:navigator.userAgent,url:window.location.href,customMetrics:z()};if("memory"in performance){const T=performance.memory;y.memory={used:T.usedJSHeapSize,total:T.totalJSHeapSize,limit:T.jsHeapSizeLimit}}n.value.push(y)}catch(y){I.warn("Failed to collect performance sample:",y)}}function h(){const y=performance.getEntriesByType("navigation")[0];return y?{navigation:y.loadEventEnd-y.fetchStart,domContentLoaded:y.domContentLoadedEventEnd-y.fetchStart,loadComplete:y.loadEventEnd-y.fetchStart}:{navigation:performance.now(),domContentLoaded:0,loadComplete:0}}function U(){const y=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return y?{downlink:y.downlink,effectiveType:y.effectiveType,rtt:y.rtt}:{}}function z(){const y={};y.domNodes=document.querySelectorAll("*").length,y.scripts=document.querySelectorAll("script").length,y.stylesheets=document.querySelectorAll('link[rel="stylesheet"]').length,window.__VUE__&&(y.vueVersion=window.__VUE__.version),window.React&&(y.reactVersion=window.React.version);const T=Array.from(document.querySelectorAll("script[src]"));return y.scriptSources=T.length,y}function k(){const y=[];if(n.value.length===0)return y;const T=n.value,D=T[T.length-1];if(D.memory){const V=D.memory.used/1048576,Y=D.memory.limit/(1024*1024),ee=V/Y*100;ee>80?y.push({type:"memory",severity:"critical",description:`Memory usage is ${ee.toFixed(1)}% of limit`,value:V,recommendation:"Clear caches, reduce data in memory, check for memory leaks"}):ee>60&&y.push({type:"memory",severity:"high",description:`Memory usage is ${ee.toFixed(1)}% of limit`,value:V,recommendation:"Monitor memory usage, consider data pagination"})}return D.timing.navigation>3e3&&y.push({type:"timing",severity:"high",description:"Slow page load time",value:D.timing.navigation,recommendation:"Optimize bundle size, lazy load components, check network"}),D.network.rtt&&D.network.rtt>200&&y.push({type:"network",severity:"medium",description:"High network latency",value:D.network.rtt,recommendation:"Check network connection, consider CDN, reduce API calls"}),y}function N(){var y,T;o.value=!0;try{const D=k(),V={recordingInfo:{startTime:new Date(A.value).toISOString(),duration:C.value,sampleCount:n.value.length,url:window.location.href,userAgent:navigator.userAgent},performanceSummary:{avgMemoryUsage:n.value.filter(Y=>Y.memory).reduce((Y,ee)=>Y+ee.memory.used/(1024*1024),0)/n.value.filter(Y=>Y.memory).length,totalDOMNodes:(y=n.value[n.value.length-1])==null?void 0:y.customMetrics.domNodes,networkInfo:(T=n.value[n.value.length-1])==null?void 0:T.network},issues:D,topBottlenecks:D.sort((Y,ee)=>W(ee.severity)-W(Y.severity)).slice(0,5),detailedSamples:n.value.slice(-10),recommendations:[...new Set(D.map(Y=>Y.recommendation))]};u.value=JSON.stringify(V,null,2),I.info("📊 Performance data exported")}catch(D){I.error("Failed to export performance data:",D),u.value=`Export Error: ${D}`}finally{o.value=!1}}function W(y){return{critical:4,high:3,medium:2,low:1}[y]||0}function K(){n.value=[],u.value="",C.value=0,I.info("🗑️ Performance data cleared")}return Oe(()=>{$.value&&w()}),(y,T)=>(p(),b("div",Ut,[t("div",Et,[t("button",{onClick:d,class:ye(["record-btn",{recording:$.value}]),disabled:o.value},P($.value?"Stop Recording":"Start Recording"),11,It),t("button",{onClick:N,disabled:!x.value||o.value,class:"export-btn"},P(o.value?"Exporting...":"Export Logs"),9,Dt),t("button",{onClick:K,disabled:!x.value||$.value,class:"clear-btn"}," Clear ",8,Ft)]),t("div",Ot,[$.value?(p(),b("div",Kt," 🔴 Recording... ("+P(C.value)+"s) ",1)):x.value?(p(),b("div",Lt," ✅ "+P(n.value.length)+" samples recorded ",1)):(p(),b("div",Nt," ⏸️ Ready to record "))]),u.value?(p(),b("div",Vt,[T[1]||(T[1]=t("h3",null,"Performance Data Ready",-1)),M(t("textarea",{"onUpdate:modelValue":T[0]||(T[0]=D=>u.value=D),readonly:"",rows:"10",placeholder:"Exported performance data will appear here..."},null,512),[[_,u.value]]),T[2]||(T[2]=t("div",{class:"copy-instructions"}," Copy this data and paste it to Claude for analysis ",-1))])):O("",!0)]))}}),_t=re(Bt,[["__scopeId","data-v-48cb70ff"]]),zt={class:"advanced-section"},qt={key:0},Gt={key:1},jt={class:"sub-tabs"},Wt=["onClick"],Jt={class:"sub-tab-content"},Yt={key:0,class:"provider-settings"},Ht={key:0,class:"no-providers"},Xt={key:0},Zt={key:1},Qt={key:1,class:"provider-cards"},es={key:0,class:"provider-advanced-card"},ts={class:"setting-group"},ss=["onUpdate:modelValue","onChange"],ns={class:"setting-group"},os=["onUpdate:modelValue","onChange"],as={class:"setting-group"},ls=["onUpdate:modelValue","onChange"],is={class:"setting-group"},rs=["onUpdate:modelValue","onChange"],us={class:"setting-group"},ds=["onUpdate:modelValue","onChange"],cs={key:1,class:"execution-settings"},ms={class:"settings-grid"},ps={class:"setting-group"},ys={class:"setting-group"},vs={class:"setting-group"},fs={class:"setting-group"},gs={class:"setting-group"},bs={class:"setting-group"},ks={class:"setting-group"},Ss={key:2,class:"discovery-settings"},hs={class:"settings-grid"},ws={class:"setting-group"},xs={class:"setting-group"},Cs={class:"setting-group"},$s={class:"setting-group"},As={key:3,class:"coordination-settings"},Ps={class:"settings-grid"},Ms={class:"setting-group"},Ts={class:"setting-group"},Rs={class:"setting-group"},Us={class:"setting-group"},Es={key:4,class:"performance-settings"},Is={class:"settings-grid"},Ds={class:"setting-group"},Fs={class:"setting-group"},Os={class:"setting-group"},Ks={class:"setting-group"},Ls={key:5,class:"system-settings"},Ns=ue({__name:"AdvancedSection",props:{onStatusMessage:{type:Function}},setup(ne){const $=Ce(),o=xe(),n=ne;function u(l,e){n.onStatusMessage&&n.onStatusMessage(l,e)}const A=[{id:"providers",label:"Provider Settings"},{id:"execution",label:"Execution"},{id:"discovery",label:"Discovery"},{id:"coordination",label:"Multi-Tab"},{id:"performance",label:"Performance"},{id:"system",label:"System"}],C=F("providers"),x=F(!1),m=ce(()=>{const l=R.value;return l.length>0&&l.every(e=>d[e.id]&&typeof d[e.id].concurrency=="number")}),R=ce(()=>{try{const l=L.getAllGroups();I.info("Available group IDs from registry:",l);const e=l.map(s=>{const c=L.getProvidersInGroup(s),f=c.some(H=>L.requiresApiKey(H.id));return{id:s,name:s.charAt(0).toUpperCase()+s.slice(1),requiresApiKey:f,endpoints:c.map(H=>({id:H.id,name:H.name}))}});return I.info("Computed availableProviders:",e),e}catch(l){return I.error("Failed to get available provider groups:",l),[]}}),d=ae((()=>{try{const l=L.getAllGroups();I.info("Initializing provider settings for groups:",l);const e={};return l.forEach(s=>{e[s]={concurrency:2,requestTimeout:30,maxRetries:3,backoffMultiplier:2}}),I.info("Initial provider settings:",e),e}catch(l){return I.error("Failed to initialize provider settings:",l),{}}})());pe(R,async l=>{await L.waitForReady(),I.info("Initializing settings for",l.length,"provider groups"),l.forEach(e=>{if(!d[e.id]){const s=L.getProvidersInGroup(e.id),c=s[0],f=(c==null?void 0:c.execution)||{};I.info(`Initializing settings for provider group ${e.id}:`,{endpoints:s.map(H=>H.id),execution:f}),d[e.id]={baseUrl:o.getProviderBaseUrl(e.id)||"",concurrency:f.defaultConcurrency||2,requestTimeout:Math.floor((f.timeout||3e4)/1e3),maxRetries:f.maxRetries||3,backoffMultiplier:f.backoffMultiplier||2}}})},{immediate:!0});const i=ae({defaultConcurrency:1,defaultTimeout:120,defaultMaxRetries:3,defaultTemperature:.7,batchSize:1,maxConcurrentBatches:2,progressBufferMs:0}),w=ae({autoDiscoverOnStartup:!0,discoveryInterval:24,discoveryTimeout:60,skipFailedProviders:!1}),S=ae({leaderElectionTimeout:1e3,syncInterval:500,enableBroadcastChannel:!0,enableWebLocks:!0}),h=ae({virtualScrollThreshold:1e3,debounceDelay:300,enableRequestIdleCallback:!0,enableProgressiveRendering:!0});Ae(async()=>{try{await L.waitForReady();const l=await $.settings.system.getAllSettings(),e=L.getAllGroups();I.info("Loading existing settings from provider registry for",e.length,"provider groups"),e.forEach(s=>{const c=L.getProviderExecutionOverrides(s);if(I.info(`Loading registry overrides for group ${s}:`,c),c&&d[s])c.concurrency!==void 0&&(d[s].concurrency=c.concurrency),c.timeout!==void 0&&(d[s].requestTimeout=Math.floor(c.timeout/1e3)),c.maxRetries!==void 0&&(d[s].maxRetries=c.maxRetries),c.backoffMultiplier!==void 0&&(d[s].backoffMultiplier=c.backoffMultiplier);else if(d[s]){const H=L.getProvidersInGroup(s)[0],te=(H==null?void 0:H.execution)||{};I.info(`No overrides for group ${s}, using provider defaults:`,te),d[s].concurrency=te.defaultConcurrency||2,d[s].requestTimeout=Math.floor((te.timeout||3e4)/1e3),d[s].maxRetries=te.maxRetries||3,d[s].backoffMultiplier=te.backoffMultiplier||2}}),l.execution&&Object.assign(i,l.execution),l.discovery&&Object.assign(w,l.discovery),l.coordination&&Object.assign(S,l.coordination),l.performance&&Object.assign(h,l.performance),x.value=!0}catch(l){I.error("Failed to initialize advanced settings:",l),x.value=!0}});async function U(l,e){try{const s=e==null?void 0:e.trim();if(s)try{new URL(s),o.setProviderBaseUrl(l,s),u("Custom API endpoint saved","success")}catch{u("Invalid URL format. Please enter a valid URL starting with http:// or https://","error"),d[l].baseUrl=o.getProviderBaseUrl(l)||""}else o.setProviderBaseUrl(l,""),u("Custom API endpoint cleared","success")}catch{u("Failed to update custom endpoint","error")}}async function z(l,e,s){var c,f;try{switch(await L.waitForReady(),e){case"concurrency":L.setProviderConcurrency(l,s);break;case"requestTimeout":L.setProviderTimeout(l,s*1e3);break;case"maxRetries":L.setProviderMaxRetries(l,s);break;case"backoffMultiplier":L.setProviderBackoffMultiplier(l,s);break;default:throw new Error(`Unknown setting: ${e}`)}(c=n.onStatusMessage)==null||c.call(n,`Updated ${e} for ${l}`,"success")}catch(H){(f=n.onStatusMessage)==null||f.call(n,`Failed to update ${e}: ${H.message}`,"error");const te=L.getProvider(l),de=(te==null?void 0:te.execution)||{};switch(e){case"concurrency":d[l].concurrency=de.defaultConcurrency||2;break;case"requestTimeout":d[l].requestTimeout=Math.floor((de.timeout||3e4)/1e3);break;case"maxRetries":d[l].maxRetries=de.maxRetries||3;break;case"backoffMultiplier":d[l].backoffMultiplier=de.backoffMultiplier||2;break}}}async function k(l,e){var c,f;const s=await $.settings.system.setExecutionSetting(l,e);s.ok?(c=n.onStatusMessage)==null||c.call(n,`Updated ${l}`,"success"):(f=n.onStatusMessage)==null||f.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}async function N(l,e){var c,f;const s=await $.settings.system.setDiscoverySetting(l,e);s.ok?(c=n.onStatusMessage)==null||c.call(n,`Updated ${l}`,"success"):(f=n.onStatusMessage)==null||f.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}async function W(l,e){var c,f;const s=await $.settings.system.setCoordinationSetting(l,e);s.ok?(c=n.onStatusMessage)==null||c.call(n,`Updated ${l}`,"success"):(f=n.onStatusMessage)==null||f.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}async function K(l,e){var c,f;const s=await $.settings.system.setPerformanceSetting(l,e);s.ok?(c=n.onStatusMessage)==null||c.call(n,`Updated ${l}`,"success"):(f=n.onStatusMessage)==null||f.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}function y(){ge.confirm({title:"DELETE ALL DATA WARNING",content:`This will delete ALL data including:

• All trials and their results
• All API calls and responses
• All models and configurations
• All variable lists and datasets
• All settings and preferences

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Delete All Data",cancelText:"Cancel",okType:"danger",onOk(){ge.confirm({title:"FINAL WARNING",content:`You are about to delete EVERYTHING.

Click "Proceed" to confirm database deletion.`,okText:"Proceed with Deletion",cancelText:"Cancel",okType:"danger",onOk(){T()}})}})}async function T(){var l,e;try{await se.transaction("rw",se.tables,async()=>{await Promise.all(se.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),(l=n.onStatusMessage)==null||l.call(n,"Database and storage cleared successfully","success"),setTimeout(()=>{window.location.reload()},1500)}catch(s){I.error("Failed to clear database:",s),(e=n.onStatusMessage)==null||e.call(n,`Failed to clear database: ${s}`,"error")}}function D(){ge.confirm({title:"FACTORY RESET WARNING",content:`This will completely reset the application to a fresh state.

This will clear:
• All database data (trials, models, settings, API calls)
• All localStorage data
• All sessionStorage data
• All cookies for this domain
• All cached data and preferences
• All API keys and security settings

The app will be restored to first-run state.

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Reset Everything",cancelText:"Cancel",okType:"danger",onOk(){ge.confirm({title:"FINAL FACTORY RESET WARNING",content:`You will lose EVERYTHING.

All data, settings, API keys, and preferences will be permanently deleted.

Click "Proceed" to confirm factory reset.`,okText:"Proceed with Reset",cancelText:"Cancel",okType:"danger",onOk(){V()}})}})}async function V(){var l,e;try{if(await se.transaction("rw",se.tables,async()=>{await Promise.all(se.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),Y(),await ee(),"caches"in window){const s=await caches.keys();await Promise.all(s.map(c=>caches.delete(c)))}(l=n.onStatusMessage)==null||l.call(n,"Factory reset completed - all data cleared","success"),setTimeout(()=>{window.location.reload()},2e3)}catch(s){I.error("Failed to perform factory reset:",s),(e=n.onStatusMessage)==null||e.call(n,`Factory reset failed: ${s}`,"error")}}function Y(){const l=document.cookie.split(";");for(let e of l){const s=e.indexOf("="),c=s>-1?e.substr(0,s).trim():e.trim();document.cookie=`${c}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${c}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;`;const f=window.location.hostname;document.cookie=`${c}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${f}`,document.cookie=`${c}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${f}`}}async function ee(){if("indexedDB"in window&&indexedDB.databases)try{const l=await indexedDB.databases();await Promise.all(l.map(e=>{if(e.name)return new Promise((s,c)=>{const f=indexedDB.deleteDatabase(e.name);f.onsuccess=()=>s(),f.onerror=()=>c(f.error)})}))}catch(l){I.warn("Could not clear all IndexedDB databases:",l)}}return(l,e)=>(p(),b("div",zt,[x.value?(p(),b("div",Gt,[e[99]||(e[99]=t("h2",null,"Advanced Settings",-1)),e[100]||(e[100]=t("p",{class:"tab-description"},"Configure advanced settings for providers, execution, and system performance.",-1)),t("div",jt,[(p(),b(me,null,Se(A,s=>t("button",{key:s.id,class:ye(["sub-tab",{active:C.value===s.id}]),onClick:c=>C.value=s.id},P(s.label),11,Wt)),64))]),t("div",Jt,[C.value==="providers"?(p(),b("div",Yt,[e[50]||(e[50]=t("h3",null,"Provider-Specific Settings",-1)),e[51]||(e[51]=t("p",{class:"section-description"},"Configure advanced settings for each provider",-1)),m.value?(p(),b("div",Qt,[(p(!0),b(me,null,Se(R.value,s=>(p(),b(me,{key:s.id},[s&&d[s.id]?(p(),b("div",es,[t("h4",null,P(s.name)+" Group",1),e[49]||(e[49]=t("p",{class:"group-description"},"Settings apply to all endpoints in this provider group",-1)),t("div",ts,[e[39]||(e[39]=t("label",null,"Custom API Endpoint",-1)),M(t("input",{type:"text","onUpdate:modelValue":c=>d[s.id].baseUrl=c,placeholder:"Use default API endpoint",onChange:c=>{var f;return U(s.id,(f=d[s.id])==null?void 0:f.baseUrl)}},null,40,ss),[[_,d[s.id].baseUrl]]),e[40]||(e[40]=t("span",{class:"hint"},"Override default API endpoint URL (optional)",-1))]),t("div",ns,[e[41]||(e[41]=t("label",null,"Concurrency Limit",-1)),M(t("input",{type:"number","onUpdate:modelValue":c=>d[s.id].concurrency=c,min:"1",max:"100",onChange:c=>{var f;return z(s.id,"concurrency",(f=d[s.id])==null?void 0:f.concurrency)}},null,40,os),[[_,d[s.id].concurrency,void 0,{number:!0}]]),e[42]||(e[42]=t("span",{class:"hint"},"Max parallel requests (1-100)",-1))]),t("div",as,[e[43]||(e[43]=t("label",null,"Request Timeout (seconds)",-1)),M(t("input",{type:"number","onUpdate:modelValue":c=>d[s.id].requestTimeout=c,min:"10",max:"600",onChange:c=>{var f;return z(s.id,"requestTimeout",(f=d[s.id])==null?void 0:f.requestTimeout)}},null,40,ls),[[_,d[s.id].requestTimeout,void 0,{number:!0}]]),e[44]||(e[44]=t("span",{class:"hint"},"Time before request fails (10-600s)",-1))]),t("div",is,[e[45]||(e[45]=t("label",null,"Max Retries",-1)),M(t("input",{type:"number","onUpdate:modelValue":c=>d[s.id].maxRetries=c,min:"0",max:"10",onChange:c=>{var f;return z(s.id,"maxRetries",(f=d[s.id])==null?void 0:f.maxRetries)}},null,40,rs),[[_,d[s.id].maxRetries,void 0,{number:!0}]]),e[46]||(e[46]=t("span",{class:"hint"},"Retry attempts on failure (0-10)",-1))]),t("div",us,[e[47]||(e[47]=t("label",null,"Backoff Multiplier",-1)),M(t("input",{type:"number","onUpdate:modelValue":c=>d[s.id].backoffMultiplier=c,min:"1",max:"5",step:"0.1",onChange:c=>{var f;return z(s.id,"backoffMultiplier",(f=d[s.id])==null?void 0:f.backoffMultiplier)}},null,40,ds),[[_,d[s.id].backoffMultiplier,void 0,{number:!0}]]),e[48]||(e[48]=t("span",{class:"hint"},"Exponential backoff factor (1-5)",-1))])])):O("",!0)],64))),128))])):(p(),b("div",Ht,[R.value.length===0?(p(),b("p",Xt,"No providers are currently configured. Add API keys in the API Keys tab first.")):(p(),b("p",Zt,"Loading provider settings..."))]))])):O("",!0),C.value==="execution"?(p(),b("div",cs,[e[66]||(e[66]=t("h3",null,"Execution Settings",-1)),e[67]||(e[67]=t("p",{class:"section-description"},"Configure how trials are executed",-1)),t("div",ms,[t("div",ps,[e[52]||(e[52]=t("label",null,"Default Trial Concurrency",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>i.defaultConcurrency=s),min:"1",max:"20",onChange:e[1]||(e[1]=s=>k("defaultConcurrency",i.defaultConcurrency))},null,544),[[_,i.defaultConcurrency,void 0,{number:!0}]]),e[53]||(e[53]=t("span",{class:"hint"},"Default parallel API calls per trial (1-20)",-1))]),t("div",ys,[e[54]||(e[54]=t("label",null,"Default Timeout (seconds)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>i.defaultTimeout=s),min:"10",max:"600",onChange:e[3]||(e[3]=s=>k("defaultTimeout",i.defaultTimeout))},null,544),[[_,i.defaultTimeout,void 0,{number:!0}]]),e[55]||(e[55]=t("span",{class:"hint"},"Default timeout for all calls (10-600s)",-1))]),t("div",vs,[e[56]||(e[56]=t("label",null,"Default Max Retries",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>i.defaultMaxRetries=s),min:"0",max:"5",onChange:e[5]||(e[5]=s=>k("defaultMaxRetries",i.defaultMaxRetries))},null,544),[[_,i.defaultMaxRetries,void 0,{number:!0}]]),e[57]||(e[57]=t("span",{class:"hint"},"Default retry attempts (0-5)",-1))]),t("div",fs,[e[58]||(e[58]=t("label",null,"Default Temperature",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>i.defaultTemperature=s),min:"0",max:"2",step:"0.1",onChange:e[7]||(e[7]=s=>k("defaultTemperature",i.defaultTemperature))},null,544),[[_,i.defaultTemperature,void 0,{number:!0}]]),e[59]||(e[59]=t("span",{class:"hint"},"Default model temperature (0-2)",-1))]),t("div",gs,[e[60]||(e[60]=t("label",null,"Batch Size",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>i.batchSize=s),min:"1",max:"1000",onChange:e[9]||(e[9]=s=>k("batchSize",i.batchSize))},null,544),[[_,i.batchSize,void 0,{number:!0}]]),e[61]||(e[61]=t("span",{class:"hint"},"API calls per batch (1-1000, lower = more responsive)",-1))]),t("div",bs,[e[62]||(e[62]=t("label",null,"Max Concurrent Batches",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=s=>i.maxConcurrentBatches=s),min:"1",max:"20",onChange:e[11]||(e[11]=s=>k("maxConcurrentBatches",i.maxConcurrentBatches))},null,544),[[_,i.maxConcurrentBatches,void 0,{number:!0}]]),e[63]||(e[63]=t("span",{class:"hint"},"Batches processed simultaneously (1-20)",-1))]),t("div",ks,[e[64]||(e[64]=t("label",null,"Progress Buffer Delay (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>i.progressBufferMs=s),min:"0",max:"10000",step:"100",onChange:e[13]||(e[13]=s=>k("progressBufferMs",i.progressBufferMs))},null,544),[[_,i.progressBufferMs,void 0,{number:!0}]]),e[65]||(e[65]=t("span",{class:"hint"},"Delay before updating progress (0-10000ms, 0 = immediate)",-1))])])])):O("",!0),C.value==="discovery"?(p(),b("div",Ss,[e[74]||(e[74]=t("h3",null,"Model Discovery Settings",-1)),e[75]||(e[75]=t("p",{class:"section-description"},"Configure automatic model discovery",-1)),t("div",hs,[t("div",ws,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>w.autoDiscoverOnStartup=s),onChange:e[15]||(e[15]=s=>N("autoDiscoverOnStartup",w.autoDiscoverOnStartup))},null,544),[[ie,w.autoDiscoverOnStartup]]),e[68]||(e[68]=q(" Auto-discover models on startup "))])]),t("div",xs,[e[69]||(e[69]=t("label",null,"Discovery Interval (hours)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>w.discoveryInterval=s),min:"1",max:"168",onChange:e[17]||(e[17]=s=>N("discoveryInterval",w.discoveryInterval))},null,544),[[_,w.discoveryInterval,void 0,{number:!0}]]),e[70]||(e[70]=t("span",{class:"hint"},"Time between auto-discovery runs (1-168h)",-1))]),t("div",Cs,[e[71]||(e[71]=t("label",null,"Discovery Timeout (seconds)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=s=>w.discoveryTimeout=s),min:"10",max:"300",onChange:e[19]||(e[19]=s=>N("discoveryTimeout",w.discoveryTimeout))},null,544),[[_,w.discoveryTimeout,void 0,{number:!0}]]),e[72]||(e[72]=t("span",{class:"hint"},"Max time for discovery operations (10-300s)",-1))]),t("div",$s,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[20]||(e[20]=s=>w.skipFailedProviders=s),onChange:e[21]||(e[21]=s=>N("skipFailedProviders",w.skipFailedProviders))},null,544),[[ie,w.skipFailedProviders]]),e[73]||(e[73]=q(" Skip providers that previously failed "))])])])])):O("",!0),C.value==="coordination"?(p(),b("div",As,[e[82]||(e[82]=t("h3",null,"Multi-Tab Coordination",-1)),e[83]||(e[83]=t("p",{class:"section-description"},"Configure how multiple tabs work together",-1)),t("div",Ps,[t("div",Ms,[e[76]||(e[76]=t("label",null,"Leader Election Timeout (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[22]||(e[22]=s=>S.leaderElectionTimeout=s),min:"100",max:"5000",onChange:e[23]||(e[23]=s=>W("leaderElectionTimeout",S.leaderElectionTimeout))},null,544),[[_,S.leaderElectionTimeout,void 0,{number:!0}]]),e[77]||(e[77]=t("span",{class:"hint"},"Time to elect new leader tab (100-5000ms)",-1))]),t("div",Ts,[e[78]||(e[78]=t("label",null,"Sync Interval (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[24]||(e[24]=s=>S.syncInterval=s),min:"100",max:"2000",onChange:e[25]||(e[25]=s=>W("syncInterval",S.syncInterval))},null,544),[[_,S.syncInterval,void 0,{number:!0}]]),e[79]||(e[79]=t("span",{class:"hint"},"Tab synchronization frequency (100-2000ms)",-1))]),t("div",Rs,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[26]||(e[26]=s=>S.enableBroadcastChannel=s),onChange:e[27]||(e[27]=s=>W("enableBroadcastChannel",S.enableBroadcastChannel))},null,544),[[ie,S.enableBroadcastChannel]]),e[80]||(e[80]=q(" Enable BroadcastChannel communication "))])]),t("div",Us,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[28]||(e[28]=s=>S.enableWebLocks=s),onChange:e[29]||(e[29]=s=>W("enableWebLocks",S.enableWebLocks))},null,544),[[ie,S.enableWebLocks]]),e[81]||(e[81]=q(" Enable Web Locks API "))])])])])):O("",!0),C.value==="performance"?(p(),b("div",Es,[e[90]||(e[90]=t("h3",null,"UI Performance",-1)),e[91]||(e[91]=t("p",{class:"section-description"},"Optimize UI performance for large datasets and debug performance issues",-1)),oe(_t),t("div",Is,[t("div",Ds,[e[84]||(e[84]=t("label",null,"Virtual Scrolling Threshold",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=s=>h.virtualScrollThreshold=s),min:"50",max:"10000",onChange:e[31]||(e[31]=s=>K("virtualScrollThreshold",h.virtualScrollThreshold))},null,544),[[_,h.virtualScrollThreshold,void 0,{number:!0}]]),e[85]||(e[85]=t("span",{class:"hint"},"Enable virtual scrolling above this row count (50-10000)",-1))]),t("div",Fs,[e[86]||(e[86]=t("label",null,"Debounce Delay (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[32]||(e[32]=s=>h.debounceDelay=s),min:"100",max:"1000",onChange:e[33]||(e[33]=s=>K("debounceDelay",h.debounceDelay))},null,544),[[_,h.debounceDelay,void 0,{number:!0}]]),e[87]||(e[87]=t("span",{class:"hint"},"Search/filter debounce delay (100-1000ms)",-1))]),t("div",Os,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[34]||(e[34]=s=>h.enableRequestIdleCallback=s),onChange:e[35]||(e[35]=s=>K("enableRequestIdleCallback",h.enableRequestIdleCallback))},null,544),[[ie,h.enableRequestIdleCallback]]),e[88]||(e[88]=q(" Use requestIdleCallback for background tasks "))])]),t("div",Ks,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[36]||(e[36]=s=>h.enableProgressiveRendering=s),onChange:e[37]||(e[37]=s=>K("enableProgressiveRendering",h.enableProgressiveRendering))},null,544),[[ie,h.enableProgressiveRendering]]),e[89]||(e[89]=q(" Enable progressive rendering for large results "))])])])])):O("",!0),C.value==="system"?(p(),b("div",Ls,[e[97]||(e[97]=t("h3",null,"System Management",-1)),e[98]||(e[98]=t("p",{class:"section-description"},"Manage database and storage",-1)),t("div",{class:"danger-zone"},[e[96]||(e[96]=t("h4",null,"⚠️ Danger Zone",-1)),t("div",{class:"danger-actions"},[t("div",{class:"action-card"},[e[92]||(e[92]=t("h5",null,"Clear All Data",-1)),e[93]||(e[93]=t("p",null,"Delete all trials, models, settings, and API calls from the database. This action cannot be undone.",-1)),t("button",{class:"danger-button",onClick:y}," Delete Database & Store ")]),t("div",{class:"action-card"},[e[94]||(e[94]=t("h5",null,"Factory Reset",-1)),e[95]||(e[95]=t("p",null,"Complete factory reset - clears database, localStorage, sessionStorage, cookies, and all browser data. Restores app to fresh installation state.",-1)),t("button",{class:"danger-button",onClick:D}," Factory Reset Everything ")])])])])):O("",!0)])])):(p(),b("div",qt,e[38]||(e[38]=[t("p",null,"Loading settings...",-1)])))]))}}),Vs=re(Ns,[["__scopeId","data-v-d8ef7286"]]),Bs={class:"import-export-section"},_s={class:"import-export-content"},zs={class:"import-section all-data"},qs={class:"file-input-wrapper"},Gs={class:"import-section"},js={class:"file-input-wrapper"},Ws={class:"danger-section"},Js=["disabled"],Ys=ue({__name:"ImportExportSection",props:{onStatusMessage:{type:Function}},setup(ne){const $=Ce(),o=ne,n=F(),u=F(),A=F(!1);async function C(){var i,w;const d=await $.settings.core.exportSettings();if(d.ok){const S=new Blob([d.value],{type:"application/json"}),h=URL.createObjectURL(S),U=document.createElement("a");U.href=h,U.download=`auditomatic-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(h),(i=o.onStatusMessage)==null||i.call(o,"Settings exported successfully","success")}else(w=o.onStatusMessage)==null||w.call(o,`Failed to export settings: ${d.error.message}`,"error")}async function x(d){var w,S,h,U;const i=(w=d.target.files)==null?void 0:w[0];if(i)try{const z=await i.text(),k=await $.settings.core.importSettings(z);k.ok?((S=o.onStatusMessage)==null||S.call(o,"Settings imported successfully","success"),n.value&&(n.value.value="")):(h=o.onStatusMessage)==null||h.call(o,`Failed to import settings: ${k.error.message}`,"error")}catch{(U=o.onStatusMessage)==null||U.call(o,"Failed to read file","error")}}async function m(){var i,w;if(!confirm("Are you sure you want to reset all settings? This cannot be undone."))return;A.value=!0;const d=await $.settings.core.resetSettings();A.value=!1,d.ok?(i=o.onStatusMessage)==null||i.call(o,"All settings have been reset","success"):(w=o.onStatusMessage)==null||w.call(o,`Failed to reset settings: ${d.error.message}`,"error")}async function R(){var d,i,w;try{(d=o.onStatusMessage)==null||d.call(o,"Exporting all data...","success");const S={version:2,exported:new Date().toISOString(),app:"auditomatic-lite",tables:{}};for(const W of se.tables){const K=W.name;S.tables[K]=await W.toArray()}const h=JSON.stringify(S,null,2),U=(h.length/(1024*1024)).toFixed(2),z=new Blob([h],{type:"application/json"}),k=URL.createObjectURL(z),N=document.createElement("a");N.href=k,N.download=`auditomatic-all-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(k),(i=o.onStatusMessage)==null||i.call(o,`All data exported successfully (${U} MB)`,"success")}catch(S){I.error("Failed to export all data:",S),(w=o.onStatusMessage)==null||w.call(o,`Failed to export data: ${S}`,"error")}}async function j(d){var S,h,U,z;const i=(S=d.target.files)==null?void 0:S[0];if(!i)return;if(!confirm(`WARNING: This will REPLACE ALL existing data with the imported data.

All current trials, models, settings, etc. will be deleted.

Are you absolutely sure?`)){u.value&&(u.value.value="");return}try{(h=o.onStatusMessage)==null||h.call(o,"Importing all data...","success");const k=await i.text(),N=JSON.parse(k);if(!N.version||!N.tables)throw new Error("Invalid data format");await se.transaction("rw",se.tables,async()=>{await Promise.all(se.tables.map(W=>W.clear()));for(const[W,K]of Object.entries(N.tables)){const y=se[W];y&&Array.isArray(K)&&K.length>0&&await y.bulkAdd(K)}}),(U=o.onStatusMessage)==null||U.call(o,"All data imported successfully","success"),u.value&&(u.value.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(k){I.error("Failed to import all data:",k),(z=o.onStatusMessage)==null||z.call(o,`Failed to import data: ${k}`,"error"),u.value&&(u.value.value="")}}return(d,i)=>(p(),b("div",Bs,[i[13]||(i[13]=t("h2",null,"Import & Export",-1)),i[14]||(i[14]=t("p",{class:"tab-description"},"Backup and restore your settings. API keys are masked during export for security.",-1)),t("div",_s,[t("div",{class:"export-section all-data"},[i[2]||(i[2]=t("h3",null,"📦 Export All Data",-1)),t("button",{onClick:R,class:"btn btn-primary btn-large"}," Export Everything to JSON "),i[3]||(i[3]=t("p",{class:"help-text"},"Downloads ALL data: trials, models, settings, variable lists, datasets, API calls, etc.",-1))]),t("div",zs,[i[4]||(i[4]=t("h3",null,"📥 Import All Data",-1)),t("div",qs,[t("input",{ref_key:"allDataFileInput",ref:u,type:"file",accept:".json",onChange:j,class:"file-input"},null,544),t("button",{onClick:i[0]||(i[0]=()=>u.value&&u.value.click()),class:"btn btn-primary btn-large"}," Import Everything from JSON ")]),i[5]||(i[5]=t("p",{class:"help-text"},"⚠️ WARNING: This will REPLACE all existing data with the imported data",-1))]),i[12]||(i[12]=t("hr",{class:"section-divider"},null,-1)),t("div",{class:"export-section"},[i[6]||(i[6]=t("h3",null,"Export Settings Only",-1)),t("button",{onClick:C,class:"btn btn-secondary"}," Export Settings to JSON "),i[7]||(i[7]=t("p",{class:"help-text"},"Downloads a JSON file with your settings (API keys will be masked)",-1))]),t("div",Gs,[i[8]||(i[8]=t("h3",null,"Import Settings Only",-1)),t("div",js,[t("input",{ref_key:"fileInput",ref:n,type:"file",accept:".json",onChange:x,class:"file-input"},null,544),t("button",{onClick:i[1]||(i[1]=()=>n.value&&n.value.click()),class:"btn btn-secondary"}," Choose File ")]),i[9]||(i[9]=t("p",{class:"help-text"},"Import settings from a previously exported JSON file",-1))]),t("div",Ws,[i[10]||(i[10]=t("h3",null,"Reset Settings",-1)),t("button",{onClick:m,class:"btn btn-danger",disabled:A.value},P(A.value?"Resetting...":"Reset All Settings"),9,Js),i[11]||(i[11]=t("p",{class:"help-text"},"⚠️ This will clear all API keys and reset preferences to defaults",-1))])])]))}}),Hs=re(Ys,[["__scopeId","data-v-7b20deaa"]]),Xs=ue({__name:"StatusMessage",props:{text:{},type:{},duration:{default:5e3}},setup(ne){const $=ne,o=F(!1);let n=null;return pe(()=>$.text,u=>{u&&(o.value=!0,n&&clearTimeout(n),n=setTimeout(()=>{o.value=!1},$.duration))},{immediate:!0}),pe(o,u=>{!u&&n&&(clearTimeout(n),n=null)}),(u,A)=>(p(),Q(Ke,{name:"slide"},{default:Z(()=>[o.value?(p(),b("div",{key:0,class:ye(["status-message",u.type])},P(u.text),3)):O("",!0)]),_:1}))}}),Zs=re(Xs,[["__scopeId","data-v-da279e0d"]]),Qs={class:"settings-view","data-testid":"page-settings"},en={class:"tabs"},tn=["onClick"],sn={class:"tab-content"},nn=ue({__name:"SettingsView",setup(ne){const $=[{id:"api-keys",label:"API Keys"},{id:"preferences",label:"Preferences"},{id:"advanced",label:"Advanced"},{id:"import-export",label:"Import/Export"}],o=F("api-keys"),n=F(null);function u(A,C){n.value={text:A,type:C},setTimeout(()=>{var x;((x=n.value)==null?void 0:x.text)===A&&(n.value=null)},5500)}return(A,C)=>(p(),b("div",Qs,[C[0]||(C[0]=t("h1",{class:"settings-title"},"Settings",-1)),t("div",en,[(p(),b(me,null,Se($,x=>t("button",{key:x.id,class:ye(["tab",{active:o.value===x.id}]),onClick:m=>o.value=x.id},P(x.label),11,tn)),64))]),t("div",sn,[o.value==="api-keys"?(p(),Q(ft,{key:0,"on-status-message":u})):O("",!0),o.value==="preferences"?(p(),Q(Rt,{key:1,"on-status-message":u})):O("",!0),o.value==="advanced"?(p(),Q(Vs,{key:2,"on-status-message":u})):O("",!0),o.value==="import-export"?(p(),Q(Hs,{key:3,"on-status-message":u})):O("",!0)]),n.value?(p(),Q(Zs,{key:0,text:n.value.text,type:n.value.type},null,8,["text","type"])):O("",!0)]))}}),mn=re(nn,[["__scopeId","data-v-ea1dc301"]]);export{mn as default};

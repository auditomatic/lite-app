import{d as e,f as a,c as s,o as l,a3 as o,Y as t,S as r,a7 as n,k as i,X as c,U as d,u,F as p,a5 as y,W as m,G as v,_ as k,B as f}from"./vendor-DCf9YP3r.js";import{f as g}from"./cost-formatting-Cno2rTOg.js";import{u as h,m as b}from"./models-db-3pG6m6YE.js";import{p as C}from"./registry-DiQCbBcP.js";import{R as w,_}from"./index-dQqVkRMY.js";import"./db-CL8uhZCz.js";import"./logger.service-_k__GSpu.js";const M={class:"models-view"},O={class:"page-header"},P={key:1,class:"discovery-status-bar"},j={class:"source-name"},x=["onClick"],L={class:"provider-header"},F={class:"provider-name"},z={key:1},S={key:0},R={key:1,class:"text-secondary"},$={key:0,class:"cost-display"},I={key:0,class:"cost-line"},T={key:1,class:"cost-line"},B={key:1,class:"text-secondary"},E=_(e({__name:"ModelsView",setup(e){const _=h(),E=a(""),U=a(!1),A=a(""),K=a([]),N=a(null),W=[{title:"Enabled",key:"enabled",width:80,align:"center"},{title:"Model",key:"model",width:300},{title:"Source",key:"source",width:100,align:"center"},{title:"Context",key:"context",width:100,align:"right"},{title:"Cost/1M",key:"cost",width:100,align:"right"}],D=s(()=>{const e=E.value.toLowerCase(),a={};for(const[s,l]of Object.entries(_.modelsByProvider)){const o=l.filter(a=>a.displayName.toLowerCase().includes(e)||a.modelId.toLowerCase().includes(e)||s.toLowerCase().includes(e));o.length>0&&(a[s]=o)}return a}),G=s(()=>E.value?`No models found matching "${E.value}"`:'No models available. Click "Refresh Models" to discover models.');function V(e){const a=C.getProvider(e);return a?.name||e}function X(e){const a=_.modelsByProvider[e]||[];return a.length>0&&a.every(e=>e.enabled)}async function Y(){try{await b.enableOpenRouterFavorites(),K.value=Object.keys(_.modelsByProvider)}catch(e){console.error("Failed to enable OpenRouter favorites:",e),alert("Failed to enable OpenRouter favorites: "+(e instanceof Error?e.message:"Unknown error"))}}async function q(){U.value=!0,A.value="";try{const e=await _.discoverModels(!0);e.errors.length>0&&(A.value=`Some sources failed: ${e.errors.join("; ")}`)}catch(e){console.error("Failed to refresh models:",e),A.value="Failed to refresh models. Please check your connection and try again."}finally{U.value=!1}}const H=g;return l(async()=>{0===_.allModels.length&&await q(),K.value=Object.keys(_.modelsByProvider)}),(e,a)=>{const s=d("a-button"),l=d("a-space"),g=d("a-alert"),h=d("a-tag"),b=d("a-input-search"),C=d("a-switch"),J=d("a-table"),Q=d("a-collapse-panel"),Z=d("a-collapse"),ee=d("a-empty");return m(),o("div",M,[t("div",O,[a[5]||(a[5]=t("div",{class:"header-content"},[t("h1",null,"Model Management"),t("p",{class:"description"},"Configure and enable LLM models for testing")],-1)),i(l,null,{default:c(()=>[i(s,{type:"primary",onClick:q,loading:U.value},{icon:c(()=>[i(u(w))]),default:c(()=>[a[4]||(a[4]=v(" Refresh Models "))]),_:1,__:[4]},8,["loading"])]),_:1})]),A.value?(m(),r(g,{key:0,type:"error",message:A.value,closable:"",onClose:a[0]||(a[0]=e=>A.value=""),class:"error-alert"},null,8,["message"])):n("",!0),u(_).discoveryStatus.length>0?(m(),o("div",P,[a[6]||(a[6]=t("span",{class:"status-label"},"Sources:",-1)),(m(!0),o(p,null,y(u(_).discoveryStatus,e=>{return m(),o("div",{key:e.id,class:"source-status-compact"},[t("span",j,k((s=e.id,{litellm:"LiteLLM (Anthropic & OpenAI models & prices)",openrouter:"OpenRouter",ollama:"Ollama"}[s]||s)),1),i(h,{color:(a=e.status,{idle:"default",loading:"processing",success:"success",error:"error"}[a]||"default"),size:"small"},{default:c(()=>["success"===e.status&&e.modelCount?(m(),o(p,{key:0},[v(k(e.modelCount),1)],64)):"error"===e.status?(m(),o("span",{key:1,onClick:a=>async function(e){N.value=e,A.value="";try{await _.refreshSource(e)}catch(a){console.error(`Failed to retry ${e}:`,a),A.value=`Failed to refresh ${function(e){return{litellm:"LiteLLM",openrouter:"OpenRouter",ollama:"Ollama"}[e]||e}(e)}: ${a instanceof Error?a.message:"Unknown error"}`}finally{N.value=null}}(e.id),style:{cursor:"pointer"}},"âŸ³ retry",8,x)):(m(),o(p,{key:2},[v(k(e.status),1)],64))]),_:2},1032,["color"])]);var a,s}),128))])):n("",!0),i(b,{value:E.value,"onUpdate:value":a[1]||(a[1]=e=>E.value=e),placeholder:"Search models by name, provider, or ID...","allow-clear":"",size:"large",class:"search-bar"},null,8,["value"]),i(Z,{activeKey:K.value,"onUpdate:activeKey":a[3]||(a[3]=e=>K.value=e),class:"provider-collapse",bordered:!1},{default:c(()=>[(m(!0),o(p,null,y(D.value,(e,d)=>(m(),r(Q,{key:d},{header:c(()=>[t("div",L,[t("span",F,[t("strong",null,k(V(d)),1),i(h,{size:"small",color:"blue"},{default:c(()=>[v(k(e.length)+" models",1)]),_:2},1024)]),i(l,{size:"small",onClick:a[2]||(a[2]=f(()=>{},["stop"]))},{default:c(()=>["openrouter"===d?(m(),r(s,{key:0,size:"small",type:"primary",ghost:"",onClick:f(Y,["stop"])},{default:c(()=>a[7]||(a[7]=[v(" Enable Favorites ")])),_:1,__:[7]})):n("",!0),i(s,{size:"small",type:X(d)?"danger":"primary",onClick:f(e=>async function(e,a){await _.toggleProvider(e,a)}(d,!X(d)),["stop"])},{default:c(()=>[v(k(X(d)?"Disable All":"Enable All"),1)]),_:2},1032,["type","onClick"])]),_:2},1024)])]),default:c(()=>[i(J,{columns:W,"data-source":e,pagination:!1,size:"small",scroll:{y:"calc((100vh - 250px) * 0.75)"},"row-key":"id",class:"models-table"},{bodyCell:c(({column:e,record:s})=>{return["enabled"===e.key?(m(),r(C,{key:0,checked:s.enabled,onChange:e=>async function(e,a){await _.toggleModel(e,a)}(s.id,e),size:"small"},null,8,["checked","onChange"])):n("",!0),"model"===e.key?(m(),o("code",z,k(s.modelId),1)):n("",!0),"source"===e.key?(m(),o(p,{key:2},[s.source?(m(),r(h,{key:0,size:"small",color:"cyan"},{default:c(()=>[v(k(s.source),1)]),_:2},1024)):n("",!0)],64)):n("",!0),"context"===e.key?(m(),o(p,{key:3},[s.capabilities?.contextWindow?(m(),o("span",S,k((l=s.capabilities.contextWindow,l>=1e6?(l/1e6).toFixed(1)+"M":l>=1e3?(l/1e3).toFixed(0)+"K":l.toString())),1)):(m(),o("span",R,"-"))],64)):n("",!0),"cost"===e.key?(m(),o(p,{key:4},[s.capabilities?.inputCostPerToken||s.capabilities?.outputCostPerToken?(m(),o("div",$,[s.capabilities.inputCostPerToken?(m(),o("div",I,[a[8]||(a[8]=t("span",{class:"cost-label"},"In:",-1)),v(" $"+k(u(H)(s.capabilities.inputCostPerToken)),1)])):n("",!0),s.capabilities.outputCostPerToken?(m(),o("div",T,[a[9]||(a[9]=t("span",{class:"cost-label"},"Out:",-1)),v(" $"+k(u(H)(s.capabilities.outputCostPerToken)),1)])):n("",!0)])):(m(),o("span",B,"-"))],64)):n("",!0)];var l}),_:2},1032,["data-source"])]),_:2},1024))),128))]),_:1},8,["activeKey"]),0===Object.keys(D.value).length?(m(),r(ee,{key:2,description:G.value,class:"empty-state"},null,8,["description"])):n("",!0)])}}}),[["__scopeId","data-v-39abe109"]]);export{E as default};

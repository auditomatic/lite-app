const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-dQqVkRMY.js","./vendor-DCf9YP3r.js","./db-CL8uhZCz.js","./index-Dgs9Bne1.css"])))=>i.map(i=>d[i]);
import{e}from"./index-dQqVkRMY.js";const t=new class{async getStorageInfo(){const e=await this.calculateStorageBreakdown(),t=await this.getDetailedIndexedDBBreakdown(),a=e.localStorage+e.indexedDB+e.sessionStorage;let s=0,o=0;if("storage"in navigator&&"estimate"in navigator.storage)try{const e=await navigator.storage.estimate();s=e.quota||0,o=s-(e.usage||a)}catch(n){console.warn("Could not get storage estimate:",n)}0===s&&(s=this.estimateQuota(),o=s-a);const{value:r,unit:i}=this.formatBytes(a);return{total:s,used:a,available:Math.max(0,o),unit:i,formatted:`${r} ${i}`,breakdown:e,detailedBreakdown:t}}async calculateStorageBreakdown(){const e=this.calculateLocalStorageSize(),t=this.calculateSessionStorageSize();return{localStorage:e,indexedDB:await this.calculateIndexedDBSize(),sessionStorage:t}}calculateLocalStorageSize(){let e=0;try{for(let t in localStorage)localStorage.hasOwnProperty(t)&&(e+=localStorage[t].length+t.length)}catch(t){console.warn("Could not calculate localStorage size:",t)}return 2*e}calculateSessionStorageSize(){let e=0;try{for(let t in sessionStorage)sessionStorage.hasOwnProperty(t)&&(e+=sessionStorage[t].length+t.length)}catch(t){console.warn("Could not calculate sessionStorage size:",t)}return 2*e}async calculateIndexedDBSize(){if("storage"in navigator&&"estimate"in navigator.storage)try{const e=await navigator.storage.estimate();if(e.usageDetails&&e.usageDetails.indexedDB)return e.usageDetails.indexedDB}catch(e){console.warn("Could not get IndexedDB size from storage API:",e)}return await this.estimateIndexedDBSize()}async estimateIndexedDBSize(){const e=await this.getDetailedIndexedDBBreakdown();return e?Object.values(e).reduce((e,t)=>e+t,0):0}async getDetailedIndexedDBBreakdown(){try{const{db:t}=await e(async()=>{const{db:e}=await import("./index-dQqVkRMY.js").then(e=>e.s);return{db:e}},__vite__mapDeps([0,1,2,3]),import.meta.url),[a,s,o,r,i]=await Promise.all([t.designs.toArray(),t.variableLists.toArray(),t.trials.toArray(),t.apiCalls.toArray(),t.settings.toArray()]);return{designs:this.calculateObjectSize(a),variableLists:this.calculateObjectSize(s),trials:this.calculateObjectSize(o),apiCalls:this.calculateObjectSize(r),settings:this.calculateObjectSize(i)}}catch(t){return console.warn("Could not get detailed IndexedDB breakdown:",t),{designs:0,variableLists:0,trials:0,apiCalls:0,settings:0}}}calculateObjectSize(e){try{return 2*JSON.stringify(e).length}catch(t){return console.warn("Could not calculate object size:",t),0}}estimateQuota(){const e=navigator.userAgent.toLowerCase();return e.includes("chrome")||e.includes("edge")?1073741824:e.includes("firefox")?536870912:(e.includes("safari"),268435456)}formatBytes(e){if(0===e)return{value:"0",unit:"B"};const t=Math.floor(Math.log(e)/Math.log(1024));return{value:(e/Math.pow(1024,t)).toFixed(0===t?0:1),unit:["B","KB","MB","GB"][t]||"GB"}}async getStoragePercentage(){const e=await this.getStorageInfo();return 0===e.total?0:Math.round(e.used/e.total*100)}};export{t as s};

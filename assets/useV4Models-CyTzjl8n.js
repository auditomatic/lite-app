import{a as c}from"./useV4LiveQuery-DCvW8B3Q.js";import{l as d,d as n,a as f,c as u}from"./index-nY7SO6jw.js";class j{liveModels(){return d(async()=>{const o=await n.models.toArray(),e=await n.settings.get("main");f.info("[V4-DB] liveModels query running, settings:",e),f.info("[V4-DB] OpenRouter models before filter:",o.filter(t=>t.provider==="openrouter").length);let a=o;if(e&&(e.hideOpenRouterAuto||e.hideOpenRouterFree)){const t=o.filter(i=>i.provider==="openrouter").length;a=o.filter(i=>{var s;if(i.provider==="openrouter"){if(e.hideOpenRouterAuto&&i.modelId==="openrouter/auto")return f.info("[V4-DB] Filtering out openrouter/auto"),!1;if(e.hideOpenRouterFree&&((s=i.capabilities)==null?void 0:s.inputCostPerToken)===0)return f.info("[V4-DB] Filtering out free model:",i.modelId),!1}return!0});const l=a.filter(i=>i.provider==="openrouter").length;f.info(`[V4-DB] OpenRouter models after filter: ${l} (filtered ${t-l})`)}a.sort((t,l)=>(t.displayName||t.modelId).localeCompare(l.displayName||l.modelId));const r=a.map(t=>Object.freeze(t));return Object.freeze(r)})}liveModelsByProvider(){return d(async()=>{const o=await n.models.toArray(),e=await n.settings.get("main");let a=o;e&&(e.hideOpenRouterAuto||e.hideOpenRouterFree)&&(a=o.filter(l=>{var i;return!(l.provider==="openrouter"&&(e.hideOpenRouterAuto&&l.modelId==="openrouter/auto"||e.hideOpenRouterFree&&((i=l.capabilities)==null?void 0:i.inputCostPerToken)===0))}));const r={};for(const l of a)r[l.provider]||(r[l.provider]=[]),r[l.provider].push(Object.freeze(l));const t={};for(const[l,i]of Object.entries(r))i.sort((s,p)=>(s.displayName||s.modelId).localeCompare(p.displayName||p.modelId)),t[l]=Object.freeze(i);return Object.freeze(t)})}liveEnabledModels(){return d(async()=>{const o=await n.models.filter(t=>t.enabled===!0).toArray(),e=await n.settings.get("main");let a=o;e&&(e.hideOpenRouterAuto||e.hideOpenRouterFree)&&(a=o.filter(t=>{var l;return!(t.provider==="openrouter"&&(e.hideOpenRouterAuto&&t.modelId==="openrouter/auto"||e.hideOpenRouterFree&&((l=t.capabilities)==null?void 0:l.inputCostPerToken)===0))}));const r=a.map(t=>Object.freeze(t));return Object.freeze(r)})}liveModelsBySpecificProvider(o){return d(async()=>{const a=(await n.models.where("provider").equals(o).toArray()).map(r=>Object.freeze(r));return Object.freeze(a)})}liveModel(o){return d(async()=>{const e=await n.models.get(o);return e?Object.freeze(e):null})}liveModelStats(){return d(async()=>{const o=await n.models.toArray(),e=o.length,a=o.filter(r=>r.enabled===!0).length;return Object.freeze({total:e,enabled:a,disabled:e-a})})}liveProviderStats(){return d(async()=>{const o=await n.models.toArray(),e={};for(const r of o)e[r.provider]||(e[r.provider]={total:0,enabled:0,available:0}),e[r.provider].total++,r.enabled&&e[r.provider].enabled++,r.available!==!1&&e[r.provider].available++;const a={};for(const[r,t]of Object.entries(e))a[r]=Object.freeze(t);return Object.freeze(a)})}}const v=new j;function V(){const{data:m,loading:o,error:e}=c(()=>v.liveModels(),{initialValue:[],shallow:!0}),{data:a,loading:r,error:t}=c(()=>v.liveModelsByProvider(),{initialValue:{},shallow:!0}),{data:l,loading:i,error:s}=c(()=>v.liveEnabledModels(),{initialValue:[],shallow:!0}),{data:p,loading:g,error:O}=c(()=>v.liveModelStats(),{initialValue:{total:0,enabled:0,disabled:0},shallow:!0}),y=u(()=>o.value||r.value||i.value||g.value),h=u(()=>e.value||t.value||s.value||O.value);function M(b){return m.value.find(w=>w.id===b)}function z(b){return a.value[b]||[]}return{models:u(()=>m.value),modelsByProvider:u(()=>a.value),enabledModels:u(()=>l.value),stats:u(()=>p.value),loading:y,error:h,findModel:M,getProviderModels:z}}export{V as u};

var Ut=Object.defineProperty;var Nt=(n,e,t)=>e in n?Ut(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ce=(n,e,t)=>Nt(n,typeof e!="symbol"?e+"":e,t);import{e as V,I as Xe,f as ie,r as j,c as M,t as me,o as he,w as ue,h as f,ac as ee,i as s,A,aM as $e,ah as ge,j as o,k as re,ag as Te,aV as Wt,aW as Ht,aX as zt,v as J,aY as Bt,aZ as Gt,y as Z,ae as yt,ad as Ce,x as L,F as X,C as se,at as nt,a_ as jt,a$ as qt,b0 as lt,G as W,aF as _t,ai as Ge,an as Tt,B as k,b1 as Kt,z as N,P as Qt,aJ as ot,as as Yt,aP as $t,L as Jt,M as Ct,J as Xt,N as Zt,R as it,aI as es,u as Ze,D as oe,a as m,s as Oe,d as je,b2 as Ie,b3 as Re,b4 as ze,Y as kt,aU as St,b5 as ts,aj as wt,a6 as ss,aA as as,Z as It,Q as et,aw as qe,H as ns,ak as ls,K as os}from"./index-C_Jm4ddV.js";import{F as is}from"./FilterOutlined-Cq2JyzlU.js";import{I as rs}from"./InboxOutlined-DFX32_Vs.js";import{S as us}from"./StopOutlined-Bbf1DzlH.js";import{F as ds,C as cs,b as Rt,u as ps,a as fs,c as vs}from"./useV4TrialCommands-9J6dMPy7.js";import{u as ms}from"./useHeatmapStylingV3-uGNvjGeO.js";import{W as Et}from"./WarningOutlined-DmuWnCbI.js";import{u as gs}from"./useV4Models-BDI7fbnD.js";import"./useV4LiveQuery-DYWEk8w6.js";var hs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};function rt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable}))),l.forEach(function(d){bs(n,d,t[d])})}return n}function bs(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var tt=function(e,t){var l=rt({},e,t.attrs);return V(Xe,rt({},l,{icon:hs}),null)};tt.displayName="ColumnHeightOutlined";tt.inheritAttrs=!1;var ys={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function ut(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable}))),l.forEach(function(d){_s(n,d,t[d])})}return n}function _s(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var st=function(e,t){var l=ut({},e,t.attrs);return V(Xe,ut({},l,{icon:ys}),null)};st.displayName="PauseCircleOutlined";st.inheritAttrs=!1;var Ts={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function dt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable}))),l.forEach(function(d){$s(n,d,t[d])})}return n}function $s(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var at=function(e,t){var l=dt({},e,t.attrs);return V(Xe,dt({},l,{icon:Ts}),null)};at.displayName="SyncOutlined";at.inheritAttrs=!1;const Cs={class:"right-panel"},ks=ie({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(n,{expose:e,emit:t}){const l=n,d=t,r=j(l.defaultWidth),u=j(!1),b=j(0),i=j(0),c=j(window.innerWidth),g=j(!1),y=M(()=>c.value<l.mobileBreakpoint),h=M(()=>y.value?{width:`${Math.min(c.value*.85,400)}px`}:{width:`${r.value}px`});function $(){const p=localStorage.getItem(l.storageKey);if(p){const O=parseInt(p,10);!isNaN(O)&&O>=l.minWidth&&O<=l.maxWidth&&(r.value=O)}}function I(p){localStorage.setItem(l.storageKey,p.toString()),d("resize",p)}function _(p){u.value=!0,b.value=p.clientX,i.value=r.value,document.addEventListener("mousemove",w),document.addEventListener("mouseup",H),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function w(p){if(!u.value)return;const O=p.clientX-b.value,q=Math.max(l.minWidth,Math.min(l.maxWidth,i.value+O));r.value=q}function H(){u.value&&(u.value=!1,I(r.value),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",H),document.body.style.userSelect="",document.body.style.cursor="")}function F(){r.value=l.defaultWidth,I(l.defaultWidth)}function T(){c.value=window.innerWidth,!y.value&&g.value&&(g.value=!1,d("mobile-overlay-change",!1))}function E(){y.value&&(g.value=!g.value,d("mobile-overlay-change",g.value))}function v(){g.value=!1,d("mobile-overlay-change",!1)}return e({toggleMobileOverlay:E,closeMobileOverlay:v}),me(()=>{$(),window.addEventListener("resize",T)}),he(()=>{window.removeEventListener("resize",T),H()}),ue(()=>l.defaultWidth,p=>{r.value===l.defaultWidth&&(r.value=p)}),(p,O)=>(o(),f("div",{class:ee(["resizable-panel-container",{"mobile-overlay":y.value}])},[s("div",{class:ee(["left-panel",{"overlay-visible":y.value&&g.value}]),style:ge(h.value)},[$e(p.$slots,"left",{},void 0,!0)],6),y.value?A("",!0):(o(),f("div",{key:0,class:ee(["resize-handle",{dragging:u.value}]),onMousedown:_,onDblclick:F},O[0]||(O[0]=[s("div",{class:"handle-bar"},null,-1)]),34)),s("div",Cs,[$e(p.$slots,"right",{},void 0,!0)]),y.value&&g.value?(o(),f("div",{key:1,class:"mobile-overlay-bg",onClick:v})):A("",!0)],2))}}),Ss=re(ks,[["__scopeId","data-v-949e1df1"]]);function ws(){var n=window.navigator.userAgent,e=n.indexOf("MSIE ");if(e>0)return parseInt(n.substring(e+5,n.indexOf(".",e)),10);var t=n.indexOf("Trident/");if(t>0){var l=n.indexOf("rv:");return parseInt(n.substring(l+3,n.indexOf(".",l)),10)}var d=n.indexOf("Edge/");return d>0?parseInt(n.substring(d+5,n.indexOf(".",d)),10):-1}let Le;function Ke(){Ke.init||(Ke.init=!0,Le=ws()!==-1)}var xe={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ke(),Te(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const n=document.createElement("object");this._resizeObject=n,n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex",-1),n.onload=this.addResizeHandlers,n.type="text/html",Le&&this.$el.appendChild(n),n.data="about:blank",Le||this.$el.appendChild(n)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Le&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Is=zt();Wt("data-v-b329ee4c");const Rs={class:"resize-observer",tabindex:"-1"};Ht();const Es=Is((n,e,t,l,d,r)=>(o(),J("div",Rs)));xe.render=Es;xe.__scopeId="data-v-b329ee4c";xe.__file="src/components/ResizeObserver.vue";function Pe(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pe=function(e){return typeof e}:Pe=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(n)}function Vs(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function As(n,e){for(var t=0;t<e.length;t++){var l=e[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}function Fs(n,e,t){return e&&As(n.prototype,e),n}function ct(n){return Os(n)||Ls(n)||Ps(n)||Ms()}function Os(n){if(Array.isArray(n))return Qe(n)}function Ls(n){if(typeof Symbol<"u"&&Symbol.iterator in Object(n))return Array.from(n)}function Ps(n,e){if(n){if(typeof n=="string")return Qe(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qe(n,e)}}function Qe(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,l=new Array(e);t<e;t++)l[t]=n[t];return l}function Ms(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ds(n){var e;return typeof n=="function"?e={callback:n}:e=n,e}function xs(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l,d,r,u=function(i){for(var c=arguments.length,g=new Array(c>1?c-1:0),y=1;y<c;y++)g[y-1]=arguments[y];if(r=g,!(l&&i===d)){var h=t.leading;typeof h=="function"&&(h=h(i,d)),(!l||i!==d)&&h&&n.apply(void 0,[i].concat(ct(r))),d=i,clearTimeout(l),l=setTimeout(function(){n.apply(void 0,[i].concat(ct(r))),l=0},e)}};return u._clear=function(){clearTimeout(l),l=null},u}function Vt(n,e){if(n===e)return!0;if(Pe(n)==="object"){for(var t in n)if(!Vt(n[t],e[t]))return!1;return!0}return!1}var Us=function(){function n(e,t,l){Vs(this,n),this.el=e,this.observer=null,this.frozen=!1,this.createObserver(t,l)}return Fs(n,[{key:"createObserver",value:function(t,l){var d=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Ds(t),this.callback=function(b,i){d.options.callback(b,i),b&&d.options.once&&(d.frozen=!0,d.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},u=r.leading;this.callback=xs(this.callback,this.options.throttle,{leading:function(i){return u==="both"||u==="visible"&&i||u==="hidden"&&!i}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(b){var i=b[0];if(b.length>1){var c=b.find(function(y){return y.isIntersecting});c&&(i=c)}if(d.callback){var g=i.isIntersecting&&i.intersectionRatio>=d.threshold;if(g===d.oldResult)return;d.oldResult=g,d.callback(g,i)}},this.options.intersection),Te(function(){d.observer&&d.observer.observe(d.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),n}();function At(n,e,t){var l=e.value;if(l)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var d=new Us(n,l,t);n._vue_visibilityState=d}}function Ns(n,e,t){var l=e.value,d=e.oldValue;if(!Vt(l,d)){var r=n._vue_visibilityState;if(!l){Ft(n);return}r?r.createObserver(l,t):At(n,{value:l},t)}}function Ft(n){var e=n._vue_visibilityState;e&&(e.destroyObserver(),delete n._vue_visibilityState)}var Ws={beforeMount:At,updated:Ns,unmounted:Ft},Hs={itemsLimit:1e3},zs=/(auto|scroll)/;function Ot(n,e){return n.parentNode===null?e:Ot(n.parentNode,e.concat([n]))}var Be=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},Bs=function(e){return Be(e,"overflow")+Be(e,"overflow-y")+Be(e,"overflow-x")},Gs=function(e){return zs.test(Bs(e))};function pt(n){if(n instanceof HTMLElement||n instanceof SVGElement){for(var e=Ot(n.parentNode,[]),t=0;t<e.length;t+=1)if(Gs(e[t]))return e[t];return document.scrollingElement||document.documentElement}}function Ye(n){"@babel/helpers - typeof";return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(n)}var js={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(e){return["vertical","horizontal"].includes(e)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function qs(){return this.items.length&&Ye(this.items[0])!=="object"}var Je=!1;if(typeof window<"u"){Je=!1;try{var Ks=Object.defineProperty({},"passive",{get:function(){Je=!0}});window.addEventListener("test",null,Ks)}catch{}}let Qs=0;var Ue={name:"RecycleScroller",components:{ResizeObserver:xe},directives:{ObserveVisibility:Ws},props:{...js,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const n={"-1":{accumulator:0}},e=this.items,t=this.sizeField,l=this.minItemSize;let d=1e4,r=0,u;for(let b=0,i=e.length;b<i;b++)u=e[b][t]||l,u<d&&(d=u),r+=u,n[b]={accumulator:r,size:u};return this.$_computedMinItemSize=d,n}return[]},simpleArray:qs,itemIndexByKey(){const{keyField:n,items:e}=this,t={};for(let l=0,d=e.length;l<d;l++)t[e[l][n]]=l;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const n=this.$_lastUpdateScrollPosition;typeof n=="number"&&this.$nextTick(()=>{this.scrollToPosition(n)})},beforeUnmount(){this.removeListeners()},methods:{addView(n,e,t,l,d){const r=Bt({id:Qs++,index:e,used:!0,key:l,type:d}),u=Gt({item:t,position:0,nr:r});return n.push(u),u},unuseView(n,e=!1){const t=this.$_unusedViews,l=n.nr.type;let d=t.get(l);d||(d=[],t.set(l,d)),d.push(n),e||(n.nr.used=!1,n.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(n){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const e=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});e(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&e()},this.updateInterval))}},handleVisibilityChange(n,e){this.ready&&(n||e.boundingClientRect.width!==0||e.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(n,e=!1){const t=this.itemSize,l=this.gridItems||1,d=this.itemSecondarySize||t,r=this.$_computedMinItemSize,u=this.typeField,b=this.simpleArray?null:this.keyField,i=this.items,c=i.length,g=this.sizes,y=this.$_views,h=this.$_unusedViews,$=this.pool,I=this.itemIndexByKey;let _,w,H,F,T;if(!c)_=w=F=T=H=0;else if(this.$_prerender)_=F=0,w=T=Math.min(this.prerender,i.length),H=null;else{const a=this.getScroll();if(e){let C=a.start-this.$_lastUpdateScrollPosition;if(C<0&&(C=-C),t===null&&C<r||C<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=a.start;const S=this.buffer;a.start-=S,a.end+=S;let U=0;if(this.$refs.before&&(U=this.$refs.before.scrollHeight,a.start-=U),this.$refs.after){const C=this.$refs.after.scrollHeight;a.end+=C}if(t===null){let C,G=0,te=c-1,R=~~(c/2),ae;do ae=R,C=g[R].accumulator,C<a.start?G=R:R<c-1&&g[R+1].accumulator>a.start&&(te=R),R=~~((G+te)/2);while(R!==ae);for(R<0&&(R=0),_=R,H=g[c-1].accumulator,w=R;w<c&&g[w].accumulator<a.end;w++);for(w===-1?w=i.length-1:(w++,w>c&&(w=c)),F=_;F<c&&U+g[F].accumulator<a.start;F++);for(T=F;T<c&&U+g[T].accumulator<a.end;T++);}else{_=~~(a.start/t*l);const C=_%l;_-=C,w=Math.ceil(a.end/t*l),F=Math.max(0,Math.floor((a.start-U)/t*l)),T=Math.floor((a.end-U)/t*l),_<0&&(_=0),w>c&&(w=c),F<0&&(F=0),T>c&&(T=c),H=Math.ceil(c/l)*t}}w-_>Hs.itemsLimit&&this.itemsLimitError(),this.totalSize=H;let E;const v=_<=this.$_endIndex&&w>=this.$_startIndex;if(v)for(let a=0,S=$.length;a<S;a++)E=$[a],E.nr.used&&(n&&(E.nr.index=I[E.item[b]]),(E.nr.index==null||E.nr.index<_||E.nr.index>=w)&&this.unuseView(E));const p=v?null:new Map;let O,q,x;for(let a=_;a<w;a++){O=i[a];const S=b?O[b]:O;if(S==null)throw new Error(`Key is ${S} on item (keyField is '${b}')`);if(E=y.get(S),!t&&!g[a].size){E&&this.unuseView(E);continue}q=O[u];let U=h.get(q),C=!1;if(!E)v?U&&U.length?E=U.pop():E=this.addView($,a,O,S,q):(x=p.get(q)||0,(!U||x>=U.length)&&(E=this.addView($,a,O,S,q),this.unuseView(E,!0),U=h.get(q)),E=U[x],p.set(q,x+1)),y.delete(E.nr.key),E.nr.used=!0,E.nr.index=a,E.nr.key=S,E.nr.type=q,y.set(S,E),C=!0;else if(!E.nr.used&&(E.nr.used=!0,C=!0,U)){const G=U.indexOf(E);G!==-1&&U.splice(G,1)}E.item=O,C&&(a===i.length-1&&this.$emit("scroll-end"),a===0&&this.$emit("scroll-start")),t===null?(E.position=g[a-1].accumulator,E.offset=0):(E.position=Math.floor(a/l)*t,E.offset=a%l*d)}return this.$_startIndex=_,this.$_endIndex=w,this.emitUpdate&&this.$emit("update",_,w,F,T),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:v}},getListenerTarget(){let n=pt(this.$el);return window.document&&(n===window.document.documentElement||n===window.document.body)&&(n=window),n},getScroll(){const{$el:n,direction:e}=this,t=e==="vertical";let l;if(this.pageMode){const d=n.getBoundingClientRect(),r=t?d.height:d.width;let u=-(t?d.top:d.left),b=t?window.innerHeight:window.innerWidth;u<0&&(b+=u,u=0),u+b>r&&(b=r-u),l={start:u,end:u+b}}else t?l={start:n.scrollTop,end:n.scrollTop+n.clientHeight}:l={start:n.scrollLeft,end:n.scrollLeft+n.clientWidth};return l},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Je?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(n){let e;const t=this.gridItems||1;this.itemSize===null?e=n>0?this.sizes[n-1].accumulator:0:e=Math.floor(n/t)*this.itemSize,this.scrollToPosition(e)},scrollToPosition(n){const e=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,l,d;if(this.pageMode){const r=pt(this.$el),u=r.tagName==="HTML"?0:r[e.scroll],b=r.getBoundingClientRect(),c=this.$el.getBoundingClientRect()[e.start]-b[e.start];t=r,l=e.scroll,d=n+u+c}else t=this.$el,l=e.scroll,d=n;t[l]=d},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((n,e)=>n.nr.index-e.nr.index)}}};const Ys={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Js={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Xs(n,e,t,l,d,r){const u=Z("ResizeObserver"),b=yt("observe-visibility");return Ce((o(),f("div",{class:ee(["vue-recycle-scroller",{ready:d.ready,"page-mode":t.pageMode,[`direction-${n.direction}`]:!0}]),onScrollPassive:e[0]||(e[0]=(...i)=>r.handleScroll&&r.handleScroll(...i))},[n.$slots.before?(o(),f("div",Ys,[$e(n.$slots,"before")],512)):A("v-if",!0),(o(),J(nt(t.listTag),{ref:"wrapper",style:ge({[n.direction==="vertical"?"minHeight":"minWidth"]:d.totalSize+"px"}),class:ee(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:L(()=>[(o(!0),f(X,null,se(d.pool,i=>(o(),J(nt(t.itemTag),jt({key:i.nr.id,style:d.ready?{transform:`translate${n.direction==="vertical"?"Y":"X"}(${i.position}px) translate${n.direction==="vertical"?"X":"Y"}(${i.offset}px)`,width:t.gridItems?`${n.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${n.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&d.hoverKey===i.nr.key}]]},qt(t.skipHover?{}:{mouseenter:()=>{d.hoverKey=i.nr.key},mouseleave:()=>{d.hoverKey=null}})),{default:L(()=>[$e(n.$slots,"default",{item:i.item,index:i.nr.index,active:i.nr.used})]),_:2},1040,["style","class"]))),128)),$e(n.$slots,"empty")]),_:3},8,["style","class"])),n.$slots.after?(o(),f("div",Js,[$e(n.$slots,"after")],512)):A("v-if",!0),V(u,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[b,r.handleVisibilityChange]])}Ue.render=Xs;Ue.__file="src/components/RecycleScroller.vue";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ft=()=>{};function Zs(n,e){function t(...l){return new Promise((d,r)=>{Promise.resolve(n(()=>e.apply(this,l),{fn:e,thisArg:this,args:l})).then(d).catch(r)})}return t}function ea(n,e={}){let t,l,d=ft;const r=i=>{clearTimeout(i),d(),d=ft};let u;return i=>{const c=lt(n),g=lt(e.maxWait);return t&&r(t),c<=0||g!==void 0&&g<=0?(l&&(r(l),l=void 0),Promise.resolve(i())):new Promise((y,h)=>{d=e.rejectOnCancel?h:y,u=i,g&&!l&&(l=setTimeout(()=>{t&&r(t),l=void 0,y(u())},g)),t=setTimeout(()=>{l&&r(l),l=void 0,y(i())},c)})}}function Lt(n,e=200,t={}){return Zs(ea(e,t),n)}const ta={class:"trial-list-search"},sa=["value"],aa=ie({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=j(),d=Lt(c=>{t("update:modelValue",c)},300);function r(c){const g=c.target.value;d(g)}function u(){var c;t("update:modelValue",""),(c=l.value)==null||c.focus()}function b(){var c,g;(c=l.value)==null||c.focus(),(g=l.value)==null||g.select()}function i(c){c.type==="focus-trial-search"&&b()}return me(()=>{window.addEventListener("focus-trial-search",i)}),he(()=>{window.removeEventListener("focus-trial-search",i)}),(c,g)=>(o(),f("div",ta,[V(W(_t),{class:"search-icon"}),s("input",{ref_key:"searchInput",ref:l,type:"text",class:"search-input",placeholder:"Filter trials...",value:c.modelValue,onInput:r,onKeydown:Ge(u,["escape"])},null,40,sa),c.modelValue?(o(),J(W(Tt),{key:0,class:"clear-icon",onClick:u})):A("",!0)]))}}),na=re(aa,[["__scopeId","data-v-3a032c2b"]]),la={class:"item-content"},oa={class:"item-header"},ia=["title"],ra={key:0,class:"progress-bar"},ua={class:"item-metadata"},da={class:"meta-item"},ca={class:"meta-item"},pa={key:0,class:"meta-separator"},fa={key:1,class:"meta-item cost"},va=ie({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(n){const e=n,t=M(()=>{if(e.trial.progress.total===0)return 0;const u=e.trial.progress.completed+e.trial.progress.failed;return Math.round(u/e.trial.progress.total*100)}),l=M(()=>{const{completed:u,failed:b,total:i}=e.trial.progress;return e.trial.status==="draft"?`${i} tasks`:`${u+b}/${i} tasks`}),d=M(()=>{const u=e.trial.started||e.trial.created;if(!u)return"";const i=new Date().getTime()-u.getTime(),c=Math.floor(i/1e3),g=Math.floor(c/60),y=Math.floor(g/60),h=Math.floor(y/24);return c<60?"now":g<60?`${g}m`:y<24?`${y}h`:`${h}d`}),r=M(()=>{if(!e.trial.configurations||e.trial.configurations.length===0)return null;let u=0;return e.trial.configurations.forEach(b=>{var c,g;const i=b.modelSnapshot;if((c=i==null?void 0:i.capabilities)!=null&&c.inputCostPerToken&&((g=i==null?void 0:i.capabilities)!=null&&g.outputCostPerToken)){const y=500*i.capabilities.inputCostPerToken+500*i.capabilities.outputCostPerToken;u+=y*(e.trial.progress.total/e.trial.configurations.length)}}),u===0?null:u<.01?"<$0.01":u<1?`$${u.toFixed(2)}`:`$${u.toFixed(0)}`});return(u,b)=>(o(),f("div",{class:ee(["trial-list-item",{selected:u.selected,"has-progress":u.trial.status==="running"}]),onClick:b[0]||(b[0]=i=>u.$emit("click"))},[s("div",{class:ee(["status-indicator",`status-${u.trial.status}`])},null,2),s("div",la,[s("div",oa,[s("span",{class:"trial-name",title:u.trial.name},k(u.trial.name),9,ia),s("span",{class:ee(["status-tag",`status-${u.trial.status}`])},k(u.trial.status.toUpperCase()),3)]),u.trial.status==="running"?(o(),f("div",ra,[s("div",{class:"progress-fill",style:ge({width:`${t.value}%`})},null,4)])):A("",!0),s("div",ua,[s("span",da,k(l.value),1),b[1]||(b[1]=s("span",{class:"meta-separator"},"â€¢",-1)),s("span",ca,k(d.value),1),r.value?(o(),f("span",pa,"â€¢")):A("",!0),r.value?(o(),f("span",fa,k(r.value),1)):A("",!0)])])],2))}}),vt=re(va,[["__scopeId","data-v-f0ccace4"]]),ma={class:"section-title"},ga=ie({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(n){return(e,t)=>(o(),f("div",{class:ee(["trial-list-section",{"with-background":e.background}])},[s("span",ma,k(e.title),1)],2))}}),mt=re(ga,[["__scopeId","data-v-07a26c58"]]),ha={class:"panel-header"},ba={class:"header-title"},ya={key:0,class:"title-text"},_a={class:"trial-count"},Ta={key:0,class:"header-actions"},$a={class:"filter-count"},Ca={class:"filter-count"},ka={class:"filter-count"},Sa={class:"filter-count"},wa={class:"filter-count"},Ia={key:1,class:"status-tabs"},Ra={class:"tab-count"},Ea={class:"tab-count"},Va={class:"tab-count"},Aa={class:"trial-list-container"},Fa={key:1,class:"trial-list"},Oa={key:2,class:"collapsed-list"},La=["onClick"],Pa={class:"collapsed-count"},Ma={key:3,class:"empty-state"},Da=ie({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","update-search","update-filter","refresh"],setup(n,{emit:e}){const t=n,l=e,d=j(!1),r=j("all"),u=j(250),b=M(()=>u.value<50),i=M(()=>t.trials.filter(p=>p.status==="running"||p.status==="paused").length),c=M(()=>t.trials.filter(p=>p.status==="completed"||p.status==="failed").length),g=M(()=>{let p=t.trials;if(t.searchQuery){const a=t.searchQuery.toLowerCase();p=p.filter(S=>{var te,R;const U=S.name.toLowerCase().includes(a),C=(R=(te=S.templateConfig)==null?void 0:te.template)==null?void 0:R.toLowerCase().includes(a),G=S.configurations.some(ae=>ae.modelId.toLowerCase().includes(a)||ae.provider.toLowerCase().includes(a));return U||C||G})}t.filterStatus!=="all"&&(p=p.filter(a=>a.status===t.filterStatus)),r.value==="active"?p=p.filter(a=>a.status==="running"||a.status==="paused"):r.value==="done"&&(p=p.filter(a=>a.status==="completed"||a.status==="failed"));const O=p.filter(a=>a.status==="running"),q=p.filter(a=>a.status!=="running"),x=[];return O.length>0&&(x.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),x.push(...O.sort((a,S)=>{var U,C;return(((U=S.started)==null?void 0:U.getTime())||0)-(((C=a.started)==null?void 0:C.getTime())||0)}))),q.length>0&&(O.length>0&&x.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),x.push(...q.sort((a,S)=>{var U,C;return(((U=S.created)==null?void 0:U.getTime())||0)-(((C=a.created)==null?void 0:C.getTime())||0)}))),x}),y=M(()=>g.value.map(p=>({...p,height:H(p)}))),h=M(()=>t.trials.filter(p=>r.value==="active"?p.status==="running"||p.status==="paused":r.value==="done"?p.status==="completed"||p.status==="failed":!0)),$=M(()=>t.searchQuery?"No trials found":t.filterStatus==="running"?"No trials are currently running":"No trials found"),I=M(()=>t.searchQuery?"No trials match your search":t.filterStatus!=="all"?`No ${t.filterStatus} trials`:"Create your first trial to get started"),_=M(()=>t.filterStatus==="all"&&!t.searchQuery);function w(p){return t.trials.filter(O=>O.status===p).length}function H(p){var x;if(p.type==="section")return 32;const O=p.status==="running",q=(x=p.configurations)==null?void 0:x.some(a=>a.repeatCount>1);return O||q?96:80}function F(p){const O=p.progress.completed+p.progress.failed;return p.status==="running"?`${Math.round(O/p.progress.total*100)}%`:O.toString()}async function T(){d.value=!0;try{await new Promise(p=>setTimeout(p,500)),l("refresh")}finally{d.value=!1}}function E({key:p}){l("update-filter",p)}function v(){const p=document.querySelector(".trial-list-panel");p&&(u.value=p.clientWidth)}return me(()=>{v(),window.addEventListener("resize",v);const p=document.querySelector(".trial-list-panel");p&&new ResizeObserver(()=>v()).observe(p)}),he(()=>{window.removeEventListener("resize",v)}),(p,O)=>{const q=Z("a-button"),x=Z("a-menu-item"),a=Z("a-menu-divider"),S=Z("a-menu"),U=Z("a-dropdown");return o(),f("div",{class:ee(["trial-list-panel",{collapsed:b.value}])},[s("div",ha,[s("div",ba,[V(W(Kt),{class:"title-icon"}),b.value?A("",!0):(o(),f("span",ya,"Trials")),s("span",_a,k(p.trials.length),1)]),b.value?A("",!0):(o(),f("div",Ta,[V(q,{type:"primary",size:"small",onClick:O[0]||(O[0]=C=>p.$emit("create-trial"))},{default:L(()=>[V(W(Qt)),O[6]||(O[6]=N(" New Trial "))]),_:1,__:[6]}),V(q,{size:"small",onClick:T,loading:d.value},{default:L(()=>[V(W(at),{spin:d.value},null,8,["spin"])]),_:1},8,["loading"]),V(U,null,{overlay:L(()=>[V(S,{onClick:E},{default:L(()=>[V(x,{key:"all"},{default:L(()=>O[7]||(O[7]=[s("span",null,"All Trials",-1)])),_:1,__:[7]}),V(a),V(x,{key:"running"},{default:L(()=>[O[8]||(O[8]=s("span",null,"Running Only",-1)),s("span",$a,k(w("running")),1)]),_:1,__:[8]}),V(x,{key:"completed"},{default:L(()=>[O[9]||(O[9]=s("span",null,"Completed Only",-1)),s("span",Ca,k(w("completed")),1)]),_:1,__:[9]}),V(x,{key:"failed"},{default:L(()=>[O[10]||(O[10]=s("span",null,"Failed Only",-1)),s("span",ka,k(w("failed")),1)]),_:1,__:[10]}),V(x,{key:"paused"},{default:L(()=>[O[11]||(O[11]=s("span",null,"Paused Only",-1)),s("span",Sa,k(w("paused")),1)]),_:1,__:[11]}),V(x,{key:"draft"},{default:L(()=>[O[12]||(O[12]=s("span",null,"Draft Only",-1)),s("span",wa,k(w("draft")),1)]),_:1,__:[12]})]),_:1})]),default:L(()=>[V(q,{size:"small"},{default:L(()=>[V(W(is))]),_:1})]),_:1})]))]),b.value?A("",!0):(o(),J(na,{key:0,"model-value":p.searchQuery,"onUpdate:modelValue":O[1]||(O[1]=C=>p.$emit("update-search",C))},null,8,["model-value"])),b.value?A("",!0):(o(),f("div",Ia,[s("div",{class:ee(["status-tab",{active:r.value==="all"}]),onClick:O[2]||(O[2]=C=>r.value="all")},[O[13]||(O[13]=s("span",{class:"tab-icon"},"ðŸ“Š",-1)),O[14]||(O[14]=s("span",{class:"tab-label"},"ALL",-1)),s("span",Ra,k(p.trials.length),1)],2),s("div",{class:ee(["status-tab",{active:r.value==="active"}]),onClick:O[3]||(O[3]=C=>r.value="active")},[O[15]||(O[15]=s("span",{class:"tab-icon"},"ðŸŸ¢",-1)),O[16]||(O[16]=s("span",{class:"tab-label"},"Active",-1)),s("span",Ea,k(i.value),1)],2),s("div",{class:ee(["status-tab",{active:r.value==="done"}]),onClick:O[4]||(O[4]=C=>r.value="done")},[O[17]||(O[17]=s("span",{class:"tab-icon"},"âœ…",-1)),O[18]||(O[18]=s("span",{class:"tab-label"},"Done",-1)),s("span",Va,k(c.value),1)],2)])),s("div",Aa,[!b.value&&g.value.length>100?(o(),J(W(Ue),{key:0,class:"trial-list virtual-list",items:y.value,"size-field":"height","key-field":"id",buffer:10},{default:L(({item:C})=>[C.type==="section"?(o(),J(mt,{key:0,title:C.title,background:C.background},null,8,["title","background"])):(o(),J(vt,{key:1,trial:C,selected:C.id===p.selectedTrialId,"data-trial-id":C.id,onClick:G=>p.$emit("select-trial",C.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):b.value?(o(),f("div",Oa,[(o(!0),f(X,null,se(h.value,C=>(o(),f("div",{key:C.id,class:ee(["collapsed-item",{selected:C.id===p.selectedTrialId}]),onClick:G=>p.$emit("select-trial",C.id)},[s("div",{class:ee(["status-dot",`status-${C.status}`])},null,2),s("span",Pa,k(F(C)),1)],10,La))),128))])):(o(),f("div",Fa,[(o(!0),f(X,null,se(g.value,(C,G)=>(o(),f(X,{key:C.id||`section-${G}`},[C.type==="section"?(o(),J(mt,{key:0,title:C.title,background:C.background},null,8,["title","background"])):(o(),J(vt,{key:1,trial:C,selected:C.id===p.selectedTrialId,"data-trial-id":C.id,onClick:te=>p.$emit("select-trial",C.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),g.value.length===0&&!b.value?(o(),f("div",Ma,[V(W(rs),{class:"empty-icon"}),s("h3",null,k($.value),1),s("p",null,k(I.value),1),_.value?(o(),J(q,{key:0,type:"primary",size:"large",onClick:O[5]||(O[5]=C=>p.$emit("create-trial"))},{default:L(()=>O[19]||(O[19]=[N(" Create New Trial ")])),_:1,__:[19]})):A("",!0)])):A("",!0)])],2)}}}),xa=re(Da,[["__scopeId","data-v-46871462"]]),Ua={class:"trial-header"},Na={class:"header-main"},Wa={class:"header-title"},Ha={class:"trial-name"},za={key:0,class:"progress-container"},Ba={class:"progress-bar"},Ga={class:"progress-stats-inline"},ja={class:"progress-text"},qa={key:0,class:"progress-stat"},Ka={class:"stat-number"},Qa={key:1,class:"progress-stat"},Ya={class:"stat-number"},Ja={key:2,class:"progress-stat"},Xa={class:"stat-number"},Za=ie({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(n){const e=n,t=M(()=>{let c=e.trial.name;return c=c.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),c=c.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),c.trim()}),l=M(()=>!0),d=M(()=>e.progress?e.progress.completed+e.progress.failed:0),r=M(()=>{if(!e.progress||e.progress.total===0)return 0;const c=e.progress.completed+e.progress.failed;return Math.round(c/e.progress.total*100)}),u=M(()=>{const c=e.trial.started||e.trial.created;if(!c)return"0m";let g;if(e.trial.status==="draft")return"0m";e.trial.completed?g=e.trial.completed:g=new Date;const y=g.getTime()-c.getTime(),h=Math.floor(y/(1e3*60*60)),$=Math.floor(y%(1e3*60*60)/(1e3*60));return h>0?`${h}h ${$}m`:`${$}m`}),b=M(()=>{var g;if(!((g=e.progress)!=null&&g.avgLatencyMs))return null;const c=e.progress.avgLatencyMs;return c<1e3?`${Math.round(c)}ms`:`${(c/1e3).toFixed(1)}s`});M(()=>{var h;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let c=0;const g=((h=e.progress)==null?void 0:h.total)||e.trial.progress.total,y=Math.ceil(g/e.trial.configurations.length);return e.trial.configurations.forEach($=>{var _,w;const I=$.modelSnapshot;if((_=I==null?void 0:I.capabilities)!=null&&_.inputCostPerToken&&((w=I==null?void 0:I.capabilities)!=null&&w.outputCostPerToken)){const H=500*I.capabilities.inputCostPerToken+500*I.capabilities.outputCostPerToken;c+=H*y}}),c===0?null:(e.progress&&e.progress.completed>0&&(c=c*(e.progress.completed/g)),`$${c.toFixed(2)}`)});const i=M(()=>{var I;if(e.trial.status!=="running"||!e.progress||e.progress.completed===0)return null;const g=(Date.now()-(((I=e.trial.started)==null?void 0:I.getTime())||0))/e.progress.completed,y=e.progress.pending*g,h=Math.floor(y/(1e3*60)),$=Math.floor(y%(1e3*60)/1e3);if(h>60){const _=Math.floor(h/60),w=h%60;return`${_}h ${w}m`}return`${h}m ${$}s`});return(c,g)=>{var y;return o(),f("div",Ua,[s("div",Na,[s("div",Wa,[s("h2",Ha,k(t.value),1),s("span",{class:ee(["status-tag",`status-${c.trial.status}`])},k(c.trial.status.toUpperCase()),3)]),l.value?(o(),f("div",za,[s("div",Ba,[s("div",{class:"progress-fill",style:ge({width:`${r.value}%`})},null,4)]),s("div",Ga,[s("span",ja,k(d.value)+"/"+k(((y=c.progress)==null?void 0:y.total)||0)+" ("+k(r.value)+"%) ",1),u.value?(o(),f("span",qa,[g[0]||(g[0]=s("span",{class:"stat-label"},"Duration:",-1)),g[1]||(g[1]=N()),s("span",Ka,k(u.value),1)])):A("",!0),b.value?(o(),f("span",Qa,[g[2]||(g[2]=s("span",{class:"stat-label"},"Avg:",-1)),g[3]||(g[3]=N()),s("span",Ya,k(b.value),1)])):A("",!0),i.value?(o(),f("span",Ja,[g[4]||(g[4]=s("span",{class:"stat-label"},"Remaining:",-1)),g[5]||(g[5]=N()),s("span",Xa,"~"+k(i.value),1)])):A("",!0)])])):A("",!0)]),A("",!0)])}}}),en=re(Za,[["__scopeId","data-v-dce3a18a"]]),tn={class:"trial-actions"},sn={class:"action-group execution-controls"},an={class:"action-group data-actions"},nn={class:"action-group management-actions"},ln=ie({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(n,{emit:e}){const t=n,l=e,d=j(!1),r=j(!1),u=j(!1);M(()=>{var E;return((E=t.executionState)==null?void 0:E.currentTrialId)===t.trial.id});const b=M(()=>["draft","failed","cancelled"].includes(t.trial.status)),i=M(()=>t.trial.status==="running"),c=M(()=>t.trial.status==="paused"),g=M(()=>["running","paused"].includes(t.trial.status));function y(){l("start")}async function h(){d.value=!0,r.value=!1,l("pause"),setTimeout(()=>{d.value=!1},1e3)}async function $(){r.value=!0,d.value=!1,l("resume"),setTimeout(()=>{r.value=!1},3e3)}function I(){it.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>l("cancel")})}async function _(){u.value=!0,l("refresh"),setTimeout(()=>{u.value=!1},500)}function w({key:E}){E==="data"?l("export-data"):E==="python"&&l("export-python")}function H(){l("duplicate")}function F(){l("edit")}function T(){const E=t.trial.progress.total;it.confirm({title:"Delete trial?",content:`Delete trial and all ${E} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{l("delete")}})}return(E,v)=>{const p=Z("a-button"),O=Z("a-menu-item"),q=Z("a-menu"),x=Z("a-dropdown");return o(),f("div",tn,[s("div",sn,[b.value?(o(),J(p,{key:0,type:"primary",size:"large",disabled:!E.isLeader,onClick:y},{default:L(()=>[V(W(ot)),v[0]||(v[0]=N(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):A("",!0),i.value?(o(),J(p,{key:1,size:"large",disabled:!E.isLeader,loading:d.value,onClick:h},{default:L(()=>[d.value?A("",!0):(o(),J(W(st),{key:0})),N(" "+k(d.value?"Pausing...":"Pause"),1)]),_:1},8,["disabled","loading"])):A("",!0),c.value?(o(),J(p,{key:2,type:"primary",size:"large",disabled:!E.isLeader||r.value,loading:r.value,onClick:$},{default:L(()=>[r.value?A("",!0):(o(),J(W(ot),{key:0})),N(" "+k(r.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):A("",!0),g.value?(o(),J(p,{key:3,danger:"",size:"large",disabled:!E.isLeader,onClick:I},{default:L(()=>[V(W(us)),v[1]||(v[1]=N(" Cancel "))]),_:1,__:[1]},8,["disabled"])):A("",!0)]),s("div",an,[V(p,{size:"large",loading:u.value,onClick:_,title:"Refresh trial data from database"},{default:L(()=>[u.value?(o(),J(W($t),{key:1,spin:""})):(o(),J(W(Yt),{key:0})),N(" "+k(u.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),V(x,null,{overlay:L(()=>[V(q,{onClick:w},{default:L(()=>[V(O,{key:"data"},{default:L(()=>[V(W(ds)),v[3]||(v[3]=N(" Export Data "))]),_:1,__:[3]}),V(O,{key:"python"},{default:L(()=>[V(W(cs)),v[4]||(v[4]=N(" Export Python Script "))]),_:1,__:[4]})]),_:1})]),default:L(()=>[V(p,{size:"large"},{default:L(()=>[v[2]||(v[2]=N(" Export ")),V(W(Jt))]),_:1,__:[2]})]),_:1})]),s("div",nn,[V(p,{size:"large",disabled:!E.isLeader,onClick:H},{default:L(()=>[V(W(Ct)),v[5]||(v[5]=N(" Duplicate "))]),_:1,__:[5]},8,["disabled"]),E.trial.status==="draft"?(o(),J(p,{key:0,size:"large",disabled:!E.isLeader,onClick:F},{default:L(()=>[V(W(Xt)),v[6]||(v[6]=N(" Edit "))]),_:1,__:[6]},8,["disabled"])):A("",!0),V(p,{danger:"",size:"large",disabled:!E.isLeader,onClick:T},{default:L(()=>[V(W(Zt)),v[7]||(v[7]=N(" Delete "))]),_:1,__:[7]},8,["disabled"])])])}}}),on=re(ln,[["__scopeId","data-v-e642c431"]]),rn={class:"trial-detail-view"},un={key:0,class:"detail-content"},dn={class:"detail-section"},cn={class:"detail-grid"},pn={class:"detail-item"},fn={key:0,class:"detail-item"},vn={key:1,class:"detail-item"},mn={class:"detail-item"},gn={class:"detail-item"},hn={class:"detail-section"},bn={class:"detail-grid"},yn={key:0,class:"detail-item full-width"},_n={key:1,class:"detail-item full-width"},Tn={class:"detail-item"},$n={class:"detail-item"},Cn={key:2,class:"detail-item"},kn={key:0,class:"detail-section"},Sn={class:"detail-grid"},wn={class:"detail-item"},In={class:"detail-item"},Rn={class:"detail-item"},En={class:"detail-section"},Vn={class:"model-configs"},An={class:"config-header"},Fn=["src","alt"],On={class:"provider-name"},Ln={class:"config-details"},Pn={class:"config-item"},Mn={class:"config-params"},Dn={class:"param-list"},xn={key:0,class:"config-item"},Un={class:"cost"},Nn=ie({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(n){const e=n,t=M(()=>{const _=e.trial.started||e.trial.created,H=(e.trial.completed||new Date).getTime()-_.getTime(),F=Math.floor(H/(1e3*60*60)),T=Math.floor(H%(1e3*60*60)/(1e3*60));return F>0?`${F}h ${T}m`:`${T}m`}),l=M(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[e.trial.status]||e.trial.status),d=M(()=>{var _;return e.trial.type==="template"&&((_=e.trial.templateConfig)!=null&&_.variables)?Object.keys(e.trial.templateConfig.variables).length:0}),r=M(()=>Math.round(e.trial.progress.total*750)),u=M(()=>"text"),b=M(()=>1),i=M(()=>e.trial.progress.total/b.value);function c(_){return _?new Date(_).toLocaleString():"N/A"}function g(){var _;return((_=e.trial.templateConfig)==null?void 0:_.template)||"Unknown Template"}function y(){var _;return((_=e.trial.spreadsheetConfig)==null?void 0:_.datasetId)||"Unknown Dataset"}function h(_){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[_]||_}function $(_){}function I(_){var F;const w=_.modelSnapshot;return(F=w==null?void 0:w.capabilities)!=null&&F.inputCostPerToken?`$${((w.capabilities.inputCostPerToken+w.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(_,w)=>(o(),f("div",rn,[s("div",{class:"detail-header",onClick:w[0]||(w[0]=H=>_.$emit("toggle-collapse"))},[w[1]||(w[1]=s("h3",null,"Trial Details",-1)),V(W(es),{class:ee(["collapse-icon",{rotated:_.isCollapsed}])},null,8,["class"])]),_.isCollapsed?A("",!0):(o(),f("div",un,[s("div",dn,[w[7]||(w[7]=s("h4",null,"Basic Information",-1)),s("div",cn,[s("div",pn,[w[2]||(w[2]=s("label",null,"Created:",-1)),s("span",null,k(c(_.trial.created)),1)]),_.trial.started?(o(),f("div",fn,[w[3]||(w[3]=s("label",null,"Started:",-1)),s("span",null,k(c(_.trial.started)),1)])):A("",!0),_.trial.completed?(o(),f("div",vn,[w[4]||(w[4]=s("label",null,"Completed:",-1)),s("span",null,k(c(_.trial.completed)),1)])):A("",!0),s("div",mn,[w[5]||(w[5]=s("label",null,"Duration:",-1)),s("span",null,k(t.value),1)]),s("div",gn,[w[6]||(w[6]=s("label",null,"Status:",-1)),s("span",null,k(_.trial.status)+" - "+k(l.value),1)])])]),s("div",hn,[w[13]||(w[13]=s("h4",null,"Configuration",-1)),s("div",bn,[_.trial.type==="template"?(o(),f("div",yn,[w[8]||(w[8]=s("label",null,"Template:",-1)),s("span",null,k(g()),1)])):A("",!0),_.trial.type==="spreadsheet"?(o(),f("div",_n,[w[9]||(w[9]=s("label",null,"Dataset:",-1)),s("span",null,k(y()),1)])):A("",!0),s("div",Tn,[w[10]||(w[10]=s("label",null,"Variable Lists:",-1)),s("span",null,k(d.value)+" lists",1)]),s("div",$n,[w[11]||(w[11]=s("label",null,"Token Estimate:",-1)),s("span",null,"~"+k(r.value)+" tokens",1)]),u.value?(o(),f("div",Cn,[w[12]||(w[12]=s("label",null,"Output Type:",-1)),s("span",{class:ee(["output-type",`type-${u.value}`])},k(u.value),3)])):A("",!0)])]),b.value>1?(o(),f("div",kn,[w[17]||(w[17]=s("h4",null,"Repeat Configuration",-1)),s("div",Sn,[s("div",wn,[w[14]||(w[14]=s("label",null,"Times per prompt:",-1)),s("span",null,k(b.value),1)]),s("div",In,[w[15]||(w[15]=s("label",null,"Total combinations:",-1)),s("span",null,k(i.value),1)]),s("div",Rn,[w[16]||(w[16]=s("label",null,"Total API calls:",-1)),s("span",null,k(_.trial.progress.total),1)])])])):A("",!0),s("div",En,[w[21]||(w[21]=s("h4",null,"Model Configurations",-1)),s("div",Vn,[(o(!0),f(X,null,se(_.trial.configurations,(H,F)=>(o(),f("div",{key:F,class:"model-config-card"},[s("div",An,[(H.provider,void 0)?(o(),f("img",{key:0,src:(H.provider,void 0),alt:H.provider,class:"provider-logo"},null,8,Fn)):A("",!0),s("span",On,k(h(H.provider)),1)]),s("div",Ln,[s("div",Pn,[w[18]||(w[18]=s("label",null,"Model:",-1)),s("span",null,k(H.modelId),1)]),s("div",Mn,[w[19]||(w[19]=s("label",null,"Parameters:",-1)),s("div",Dn,[(o(!0),f(X,null,se(H.parameters,(T,E)=>(o(),f("span",{key:E,class:"param-tag"},k(E)+": "+k(T),1))),128))])]),I(H)?(o(),f("div",xn,[w[20]||(w[20]=s("label",null,"Est. Cost:",-1)),s("span",Un,k(I(H)),1)])):A("",!0)])]))),128))])])]))]))}}),Wn=re(Nn,[["__scopeId","data-v-0613b5f7"]]),Hn={class:"filter-bar"},zn={class:"search-container"},Bn=ie({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns"],setup(n,{emit:e}){const t=n,l=e,d=M(()=>{const c=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return t.showRepeatColumn&&c.splice(2,0,{key:"repeat",label:"Repeat Index"}),c}),r=M(()=>{const c={total:t.apiCalls.length,completed:0,failed:0,running:0,pending:0};return t.apiCalls.forEach(g=>{g.status==="completed"?c.completed++:g.status==="failed"?c.failed++:g.status==="running"?c.running++:g.status==="pending"&&c.pending++}),c});function u(c){var g;return((g=c.modelSnapshot)==null?void 0:g.displayName)||`${c.provider} - ${c.modelId}`}const b=Lt(c=>{const g=c.target.value;l("update:searchQuery",g)},300);function i(c){const g=[...t.visibleColumns],y=g.indexOf(c);if(y>-1)g.splice(y,1);else{const h=d.value.map(_=>_.key),$=h.indexOf(c);let I=0;for(let _=0;_<$;_++)g.includes(h[_])&&I++;g.splice(I,0,c)}l("update:visibleColumns",g)}return(c,g)=>{const y=Z("a-select-option"),h=Z("a-select"),$=Z("a-input"),I=Z("a-button"),_=Z("a-checkbox"),w=Z("a-menu-item"),H=Z("a-menu"),F=Z("a-dropdown");return o(),f("div",Hn,[V(h,{value:c.statusFilter,onChange:g[0]||(g[0]=T=>c.$emit("update:statusFilter",T)),placeholder:"Filter by status",style:{width:"150px"}},{default:L(()=>[V(y,{value:"all"},{default:L(()=>[N(" All ("+k(r.value.total)+") ",1)]),_:1}),V(y,{value:"completed"},{default:L(()=>[N(" Completed ("+k(r.value.completed)+") ",1)]),_:1}),V(y,{value:"failed"},{default:L(()=>[N(" Failed ("+k(r.value.failed)+") ",1)]),_:1}),V(y,{value:"running"},{default:L(()=>[N(" Running ("+k(r.value.running)+") ",1)]),_:1}),V(y,{value:"pending"},{default:L(()=>[N(" Pending ("+k(r.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),V(h,{value:c.configFilter,onChange:g[1]||(g[1]=T=>c.$emit("update:configFilter",T)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:L(()=>[V(y,{value:""},{default:L(()=>g[2]||(g[2]=[N("All Configurations")])),_:1,__:[2]}),(o(!0),f(X,null,se(c.configurations,(T,E)=>(o(),J(y,{key:E,value:E.toString()},{default:L(()=>[N(k(u(T)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),s("div",zn,[V($,{value:c.searchQuery,onInput:W(b),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:L(()=>[V(W(_t))]),_:1},8,["value","onInput"])]),V(F,null,{overlay:L(()=>[V(H,null,{default:L(()=>[(o(!0),f(X,null,se(d.value,T=>(o(),J(w,{key:T.key},{default:L(()=>[V(_,{checked:c.visibleColumns.includes(T.key),disabled:T.key==="status",onChange:E=>i(T.key)},{default:L(()=>[N(k(T.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:L(()=>[V(I,null,{default:L(()=>[V(W(tt)),g[3]||(g[3]=N(" Columns "))]),_:1,__:[3]})]),_:1})])}}}),Gn=re(Bn,[["__scopeId","data-v-1fdfdfd1"]]),jn={class:"modal-content"},qn={class:"section"},Kn={class:"info-grid"},Qn={class:"info-item"},Yn={class:"monospace"},Jn={class:"info-item"},Xn={class:"info-item"},Zn={key:0,class:"info-item"},el={class:"info-item"},tl={key:1,class:"info-item"},sl={key:2,class:"info-item"},al={key:3,class:"info-item"},nl={key:0,class:"info-row"},ll={class:"monospace"},ol={key:0,class:"section"},il={class:"variables-list"},rl={class:"variable-main"},ul={class:"variable-label"},dl={class:"variable-value"},cl={key:0,class:"variable-attributes"},pl={class:"attribute-label"},fl={class:"attribute-value"},vl={class:"section"},ml={class:"content-box prompt-display"},gl={key:1,class:"section"},hl={key:0,class:"error-result"},bl={key:1,class:"success-result"},yl={class:"content-box response-content"},_l={key:0,class:"parsed-content-section"},Tl={class:"content-box parsed-content"},$l={key:1,class:"refusal-warning"},Cl={class:"extraction-config-section"},kl={class:"config-grid"},Sl={key:0,class:"config-item"},wl={class:"config-value"},Il={key:1,class:"config-item"},Rl={class:"config-value pattern"},El={key:2,class:"config-item"},Vl={class:"config-value"},Al={key:3,class:"config-item"},Fl={class:"config-value"},Ol={key:4,class:"config-item no-extraction"},Ll={key:2,class:"usage-info"},Pl={class:"info-grid"},Ml={class:"info-item"},Dl={class:"info-item"},xl={class:"info-item"},Ul={key:0,class:"info-item"},Nl={class:"raw-data-section"},Wl={class:"raw-data"},Hl={key:0},zl={key:1,class:"raw-data"},Bl={key:2},Gl={key:3,class:"raw-data"},jl={class:"modal-footer"},ql=ie({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(n,{emit:e}){const t=n,l=e,d=Ze(),r=M(()=>{if(!t.apiCall.completed||!t.apiCall.created)return null;const v=new Date(t.apiCall.created).getTime();return new Date(t.apiCall.completed).getTime()-v}),u=M(()=>{const v=t.trial.configurations[t.apiCall.configurationIndex];return v?`${v.provider} / ${v.modelId}`:null}),b=M(()=>{var x,a,S;if(!((x=t.apiCall.result)!=null&&x.usage))return null;const v=t.trial.configurations[t.apiCall.configurationIndex];if(!v)return null;const p=d.models.value.find(U=>U.provider===v.provider&&U.modelId===v.modelId);if(!((a=p==null?void 0:p.capabilities)!=null&&a.inputCostPerToken)&&!((S=p==null?void 0:p.capabilities)!=null&&S.outputCostPerToken))return null;const O=(t.apiCall.result.usage.prompt_tokens||0)*(p.capabilities.inputCostPerToken||0),q=(t.apiCall.result.usage.completion_tokens||0)*(p.capabilities.outputCostPerToken||0);return O+q}),i=M(()=>{if(!t.apiCall.request)return"No request data";const v=JSON.parse(JSON.stringify(t.apiCall.request));return v.headers&&Object.keys(v.headers).forEach(p=>{(p.toLowerCase().includes("authorization")||p.toLowerCase().includes("api-key")||p.toLowerCase().includes("x-api-key"))&&(v.headers[p]="[REDACTED]")}),v.body&&typeof v.body=="object"&&(v.body.api_key&&(v.body.api_key="[REDACTED]"),v.body.apiKey&&(v.body.apiKey="[REDACTED]")),JSON.stringify(v,null,2)}),c=M(()=>t.trial.type!=="template"||!t.trial.templateConfig?{}:{outputType:t.trial.templateConfig.outputType,extractPattern:t.trial.templateConfig.extractPattern,refusalWords:t.trial.templateConfig.refusalWords,rejectRefusalWords:t.trial.templateConfig.rejectRefusalWords}),g=M(()=>{const v=c.value;return!!(v.outputType||v.extractPattern||v.refusalWords&&v.refusalWords.length>0)}),y=M(()=>t.apiCall.response?JSON.stringify({status:t.apiCall.response.status,headers:t.apiCall.response.headers,body:t.apiCall.response.body,latencyMs:t.apiCall.response.latencyMs},null,2):"No response data available"),h=M(()=>t.apiCall.result?JSON.stringify(t.apiCall.result,null,2):"No processed result available");function $(v){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[v]||"default"}function I(){var p;const v=t.trial.configurations[t.apiCall.configurationIndex];return((p=v==null?void 0:v.modelSnapshot)==null?void 0:p.displayName)||(v==null?void 0:v.modelId)||`Configuration ${t.apiCall.configurationIndex+1}`}function _(v){return(typeof v=="string"?new Date(v):v).toLocaleString()}function w(v){return v<1e3?`${v}ms`:v<6e4?`${(v/1e3).toFixed(1)}s`:`${Math.floor(v/6e4)}m ${(v%6e4/1e3).toFixed(0)}s`}function H(v){return v==null?"null":typeof v=="string"?v:typeof v=="number"||typeof v=="boolean"?String(v):JSON.stringify(v,null,2)}function F(v){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[v]||v}function T(){l("update:visible",!1)}async function E(){const v={id:t.apiCall.id,status:t.apiCall.status,configuration:I(),provider:u.value,variables:t.apiCall.variables,variableAttributes:t.apiCall.variableAttributes,prompt:t.apiCall.prompt,fullApiResponse:t.apiCall.response,processedResult:t.apiCall.result,extractionConfig:c.value,created:t.apiCall.created,completed:t.apiCall.completed,duration:r.value?`${r.value}ms`:null,cost:b.value?`$${b.value.toFixed(4)}`:null},p=JSON.stringify(v,null,2);try{await navigator.clipboard.writeText(p),oe.success("Details copied to clipboard!")}catch(O){m.error("Failed to copy to clipboard",O),oe.error("Failed to copy to clipboard")}}return(v,p)=>{const O=Z("a-tag"),q=Z("a-alert"),x=Z("a-collapse-panel"),a=Z("a-collapse"),S=Z("a-button"),U=Z("a-modal");return o(),J(U,{open:v.visible,onCancel:p[0]||(p[0]=C=>l("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:L(()=>{var C;return[s("div",jn,[s("div",qn,[p[10]||(p[10]=s("h3",null,"Overview",-1)),s("div",Kn,[s("div",Qn,[p[1]||(p[1]=s("label",null,"Call ID:",-1)),s("span",Yn,k(v.apiCall.id),1)]),s("div",Jn,[p[2]||(p[2]=s("label",null,"Status:",-1)),V(O,{color:$(v.apiCall.status)},{default:L(()=>[N(k(v.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),s("div",Xn,[p[3]||(p[3]=s("label",null,"Configuration:",-1)),s("span",null,k(I()),1)]),v.apiCall.repeatIndex!==void 0?(o(),f("div",Zn,[p[4]||(p[4]=s("label",null,"Repeat:",-1)),s("span",null,"#"+k(v.apiCall.repeatIndex+1),1)])):A("",!0),s("div",el,[p[5]||(p[5]=s("label",null,"Created:",-1)),s("span",null,k(_(v.apiCall.created)),1)]),v.apiCall.completed?(o(),f("div",tl,[p[6]||(p[6]=s("label",null,"Completed:",-1)),s("span",null,k(_(v.apiCall.completed)),1)])):A("",!0),r.value?(o(),f("div",sl,[p[7]||(p[7]=s("label",null,"Duration:",-1)),s("span",null,k(w(r.value)),1)])):A("",!0),(C=v.apiCall.result)!=null&&C.latency?(o(),f("div",al,[p[8]||(p[8]=s("label",null,"API Latency:",-1)),s("span",null,k(v.apiCall.result.latency)+"ms",1)])):A("",!0)]),u.value?(o(),f("div",nl,[p[9]||(p[9]=s("label",null,"Provider/Model:",-1)),s("span",ll,k(u.value),1)])):A("",!0)]),v.apiCall.variables&&Object.keys(v.apiCall.variables).length>0?(o(),f("div",ol,[p[11]||(p[11]=s("h3",null,"Variables",-1)),s("div",il,[(o(!0),f(X,null,se(v.apiCall.variables,(G,te)=>(o(),f("div",{key:te,class:"variable-group"},[s("div",rl,[s("label",ul,k(te)+":",1),s("span",dl,k(G),1)]),v.apiCall.variableAttributes&&v.apiCall.variableAttributes[te]?(o(),f("div",cl,[(o(!0),f(X,null,se(v.apiCall.variableAttributes[te],(R,ae)=>(o(),f("div",{key:ae,class:"attribute-item"},[s("label",pl,k(ae)+":",1),s("span",fl,k(R),1)]))),128))])):A("",!0)]))),128))])])):A("",!0),s("div",vl,[p[12]||(p[12]=s("h3",null,"Resolved Prompt",-1)),s("div",ml,k(v.apiCall.prompt),1)]),v.apiCall.result?(o(),f("div",gl,[p[25]||(p[25]=s("h3",null,"Response",-1)),v.apiCall.status==="failed"&&v.apiCall.result.error?(o(),f("div",hl,[V(q,{type:"error",message:v.apiCall.result.error,description:v.apiCall.result.errorType?`Error Type: ${F(v.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):v.apiCall.result.content?(o(),f("div",bl,[s("div",yl,k(v.apiCall.result.content),1),v.apiCall.result.parsedContent!==void 0?(o(),f("div",_l,[p[13]||(p[13]=s("h4",null,"Extracted Value",-1)),s("div",Tl,k(H(v.apiCall.result.parsedContent)),1)])):A("",!0),v.apiCall.result.refused?(o(),f("div",$l,[V(q,{type:"warning",message:"Response flagged as refusal",description:"This response matched configured refusal patterns","show-icon":""})])):A("",!0),s("div",Cl,[p[19]||(p[19]=s("h4",null,"Extraction Configuration",-1)),s("div",kl,[c.value.outputType?(o(),f("div",Sl,[p[14]||(p[14]=s("label",null,"Output Type:",-1)),s("span",wl,k(c.value.outputType),1)])):A("",!0),c.value.extractPattern?(o(),f("div",Il,[p[15]||(p[15]=s("label",null,"Extract Pattern:",-1)),s("span",Rl,k(c.value.extractPattern),1)])):A("",!0),c.value.refusalWords&&c.value.refusalWords.length>0?(o(),f("div",El,[p[16]||(p[16]=s("label",null,"Refusal Words:",-1)),s("span",Vl,k(c.value.refusalWords.join(", ")),1)])):A("",!0),c.value.rejectRefusalWords!==void 0?(o(),f("div",Al,[p[17]||(p[17]=s("label",null,"Reject on Refusal:",-1)),s("span",Fl,k(c.value.rejectRefusalWords?"Yes":"No"),1)])):A("",!0),g.value?A("",!0):(o(),f("div",Ol,p[18]||(p[18]=[s("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),v.apiCall.result.usage?(o(),f("div",Ll,[p[24]||(p[24]=s("h4",null,"Token Usage",-1)),s("div",Pl,[s("div",Ml,[p[20]||(p[20]=s("label",null,"Prompt Tokens:",-1)),s("span",null,k(v.apiCall.result.usage.prompt_tokens||0),1)]),s("div",Dl,[p[21]||(p[21]=s("label",null,"Completion Tokens:",-1)),s("span",null,k(v.apiCall.result.usage.completion_tokens||0),1)]),s("div",xl,[p[22]||(p[22]=s("label",null,"Total Tokens:",-1)),s("span",null,k(v.apiCall.result.usage.total_tokens||0),1)]),b.value?(o(),f("div",Ul,[p[23]||(p[23]=s("label",null,"Cost:",-1)),s("span",null,"$"+k(b.value.toFixed(4)),1)])):A("",!0)])])):A("",!0)])):A("",!0)])):A("",!0),V(a,{ghost:""},{default:L(()=>[V(x,{key:"raw",header:"Raw Data"},{default:L(()=>[s("div",Nl,[p[26]||(p[26]=s("h4",null,"HTTP Request",-1)),s("pre",Wl,k(i.value),1),v.apiCall.response?(o(),f("h4",Hl,"Full API Response")):A("",!0),v.apiCall.response?(o(),f("pre",zl,k(y.value),1)):A("",!0),v.apiCall.result?(o(),f("h4",Bl,"Processed Result")):A("",!0),v.apiCall.result?(o(),f("pre",Gl,k(h.value),1)):A("",!0)])]),_:1})]),_:1})]),s("div",jl,[V(S,{onClick:T,size:"large"},{default:L(()=>p[27]||(p[27]=[N(" Close ")])),_:1,__:[27]}),V(S,{type:"primary",onClick:E,size:"large"},{default:L(()=>[V(W(Ct)),p[28]||(p[28]=N(" Copy Details "))]),_:1,__:[28]})])]}),_:1},8,["open"])}}}),Kl=re(ql,[["__scopeId","data-v-bd0d6ad2"]]);class Ql{constructor(){ce(this,"apiCalls",Oe([]));ce(this,"currentTrialId",Oe(null));ce(this,"executionProgress",Oe(null));ce(this,"isStreaming",Oe(!1));ce(this,"progress",M(()=>{var g,y;const e=performance.now(),t=this.apiCalls.value;if(t.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let l=0,d=0,r=0,u=0,b=0;m.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Computing progress from ${t.length} calls in store`);for(const h of t)switch(h.status){case"completed":l++;break;case"failed":d++,(y=(g=h.result)==null?void 0:g.error)!=null&&y.includes("network");break;case"cancelled":r++;break;case"pending":u++;break;case"running":b++;break}const i=performance.now(),c={trialId:this.currentTrialId.value||"",total:t.length,completed:l,failed:d,cancelled:r,pending:u,running:b,lastUpdated:new Date};return m.info(`V4_STORE_PROGRESS: Computed in ${(i-e).toFixed(1)}ms - ${l}/${t.length} completed, ${b} running, ${u} pending`),m.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Final result - completed: ${l}, failed: ${d}, running: ${b}, pending: ${u}, total: ${t.length}`),c}));ce(this,"pivotData",M(()=>{const e=performance.now(),t=this.apiCalls.value,l={rows:[],columns:[],cells:new Map};if(t.length===0)return l;const d=new Set,r=new Set;for(const b of t){if(b.status!=="completed")continue;const i=`Config ${b.configurationIndex}`;d.add(i);const c=Object.keys(b.variables||{}),g=c.length>0?String(b.variables[c[0]]):"default";r.add(g),l.cells.has(i)||l.cells.set(i,new Map);const y=l.cells.get(i);y.has(g)||y.set(g,[]),y.get(g).push(b)}l.rows=Array.from(d).sort(),l.columns=Array.from(r).sort();const u=performance.now();return m.info(`V4_TRIAL_SWITCH: Store pivotData computed for ${t.length} calls in ${(u-e).toFixed(1)}ms`),l}));ce(this,"stats",M(()=>{var y;const e=performance.now(),t=this.apiCalls.value,l=t.length;if(l===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let d=0,r=0,u=0,b=0,i=0,c=0;for(const h of t)switch(h.status){case"completed":d++,(y=h.response)!=null&&y.latencyMs&&(i+=h.response.latencyMs,c++);break;case"failed":r++;break;case"pending":u++;break;case"running":b++;break}const g=performance.now();return m.info(`V4_TRIAL_SWITCH: Store stats computed for ${t.length} calls in ${(g-e).toFixed(1)}ms`),{total:l,completed:d,failed:r,pending:u,running:b,avgLatency:c>0?i/c:0,errorRate:l>0?r/l*100:0}}))}updateApiCalls(e){for(const t of e)switch(t.status){}this.apiCalls.value=Object.freeze(e)}updateProgress(e){m.info("STORE_V4: Updating progress:",e.type),this.executionProgress.value=e}setStreaming(e){m.info(`STORE_V4: Set streaming: ${e}`),this.isStreaming.value=e}setCurrentTrial(e){m.info(`STORE_V4: Set current trial: ${e}`),this.currentTrialId.value=e,e||this.clear()}clear(){m.info("STORE_V4: Clearing store data"),this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(e){m.info(`STORE_V4: Refreshing data from database for trial ${e}`);try{const t=await je.apiCalls.where("trialId").equals(e).toArray();m.info(`STORE_V4: Loaded ${t.length} calls from database`),t.sort((l,d)=>{const r=i=>{switch(i){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},u=r(l.status),b=r(d.status);return u!==b?u-b:l.order-d.order}),this.updateApiCalls(t),this.setCurrentTrial(e),m.info("STORE_V4: Refresh complete - store updated with fresh data")}catch(t){throw m.error("STORE_V4: Failed to refresh from database:",t),t}}}let Me=null;function Ne(){return Me||(Me=new Ql,m.info("STORE_V4: Created singleton store instance")),Me}typeof window<"u"&&(window.__trialDataStoreV4=()=>Me);const Yl={class:"trial-results-table"},Jl={class:"table-container"},Xl={class:"results-table"},Zl={key:0,class:"col-status"},eo={key:1,class:"col-configuration"},to={key:2,class:"col-repeat"},so={key:3,class:"col-variables"},ao={key:4,class:"col-response"},no={key:5,class:"col-parsed"},lo={key:6,class:"col-length"},oo={key:7,class:"col-latency"},io={class:"results-table"},ro=["onClick"],uo={key:0,class:"col-status"},co={class:"status-cell"},po={class:"status-time"},fo={key:1,class:"col-configuration"},vo={key:2,class:"col-repeat"},mo={key:3,class:"col-variables"},go={class:"variable-tags"},ho={key:0,class:"var-item"},bo={key:1,class:"var-item"},yo={key:2},_o={key:3},To={key:4,class:"col-response"},$o={class:"response-content"},Co={key:5,class:"col-parsed"},ko={key:6,class:"col-length"},So={key:7,class:"col-latency"},wo={key:1,class:"results-table"},Io={key:0,class:"col-status"},Ro={key:1,class:"col-configuration"},Eo={key:2,class:"col-repeat"},Vo={key:3,class:"col-variables"},Ao={key:4,class:"col-response"},Fo={key:5,class:"col-parsed"},Oo={key:6,class:"col-length"},Lo={key:7,class:"col-latency"},Po=["onClick"],Mo={key:0,class:"col-status"},Do={class:"status-cell"},xo={class:"status-time"},Uo={key:1,class:"col-configuration"},No={key:2,class:"col-repeat"},Wo={key:3,class:"col-variables"},Ho={class:"variable-tags"},zo={key:0,class:"var-item"},Bo={key:1,class:"var-item"},Go={key:2},jo={key:3},qo={key:4,class:"col-response"},Ko={class:"response-content"},Qo={key:5,class:"col-parsed"},Yo={key:6,class:"col-length"},Jo={key:7,class:"col-latency"},Xo={key:0},Zo=["colspan"],ei={key:0},ti={key:1},gt="trial-results-visible-columns",si=ie({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(n){const e=n,t=j("all"),l=j([]),d=j(""),r=j(["status","configuration","variables","response","parsedResponse","length","latency"]),u=j(null),b=Ne(),i=M(()=>{var a;return((a=b.apiCalls)==null?void 0:a.value)||[]}),c=M(()=>e.apiCalls||i.value);ue(c,(a,S)=>{const U=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${(S==null?void 0:S.length)||0} to ${a.length} calls`),setTimeout(()=>{const C=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(C-U).toFixed(1)}ms`)},0)});const g=a=>{if(!d.value)return a;const S=d.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),U=new RegExp(`(${S})`,"gi");return a.replace(U,"<mark>$1</mark>")},y=M(()=>{const a=performance.now();let S=[...c.value];if(t.value!=="all"&&(S=S.filter(C=>C.status===t.value)),l.value.length>0&&(S=S.filter(C=>l.value.includes(String(C.configurationIndex)))),d.value){const C=d.value.toLowerCase();S=S.filter(G=>{var te,R,ae,pe,ye;return!!((te=G.prompt)!=null&&te.toLowerCase().includes(C)||(ae=(R=G.result)==null?void 0:R.content)!=null&&ae.toLowerCase().includes(C)||(ye=(pe=G.result)==null?void 0:pe.error)!=null&&ye.toLowerCase().includes(C))})}const U=performance.now();return m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${S.length} calls in ${(U-a).toFixed(1)}ms`),S});ue(y,(a,S)=>{const U=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${(S==null?void 0:S.length)||0} to ${a.length} items`),setTimeout(()=>{const C=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(C-U).toFixed(1)}ms`)},0)});const h=M(()=>c.value),$=M(()=>c.value.length),I=M(()=>e.trial.configurations.some(a=>a.repeatCount>1)),_=M(()=>60);function w(a){}function H(a){var U;const S=e.trial.configurations[a];return S?((U=S.modelSnapshot)==null?void 0:U.displayName)||`${S.modelId}`:`Config ${a+1}`}function F(a){var S,U,C,G,te;return a.status==="pending"?"Waiting...":a.status==="running"?"Processing...":a.status==="failed"?((S=a.result)==null?void 0:S.errorType)==="refusal_detected"||((U=a.result)==null?void 0:U.error)==="REFUSED"?((C=a.result)==null?void 0:C.content)||"REFUSED":((G=a.result)==null?void 0:G.error)||"Error occurred":((te=a.result)==null?void 0:te.content)||""}function T(a){if(!a.result)return"";if(a.result.parsedContent!==void 0){const S=a.result.parsedContent;return S===null?"null":typeof S=="string"?S:typeof S=="number"||typeof S=="boolean"?String(S):JSON.stringify(S)}return""}function E(a){var C;const S=((C=a.result)==null?void 0:C.content)||"";if(!S)return"";const U=S.length;return U>1e3?`${(U/1e3).toFixed(1)}k chars`:`${U} chars`}function v(a){return a?a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`:""}function p(a){let S;switch(a.status){case"completed":case"failed":S=a.completed;break;case"running":S=a.started;break;case"pending":case"cancelled":S=a.created;break}if(!S)return"";const U=new Date(S),C=U.getHours().toString().padStart(2,"0"),G=U.getMinutes().toString().padStart(2,"0"),te=U.getSeconds().toString().padStart(2,"0");return`Â Â ${C}:${G}:${te}`}function O(a){return a?a<1e3?"latency-fast":a<5e3?"latency-medium":"latency-slow":""}function q(a){return g(a)}function x(a){u.value=a}return ue(r,a=>{localStorage.setItem(gt,JSON.stringify(a))},{deep:!0}),me(()=>{const a=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${c.value.length} calls`);const S=localStorage.getItem(gt);if(S)try{r.value=JSON.parse(S)}catch{}Te(()=>{const U=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(U-a).toFixed(1)}ms`),setTimeout(()=>{const C=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(C-a).toFixed(1)}ms`)},100)}),setTimeout(()=>{const U=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(U-a).toFixed(1)}ms`)},0)}),Ie(()=>{m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${c.value.length} calls`)}),Re(()=>{m.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),he(()=>{m.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(a,S)=>{const U=yt("dompurify-html");return o(),f("div",Yl,[V(Gn,{"status-filter":t.value,"onUpdate:statusFilter":S[0]||(S[0]=C=>t.value=C),"config-filter":l.value,"onUpdate:configFilter":S[1]||(S[1]=C=>l.value=C),"search-query":d.value,"onUpdate:searchQuery":S[2]||(S[2]=C=>d.value=C),"visible-columns":r.value,"onUpdate:visibleColumns":S[3]||(S[3]=C=>r.value=C),configurations:a.trial.configurations,"api-calls":h.value,"show-repeat-column":I.value},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),s("div",Jl,[$.value>100?(o(),J(W(Ue),{key:0,class:"results-scroller",items:y.value,"item-size":_.value,"key-field":"id",buffer:10,onVisibleRange:w},{before:L(()=>[s("table",Xl,[s("thead",null,[s("tr",null,[r.value.includes("status")?(o(),f("th",Zl,"Status")):A("",!0),r.value.includes("configuration")?(o(),f("th",eo,"Configuration")):A("",!0),r.value.includes("repeat")&&I.value?(o(),f("th",to,"Repeat")):A("",!0),r.value.includes("variables")?(o(),f("th",so,"Variables")):A("",!0),r.value.includes("response")?(o(),f("th",ao,"Response")):A("",!0),r.value.includes("parsedResponse")?(o(),f("th",no,"Parsed Response")):A("",!0),r.value.includes("length")?(o(),f("th",lo,"Length")):A("",!0),r.value.includes("latency")?(o(),f("th",oo,"Latency")):A("",!0)])])])]),default:L(({item:C})=>{var G,te;return[s("table",io,[s("tbody",null,[s("tr",{class:ee(["result-row",`status-${C.status}`]),onClick:R=>x(C)},[r.value.includes("status")?(o(),f("td",uo,[s("div",co,[s("span",{class:ee(["status-tag",`status-${C.status}`])},k(C.status.toUpperCase()),3),s("span",po,k(p(C)),1)])])):A("",!0),r.value.includes("configuration")?(o(),f("td",fo,k(H(C.configurationIndex)),1)):A("",!0),r.value.includes("repeat")&&I.value?(o(),f("td",vo," #"+k((C.repeatIndex||0)+1),1)):A("",!0),r.value.includes("variables")?(o(),f("td",mo,[s("div",go,[(o(!0),f(X,null,se(Object.entries(C.variables),([R,ae],pe)=>(o(),f(X,{key:R},[S[6]||(S[6]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(C.variables).length<=2?(o(),f("span",ho,k(R)+": "+k(ae),1)):(o(),f("span",bo,k(ae),1)),Object.keys(C.variables).length===2&&pe===0?(o(),f("span",yo,S[5]||(S[5]=[s("br",null,null,-1)]))):pe<Object.keys(C.variables).length-1?(o(),f("span",_o,k("Â Â "))):A("",!0)],64))),128))])])):A("",!0),r.value.includes("response")?(o(),f("td",To,[Ce(s("div",$o,null,512),[[U,q(F(C)),"apiResponse"]])])):A("",!0),r.value.includes("parsedResponse")?(o(),f("td",Co,k(T(C)),1)):A("",!0),r.value.includes("length")?(o(),f("td",ko,k(E(C)),1)):A("",!0),r.value.includes("latency")?(o(),f("td",So,[s("span",{class:ee(O((G=C.response)==null?void 0:G.latencyMs))},k(v((te=C.response)==null?void 0:te.latencyMs)),3)])):A("",!0)],10,ro)])])]}),_:1},8,["items","item-size"])):(o(),f("table",wo,[s("thead",null,[s("tr",null,[r.value.includes("status")?(o(),f("th",Io,"Status")):A("",!0),r.value.includes("configuration")?(o(),f("th",Ro,"Configuration")):A("",!0),r.value.includes("repeat")&&I.value?(o(),f("th",Eo,"Repeat")):A("",!0),r.value.includes("variables")?(o(),f("th",Vo,"Variables")):A("",!0),r.value.includes("response")?(o(),f("th",Ao,"Response")):A("",!0),r.value.includes("parsedResponse")?(o(),f("th",Fo,"Parsed Response")):A("",!0),r.value.includes("length")?(o(),f("th",Oo,"Length")):A("",!0),r.value.includes("latency")?(o(),f("th",Lo,"Latency")):A("",!0)])]),s("tbody",null,[(o(!0),f(X,null,se(y.value,C=>{var G,te;return o(),f("tr",{key:C.id,class:ee(["result-row",`status-${C.status}`]),onClick:R=>x(C)},[r.value.includes("status")?(o(),f("td",Mo,[s("div",Do,[s("span",{class:ee(["status-tag",`status-${C.status}`])},k(C.status.toUpperCase()),3),s("span",xo,k(p(C)),1)])])):A("",!0),r.value.includes("configuration")?(o(),f("td",Uo,k(H(C.configurationIndex)),1)):A("",!0),r.value.includes("repeat")&&I.value?(o(),f("td",No," #"+k((C.repeatIndex||0)+1),1)):A("",!0),r.value.includes("variables")?(o(),f("td",Wo,[s("div",Ho,[(o(!0),f(X,null,se(C.variables,(R,ae,pe)=>(o(),f(X,{key:ae},[S[8]||(S[8]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(C.variables).length<=2?(o(),f("span",zo,k(ae)+": "+k(R),1)):(o(),f("span",Bo,k(R),1)),Object.keys(C.variables).length===2&&pe===0?(o(),f("span",Go,S[7]||(S[7]=[s("br",null,null,-1)]))):pe<Object.keys(C.variables).length-1?(o(),f("span",jo,k("Â Â "))):A("",!0)],64))),128))])])):A("",!0),r.value.includes("response")?(o(),f("td",qo,[Ce(s("div",Ko,null,512),[[U,q(F(C)),"apiResponse"]])])):A("",!0),r.value.includes("parsedResponse")?(o(),f("td",Qo,k(T(C)),1)):A("",!0),r.value.includes("length")?(o(),f("td",Yo,k(E(C)),1)):A("",!0),r.value.includes("latency")?(o(),f("td",Jo,[s("span",{class:ee(O((G=C.response)==null?void 0:G.latencyMs))},k(v((te=C.response)==null?void 0:te.latencyMs)),3)])):A("",!0)],10,Po)}),128)),y.value.length===0?(o(),f("tr",Xo,[s("td",{colspan:r.value.length,class:"empty-state"},[i.value.length===0?(o(),f("div",ei," No API calls yet. Start the trial to begin execution. ")):(o(),f("div",ti," No results match your filters. "))],8,Zo)])):A("",!0)])]))]),u.value?(o(),J(Kl,{key:0,visible:!!u.value,"api-call":u.value,trial:a.trial,"onUpdate:visible":S[4]||(S[4]=C=>u.value=null)},null,8,["visible","api-call","trial"])):A("",!0)])}}}),ai=re(si,[["__scopeId","data-v-95899931"]]),ni={class:"trial-analysis-view"},li=ie({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(n){const e=n;return me(()=>{const t=performance.now();m.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${e.trial.id}`),Te(()=>{const l=performance.now();m.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(l-t).toFixed(1)}ms`)}),setTimeout(()=>{const l=performance.now();m.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(l-t).toFixed(1)}ms`)},0)}),Ie(()=>{m.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Re(()=>{m.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${e.trial.id}`)}),he(()=>{m.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(t,l)=>(o(),f("div",ni,[V(ai,{trial:t.trial,progress:t.progress,"is-executing":t.isExecuting,"api-calls":t.apiCalls,"is-streaming":t.isStreaming,"is-loading":t.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),oi=re(li,[["__scopeId","data-v-602f5d5a"]]);function ii(n,e){const t=new Set,l=new Set,d=new Set;n.forEach(g=>{g.variables&&Object.keys(g.variables).forEach(y=>t.add(y)),g.variableAttributes&&Object.values(g.variableAttributes).forEach(y=>{y&&Object.keys(y).forEach(h=>l.add(h))})});const r=Array.from(t).sort(),u=Array.from(l).sort(),b=Array.from(d).sort(),i=[],c=["success","refused","parsed_response",...i,...b];return{categorical:[...r,...u,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...i].sort(),extracted:c}}function we(n,e,t){var l,d,r,u,b,i,c,g,y,h,$,I,_,w,H,F,T,E,v,p,O;switch(e){case"model":return t&&n.configurationIndex<t.configurations.length&&t.configurations[n.configurationIndex].modelId||"Unknown";case"status":return n.status;case"response_time":return((l=n.response)==null?void 0:l.latencyMs)||0;case"total_tokens":if((r=(d=n.response)==null?void 0:d.body)!=null&&r.usage){const q=n.response.body.usage;return q.total_tokens||q.prompt_tokens+q.completion_tokens||0}return 0;case"prompt_tokens":return((i=(b=(u=n.response)==null?void 0:u.body)==null?void 0:b.usage)==null?void 0:i.prompt_tokens)||((y=(g=(c=n.response)==null?void 0:c.body)==null?void 0:g.usage)==null?void 0:y.input_tokens)||0;case"completion_tokens":return((I=($=(h=n.response)==null?void 0:h.body)==null?void 0:$.usage)==null?void 0:I.completion_tokens)||((H=(w=(_=n.response)==null?void 0:_.body)==null?void 0:w.usage)==null?void 0:H.output_tokens)||0;case"error_type":return((F=n.result)==null?void 0:F.errorType)||(((T=n.result)==null?void 0:T.success)===!1?"api_error":"success");case"success":return(E=n.result)!=null&&E.success?1:0;case"refused":return(v=n.result)!=null&&v.refused?1:0;case"parsed_response":if(((p=n.result)==null?void 0:p.parsedContent)!==void 0){const q=n.result.parsedContent;return typeof q=="object"?JSON.stringify(q):q}return null}if(((O=n.variables)==null?void 0:O[e])!==void 0)return n.variables[e];if(n.variableAttributes)for(const q of Object.keys(n.variableAttributes)){const x=n.variableAttributes[q];if(x&&x[e]!==void 0)return x[e]}return null}const Ee={count:{label:"Count",calculate:n=>n.length,format:n=>n.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},mean:{label:"Mean",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0)/e.length:null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},median:{label:"Median",calculate:n=>{const e=n.map(d=>typeof d=="number"?d:null).filter(d=>d!==null);if(e.length===0)return null;const t=[...e].sort((d,r)=>d-r),l=Math.floor(t.length/2);return t.length%2===0?(t[l-1]+t[l])/2:t[l]},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},mode:{label:"Mode",calculate:n=>{if(n.length===0)return null;const e=new Map;n.forEach(d=>e.set(d,(e.get(d)||0)+1));let t=0,l=null;return e.forEach((d,r)=>{d>t&&(t=d,l=r)}),{value:l,count:t,total:n.length}},format:n=>n?`${n.value} (${n.count}/${n.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:n=>{const e=n.map(d=>typeof d=="number"?d:null).filter(d=>d!==null);if(e.length<=1)return null;const t=e.reduce((d,r)=>d+r,0)/e.length;return e.reduce((d,r)=>d+Math.pow(r-t,2),0)/(e.length-1)},format:n=>(n==null?void 0:n.toFixed(3))||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:n=>{const e=Ee.variance.calculate(n);return e!==null?Math.sqrt(e):null},format:n=>(n==null?void 0:n.toFixed(3))||"-",needsNumeric:!0},min:{label:"Min",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.min(...e):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},max:{label:"Max",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.max(...e):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(n,e)=>{const t=e.filter(l=>{var d;return(d=l.result)==null?void 0:d.success}).length;return e.length>0?t/e.length:0},format:n=>`${Math.round(n*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(n,e)=>{const t=e.filter(l=>{var d;return(d=l.result)==null?void 0:d.refused}).length;return e.length>0?t/e.length:0},format:n=>`${Math.round(n*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(n,e)=>{const t=e.filter(l=>{var d;return(d=l.response)==null?void 0:d.latencyMs}).map(l=>l.response.latencyMs);return t.length>0?t.reduce((l,d)=>l+d,0)/t.length:null},format:n=>n?`${Math.round(n)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function ht(n,e,t){const l=new Map,d=new Set,r=new Set;n.forEach(I=>{const _=String(we(I,e.rowField,t)||"Unknown"),w=String(we(I,e.columnField,t)||"Unknown");d.add(_),r.add(w),l.has(_)||l.set(_,new Map),l.get(_).has(w)||l.get(_).set(w,[]),l.get(_).get(w).push(I)});const u=I=>I.every(w=>!isNaN(Number(w))&&w.trim()!=="")?I.sort((w,H)=>Number(w)-Number(H)):I.sort(),b=(I,_)=>(t&&(t.type,t.type),u(I)),i=e.rowSort==="original"?b(Array.from(d),e.rowField):u(Array.from(d)),c=e.columnSort==="original"?b(Array.from(r),e.columnField):u(Array.from(r)),g=Ee[e.aggregation];function y(I){const _=I.map(T=>we(T,e.valueField,t));if(!g||typeof g.calculate!="function")return m.error("Invalid aggregation function:",e.aggregation,g),{value:null,count:I.length,apiCalls:I,rawValues:_,error:"Invalid aggregation function"};const w={nonNumeric:0,nullUndefined:0};return g.needsNumeric&&(w.nonNumeric=_.filter(T=>typeof T!="number").length),w.nullUndefined=_.filter(T=>T==null).length,{value:g.usesApiCalls?g.calculate(_,I):g.calculate(_),count:I.length,apiCalls:I,rawValues:_,excludedCounts:w}}const h=i.map(I=>{const _=[],w=[];return c.forEach(H=>{var T;const F=((T=l.get(I))==null?void 0:T.get(H))||[];_.push(F.length>0?y(F):null),w.push(...F)}),{label:I,cells:_,total:y(w)}}),$=c.map(I=>{const _=[];return i.forEach(w=>{var F;const H=((F=l.get(w))==null?void 0:F.get(I))||[];_.push(...H)}),y(_)});return{rows:h,columns:c,totals:$,grandTotal:y(n)}}function be(n,e){return!n||n.value===null?"-":Ee[e].format(n.value)}function ri(n,e,t,l=j({}),d={}){const{debounceMs:r=100}=d,u=j({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),b=j({categorical:[],numeric:[],extracted:[]}),i=j(!1),c=j(0),g=M(()=>{const I=l.value;return Object.values(I).some(w=>w!=="")?n.value.filter(w=>{var H;if(I.model&&I.model!==""&&(!t.value||w.configurationIndex>=t.value.configurations.length||(t.value.configurations[w.configurationIndex].modelId||"Unknown")!==I.model)||I.status&&I.status!==""&&w.status!==I.status)return!1;for(const[F,T]of Object.entries(I))if(T&&T!==""&&F!=="model"&&F!=="status"&&((H=w.variables)==null?void 0:H[F])!==T)return!1;return!0}):n.value}),y=ze(()=>{if(g.value.length===0){u.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}i.value=!0;const I=performance.now();try{u.value=ht(g.value,e.value,t.value);const _=performance.now()-I;c.value=_,m.debug("Pivot data computed (config change)",{apiCallCount:g.value.length,computeTimeMs:_,rowCount:u.value.rows.length,columnCount:u.value.columns.length})}catch(_){m.error("Error computing pivot data",_)}finally{i.value=!1}},r),h=ze(()=>{if(g.value.length===0){u.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}i.value=!0;const I=performance.now();try{u.value=ht(g.value,e.value,t.value);const _=performance.now()-I;c.value=_,m.debug("Pivot data computed (stream update)",{apiCallCount:g.value.length,computeTimeMs:_,rowCount:u.value.rows.length,columnCount:u.value.columns.length})}catch(_){m.error("Error computing pivot data",_)}finally{i.value=!1}},1e3),$=ze(()=>{b.value=ii(n.value,t.value)},200);return ue([e],()=>{h.cancel(),y()},{deep:!0}),ue(()=>g.value,(I,_)=>{m.info(`PIVOT_DEBUG: filteredApiCalls changed from ${(_==null?void 0:_.length)||0} to ${I.length}`),h()},{immediate:!1}),ue(()=>[n.value,t.value],()=>{m.info("PIVOT_DEBUG: apiCalls or trial changed, updating fields"),$(),h()},{immediate:!1}),$(),y(),{pivotData:M(()=>u.value),availableFields:M(()=>b.value),isComputing:M(()=>i.value),lastComputeTime:M(()=>c.value),formatCellValue:be,extractFieldValue:we,aggregationFunctions:Ee}}const ui={class:"pivot-config-v3"},di={class:"config-row"},ci={class:"config-group"},pi=["value","aria-label"],fi={label:"Categorical"},vi=["value"],mi={class:"config-group sort-group"},gi=["value","aria-label"],hi={class:"config-group"},bi=["value","aria-label"],yi={label:"Categorical"},_i=["value"],Ti={class:"config-group sort-group"},$i=["value","aria-label"],Ci={class:"config-group"},ki=["value","aria-label"],Si={label:"Extracted Values"},wi=["value"],Ii={label:"Numeric Fields"},Ri=["value"],Ei={class:"config-group"},Vi=["value","aria-label"],Ai=ie({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(n,{emit:e}){const t=e;function l(r,u){t("update-config",r,u)}function d(r){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[r]||r.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase())}return(r,u)=>(o(),f("div",ui,[s("div",di,[s("div",ci,[u[6]||(u[6]=s("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),s("select",{id:"pivot-row-field",value:r.config.rowField,"aria-label":"Group rows by "+d(r.config.rowField),onChange:u[0]||(u[0]=b=>l("rowField",b.target.value))},[s("optgroup",fi,[(o(!0),f(X,null,se(r.availableFields.categorical,b=>(o(),f("option",{key:b,value:b},k(d(b)),9,vi))),128))])],40,pi)]),s("div",mi,[u[8]||(u[8]=s("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),s("select",{id:"pivot-row-sort",value:r.config.rowSort||"original","aria-label":"Sort rows by "+(r.config.rowSort||"original")+" order",onChange:u[1]||(u[1]=b=>l("rowSort",b.target.value))},u[7]||(u[7]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,gi)]),s("div",hi,[u[9]||(u[9]=s("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),s("select",{id:"pivot-column-field",value:r.config.columnField,"aria-label":"Group columns by "+d(r.config.columnField),onChange:u[2]||(u[2]=b=>l("columnField",b.target.value))},[s("optgroup",yi,[(o(!0),f(X,null,se(r.availableFields.categorical,b=>(o(),f("option",{key:b,value:b},k(d(b)),9,_i))),128))])],40,bi)]),s("div",Ti,[u[11]||(u[11]=s("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),s("select",{id:"pivot-column-sort",value:r.config.columnSort||"original","aria-label":"Sort columns by "+(r.config.columnSort||"original")+" order",onChange:u[3]||(u[3]=b=>l("columnSort",b.target.value))},u[10]||(u[10]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,$i)]),s("div",Ci,[u[12]||(u[12]=s("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),s("select",{id:"pivot-value-field",value:r.config.valueField,"aria-label":"Aggregate "+r.config.valueField+" values",onChange:u[4]||(u[4]=b=>l("valueField",b.target.value))},[s("optgroup",Si,[(o(!0),f(X,null,se(r.availableFields.extracted,b=>(o(),f("option",{key:b,value:b},k(b),9,wi))),128))]),s("optgroup",Ii,[(o(!0),f(X,null,se(r.availableFields.numeric,b=>(o(),f("option",{key:b,value:b},k(d(b)),9,Ri))),128))])],40,ki)]),s("div",Ei,[u[14]||(u[14]=s("label",{for:"pivot-aggregation"},"Aggregation:",-1)),s("select",{id:"pivot-aggregation",value:r.config.aggregation,"aria-label":"Aggregation method: "+r.config.aggregation,onChange:u[5]||(u[5]=b=>l("aggregation",b.target.value))},u[13]||(u[13]=[kt('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,Vi)])])]))}}),Fi=re(Ai,[["__scopeId","data-v-0d3a0d50"]]),Oi={class:"heatmap-controls-v3"},Li={class:"color-scale-selector"},Pi=["value","aria-label"],Mi={class:"gradient-mode-selector"},Di={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},xi=["aria-pressed"],Ui=["aria-pressed"],Ni=["aria-pressed"],Wi=["title","aria-label"],Hi=ie({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(n,{emit:e}){const t=e;function l(r){const u=r.target.value;t("update-color-scale",u)}function d(r){t("update-gradient-mode",r)}return(r,u)=>(o(),f("div",Oi,[s("div",Li,[u[5]||(u[5]=s("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),s("select",{id:"heatmap-color-scale",value:r.selectedColorScale,"aria-label":"Color scale: "+r.selectedColorScale,onChange:l},u[4]||(u[4]=[kt('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,Pi)]),s("div",Mi,[u[6]||(u[6]=s("label",null,"Gradient Mode:",-1)),s("div",Di,[s("button",{type:"button",class:ee(["toggle-btn",{active:r.gradientMode==="global"}]),"aria-pressed":r.gradientMode==="global",onClick:u[0]||(u[0]=b=>d("global"))}," Global ",10,xi),s("button",{type:"button",class:ee(["toggle-btn",{active:r.gradientMode==="column"}]),"aria-pressed":r.gradientMode==="column",onClick:u[1]||(u[1]=b=>d("column"))}," Per Column ",10,Ui),s("button",{type:"button",class:ee(["toggle-btn",{active:r.gradientMode==="row"}]),"aria-pressed":r.gradientMode==="row",onClick:u[2]||(u[2]=b=>d("row"))}," Per Row ",10,Ni)])]),s("button",{type:"button",class:"fullscreen-btn",title:r.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":r.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:u[3]||(u[3]=b=>r.$emit("toggle-fullscreen"))},k(r.isFullscreen?"âŠŸ":"âŠž"),9,Wi)]))}}),zi=re(Hi,[["__scopeId","data-v-dcb6369b"]]),Bi={class:"pivot-filters-v3"},Gi={class:"filters-row"},ji={key:0,class:"filter-group"},qi=["value"],Ki=["value"],Qi=["for"],Yi=["id","value","aria-label","onChange"],Ji={value:""},Xi=["value"],Zi={key:1,class:"filter-group"},er=["value"],tr=["value"],sr=ie({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(n,{emit:e}){const t=n,l=e,d=j({});let r=0;const u=()=>{if(t.apiCalls.length===0){d.value={};return}const y={};t.apiCalls.forEach($=>{if(t.trial&&$.configurationIndex<t.trial.configurations.length){const _=t.trial.configurations[$.configurationIndex].modelId||"Unknown";y.model||(y.model=new Set),y.model.add(_)}$.status&&(y.status||(y.status=new Set),y.status.add($.status)),$.variables&&Object.entries($.variables).forEach(([I,_])=>{_&&String(_).trim()&&(y[I]||(y[I]=new Set),y[I].add(String(_)))})});const h={};Object.entries(y).forEach(([$,I])=>{h[$]=Array.from(I).sort()}),d.value=h};ue(()=>t.apiCalls.length,y=>{(y===0||r===0||y-r>=5)&&(u(),r=y)},{immediate:!0});const b=M(()=>{const{model:y,status:h,...$}=d.value;return $}),i=M(()=>Object.values(t.activeFilters).some(y=>y!==""));function c(y){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[y]||y.replace(/_/g," ").replace(/\b\w/g,$=>$.toUpperCase())}function g(y,h){const $={...t.activeFilters};h===""?delete $[y]:$[y]=h,l("update-filters",$)}return(y,h)=>(o(),f("div",Bi,[s("div",Gi,[d.value.model&&d.value.model.length>1?(o(),f("div",ji,[h[4]||(h[4]=s("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),s("select",{id:"filter-model",value:y.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:h[0]||(h[0]=$=>g("model",$.target.value))},[h[3]||(h[3]=s("option",{value:""},"All Models",-1)),(o(!0),f(X,null,se(d.value.model,$=>(o(),f("option",{key:$,value:$},k($),9,Ki))),128))],40,qi)])):A("",!0),(o(!0),f(X,null,se(b.value,($,I)=>(o(),f("div",{key:I,class:"filter-group"},[s("label",{for:`filter-${I}`,class:"filter-label"},k(c(String(I)))+": ",9,Qi),s("select",{id:`filter-${I}`,value:y.activeFilters[I]||"",class:"filter-select","aria-label":`Filter by ${c(String(I))}`,onChange:_=>g(String(I),_.target.value)},[s("option",Ji,"All "+k(c(String(I))),1),(o(!0),f(X,null,se($,_=>(o(),f("option",{key:_,value:_},k(_),9,Xi))),128))],40,Yi)]))),128)),d.value.status&&d.value.status.length>1?(o(),f("div",Zi,[h[6]||(h[6]=s("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),s("select",{id:"filter-status",value:y.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:h[1]||(h[1]=$=>g("status",$.target.value))},[h[5]||(h[5]=s("option",{value:""},"All Statuses",-1)),(o(!0),f(X,null,se(d.value.status,$=>(o(),f("option",{key:$,value:$},k($),9,tr))),128))],40,er)])):A("",!0),i.value?(o(),f("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:h[2]||(h[2]=$=>y.$emit("clear-filters"))}," Clear Filters ")):A("",!0)])]))}}),ar=re(sr,[["__scopeId","data-v-99c57ee0"]]),nr={class:"collapse-icon"},lr={class:"options-content"},or={class:"controls-row"},ir={key:0,class:"performance-info"},rr={class:"table-view"},ur={key:0,class:"empty-state","data-testid":"empty-data-message"},dr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},cr={key:2,class:"loading-state","data-testid":"computing-state"},pr={key:3,class:"pivot-table-container"},fr={class:"pivot-table-grid responsive-table",role:"table"},vr={role:"row"},mr={class:"corner-cell",role:"columnheader"},gr={key:0,class:"total-header",role:"columnheader"},hr={class:"row-header",role:"rowheader"},br=["data-testid","title","aria-label","role","onClick","onKeydown"],yr={key:0,class:"cell-content"},_r=["title"],Tr={class:"cell-value"},$r={class:"error-message"},Cr={key:1},kr=ie({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(n,{emit:e}){var R,ae,pe,ye,ke,Ve;const t=n,l=e,d=j(!1),r=j("viridis"),u=j("global"),b=j(!1),i=j({rowField:((R=t.config)==null?void 0:R.rowField)||"",columnField:((ae=t.config)==null?void 0:ae.columnField)||"",valueField:((pe=t.config)==null?void 0:pe.valueField)||"",aggregation:((ye=t.config)==null?void 0:ye.aggregation)||"mean",rowSort:((ke=t.config)==null?void 0:ke.rowSort)||"original",columnSort:((Ve=t.config)==null?void 0:Ve.columnSort)||"original"});ue(()=>t.config,z=>{z&&Object.assign(i.value,z)},{deep:!0});const c=j({}),g=Ne(),y=M(()=>g.apiCalls?g.apiCalls.value||[]:t.apiCalls||[]),h=y,$=M(()=>t.trial),{pivotData:I,availableFields:_,isComputing:w,lastComputeTime:H}=ri(h,i,$,c,{debounceMs:750});ue(I,(z,K)=>{var fe,Ae;const B=performance.now(),Q=((fe=z==null?void 0:z.rows)==null?void 0:fe.length)||0,de=((Ae=z==null?void 0:z.columns)==null?void 0:Ae.length)||0;m.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${Q}x${de} matrix`),setTimeout(()=>{const We=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(We-B).toFixed(1)}ms`)},0)}),ue(w,z=>{z?m.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${y.value.length} API calls`):m.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${H.value.toFixed(1)}ms`)}),ue(y,(z,K)=>{const B=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${(K==null?void 0:K.length)||0} to ${z.length} calls`),setTimeout(()=>{const Q=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(Q-B).toFixed(1)}ms`)},0)});const F=M(()=>I.value.rows.slice(0,t.maxTableRows)),T=M(()=>Object.values(c.value).some(K=>K!=="")?y.value.filter(K=>{var B;if(c.value.model&&c.value.model!==""&&(!t.trial||K.configurationIndex>=t.trial.configurations.length||(t.trial.configurations[K.configurationIndex].modelId||"Unknown")!==c.value.model)||c.value.status&&c.value.status!==""&&K.status!==c.value.status)return!1;for(const[Q,de]of Object.entries(c.value))if(de&&de!==""&&Q!=="model"&&Q!=="status"&&((B=K.variables)==null?void 0:B[Q])!==de)return!1;return!0}).length:y.value.length),{getCellStyle:E,getSummaryStyle:v,styleKey:p}=ms(I,r,u);function O(z){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[z]||z.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase())}function q(z,K,B){if(!B)return`${z} Ã— ${K}: No data`;const Q=be(B,i.value.aggregation);let de=`${z} Ã— ${K}: ${Q} (${B.count} calls)`;if(B.excludedCounts){const fe=[];B.excludedCounts.nonNumeric>0&&fe.push(`${B.excludedCounts.nonNumeric} non-numeric responses excluded`),B.excludedCounts.nullUndefined>0&&fe.push(`${B.excludedCounts.nullUndefined} null/empty responses`),fe.length>0&&(de+=` | ${fe.join(", ")}`)}return B.error&&(de+=` - ERROR: ${B.error}`),de}function x(z,K,B){if(!B)return`${z} by ${K}: No data`;const Q=be(B,i.value.aggregation);return B.error?`${z} by ${K}: ${Q} with data integrity error: ${B.error}`:`${z} by ${K}: ${Q} from ${B.count} API calls`}function a(z,K){(z==="rowField"||z==="columnField"||z==="valueField"||z==="aggregation"||z==="rowSort"||z==="columnSort")&&(i.value[z]=K),l("config-change",{...i.value})}function S(z){c.value={...z}}function U(){c.value={}}function C(z,K,B){B&&l("cell-click",{row:z,column:K,cell:B})}function G(){b.value=!b.value}function te(){d.value=!d.value,d.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return me(()=>{var K;const z=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${((K=t.trial)==null?void 0:K.id)||"unknown"} with ${y.value.length} calls`),Te(()=>{const B=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(B-z).toFixed(1)}ms`)}),setTimeout(()=>{const B=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(B-z).toFixed(1)}ms`)},0)}),Ie(()=>{var z;m.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${((z=t.trial)==null?void 0:z.id)||"unknown"} with ${y.value.length} calls`)}),Re(()=>{var z;m.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${((z=t.trial)==null?void 0:z.id)||"unknown"}`)}),he(()=>{var z;m.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${((z=t.trial)==null?void 0:z.id)||"unknown"}`),d.value&&(document.body.style.overflow="")}),ue([_,y],([z])=>{if(y.value.length>0&&(!i.value.rowField||i.value.rowField==="")&&z.categorical.length>0){if(i.value.rowField=z.categorical.find(K=>K!=="model"&&K!=="status"&&K!=="error_type")||z.categorical[0]||"model",i.value.columnField=i.value.columnField||"model",i.value.valueField=i.value.valueField||"parsed_response",!i.value.aggregation||i.value.aggregation===""){const K=y.value.slice(0,3).map(Q=>we(Q,i.value.valueField,t.trial)).filter(Q=>Q!=null),B=K.length>0&&K.every(Q=>typeof Q=="number");i.value.aggregation=B?"mean":"mode"}l("config-change",{...i.value})}},{immediate:!0}),(z,K)=>(o(),f("div",{class:ee(["pivot-table-v3",{fullscreen:d.value}])},[s("div",{class:ee(["pivot-options-container",{collapsed:b.value}])},[s("div",{class:"options-header",onClick:G},[K[3]||(K[3]=s("span",{class:"options-title"},"Pivot Table Options",-1)),s("span",nr,k(b.value?"â–¶":"â–¼"),1)]),Ce(s("div",lr,[ts([W(_),i.value],()=>(o(),f("div",null,[V(Fi,{config:i.value,"available-fields":W(_),onUpdateConfig:a},null,8,["config","available-fields"])])),K,0),s("div",or,[y.value.length>0?(o(),J(ar,{key:0,"api-calls":y.value,trial:z.trial,"active-filters":c.value,onUpdateFilters:S,onClearFilters:U},null,8,["api-calls","trial","active-filters"])):A("",!0),V(zi,{"selected-color-scale":r.value,"gradient-mode":u.value,"is-fullscreen":d.value,onUpdateColorScale:K[1]||(K[1]=B=>r.value=B),onUpdateGradientMode:K[2]||(K[2]=B=>u.value=B),onToggleFullscreen:te},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[St,!b.value]])],2),z.showPerformanceInfo?(o(),f("div",ir,[s("span",null,"Computing: "+k(W(w)?"Yes":"No"),1),s("span",null,"Last Compute: "+k(W(H).toFixed(1))+"ms",1),s("span",null,"API Calls: "+k(y.value.length),1),s("span",null,"Filtered: "+k(T.value),1)])):A("",!0),s("div",rr,[y.value.length===0?(o(),f("div",ur,K[4]||(K[4]=[s("p",null,"No data available for pivot table analysis.",-1)]))):i.value.aggregation in W(Ee)?W(w)?(o(),f("div",cr,K[6]||(K[6]=[s("p",null,"Computing pivot table...",-1)]))):(o(),f("div",pr,[s("table",fr,[s("thead",null,[s("tr",vr,[s("th",mr,k(O(i.value.rowField)||"Items")+" / "+k(O(i.value.columnField)||"Aggregated"),1),(o(!0),f(X,null,se(W(I).columns,B=>(o(),f("th",{key:B,class:"column-header",role:"columnheader"},k(B),1))),128)),i.value.columnField&&z.showTotals?(o(),f("th",gr," Total ")):A("",!0)])]),s("tbody",null,[(o(!0),f(X,null,se(F.value,B=>(o(),f("tr",{key:`${B.label}-${W(p)}`,class:"data-row",role:"row"},[s("td",hr,k(B.label),1),(o(!0),f(X,null,se(B.cells,(Q,de)=>(o(),f("td",{key:`${de}-${W(p)}`,class:ee(["data-cell",{"error-cell":Q==null?void 0:Q.error}]),"data-testid":Q!=null&&Q.error?"pivot-cell-error":"pivot-cell",style:ge(W(E)(Q,B.label,de)),title:q(B.label,W(I).columns[de],Q),"aria-label":x(B.label,W(I).columns[de],Q),role:Q!=null&&Q.error?"alert":"cell",tabindex:"0",onClick:fe=>C(B.label,W(I).columns[de],Q),onKeydown:[Ge(fe=>C(B.label,W(I).columns[de],Q),["enter"]),Ge(wt(fe=>C(B.label,W(I).columns[de],Q),["prevent"]),["space"])]},[Q!=null&&Q.error?(o(),f("div",yr,[s("span",{class:"error-indicator",title:Q.error},"âš ï¸",8,_r),s("span",Tr,k(Q?W(be)(Q,i.value.aggregation):"-"),1),s("div",$r,k(Q.error),1)])):(o(),f("span",Cr,k(Q?W(be)(Q,i.value.aggregation):"-"),1))],46,br))),128)),i.value.columnField&&z.showTotals?(o(),f("td",{key:0,class:"total-cell",style:ge(W(v)(B.total)),role:"cell"},k(W(be)(B.total,i.value.aggregation)),5)):A("",!0)]))),128)),i.value.rowField&&z.showTotals?(o(),f("tr",{key:`totals-${W(p)}`,class:"total-row",role:"row"},[K[7]||(K[7]=s("td",{class:"row-header",role:"rowheader"},"Total",-1)),(o(!0),f(X,null,se(W(I).totals,(B,Q)=>(o(),f("td",{key:`total-${Q}-${W(p)}`,class:"total-cell",style:ge(W(v)(B)),role:"cell"},k(W(be)(B,i.value.aggregation)),5))),128)),i.value.columnField?(o(),f("td",{key:0,class:"grand-total-cell",style:ge(W(v)(W(I).grandTotal)),role:"cell"},k(W(be)(W(I).grandTotal,i.value.aggregation)),5)):A("",!0)])):A("",!0)])])])):(o(),f("div",dr,[s("p",null,"Invalid aggregation function: "+k(i.value.aggregation),1),K[5]||(K[5]=s("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),Sr=re(kr,[["__scopeId","data-v-64ef72f7"]]),wr={class:"modal-content"},Ir={class:"modal-header"},Rr={class:"modal-title"},Er={class:"summary-row"},Vr={key:0},Ar={key:0,class:"filter-row"},Fr=["onUpdate:modelValue","aria-label"],Or={value:""},Lr=["value"],Pr={class:"table-container"},Mr={class:"api-calls-table"},Dr=["title"],xr=["title"],Ur=ie({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(n){const e=n,t=ss({}),l=M(()=>{const T=new Set;return e.apiCalls.forEach(E=>{E.variables&&Object.keys(E.variables).forEach(v=>T.add(v)),E.attributedVariables&&Object.entries(E.attributedVariables).forEach(([v,p])=>{p&&typeof p=="object"&&Object.keys(p).forEach(O=>{T.add(`${v}.${O}`)})})}),Array.from(T).sort()}),d=M(()=>l.value.map(T=>({title:T,dataIndex:`var_${T}`,key:`var_${T}`,width:150}))),r=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],u=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],b=M(()=>[...r,...d.value,...u]),i=M(()=>`${e.row} Ã— ${e.column} - ${e.apiCalls.length} API Calls`),c=M(()=>e.apiCalls.map(T=>{var v,p;const E={id:T.id,status:T.status,model:T.model||"-",response:((v=T.result)==null?void 0:v.content)||((p=T.result)==null?void 0:p.error)||"-",extracted:T.extracted||"-",duration:T.duration?`${T.duration}ms`:"-",cost:T.cost||0};return l.value.forEach(O=>{var q,x,a;if(O.includes(".")){const[S,U]=O.split("."),C=(x=(q=T.attributedVariables)==null?void 0:q[S])==null?void 0:x[U];E[`var_${O}`]=C!==void 0?String(C):"-"}else E[`var_${O}`]=((a=T.variables)==null?void 0:a[O])||"-"}),E})),g=M(()=>Object.values(t).some(T=>T!==void 0&&T!=="")),y=M(()=>g.value?c.value.filter(T=>Object.entries(t).every(([E,v])=>v?T[E]===v:!0)):c.value),h=M(()=>{const T=e.apiCalls.filter(E=>E.status==="completed").length;return Math.round(T/e.apiCalls.length*100)}),$=M(()=>{const T=e.apiCalls.filter(E=>E.duration).map(E=>E.duration);return T.length===0?0:Math.round(T.reduce((E,v)=>E+v,0)/T.length)}),I=M(()=>e.apiCalls.filter(E=>E.cost).map(E=>E.cost).reduce((E,v)=>E+v,0));function _(T){switch(T){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function w(T,E){return T?T.length<=E?T:T.slice(0,E)+"...":""}function H(T){const E=new Set;return c.value.forEach(v=>{const p=v[T];p&&p!=="-"&&E.add(p)}),Array.from(E).sort()}function F(){Object.keys(t).forEach(T=>{delete t[T]})}return(T,E)=>(o(),f("div",{class:ee(["pivot-cell-detail-modal-v3",{visible:T.visible}]),onClick:E[1]||(E[1]=wt(v=>T.$emit("close"),["self"]))},[s("div",wr,[s("div",Ir,[s("h3",Rr,k(i.value),1),s("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:E[0]||(E[0]=v=>T.$emit("close"))}," Ã— ")]),s("div",Er,[s("span",null,[E[2]||(E[2]=s("b",null,"Total:",-1)),N(" "+k(T.apiCalls.length),1)]),s("span",null,[E[3]||(E[3]=s("b",null,"Success Rate:",-1)),N(" "+k(h.value)+"%",1)]),s("span",null,[E[4]||(E[4]=s("b",null,"Avg Duration:",-1)),N(" "+k($.value)+"ms",1)]),I.value>0?(o(),f("span",Vr,[E[5]||(E[5]=s("b",null,"Total Cost:",-1)),N(" $"+k(I.value),1)])):A("",!0)]),d.value.length>0?(o(),f("div",Ar,[(o(!0),f(X,null,se(d.value,v=>(o(),f("div",{key:v.key,class:"variable-filter"},[Ce(s("select",{"onUpdate:modelValue":p=>t[v.key]=p,"aria-label":`Filter ${v.title}`,class:"filter-select"},[s("option",Or,"All "+k(v.title),1),(o(!0),f(X,null,se(H(v.key),p=>(o(),f("option",{key:p,value:p},k(p),9,Lr))),128))],8,Fr),[[as,t[v.key]]])]))),128)),g.value?(o(),f("button",{key:0,type:"button",class:"clear-filters-btn",onClick:F}," Clear Filters ")):A("",!0)])):A("",!0),s("div",Pr,[s("table",Mr,[s("thead",null,[s("tr",null,[(o(!0),f(X,null,se(b.value,v=>(o(),f("th",{key:v.key,class:"table-header",style:ge({width:v.width?`${v.width}px`:"auto"})},k(v.title),5))),128))])]),s("tbody",null,[(o(!0),f(X,null,se(y.value,v=>(o(),f("tr",{key:v.id,class:"table-row"},[(o(!0),f(X,null,se(b.value,p=>(o(),f("td",{key:p.key,class:ee(["table-cell",{"status-cell":p.key==="status"}])},[p.key==="status"?(o(),f("span",{key:0,class:ee(["status-tag",_(v.status)])},k(v.status),3)):p.key==="response"?(o(),f("span",{key:1,class:"response-cell",title:v.response},k(w(v.response,100)),9,Dr)):p.key==="cost"?(o(),f(X,{key:2},[N(k(v.cost===0?"-":`$${v.cost.toFixed(4)}`),1)],64)):p.key.startsWith("var_")?(o(),f("span",{key:3,class:"variable-cell",title:v[p.key]},k(v[p.key]||"-"),9,xr)):(o(),f(X,{key:4},[N(k(v[p.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),Nr=re(Ur,[["__scopeId","data-v-2738b696"]]),Wr={class:"trial-tab-content"},Hr={class:"tab-pane-content"},zr={class:"tab-pane-content"},Br={key:0,class:"no-data-message"},Gr={class:"tab-pane-content"},bt="trial-details-active-tab",jr=ie({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(n){const e=n,t=It(),l=et(),d=Ne(),r=M(()=>{var F;return((F=d.apiCalls)==null?void 0:F.value)||[]}),u=M(()=>{var F;return((F=d.isStreaming)==null?void 0:F.value)||!1});ue(r,(F,T)=>{const E=performance.now();m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${(T==null?void 0:T.length)||0} to ${F.length} calls`),setTimeout(()=>{const v=performance.now();m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(v-E).toFixed(1)}ms`)},0)});const b=M(()=>!1),c=j((()=>{const F=t.query.tab;return F==="status"?"details":F&&["details","tasks","pivot"].includes(F)?F:"tasks"})()),g=j(!1),y=j(!1),h=j({row:"",column:"",apiCalls:[],value:null}),$=M(()=>{var F,T;return((F=e.executionState)==null?void 0:F.status)==="executing"&&((T=e.executionState)==null?void 0:T.currentTrialId)===e.trial.id}),I=M(()=>e.trial.progress.completed>0);function _(){localStorage.setItem(bt,c.value);const F={...t.query};F.tab=c.value,t.query.tab!==c.value&&(l.replace({query:F}),m.info(`TAB_ROUTING: Updated URL tab parameter to '${c.value}'`))}function w(){const F=localStorage.getItem(bt);F==="status"?c.value="details":F&&["details","tasks","pivot"].includes(F)&&(c.value=F)}function H(F){!F.cell||!F.cell.apiCalls.length||(h.value={row:F.row,column:F.column,apiCalls:F.cell.apiCalls,value:F.cell.value},y.value=!0)}return ue(c,()=>{_()}),ue(()=>t.query.tab,F=>{if(F&&typeof F=="string"){let T=F==="status"?"details":F;["details","tasks","pivot"].includes(T)&&c.value!==T&&(c.value=T,m.info(`TAB_ROUTING: Synced tab to URL parameter '${T}'`))}}),me(()=>{const F=performance.now();if(m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${e.trial.id}`),!t.query.tab){const T={...t.query};T.tab=c.value,l.replace({query:T}),m.info(`TAB_ROUTING: Set initial URL tab parameter to '${c.value}'`)}w(),setTimeout(()=>{const T=performance.now();m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(T-F).toFixed(1)}ms`)},0)}),Ie(()=>{m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Re(()=>{m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${e.trial.id}`)}),he(()=>{m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(F,T)=>{const E=Z("a-tab-pane"),v=Z("a-tabs");return o(),f("div",Wr,[V(v,{activeKey:c.value,"onUpdate:activeKey":T[1]||(T[1]=p=>c.value=p),type:"card",class:"trial-tabs"},{default:L(()=>[V(E,{key:"tasks",tab:"Task View"},{default:L(()=>[s("div",Hr,[(o(),J(qe,null,[V(oi,{trial:F.trial,progress:F.progress,"is-executing":$.value,"api-calls":r.value,"is-streaming":u.value,"is-loading":b.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),V(E,{key:"pivot",tab:"Pivot Table"},{default:L(()=>[s("div",zr,[(o(),J(qe,null,[I.value&&r.value.length>0?(o(),J(Sr,{key:0,"api-calls":r.value,trial:F.trial,"show-performance-info":!1,onCellClick:H},null,8,["api-calls","trial"])):A("",!0)],1024)),I.value&&r.value.length>0?A("",!0):(o(),f("div",Br,T[3]||(T[3]=[s("p",null,"No completed API calls available for pivot analysis.",-1),s("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),V(E,{key:"details",tab:"Details"},{default:L(()=>[s("div",Gr,[V(Wn,{trial:F.trial,"is-collapsed":g.value,onToggleCollapse:T[0]||(T[0]=p=>g.value=!g.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),y.value?(o(),J(Nr,{key:0,visible:y.value,row:h.value.row,column:h.value.column,"api-calls":h.value.apiCalls,trial:F.trial,value:h.value.value,onClose:T[2]||(T[2]=p=>y.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):A("",!0)])}}}),qr=re(jr,[["__scopeId","data-v-d2c24429"]]),Kr={class:"export-content"},Qr={class:"section"},Yr={class:"section"},Jr={class:"field-actions"},Xr={class:"field-groups"},Zr={class:"field-group"},eu={class:"field-list"},tu={class:"field-group"},su={class:"field-list"},au={class:"field-group"},nu={class:"field-list"},lu={class:"field-group"},ou={class:"field-list"},iu={class:"field-group"},ru={class:"field-list"},uu={key:0,class:"field-group"},du={class:"field-list"},cu={key:1,class:"field-group"},pu={class:"field-list"},fu={class:"section"},vu={class:"preview-info"},mu={class:"info-item"},gu={class:"value"},hu={class:"info-item"},bu={class:"value"},yu={class:"info-item"},_u={class:"value"},Tu={class:"export-actions"},$u=ie({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(n,{emit:e}){const t=n,l=e,d=Ze(),r=j("csv"),u=j(["order","status","configuration","prompt","response","latency"]),b=j(!1),i=j({}),c=j([]),g=j([]),y=j([]),h=["order","status","configuration","prompt","response","latency"],$=j([]),I=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],_=M(()=>{var S,U;const x=((S=t.trial.progress)==null?void 0:S.completed)||0,a=((U=t.trial.progress)==null?void 0:U.failed)||0;return x+a}),w=M(()=>{const a=u.value.length*50*_.value;return a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`});function H(){m.info("EXPORT_DEBUG: ExportModal initializeFieldSelection with allFields",$.value.length),$.value.forEach(S=>{i.value[S]=!1}),h.forEach(S=>{i.value[S]=!0});const x=g.value.map(S=>S.id),a=y.value.map(S=>S.id);x.forEach(S=>{i.value[S]=!0}),a.forEach(S=>{i.value[S]=!0}),m.info("EXPORT_DEBUG: ExportModal default selection includes",{standardDefaults:h.length,parameterDefaults:x.length,variableDefaults:a.length,totalDefaults:h.length+x.length+a.length}),F()}function F(){u.value=$.value.filter(x=>i.value[x])}function T(x,a){i.value[x]=a,F()}function E(){$.value.forEach(x=>{i.value[x]=!0}),F()}function v(){$.value.forEach(S=>{i.value[S]=!1}),h.forEach(S=>{i.value[S]=!0});const x=g.value.map(S=>S.id),a=y.value.map(S=>S.id);x.forEach(S=>{i.value[S]=!0}),a.forEach(S=>{i.value[S]=!0}),F()}function p(){$.value.forEach(x=>{i.value[x]=!1}),F()}function O(){l("update:visible",!1)}async function q(){if(u.value.length===0){oe.warning("Please select at least one field to export");return}b.value=!0;try{const x={format:r.value,fields:u.value,includeHeaders:!0,addBOM:r.value==="excel"||r.value==="csv"},a=await d.dataExport.exportTrialData(t.trial.id,x);a.ok?(oe.success("Export completed successfully"),l("update:visible",!1)):oe.error(`Export failed: ${a.error.message}`)}catch(x){oe.error("Export failed: "+x.message)}finally{b.value=!1}}return me(async()=>{m.info("EXPORT_DEBUG: ExportModal discovering available fields for trial",t.trial.id);const x=await d.dataExport.getAvailableFields(t.trial.id);if(x.ok){c.value=x.value.standardFields,g.value=x.value.parameterFields,y.value=x.value.variableFields||[];const a=x.value.standardFields.map(C=>C.id).filter(C=>C!=="parameters"&&C!=="variables"),S=x.value.parameterFields.map(C=>C.id),U=(x.value.variableFields||[]).map(C=>C.id);$.value=[...a,...S,...U],m.info("EXPORT_DEBUG: ExportModal discovered fields",{standardFields:x.value.standardFields.length,parameterFields:x.value.parameterFields.length,variableFields:(x.value.variableFields||[]).length,totalFields:$.value.length,parameterFieldNames:x.value.parameterFields.map(C=>C.id),variableFieldNames:(x.value.variableFields||[]).map(C=>C.id),allFieldNames:$.value})}else m.info("EXPORT_DEBUG: ExportModal field discovery failed",x.error),$.value=[...I];H()}),(x,a)=>{const S=Z("a-radio-button"),U=Z("a-radio-group"),C=Z("a-button"),G=Z("a-checkbox"),te=Z("a-modal");return o(),J(te,{visible:x.visible,"onUpdate:visible":a[45]||(a[45]=R=>x.$emit("update:visible",R)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:L(()=>[s("div",Kr,[s("div",Qr,[a[51]||(a[51]=s("h4",null,"Export Format",-1)),V(U,{value:r.value,"onUpdate:value":a[0]||(a[0]=R=>r.value=R),class:"format-options"},{default:L(()=>[V(S,{value:"csv"},{default:L(()=>a[46]||(a[46]=[N("CSV")])),_:1,__:[46]}),V(S,{value:"tsv"},{default:L(()=>a[47]||(a[47]=[N("TSV")])),_:1,__:[47]}),V(S,{value:"excel"},{default:L(()=>a[48]||(a[48]=[N("Excel")])),_:1,__:[48]}),V(S,{value:"json"},{default:L(()=>a[49]||(a[49]=[N("JSON")])),_:1,__:[49]}),V(S,{value:"jsonl"},{default:L(()=>a[50]||(a[50]=[N("JSONL")])),_:1,__:[50]})]),_:1},8,["value"])]),s("div",Yr,[a[84]||(a[84]=s("h4",null,"Fields to Export",-1)),s("div",Jr,[V(C,{size:"small",onClick:E},{default:L(()=>a[52]||(a[52]=[N("Select All")])),_:1,__:[52]}),V(C,{size:"small",onClick:v},{default:L(()=>a[53]||(a[53]=[N("Select Defaults")])),_:1,__:[53]}),V(C,{size:"small",onClick:p},{default:L(()=>a[54]||(a[54]=[N("Clear All")])),_:1,__:[54]})]),s("div",Xr,[s("div",Zr,[a[60]||(a[60]=s("h5",null,"Basic Information",-1)),s("div",eu,[V(G,{checked:i.value.id,"onUpdate:checked":a[1]||(a[1]=R=>i.value.id=R),onChange:a[2]||(a[2]=R=>T("id",R.target.checked))},{default:L(()=>a[55]||(a[55]=[N("Call ID")])),_:1,__:[55]},8,["checked"]),V(G,{checked:i.value.order,"onUpdate:checked":a[3]||(a[3]=R=>i.value.order=R),onChange:a[4]||(a[4]=R=>T("order",R.target.checked))},{default:L(()=>a[56]||(a[56]=[N("Order")])),_:1,__:[56]},8,["checked"]),V(G,{checked:i.value.status,"onUpdate:checked":a[5]||(a[5]=R=>i.value.status=R),onChange:a[6]||(a[6]=R=>T("status",R.target.checked))},{default:L(()=>a[57]||(a[57]=[N("Status")])),_:1,__:[57]},8,["checked"]),V(G,{checked:i.value.created,"onUpdate:checked":a[7]||(a[7]=R=>i.value.created=R),onChange:a[8]||(a[8]=R=>T("created",R.target.checked))},{default:L(()=>a[58]||(a[58]=[N("Created Time")])),_:1,__:[58]},8,["checked"]),V(G,{checked:i.value.completed,"onUpdate:checked":a[9]||(a[9]=R=>i.value.completed=R),onChange:a[10]||(a[10]=R=>T("completed",R.target.checked))},{default:L(()=>a[59]||(a[59]=[N("Completed Time")])),_:1,__:[59]},8,["checked"])])]),s("div",tu,[a[65]||(a[65]=s("h5",null,"Configuration",-1)),s("div",su,[V(G,{checked:i.value.configuration,"onUpdate:checked":a[11]||(a[11]=R=>i.value.configuration=R),onChange:a[12]||(a[12]=R=>T("configuration",R.target.checked))},{default:L(()=>a[61]||(a[61]=[N("Configuration Name")])),_:1,__:[61]},8,["checked"]),V(G,{checked:i.value.provider,"onUpdate:checked":a[13]||(a[13]=R=>i.value.provider=R),onChange:a[14]||(a[14]=R=>T("provider",R.target.checked))},{default:L(()=>a[62]||(a[62]=[N("Provider")])),_:1,__:[62]},8,["checked"]),V(G,{checked:i.value.modelId,"onUpdate:checked":a[15]||(a[15]=R=>i.value.modelId=R),onChange:a[16]||(a[16]=R=>T("modelId",R.target.checked))},{default:L(()=>a[63]||(a[63]=[N("Model ID")])),_:1,__:[63]},8,["checked"]),V(G,{checked:i.value.parameters,"onUpdate:checked":a[17]||(a[17]=R=>i.value.parameters=R),onChange:a[18]||(a[18]=R=>T("parameters",R.target.checked))},{default:L(()=>a[64]||(a[64]=[N("Parameters")])),_:1,__:[64]},8,["checked"])])]),s("div",au,[a[70]||(a[70]=s("h5",null,"Content",-1)),s("div",nu,[V(G,{checked:i.value.prompt,"onUpdate:checked":a[19]||(a[19]=R=>i.value.prompt=R),onChange:a[20]||(a[20]=R=>T("prompt",R.target.checked))},{default:L(()=>a[66]||(a[66]=[N("Prompt")])),_:1,__:[66]},8,["checked"]),V(G,{checked:i.value.variables,"onUpdate:checked":a[21]||(a[21]=R=>i.value.variables=R),onChange:a[22]||(a[22]=R=>T("variables",R.target.checked))},{default:L(()=>a[67]||(a[67]=[N("Variables")])),_:1,__:[67]},8,["checked"]),V(G,{checked:i.value.response,"onUpdate:checked":a[23]||(a[23]=R=>i.value.response=R),onChange:a[24]||(a[24]=R=>T("response",R.target.checked))},{default:L(()=>a[68]||(a[68]=[N("Response")])),_:1,__:[68]},8,["checked"]),V(G,{checked:i.value.parsedResponse,"onUpdate:checked":a[25]||(a[25]=R=>i.value.parsedResponse=R),onChange:a[26]||(a[26]=R=>T("parsedResponse",R.target.checked))},{default:L(()=>a[69]||(a[69]=[N("Parsed Response")])),_:1,__:[69]},8,["checked"])])]),s("div",lu,[a[76]||(a[76]=s("h5",null,"Performance",-1)),s("div",ou,[V(G,{checked:i.value.latency,"onUpdate:checked":a[27]||(a[27]=R=>i.value.latency=R),onChange:a[28]||(a[28]=R=>T("latency",R.target.checked))},{default:L(()=>a[71]||(a[71]=[N("Latency (ms)")])),_:1,__:[71]},8,["checked"]),V(G,{checked:i.value.promptTokens,"onUpdate:checked":a[29]||(a[29]=R=>i.value.promptTokens=R),onChange:a[30]||(a[30]=R=>T("promptTokens",R.target.checked))},{default:L(()=>a[72]||(a[72]=[N("Prompt Tokens")])),_:1,__:[72]},8,["checked"]),V(G,{checked:i.value.completionTokens,"onUpdate:checked":a[31]||(a[31]=R=>i.value.completionTokens=R),onChange:a[32]||(a[32]=R=>T("completionTokens",R.target.checked))},{default:L(()=>a[73]||(a[73]=[N("Completion Tokens")])),_:1,__:[73]},8,["checked"]),V(G,{checked:i.value.totalTokens,"onUpdate:checked":a[33]||(a[33]=R=>i.value.totalTokens=R),onChange:a[34]||(a[34]=R=>T("totalTokens",R.target.checked))},{default:L(()=>a[74]||(a[74]=[N("Total Tokens")])),_:1,__:[74]},8,["checked"]),V(G,{checked:i.value.cost,"onUpdate:checked":a[35]||(a[35]=R=>i.value.cost=R),onChange:a[36]||(a[36]=R=>T("cost",R.target.checked))},{default:L(()=>a[75]||(a[75]=[N("Cost (USD)")])),_:1,__:[75]},8,["checked"])])]),s("div",iu,[a[81]||(a[81]=s("h5",null,"Technical Details",-1)),s("div",ru,[V(G,{checked:i.value.request,"onUpdate:checked":a[37]||(a[37]=R=>i.value.request=R),onChange:a[38]||(a[38]=R=>T("request",R.target.checked))},{default:L(()=>a[77]||(a[77]=[N("Full Request")])),_:1,__:[77]},8,["checked"]),V(G,{checked:i.value.response_raw,"onUpdate:checked":a[39]||(a[39]=R=>i.value.response_raw=R),onChange:a[40]||(a[40]=R=>T("response_raw",R.target.checked))},{default:L(()=>a[78]||(a[78]=[N("Raw Response")])),_:1,__:[78]},8,["checked"]),V(G,{checked:i.value.error,"onUpdate:checked":a[41]||(a[41]=R=>i.value.error=R),onChange:a[42]||(a[42]=R=>T("error",R.target.checked))},{default:L(()=>a[79]||(a[79]=[N("Error Details")])),_:1,__:[79]},8,["checked"]),V(G,{checked:i.value.repeatIndex,"onUpdate:checked":a[43]||(a[43]=R=>i.value.repeatIndex=R),onChange:a[44]||(a[44]=R=>T("repeatIndex",R.target.checked))},{default:L(()=>a[80]||(a[80]=[N("Repeat Index")])),_:1,__:[80]},8,["checked"])])]),g.value.length>0?(o(),f("div",uu,[a[82]||(a[82]=s("h5",null,"Parameters (Individual Columns)",-1)),s("div",du,[(o(!0),f(X,null,se(g.value,R=>(o(),J(G,{key:R.id,checked:i.value[R.id],"onUpdate:checked":ae=>i.value[R.id]=ae,onChange:ae=>T(R.id,ae.target.checked)},{default:L(()=>[N(k(R.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):A("",!0),y.value.length>0?(o(),f("div",cu,[a[83]||(a[83]=s("h5",null,"Attributes (Individual Columns)",-1)),s("div",pu,[(o(!0),f(X,null,se(y.value,R=>(o(),J(G,{key:R.id,checked:i.value[R.id],"onUpdate:checked":ae=>i.value[R.id]=ae,onChange:ae=>T(R.id,ae.target.checked)},{default:L(()=>[N(k(R.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):A("",!0)])]),s("div",fu,[a[88]||(a[88]=s("h4",null,"Export Preview",-1)),s("div",vu,[s("div",mu,[a[85]||(a[85]=s("span",{class:"label"},"Records:",-1)),s("span",gu,k(_.value),1)]),s("div",hu,[a[86]||(a[86]=s("span",{class:"label"},"Fields:",-1)),s("span",bu,k(u.value.length),1)]),s("div",yu,[a[87]||(a[87]=s("span",{class:"label"},"Estimated Size:",-1)),s("span",_u,k(w.value),1)])])]),s("div",Tu,[V(C,{onClick:O},{default:L(()=>a[89]||(a[89]=[N("Cancel")])),_:1,__:[89]}),V(C,{type:"primary",onClick:q,loading:b.value,disabled:u.value.length===0},{default:L(()=>[V(W(ns)),a[90]||(a[90]=N(" Export "))]),_:1,__:[90]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),Cu=re($u,[["__scopeId","data-v-d6076c55"]]);class ku{constructor(){ce(this,"subscription",null);ce(this,"progressSubscription",null);ce(this,"store",Ne());ce(this,"v4Control",Rt());ce(this,"isActive",!1);ce(this,"currentTrialId",null)}async startStreaming(e){const t=performance.now();m.info(`V4_TRIAL_SWITCH: Stream manager starting for trial ${e}`),this.cleanupSubscriptions();const l=performance.now();m.info(`V4_TRIAL_SWITCH: Stream cleanup completed in ${(l-t).toFixed(1)}ms`),this.isActive=!0,m.info(`V4_TRIAL_SWITCH: Set isActive = true to pause reactive queries at ${(l-t).toFixed(1)}ms`),this.currentTrialId=e,this.store.setCurrentTrial(e),this.store.setStreaming(!0);const d=performance.now();m.info(`V4_TRIAL_SWITCH: Store updated in ${(d-l).toFixed(1)}ms`);const r=performance.now();m.info("V4_TRIAL_SWITCH: ALWAYS loading complete historical data first"),await this.loadHistoricalData(e);const u=performance.now();m.info(`V4_TRIAL_SWITCH: Historical data loading completed in ${(u-r).toFixed(1)}ms - store now has complete dataset`);const b=performance.now();m.info("V4_TRIAL_SWITCH: Checking for active streams to overlay updates");const i=this.v4Control.getActiveStreams(e),c=performance.now();if(m.info(`V4_TRIAL_SWITCH: Stream check completed in ${(c-b).toFixed(1)}ms, result: ${i?"FOUND":"NONE"}`),!i){m.info(`V4_TRIAL_SWITCH: No active streams for trial ${e}, using complete historical data only`);const g=await je.trials.get(e);if(g&&g.status==="running"){m.info(`V4_TRIAL_SWITCH: Running trial ${e}, setting up retry for potential streaming`);let y=0;const h=5,$=setInterval(()=>{y++,m.info(`V4_TRIAL_SWITCH: Retry ${y}/${h} checking for active streams`);const I=this.v4Control.getActiveStreams(e);I?(m.info(`V4_TRIAL_SWITCH: Found active streams after ${y} retries - starting live updates`),clearInterval($),this.connectToTrialStream(e,I)):y>=h&&(m.info(`V4_TRIAL_SWITCH: No streams after ${h} retries - staying with historical data only`),clearInterval($))},500)}else m.info(`V4_TRIAL_SWITCH: Non-running trial ${(g==null?void 0:g.status)||"NOT_FOUND"} - complete with historical data only`);return}this.connectToTrialStream(e,i)}connectToTrialStream(e,t){var d,r;m.info(`V4_STREAM_CONNECT: Connecting to streams for trial ${e} with historical foundation`),m.info(`V4_STREAM_CONNECT: Entry point - starting stream connection for trial ${e}`),this.isActive=!0;const l=t.callsSubject||t.sharedCalls$;m.info(`V4_STREAM_CONNECT: Subscribing to calls stream for updates, type: ${(d=l==null?void 0:l.constructor)==null?void 0:d.name}`),m.info(`V4_STREAM_CONNECT: Calls stream available: ${!!l}, type: ${(r=l==null?void 0:l.constructor)==null?void 0:r.name}`),this.subscription=l.subscribe({next:u=>{if(u&&u.length>0){m.info(`V4_STREAM_CONNECT: Merging ${u.length} streaming updates`);const b=[...this.store.apiCalls.value];u.forEach(i=>{const c=b.findIndex(g=>g.id===i.id);c>=0?b[c]=i:b.push(i)}),b.sort((i,c)=>{const g=$=>{switch($){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},y=g(i.status),h=g(c.status);if(y!==h)return y-h;if(i.status==="completed"&&c.status==="completed"){const $=i.completed?new Date(i.completed).getTime():0;return(c.completed?new Date(c.completed).getTime():0)-$}if(i.status==="running"&&c.status==="running"){const $=i.started?new Date(i.started).getTime():0;return(c.started?new Date(c.started).getTime():0)-$}return i.order-c.order}),this.store.updateApiCalls(b)}},error:u=>{m.error("V4_STREAM_CONNECT: Stream error:",u),m.info("V4_STREAM_CONNECT: Calls stream ERROR:",u),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{m.info(`V4_TRIAL_DEBUG_STREAMS_MGR: Stream completed for trial ${e}`),m.info(`V4_TRIAL_DEBUG_STREAMS: Calls stream COMPLETED for trial ${e}`),this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(e)}}),t.sharedProgress$&&(m.info("V4_STREAM_CONNECT: Subscribing to progress stream"),m.info(`V4_STREAM_CONNECT: Progress stream available: ${!!t.sharedProgress$}`),this.progressSubscription=t.sharedProgress$.subscribe({next:u=>{m.info("V4_STREAM_CONNECT: Received progress update:",u.type),m.info(`V4_STREAM_CONNECT: Progress update - ${u.type}`),m.info(`ðŸš¨ COMPLETION_DEBUG: Stream manager received progress event: ${u.type} at ${new Date().toISOString()}`),u.type==="completed"&&(m.info(`V4_TRIAL_DEBUG_STREAMS: Trial ${e} COMPLETED via progress stream`),m.info("ðŸš¨ COMPLETION_DEBUG: âœ… TRIAL COMPLETED EVENT RECEIVED BY STREAM MANAGER!"),m.info(`V4_TRIAL_COMPLETION: Loading final data from database for completed trial ${e}`),this.loadHistoricalData(e).then(()=>{m.info("V4_TRIAL_COMPLETION: Final data loaded - UI should now show accurate completion counts"),m.info("ðŸš¨ COMPLETION_DEBUG: âœ… UI SHOULD BE UPDATED NOW!")}).catch(b=>{m.error("V4_TRIAL_COMPLETION: Failed to load final data:",b)})),this.store.updateProgress(u)},error:u=>{m.error("V4_STREAM_CONNECT: Progress stream error:",u),m.info("V4_STREAM_CONNECT: Progress stream ERROR:",u)}})),m.info("V4_STREAM_CONNECT: Successfully connected to streams with historical foundation"),m.info(`V4_STREAM_CONNECT: Stream subscriptions complete for trial ${e}`)}cleanupSubscriptions(){m.info("STREAM_MGR_V4: Cleaning up existing subscriptions"),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){m.info("STREAM_MGR_V4: Stopping streaming"),m.info(`V4_TRIAL_DEBUG_STREAMS: stopStreaming() called for trial ${this.currentTrialId}`),m.info(`V4_TRIAL_DEBUG_STREAMS: Current isActive: ${this.isActive}`),this.cleanupSubscriptions(),this.isActive=!1,m.info("V4_TRIAL_DEBUG_STREAMS: Stopped streaming, isActive set to false")}async loadHistoricalData(e){const t=performance.now();m.info(`V4_TRIAL_SWITCH: loadHistoricalData() ENTRY for trial ${e}`);try{const l=performance.now();m.info(`V4_TRIAL_SWITCH: Checking database availability at ${(l-t).toFixed(1)}ms`);const d=performance.now();m.info(`V4_TRIAL_SWITCH: Preparing database query at ${(d-t).toFixed(1)}ms`);const r=performance.now();m.info(`V4_TRIAL_SWITCH: Starting IndexedDB query at ${(r-t).toFixed(1)}ms`);const u=await je.apiCalls.where("trialId").equals(e).toArray(),b=performance.now();m.info(`V4_TRIAL_SWITCH: IndexedDB query COMPLETED - loaded ${u.length} calls in ${(b-r).toFixed(1)}ms`),m.info(`V4_TRIAL_SWITCH: Total time to query completion: ${(b-t).toFixed(1)}ms`);const i=performance.now();u.sort(($,I)=>{const _=F=>{switch(F){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},w=_($.status),H=_(I.status);if(w!==H)return w-H;if($.status==="completed"&&I.status==="completed"){const F=$.completed?new Date($.completed).getTime():0;return(I.completed?new Date(I.completed).getTime():0)-F}if($.status==="running"&&I.status==="running"){const F=$.started?new Date($.started).getTime():0;return(I.started?new Date(I.started).getTime():0)-F}return $.order-I.order});const c=performance.now();m.info(`V4_TRIAL_SWITCH: Sorting ${u.length} calls took ${(c-i).toFixed(1)}ms`);const g=performance.now();this.store.updateApiCalls(u),this.store.setStreaming(!1);const y=performance.now();m.info(`V4_TRIAL_SWITCH: Store update took ${(y-g).toFixed(1)}ms`),m.info(`V4_TRIAL_SWITCH: loadHistoricalData keeping isActive = ${this.isActive} to maintain reactive query pause`);const h=performance.now();m.info(`V4_TRIAL_SWITCH: loadHistoricalData TOTAL: ${(h-t).toFixed(1)}ms`)}catch(l){m.error("STREAM_MGR_V4: Failed to load historical data:",l),this.store.clear()}}destroy(){m.info("STREAM_MGR_V4: Destroying stream manager"),this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let De=null;function Pt(){return De||(De=new ku,m.info("STREAM_MGR_V4: Created singleton manager instance")),De}typeof window<"u"&&(window.__trialStreamManagerV4=()=>De);const Su={class:"trial-details-panel"},wu={key:0,class:"loading-state"},Iu={key:1,class:"error-state"},Ru={class:"error-actions"},Eu=ie({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(n){const e=n,t=et(),l=j(!1),d=j(null),r=j(!1),u=Pt(),b=M(()=>{var h,$,I;return((h=e.executionState)==null?void 0:h.status)==="executing"&&(($=e.executionState)==null?void 0:$.currentTrialId)===((I=e.trial)==null?void 0:I.id)});function i(){d.value=null}function c(){t.push("/trials")}function g(){r.value=!0}async function y(){if(e.trial){m.info(`REFRESH: Manually refreshing trial ${e.trial.id} data from database`);try{u.isActive&&u.currentTrialId===e.trial.id&&(m.info("REFRESH: Temporarily stopping active stream to reload data"),u.stopStreaming()),await u.loadHistoricalData(e.trial.id),m.info(`REFRESH: Successfully refreshed trial ${e.trial.id} data`),(e.trial.status==="running"||e.trial.status==="paused")&&(m.info("REFRESH: Restarting streaming for active trial"),await u.startStreaming(e.trial.id))}catch(h){m.error("REFRESH: Failed to refresh trial data:",h)}}}return ue(()=>e.trial,(h,$)=>{h&&h.id!==($==null?void 0:$.id)&&(d.value=null,m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${$==null?void 0:$.id} to ${h.id}`))}),me(()=>{var $;const h=($=e.trial)==null?void 0:$.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${h}`)}),Ie(()=>{var $;const h=($=e.trial)==null?void 0:$.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${h}`)}),Re(()=>{var $;const h=($=e.trial)==null?void 0:$.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${h}`)}),he(()=>{var $;const h=($=e.trial)==null?void 0:$.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${h}`)}),(h,$)=>{const I=Z("a-button");return o(),f("div",Su,[l.value?(o(),f("div",wu,[V(W($t),{class:"loading-spinner",spin:""}),$[9]||($[9]=s("span",null,"Loading trial details...",-1))])):d.value?(o(),f("div",Iu,[V(W(Et),{class:"error-icon"}),$[12]||($[12]=s("h3",null,"Failed to load trial",-1)),s("p",null,k(d.value),1),s("div",Ru,[V(I,{onClick:i},{default:L(()=>$[10]||($[10]=[N("Retry")])),_:1,__:[10]}),V(I,{type:"link",onClick:c},{default:L(()=>$[11]||($[11]=[N("Go Back")])),_:1,__:[11]})])])):h.trial?(o(),f(X,{key:2},[V(en,{trial:h.trial,progress:h.progress,"is-executing":b.value},null,8,["trial","progress","is-executing"]),V(on,{trial:h.trial,"is-leader":h.isLeader,"execution-state":h.executionState,onStart:$[0]||($[0]=_=>h.$emit("start-trial")),onPause:$[1]||($[1]=_=>h.$emit("pause-trial")),onResume:$[2]||($[2]=_=>h.$emit("resume-trial")),onCancel:$[3]||($[3]=_=>h.$emit("cancel-trial")),onDuplicate:$[4]||($[4]=_=>h.$emit("duplicate-trial",h.trial.id)),onEdit:$[5]||($[5]=_=>h.$emit("edit-trial",h.trial.id)),onDelete:$[6]||($[6]=_=>h.$emit("delete-trial",h.trial.id)),onExportData:g,onExportPython:$[7]||($[7]=_=>h.$emit("export-python",h.trial.id)),onRefresh:y},null,8,["trial","is-leader","execution-state"]),h.trial&&r.value?(o(),J(Cu,{key:0,visible:r.value,trial:h.trial,"onUpdate:visible":$[8]||($[8]=_=>r.value=!1)},null,8,["visible","trial"])):A("",!0),V(qr,{trial:h.trial,progress:h.progress,"is-leader":h.isLeader,"execution-state":h.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):A("",!0)])}}}),Vu=re(Eu,[["__scopeId","data-v-081db72e"]]),Au={class:"trials-view-v3"},Fu={key:0,class:"provider-warning-banner"},Ou={class:"banner-content"},Lu={key:1,class:"observer-mode-banner"},Pu={class:"banner-content"},Mu={key:1,class:"loading-left-pane"},Du={key:0,class:"no-selection"},xu={key:0,class:"observer-note"},Uu=ie({__name:"TrialsViewV3",setup(n){const e=Rt(),{trials:t}=ps(),{enabledModels:l}=gs(),{duplicateTrial:d,deleteTrial:r}=fs(),u=Pt(),b=Ze(),i=It(),c=et(),g=j(),y=j(!0),h=j(null),$=j(""),I=j("all"),_=j(-1),w=j(!1),H=j(!1),F=M(()=>l.value.length>0),T=M(()=>!F.value&&!H.value),E=e.isLeader,v=e.execution,{trial:p}=vs(h),O=M(()=>{var D;const P=(D=p.value)==null?void 0:D.progress;return P?{trialId:h.value||"",...P,lastUpdated:new Date}:null}),q=M(()=>{let P=t.value;if($.value){const D=$.value.toLowerCase();P=P.filter(Y=>{var _e,Fe;const le=Y.name.toLowerCase().includes(D),ve=(Fe=(_e=Y.templateConfig)==null?void 0:_e.template)==null?void 0:Fe.toLowerCase().includes(D),ne=Y.configurations.some(Se=>Se.modelId.toLowerCase().includes(D)||Se.provider.toLowerCase().includes(D));return le||ve||ne})}return I.value!=="all"&&(P=P.filter(D=>D.status===I.value)),P});async function x(){var D;const P=i.query;if(P.duplicate){const Y=P.duplicate,le=await d(Y);le.ok?await c.push({path:"/trials/create",query:{duplicate:le.value,edit:P.edit==="true"?"true":void 0}}):oe.error(`Failed to duplicate trial: ${((D=le.error)==null?void 0:D.message)||"Unknown error"}`),await c.replace({query:{}});return}if(P.designId||P.promptSource){await c.push({path:"/trials/create",query:P});return}if(i.query.trialId){const Y=i.query.trialId;S(Y)}}function a(){if(h.value)return;if(t.value.length===0){m.info("V4_TRIALS: No trials available for auto-selection");return}const P=t.value.find(D=>D.status==="running");if(P){S(P.id);return}S(t.value[0].id)}async function S(P){const D=performance.now();m.info(`V4_TRIAL_SWITCH: Starting trial selection: ${P}`),h.value=P;const Y=performance.now();if(m.info(`V4_TRIAL_SWITCH: UI updated in ${(Y-D).toFixed(1)}ms`),t.value.length>0){const ne=q.value.findIndex(_e=>_e.id===P);ne>=0&&(_.value=ne)}const le=performance.now();if(m.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${P} at ${(le-D).toFixed(1)}ms`),u.startStreaming(P).catch(ne=>{m.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${P}`,ne)}),i.query.trialId!==P){const ne={...i.query};ne.trialId=P,ne.tab||(ne.tab="status"),c.push({path:"/trials",query:ne}),m.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${ne.tab}' at ${(performance.now()-D).toFixed(1)}ms`)}g.value&&g.value.closeMobileOverlay();const ve=performance.now();m.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(ve-D).toFixed(1)}ms`)}function U(P){$.value=P,_.value=-1}function C(P){I.value=P,_.value=-1}async function G(){oe.info("Refreshing trial list...")}function te(P){const D=q.value;if(D.length!==0){if((P.metaKey||P.ctrlKey)&&P.key==="k"){P.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(P.key==="j"||P.key==="ArrowDown")&&(P.preventDefault(),_.value=Math.min(_.value+1,D.length-1),_.value>=0&&(S(D[_.value].id),R(D[_.value].id))),(P.key==="k"||P.key==="ArrowUp")&&(P.preventDefault(),_.value=Math.max(_.value-1,0),S(D[_.value].id),R(D[_.value].id)),P.key==="Enter"&&h.value,P.key==="Escape"&&($.value="",h.value=null,_.value=-1)}}function R(P){Te(()=>{const D=document.querySelector(`[data-trial-id="${P}"]`);D&&D.scrollIntoView({behavior:"smooth",block:"nearest"})})}function ae(P){m.debug("Trial list panel resized",{width:P})}function pe(P){m.debug("Mobile overlay changed",{visible:P})}function ye(){H.value=!0}async function ke(){await c.push("/trials/create")}async function Ve(){var P,D,Y,le;if(h.value){if(w.value){m.info("Start trial already in progress, ignoring duplicate request");return}w.value=!0,m.info("V4_EXECUTION:",(P=e.execution)==null?void 0:P.value),m.info("V4_STATUS:",(Y=(D=e.execution)==null?void 0:D.value)==null?void 0:Y.status);try{m.info("V4: Starting trial with streaming",h.value);const ve=await e.startTrialWithStreaming(h.value);if(!ve.ok){oe.error(((le=ve.error)==null?void 0:le.message)||"Unknown error");return}m.info("V4_STREAMING: Restarting stream manager after trial start"),await u.startStreaming(h.value),m.info("V4: Trial started with streaming, stream manager connected");const ne={...i.query};ne.tab="tasks",c.replace({query:ne})}finally{w.value=!1}}}async function z(){var D;m.info(`V4_TRIAL_DEBUG_PAUSE: UI pauseTrial() called for trial: ${h.value}`),m.info(`V4_TRIAL_DEBUG_PAUSE: Current execution state: ${e.execution.value.status}`),m.info(`V4_TRIAL_DEBUG_PAUSE: Is leader: ${e.isLeader.value}`);const P=await e.pauseExecution();m.info("V4_TRIAL_DEBUG_PAUSE: UI pauseTrial result:",P),P.ok?m.info(`V4_TRIAL_DEBUG_PAUSE: Pause successful, execution state: ${e.execution.value.status}`):(m.info("V4_TRIAL_DEBUG_PAUSE: Pause failed from UI:",P.error.message),oe.error(((D=P.error)==null?void 0:D.message)||"Unknown error"))}async function K(){var Y,le,ve;if(!h.value)return;m.info(`V4_TRIAL_DEBUG_RESUME: UI resumeTrial() called for trial: ${h.value}`),m.info(`V4_TRIAL_DEBUG_RESUME: Current execution state: ${e.execution.value.status}`),m.info(`V4_TRIAL_DEBUG_RESUME: Is leader: ${e.isLeader.value}`);const P=((Y=e.execution.value)==null?void 0:Y.status)||"idle";m.info(`V4_TRIAL_DEBUG_RESUME: Current execution status: ${P}`);const D=(le=e.execution.value)==null?void 0:le.currentTrialId;if(P==="paused"&&D===h.value){m.info(`V4_TRIAL_DEBUG_RESUME: Execution is paused for THIS trial (${h.value}), using resumeExecution()`);const ne=await e.resumeExecution(h.value);m.info("V4_TRIAL_DEBUG_RESUME: resumeExecution result:",ne),ne.ok?(m.info("V4_TRIAL_DEBUG_RESUME: Resume successful - existing pipeline will continue automatically via pause$ = false"),m.info("V4_TRIAL_DEBUG_RESUME: Resume complete - existing V3 pipeline should continue processing pending calls")):(m.info("V4_TRIAL_DEBUG_RESUME: Resume failed:",ne.error.message),oe.error(ne.error.message))}else{m.info("V4_TRIAL_DEBUG_RESUME: No paused execution found, using startTrialWithStreaming (fresh start)");const ne=await e.startTrialWithStreaming(h.value);m.info("V4_TRIAL_DEBUG_RESUME: startTrialWithStreaming result for fresh start:",ne),ne.ok?(m.info("V4_TRIAL_DEBUG_RESUME: Fresh start successful, starting stream manager"),await u.startStreaming(h.value),m.info("V4_TRIAL_DEBUG_RESUME: Stream manager started for fresh execution")):(m.info("V4_TRIAL_DEBUG_RESUME: Fresh start failed:",ne.error.message),oe.error(((ve=ne.error)==null?void 0:ve.message)||"Unknown error"))}}async function B(){var D;const P=await e.cancelExecution();P.ok||oe.error(((D=P.error)==null?void 0:D.message)||"Unknown error")}async function Q(P){var Y;const D=await d(P);D.ok?(oe.success("Trial duplicated"),D.value&&S(D.value)):oe.error(((Y=D.error)==null?void 0:Y.message)||"Unknown error")}async function de(P){await c.push({path:"/trials/create",query:{duplicate:P,edit:"true"}})}async function fe(P){var Y;const D=await r(P);D.ok?(oe.success("Trial deleted"),h.value===P&&(h.value=null)):oe.error(((Y=D.error)==null?void 0:Y.message)||"Unknown error")}async function Ae(P,D){var le;const Y=await b.dataExport.exportTrialData(P,{format:D,fields:void 0,includeHeaders:!0,addBOM:D==="excel"});Y.ok?oe.success(`Exported ${Y.value.recordCount} API calls to ${Y.value.filename}`):oe.error(((le=Y.error)==null?void 0:le.message)||"Unknown error")}async function We(P){var Y;const D=await b.pythonGeneration.generatePythonScript(P,{template:"basic",includeAnalysis:!0,includeComments:!0});D.ok?oe.success("Python script exported"):oe.error(((Y=D.error)==null?void 0:Y.message)||"Unknown error")}return ue(()=>i.query.trialId,P=>{P&&P!==h.value&&S(P)}),ue(y,(P,D)=>{const Y=performance.now();m.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${D} to ${P} at ${Y}`),P||m.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),ue(t,(P,D)=>{const Y=performance.now();m.info(`V4_TRIAL_SWITCH: trials array changed from ${(D==null?void 0:D.length)||0} to ${P.length} trials at ${Y}`)},{immediate:!0}),me(async()=>{const P=performance.now();m.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${P}`);const D=performance.now();m.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(D-P).toFixed(1)}ms`);try{await e.initialize();const He=performance.now();m.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(He-D).toFixed(1)}ms`)}catch(He){const xt=performance.now();m.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(xt-D).toFixed(1)}ms:`,He)}const Y=performance.now();window.addEventListener("keydown",te),m.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(Y-P).toFixed(1)}ms`);const le=performance.now();m.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(le-P).toFixed(1)}ms`),await Te();const ve=performance.now();m.info(`V4_TRIAL_SWITCH: nextTick completed in ${(ve-le).toFixed(1)}ms`);const ne=performance.now();y.value=!1,m.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(ne-P).toFixed(1)}ms`);const _e=performance.now();m.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(_e-P).toFixed(1)}ms`),await x();const Fe=performance.now();m.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Fe-_e).toFixed(1)}ms`);const Se=performance.now();m.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(Se-P).toFixed(1)}ms`),a();const Mt=performance.now();m.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Mt-Se).toFixed(1)}ms`);const Dt=performance.now();m.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(Dt-P).toFixed(1)}ms`)}),he(()=>{m.info("V4_SINGLETON_DEBUG: TrialsViewV3 onUnmounted() - NOT calling v4ExecutionControl.cleanup() to preserve singleton"),window.removeEventListener("keydown",te),u.destroy(),m.info("V4_SINGLETON_DEBUG: V4 execution system preserved, initialized flag should remain true")}),(P,D)=>{const Y=Z("router-link"),le=Z("a-button");return o(),f("div",Au,[T.value?(o(),f("div",Fu,[s("div",Ou,[V(W(Et),{class:"warning-icon"}),D[1]||(D[1]=s("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),V(Y,{to:"/settings",class:"settings-link"},{default:L(()=>D[0]||(D[0]=[N("Go to Settings")])),_:1,__:[0]}),V(W(Tt),{class:"close-icon",onClick:ye})]),D[2]||(D[2]=s("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):A("",!0),W(E)?A("",!0):(o(),f("div",Lu,[s("div",Pu,[V(W(ls),{class:"observer-icon"}),D[3]||(D[3]=s("span",null,[s("strong",null,"Observer Mode: Multiple Tabs Detected")],-1)),D[4]||(D[4]=s("div",{class:"leader-hint"}," You can only open one Auditomatic tab at a time. Close other tabs, or refresh if this is your only tab. Your templates and trials are safely saved. ",-1))])])),V(Ss,{ref_key:"splitPanel",ref:g,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:ae,onMobileOverlayChange:pe},{left:L(()=>[y.value?(o(),f("div",Mu," Loading trials... ")):(o(),J(xa,{key:0,trials:W(t),"selected-trial-id":h.value,"search-query":$.value,"filter-status":I.value,onSelectTrial:S,onCreateTrial:ke,onUpdateSearch:U,onUpdateFilter:C,onRefresh:G},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:L(()=>[(o(),J(qe,{max:5},[h.value?(o(),J(Vu,{key:h.value,trial:W(p),"is-leader":W(E),"execution-state":W(v),progress:O.value,onStartTrial:Ve,onPauseTrial:z,onResumeTrial:K,onCancelTrial:B,onDuplicateTrial:Q,onEditTrial:de,onDeleteTrial:fe,onExportData:Ae,onExportPython:We},null,8,["trial","is-leader","execution-state","progress"])):A("",!0)],1024)),!h.value||!W(p)?Ce((o(),f("div",Du,[V(W(os),{class:"empty-icon"}),D[6]||(D[6]=s("h3",null,"Select a trial to view details",-1)),D[7]||(D[7]=s("p",null,"Choose from the list or create a new one",-1)),V(le,{type:"primary",size:"large",disabled:!W(E),onClick:ke},{default:L(()=>D[5]||(D[5]=[N(" Create New Trial ")])),_:1,__:[5]},8,["disabled"]),W(E)?A("",!0):(o(),f("div",xu," Close other tabs to enable trial creation "))],512)),[[St,!y.value]]):A("",!0)]),_:1},512)])}}}),Yu=re(Uu,[["__scopeId","data-v-d3804fd9"]]);export{Yu as default};

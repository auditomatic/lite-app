var e=Object.defineProperty,t=(t,r,a)=>((t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a)(t,"symbol"!=typeof r?r+"":r,a);import{d as r,r as a,b as s,e as o,f as n,k as i,m as c,F as l,A as d,t as u,g as m,n as p,L as f,o as h,i as v,w as y,a0 as g,E as _,Y as $,u as b,Z as w,p as k}from"./vendor-w2iEWTO6.js";import{d as S,_ as E,b as P}from"./index-BO1xIGYv.js";import{P as j,T as x}from"./TaskDetailModal-Cxjf6xNQ.js";import{g as C}from"./db-BfRGDvSu.js";import"./apiLogger-DxGnFuqw.js";var N={exports:{}},R={},O={},I={},T={},M={},D={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class a extends t{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function s(e,...t){const r=[e[0]];let s=0;for(;s<t.length;)i(r,t[s]),r.push(e[++s]);return new a(r)}e._Code=a,e.nil=new a(""),e._=s;const o=new a("+");function n(e,...t){const r=[l(e[0])];let s=0;for(;s<t.length;)r.push(o),i(r,t[s]),r.push(o,l(e[++s]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===o){const r=c(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new a(r)}function i(e,t){var s;t instanceof a?e.push(...t._items):t instanceof r?e.push(t):e.push("number"==typeof(s=t)||"boolean"==typeof s||null===s?s:l(Array.isArray(s)?s.join(","):s))}function c(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof r||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function l(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=n,e.addCodeArg=i,e.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:n`${e}${t}`},e.stringify=function(e){return new a(l(e))},e.safeStringify=l,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new a(`.${t}`):s`[${t}]`},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new a(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)},e.regexpCode=function(e){return new a(e.toString())}}(D);var z={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=D;class r extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var a,s;(s=a||(e.UsedValueState=a={}))[s.Started=0]="Started",s[s.Completed=1]="Completed",e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof t.Name?e:this.name(e)}name(e){return new t.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}e.Scope=o;class n extends t.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:r,itemIndex:a}){this.value=e,this.scopePath=t._`.${new t.Name(r)}[${a}]`}}e.ValueScopeName=n;const i=t._`\n`;e.ValueScope=class extends o{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?i:t.nil}}get(){return this._scope}name(e){return new n(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const a=this.toName(e),{prefix:s}=a,o=null!==(r=t.key)&&void 0!==r?r:t.ref;let n=this._values[s];if(n){const e=n.get(o);if(e)return e}else n=this._values[s]=new Map;n.set(o,a);const i=this._scope[s]||(this._scope[s]=[]),c=i.length;return i[c]=t.ref,a.setValue(t,{property:s,itemIndex:c}),a}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,r=this._values){return this._reduceValues(r,r=>{if(void 0===r.scopePath)throw new Error(`CodeGen: name "${r}" has no value`);return t._`${e}${r.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(s,o,n={},i){let c=t.nil;for(const l in s){const d=s[l];if(!d)continue;const u=n[l]=n[l]||new Map;d.forEach(s=>{if(u.has(s))return;u.set(s,a.Started);let n=o(s);if(n){const r=this.opts.es5?e.varKinds.var:e.varKinds.const;c=t._`${c}${r} ${s} = ${n};${this.opts._n}`}else{if(!(n=null==i?void 0:i(s)))throw new r(s);c=t._`${c}${n}${this.opts._n}`}u.set(s,a.Completed)})}return c}}}(z),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=D,r=z;var a=D;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return a._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return a.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return a.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return a.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return a.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return a.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return a.Name}});var s=z;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(e,t){return this}}class n extends o{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const a=e?r.varKinds.var:this.varKind,s=void 0===this.rhs?"":` = ${this.rhs}`;return`${a} ${this.name}${s};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=C(this.rhs,e,t)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class i extends o{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=C(this.rhs,e,r),this}get names(){return x(this.lhs instanceof t.Name?{}:{...this.lhs.names},this.rhs)}}class c extends i{constructor(e,t,r,a){super(e,r,a),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class l extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class d extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}}class u extends o{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class m extends o{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=C(this.code,e,t),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class p extends o{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let a=r.length;for(;a--;){const s=r[a];s.optimizeNames(e,t)||(N(e,s.names),r.splice(a,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>j(e,t.names),{})}}class f extends p{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class h extends p{}class v extends f{}v.kind="else";class y extends f{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new v(e):e}return t?!1===e?t instanceof y?t:t.nodes:this.nodes.length?this:new y(R(e),t instanceof y?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=C(this.condition,e,t),this}get names(){const e=super.names;return x(e,this.condition),this.else&&j(e,this.else.names),e}}y.kind="if";class g extends f{}g.kind="for";class _ extends g{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=C(this.iteration,e,t),this}get names(){return j(super.names,this.iteration.names)}}class $ extends g{constructor(e,t,r,a){super(),this.varKind=e,this.name=t,this.from=r,this.to=a}render(e){const t=e.es5?r.varKinds.var:this.varKind,{name:a,from:s,to:o}=this;return`for(${t} ${a}=${s}; ${a}<${o}; ${a}++)`+super.render(e)}get names(){const e=x(super.names,this.from);return x(e,this.to)}}class b extends g{constructor(e,t,r,a){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=a}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=C(this.iterable,e,t),this}get names(){return j(super.names,this.iterable.names)}}class w extends f{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}w.kind="func";class k extends p{render(e){return"return "+super.render(e)}}k.kind="return";class S extends f{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,a;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(a=this.finally)||void 0===a||a.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&j(e,this.catch.names),this.finally&&j(e,this.finally.names),e}}class E extends f{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}E.kind="catch";class P extends f{render(e){return"finally"+super.render(e)}}P.kind="finally";function j(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function x(e,r){return r instanceof t._CodeOrName?j(e,r.names):e}function C(e,r,a){return e instanceof t.Name?o(e):(s=e)instanceof t._Code&&s._items.some(e=>e instanceof t.Name&&1===r[e.str]&&void 0!==a[e.str])?new t._Code(e._items.reduce((e,r)=>(r instanceof t.Name&&(r=o(r)),r instanceof t._Code?e.push(...r._items):e.push(r),e),[])):e;var s;function o(e){const t=a[e.str];return void 0===t||1!==r[e.str]?e:(delete r[e.str],t)}}function N(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function R(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:t._`!${M(e)}`}e.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new h]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,a){const s=this._scope.toName(t);return void 0!==r&&a&&(this._constants[s.str]=r),this._leafNode(new n(e,s,r)),s}const(e,t,a){return this._def(r.varKinds.const,e,t,a)}let(e,t,a){return this._def(r.varKinds.let,e,t,a)}var(e,t,a){return this._def(r.varKinds.var,e,t,a)}assign(e,t,r){return this._leafNode(new i(e,t,r))}add(t,r){return this._leafNode(new c(t,e.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==t.nil&&this._leafNode(new m(e)),this}object(...e){const r=["{"];for(const[a,s]of e)r.length>1&&r.push(","),r.push(a),(a!==s||this.opts.es5)&&(r.push(":"),(0,t.addCodeArg)(r,s));return r.push("}"),new t._Code(r)}if(e,t,r){if(this._blockNode(new y(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new y(e))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(y,v)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new _(e),t)}forRange(e,t,a,s,o=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const n=this._scope.toName(e);return this._for(new $(o,n,t,a),()=>s(n))}forOf(e,a,s,o=r.varKinds.const){const n=this._scope.toName(e);if(this.opts.es5){const e=a instanceof t.Name?a:this.var("_arr",a);return this.forRange("_i",0,t._`${e}.length`,r=>{this.var(n,t._`${e}[${r}]`),s(n)})}return this._for(new b("of",o,n,a),()=>s(n))}forIn(e,a,s,o=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,t._`Object.keys(${a})`,s);const n=this._scope.toName(e);return this._for(new b("in",o,n,a),()=>s(n))}endFor(){return this._endBlockNode(g)}label(e){return this._leafNode(new l(e))}break(e){return this._leafNode(new d(e))}return(e){const t=new k;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const a=new S;if(this._blockNode(a),this.code(e),t){const e=this.name("e");this._currNode=a.catch=new E(e),t(e)}return r&&(this._currNode=a.finally=new P,this.code(r)),this._endBlockNode(E,P)}throw(e){return this._leafNode(new u(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,r=t.nil,a,s){return this._blockNode(new w(e,r,a)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(w)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},e.not=R;const O=T(e.operators.AND);e.and=function(...e){return e.reduce(O)};const I=T(e.operators.OR);function T(e){return(r,a)=>r===t.nil?a:a===t.nil?r:t._`${M(r)} ${e} ${M(a)}`}function M(e){return e instanceof t.Name?e:t._`(${e})`}e.or=function(...e){return e.reduce(I)}}(M);var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.checkStrictMode=A.getErrorPath=A.Type=A.useFunc=A.setEvaluated=A.evaluatedPropsToName=A.mergeEvaluated=A.eachItem=A.unescapeJsonPointer=A.escapeJsonPointer=A.escapeFragment=A.unescapeFragment=A.schemaRefOrVal=A.schemaHasRulesButRef=A.schemaHasRules=A.checkUnknownRules=A.alwaysValidSchema=A.toHash=void 0;const V=M,q=D;function U(e,t=e.schema){const{opts:r,self:a}=e;if(!r.strictSchema)return;if("boolean"==typeof t)return;const s=a.RULES.keywords;for(const o in t)s[o]||Q(e,`unknown keyword: "${o}"`)}function F(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function L(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function K(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function G({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:a}){return(s,o,n,i)=>{const c=void 0===n?o:n instanceof V.Name?(o instanceof V.Name?e(s,o,n):t(s,o,n),n):o instanceof V.Name?(t(s,n,o),o):r(o,n);return i!==V.Name||c instanceof V.Name?c:a(s,c)}}function B(e,t){if(!0===t)return e.var("props",!0);const r=e.var("props",V._`{}`);return void 0!==t&&J(e,r,t),r}function J(e,t,r){Object.keys(r).forEach(r=>e.assign(V._`${t}${(0,V.getProperty)(r)}`,!0))}A.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},A.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(U(e,t),!F(t,e.self.RULES.all))},A.checkUnknownRules=U,A.schemaHasRules=F,A.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},A.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,a,s){if(!s){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return V._`${r}`}return V._`${e}${t}${(0,V.getProperty)(a)}`},A.unescapeFragment=function(e){return K(decodeURIComponent(e))},A.escapeFragment=function(e){return encodeURIComponent(L(e))},A.escapeJsonPointer=L,A.unescapeJsonPointer=K,A.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},A.mergeEvaluated={props:G({mergeNames:(e,t,r)=>e.if(V._`${r} !== true && ${t} !== undefined`,()=>{e.if(V._`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,V._`${r} || {}`).code(V._`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if(V._`${r} !== true`,()=>{!0===t?e.assign(r,!0):(e.assign(r,V._`${r} || {}`),J(e,r,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:B}),items:G({mergeNames:(e,t,r)=>e.if(V._`${r} !== true && ${t} !== undefined`,()=>e.assign(r,V._`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if(V._`${r} !== true`,()=>e.assign(r,!0===t||V._`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},A.evaluatedPropsToName=B,A.setEvaluated=J;const H={};var W,Z;function Q(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}A.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:H[t.code]||(H[t.code]=new q._Code(t.code))})},(Z=W||(A.Type=W={}))[Z.Num=0]="Num",Z[Z.Str=1]="Str",A.getErrorPath=function(e,t,r){if(e instanceof V.Name){const a=t===W.Num;return r?a?V._`"[" + ${e} + "]"`:V._`"['" + ${e} + "']"`:a?V._`"/" + ${e}`:V._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,V.getProperty)(e).toString():"/"+L(e)},A.checkStrictMode=Q;var Y={};Object.defineProperty(Y,"__esModule",{value:!0});const X=M,ee={data:new X.Name("data"),valCxt:new X.Name("valCxt"),instancePath:new X.Name("instancePath"),parentData:new X.Name("parentData"),parentDataProperty:new X.Name("parentDataProperty"),rootData:new X.Name("rootData"),dynamicAnchors:new X.Name("dynamicAnchors"),vErrors:new X.Name("vErrors"),errors:new X.Name("errors"),this:new X.Name("this"),self:new X.Name("self"),scope:new X.Name("scope"),json:new X.Name("json"),jsonPos:new X.Name("jsonPos"),jsonLen:new X.Name("jsonLen"),jsonPart:new X.Name("jsonPart")};var te;Y.default=ee,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=M,r=A,a=Y;function s(e,r){const s=e.const("err",r);e.if(t._`${a.default.vErrors} === null`,()=>e.assign(a.default.vErrors,t._`[${s}]`),t._`${a.default.vErrors}.push(${s})`),e.code(t._`${a.default.errors}++`)}function o(e,r){const{gen:a,validateName:s,schemaEnv:o}=e;o.$async?a.throw(t._`new ${e.ValidationError}(${r})`):(a.assign(t._`${s}.errors`,r),a.return(!1))}e.keywordError={message:({keyword:e})=>t.str`must pass "${e}" keyword validation`},e.keyword$DataError={message:({keyword:e,schemaType:r})=>r?t.str`"${e}" keyword must be ${r} ($data)`:t.str`"${e}" keyword is invalid ($data)`},e.reportError=function(r,a=e.keywordError,n,c){const{it:l}=r,{gen:d,compositeRule:u,allErrors:m}=l,p=i(r,a,n);(null!=c?c:u||m)?s(d,p):o(l,t._`[${p}]`)},e.reportExtraError=function(t,r=e.keywordError,n){const{it:c}=t,{gen:l,compositeRule:d,allErrors:u}=c;s(l,i(t,r,n)),d||u||o(c,a.default.vErrors)},e.resetErrorsCount=function(e,r){e.assign(a.default.errors,r),e.if(t._`${a.default.vErrors} !== null`,()=>e.if(r,()=>e.assign(t._`${a.default.vErrors}.length`,r),()=>e.assign(a.default.vErrors,null)))},e.extendErrors=function({gen:e,keyword:r,schemaValue:s,data:o,errsCount:n,it:i}){if(void 0===n)throw new Error("ajv implementation error");const c=e.name("err");e.forRange("i",n,a.default.errors,n=>{e.const(c,t._`${a.default.vErrors}[${n}]`),e.if(t._`${c}.instancePath === undefined`,()=>e.assign(t._`${c}.instancePath`,(0,t.strConcat)(a.default.instancePath,i.errorPath))),e.assign(t._`${c}.schemaPath`,t.str`${i.errSchemaPath}/${r}`),i.opts.verbose&&(e.assign(t._`${c}.schema`,s),e.assign(t._`${c}.data`,o))})};const n={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function i(e,r,s){const{createErrors:o}=e.it;return!1===o?t._`{}`:function(e,r,s={}){const{gen:o,it:i}=e,d=[c(i,s),l(e,s)];return function(e,{params:r,message:s},o){const{keyword:i,data:c,schemaValue:l,it:d}=e,{opts:u,propertyName:m,topSchemaRef:p,schemaPath:f}=d;o.push([n.keyword,i],[n.params,"function"==typeof r?r(e):r||t._`{}`]),u.messages&&o.push([n.message,"function"==typeof s?s(e):s]);u.verbose&&o.push([n.schema,l],[n.parentSchema,t._`${p}${f}`],[a.default.data,c]);m&&o.push([n.propertyName,m])}(e,r,d),o.object(...d)}(e,r,s)}function c({errorPath:e},{instancePath:s}){const o=s?t.str`${e}${(0,r.getErrorPath)(s,r.Type.Str)}`:e;return[a.default.instancePath,(0,t.strConcat)(a.default.instancePath,o)]}function l({keyword:e,it:{errSchemaPath:a}},{schemaPath:s,parentSchema:o}){let i=o?a:t.str`${a}/${e}`;return s&&(i=t.str`${i}${(0,r.getErrorPath)(s,r.Type.Str)}`),[n.schemaPath,i]}}(T);var re={},ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.getRules=ae.isJSONType=void 0;const se=new Set(["string","number","integer","boolean","null","object","array"]);ae.isJSONType=function(e){return"string"==typeof e&&se.has(e)},ae.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var oe={};function ne(e,t){return t.rules.some(t=>ie(e,t))}function ie(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(oe,"__esModule",{value:!0}),oe.shouldUseRule=oe.shouldUseGroup=oe.schemaHasRulesForType=void 0,oe.schemaHasRulesForType=function({schema:e,self:t},r){const a=t.RULES.types[r];return a&&!0!==a&&ne(e,a)},oe.shouldUseGroup=ne,oe.shouldUseRule=ie,Object.defineProperty(re,"__esModule",{value:!0}),re.reportTypeError=re.checkDataTypes=re.checkDataType=re.coerceAndCheckDataType=re.getJSONTypes=re.getSchemaTypes=re.DataType=void 0;const ce=ae,le=oe,de=T,ue=M,me=A;var pe,fe;function he(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(ce.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}(fe=pe||(re.DataType=pe={}))[fe.Correct=0]="Correct",fe[fe.Wrong=1]="Wrong",re.getSchemaTypes=function(e){const t=he(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},re.getJSONTypes=he,re.coerceAndCheckDataType=function(e,t){const{gen:r,data:a,opts:s}=e,o=function(e,t){return t?e.filter(e=>ve.has(e)||"array"===t&&"array"===e):[]}(t,s.coerceTypes),n=t.length>0&&!(0===o.length&&1===t.length&&(0,le.schemaHasRulesForType)(e,t[0]));if(n){const n=ge(t,a,s.strictNumbers,pe.Wrong);r.if(n,()=>{o.length?function(e,t,r){const{gen:a,data:s,opts:o}=e,n=a.let("dataType",ue._`typeof ${s}`),i=a.let("coerced",ue._`undefined`);"array"===o.coerceTypes&&a.if(ue._`${n} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>a.assign(s,ue._`${s}[0]`).assign(n,ue._`typeof ${s}`).if(ge(t,s,o.strictNumbers),()=>a.assign(i,s)));a.if(ue._`${i} !== undefined`);for(const l of r)(ve.has(l)||"array"===l&&"array"===o.coerceTypes)&&c(l);function c(e){switch(e){case"string":return void a.elseIf(ue._`${n} == "number" || ${n} == "boolean"`).assign(i,ue._`"" + ${s}`).elseIf(ue._`${s} === null`).assign(i,ue._`""`);case"number":return void a.elseIf(ue._`${n} == "boolean" || ${s} === null
              || (${n} == "string" && ${s} && ${s} == +${s})`).assign(i,ue._`+${s}`);case"integer":return void a.elseIf(ue._`${n} === "boolean" || ${s} === null
              || (${n} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(i,ue._`+${s}`);case"boolean":return void a.elseIf(ue._`${s} === "false" || ${s} === 0 || ${s} === null`).assign(i,!1).elseIf(ue._`${s} === "true" || ${s} === 1`).assign(i,!0);case"null":return a.elseIf(ue._`${s} === "" || ${s} === 0 || ${s} === false`),void a.assign(i,null);case"array":a.elseIf(ue._`${n} === "string" || ${n} === "number"
              || ${n} === "boolean" || ${s} === null`).assign(i,ue._`[${s}]`)}}a.else(),$e(e),a.endIf(),a.if(ue._`${i} !== undefined`,()=>{a.assign(s,i),function({gen:e,parentData:t,parentDataProperty:r},a){e.if(ue._`${t} !== undefined`,()=>e.assign(ue._`${t}[${r}]`,a))}(e,i)})}(e,t,o):$e(e)})}return n};const ve=new Set(["string","number","integer","boolean","null"]);function ye(e,t,r,a=pe.Correct){const s=a===pe.Correct?ue.operators.EQ:ue.operators.NEQ;let o;switch(e){case"null":return ue._`${t} ${s} null`;case"array":o=ue._`Array.isArray(${t})`;break;case"object":o=ue._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=n(ue._`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=n();break;default:return ue._`typeof ${t} ${s} ${e}`}return a===pe.Correct?o:(0,ue.not)(o);function n(e=ue.nil){return(0,ue.and)(ue._`typeof ${t} == "number"`,e,r?ue._`isFinite(${t})`:ue.nil)}}function ge(e,t,r,a){if(1===e.length)return ye(e[0],t,r,a);let s;const o=(0,me.toHash)(e);if(o.array&&o.object){const e=ue._`typeof ${t} != "object"`;s=o.null?e:ue._`!${t} || ${e}`,delete o.null,delete o.array,delete o.object}else s=ue.nil;o.number&&delete o.integer;for(const n in o)s=(0,ue.and)(s,ye(n,t,r,a));return s}re.checkDataType=ye,re.checkDataTypes=ge;const _e={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?ue._`{type: ${e}}`:ue._`{type: ${t}}`};function $e(e){const t=function(e){const{gen:t,data:r,schema:a}=e,s=(0,me.schemaRefOrVal)(e,a,"type");return{gen:t,keyword:"type",data:r,schema:a.type,schemaCode:s,schemaValue:s,parentSchema:a,params:{},it:e}}(e);(0,de.reportError)(t,_e)}re.reportTypeError=$e;var be,we={};var ke={},Se={};Object.defineProperty(Se,"__esModule",{value:!0}),Se.validateUnion=Se.validateArray=Se.usePattern=Se.callValidateCode=Se.schemaProperties=Se.allSchemaProperties=Se.noPropertyInData=Se.propertyInData=Se.isOwnProperty=Se.hasPropFunc=Se.reportMissingProp=Se.checkMissingProp=Se.checkReportMissingProp=void 0;const Ee=M,Pe=A,je=Y,xe=A;function Ce(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:Ee._`Object.prototype.hasOwnProperty`})}function Ne(e,t,r){return Ee._`${Ce(e)}.call(${t}, ${r})`}function Re(e,t,r,a){const s=Ee._`${t}${(0,Ee.getProperty)(r)} === undefined`;return a?(0,Ee.or)(s,(0,Ee.not)(Ne(e,t,r))):s}function Oe(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}Se.checkReportMissingProp=function(e,t){const{gen:r,data:a,it:s}=e;r.if(Re(r,a,t,s.opts.ownProperties),()=>{e.setParams({missingProperty:Ee._`${t}`},!0),e.error()})},Se.checkMissingProp=function({gen:e,data:t,it:{opts:r}},a,s){return(0,Ee.or)(...a.map(a=>(0,Ee.and)(Re(e,t,a,r.ownProperties),Ee._`${s} = ${a}`)))},Se.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},Se.hasPropFunc=Ce,Se.isOwnProperty=Ne,Se.propertyInData=function(e,t,r,a){const s=Ee._`${t}${(0,Ee.getProperty)(r)} !== undefined`;return a?Ee._`${s} && ${Ne(e,t,r)}`:s},Se.noPropertyInData=Re,Se.allSchemaProperties=Oe,Se.schemaProperties=function(e,t){return Oe(t).filter(r=>!(0,Pe.alwaysValidSchema)(e,t[r]))},Se.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:a,schemaPath:s,errorPath:o},it:n},i,c,l){const d=l?Ee._`${e}, ${t}, ${a}${s}`:t,u=[[je.default.instancePath,(0,Ee.strConcat)(je.default.instancePath,o)],[je.default.parentData,n.parentData],[je.default.parentDataProperty,n.parentDataProperty],[je.default.rootData,je.default.rootData]];n.opts.dynamicRef&&u.push([je.default.dynamicAnchors,je.default.dynamicAnchors]);const m=Ee._`${d}, ${r.object(...u)}`;return c!==Ee.nil?Ee._`${i}.call(${c}, ${m})`:Ee._`${i}(${m})`};const Ie=Ee._`new RegExp`;var Te;function Me(){if(Te)return ke;Te=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.validateKeywordUsage=ke.validSchemaType=ke.funcKeywordCode=ke.macroKeywordCode=void 0;const e=M,t=Y,r=Se,a=T;function s(t){const{gen:r,data:a,it:s}=t;r.if(s.parentData,()=>r.assign(a,e._`${s.parentData}[${s.parentDataProperty}]`))}function o(t,r,a){if(void 0===a)throw new Error(`keyword "${r}" failed to compile`);return t.scopeValue("keyword","function"==typeof a?{ref:a}:{ref:a,code:(0,e.stringify)(a)})}return ke.macroKeywordCode=function(t,r){const{gen:a,keyword:s,schema:n,parentSchema:i,it:c}=t,l=r.macro.call(c.self,n,i,c),d=o(a,s,l);!1!==c.opts.validateSchema&&c.self.validateSchema(l,!0);const u=a.name("valid");t.subschema({schema:l,schemaPath:e.nil,errSchemaPath:`${c.errSchemaPath}/${s}`,topSchemaRef:d,compositeRule:!0},u),t.pass(u,()=>t.error(!0))},ke.funcKeywordCode=function(n,i){var c;const{gen:l,keyword:d,schema:u,parentSchema:m,$data:p,it:f}=n;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(f,i);const h=!p&&i.compile?i.compile.call(f.self,u,m,f):i.validate,v=o(l,d,h),y=l.let("valid");function g(a=(i.async?e._`await `:e.nil)){const s=f.opts.passContext?t.default.this:t.default.self,o=!("compile"in i&&!p||!1===i.schema);l.assign(y,e._`${a}${(0,r.callValidateCode)(n,v,s,o)}`,i.modifying)}function _(t){var r;l.if((0,e.not)(null!==(r=i.valid)&&void 0!==r?r:y),t)}n.block$data(y,function(){if(!1===i.errors)g(),i.modifying&&s(n),_(()=>n.error());else{const r=i.async?function(){const t=l.let("ruleErrs",null);return l.try(()=>g(e._`await `),r=>l.assign(y,!1).if(e._`${r} instanceof ${f.ValidationError}`,()=>l.assign(t,e._`${r}.errors`),()=>l.throw(r))),t}():function(){const t=e._`${v}.errors`;return l.assign(t,null),g(e.nil),t}();i.modifying&&s(n),_(()=>function(r,s){const{gen:o}=r;o.if(e._`Array.isArray(${s})`,()=>{o.assign(t.default.vErrors,e._`${t.default.vErrors} === null ? ${s} : ${t.default.vErrors}.concat(${s})`).assign(t.default.errors,e._`${t.default.vErrors}.length`),(0,a.extendErrors)(r)},()=>r.error())}(n,r))}}),n.ok(null!==(c=i.valid)&&void 0!==c?c:y)},ke.validSchemaType=function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e)},ke.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:a},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");const n=s.dependencies;if(null==n?void 0:n.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${o}: ${n.join(",")}`);if(s.validateSchema){if(!s.validateSchema(e[o])){const e=`keyword "${o}" value is invalid at path "${a}": `+r.errorsText(s.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}},ke}Se.usePattern=function({gen:e,it:{opts:t}},r){const a=t.unicodeRegExp?"u":"",{regExp:s}=t.code,o=s(r,a);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:Ee._`${"new RegExp"===s.code?Ie:(0,xe.useFunc)(e,s)}(${r}, ${a})`})},Se.validateArray=function(e){const{gen:t,data:r,keyword:a,it:s}=e,o=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return n(()=>t.assign(e,!1)),e}return t.var(o,!0),n(()=>t.break()),o;function n(s){const n=t.const("len",Ee._`${r}.length`);t.forRange("i",0,n,r=>{e.subschema({keyword:a,dataProp:r,dataPropType:Pe.Type.Num},o),t.if((0,Ee.not)(o),s)})}},Se.validateUnion=function(e){const{gen:t,schema:r,keyword:a,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(e=>(0,Pe.alwaysValidSchema)(s,e))&&!s.opts.unevaluated)return;const o=t.let("valid",!1),n=t.name("_valid");t.block(()=>r.forEach((r,s)=>{const i=e.subschema({keyword:a,schemaProp:s,compositeRule:!0},n);t.assign(o,Ee._`${o} || ${n}`);e.mergeValidEvaluated(i,n)||t.if((0,Ee.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))};var De,ze={};var Ae={},Ve=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var a,s,o;if(Array.isArray(t)){if((a=t.length)!=r.length)return!1;for(s=a;0!==s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((a=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=a;0!==s--;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=a;0!==s--;){var n=o[s];if(!e(t[n],r[n]))return!1}return!0}return t!=t&&r!=r},qe={exports:{}},Ue=qe.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),Fe(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function Fe(e,t,r,a,s,o,n,i,c,l){if(a&&"object"==typeof a&&!Array.isArray(a)){for(var d in t(a,s,o,n,i,c,l),a){var u=a[d];if(Array.isArray(u)){if(d in Ue.arrayKeywords)for(var m=0;m<u.length;m++)Fe(e,t,r,u[m],s+"/"+d+"/"+m,o,s,d,a,m)}else if(d in Ue.propsKeywords){if(u&&"object"==typeof u)for(var p in u)Fe(e,t,r,u[p],s+"/"+d+"/"+Le(p),o,s,d,a,p)}else(d in Ue.keywords||e.allKeys&&!(d in Ue.skipKeywords))&&Fe(e,t,r,u,s+"/"+d,o,s,d,a)}r(a,s,o,n,i,c,l)}}function Le(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Ue.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},Ue.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},Ue.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},Ue.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};var Ke=qe.exports;Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.getSchemaRefs=Ae.resolveUrl=Ae.normalizeId=Ae._getFullPath=Ae.getFullPath=Ae.inlineRef=void 0;const Ge=A,Be=Ve,Je=Ke,He=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);Ae.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!Ze(e):!!t&&Qe(e)<=t)};const We=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Ze(e){for(const t in e){if(We.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(Ze))return!0;if("object"==typeof r&&Ze(r))return!0}return!1}function Qe(e){let t=0;for(const r in e){if("$ref"===r)return 1/0;if(t++,!He.has(r)&&("object"==typeof e[r]&&(0,Ge.eachItem)(e[r],e=>t+=Qe(e)),t===1/0))return 1/0}return t}function Ye(e,t="",r){!1!==r&&(t=tt(t));const a=e.parse(t);return Xe(e,a)}function Xe(e,t){return e.serialize(t).split("#")[0]+"#"}Ae.getFullPath=Ye,Ae._getFullPath=Xe;const et=/#\/?$/;function tt(e){return e?e.replace(et,""):""}Ae.normalizeId=tt,Ae.resolveUrl=function(e,t,r){return r=tt(r),e.resolve(t,r)};const rt=/^[a-z_][-a-z0-9._]*$/i;var at;function st(){if(at)return O;at=1,Object.defineProperty(O,"__esModule",{value:!0}),O.getData=O.KeywordCxt=O.validateFunctionCode=void 0;const e=function(){if(te)return I;te=1,Object.defineProperty(I,"__esModule",{value:!0}),I.boolOrEmptySchema=I.topBoolOrEmptySchema=void 0;const e=T,t=M,r=Y,a={message:"boolean schema is false"};function s(t,r){const{gen:s,data:o}=t;(0,e.reportError)({gen:s,keyword:"false schema",data:o,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t},a,void 0,r)}return I.topBoolOrEmptySchema=function(e){const{gen:a,schema:o,validateName:n}=e;!1===o?s(e,!1):"object"==typeof o&&!0===o.$async?a.return(r.default.data):(a.assign(t._`${n}.errors`,null),a.return(!0))},I.boolOrEmptySchema=function(e,t){const{gen:r,schema:a}=e;!1===a?(r.var(t,!1),s(e)):r.var(t,!0)},I}(),t=re,r=oe,a=re,s=function(){if(be)return we;be=1,Object.defineProperty(we,"__esModule",{value:!0}),we.assignDefaults=void 0;const e=M,t=A;function r(r,a,s){const{gen:o,compositeRule:n,data:i,opts:c}=r;if(void 0===s)return;const l=e._`${i}${(0,e.getProperty)(a)}`;if(n)return void(0,t.checkStrictMode)(r,`default is ignored for: ${l}`);let d=e._`${l} === undefined`;"empty"===c.useDefaults&&(d=e._`${d} || ${l} === null || ${l} === ""`),o.if(d,e._`${l} = ${(0,e.stringify)(s)}`)}return we.assignDefaults=function(e,t){const{properties:a,items:s}=e.schema;if("object"===t&&a)for(const o in a)r(e,o,a[o].default);else"array"===t&&Array.isArray(s)&&s.forEach((t,a)=>r(e,a,t.default))},we}(),o=Me(),n=function(){if(De)return ze;De=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.extendSubschemaMode=ze.extendSubschemaData=ze.getSubschema=void 0;const e=M,t=A;return ze.getSubschema=function(r,{keyword:a,schemaProp:s,schema:o,schemaPath:n,errSchemaPath:i,topSchemaRef:c}){if(void 0!==a&&void 0!==o)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==a){const o=r.schema[a];return void 0===s?{schema:o,schemaPath:e._`${r.schemaPath}${(0,e.getProperty)(a)}`,errSchemaPath:`${r.errSchemaPath}/${a}`}:{schema:o[s],schemaPath:e._`${r.schemaPath}${(0,e.getProperty)(a)}${(0,e.getProperty)(s)}`,errSchemaPath:`${r.errSchemaPath}/${a}/${(0,t.escapeFragment)(s)}`}}if(void 0!==o){if(void 0===n||void 0===i||void 0===c)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:o,schemaPath:n,topSchemaRef:c,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')},ze.extendSubschemaData=function(r,a,{dataProp:s,dataPropType:o,data:n,dataTypes:i,propertyName:c}){if(void 0!==n&&void 0!==s)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:l}=a;if(void 0!==s){const{errorPath:n,dataPathArr:i,opts:c}=a;d(l.let("data",e._`${a.data}${(0,e.getProperty)(s)}`,!0)),r.errorPath=e.str`${n}${(0,t.getErrorPath)(s,o,c.jsPropertySyntax)}`,r.parentDataProperty=e._`${s}`,r.dataPathArr=[...i,r.parentDataProperty]}function d(e){r.data=e,r.dataLevel=a.dataLevel+1,r.dataTypes=[],a.definedProperties=new Set,r.parentData=a.data,r.dataNames=[...a.dataNames,e]}void 0!==n&&(d(n instanceof e.Name?n:l.let("data",n,!0)),void 0!==c&&(r.propertyName=c)),i&&(r.dataTypes=i)},ze.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:a,createErrors:s,allErrors:o}){void 0!==a&&(e.compositeRule=a),void 0!==s&&(e.createErrors=s),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r},ze}(),i=M,c=Y,l=Ae,d=A,u=T;function m({gen:e,validateName:t,schema:r,schemaEnv:a,opts:s},o){s.code.es5?e.func(t,i._`${c.default.data}, ${c.default.valCxt}`,a.$async,()=>{e.code(i._`"use strict"; ${p(r,s)}`),function(e,t){e.if(c.default.valCxt,()=>{e.var(c.default.instancePath,i._`${c.default.valCxt}.${c.default.instancePath}`),e.var(c.default.parentData,i._`${c.default.valCxt}.${c.default.parentData}`),e.var(c.default.parentDataProperty,i._`${c.default.valCxt}.${c.default.parentDataProperty}`),e.var(c.default.rootData,i._`${c.default.valCxt}.${c.default.rootData}`),t.dynamicRef&&e.var(c.default.dynamicAnchors,i._`${c.default.valCxt}.${c.default.dynamicAnchors}`)},()=>{e.var(c.default.instancePath,i._`""`),e.var(c.default.parentData,i._`undefined`),e.var(c.default.parentDataProperty,i._`undefined`),e.var(c.default.rootData,c.default.data),t.dynamicRef&&e.var(c.default.dynamicAnchors,i._`{}`)})}(e,s),e.code(o)}):e.func(t,i._`${c.default.data}, ${function(e){return i._`{${c.default.instancePath}="", ${c.default.parentData}, ${c.default.parentDataProperty}, ${c.default.rootData}=${c.default.data}${e.dynamicRef?i._`, ${c.default.dynamicAnchors}={}`:i.nil}}={}`}(s)}`,a.$async,()=>e.code(p(r,s)).code(o))}function p(e,t){const r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?i._`/*# sourceURL=${r} */`:i.nil}function f(t,r){v(t)&&(y(t),h(t))?function(e,t){const{schema:r,gen:a,opts:s}=e;s.$comment&&r.$comment&&_(e);(function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,l.resolveUrl)(e.opts.uriResolver,e.baseId,t))})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=a.const("_errs",c.default.errors);g(e,o),a.var(t,i._`${o} === ${c.default.errors}`)}(t,r):(0,e.boolOrEmptySchema)(t,r)}function h({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function v(e){return"boolean"!=typeof e.schema}function y(e){(0,d.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:r,opts:a,self:s}=e;t.$ref&&a.ignoreKeywordsWithRef&&(0,d.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function g(e,r){if(e.opts.jtd)return $(e,[],!1,r);const a=(0,t.getSchemaTypes)(e.schema);$(e,a,!(0,t.coerceAndCheckDataType)(e,a),r)}function _({gen:e,schemaEnv:t,schema:r,errSchemaPath:a,opts:s}){const o=r.$comment;if(!0===s.$comment)e.code(i._`${c.default.self}.logger.log(${o})`);else if("function"==typeof s.$comment){const r=i.str`${a}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code(i._`${c.default.self}.opts.$comment(${o}, ${r}, ${s}.schema)`)}}function $(e,t,s,o){const{gen:n,schema:l,data:u,allErrors:m,opts:p,self:f}=e,{RULES:h}=f;function v(d){(0,r.shouldUseGroup)(l,d)&&(d.type?(n.if((0,a.checkDataType)(d.type,u,p.strictNumbers)),b(e,d),1===t.length&&t[0]===d.type&&s&&(n.else(),(0,a.reportTypeError)(e)),n.endIf()):b(e,d),m||n.if(i._`${c.default.errors} === ${o||0}`))}!l.$ref||!p.ignoreKeywordsWithRef&&(0,d.schemaHasRulesButRef)(l,h)?(p.jtd||function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(t=>{k(e.dataTypes,t)||S(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),function(e,t){const r=[];for(const a of e.dataTypes)k(t,a)?r.push(a):t.includes("integer")&&"number"===a&&r.push("integer");e.dataTypes=r}(e,t)})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&S(e,"use allowUnionTypes to allow union type keyword")}(e,t);!function(e,t){const a=e.self.RULES.all;for(const s in a){const o=a[s];if("object"==typeof o&&(0,r.shouldUseRule)(e.schema,o)){const{type:r}=o.definition;r.length&&!r.some(e=>w(t,e))&&S(e,`missing type "${r.join(",")}" for keyword "${s}"`)}}}(e,e.dataTypes)}(e,t),n.block(()=>{for(const e of h.rules)v(e);v(h.post)})):n.block(()=>P(e,"$ref",h.all.$ref.definition))}function b(e,t){const{gen:a,schema:o,opts:{useDefaults:n}}=e;n&&(0,s.assignDefaults)(e,t.type),a.block(()=>{for(const a of t.rules)(0,r.shouldUseRule)(o,a)&&P(e,a.keyword,a.definition,t.type)})}function w(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function k(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function S(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,d.checkStrictMode)(e,t,e.opts.strictTypes)}O.validateFunctionCode=function(t){v(t)&&(y(t),h(t))?function(e){const{schema:t,opts:r,gen:a}=e;m(e,()=>{r.$comment&&t.$comment&&_(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,d.checkStrictMode)(e,"default is ignored in the schema root")}(e),a.let(c.default.vErrors,null),a.let(c.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",i._`${r}.evaluated`),t.if(i._`${e.evaluated}.dynamicProps`,()=>t.assign(i._`${e.evaluated}.props`,i._`undefined`)),t.if(i._`${e.evaluated}.dynamicItems`,()=>t.assign(i._`${e.evaluated}.items`,i._`undefined`))}(e),g(e),function(e){const{gen:t,schemaEnv:r,validateName:a,ValidationError:s,opts:o}=e;r.$async?t.if(i._`${c.default.errors} === 0`,()=>t.return(c.default.data),()=>t.throw(i._`new ${s}(${c.default.vErrors})`)):(t.assign(i._`${a}.errors`,c.default.vErrors),o.unevaluated&&function({gen:e,evaluated:t,props:r,items:a}){r instanceof i.Name&&e.assign(i._`${t}.props`,r);a instanceof i.Name&&e.assign(i._`${t}.items`,a)}(e),t.return(i._`${c.default.errors} === 0`))}(e)})}(t):m(t,()=>(0,e.topBoolOrEmptySchema)(t))};class E{constructor(e,t,r){if((0,o.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,d.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",C(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,o.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",c.default.errors))}result(e,t,r){this.failResult((0,i.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,i.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(i._`${t} !== undefined && (${(0,i.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?u.reportExtraError:u.reportError)(this,this.def.error,t)}$dataError(){(0,u.reportError)(this,this.def.$dataError||u.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,u.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=i.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=i.nil,t=i.nil){if(!this.$data)return;const{gen:r,schemaCode:a,schemaType:s,def:o}=this;r.if((0,i.or)(i._`${a} === undefined`,t)),e!==i.nil&&r.assign(e,!0),(s.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==i.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:s,it:o}=this;return(0,i.or)(function(){if(r.length){if(!(t instanceof i.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return i._`${(0,a.checkDataTypes)(e,t,o.opts.strictNumbers,a.DataType.Wrong)}`}return i.nil}(),function(){if(s.validateSchema){const r=e.scopeValue("validate$data",{ref:s.validateSchema});return i._`!${r}(${t})`}return i.nil}())}subschema(e,t){const r=(0,n.getSubschema)(this.it,e);(0,n.extendSubschemaData)(r,this.it,e),(0,n.extendSubschemaMode)(r,e);const a={...this.it,...r,items:void 0,props:void 0};return f(a,t),a}mergeEvaluated(e,t){const{it:r,gen:a}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=d.mergeEvaluated.props(a,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=d.mergeEvaluated.items(a,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:a}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return a.if(t,()=>this.mergeEvaluated(e,i.Name)),!0}}function P(e,t,r,a){const s=new E(e,r,t);"code"in r?r.code(s,a):s.$data&&r.validate?(0,o.funcKeywordCode)(s,r):"macro"in r?(0,o.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,o.funcKeywordCode)(s,r)}O.KeywordCxt=E;const j=/^\/(?:[^~]|~0|~1)*$/,x=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function C(e,{dataLevel:t,dataNames:r,dataPathArr:a}){let s,o;if(""===e)return c.default.rootData;if("/"===e[0]){if(!j.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);s=e,o=c.default.rootData}else{const n=x.exec(e);if(!n)throw new Error(`Invalid JSON-pointer: ${e}`);const i=+n[1];if(s=n[2],"#"===s){if(i>=t)throw new Error(u("property/index",i));return a[t-i]}if(i>t)throw new Error(u("data",i));if(o=r[t-i],!s)return o}let n=o;const l=s.split("/");for(const c of l)c&&(o=i._`${o}${(0,i.getProperty)((0,d.unescapeJsonPointer)(c))}`,n=i._`${n} && ${o}`);return n;function u(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}return O.getData=C,O}Ae.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:r,uriResolver:a}=this.opts,s=tt(e[r]||t),o={"":s},n=Ye(a,s,!1),i={},c=new Set;return Je(e,{allKeys:!0},(e,t,a,s)=>{if(void 0===s)return;const u=n+t;let m=o[s];function p(t){const r=this.opts.uriResolver.resolve;if(t=tt(m?r(m,t):t),c.has(t))throw d(t);c.add(t);let a=this.refs[t];return"string"==typeof a&&(a=this.refs[a]),"object"==typeof a?l(e,a.schema,t):t!==tt(u)&&("#"===t[0]?(l(e,i[t],t),i[t]=e):this.refs[t]=u),t}function f(e){if("string"==typeof e){if(!rt.test(e))throw new Error(`invalid anchor "${e}"`);p.call(this,`#${e}`)}}"string"==typeof e[r]&&(m=p.call(this,e[r])),f.call(this,e.$anchor),f.call(this,e.$dynamicAnchor),o[t]=m}),i;function l(e,t,r){if(void 0!==t&&!Be(e,t))throw d(r)}function d(e){return new Error(`reference "${e}" resolves to more than one schema`)}};var ot,nt={};function it(){if(ot)return nt;ot=1,Object.defineProperty(nt,"__esModule",{value:!0});class e extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}return nt.default=e,nt}var ct={};Object.defineProperty(ct,"__esModule",{value:!0});const lt=Ae;class dt extends Error{constructor(e,t,r,a){super(a||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,lt.resolveUrl)(e,t,r),this.missingSchema=(0,lt.normalizeId)((0,lt.getFullPath)(e,this.missingRef))}}ct.default=dt;var ut={};Object.defineProperty(ut,"__esModule",{value:!0}),ut.resolveSchema=ut.getCompilingSchema=ut.resolveRef=ut.compileSchema=ut.SchemaEnv=void 0;const mt=M,pt=it(),ft=Y,ht=Ae,vt=A,yt=st();class gt{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,ht.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function _t(e){const t=bt.call(this,e);if(t)return t;const r=(0,ht.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:a,lines:s}=this.opts.code,{ownProperties:o}=this.opts,n=new mt.CodeGen(this.scope,{es5:a,lines:s,ownProperties:o});let i;e.$async&&(i=n.scopeValue("Error",{ref:pt.default,code:mt._`require("ajv/dist/runtime/validation_error").default`}));const c=n.scopeName("validate");e.validateName=c;const l={gen:n,allErrors:this.opts.allErrors,data:ft.default.data,parentData:ft.default.parentData,parentDataProperty:ft.default.parentDataProperty,dataNames:[ft.default.data],dataPathArr:[mt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:n.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,mt.stringify)(e.schema)}:{ref:e.schema}),validateName:c,ValidationError:i,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:mt.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:mt._`""`,opts:this.opts,self:this};let d;try{this._compilations.add(e),(0,yt.validateFunctionCode)(l),n.optimize(this.opts.code.optimize);const t=n.toString();d=`${n.scopeRefs(ft.default.scope)}return ${t}`,this.opts.code.process&&(d=this.opts.code.process(d,e));const r=new Function(`${ft.default.self}`,`${ft.default.scope}`,d)(this,this.scope.get());if(this.scope.value(c,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:c,validateCode:t,scopeValues:n._values}),this.opts.unevaluated){const{props:e,items:t}=l;r.evaluated={props:e instanceof mt.Name?void 0:e,items:t instanceof mt.Name?void 0:t,dynamicProps:e instanceof mt.Name,dynamicItems:t instanceof mt.Name},r.source&&(r.source.evaluated=(0,mt.stringify)(r.evaluated))}return e.validate=r,e}catch(u){throw delete e.validate,delete e.validateName,d&&this.logger.error("Error compiling schema, function code:",d),u}finally{this._compilations.delete(e)}}function $t(e){return(0,ht.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:_t.call(this,e)}function bt(e){for(const t of this._compilations)if(wt(t,e))return t}function wt(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function kt(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||St.call(this,e,t)}function St(e,t){const r=this.opts.uriResolver.parse(t),a=(0,ht._getFullPath)(this.opts.uriResolver,r);let s=(0,ht.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&a===s)return Pt.call(this,r,e);const o=(0,ht.normalizeId)(a),n=this.refs[o]||this.schemas[o];if("string"==typeof n){const t=St.call(this,e,n);if("object"!=typeof(null==t?void 0:t.schema))return;return Pt.call(this,r,t)}if("object"==typeof(null==n?void 0:n.schema)){if(n.validate||_t.call(this,n),o===(0,ht.normalizeId)(t)){const{schema:t}=n,{schemaId:r}=this.opts,a=t[r];return a&&(s=(0,ht.resolveUrl)(this.opts.uriResolver,s,a)),new gt({schema:t,schemaId:r,root:e,baseId:s})}return Pt.call(this,r,n)}}ut.SchemaEnv=gt,ut.compileSchema=_t,ut.resolveRef=function(e,t,r){var a;r=(0,ht.resolveUrl)(this.opts.uriResolver,t,r);const s=e.refs[r];if(s)return s;let o=kt.call(this,e,r);if(void 0===o){const s=null===(a=e.localRefs)||void 0===a?void 0:a[r],{schemaId:n}=this.opts;s&&(o=new gt({schema:s,schemaId:n,root:e,baseId:t}))}return void 0!==o?e.refs[r]=$t.call(this,o):void 0},ut.getCompilingSchema=bt,ut.resolveSchema=St;const Et=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Pt(e,{baseId:t,schema:r,root:a}){var s;if("/"!==(null===(s=e.fragment)||void 0===s?void 0:s[0]))return;for(const i of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;const e=r[(0,vt.unescapeFragment)(i)];if(void 0===e)return;const a="object"==typeof(r=e)&&r[this.opts.schemaId];!Et.has(i)&&a&&(t=(0,ht.resolveUrl)(this.opts.uriResolver,t,a))}let o;if("boolean"!=typeof r&&r.$ref&&!(0,vt.schemaHasRulesButRef)(r,this.RULES)){const e=(0,ht.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=St.call(this,a,e)}const{schemaId:n}=this.opts;return o=o||new gt({schema:r,schemaId:n,root:a,baseId:t}),o.schema!==o.root.schema?o:void 0}const jt={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var xt={},Ct={exports:{}};var Nt={HEX:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15}};const{HEX:Rt}=Nt,Ot=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function It(e){if(zt(e,".")<3)return{host:e,isIPV4:!1};const t=e.match(Ot)||[],[r]=t;return r?{host:Dt(r,"."),isIPV4:!0}:{host:e,isIPV4:!1}}function Tt(e,t=!1){let r="",a=!0;for(const s of e){if(void 0===Rt[s])return;"0"!==s&&!0===a&&(a=!1),a||(r+=s)}return t&&0===r.length&&(r="0"),r}function Mt(e){if(zt(e,":")<2)return{host:e,isIPV6:!1};const t=function(e){let t=0;const r={error:!1,address:"",zone:""},a=[],s=[];let o=!1,n=!1,i=!1;function c(){if(s.length){if(!1===o){const e=Tt(s);if(void 0===e)return r.error=!0,!1;a.push(e)}s.length=0}return!0}for(let l=0;l<e.length;l++){const d=e[l];if("["!==d&&"]"!==d)if(":"!==d)if("%"===d){if(!c())break;o=!0}else s.push(d);else{if(!0===n&&(i=!0),!c())break;if(t++,a.push(":"),t>7){r.error=!0;break}l-1>=0&&":"===e[l-1]&&(n=!0)}}return s.length&&(o?r.zone=s.join(""):i?a.push(s.join("")):a.push(Tt(s))),r.address=a.join(""),r}(e);if(t.error)return{host:e,isIPV6:!1};{let e=t.address,r=t.address;return t.zone&&(e+="%"+t.zone,r+="%25"+t.zone),{host:e,escapedHost:r,isIPV6:!0}}}function Dt(e,t){let r="",a=!0;const s=e.length;for(let o=0;o<s;o++){const n=e[o];"0"===n&&a?(o+1<=s&&e[o+1]===t||o+1===s)&&(r+=n,a=!1):(a=n===t,r+=n)}return r}function zt(e,t){let r=0;for(let a=0;a<e.length;a++)e[a]===t&&r++;return r}const At=/^\.\.?\//u,Vt=/^\/\.(?:\/|$)/u,qt=/^\/\.\.(?:\/|$)/u,Ut=/^\/?(?:.|\n)*?(?=\/|$)/u;var Ft={recomposeAuthority:function(e){const t=[];if(void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host){let r=unescape(e.host);const a=It(r);if(a.isIPV4)r=a.host;else{const t=Mt(a.host);r=!0===t.isIPV6?`[${t.escapedHost}]`:e.host}t.push(r)}return"number"!=typeof e.port&&"string"!=typeof e.port||(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0},normalizeComponentEncoding:function(e,t){const r=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=r(e.scheme)),void 0!==e.userinfo&&(e.userinfo=r(e.userinfo)),void 0!==e.host&&(e.host=r(e.host)),void 0!==e.path&&(e.path=r(e.path)),void 0!==e.query&&(e.query=r(e.query)),void 0!==e.fragment&&(e.fragment=r(e.fragment)),e},removeDotSegments:function(e){const t=[];for(;e.length;)if(e.match(At))e=e.replace(At,"");else if(e.match(Vt))e=e.replace(Vt,"/");else if(e.match(qt))e=e.replace(qt,"/"),t.pop();else if("."===e||".."===e)e="";else{const r=e.match(Ut);if(!r)throw new Error("Unexpected dot segment condition");{const a=r[0];e=e.slice(a.length),t.push(a)}}return t.join("")},normalizeIPv4:It,normalizeIPv6:Mt};const Lt=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,Kt=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function Gt(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}function Bt(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function Jt(e){const t="https"===String(e.scheme).toLowerCase();return e.port!==(t?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}const Ht={scheme:"http",domainHost:!0,parse:Bt,serialize:Jt},Wt={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=Gt(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if(e.port!==(Gt(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){const[t,r]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}},Zt={http:Ht,https:{scheme:"https",domainHost:Ht.domainHost,parse:Bt,serialize:Jt},ws:Wt,wss:{scheme:"wss",domainHost:Wt.domainHost,parse:Wt.parse,serialize:Wt.serialize},urn:{scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;const r=e.path.match(Kt);if(r){const a=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];const s=`${a}:${t.nid||e.nid}`,o=Zt[s];e.path=void 0,o&&(e=o.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){const r=t.scheme||e.scheme||"urn",a=e.nid.toLowerCase(),s=`${r}:${t.nid||a}`,o=Zt[s];o&&(e=o.serialize(e,t));const n=e,i=e.nss;return n.path=`${a||t.nid}:${i}`,t.skipEscape=!0,n},skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:function(e,t){const r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&Lt.test(r.uuid)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e){const t=e;return t.nss=(e.uuid||"").toLowerCase(),t},skipNormalize:!0}};var Qt=Zt;const{normalizeIPv6:Yt,normalizeIPv4:Xt,removeDotSegments:er,recomposeAuthority:tr,normalizeComponentEncoding:rr}=Ft,ar=Qt;function sr(e,t,r,a){const s={};return a||(e=cr(or(e,r),r),t=cr(or(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=er(t.path||""),s.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=er(t.path||""),s.query=t.query):(t.path?("/"===t.path.charAt(0)?s.path=er(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?s.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:s.path=t.path:s.path="/"+t.path,s.path=er(s.path)),s.query=t.query):(s.path=e.path,void 0!==t.query?s.query=t.query:s.query=e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s}function or(e,t){const r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},a=Object.assign({},t),s=[],o=ar[(a.scheme||r.scheme||"").toLowerCase()];o&&o.serialize&&o.serialize(r,a),void 0!==r.path&&(a.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),void 0!==r.scheme&&(r.path=r.path.split("%3A").join(":")))),"suffix"!==a.reference&&r.scheme&&s.push(r.scheme,":");const n=tr(r);if(void 0!==n&&("suffix"!==a.reference&&s.push("//"),s.push(n),r.path&&"/"!==r.path.charAt(0)&&s.push("/")),void 0!==r.path){let e=r.path;a.absolutePath||o&&o.absolutePath||(e=er(e)),void 0===n&&(e=e.replace(/^\/\//u,"/%2F")),s.push(e)}return void 0!==r.query&&s.push("?",r.query),void 0!==r.fragment&&s.push("#",r.fragment),s.join("")}const nr=Array.from({length:127},(e,t)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(t)));const ir=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function cr(e,t){const r=Object.assign({},t),a={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=-1!==e.indexOf("%");let o=!1;"suffix"===r.reference&&(e=(r.scheme?r.scheme+":":"")+"//"+e);const n=e.match(ir);if(n){if(a.scheme=n[1],a.userinfo=n[3],a.host=n[4],a.port=parseInt(n[5],10),a.path=n[6]||"",a.query=n[7],a.fragment=n[8],isNaN(a.port)&&(a.port=n[5]),a.host){const e=Xt(a.host);if(!1===e.isIPV4){const t=Yt(e.host);a.host=t.host.toLowerCase(),o=t.isIPV6}else a.host=e.host,o=!0}void 0!==a.scheme||void 0!==a.userinfo||void 0!==a.host||void 0!==a.port||void 0!==a.query||a.path?void 0===a.scheme?a.reference="relative":void 0===a.fragment?a.reference="absolute":a.reference="uri":a.reference="same-document",r.reference&&"suffix"!==r.reference&&r.reference!==a.reference&&(a.error=a.error||"URI is not a "+r.reference+" reference.");const e=ar[(r.scheme||a.scheme||"").toLowerCase()];if(!(r.unicodeSupport||e&&e.unicodeSupport)&&a.host&&(r.domainHost||e&&e.domainHost)&&!1===o&&function(e){let t=0;for(let r=0,a=e.length;r<a;++r)if(t=e.charCodeAt(r),t>126||nr[t])return!0;return!1}(a.host))try{a.host=URL.domainToASCII(a.host.toLowerCase())}catch(i){a.error=a.error||"Host's domain name can not be converted to ASCII: "+i}(!e||e&&!e.skipNormalize)&&(s&&void 0!==a.scheme&&(a.scheme=unescape(a.scheme)),s&&void 0!==a.host&&(a.host=unescape(a.host)),a.path&&(a.path=escape(unescape(a.path))),a.fragment&&(a.fragment=encodeURI(decodeURIComponent(a.fragment)))),e&&e.parse&&e.parse(a,r)}else a.error=a.error||"URI can not be parsed.";return a}const lr={SCHEMES:ar,normalize:function(e,t){return"string"==typeof e?e=or(cr(e,t),t):"object"==typeof e&&(e=cr(or(e,t),t)),e},resolve:function(e,t,r){const a=Object.assign({scheme:"null"},r);return or(sr(cr(e,a),cr(t,a),a,!0),{...a,skipEscape:!0})},resolveComponents:sr,equal:function(e,t,r){return"string"==typeof e?(e=unescape(e),e=or(rr(cr(e,r),!0),{...r,skipEscape:!0})):"object"==typeof e&&(e=or(rr(e,!0),{...r,skipEscape:!0})),"string"==typeof t?(t=unescape(t),t=or(rr(cr(t,r),!0),{...r,skipEscape:!0})):"object"==typeof t&&(t=or(rr(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()},serialize:or,parse:cr};Ct.exports=lr,Ct.exports.default=lr,Ct.exports.fastUri=lr;var dr=Ct.exports;Object.defineProperty(xt,"__esModule",{value:!0});const ur=dr;ur.code='require("ajv/dist/runtime/uri").default',xt.default=ur,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=st();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=M;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const a=it(),s=ct,o=ae,n=ut,i=M,c=Ae,l=re,d=A,u=jt,m=xt,p=(e,t)=>new RegExp(e,t);p.code="new RegExp";const f=["removeAdditional","useDefaults","coerceTypes"],h=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),v={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},y={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function g(e){var t,r,a,s,o,n,i,c,l,d,u,f,h,v,y,g,_,$,b,w,k,S,E,P,j;const x=e.strict,C=null===(t=e.code)||void 0===t?void 0:t.optimize,N=!0===C||void 0===C?1:C||0,R=null!==(a=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==a?a:p,O=null!==(s=e.uriResolver)&&void 0!==s?s:m.default;return{strictSchema:null===(n=null!==(o=e.strictSchema)&&void 0!==o?o:x)||void 0===n||n,strictNumbers:null===(c=null!==(i=e.strictNumbers)&&void 0!==i?i:x)||void 0===c||c,strictTypes:null!==(d=null!==(l=e.strictTypes)&&void 0!==l?l:x)&&void 0!==d?d:"log",strictTuples:null!==(f=null!==(u=e.strictTuples)&&void 0!==u?u:x)&&void 0!==f?f:"log",strictRequired:null!==(v=null!==(h=e.strictRequired)&&void 0!==h?h:x)&&void 0!==v&&v,code:e.code?{...e.code,optimize:N,regExp:R}:{optimize:N,regExp:R},loopRequired:null!==(y=e.loopRequired)&&void 0!==y?y:200,loopEnum:null!==(g=e.loopEnum)&&void 0!==g?g:200,meta:null===(_=e.meta)||void 0===_||_,messages:null===($=e.messages)||void 0===$||$,inlineRefs:null===(b=e.inlineRefs)||void 0===b||b,schemaId:null!==(w=e.schemaId)&&void 0!==w?w:"$id",addUsedSchema:null===(k=e.addUsedSchema)||void 0===k||k,validateSchema:null===(S=e.validateSchema)||void 0===S||S,validateFormats:null===(E=e.validateFormats)||void 0===E||E,unicodeRegExp:null===(P=e.unicodeRegExp)||void 0===P||P,int32range:null===(j=e.int32range)||void 0===j||j,uriResolver:O}}class _{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...g(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new i.ValueScope({scope:{},prefixes:h,es5:t,lines:r}),this.logger=function(e){if(!1===e)return P;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const a=e.validateFormats;e.validateFormats=!1,this.RULES=(0,o.getRules)(),$.call(this,v,e,"NOT SUPPORTED"),$.call(this,y,e,"DEPRECATED","warn"),this._metaOpts=E.call(this),e.formats&&k.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&S.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),w.call(this),e.validateFormats=a}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:r}=this.opts;let a=u;"id"===r&&(a={...u},a.id=a.$id,delete a.$id),t&&e&&this.addMetaSchema(a,a[r],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const a=r(t);return"$async"in r||(this.errors=r.errors),a}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return a.call(this,e,t);async function a(e,t){await o.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||n.call(this,r)}async function o(e){e&&!this.getSchema(e)&&await a.call(this,{$ref:e},!0)}async function n(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof s.default))throw t;return i.call(this,t),await c.call(this,t.missingSchema),n.call(this,e)}}function i({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function c(e){const r=await l.call(this,e);this.refs[e]||await o.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function l(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,a=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,a);return this}let s;if("object"==typeof e){const{schemaId:t}=this.opts;if(s=e[t],void 0!==s&&"string"!=typeof s)throw new Error(`schema ${t} must be string`)}return t=(0,c.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,a,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const a=this.validate(r,e);if(!a&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return a}getSchema(e){let t;for(;"string"==typeof(t=b.call(this,e));)e=t;if(void 0===t){const{schemaId:r}=this.opts,a=new n.SchemaEnv({schema:{},schemaId:r});if(t=n.resolveSchema.call(this,a,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=b.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e[this.opts.schemaId];return r&&(r=(0,c.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(x.call(this,r,t),!t)return(0,d.eachItem)(r,e=>C.call(this,e)),this;R.call(this,t);const a={...t,type:(0,l.getJSONTypes)(t.type),schemaType:(0,l.getJSONTypes)(t.schemaType)};return(0,d.eachItem)(r,0===a.type.length?e=>C.call(this,e,a):e=>a.type.forEach(t=>C.call(this,e,a,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.instancePath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const a of t){const t=a.split("/").slice(1);let s=e;for(const e of t)s=s[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:a}=t.definition,o=s[e];a&&o&&(s[e]=I(o))}}return e}_removeAllSchemas(e,t){for(const r in e){const a=e[r];t&&!t.test(r)||("string"==typeof a?delete e[r]:a&&!a.meta&&(this._cache.delete(a.schema),delete e[r]))}}_addSchema(e,t,r,a=this.opts.validateSchema,s=this.opts.addUsedSchema){let o;const{schemaId:i}=this.opts;if("object"==typeof e)o=e[i];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let l=this._cache.get(e);if(void 0!==l)return l;r=(0,c.normalizeId)(o||r);const d=c.getSchemaRefs.call(this,e,r);return l=new n.SchemaEnv({schema:e,schemaId:i,meta:t,baseId:r,localRefs:d}),this._cache.set(l.schema,l),s&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=l),a&&this.validateSchema(e,!0),l}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):n.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{n.compileSchema.call(this,e)}finally{this.opts=t}}}function $(e,t,r,a="error"){for(const s in e){const o=s;o in t&&this.logger[a](`${r}: option ${s}. ${e[o]}`)}}function b(e){return e=(0,c.normalizeId)(e),this.schemas[e]||this.refs[e]}function w(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function k(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function S(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function E(){const e={...this.opts};for(const t of f)delete e[t];return e}_.ValidationError=a.default,_.MissingRefError=s.default,e.default=_;const P={log(){},warn(){},error(){}};const j=/^[a-z_$][a-z0-9_$:-]*$/i;function x(e,t){const{RULES:r}=this;if((0,d.eachItem)(e,e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!j.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function C(e,t,r){var a;const s=null==t?void 0:t.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let n=s?o.post:o.rules.find(({type:e})=>e===r);if(n||(n={type:r,rules:[]},o.rules.push(n)),o.keywords[e]=!0,!t)return;const i={keyword:e,definition:{...t,type:(0,l.getJSONTypes)(t.type),schemaType:(0,l.getJSONTypes)(t.schemaType)}};t.before?N.call(this,n,i,t.before):n.rules.push(i),o.all[e]=i,null===(a=t.implements)||void 0===a||a.forEach(e=>this.addKeyword(e))}function N(e,t,r){const a=e.rules.findIndex(e=>e.keyword===r);a>=0?e.rules.splice(a,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function R(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=I(t)),e.validateSchema=this.compile(t,!0))}const O={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function I(e){return{anyOf:[e,O]}}}(R);var mr={},pr={},fr={};Object.defineProperty(fr,"__esModule",{value:!0});const hr={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};fr.default=hr;var vr={};Object.defineProperty(vr,"__esModule",{value:!0}),vr.callRef=vr.getValidate=void 0;const yr=ct,gr=Se,_r=M,$r=Y,br=ut,wr=A,kr={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:a}=e,{baseId:s,schemaEnv:o,validateName:n,opts:i,self:c}=a,{root:l}=o;if(("#"===r||"#/"===r)&&s===l.baseId)return function(){if(o===l)return Er(e,n,o,o.$async);const r=t.scopeValue("root",{ref:l});return Er(e,_r._`${r}.validate`,l,l.$async)}();const d=br.resolveRef.call(c,l,s,r);if(void 0===d)throw new yr.default(a.opts.uriResolver,s,r);return d instanceof br.SchemaEnv?function(t){const r=Sr(e,t);Er(e,r,t,t.$async)}(d):function(a){const s=t.scopeValue("schema",!0===i.code.source?{ref:a,code:(0,_r.stringify)(a)}:{ref:a}),o=t.name("valid"),n=e.subschema({schema:a,dataTypes:[],schemaPath:_r.nil,topSchemaRef:s,errSchemaPath:r},o);e.mergeEvaluated(n),e.ok(o)}(d)}};function Sr(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):_r._`${r.scopeValue("wrapper",{ref:t})}.validate`}function Er(e,t,r,a){const{gen:s,it:o}=e,{allErrors:n,schemaEnv:i,opts:c}=o,l=c.passContext?$r.default.this:_r.nil;function d(e){const t=_r._`${e}.errors`;s.assign($r.default.vErrors,_r._`${$r.default.vErrors} === null ? ${t} : ${$r.default.vErrors}.concat(${t})`),s.assign($r.default.errors,_r._`${$r.default.vErrors}.length`)}function u(e){var t;if(!o.opts.unevaluated)return;const a=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==o.props)if(a&&!a.dynamicProps)void 0!==a.props&&(o.props=wr.mergeEvaluated.props(s,a.props,o.props));else{const t=s.var("props",_r._`${e}.evaluated.props`);o.props=wr.mergeEvaluated.props(s,t,o.props,_r.Name)}if(!0!==o.items)if(a&&!a.dynamicItems)void 0!==a.items&&(o.items=wr.mergeEvaluated.items(s,a.items,o.items));else{const t=s.var("items",_r._`${e}.evaluated.items`);o.items=wr.mergeEvaluated.items(s,t,o.items,_r.Name)}}a?function(){if(!i.$async)throw new Error("async schema referenced by sync schema");const r=s.let("valid");s.try(()=>{s.code(_r._`await ${(0,gr.callValidateCode)(e,t,l)}`),u(t),n||s.assign(r,!0)},e=>{s.if(_r._`!(${e} instanceof ${o.ValidationError})`,()=>s.throw(e)),d(e),n||s.assign(r,!1)}),e.ok(r)}():e.result((0,gr.callValidateCode)(e,t,l),()=>u(t),()=>d(t))}vr.getValidate=Sr,vr.callRef=Er,vr.default=kr,Object.defineProperty(pr,"__esModule",{value:!0});const Pr=vr,jr=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",fr.default,Pr.default];pr.default=jr;var xr={},Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});const Nr=M,Rr=Nr.operators,Or={maximum:{okStr:"<=",ok:Rr.LTE,fail:Rr.GT},minimum:{okStr:">=",ok:Rr.GTE,fail:Rr.LT},exclusiveMaximum:{okStr:"<",ok:Rr.LT,fail:Rr.GTE},exclusiveMinimum:{okStr:">",ok:Rr.GT,fail:Rr.LTE}},Ir={message:({keyword:e,schemaCode:t})=>Nr.str`must be ${Or[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>Nr._`{comparison: ${Or[e].okStr}, limit: ${t}}`},Tr={keyword:Object.keys(Or),type:"number",schemaType:"number",$data:!0,error:Ir,code(e){const{keyword:t,data:r,schemaCode:a}=e;e.fail$data(Nr._`${r} ${Or[t].fail} ${a} || isNaN(${r})`)}};Cr.default=Tr;var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});const Dr=M,zr={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>Dr.str`must be multiple of ${e}`,params:({schemaCode:e})=>Dr._`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:a,it:s}=e,o=s.opts.multipleOfPrecision,n=t.let("res"),i=o?Dr._`Math.abs(Math.round(${n}) - ${n}) > 1e-${o}`:Dr._`${n} !== parseInt(${n})`;e.fail$data(Dr._`(${a} === 0 || (${n} = ${r}/${a}, ${i}))`)}};Mr.default=zr;var Ar={},Vr={};function qr(e){const t=e.length;let r,a=0,s=0;for(;s<t;)a++,r=e.charCodeAt(s++),r>=55296&&r<=56319&&s<t&&(r=e.charCodeAt(s),56320==(64512&r)&&s++);return a}Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.default=qr,qr.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(Ar,"__esModule",{value:!0});const Ur=M,Fr=A,Lr=Vr,Kr={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>Ur.str`must NOT have ${"maxLength"===e?"more":"fewer"} than ${t} characters`,params:({schemaCode:e})=>Ur._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a,it:s}=e,o="maxLength"===t?Ur.operators.GT:Ur.operators.LT,n=!1===s.opts.unicode?Ur._`${r}.length`:Ur._`${(0,Fr.useFunc)(e.gen,Lr.default)}(${r})`;e.fail$data(Ur._`${n} ${o} ${a}`)}};Ar.default=Kr;var Gr={};Object.defineProperty(Gr,"__esModule",{value:!0});const Br=Se,Jr=M,Hr={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>Jr.str`must match pattern "${e}"`,params:({schemaCode:e})=>Jr._`{pattern: ${e}}`},code(e){const{data:t,$data:r,schema:a,schemaCode:s,it:o}=e,n=o.opts.unicodeRegExp?"u":"",i=r?Jr._`(new RegExp(${s}, ${n}))`:(0,Br.usePattern)(e,a);e.fail$data(Jr._`!${i}.test(${t})`)}};Gr.default=Hr;var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});const Zr=M,Qr={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>Zr.str`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${t} properties`,params:({schemaCode:e})=>Zr._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a}=e,s="maxProperties"===t?Zr.operators.GT:Zr.operators.LT;e.fail$data(Zr._`Object.keys(${r}).length ${s} ${a}`)}};Wr.default=Qr;var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});const Xr=Se,ea=M,ta=A,ra={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>ea.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>ea._`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:a,data:s,$data:o,it:n}=e,{opts:i}=n;if(!o&&0===r.length)return;const c=r.length>=i.loopRequired;if(n.allErrors?function(){if(c||o)e.block$data(ea.nil,l);else for(const t of r)(0,Xr.checkReportMissingProp)(e,t)}():function(){const n=t.let("missing");if(c||o){const r=t.let("valid",!0);e.block$data(r,()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,a,()=>{t.assign(o,(0,Xr.propertyInData)(t,s,r,i.ownProperties)),t.if((0,ea.not)(o),()=>{e.error(),t.break()})},ea.nil)}(n,r)),e.ok(r)}else t.if((0,Xr.checkMissingProp)(e,r,n)),(0,Xr.reportMissingProp)(e,n),t.else()}(),i.strictRequired){const t=e.parentSchema.properties,{definedProperties:a}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!a.has(e)){const t=`required property "${e}" is not defined at "${n.schemaEnv.baseId+n.errSchemaPath}" (strictRequired)`;(0,ta.checkStrictMode)(n,t,n.opts.strictRequired)}}function l(){t.forOf("prop",a,r=>{e.setParams({missingProperty:r}),t.if((0,Xr.noPropertyInData)(t,s,r,i.ownProperties),()=>e.error())})}}};Yr.default=ra;var aa={};Object.defineProperty(aa,"__esModule",{value:!0});const sa=M,oa={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>sa.str`must NOT have ${"maxItems"===e?"more":"fewer"} than ${t} items`,params:({schemaCode:e})=>sa._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a}=e,s="maxItems"===t?sa.operators.GT:sa.operators.LT;e.fail$data(sa._`${r}.length ${s} ${a}`)}};aa.default=oa;var na={},ia={};Object.defineProperty(ia,"__esModule",{value:!0});const ca=Ve;ca.code='require("ajv/dist/runtime/equal").default',ia.default=ca,Object.defineProperty(na,"__esModule",{value:!0});const la=re,da=M,ua=A,ma=ia,pa={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>da.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>da._`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:a,schema:s,parentSchema:o,schemaCode:n,it:i}=e;if(!a&&!s)return;const c=t.let("valid"),l=o.items?(0,la.getSchemaTypes)(o.items):[];function d(a,s){const o=t.name("item"),n=(0,la.checkDataTypes)(l,o,i.opts.strictNumbers,la.DataType.Wrong),d=t.const("indices",da._`{}`);t.for(da._`;${a}--;`,()=>{t.let(o,da._`${r}[${a}]`),t.if(n,da._`continue`),l.length>1&&t.if(da._`typeof ${o} == "string"`,da._`${o} += "_"`),t.if(da._`typeof ${d}[${o}] == "number"`,()=>{t.assign(s,da._`${d}[${o}]`),e.error(),t.assign(c,!1).break()}).code(da._`${d}[${o}] = ${a}`)})}function u(a,s){const o=(0,ua.useFunc)(t,ma.default),n=t.name("outer");t.label(n).for(da._`;${a}--;`,()=>t.for(da._`${s} = ${a}; ${s}--;`,()=>t.if(da._`${o}(${r}[${a}], ${r}[${s}])`,()=>{e.error(),t.assign(c,!1).break(n)})))}e.block$data(c,function(){const a=t.let("i",da._`${r}.length`),s=t.let("j");e.setParams({i:a,j:s}),t.assign(c,!0),t.if(da._`${a} > 1`,()=>(l.length>0&&!l.some(e=>"object"===e||"array"===e)?d:u)(a,s))},da._`${n} === false`),e.ok(c)}};na.default=pa;var fa={};Object.defineProperty(fa,"__esModule",{value:!0});const ha=M,va=A,ya=ia,ga={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:e})=>ha._`{allowedValue: ${e}}`},code(e){const{gen:t,data:r,$data:a,schemaCode:s,schema:o}=e;a||o&&"object"==typeof o?e.fail$data(ha._`!${(0,va.useFunc)(t,ya.default)}(${r}, ${s})`):e.fail(ha._`${o} !== ${r}`)}};fa.default=ga;var _a={};Object.defineProperty(_a,"__esModule",{value:!0});const $a=M,ba=A,wa=ia,ka={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:e})=>$a._`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:a,schema:s,schemaCode:o,it:n}=e;if(!a&&0===s.length)throw new Error("enum must have non-empty array");const i=s.length>=n.opts.loopEnum;let c;const l=()=>null!=c?c:c=(0,ba.useFunc)(t,wa.default);let d;if(i||a)d=t.let("valid"),e.block$data(d,function(){t.assign(d,!1),t.forOf("v",o,e=>t.if($a._`${l()}(${r}, ${e})`,()=>t.assign(d,!0).break()))});else{if(!Array.isArray(s))throw new Error("ajv implementation error");const e=t.const("vSchema",o);d=(0,$a.or)(...s.map((t,a)=>function(e,t){const a=s[t];return"object"==typeof a&&null!==a?$a._`${l()}(${r}, ${e}[${t}])`:$a._`${r} === ${a}`}(e,a)))}e.pass(d)}};_a.default=ka,Object.defineProperty(xr,"__esModule",{value:!0});const Sa=Mr,Ea=Ar,Pa=Gr,ja=Wr,xa=Yr,Ca=aa,Na=na,Ra=fa,Oa=_a,Ia=[Cr.default,Sa.default,Ea.default,Pa.default,ja.default,xa.default,Ca.default,Na.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Ra.default,Oa.default];xr.default=Ia;var Ta={},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.validateAdditionalItems=void 0;const Da=M,za=A,Aa={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>Da.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>Da._`{limit: ${e}}`},code(e){const{parentSchema:t,it:r}=e,{items:a}=t;Array.isArray(a)?Va(e,a):(0,za.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas')}};function Va(e,t){const{gen:r,schema:a,data:s,keyword:o,it:n}=e;n.items=!0;const i=r.const("len",Da._`${s}.length`);if(!1===a)e.setParams({len:t.length}),e.pass(Da._`${i} <= ${t.length}`);else if("object"==typeof a&&!(0,za.alwaysValidSchema)(n,a)){const a=r.var("valid",Da._`${i} <= ${t.length}`);r.if((0,Da.not)(a),()=>function(a){r.forRange("i",t.length,i,t=>{e.subschema({keyword:o,dataProp:t,dataPropType:za.Type.Num},a),n.allErrors||r.if((0,Da.not)(a),()=>r.break())})}(a)),e.ok(a)}}Ma.validateAdditionalItems=Va,Ma.default=Aa;var qa={},Ua={};Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.validateTuple=void 0;const Fa=M,La=A,Ka=Se,Ga={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return Ba(e,"additionalItems",t);r.items=!0,(0,La.alwaysValidSchema)(r,t)||e.ok((0,Ka.validateArray)(e))}};function Ba(e,t,r=e.schema){const{gen:a,parentSchema:s,data:o,keyword:n,it:i}=e;!function(e){const{opts:a,errSchemaPath:s}=i,o=r.length,c=o===e.minItems&&(o===e.maxItems||!1===e[t]);if(a.strictTuples&&!c){const e=`"${n}" is ${o}-tuple, but minItems or maxItems/${t} are not specified or different at path "${s}"`;(0,La.checkStrictMode)(i,e,a.strictTuples)}}(s),i.opts.unevaluated&&r.length&&!0!==i.items&&(i.items=La.mergeEvaluated.items(a,r.length,i.items));const c=a.name("valid"),l=a.const("len",Fa._`${o}.length`);r.forEach((t,r)=>{(0,La.alwaysValidSchema)(i,t)||(a.if(Fa._`${l} > ${r}`,()=>e.subschema({keyword:n,schemaProp:r,dataProp:r},c)),e.ok(c))})}Ua.validateTuple=Ba,Ua.default=Ga,Object.defineProperty(qa,"__esModule",{value:!0});const Ja=Ua,Ha={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Ja.validateTuple)(e,"items")};qa.default=Ha;var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});const Za=M,Qa=A,Ya=Se,Xa=Ma,es={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:e}})=>Za.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>Za._`{limit: ${e}}`},code(e){const{schema:t,parentSchema:r,it:a}=e,{prefixItems:s}=r;a.items=!0,(0,Qa.alwaysValidSchema)(a,t)||(s?(0,Xa.validateAdditionalItems)(e,s):e.ok((0,Ya.validateArray)(e)))}};Wa.default=es;var ts={};Object.defineProperty(ts,"__esModule",{value:!0});const rs=M,as=A,ss={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?rs.str`must contain at least ${e} valid item(s)`:rs.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?rs._`{minContains: ${e}}`:rs._`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:a,data:s,it:o}=e;let n,i;const{minContains:c,maxContains:l}=a;o.opts.next?(n=void 0===c?1:c,i=l):n=1;const d=t.const("len",rs._`${s}.length`);if(e.setParams({min:n,max:i}),void 0===i&&0===n)return void(0,as.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==i&&n>i)return(0,as.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,as.alwaysValidSchema)(o,r)){let t=rs._`${d} >= ${n}`;return void 0!==i&&(t=rs._`${t} && ${d} <= ${i}`),void e.pass(t)}o.items=!0;const u=t.name("valid");function m(){const e=t.name("_valid"),r=t.let("count",0);p(e,()=>t.if(e,()=>function(e){t.code(rs._`${e}++`),void 0===i?t.if(rs._`${e} >= ${n}`,()=>t.assign(u,!0).break()):(t.if(rs._`${e} > ${i}`,()=>t.assign(u,!1).break()),1===n?t.assign(u,!0):t.if(rs._`${e} >= ${n}`,()=>t.assign(u,!0)))}(r)))}function p(r,a){t.forRange("i",0,d,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:as.Type.Num,compositeRule:!0},r),a()})}void 0===i&&1===n?p(u,()=>t.if(u,()=>t.break())):0===n?(t.let(u,!0),void 0!==i&&t.if(rs._`${s}.length > 0`,m)):(t.let(u,!1),m()),e.result(u,()=>e.reset())}};ts.default=ss;var os={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=M,r=A,a=Se;e.error={message:({params:{property:e,depsCount:r,deps:a}})=>t.str`must have ${1===r?"property":"properties"} ${a} when property ${e} is present`,params:({params:{property:e,depsCount:r,deps:a,missingProperty:s}})=>t._`{property: ${e},
    missingProperty: ${s},
    depsCount: ${r},
    deps: ${a}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const a in e){if("__proto__"===a)continue;(Array.isArray(e[a])?t:r)[a]=e[a]}return[t,r]}(e);o(e,t),n(e,r)}};function o(e,r=e.schema){const{gen:s,data:o,it:n}=e;if(0===Object.keys(r).length)return;const i=s.let("missing");for(const c in r){const l=r[c];if(0===l.length)continue;const d=(0,a.propertyInData)(s,o,c,n.opts.ownProperties);e.setParams({property:c,depsCount:l.length,deps:l.join(", ")}),n.allErrors?s.if(d,()=>{for(const t of l)(0,a.checkReportMissingProp)(e,t)}):(s.if(t._`${d} && (${(0,a.checkMissingProp)(e,l,i)})`),(0,a.reportMissingProp)(e,i),s.else())}}function n(e,t=e.schema){const{gen:s,data:o,keyword:n,it:i}=e,c=s.name("valid");for(const l in t)(0,r.alwaysValidSchema)(i,t[l])||(s.if((0,a.propertyInData)(s,o,l,i.opts.ownProperties),()=>{const t=e.subschema({keyword:n,schemaProp:l},c);e.mergeValidEvaluated(t,c)},()=>s.var(c,!0)),e.ok(c))}e.validatePropertyDeps=o,e.validateSchemaDeps=n,e.default=s}(os);var ns={};Object.defineProperty(ns,"__esModule",{value:!0});const is=M,cs=A,ls={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:e})=>is._`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:a,it:s}=e;if((0,cs.alwaysValidSchema)(s,r))return;const o=t.name("valid");t.forIn("key",a,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},o),t.if((0,is.not)(o),()=>{e.error(!0),s.allErrors||t.break()})}),e.ok(o)}};ns.default=ls;var ds={};Object.defineProperty(ds,"__esModule",{value:!0});const us=Se,ms=M,ps=Y,fs=A,hs={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:e})=>ms._`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:a,data:s,errsCount:o,it:n}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:i,opts:c}=n;if(n.props=!0,"all"!==c.removeAdditional&&(0,fs.alwaysValidSchema)(n,r))return;const l=(0,us.allSchemaProperties)(a.properties),d=(0,us.allSchemaProperties)(a.patternProperties);function u(e){t.code(ms._`delete ${s}[${e}]`)}function m(a){if("all"===c.removeAdditional||c.removeAdditional&&!1===r)u(a);else{if(!1===r)return e.setParams({additionalProperty:a}),e.error(),void(i||t.break());if("object"==typeof r&&!(0,fs.alwaysValidSchema)(n,r)){const r=t.name("valid");"failing"===c.removeAdditional?(p(a,r,!1),t.if((0,ms.not)(r),()=>{e.reset(),u(a)})):(p(a,r),i||t.if((0,ms.not)(r),()=>t.break()))}}}function p(t,r,a){const s={keyword:"additionalProperties",dataProp:t,dataPropType:fs.Type.Str};!1===a&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,r)}t.forIn("key",s,r=>{l.length||d.length?t.if(function(r){let s;if(l.length>8){const e=(0,fs.schemaRefOrVal)(n,a.properties,"properties");s=(0,us.isOwnProperty)(t,e,r)}else s=l.length?(0,ms.or)(...l.map(e=>ms._`${r} === ${e}`)):ms.nil;return d.length&&(s=(0,ms.or)(s,...d.map(t=>ms._`${(0,us.usePattern)(e,t)}.test(${r})`))),(0,ms.not)(s)}(r),()=>m(r)):m(r)}),e.ok(ms._`${o} === ${ps.default.errors}`)}};ds.default=hs;var vs={};Object.defineProperty(vs,"__esModule",{value:!0});const ys=st(),gs=Se,_s=A,$s=ds,bs={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:a,data:s,it:o}=e;"all"===o.opts.removeAdditional&&void 0===a.additionalProperties&&$s.default.code(new ys.KeywordCxt(o,$s.default,"additionalProperties"));const n=(0,gs.allSchemaProperties)(r);for(const u of n)o.definedProperties.add(u);o.opts.unevaluated&&n.length&&!0!==o.props&&(o.props=_s.mergeEvaluated.props(t,(0,_s.toHash)(n),o.props));const i=n.filter(e=>!(0,_s.alwaysValidSchema)(o,r[e]));if(0===i.length)return;const c=t.name("valid");for(const u of i)l(u)?d(u):(t.if((0,gs.propertyInData)(t,s,u,o.opts.ownProperties)),d(u),o.allErrors||t.else().var(c,!0),t.endIf()),e.it.definedProperties.add(u),e.ok(c);function l(e){return o.opts.useDefaults&&!o.compositeRule&&void 0!==r[e].default}function d(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},c)}}};vs.default=bs;var ws={};Object.defineProperty(ws,"__esModule",{value:!0});const ks=Se,Ss=M,Es=A,Ps=A,js={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:a,parentSchema:s,it:o}=e,{opts:n}=o,i=(0,ks.allSchemaProperties)(r),c=i.filter(e=>(0,Es.alwaysValidSchema)(o,r[e]));if(0===i.length||c.length===i.length&&(!o.opts.unevaluated||!0===o.props))return;const l=n.strictSchema&&!n.allowMatchingProperties&&s.properties,d=t.name("valid");!0===o.props||o.props instanceof Ss.Name||(o.props=(0,Ps.evaluatedPropsToName)(t,o.props));const{props:u}=o;function m(e){for(const t in l)new RegExp(e).test(t)&&(0,Es.checkStrictMode)(o,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function p(r){t.forIn("key",a,a=>{t.if(Ss._`${(0,ks.usePattern)(e,r)}.test(${a})`,()=>{const s=c.includes(r);s||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:a,dataPropType:Ps.Type.Str},d),o.opts.unevaluated&&!0!==u?t.assign(Ss._`${u}[${a}]`,!0):s||o.allErrors||t.if((0,Ss.not)(d),()=>t.break())})})}!function(){for(const e of i)l&&m(e),o.allErrors?p(e):(t.var(d,!0),p(e),t.if(d))}()}};ws.default=js;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});const Cs=A,Ns={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:a}=e;if((0,Cs.alwaysValidSchema)(a,r))return void e.fail();const s=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.failResult(s,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};xs.default=Ns;var Rs={};Object.defineProperty(Rs,"__esModule",{value:!0});const Os={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Se.validateUnion,error:{message:"must match a schema in anyOf"}};Rs.default=Os;var Is={};Object.defineProperty(Is,"__esModule",{value:!0});const Ts=M,Ms=A,Ds={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:e})=>Ts._`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,parentSchema:a,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&a.discriminator)return;const o=r,n=t.let("valid",!1),i=t.let("passing",null),c=t.name("_valid");e.setParams({passing:i}),t.block(function(){o.forEach((r,a)=>{let o;(0,Ms.alwaysValidSchema)(s,r)?t.var(c,!0):o=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},c),a>0&&t.if(Ts._`${c} && ${n}`).assign(n,!1).assign(i,Ts._`[${i}, ${a}]`).else(),t.if(c,()=>{t.assign(n,!0),t.assign(i,a),o&&e.mergeEvaluated(o,Ts.Name)})})}),e.result(n,()=>e.reset(),()=>e.error(!0))}};Is.default=Ds;var zs={};Object.defineProperty(zs,"__esModule",{value:!0});const As=A,Vs={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=t.name("valid");r.forEach((t,r)=>{if((0,As.alwaysValidSchema)(a,t))return;const o=e.subschema({keyword:"allOf",schemaProp:r},s);e.ok(s),e.mergeEvaluated(o)})}};zs.default=Vs;var qs={};Object.defineProperty(qs,"__esModule",{value:!0});const Us=M,Fs=A,Ls={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>Us.str`must match "${e.ifClause}" schema`,params:({params:e})=>Us._`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:a}=e;void 0===r.then&&void 0===r.else&&(0,Fs.checkStrictMode)(a,'"if" without "then" and "else" is ignored');const s=Ks(a,"then"),o=Ks(a,"else");if(!s&&!o)return;const n=t.let("valid",!0),i=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},i);e.mergeEvaluated(t)}(),e.reset(),s&&o){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(i,c("then",r),c("else",r))}else s?t.if(i,c("then")):t.if((0,Us.not)(i),c("else"));function c(r,a){return()=>{const s=e.subschema({keyword:r},i);t.assign(n,i),e.mergeValidEvaluated(s,n),a?t.assign(a,Us._`${r}`):e.setParams({ifClause:r})}}e.pass(n,()=>e.error(!0))}};function Ks(e,t){const r=e.schema[t];return void 0!==r&&!(0,Fs.alwaysValidSchema)(e,r)}qs.default=Ls;var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});const Bs=A,Js={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,Bs.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};Gs.default=Js,Object.defineProperty(Ta,"__esModule",{value:!0});const Hs=Ma,Ws=qa,Zs=Ua,Qs=Wa,Ys=ts,Xs=os,eo=ns,to=ds,ro=vs,ao=ws,so=xs,oo=Rs,no=Is,io=zs,co=qs,lo=Gs;Ta.default=function(e=!1){const t=[so.default,oo.default,no.default,io.default,co.default,lo.default,eo.default,to.default,Xs.default,ro.default,ao.default];return e?t.push(Ws.default,Qs.default):t.push(Hs.default,Zs.default),t.push(Ys.default),t};var uo={},mo={};Object.defineProperty(mo,"__esModule",{value:!0});const po=M,fo={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>po.str`must match format "${e}"`,params:({schemaCode:e})=>po._`{format: ${e}}`},code(e,t){const{gen:r,data:a,$data:s,schema:o,schemaCode:n,it:i}=e,{opts:c,errSchemaPath:l,schemaEnv:d,self:u}=i;c.validateFormats&&(s?function(){const s=r.scopeValue("formats",{ref:u.formats,code:c.code.formats}),o=r.const("fDef",po._`${s}[${n}]`),i=r.let("fType"),l=r.let("format");r.if(po._`typeof ${o} == "object" && !(${o} instanceof RegExp)`,()=>r.assign(i,po._`${o}.type || "string"`).assign(l,po._`${o}.validate`),()=>r.assign(i,po._`"string"`).assign(l,o)),e.fail$data((0,po.or)(!1===c.strictSchema?po.nil:po._`${n} && !${l}`,function(){const e=d.$async?po._`(${o}.async ? await ${l}(${a}) : ${l}(${a}))`:po._`${l}(${a})`,r=po._`(typeof ${l} == "function" ? ${e} : ${l}.test(${a}))`;return po._`${l} && ${l} !== true && ${i} === ${t} && !${r}`}()))}():function(){const s=u.formats[o];if(!s)return void function(){if(!1===c.strictSchema)return void u.logger.warn(e());throw new Error(e());function e(){return`unknown format "${o}" ignored in schema at path "${l}"`}}();if(!0===s)return;const[n,i,m]=function(e){const t=e instanceof RegExp?(0,po.regexpCode)(e):c.code.formats?po._`${c.code.formats}${(0,po.getProperty)(o)}`:void 0,a=r.scopeValue("formats",{key:o,ref:e,code:t});if("object"==typeof e&&!(e instanceof RegExp))return[e.type||"string",e.validate,po._`${a}.validate`];return["string",e,a]}(s);n===t&&e.pass(function(){if("object"==typeof s&&!(s instanceof RegExp)&&s.async){if(!d.$async)throw new Error("async format in sync schema");return po._`await ${m}(${a})`}return"function"==typeof i?po._`${m}(${a})`:po._`${m}.test(${a})`}())}())}};mo.default=fo,Object.defineProperty(uo,"__esModule",{value:!0});const ho=[mo.default];uo.default=ho;var vo={};Object.defineProperty(vo,"__esModule",{value:!0}),vo.contentVocabulary=vo.metadataVocabulary=void 0,vo.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],vo.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(mr,"__esModule",{value:!0});const yo=xr,go=Ta,_o=uo,$o=vo,bo=[pr.default,yo.default,(0,go.default)(),_o.default,$o.metadataVocabulary,$o.contentVocabulary];mr.default=bo;var wo,ko,So={},Eo={};Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.DiscrError=void 0,(ko=wo||(Eo.DiscrError=wo={})).Tag="tag",ko.Mapping="mapping",Object.defineProperty(So,"__esModule",{value:!0});const Po=M,jo=Eo,xo=ut,Co=ct,No=A,Ro={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:e,tagName:t}})=>e===jo.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>Po._`{error: ${e}, tag: ${r}, tagValue: ${t}}`},code(e){const{gen:t,data:r,schema:a,parentSchema:s,it:o}=e,{oneOf:n}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const i=a.propertyName;if("string"!=typeof i)throw new Error("discriminator: requires propertyName");if(a.mapping)throw new Error("discriminator: mapping is not supported");if(!n)throw new Error("discriminator: requires oneOf keyword");const c=t.let("valid",!1),l=t.const("tag",Po._`${r}${(0,Po.getProperty)(i)}`);function d(r){const a=t.name("valid"),s=e.subschema({keyword:"oneOf",schemaProp:r},a);return e.mergeEvaluated(s,Po.Name),a}t.if(Po._`typeof ${l} == "string"`,()=>function(){const r=function(){var e;const t={},r=c(s);let a=!0;for(let s=0;s<n.length;s++){let t=n[s];if((null==t?void 0:t.$ref)&&!(0,No.schemaHasRulesButRef)(t,o.self.RULES)){const e=t.$ref;if(t=xo.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,e),t instanceof xo.SchemaEnv&&(t=t.schema),void 0===t)throw new Co.default(o.opts.uriResolver,o.baseId,e)}const d=null===(e=null==t?void 0:t.properties)||void 0===e?void 0:e[i];if("object"!=typeof d)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${i}"`);a=a&&(r||c(t)),l(d,s)}if(!a)throw new Error(`discriminator: "${i}" must be required`);return t;function c({required:e}){return Array.isArray(e)&&e.includes(i)}function l(e,t){if(e.const)d(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${i}" must have "const" or "enum"`);for(const r of e.enum)d(r,t)}}function d(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${i}" values must be unique strings`);t[e]=r}}();t.if(!1);for(const e in r)t.elseIf(Po._`${l} === ${e}`),t.assign(c,d(r[e]));t.else(),e.error(!1,{discrError:jo.DiscrError.Mapping,tag:l,tagName:i}),t.endIf()}(),()=>e.error(!1,{discrError:jo.DiscrError.Tag,tag:l,tagName:i})),e.ok(c)}};So.default=Ro;const Oo={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=R,a=mr,s=So,o=Oo,n=["/properties"],i="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),a.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,n):o;this.addMetaSchema(e,i,!1),this.refs["http://json-schema.org/schema"]=i}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(i)?i:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var l=st();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var d=M;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var u=it();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return u.default}});var m=ct;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return m.default}})}(N,N.exports);var Io=N.exports;const To=C(Io);var Mo={exports:{}},Do={};!function(e){function t(e,t){return{validate:e,compare:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0,e.fullFormats={date:t(s,o),time:t(i(!0),c),"date-time":t(u(!0),m),"iso-time":t(i(),l),"iso-date-time":t(u(),p),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return f.test(e)&&h.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if($.test(e))return!1;try{return new RegExp(e),!0}catch(t){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return v.lastIndex=0,v.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=g&&e>=y}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:_},double:{type:"number",validate:_},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,c),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,m),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,l),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,p),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,a=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(e){const t=r.exec(e);if(!t)return!1;const s=+t[1],o=+t[2],n=+t[3];return o>=1&&o<=12&&n>=1&&n<=(2===o&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(s)?29:a[o])}function o(e,t){if(e&&t)return e>t?1:e<t?-1:0}const n=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function i(e){return function(t){const r=n.exec(t);if(!r)return!1;const a=+r[1],s=+r[2],o=+r[3],i=r[4],c="-"===r[5]?-1:1,l=+(r[6]||0),d=+(r[7]||0);if(l>23||d>59||e&&!i)return!1;if(a<=23&&s<=59&&o<60)return!0;const u=s-d*c,m=a-l*c-(u<0?1:0);return(23===m||-1===m)&&(59===u||-1===u)&&o<61}}function c(e,t){if(!e||!t)return;const r=new Date("2020-01-01T"+e).valueOf(),a=new Date("2020-01-01T"+t).valueOf();return r&&a?r-a:void 0}function l(e,t){if(!e||!t)return;const r=n.exec(e),a=n.exec(t);return r&&a?(e=r[1]+r[2]+r[3])>(t=a[1]+a[2]+a[3])?1:e<t?-1:0:void 0}const d=/t|\s/i;function u(e){const t=i(e);return function(e){const r=e.split(d);return 2===r.length&&s(r[0])&&t(r[1])}}function m(e,t){if(!e||!t)return;const r=new Date(e).valueOf(),a=new Date(t).valueOf();return r&&a?r-a:void 0}function p(e,t){if(!e||!t)return;const[r,a]=e.split(d),[s,n]=t.split(d),i=o(r,s);return void 0!==i?i||c(a,n):void 0}const f=/\/|:/,h=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;const v=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;const y=-2147483648,g=2**31-1;function _(){return!0}const $=/[^\\]\\Z/}(Do);var zo={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=Io,r=M,a=r.operators,s={formatMaximum:{okStr:"<=",ok:a.LTE,fail:a.GT},formatMinimum:{okStr:">=",ok:a.GTE,fail:a.LT},formatExclusiveMaximum:{okStr:"<",ok:a.LT,fail:a.GTE},formatExclusiveMinimum:{okStr:">",ok:a.GT,fail:a.LTE}},o={message:({keyword:e,schemaCode:t})=>r.str`should be ${s[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>r._`{comparison: ${s[e].okStr}, limit: ${t}}`};e.formatLimitDefinition={keyword:Object.keys(s),type:"string",schemaType:"string",$data:!0,error:o,code(e){const{gen:a,data:o,schemaCode:n,keyword:i,it:c}=e,{opts:l,self:d}=c;if(!l.validateFormats)return;const u=new t.KeywordCxt(c,d.RULES.all.format.definition,"format");function m(e){return r._`${e}.compare(${o}, ${n}) ${s[i].fail} 0`}u.$data?function(){const t=a.scopeValue("formats",{ref:d.formats,code:l.code.formats}),s=a.const("fmt",r._`${t}[${u.schemaCode}]`);e.fail$data((0,r.or)(r._`typeof ${s} != "object"`,r._`${s} instanceof RegExp`,r._`typeof ${s}.compare != "function"`,m(s)))}():function(){const t=u.schema,s=d.formats[t];if(!s||!0===s)return;if("object"!=typeof s||s instanceof RegExp||"function"!=typeof s.compare)throw new Error(`"${i}": format "${t}" does not define "compare" function`);const o=a.scopeValue("formats",{key:t,ref:s,code:l.code.formats?r._`${l.code.formats}${(0,r.getProperty)(t)}`:void 0});e.fail$data(m(o))}()},dependencies:["format"]};e.default=t=>(t.addKeyword(e.formatLimitDefinition),t)}(zo),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Do,a=zo,s=M,o=new s.Name("fullFormats"),n=new s.Name("fastFormats"),i=(e,t={keywords:!0})=>{if(Array.isArray(t))return c(e,t,r.fullFormats,o),e;const[s,i]="fast"===t.mode?[r.fastFormats,n]:[r.fullFormats,o];return c(e,t.formats||r.formatNames,s,i),t.keywords&&(0,a.default)(e),e};function c(e,t,r,a){var o,n;null!==(o=(n=e.opts.code).formats)&&void 0!==o||(n.formats=s._`require("ajv-formats/dist/formats").${a}`);for(const s of t)e.addFormat(s,r[s])}i.get=(e,t="full")=>{const a=("fast"===t?r.fastFormats:r.fullFormats)[e];if(!a)throw new Error(`Unknown format "${e}"`);return a},e.exports=t=i,Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}(Mo,Mo.exports);const Ao=C(Mo.exports),Vo={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://auditomatic.org/schemas/export-v1.json",title:"AudiomaticLite Export Format v1.0",description:"Standard export format for AudiomaticLite experimental data",type:"object",properties:{auditomatic_export:{type:"object",properties:{format_version:{type:"string",const:"1.0.0"},instrument_version:{type:"string",pattern:"^auditomatic-lite-v\\d+\\.\\d+\\.\\d+$"},export_timestamp:{type:"string",format:"date-time"},experiment:{$ref:"#/$defs/Experiment"},execution:{$ref:"#/$defs/Execution"},measurements:{type:"array",items:{$ref:"#/$defs/Measurement"}},integrity:{$ref:"#/$defs/Integrity"}},required:["format_version","instrument_version","export_timestamp","experiment","execution","measurements","integrity"],additionalProperties:!1}},required:["auditomatic_export"],additionalProperties:!1,$defs:{Experiment:{type:"object",properties:{design_id:{type:"integer"},name:{type:"string"},description:{type:"string"},prompt_template:{type:"string"},variables:{type:"object",additionalProperties:{type:"array",items:{type:"string"}}},variable_list_refs:{type:"object",additionalProperties:{type:"object",properties:{name:{type:"string"},id:{type:"integer"},checksum:{type:"string"}},required:["name","id","checksum"]}},output_format:{type:"string",enum:["text","json"]},output_type:{type:"string"},extract_pattern:{oneOf:[{type:"string"},{type:"object",properties:{match:{type:"string"},replace:{type:"string"}},required:["match"]}]},refusal_words:{type:"array",items:{type:"string"}},reject_refusal_words:{type:"boolean"},created_at:{type:"string",format:"date-time"},updated_at:{type:"string",format:"date-time"}},required:["design_id","name","prompt_template","variables","created_at","updated_at"]},Execution:{type:"object",properties:{run_id:{type:"integer"},run_name:{type:"string"},started_at:{type:"string",format:"date-time"},completed_at:{type:["string","null"],format:"date-time"},model_configuration:{type:"object",properties:{models:{type:"array",items:{type:"string"},minItems:1},parameters:{type:"object",properties:{temperature:{type:"number",minimum:0,maximum:2},max_tokens:{type:"integer",minimum:1},concurrency:{type:"integer",minimum:1}},required:["temperature","max_tokens","concurrency"]}},required:["models","parameters"]},total_tasks:{type:"integer",minimum:0},completed_tasks:{type:"integer",minimum:0},error_count:{type:"integer",minimum:0},status:{type:"string",enum:["draft","ready","pending","running","paused","completed","stopped","error"]}},required:["run_id","run_name","started_at","model_configuration","total_tasks","completed_tasks","error_count","status"]},Measurement:{type:"object",properties:{task_id:{type:"integer"},model:{type:"string"},variable_assignment:{type:"object",additionalProperties:{type:"string"}},prompt:{type:"string"},raw_response:{type:["string","null"]},extracted_value:{type:["string","null"]},parsed_results:{type:["object","null"]},response_time_ms:{type:["integer","null"],minimum:0},token_usage:{type:["object","null"],properties:{prompt_tokens:{type:"integer",minimum:0},completion_tokens:{type:"integer",minimum:0},total_tokens:{type:"integer",minimum:0}},required:["prompt_tokens","completion_tokens","total_tokens"]},timestamp:{type:"string",format:"date-time"},status:{type:"string",enum:["pending","processing","completed","error","cancelled"]},error:{type:["string","null"]},api_call_log:{type:["object","null"],description:"Complete API request/response log for research transparency"}},required:["task_id","model","variable_assignment","prompt","timestamp","status"]},Integrity:{type:"object",properties:{measurement_count:{type:"integer",minimum:0},checksum:{type:"string",pattern:"^sha256:[a-f0-9]{64}$"},validation_errors:{type:"array",items:{type:"string"}},completeness_check:{type:"object",properties:{expected_tasks:{type:"integer"},actual_tasks:{type:"integer"},missing_tasks:{type:"array",items:{type:"object",properties:{model:{type:"string"},variables:{type:"object"}}}}},required:["expected_tasks","actual_tasks","missing_tasks"]}},required:["measurement_count","checksum","validation_errors","completeness_check"]}}},qo={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://auditomatic.org/schemas/design-export-v1.json",title:"AudiomaticLite Design Export Format v1.0",description:"Standard export format for individual experimental designs",type:"object",properties:{auditomatic_design_export:{type:"object",properties:{format_version:{type:"string",const:"1.0.0"},instrument_version:{type:"string",pattern:"^auditomatic-lite-v\\d+\\.\\d+\\.\\d+$"},export_timestamp:{type:"string",format:"date-time"},design:{$ref:"#/$defs/Design"},variable_lists:{type:"array",items:{$ref:"#/$defs/VariableList"}},integrity:{$ref:"#/$defs/Integrity"}},required:["format_version","instrument_version","export_timestamp","design","variable_lists","integrity"],additionalProperties:!1}},required:["auditomatic_design_export"],additionalProperties:!1,$defs:{Design:{type:"object",properties:{id:{type:["integer","null"]},name:{type:"string"},description:{type:"string"},prompt_template:{type:"string"},variables:{type:"object",additionalProperties:{type:"array",items:{type:"string"}}},variable_list_refs:{type:"object",additionalProperties:{type:["integer","string"]}},attribute_keys:{type:"object",additionalProperties:{type:"array",items:{type:"string"}}},output_format:{type:"string",enum:["text","json"]},output_type:{type:"string"},extract_pattern:{oneOf:[{type:"string"},{type:"object",properties:{match:{type:"string"},replace:{type:"string"}},required:["match"]}]},refusal_words:{type:"array",items:{type:"string"}},reject_refusal_words:{type:"boolean"},created_at:{type:"string",format:"date-time"},updated_at:{type:"string",format:"date-time"}},required:["name","prompt_template","variables","created_at","updated_at"]},VariableList:{type:"object",properties:{id:{type:["integer","null"]},name:{type:"string"},description:{type:"string"},values:{type:"array",items:{type:"string"}},category:{type:"string",enum:["general","attributed"]},attribute_keys:{type:"array",items:{type:"string"}},attributed_items:{type:"array",items:{type:"object",properties:{value:{type:"string"},attributes:{type:"object",additionalProperties:{type:"string"}}},required:["value","attributes"]}},created_at:{type:"string",format:"date-time"},updated_at:{type:"string",format:"date-time"},checksum:{type:"string",pattern:"^sha256:[a-f0-9]{64}$"}},required:["name","values","created_at","updated_at","checksum"]},Integrity:{type:"object",properties:{design_checksum:{type:"string",pattern:"^sha256:[a-f0-9]{64}$"},variable_lists_count:{type:"integer",minimum:0},total_variable_combinations:{type:"integer",minimum:1},validation_errors:{type:"array",items:{type:"string"}}},required:["design_checksum","variable_lists_count","total_variable_combinations","validation_errors"]}}};const Uo=new class{constructor(){t(this,"ajv"),t(this,"initialized",!1),this.ajv=new To({allErrors:!0,verbose:!1,strict:!1,validateSchema:!1});try{Ao(this.ajv),this.ajv.addSchema(Vo,"export-v1"),this.ajv.addSchema(qo,"design-export-v1"),this.initialized=!0}catch(e){console.warn("Schema validator initialization failed:",e),this.initialized=!1}}validateRunExport(e){if(!this.initialized)return{valid:!1,errors:["Schema validator not initialized - validation skipped"]};const t=this.ajv.getSchema("export-v1");if(!t)return{valid:!1,errors:["Schema not found: export-v1"]};try{const r=t(e);return{valid:r,errors:r?[]:this.formatErrors(t.errors||[])}}catch(r){return{valid:!1,errors:[`Validation error: ${r instanceof Error?r.message:"Unknown error"}`]}}}validateDesignExport(e){if(!this.initialized)return{valid:!1,errors:["Schema validator not initialized - validation skipped"]};const t=this.ajv.getSchema("design-export-v1");if(!t)return{valid:!1,errors:["Schema not found: design-export-v1"]};try{const r=t(e);return{valid:r,errors:r?[]:this.formatErrors(t.errors||[])}}catch(r){return{valid:!1,errors:[`Validation error: ${r instanceof Error?r.message:"Unknown error"}`]}}}validateExport(e){return e?.auditomatic_export?this.validateRunExport(e):e?.auditomatic_design_export?this.validateDesignExport(e):{valid:!1,errors:["Unknown export format - missing auditomatic_export or auditomatic_design_export root property"]}}formatErrors(e){return e.map(e=>{const t=e.instancePath||"root",r=e.message||"validation failed";return"required"===e.keyword?`Missing required property: ${t}/${e.params.missingProperty}`:"type"===e.keyword?`Invalid type at ${t}: expected ${e.params.type}, got ${typeof e.data}`:"enum"===e.keyword?`Invalid value at ${t}: must be one of [${e.params.allowedValues.join(", ")}]`:"format"===e.keyword?`Invalid format at ${t}: ${r}`:`Validation error at ${t}: ${r}`})}getSchemaInfo(){return{availableSchemas:["export-v1","design-export-v1"],ajvVersion:"8.17.1"}}};async function Fo(e){const t=JSON.stringify(e,null,0),r=(new TextEncoder).encode(t),a=await crypto.subtle.digest("SHA-256",r);return`sha256:${Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}`}function Lo(e){const t=[];try{const a=(r=e,Uo.validateExport(r));a.valid||t.push(...a.errors.map(e=>`Schema validation: ${e}`))}catch(a){t.push(`Schema validation failed: ${a instanceof Error?a.message:"Unknown error"}`)}var r;if("auditomatic_export"in e){const r=e.auditomatic_export;r.measurements.length!==r.integrity.measurement_count&&t.push(`Measurement count mismatch: expected ${r.integrity.measurement_count}, got ${r.measurements.length}`);const{expected_tasks:a,actual_tasks:s}=r.integrity.completeness_check;s!==r.measurements.length&&t.push(`Task count inconsistency: integrity reports ${s}, but found ${r.measurements.length} measurements`);const o=new Set(r.execution.model_configuration.models),n=new Set(r.measurements.map(e=>e.model));for(const e of n)o.has(e)||t.push(`Model '${e}' used in measurements but not declared in configuration`);try{new Date(r.export_timestamp)}catch{t.push("Invalid export_timestamp format")}r.integrity.checksum.startsWith("sha256:")&&71===r.integrity.checksum.length||t.push('Invalid checksum format - must be "sha256:" followed by 64 hex characters')}return t}function Ko(e,t,r="application/json"){const a=new Blob([e],{type:r}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}function Go(){const e=async(e,t)=>{const r=new Set;e.forEach(e=>{Object.keys(e.variables||{}).forEach(e=>{r.add(e)})});const a=Array.from(r).sort(),s=["Task ID","Model","Status","Response Time (ms)",...a,"Raw Response","Extracted Value","Error","Timestamp"],o=e.map(e=>[e.id||"",e.model,e.status,e.response_time||"",...a.map(t=>e.variables?.[t]||""),e.result||"",e.parsed_results?JSON.stringify(e.parsed_results):"",e.error||"",e.created_at]);Ko([s.join(","),...o.map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(","))].join("\n"),t?`results_run_${t}_${(new Date).toISOString().slice(0,10)}.csv`:`results_filtered_${(new Date).toISOString().slice(0,10)}.csv`,"text/csv")};return{exportCSV:e,exportJSON:async(e,t,r)=>{const a={format:"legacy_results_export",run_id:t,exported_at:(new Date).toISOString(),total_tasks:e.length,filters_applied:r,tasks:e},s=t?`results_legacy_run_${t}_${(new Date).toISOString().slice(0,10)}.json`:`results_legacy_filtered_${(new Date).toISOString().slice(0,10)}.json`;Ko(JSON.stringify(a,null,2),s,"application/json")},exportStandardizedJSON:async(e,t,r)=>{if(!t)throw new Error("Standardized export requires a specific run ID");try{const[a,s,o]=await Promise.all([S.runs.get(t),S.runs.get(t).then(e=>e?S.designs.get(e.design_id):null),S.variable_lists.toArray()]);if(!a||!s)throw new Error("Run or design data not found");const n=new Map(o.map(e=>[e.id,e])),i={};if(s.variable_list_refs)for(const[e,t]of Object.entries(s.variable_list_refs)){const r="number"==typeof t?t:parseInt(t.toString()),a=n.get(r);if(a){const t=await Fo(a);i[e]={name:a.name,id:a.id,checksum:t}}}const c=e.map(e=>({task_id:e.id,model:e.model,variable_assignment:e.variables,prompt:e.prompt,raw_response:e.result||null,extracted_value:e.parsed_results?JSON.stringify(e.parsed_results):null,parsed_results:e.parsed_results||null,response_time_ms:e.response_time||null,token_usage:e.usage||null,timestamp:e.created_at,status:e.status,error:e.error||null,api_call_log:e.api_call_log||null})),l=function(e,t,r){const a={...e.variables};if(e.variable_list_refs)for(const[o,n]of Object.entries(e.variable_list_refs)){const e="number"==typeof n?n:parseInt(n.toString()),t=Object.values(r).find(t=>t.id===e);t&&("attributed"===t.category&&t.attributed_items?a[o]=t.attributed_items.map(e=>e.value):a[o]=t.values)}const s=Object.values(a);return 0===s.length?t.length:s.reduce((e,t)=>e*t.length,1)*t.length}(s,a.models,Object.fromEntries(n)),d=await S.tasks.where("run_id").equals(t).toArray(),u=function(e,t,r,a){const s=[],o={...e.variables};if(e.variable_list_refs)for(const[l,d]of Object.entries(e.variable_list_refs)){const e="number"==typeof d?d:parseInt(d.toString()),t=Object.values(r).find(t=>t.id===e);t&&("attributed"===t.category&&t.attributed_items?o[l]=t.attributed_items.map(e=>e.value):o[l]=t.values)}const n=Object.keys(o),i=Object.values(o);if(0===i.length){for(const e of t)a.some(t=>t.model===e)||s.push({model:e,variables:{}});return s}const c=function e(t,r=[],a=0){if(a===t.length)return[r];const s=[];for(const o of t[a])s.push(...e(t,[...r,o],a+1));return s}(i);for(const l of t)for(const e of c){const t={};n.forEach((r,a)=>{t[r]=e[a]}),a.some(e=>e.model===l&&Object.entries(t).every(([t,r])=>e.variables[t]===r))||s.push({model:l,variables:t})}return s}(s,a.models,Object.fromEntries(n),d),m=await Fo(c),p={auditomatic_export:{format_version:"1.0.0",instrument_version:"auditomatic-lite-v1.0.0",export_timestamp:(new Date).toISOString(),experiment:{design_id:s.id,name:s.name,description:s.description,prompt_template:s.prompt_template,variables:s.variables,variable_list_refs:i,output_format:s.output_format,output_type:s.output_type,extract_pattern:s.extract_pattern,refusal_words:s.refusal_words,reject_refusal_words:s.reject_refusal_words,created_at:s.created_at,updated_at:s.updated_at},execution:{run_id:a.id,run_name:a.name,started_at:a.created_at,completed_at:a.completed_at||null,model_configuration:{models:a.models,parameters:a.parameters},total_tasks:a.total_tasks,completed_tasks:a.completed_tasks,error_count:a.error_count,status:a.status},measurements:c,integrity:{measurement_count:c.length,checksum:m,validation_errors:[],completeness_check:{expected_tasks:l,actual_tasks:c.length,missing_tasks:u}}}};r&&Object.keys(r).length>0&&(p.auditomatic_export.export_metadata={filtered:!0,filters_applied:r,original_task_count:d.length});const f=Lo(p);p.auditomatic_export.integrity.validation_errors=f;const h=function(e,t,r,a){const s=a||new Date,o=s.toISOString().slice(0,10).replace(/-/g,""),n=s.toISOString().slice(11,19).replace(/:/g,""),i=t.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");switch(e){case"run":return`${i}_${o}_${n}_run${r||""}.json`;case"design":return`${i}_design${r||""}_${o}.json`;case"full-db":return`auditomatic_full_export_${o}_${n}.json`;default:return`auditomatic_export_${o}_${n}.json`}}("run",s.name,a.id,new Date);return Ko(JSON.stringify(p,null,2),h,"application/json"),function(e,t,r,a,s=[],o){return{success:e,filename:t,recordCount:r,checksum:a,validationErrors:s,warning:o}}(!0,h,c.length,m,f,f.length>0?"Export contains validation warnings":void 0)}catch(a){throw new Error(`Failed to create standardized export: ${a instanceof Error?a.message:"Unknown error"}`)}},exportExcel:async(t,r)=>{await e(t,r)}}}const Bo={class:"pivot-table-wrapper"},Jo=E(r({__name:"PivotTable",props:{tasks:{}},emits:["cell-click"],setup(e,{emit:t}){const r=e,l=t,{exportCSV:d}=Go(),u=a({rowField:"",columnField:"model",valueField:"match_1",aggregation:"mean"});function m(e){u.value=e}function p(e){e.cell&&l("cell-click",{row:e.row,column:e.column,tasks:e.cell.tasks})}async function f(){await d(r.tasks,null)}return(e,t)=>(o(),s("div",Bo,[t[1]||(t[1]=n("div",{class:"pivot-header"},[n("h3",null,"Pivot Table Analysis"),n("p",{class:"pivot-description"}," Analyze your results by grouping data across different dimensions and aggregating values. ")],-1)),i(j,{tasks:e.tasks,config:u.value,"max-table-rows":1e4,"show-totals":!0,"hide-view-toggle":!1,onConfigChange:m,onCellClick:p},null,8,["tasks","config"]),n("div",{class:"export-controls"},[n("button",{class:"export-btn",onClick:f},t[0]||(t[0]=[n("svg",{class:"icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),n("polyline",{points:"7 10 12 15 17 10"}),n("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),c(" Export Pivot Data ")]))])]))}}),[["__scopeId","data-v-4fe8c0b3"]]),Ho={class:"filters-section"},Wo={class:"filters-header"},Zo={class:"filters-grid"},Qo={class:"filter-group"},Yo=["value"],Xo={class:"filter-group"},en=["value"],tn=["value"],rn={class:"filter-group"},an=["value"],sn=["value","onChange"],on={value:""},nn=["value"],cn=E(r({__name:"ResultsFilters",props:{filters:{},uniqueModels:{},availableVariables:{},getVariableValues:{type:Function}},emits:["update-filter","update-variable-filter","reset-filters"],setup(e,{emit:t}){const r=t,a=(e,t)=>{r("update-filter",e,t)};return(e,t)=>(o(),s("div",Ho,[n("div",Wo,[t[4]||(t[4]=n("h3",null,"Filters & Search",-1)),n("button",{class:"btn btn-secondary btn-sm",onClick:t[0]||(t[0]=t=>e.$emit("reset-filters"))}," Reset All ")]),n("div",Zo,[n("div",Qo,[t[5]||(t[5]=n("label",null,"Search Results:",-1)),n("input",{value:e.filters.search,type:"text",class:"form-control",placeholder:"Search in results content...",onInput:t[1]||(t[1]=e=>a("search",e.target.value))},null,40,Yo)]),n("div",Xo,[t[7]||(t[7]=n("label",null,"Model:",-1)),n("select",{value:e.filters.model,class:"form-control",onChange:t[2]||(t[2]=e=>a("model",e.target.value))},[t[6]||(t[6]=n("option",{value:""}," All Models ",-1)),(o(!0),s(l,null,d(e.uniqueModels,e=>(o(),s("option",{key:e,value:e},u(e),9,tn))),128))],40,en)]),n("div",rn,[t[9]||(t[9]=n("label",null,"Status:",-1)),n("select",{value:e.filters.status,class:"form-control",onChange:t[3]||(t[3]=e=>a("status",e.target.value))},t[8]||(t[8]=[n("option",{value:""}," All Statuses ",-1),n("option",{value:"completed"}," Completed ",-1),n("option",{value:"error"}," Error ",-1),n("option",{value:"processing"}," Processing ",-1)]),40,an)]),(o(!0),s(l,null,d(e.availableVariables,t=>(o(),s("div",{key:t,class:"filter-group"},[n("label",null,u(t)+":",1),n("select",{value:e.filters.variables[t]||"",class:"form-control",onChange:e=>((e,t)=>{r("update-variable-filter",e,t)})(t,e.target.value)},[n("option",on," All "+u(t),1),(o(!0),s(l,null,d(e.getVariableValues(t),e=>(o(),s("option",{key:e,value:e},u(e),9,nn))),128))],40,sn)]))),128))])]))}}),[["__scopeId","data-v-7f90c34c"]]),ln={class:"table-view"},dn={class:"table-section"},un={class:"table-header"},mn={class:"table-controls"},pn={class:"results-count"},fn={class:"export-buttons"},hn={class:"table-container"},vn={class:"results-table"},yn=["onClick"],gn={class:"model-name"},_n=["onClick"],$n={class:"variables-compact"},bn={class:"var-key"},wn={class:"var-value"},kn={class:"status-cell"},Sn=["title"],En=["onClick"],Pn=["title"],jn={class:"raw-text"},xn=["onClick"],Cn={class:"parsed-content"},Nn={key:0,class:"parsed-items"},Rn={class:"parsed-key"},On={key:1,class:"no-parsing"},In={class:"time-cell"},Tn={class:"timing-info"},Mn={class:"response-time"},Dn={key:0,class:"timestamp"},zn={class:"actions-cell"},An=["onClick"],Vn=E(r({__name:"ResultsTable",props:{tasks:{},resultsCount:{},getSortIcon:{type:Function}},emits:["export-csv","export-json","export-excel","sort-by","view-task"],setup(e,{emit:t}){const r=(e,t)=>!e||e.length<=t?e:e.substring(0,t)+"...",a=e=>null==e?"null":"boolean"==typeof e?e?"true":"false":"number"==typeof e?e.toString():"object"==typeof e?JSON.stringify(e):String(e),i=e=>null==e?"value-null":"boolean"==typeof e?e?"value-true":"value-false":"number"==typeof e?"value-number":"object"==typeof e?"value-object":"value-string";return(e,t)=>(o(),s("div",ln,[n("div",dn,[n("div",un,[t[6]||(t[6]=n("h3",null,"Results Data",-1)),n("div",mn,[n("span",pn,u(e.resultsCount),1),n("div",fn,[n("button",{class:"btn btn-secondary btn-sm",onClick:t[0]||(t[0]=t=>e.$emit("export-csv"))}," 📄 CSV "),n("button",{class:"btn btn-secondary btn-sm",onClick:t[1]||(t[1]=t=>e.$emit("export-json"))}," 📋 JSON "),n("button",{class:"btn btn-secondary btn-sm",onClick:t[2]||(t[2]=t=>e.$emit("export-excel"))}," 📊 Excel ")])])]),n("div",hn,[n("table",vn,[n("thead",null,[n("tr",null,[n("th",{class:"sortable",onClick:t[3]||(t[3]=t=>e.$emit("sort-by","model"))}," Model "+u(e.getSortIcon("model")),1),t[7]||(t[7]=n("th",{class:"variables-header"}," Variables ",-1)),n("th",{class:"sortable",onClick:t[4]||(t[4]=t=>e.$emit("sort-by","status"))}," Status "+u(e.getSortIcon("status")),1),t[8]||(t[8]=n("th",null,"Raw Response",-1)),t[9]||(t[9]=n("th",null,"Parsed Results",-1)),n("th",{class:"sortable",onClick:t[5]||(t[5]=t=>e.$emit("sort-by","response_time"))}," Time "+u(e.getSortIcon("response_time")),1),t[10]||(t[10]=n("th",null,"Actions",-1))])]),n("tbody",null,[(o(!0),s(l,null,d(e.tasks,t=>{return o(),s("tr",{key:t.id,class:"data-row"},[n("td",{class:"model-cell clickable",onClick:r=>e.$emit("view-task",t)},[n("span",gn,u(t.model),1)],8,yn),n("td",{class:"variables-cell clickable",onClick:r=>e.$emit("view-task",t)},[n("div",$n,[(o(!0),s(l,null,d(t.variables,(e,t)=>(o(),s("div",{key:t,class:"variable-compact"},[n("span",bn,u(t)+":",1),n("span",wn,u(r(String(e),20)),1)]))),128))])],8,_n),n("td",kn,[n("span",{class:p(["status-badge",`status-${t.status}`])},u(t.status),3),t.error?(o(),s("div",{key:0,class:"error-indicator",title:t.error}," ⚠️ ",8,Sn)):m("",!0)]),n("td",{class:"raw-response-cell clickable",onClick:r=>e.$emit("view-task",t)},[n("div",{class:"response-content",title:t.result},[n("pre",jn,u(r(t.result||t.error||"No result",150)),1)],8,Pn)],8,En),n("td",{class:"parsed-results-cell clickable",onClick:r=>e.$emit("view-task",t)},[n("div",Cn,[t.parsed_results?(o(),s("div",Nn,[(o(!0),s(l,null,d(t.parsed_results,(e,t)=>(o(),s("div",{key:t,class:"parsed-item"},[n("span",Rn,u(t)+":",1),n("span",{class:p(["parsed-value",i(e)])},u(a(e)),3)]))),128))])):(o(),s("span",On,"No parsing"))])],8,xn),n("td",In,[n("div",Tn,[n("div",Mn,u(t.response_time||"-")+"ms ",1),t.created_at?(o(),s("div",Dn,u((c=t.created_at,new Date(c).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}))),1)):m("",!0)])]),n("td",zn,[n("button",{class:"btn btn-sm btn-outline",onClick:r=>e.$emit("view-task",t)}," 📋 ",8,An)])]);var c}),128))])])])])]))}}),[["__scopeId","data-v-f35db727"]]),qn={class:"summary-view"},Un={class:"summary-cards"},Fn={class:"summary-card"},Ln={class:"card-content"},Kn={class:"card-value"},Gn={class:"card-percentage"},Bn={class:"summary-card"},Jn={class:"card-content"},Hn={class:"card-value"},Wn={class:"card-percentage"},Zn={class:"summary-card"},Qn={class:"card-content"},Yn={class:"card-value"},Xn={class:"card-sublabel"},ei={class:"summary-card"},ti={class:"card-content"},ri={class:"card-value"},ai={class:"card-sublabel"},si={class:"summary-card cost-card"},oi={class:"card-content"},ni={class:"card-value cost-value"},ii={class:"card-sublabel"},ci={class:"summary-charts"},li={class:"chart-section"},di={class:"model-breakdown"},ui={class:"model-name"},mi={class:"model-bar"},pi={class:"model-percentage"},fi={class:"model-count"},hi={class:"chart-section"},vi={class:"variable-breakdown"},yi={class:"variable-values"},gi={class:"value-name"},_i={class:"value-count"},$i={class:"value-bar"},bi=E(r({__name:"SummaryCards",props:{successCount:{},errorCount:{},successRate:{},errorRate:{},avgResponseTime:{},minMaxResponseTime:{},totalTasks:{},uniqueModelCount:{},totalCost:{},avgCostPerTask:{},modelStats:{},variableStats:{},getModelColor:{type:Function}},setup:e=>(e,t)=>(o(),s("div",qn,[n("div",Un,[n("div",Fn,[t[1]||(t[1]=n("div",{class:"card-icon"}," 📈 ",-1)),n("div",Ln,[n("div",Kn,u(e.successCount),1),t[0]||(t[0]=n("div",{class:"card-label"}," Successful ",-1)),n("div",Gn,u(e.successRate)+"% ",1)])]),n("div",Bn,[t[3]||(t[3]=n("div",{class:"card-icon"}," ⚠️ ",-1)),n("div",Jn,[n("div",Hn,u(e.errorCount),1),t[2]||(t[2]=n("div",{class:"card-label"}," Failed ",-1)),n("div",Wn,u(e.errorRate)+"% ",1)])]),n("div",Zn,[t[5]||(t[5]=n("div",{class:"card-icon"}," ⏱️ ",-1)),n("div",Qn,[n("div",Yn,u(e.avgResponseTime)+"ms ",1),t[4]||(t[4]=n("div",{class:"card-label"}," Avg Response Time ",-1)),n("div",Xn,u(e.minMaxResponseTime),1)])]),n("div",ei,[t[7]||(t[7]=n("div",{class:"card-icon"}," 🎯 ",-1)),n("div",ti,[n("div",ri,u(e.totalTasks),1),t[6]||(t[6]=n("div",{class:"card-label"}," Total Tasks ",-1)),n("div",ai,u(e.uniqueModelCount)+" models ",1)])]),n("div",si,[t[9]||(t[9]=n("div",{class:"card-icon"}," 💰 ",-1)),n("div",oi,[n("div",ni," $"+u(e.totalCost),1),t[8]||(t[8]=n("div",{class:"card-label"}," Total Cost ",-1)),n("div",ii,u(e.avgCostPerTask)+" per task ",1)])])]),n("div",ci,[n("div",li,[t[10]||(t[10]=n("h3",null,"Success Rate by Model",-1)),n("div",di,[(o(!0),s(l,null,d(e.modelStats,t=>(o(),s("div",{key:t.name,class:"model-stat"},[n("div",ui,u(t.name),1),n("div",mi,[n("div",{class:"model-bar-fill",style:f({width:t.successRate+"%",backgroundColor:e.getModelColor(t.successRate)})},null,4)]),n("div",pi,u(t.successRate.toFixed(1))+"% ",1),n("div",fi," ("+u(t.successful)+"/"+u(t.total)+") ",1)]))),128))])]),n("div",hi,[t[11]||(t[11]=n("h3",null,"Variable Distribution",-1)),n("div",vi,[(o(!0),s(l,null,d(e.variableStats,e=>(o(),s("div",{key:e.name,class:"variable-stat"},[n("h4",null,u(e.name),1),n("div",yi,[(o(!0),s(l,null,d(e.values,t=>(o(),s("div",{key:t.value,class:"value-stat"},[n("span",gi,u(t.value),1),n("span",_i,u(t.count)+" tasks",1),n("div",$i,[n("div",{class:"value-bar-fill",style:f({width:t.count/e.total*100+"%"})},null,4)])]))),128))])]))),128))])])])]))}),[["__scopeId","data-v-97a6bf5b"]]),wi={class:"run-name"},ki={class:"design-name"},Si={class:"created-date"},Ei={class:"progress-info"},Pi={key:0},ji={class:"models-info"},xi={class:"actions"},Ci=["disabled"],Ni=E(r({__name:"RunSelectionRow",props:{run:{},isSelected:{type:Boolean}},emits:["select","view-results","delete"],setup(e){const t=e,r=a("...");h(async()=>{if(t.run.design_id){const e=await S.designs.get(t.run.design_id);r.value=e?.name||"Unknown"}});const i=v(()=>"completed"===t.run.status||"stopped"===t.run.status),l=v(()=>{if(!t.run.completed_tasks||0===t.run.completed_tasks)return null;const e=t.run.completed_tasks-(t.run.error_count||0);return Math.round(e/t.run.completed_tasks*100)}),d=e=>{const t=new Date(e),r=(new Date).getTime()-t.getTime(),a=Math.floor(r/864e5);return 0===a?t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):1===a?"Yesterday":a<7?`${a}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(e,t)=>(o(),s("div",{class:p(["run-row",{incomplete:!i.value,selected:e.isSelected}]),onClick:t[1]||(t[1]=t=>e.$emit("view-results",e.run))},[n("div",{class:p(["status-dot",`status-${e.run.status}`])},null,2),n("div",wi,u(e.run.name),1),n("div",ki,u(r.value),1),n("div",Si,u(d(e.run.created_at)),1),n("div",Ei,[c(u(e.run.completed_tasks||0)+"/"+u(e.run.total_tasks||0)+" ",1),null!==l.value?(o(),s("span",Pi,"("+u(l.value)+"%)",1)):m("",!0)]),n("div",ji,u(e.run.models.length)+" models ",1),n("div",xi,[n("button",{class:"action-btn",disabled:"running"===e.run.status,title:"Delete",onClick:t[0]||(t[0]=y(t=>e.$emit("delete",e.run),["stop"]))}," 🗑️ ",8,Ci)])],2))}}),[["__scopeId","data-v-52caea50"]]),Ri={class:"run-selection-container"},Oi={class:"grid-header"},Ii={class:"filter-controls"},Ti={class:"toggle-control"},Mi=["checked"],Di={class:"sort-control"},zi=["value"],Ai={class:"grid-info"},Vi={class:"run-count"},qi={key:0,class:"loading-state"},Ui={key:1,class:"empty-state"},Fi={key:0},Li={key:1},Ki={key:2,class:"runs-list"},Gi=E(r({__name:"RunSelectionGrid",props:{runs:{},filteredRuns:{},loading:{type:Boolean},selectedRunId:{},showIncompleteRuns:{type:Boolean},sortBy:{},hasIncompleteRuns:{type:Boolean}},emits:["select-run","view-results","edit-run","delete-run","update:show-incomplete","update:sort-by"],setup:e=>(e,t)=>(o(),s("div",Ri,[n("div",Oi,[n("div",Ii,[n("label",Ti,[n("input",{type:"checkbox",checked:e.showIncompleteRuns,onChange:t[0]||(t[0]=t=>e.$emit("update:show-incomplete",t.target.checked))},null,40,Mi),t[3]||(t[3]=n("span",null,"Show incomplete runs",-1))]),n("div",Di,[t[5]||(t[5]=n("label",null,"Sort by:",-1)),n("select",{value:e.sortBy,onChange:t[1]||(t[1]=t=>e.$emit("update:sort-by",t.target.value))},t[4]||(t[4]=[g('<option value="created_at" data-v-953cccfe> Most Recent </option><option value="name" data-v-953cccfe> Name </option><option value="updated_at" data-v-953cccfe> Last Updated </option><option value="status" data-v-953cccfe> Status </option><option value="completion" data-v-953cccfe> Completion % </option>',5)]),40,zi)])]),n("div",Ai,[n("span",Vi,u(e.filteredRuns.length)+" runs",1)])]),e.loading?(o(),s("div",qi,t[6]||(t[6]=[n("div",{class:"spinner"},null,-1),n("p",null,"Loading runs...",-1)]))):0===e.filteredRuns.length?(o(),s("div",Ui,[e.showIncompleteRuns?(o(),s("p",Fi," No runs found ")):(o(),s("p",Li," No completed runs found ")),!e.showIncompleteRuns&&e.hasIncompleteRuns?(o(),s("button",{key:2,class:"btn btn-secondary",onClick:t[2]||(t[2]=t=>e.$emit("update:show-incomplete",!0))}," Show incomplete runs ")):m("",!0)])):(o(),s("div",Ki,[(o(!0),s(l,null,d(e.filteredRuns,t=>(o(),_(Ni,{key:t.id,run:t,"is-selected":e.selectedRunId===t.id,onSelect:r=>e.$emit("select-run",t),onViewResults:r=>e.$emit("view-results",t),onEdit:r=>e.$emit("edit-run",t),onDelete:r=>e.$emit("delete-run",t)},null,8,["run","is-selected","onSelect","onViewResults","onEdit","onDelete"]))),128))]))]))}),[["__scopeId","data-v-953cccfe"]]);const Bi={class:"results-view"},Ji={key:0,class:"run-selection-view"},Hi={key:1,class:"analysis-view"},Wi={class:"breadcrumb"},Zi={class:"breadcrumb-current"},Qi={class:"header"},Yi={class:"header-controls"},Xi={class:"view-mode-toggle"},ec={key:0,class:"loading-state"},tc={key:1,class:"no-results"},rc={key:2,class:"results-container"},ac={key:0},sc={key:1,class:"pivot-view"},oc={key:2},nc={class:"modal-content"},ic={class:"modal-header"},cc={class:"modal-body"},lc={class:"cell-tasks"},dc={class:"task-result"},uc=["onClick"],mc=E(r({__name:"ResultsView",setup(e){const t=$(),r=b(),f=P(),g=a("run-selection"),E=a(null),j=a(null),C=a([]),N=a([]),R=a(!1),O=a(!1),I=a(null),T=a("summary"),M=a(null),{showIncompleteRuns:D,sortBy:z,setSortBy:A,filteredRuns:V,hasIncompleteRuns:q}=function(e){const t=a(!1),r=a("created_at"),s=a("desc"),o=v(()=>{let a=e.value;return t.value||(a=a.filter(e=>"completed"===e.status||"stopped"===e.status)),[...a].sort((e,t)=>{let a,o;switch(r.value){case"created_at":a=new Date(e.created_at).getTime(),o=new Date(t.created_at).getTime();break;case"updated_at":a=new Date(e.updated_at||e.created_at).getTime(),o=new Date(t.updated_at||t.created_at).getTime();break;case"name":a=e.name.toLowerCase(),o=t.name.toLowerCase();break;case"status":const r={error:0,running:1,paused:2,completed:3,stopped:4,pending:5,ready:6,draft:7};a=r[e.status]??8,o=r[t.status]??8;break;case"completion":a=e.total_tasks?e.completed_tasks/e.total_tasks:0,o=t.total_tasks?t.completed_tasks/t.total_tasks:0;break;default:return 0}return"desc"===s.value?o<a?-1:o>a?1:0:a<o?-1:a>o?1:0})}),n=v(()=>e.value.some(e=>"completed"!==e.status&&"stopped"!==e.status));return{showIncompleteRuns:t,sortBy:r,sortOrder:s,filteredRuns:o,hasIncompleteRuns:n,setSortBy:e=>{r.value===e?s.value="asc"===s.value?"desc":"asc":(r.value=e,s.value="name"===e?"asc":"desc")},toggleShowIncomplete:()=>{t.value=!t.value}}}(C),{uniqueModels:U,availableVariables:F,successCount:L,errorCount:K,successRate:G,errorRate:B,avgResponseTime:J,minMaxResponseTime:H,modelStats:W,variableStats:Z,getModelColor:Q}=function(e){const t=v(()=>[...new Set(e.value.map(e=>e.model))].sort()),r=v(()=>{const t=new Set;return e.value.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>t.add(e))}),Array.from(t).sort()}),a=v(()=>e.value.filter(e=>"completed"===e.status).length),s=v(()=>e.value.filter(e=>"error"===e.status).length),o=v(()=>0===e.value.length?0:Math.round(a.value/e.value.length*100)),n=v(()=>0===e.value.length?0:Math.round(s.value/e.value.length*100)),i=v(()=>{const t=e.value.filter(e=>"completed"===e.status&&e.response_time);if(0===t.length)return 0;const r=t.reduce((e,t)=>e+(t.response_time||0),0);return Math.round(r/t.length)}),c=v(()=>{const t=e.value.filter(e=>e.response_time&&e.response_time>0).map(e=>e.response_time);return 0===t.length?"-":`${Math.min(...t)}-${Math.max(...t)}ms`}),l=v(()=>t.value.map(t=>{const r=e.value.filter(e=>e.model===t),a=r.filter(e=>"completed"===e.status).length,s=r.length;return{name:t,successful:a,total:s,successRate:s>0?a/s*100:0}}).sort((e,t)=>t.successRate-e.successRate)),d=v(()=>r.value.map(t=>{const r=new Map;let a=0;e.value.forEach(e=>{if(e.variables&&e.variables[t]){const s=String(e.variables[t]);r.set(s,(r.get(s)||0)+1),a++}});const s=Array.from(r.entries()).map(([e,t])=>({value:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10);return{name:t,values:s,total:a}}));return{uniqueModels:t,availableVariables:r,successCount:a,errorCount:s,successRate:o,errorRate:n,avgResponseTime:i,minMaxResponseTime:c,modelStats:l,variableStats:d,getModelColor:e=>e>=80?"#10b981":e>=60?"#fbbf24":"#ef4444"}}(N),{filters:Y,filteredTasks:X,getVariableValues:ee,resetFilters:te,sortBy:re,getSortIcon:ae}=function(e){const t=a({search:"",model:"",status:"",variables:{}}),r=a(""),s=a("asc"),o=v(()=>{let a=[...e.value];if(t.value.search){const e=t.value.search.toLowerCase();a=a.filter(t=>(t.result||"").toLowerCase().includes(e)||(t.error||"").toLowerCase().includes(e)||t.model.toLowerCase().includes(e))}return t.value.model&&(a=a.filter(e=>e.model===t.value.model)),t.value.status&&(a=a.filter(e=>e.status===t.value.status)),Object.entries(t.value.variables).forEach(([e,t])=>{t&&(a=a.filter(r=>r.variables&&String(r.variables[e])===t))}),r.value&&a.sort((e,t)=>{let a,o;switch(r.value){case"model":a=e.model,o=t.model;break;case"status":a=e.status,o=t.status;break;case"response_time":a=e.response_time||0,o=t.response_time||0;break;default:return 0}return a<o?"asc"===s.value?-1:1:a>o?"asc"===s.value?1:-1:0}),a});return{filters:t,filteredTasks:o,getVariableValues:t=>{const r=new Set;return e.value.forEach(e=>{e.variables&&e.variables[t]&&r.add(String(e.variables[t]))}),Array.from(r).sort()},resetFilters:()=>{t.value={search:"",model:"",status:"",variables:{}}},sortBy:e=>{r.value===e?s.value="asc"===s.value?"desc":"asc":(r.value=e,s.value="asc")},getSortIcon:e=>r.value!==e?"":"asc"===s.value?"↑":"↓"}}(N),{resetPagination:se}=function(e,t=50){const r=a(1),s=v(()=>Math.ceil(e.value.length/t)),o=v(()=>{const a=(r.value-1)*t,s=a+t;return e.value.slice(a,s)});return{currentPage:r,totalPages:s,paginatedTasks:o,resetPagination:()=>{r.value=1}}}(X),{exportCSV:oe,exportJSON:ne,exportExcel:ie}=Go(),{modelStats:ce,getModelColor:le}=function(e){const t=v(()=>e.value.filter(e=>"completed"===e.status&&!e.error).length),r=v(()=>e.value.filter(e=>"error"===e.status||e.error).length),a=v(()=>e.value.length),s=v(()=>a.value>0?t.value/a.value*100:0),o=v(()=>a.value>0?r.value/a.value*100:0),n=v(()=>e.value.filter(e=>e.response_time&&e.response_time>0).map(e=>e.response_time)),i=v(()=>0===n.value.length?0:n.value.reduce((e,t)=>e+t,0)/n.value.length),c=v(()=>0===n.value.length?{min:0,max:0}:{min:Math.min(...n.value),max:Math.max(...n.value)}),l=v(()=>e.value.reduce((e,t)=>e+(t.api_call_log?.cost_estimate?.estimated_cost_usd||0),0)),d=v(()=>a.value>0?l.value/a.value:0),u=v(()=>{const t=e.value.reduce((e,t)=>{const r=t.model||"Unknown";return e[r]||(e[r]=[]),e[r].push(t),e},{});return Object.entries(t).map(([e,t])=>{const r=t.filter(e=>"completed"===e.status&&!e.error),a=t.filter(e=>"error"===e.status||e.error),s=t.filter(e=>e.response_time&&e.response_time>0).map(e=>e.response_time),o=s.length>0?s.reduce((e,t)=>e+t,0)/s.length:0,n=t.reduce((e,t)=>e+(t.usage?.total_tokens||0),0),i=t.reduce((e,t)=>e+(t.api_call_log?.cost_estimate?.estimated_cost_usd||0),0);return{name:e,tasks:t.length,successCount:r.length,errorCount:a.length,successRate:t.length>0?r.length/t.length*100:0,avgResponseTime:o,totalTokens:n,estimatedCost:i}}).sort((e,t)=>t.tasks-e.tasks)}),m=v(()=>{const e=Math.max(...u.value.map(e=>e.avgResponseTime));return Math.max(e,c.value.max)}),p=v(()=>({success:{count:t.value,rate:s.value,trend:s.value>=80?"positive":s.value>=60?"neutral":"negative"},error:{count:r.value,rate:o.value,trend:o.value<=5?"positive":o.value<=20?"neutral":"negative"},timing:{count:i.value,rate:i.value,min:c.value.min,max:c.value.max},cost:{count:l.value,rate:d.value,total:l.value,perTask:d.value}}));return{successCount:t,errorCount:r,totalTasks:a,successRate:s,errorRate:o,avgResponseTime:i,minMaxResponseTime:c,maxResponseTime:m,totalEstimatedCost:l,costPerTask:d,modelStats:u,metricsCards:p,getModelColor:e=>{const t=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316","#6366f1","#84cc16"];let r=0;for(let a=0;a<e.length;a++)r=e.charCodeAt(a)+((r<<5)-r);return t[Math.abs(r)%t.length]}}}(N);!function(e,t){v(()=>e.value.map(e=>({label:e.name.split("-")[0],value:e.successRate,color:t(e.name),percentage:e.successRate}))),v(()=>e.value.map(e=>({label:e.name.split("-")[0],value:e.avgResponseTime,color:t(e.name)}))),v(()=>{const r=e.value.reduce((e,t)=>e+t.estimatedCost,0);return e.value.filter(e=>e.estimatedCost>0).map(e=>({label:e.name.split("-")[0],value:e.estimatedCost,color:t(e.name),percentage:r>0?e.estimatedCost/r*100:0})).sort((e,t)=>t.value-e.value).slice(0,5)}),v(()=>{const r=e.value.reduce((e,t)=>e+t.tasks,0);return e.value.map(e=>({label:e.name.split("-")[0],value:e.tasks,color:t(e.name),percentage:r>0?e.tasks/r*100:0}))}),v(()=>{const t=e.value.flatMap(e=>Array(e.tasks).fill(e.avgResponseTime));if(0===t.length)return[];const r=Math.max(...t)/5,a=Array.from({length:5},(e,t)=>({range:`${(t*r).toFixed(1)}-${((t+1)*r).toFixed(1)}s`,count:0,percentage:0}));return t.forEach(e=>{const t=Math.min(Math.floor(e/r),4);a[t].count++}),a.forEach(e=>{e.percentage=e.count/t.length*100}),a})}(ce,le);const de=v(()=>N.value.reduce((e,t)=>e+(t.api_call_log?.cost_estimate?.estimated_cost_usd||0),0).toFixed(4)),ue=v(()=>{const e=parseFloat(de.value);return N.value.length>0?(e/N.value.length).toFixed(6):"0.000000"});async function me(){O.value=!0;try{await f.loadRuns();const{runs:e}=w(f);C.value=e.value}catch(e){console.error("Error loading runs:",e)}finally{O.value=!1}}function pe(e){E.value=e.id,j.value=e}async function fe(e){pe(e),g.value="analysis",await async function(){if(E.value){R.value=!0;try{N.value=await S.tasks.where("run_id").equals(E.value).toArray(),te(),se()}catch(e){console.error("Error loading results:",e)}finally{R.value=!1}}}(),r.replace(`/results/${e.id}`)}function he(){g.value="run-selection",E.value=null,j.value=null,N.value=[],r.replace("/results")}async function ve(e){r.push(`/runs/edit/${e.id}`)}async function ye(e){if(confirm(`Are you sure you want to delete run "${e.name}"?`))try{await S.runs.delete(e.id),await me()}catch(t){console.error("Error deleting run:",t),alert("Failed to delete run")}}h(async()=>{if(await me(),t.params.id){const e=Number(t.params.id),r=C.value.find(t=>t.id===e);r&&await fe(r)}});const ge=(e,t)=>{Y.value[e]=t,se()},_e=(e,t)=>{Y.value.variables[e]=t,se()},$e=()=>{oe(X.value,E.value)},be=()=>{ne(X.value,E.value,Y.value)},we=()=>{ie(X.value,E.value)};function ke(e){I.value=e}function Se(e){M.value=e}async function Ee(){if(!E.value||!j.value)return;const e={metadata:{exported_at:(new Date).toISOString(),auditomatic_version:"2.0.0",export_type:"complete_run",reproducible_hash:btoa(JSON.stringify({design_id:j.value.design_id,parameters:j.value.parameters}))},run:{id:j.value.id,name:j.value.name,design_id:j.value.design_id,status:j.value.status,created_at:j.value.created_at,updated_at:j.value.updated_at,parameters:j.value.parameters},experiment:{total_tasks:N.value.length,completed_tasks:L.value,failed_tasks:K.value,success_rate:G.value,error_rate:B.value,avg_response_time:J.value,models_used:U.value,variables:F.value},results:{tasks:N.value.map(e=>({id:e.id,model:e.model,status:e.status,variables:e.variables,prompt:e.prompt,result:e.result,error:e.error,parsed_results:e.parsed_results,response_time:e.response_time,created_at:e.created_at,completed_at:e.completed_at,api_call_log:e.api_call_log})),summary_statistics:{by_model:W.value,by_variable:Z.value}},cost_analysis:{total_cost:de.value,avg_cost_per_task:ue.value,cost_by_model:W.value.map(e=>({model:e.name,total_cost:N.value.filter(t=>t.model===e.name&&t.api_call_log?.cost_estimate).reduce((e,t)=>e+(t.api_call_log?.cost_estimate.estimated_cost_usd||0),0).toFixed(4)}))},verification:{total_tasks:N.value.length,tasks_with_api_logs:N.value.filter(e=>e.api_call_log).length,tasks_with_results:N.value.filter(e=>e.result).length,tasks_with_errors:N.value.filter(e=>e.error).length,estimated_total_cost:de.value}},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`run-${j.value.id}-export-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}return(e,t)=>(o(),s("div",Bi,["run-selection"===g.value?(o(),s("div",Ji,[t[8]||(t[8]=n("div",{class:"header"},[n("h2",null,"Results")],-1)),i(Gi,{runs:C.value,"filtered-runs":k(V),loading:O.value,"selected-run-id":E.value,"show-incomplete-runs":k(D),"sort-by":k(z),"has-incomplete-runs":k(q),onSelectRun:pe,onViewResults:fe,onEditRun:ve,onDeleteRun:ye,"onUpdate:showIncomplete":t[0]||(t[0]=e=>D.value=e),"onUpdate:sortBy":t[1]||(t[1]=e=>k(A)(e))},null,8,["runs","filtered-runs","loading","selected-run-id","show-incomplete-runs","sort-by","has-incomplete-runs"])])):"analysis"===g.value&&j.value?(o(),s("div",Hi,[n("nav",Wi,[n("button",{class:"breadcrumb-link",onClick:he}," ← Results Overview "),t[9]||(t[9]=n("span",{class:"breadcrumb-separator"},"/",-1)),n("span",Zi,u(j.value.name),1)]),n("div",Qi,[n("h2",null,u(j.value.name),1),n("div",Yi,[n("div",Xi,[n("button",{class:p(["btn","btn-sm",{active:"summary"===T.value}]),onClick:t[2]||(t[2]=e=>T.value="summary")}," 📊 Summary ",2),n("button",{class:p(["btn","btn-sm",{active:"pivot"===T.value}]),onClick:t[3]||(t[3]=e=>T.value="pivot")}," 📈 Pivot ",2),n("button",{class:p(["btn","btn-sm",{active:"table"===T.value}]),onClick:t[4]||(t[4]=e=>T.value="table")}," 📋 Raw Data ",2)]),N.value.length>0?(o(),s("button",{key:0,class:"btn btn-primary btn-sm export-run-btn",onClick:Ee}," 📤 Export Run ")):m("",!0)])]),R.value?(o(),s("div",ec,t[10]||(t[10]=[n("div",{class:"spinner"},null,-1),n("p",null,"Loading results...",-1)]))):0===N.value.length?(o(),s("div",tc,t[11]||(t[11]=[n("div",{class:"empty-icon"}," ❌ ",-1),n("h3",null,"No results found",-1),n("p",null,"This run doesn't have any completed tasks or results to analyze.",-1)]))):(o(),s("div",rc,["summary"===T.value?(o(),s("div",ac,[i(bi,{"success-count":k(L),"error-count":k(K),"success-rate":k(G),"error-rate":k(B),"avg-response-time":k(J),"min-max-response-time":k(H),"total-tasks":N.value.length,"unique-model-count":k(U).length,"total-cost":de.value,"avg-cost-per-task":ue.value,"model-stats":k(W),"variable-stats":k(Z),"get-model-color":k(Q)},null,8,["success-count","error-count","success-rate","error-rate","avg-response-time","min-max-response-time","total-tasks","unique-model-count","total-cost","avg-cost-per-task","model-stats","variable-stats","get-model-color"])])):m("",!0),"pivot"===T.value?(o(),s("div",sc,[i(Jo,{tasks:k(X),onCellClick:Se},null,8,["tasks"])])):m("",!0),"table"===T.value?(o(),s("div",oc,[i(cn,{filters:k(Y),"unique-models":k(U),"available-variables":k(F),"get-variable-values":k(ee),onUpdateFilter:ge,onUpdateVariableFilter:_e,onResetFilters:k(te)},null,8,["filters","unique-models","available-variables","get-variable-values","onResetFilters"]),i(Vn,{tasks:k(X),"results-count":`${k(X).length} of ${N.value.length} results`,"get-sort-icon":k(ae),onExportCsv:$e,onExportJson:be,onExportExcel:we,onSortBy:k(re),onViewTask:ke},null,8,["tasks","results-count","get-sort-icon","onSortBy"])])):m("",!0)]))])):m("",!0),I.value?(o(),_(x,{key:2,task:I.value,onClose:t[5]||(t[5]=e=>I.value=null)},null,8,["task"])):m("",!0),M.value?(o(),s("div",{key:3,class:"modal-overlay",onClick:t[7]||(t[7]=y(e=>M.value=null,["self"]))},[n("div",nc,[n("div",ic,[n("h3",null,u(M.value.row)+" × "+u(M.value.column),1),n("button",{class:"close-btn",onClick:t[6]||(t[6]=e=>M.value=null)}," × ")]),n("div",cc,[n("p",null,[n("strong",null,u(M.value.tasks.length),1),t[12]||(t[12]=c(" tasks in this cell:"))]),n("div",lc,[(o(!0),s(l,null,d(M.value.tasks,e=>{return o(),s("div",{key:e.id,class:"cell-task"},[n("span",{class:p(["task-status",`status-${e.status}`])},u(e.status),3),n("span",dc,u((t=e.result||e.error||"No result",r=80,t.length<=r?t:t.substring(0,r)+"...")),1),n("button",{class:"btn btn-sm btn-outline",onClick:t=>function(e){M.value=null,I.value=e}(e)}," View ",8,uc)]);var t,r}),128))])])])])):m("",!0)]))}}),[["__scopeId","data-v-716a2106"]]);export{mc as default};

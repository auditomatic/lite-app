import{i as e,d as a,b as l,e as t,f as s,F as o,A as n,t as r,a0 as u,n as i,r as c,y as d,j as p,k as v,g,Q as m,V as f,p as b,L as h,w as k}from"./vendor-w2iEWTO6.js";import{d as y,_}from"./index-Be1jm3CD.js";import{a as w}from"./apiLogger-DxGnFuqw.js";async function C(e){return await y.tasks.where("run_id").equals(e).toArray()}function F(e,a){switch(a){case"model":return e.model;case"status":return e.status;case"response_time":return e.response_time||0;case"total_tokens":return e.usage?.total_tokens||0;case"result_length":return e.result?.length||0;case"error_type":return e.error?"error":"success";case"result":case"raw_result":return e.result||"";case"success":if(e.parsed_results&&Object.keys(e.parsed_results).length>0){return Object.values(e.parsed_results).some(e=>null!=e&&""!==e)?1:0}return 0}return void 0!==e.parsed_results?.[a]?e.parsed_results[a]:e.variables?.[a]||"Unknown"}function M(e){if("number"==typeof e)return isNaN(e)?null:e;if("string"==typeof e){const a=e.match(/-?\d+\.?\d*/);return a?parseFloat(a[0]):null}return null}const S={count:{label:"Count",calculate:e=>e.length,format:e=>e.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:e=>{const a=e.map(M).filter(e=>null!==e);return a.length>0?a.reduce((e,a)=>e+a,0):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mean:{label:"Mean",calculate:e=>{const a=e.map(M).filter(e=>null!==e);return a.length>0?a.reduce((e,a)=>e+a,0)/a.length:null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},median:{label:"Median",calculate:e=>{const a=e.map(M).filter(e=>null!==e);if(0===a.length)return null;const l=[...a].sort((e,a)=>e-a),t=Math.floor(l.length/2);return l.length%2==0?(l[t-1]+l[t])/2:l[t]},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mode:{label:"Mode",calculate:e=>{if(0===e.length)return null;const a=new Map;e.forEach(e=>a.set(e,(a.get(e)||0)+1));let l=0,t=null;return a.forEach((e,a)=>{e>l&&(l=e,t=a)}),{value:t,count:l,total:e.length}},format:e=>e?`${e.value} (${e.count}/${e.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:e=>{const a=e.map(M).filter(e=>null!==e);if(a.length<=1)return null;const l=a.reduce((e,a)=>e+a,0)/a.length;return a.reduce((e,a)=>e+Math.pow(a-l,2),0)/(a.length-1)},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:e=>{const a=S.variance.calculate(e);return null!==a?Math.sqrt(a):null},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},min:{label:"Min",calculate:e=>{const a=e.map(M).filter(e=>null!==e);return a.length>0?Math.min(...a):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},max:{label:"Max",calculate:e=>{const a=e.map(M).filter(e=>null!==e);return a.length>0?Math.max(...a):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(e,a)=>{const l=a.filter(e=>"completed"===e.status).length;return a.length>0?l/a.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesTasks:!0},avg_time:{label:"Avg Time (ms)",calculate:(e,a)=>{const l=a.filter(e=>e.response_time).map(e=>e.response_time);return l.length>0?l.reduce((e,a)=>e+a,0)/l.length:null},format:e=>e?`${Math.round(e)}ms`:"-",needsNumeric:!1,usesTasks:!0}};function x(e,a){if(!e||null===e.value)return"-";return S[a].format(e.value)}const $={"blue-subtle":{name:"Blue (Subtle)",colors:["rgba(59, 130, 246, 0.1)","rgba(59, 130, 246, 0.3)","rgba(59, 130, 246, 0.7)"]},"green-red":{name:"Green-Red",colors:["#dc2626","#fbbf24","#10b981"]},"blue-yellow":{name:"Blue-Yellow",colors:["#1e40af","#3b82f6","#fbbf24"]},"purple-orange":{name:"Purple-Orange",colors:["#7c3aed","#a855f7","#ff9500"]},grayscale:{name:"Grayscale",colors:["#f3f4f6","#9ca3af","#374151"]},viridis:{name:"Viridis",colors:["#440154","#482878","#3e4989","#31688e","#26828e","#1f9e89","#35b779","#6ece58","#b5de2b","#fde725"]},inferno:{name:"Inferno",colors:["#000004","#1b0c41","#4a0c6b","#781c6d","#a52c60","#cf4446","#ed6925","#fb9b06","#f7d13d","#fcffa4"]},magma:{name:"Magma",colors:["#000004","#180f3d","#440f76","#721f81","#9e2f7f","#cd4071","#f1605d","#fd9668","#feca8d","#fcfdbf"]},plasma:{name:"Plasma",colors:["#0d0887","#46039f","#7201a8","#9c179e","#bd3786","#d8576b","#ed7953","#fb9f3a","#fdca26","#f0f921"]}};function T(e,a){if(0===a.length)return"transparent";if(1===a.length)return a[0];e=Math.max(0,Math.min(1,e));const l=1/(a.length-1),t=Math.floor(e/l),s=e%l/l;return I(a[Math.min(t,a.length-1)],a[Math.min(t+1,a.length-1)],s)}function I(e,a,l){if(e.startsWith("rgba")&&a.startsWith("rgba")){const t=e=>{const a=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);return a?{r:parseInt(a[1]),g:parseInt(a[2]),b:parseInt(a[3]),a:a[4]?parseFloat(a[4]):1}:null},s=t(e),o=t(a);if(s&&o){return`rgba(${Math.round(s.r+(o.r-s.r)*l)}, ${Math.round(s.g+(o.g-s.g)*l)}, ${Math.round(s.b+(o.b-s.b)*l)}, ${(s.a+(o.a-s.a)*l).toFixed(2)})`}}if(e.startsWith("rgba")||a.startsWith("rgba"))return l<.5?e:a;const t=e.replace("#",""),s=a.replace("#",""),o=parseInt(t.substr(0,2),16),n=parseInt(t.substr(2,2),16),r=parseInt(t.substr(4,2),16),u=parseInt(s.substr(0,2),16),i=parseInt(s.substr(2,2),16),c=parseInt(s.substr(4,2),16),d=Math.round(o+(u-o)*l),p=Math.round(n+(i-n)*l),v=Math.round(r+(c-r)*l);return`#${d.toString(16).padStart(2,"0")}${p.toString(16).padStart(2,"0")}${v.toString(16).padStart(2,"0")}`}function R(e){let a,l,t;if(e.startsWith("rgba")){const s=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);if(!s)return!1;a=parseInt(s[1]),l=parseInt(s[2]),t=parseInt(s[3])}else{const s="#"===e.charAt(0)?e.substring(1,7):e;a=parseInt(s.substring(0,2),16),l=parseInt(s.substring(2,4),16),t=parseInt(s.substring(4,6),16)}const s=[a/255,l/255,t/255].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*s[0]+.7152*s[1]+.0722*s[2]<=.179}function A(e){return R(e)?"#FFFFFF":"#000000"}function E(a,l,t){const{colorScales:s,interpolateColor:o,getContrastColor:n}={colorScales:$,interpolateColor:T,interpolateBetweenColors:I,colorIsDarkAdvanced:R,getContrastColor:A};return{getCellStyle:function(e,r,u){if(!e||null===e.value||"number"!=typeof e.value)return{};const i=s[l.value],c=function(e,l,s){const o=M(e.value);if(null===o)return.5;if("global"===t.value){const e=a.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>M(e.value)).filter(e=>null!==e);if(e.length>0){const a=Math.min(...e),l=Math.max(...e);if(l!==a)return(o-a)/(l-a)}}else if("column"===t.value){const e=a.value.rows.map(e=>e.cells[s]).filter(e=>null!==e).map(e=>M(e.value)).filter(e=>null!==e);if(e.length>0){const a=Math.min(...e),l=Math.max(...e);if(l!==a)return(o-a)/(l-a)}}else if("row"===t.value){const e=a.value.rows.find(e=>e.label===l);if(e){const a=e.cells.filter(e=>null!==e).map(e=>M(e.value)).filter(e=>null!==e);if(a.length>0){const e=Math.min(...a),l=Math.max(...a);if(l!==e)return(o-e)/(l-e)}}}return.5}(e,r,u),d=o(c,i.colors);return{backgroundColor:`${d} !important`,color:`${n(d)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},getSummaryStyle:function(e){if(!e||null===e.value||"number"!=typeof e.value)return{};const t=s[l.value];let r=.5;const u=a.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>M(e.value)).filter(e=>null!==e);if(u.length>0){const a=Math.min(...u),l=Math.max(...u),t=M(e.value);null!==t&&(r=l!==a?(t-a)/(l-a):.5)}const i=o(r,t.colors);return{backgroundColor:`${i} !important`,color:`${n(i)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},styleKey:e(()=>`${l.value}-${t.value}`)}}const P={class:"pivot-config"},j={class:"config-row"},U={class:"config-group"},N=["value"],O={label:"Categorical"},V=["value"],G={class:"config-group"},L=["value"],D={label:"Categorical"},B=["value"],q={class:"config-group"},W=["value"],z={label:"Extracted Values"},H=["value"],J={label:"Numeric Fields"},K=["value"],Y={class:"config-group"},Q=["value"],X=_(a({__name:"PivotConfiguration",props:{config:{},availableFields:{}},emits:["update-config"],setup(e,{emit:a}){const i=a;function c(e,a){i("update-config",e,a)}function d(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Token Count",result_length:"Result Length",error_type:"Error Type"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return(e,a)=>(t(),l("div",P,[s("div",j,[s("div",U,[a[4]||(a[4]=s("label",null,"Rows (Group by):",-1)),s("select",{value:e.config.rowField,onChange:a[0]||(a[0]=e=>c("rowField",e.target.value))},[s("optgroup",O,[(t(!0),l(o,null,n(e.availableFields.categorical,e=>(t(),l("option",{key:e,value:e},r(d(e)),9,V))),128))])],40,N)]),s("div",G,[a[5]||(a[5]=s("label",null,"Columns (Group by):",-1)),s("select",{value:e.config.columnField,onChange:a[1]||(a[1]=e=>c("columnField",e.target.value))},[s("optgroup",D,[(t(!0),l(o,null,n(e.availableFields.categorical,e=>(t(),l("option",{key:e,value:e},r(d(e)),9,B))),128))])],40,L)]),s("div",q,[a[7]||(a[7]=s("label",null,"Values (Aggregate):",-1)),s("select",{value:e.config.valueField,onChange:a[2]||(a[2]=e=>c("valueField",e.target.value))},[s("optgroup",z,[(t(!0),l(o,null,n(e.availableFields.extracted,e=>(t(),l("option",{key:e,value:e},r(e),9,H))),128))]),s("optgroup",J,[(t(!0),l(o,null,n(e.availableFields.numeric,e=>(t(),l("option",{key:e,value:e},r(d(e)),9,K))),128))]),a[6]||(a[6]=s("option",{value:"result"}," Raw Result Text ",-1))],40,W)]),s("div",Y,[a[9]||(a[9]=s("label",null,"Aggregation:",-1)),s("select",{value:e.config.aggregation,onChange:a[3]||(a[3]=e=>c("aggregation",e.target.value))},a[8]||(a[8]=[u('<optgroup label="Statistical" data-v-2b5d370f><option value="mean" data-v-2b5d370f> Mean </option><option value="median" data-v-2b5d370f> Median </option><option value="variance" data-v-2b5d370f> Variance </option><option value="std_dev" data-v-2b5d370f> Std Dev </option><option value="min" data-v-2b5d370f> Min </option><option value="max" data-v-2b5d370f> Max </option></optgroup><optgroup label="Frequency" data-v-2b5d370f><option value="count" data-v-2b5d370f> Count </option><option value="mode" data-v-2b5d370f> Mode </option></optgroup><optgroup label="Performance" data-v-2b5d370f><option value="success_rate" data-v-2b5d370f> Success Rate </option><option value="avg_time" data-v-2b5d370f> Avg Time </option></optgroup>',3)]),40,Q)])])]))}}),[["__scopeId","data-v-2b5d370f"]]),Z={class:"heatmap-controls"},ee={class:"color-scale-selector"},ae=["value"],le={class:"gradient-mode-selector"},te={class:"gradient-toggle"},se=["title"],oe=_(a({__name:"PivotHeatmapControls",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(e,{emit:a}){const o=a;function n(e){const a=e.target.value;o("update-color-scale",a)}function c(e){o("update-gradient-mode",e)}return(e,a)=>(t(),l("div",Z,[s("div",ee,[a[5]||(a[5]=s("label",null,"Color Scale:",-1)),s("select",{value:e.selectedColorScale,onChange:n},a[4]||(a[4]=[u('<option value="blue-subtle" data-v-5e89d613> Blue (Subtle) </option><option value="green-red" data-v-5e89d613> Green-Red (Success) </option><option value="blue-yellow" data-v-5e89d613> Blue-Yellow (Performance) </option><option value="purple-orange" data-v-5e89d613> Purple-Orange (General) </option><option value="viridis" data-v-5e89d613> Viridis </option><option value="inferno" data-v-5e89d613> Inferno </option><option value="magma" data-v-5e89d613> Magma </option><option value="plasma" data-v-5e89d613> Plasma </option><option value="grayscale" data-v-5e89d613> Grayscale </option>',9)]),40,ae)]),s("div",le,[a[6]||(a[6]=s("label",null,"Gradient Mode:",-1)),s("div",te,[s("button",{class:i(["toggle-btn",{active:"global"===e.gradientMode}]),onClick:a[0]||(a[0]=e=>c("global"))}," Global ",2),s("button",{class:i(["toggle-btn",{active:"column"===e.gradientMode}]),onClick:a[1]||(a[1]=e=>c("column"))}," Per Column ",2),s("button",{class:i(["toggle-btn",{active:"row"===e.gradientMode}]),onClick:a[2]||(a[2]=e=>c("row"))}," Per Row ",2)])]),s("button",{class:"fullscreen-btn",title:e.isFullscreen?"Exit Fullscreen":"Enter Fullscreen",onClick:a[3]||(a[3]=a=>e.$emit("toggle-fullscreen"))},r(e.isFullscreen?"⊟":"⊞"),9,se)]))}}),[["__scopeId","data-v-5e89d613"]]),ne={key:0,class:"data-filters"},re={class:"filters-row"},ue={key:0,class:"filter-group"},ie=["value"],ce={class:"filter-label"},de=["onUpdate:modelValue"],pe={value:""},ve=["value"],ge={key:1,class:"filter-group"},me=["value"],fe={class:"table-view"},be={class:"pivot-table-container"},he={class:"pivot-table-grid responsive-table"},ke={class:"corner-cell"},ye={key:0,class:"total-header"},_e={class:"row-header"},we=["title","onClick"],Ce=_(a({__name:"PivotTableCore",props:{tasks:{},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0}},emits:["config-change","cell-click"],setup(a,{emit:u}){const k=a,y=u,_=c(!1),w=c("viridis"),C=c("global"),M=c({rowField:k.config?.rowField||"",columnField:k.config?.columnField||"",valueField:k.config?.valueField||"",aggregation:k.config?.aggregation||"mean"});d(()=>k.config,e=>{e&&Object.assign(M.value,e)},{deep:!0});const $=e(()=>function(e){const a=new Set,l=new Set;e.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>a.add(e)),e.parsed_results&&Object.keys(e.parsed_results).forEach(e=>l.add(e))});const t=Array.from(a).sort(),s=["success",...Array.from(l).sort()];return{categorical:[...t,"model","status","error_type"],numeric:["response_time","total_tokens","result_length"].sort(),extracted:s}}(I.value.length>0||P.value?I.value:k.tasks)),T=c({}),I=c([]),R=e(()=>{if(0===k.tasks.length)return{};const e={};k.tasks.forEach(a=>{a.model&&(e.model||(e.model=new Set),e.model.add(a.model)),a.status&&(e.status||(e.status=new Set),e.status.add(a.status)),a.variables&&Object.entries(a.variables).forEach(([a,l])=>{l&&String(l).trim()&&(e[a]||(e[a]=new Set),e[a].add(String(l)))})});const a={};return Object.entries(e).forEach(([e,l])=>{a[e]=Array.from(l).sort()}),a}),A=e(()=>{const{model:e,status:a,...l}=R.value;return l}),P=e(()=>Object.values(T.value).some(e=>""!==e));function j(){I.value=k.tasks.filter(e=>{if(T.value.model&&""!==T.value.model&&e.model!==T.value.model)return!1;if(T.value.status&&""!==T.value.status&&e.status!==T.value.status)return!1;for(const[a,l]of Object.entries(T.value))if(l&&""!==l&&"model"!==a&&"status"!==a){const t=e.variables?.[a];if(t!==l)return!1}return!0})}function U(){T.value={},j()}d(()=>k.tasks,()=>{P.value?j():I.value=k.tasks},{immediate:!0});const N=e(()=>{const e=I.value.length>0||P.value?I.value:k.tasks;return 0===e.length?{rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,tasks:[],rawValues:[]}}:function(e,a){const l=new Map,t=new Set,s=new Set;e.forEach(e=>{const o=String(F(e,a.rowField)||"Unknown"),n=String(F(e,a.columnField)||"Unknown");t.add(o),s.add(n),l.has(o)||l.set(o,new Map),l.get(o).has(n)||l.get(o).set(n,[]),l.get(o).get(n).push(e)});const o=Array.from(t).sort(),n=Array.from(s).sort(),r=S[a.aggregation];function u(e){const l=e.map(e=>F(e,a.valueField));return{value:r.usesTasks?r.calculate(l,e):r.calculate(l),count:e.length,tasks:e,rawValues:l}}const i=o.map(e=>{const a=[],t=[];return n.forEach(s=>{const o=l.get(e)?.get(s)||[];a.push(o.length>0?u(o):null),t.push(...o)}),{label:e,cells:a,total:u(t)}}),c=n.map(e=>{const a=[];return o.forEach(t=>{const s=l.get(t)?.get(e)||[];a.push(...s)}),u(a)});return{rows:i,columns:n,totals:c,grandTotal:u(e)}}(e,M.value)}),O=e(()=>N.value.rows);e(()=>!1);const{getCellStyle:V,getSummaryStyle:G,styleKey:L}=E(N,w,C);function D(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Token Count",result_length:"Result Length",error_type:"Error Type"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function B(e,a,l){if(!l)return`${e} × ${a}: No data`;return`${e} × ${a}: ${x(l,M.value.aggregation)} (${l.count} tasks)`}function q(e,a){M.value[e]=a,y("config-change",{...M.value})}function W(){_.value=!_.value,_.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return p(()=>{_.value&&(document.body.style.overflow="")}),d([$,()=>k.tasks.length],([e])=>{k.tasks.length>0&&(!M.value.rowField||""===M.value.rowField)&&e.categorical.length>0&&(M.value.rowField=e.categorical.find(e=>"model"!==e&&"status"!==e&&"error_type"!==e)||e.categorical[0]||"model",M.value.columnField=M.value.columnField||"model",M.value.valueField=M.value.valueField||e.extracted.find(e=>"match_1"===e)||e.extracted[0]||"response_time",M.value.aggregation=M.value.aggregation||"mean",y("config-change",{...M.value}))},{immediate:!0}),(e,a)=>(t(),l("div",{class:i(["pivot-table-core",{fullscreen:_.value}])},[v(X,{config:M.value,"available-fields":$.value,onUpdateConfig:q},null,8,["config","available-fields"]),v(oe,{"selected-color-scale":w.value,"gradient-mode":C.value,"is-fullscreen":_.value,onUpdateColorScale:a[0]||(a[0]=e=>w.value=e),onUpdateGradientMode:a[1]||(a[1]=e=>C.value=e),onToggleFullscreen:W},null,8,["selected-color-scale","gradient-mode","is-fullscreen"]),R.value&&Object.keys(R.value).length>0?(t(),l("div",ne,[s("div",re,[R.value.model&&R.value.model.length>1?(t(),l("div",ue,[a[5]||(a[5]=s("label",{class:"filter-label"},"Model:",-1)),m(s("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.model=e),class:"filter-select",onChange:j},[a[4]||(a[4]=s("option",{value:""}," All Models ",-1)),(t(!0),l(o,null,n(R.value.model,e=>(t(),l("option",{key:e,value:e},r(e),9,ie))),128))],544),[[f,T.value.model]])])):g("",!0),(t(!0),l(o,null,n(A.value,(e,a)=>(t(),l("div",{key:a,class:"filter-group"},[s("label",ce,r(D(String(a)))+":",1),m(s("select",{"onUpdate:modelValue":e=>T.value[a]=e,class:"filter-select",onChange:j},[s("option",pe," All "+r(D(String(a))),1),(t(!0),l(o,null,n(e,e=>(t(),l("option",{key:e,value:e},r(e),9,ve))),128))],40,de),[[f,T.value[a]]])]))),128)),R.value.status&&R.value.status.length>1?(t(),l("div",ge,[a[7]||(a[7]=s("label",{class:"filter-label"},"Status:",-1)),m(s("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.status=e),class:"filter-select",onChange:j},[a[6]||(a[6]=s("option",{value:""}," All Statuses ",-1)),(t(!0),l(o,null,n(R.value.status,e=>(t(),l("option",{key:e,value:e},r(e),9,me))),128))],544),[[f,T.value.status]])])):g("",!0),P.value?(t(),l("button",{key:2,class:"clear-filters-btn",title:"Clear all filters",onClick:U}," Clear Filters ")):g("",!0)])])):g("",!0),s("div",fe,[s("div",be,[s("table",he,[s("thead",null,[s("tr",null,[s("th",ke,r(D(M.value.rowField)||"Items")+" / "+r(D(M.value.columnField)||"Aggregated"),1),(t(!0),l(o,null,n(N.value.columns,e=>(t(),l("th",{key:e,class:"column-header"},r(e),1))),128)),M.value.columnField?(t(),l("th",ye," Total ")):g("",!0)])]),s("tbody",null,[(t(!0),l(o,null,n(O.value,e=>(t(),l("tr",{key:`${e.label}-${b(L)}`,class:"data-row"},[s("td",_e,r(e.label),1),(t(!0),l(o,null,n(e.cells,(a,s)=>(t(),l("td",{key:`${s}-${b(L)}`,class:"data-cell",style:h(b(V)(a,e.label,s)),title:B(e.label,N.value.columns[s],a),onClick:l=>function(e,a,l){l&&y("cell-click",{row:e,column:a,cell:l})}(e.label,N.value.columns[s],a)},r(a?b(x)(a,M.value.aggregation):"-"),13,we))),128)),M.value.columnField?(t(),l("td",{key:0,class:"total-cell",style:h(b(G)(e.total))},r(b(x)(e.total,M.value.aggregation)),5)):g("",!0)]))),128)),M.value.rowField&&e.showTotals?(t(),l("tr",{key:`totals-${b(L)}`,class:"total-row"},[a[8]||(a[8]=s("td",{class:"row-header"}," Total ",-1)),(t(!0),l(o,null,n(N.value.totals,(e,a)=>(t(),l("td",{key:`total-${a}-${b(L)}`,class:"total-cell",style:h(b(G)(e))},r(b(x)(e,M.value.aggregation)),5))),128)),M.value.columnField?(t(),l("td",{key:0,class:"grand-total-cell",style:h(b(G)(N.value.grandTotal))},r(b(x)(N.value.grandTotal,M.value.aggregation)),5)):g("",!0)])):g("",!0)])])])])],2))}}),[["__scopeId","data-v-abd0d23c"]]),Fe={class:"modal-content large"},Me={class:"modal-header"},Se={class:"modal-body"},xe={class:"detail-section"},$e={class:"detail-grid"},Te={class:"detail-item"},Ie={class:"value"},Re={class:"detail-item"},Ae={class:"value"},Ee={class:"detail-item"},Pe={class:"value"},je={class:"detail-item"},Ue={class:"value"},Ne={key:0,class:"detail-section api-section"},Oe={class:"api-info"},Ve={class:"api-summary"},Ge={class:"api-item"},Le={class:"value cost"},De={class:"api-item"},Be={class:"value"},qe={class:"api-item"},We={class:"value"},ze={class:"api-item"},He={class:"value url"},Je={class:"api-actions"},Ke=["disabled"],Ye={class:"detail-section"},Qe={class:"variables-list"},Xe={class:"variable-key"},Ze={class:"variable-value"},ea={class:"detail-section"},aa={class:"prompt-text"},la={key:1,class:"detail-section"},ta={class:"result-text"},sa={key:2,class:"detail-section error-section"},oa={class:"error-text"},na={key:3,class:"detail-section api-details-section"},ra={class:"api-details"},ua={class:"api-detail-item"},ia={class:"api-code"},ca={class:"api-detail-item"},da={class:"api-code"},pa={class:"modal-footer"},va=_(a({__name:"TaskDetailModal",props:{task:{}},emits:["close"],setup(a){const u=a,d=c(!1),p=e(()=>u.task.api_call_log?w.getRequestSummary(u.task.api_call_log):null),v=e(()=>u.task.api_call_log?w.formatRequest(u.task.api_call_log):""),m=e(()=>u.task.api_call_log?w.formatResponse(u.task.api_call_log):"");async function f(e){const a="prompt"===e?u.task.prompt:u.task.result;if(a)try{await navigator.clipboard.writeText(a),alert(`${e.charAt(0).toUpperCase()+e.slice(1)} copied to clipboard!`)}catch(l){console.error("Failed to copy:",l)}}function b(){if(!u.task.api_call_log)return;const e={model:u.task.model,prompt:u.task.prompt,variables:u.task.variables,original_task_id:u.task.id};alert("Retry exact call feature coming soon! This would recreate the exact API call with identical parameters."),console.log("Retry data:",e)}function h(){const e={task:{model:u.task.model,prompt:u.task.prompt,variables:u.task.variables,result:u.task.result,response_time:u.task.response_time,created_at:u.task.created_at,completed_at:u.task.completed_at},api_call:u.task.api_call_log?{cost_estimate:u.task.api_call_log.cost_estimate,timing_ms:u.task.api_call_log.response.timing_ms,model:u.task.api_call_log.metadata.model,provider:u.task.api_call_log.metadata.provider}:null,export_timestamp:(new Date).toISOString(),reproducible_hash:btoa(JSON.stringify({model:u.task.model,prompt:u.task.prompt,variables:u.task.variables}))},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`task-${u.task.id}-export.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(l)}return(e,a)=>{return t(),l("div",{class:"modal-overlay",onClick:a[5]||(a[5]=k(a=>e.$emit("close"),["self"]))},[s("div",Fe,[s("div",Me,[a[6]||(a[6]=s("h3",null,"Task Details",-1)),s("button",{class:"close-btn",onClick:a[0]||(a[0]=a=>e.$emit("close"))}," × ")]),s("div",Se,[s("div",xe,[a[11]||(a[11]=s("h4",null,"Task Information",-1)),s("div",$e,[s("div",Te,[a[7]||(a[7]=s("span",{class:"label"},"Model:",-1)),s("span",Ie,r(e.task.model),1)]),s("div",Re,[a[8]||(a[8]=s("span",{class:"label"},"Status:",-1)),s("span",Ae,[s("span",{class:i(["status-badge",`status-${e.task.status}`])},r(e.task.status),3)])]),s("div",Ee,[a[9]||(a[9]=s("span",{class:"label"},"Response Time:",-1)),s("span",Pe,r(e.task.response_time||"-")+"ms",1)]),s("div",je,[a[10]||(a[10]=s("span",{class:"label"},"Created:",-1)),s("span",Ue,r((u=e.task.created_at,new Date(u).toLocaleString())),1)])])]),p.value?(t(),l("div",Ne,[a[16]||(a[16]=s("h4",null,"🔍 API Call Details",-1)),s("div",Oe,[s("div",Ve,[s("div",Ge,[a[12]||(a[12]=s("span",{class:"label"},"Cost:",-1)),s("span",Le,r(p.value.cost),1)]),s("div",De,[a[13]||(a[13]=s("span",{class:"label"},"Tokens:",-1)),s("span",Be,r(p.value.tokens),1)]),s("div",qe,[a[14]||(a[14]=s("span",{class:"label"},"Timing:",-1)),s("span",We,r(p.value.timing),1)]),s("div",ze,[a[15]||(a[15]=s("span",{class:"label"},"URL:",-1)),s("span",He,r(p.value.url),1)])]),s("div",Je,[s("button",{class:"btn btn-secondary btn-small",disabled:!e.task.api_call_log,onClick:b}," 🔄 Retry Exact Call ",8,Ke),s("button",{class:"btn btn-secondary btn-small",onClick:h}," 📤 Export for Review ")])])])):g("",!0),s("div",Ye,[a[17]||(a[17]=s("h4",null,"Variables",-1)),s("div",Qe,[(t(!0),l(o,null,n(e.task.variables,(e,a)=>(t(),l("div",{key:a,class:"variable-item"},[s("span",Xe,r(a)+":",1),s("span",Ze,r(e),1)]))),128))])]),s("div",ea,[a[18]||(a[18]=s("h4",null,"Prompt",-1)),s("pre",aa,r(e.task.prompt),1)]),e.task.result?(t(),l("div",la,[a[19]||(a[19]=s("h4",null,"Result",-1)),s("pre",ta,r(e.task.result),1)])):g("",!0),e.task.error?(t(),l("div",sa,[a[20]||(a[20]=s("h4",null,"Error",-1)),s("pre",oa,r(e.task.error),1)])):g("",!0),d.value&&e.task.api_call_log?(t(),l("div",na,[s("div",ra,[s("div",ua,[a[21]||(a[21]=s("h5",null,"API Request",-1)),s("pre",ia,r(v.value),1)]),s("div",ca,[a[22]||(a[22]=s("h5",null,"API Response",-1)),s("pre",da,r(m.value),1)])])])):g("",!0)]),s("div",pa,[s("button",{class:"btn btn-secondary",onClick:a[1]||(a[1]=e=>f("prompt"))}," Copy Prompt "),e.task.result?(t(),l("button",{key:0,class:"btn btn-secondary",onClick:a[2]||(a[2]=e=>f("result"))}," Copy Result ")):g("",!0),e.task.api_call_log?(t(),l("button",{key:1,class:"btn btn-secondary",onClick:a[3]||(a[3]=e=>d.value=!d.value)},r(d.value?"Hide":"View")+" API Details ",1)):g("",!0),s("button",{class:"btn btn-primary",onClick:a[4]||(a[4]=a=>e.$emit("close"))}," Close ")])])]);var u}}}),[["__scopeId","data-v-52dce586"]]);export{Ce as P,va as T,C as q};

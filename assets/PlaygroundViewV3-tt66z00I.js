import{e as N,u as q,a as j,p as K}from"./index-mQWFZhQt.js";import{u as se}from"./useV4Models-oYSRS58H.js";import{M as oe,G as ne}from"./GenericModelSelectorModalV3-BKAQ71M7.js";import{v as le,a3 as ae,W as re}from"./ui-vendor-DgwC-sRC.js";import{d as z,V as m,W as e,G as R,a2 as w,k as _,a1 as x,a0 as y,_ as n,u as W,X as c,c as B,F as A,Y as J,f as I,w as Q,a5 as ee,q as G,v as ie,a6 as de,n as te,ab as ue,a7 as X,$ as T,A as pe,r as ce,o as me}from"./vue-vendor-BZxY9vkr.js";import{c as Y,i as Z,g as ve}from"./useHeatmapStylingV3-D-bcEOcj.js";import{u as ge}from"./useV4ProviderParameters-BgwoeZ7t.js";import"./utils-vendor-X1Ah6TN4.js";import"./data-vendor-CllpzWXw.js";import"./useV4LiveQuery-CfOiSnL_.js";import"./useCostEstimation-Dw3DahxG.js";const fe={class:"page-header"},_e={class:"header-actions"},he={key:0,class:"cost-estimate"},be={class:"cost-tooltip"},ye=z({__name:"PlaygroundHeaderV3",props:{selectedModel:{},estimatedTokens:{},outputTokenLimit:{},disabled:{type:Boolean},loading:{type:Boolean}},emits:["execute"],setup(E){return(i,l)=>{const a=x("a-tooltip"),d=x("a-button");return n(),m("div",fe,[l[4]||(l[4]=e("div",{class:"header-content"},[e("h1",null,[R("LLM Playground "),e("span",{class:"description"},"Test one-off prompts and responses")])],-1)),e("div",_e,[i.selectedModel?(n(),m("div",he,[_(a,{placement:"bottom"},{title:y(()=>[e("div",be,[l[1]||(l[1]=e("div",null,"Cost estimate based on:",-1)),e("div",null,"â€¢ Input: "+c(i.estimatedTokens)+" tokens",1),e("div",null,"â€¢ Output: 10 - "+c(i.outputTokenLimit)+" tokens",1),l[2]||(l[2]=e("div",null,"â€¢ Min assumes 10 token response",-1)),l[3]||(l[3]=e("div",null,"â€¢ Max assumes full response limit",-1))])]),default:y(()=>[_(W(le),{class:"info-icon"})]),_:1}),_(oe,{model:i.selectedModel,mode:"range","input-tokens":i.estimatedTokens,"min-output-tokens":10,"max-output-tokens":i.outputTokenLimit,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):w("",!0),_(d,{type:"primary",onClick:l[0]||(l[0]=r=>i.$emit("execute")),disabled:i.disabled,loading:i.loading},{default:y(()=>[R(c(i.loading?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])])}}}),$e=N(ye,[["__scopeId","data-v-26164535"]]),ke={key:0,class:"model-info"},Ce={class:"info-header"},Pe={class:"model-name"},Se={class:"provider-badge"},Ve={key:0,class:"info-details"},Te={class:"detail-item"},we={class:"value"},xe={class:"detail-item"},Ie={class:"value"},Me={class:"dollar-amount"},Re={class:"detail-item"},Ee={class:"value"},Le={class:"dollar-amount"},De={class:"detail-item"},Oe={class:"value"},Ne={class:"detail-item"},ze={class:"value"},Be={class:"detail-item"},Fe={class:"value"},Ae=z({__name:"ModelInfoCardV3",props:{model:{}},setup(E){const i=E,l=q(),a=B(()=>l.settings.core.preferences.value);function d(o){return o<.01?o.toFixed(4):o<1?o.toFixed(3):o.toFixed(2)}function r(o){return o?o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(0)+"k":o.toString():"N/A"}function h(o){var u;return!i.model||!((u=a.value)!=null&&u.enableEnvironmentalCosts),"??"}return(o,u)=>o.model?(n(),m("div",ke,[e("div",Ce,[e("span",Pe,c(o.model.displayName),1),e("span",Se,c(o.model.provider),1)]),o.model.capabilities?(n(),m("div",Ve,[e("div",Te,[u[0]||(u[0]=e("span",{class:"label"},"Context:",-1)),e("span",we,c(r(o.model.capabilities.contextWindow))+" tokens",1)]),e("div",xe,[u[2]||(u[2]=e("span",{class:"label"},"Input:",-1)),e("span",Ie,[e("span",Me,"$"+c(d((o.model.capabilities.inputCostPerToken||0)*1e3)),1),u[1]||(u[1]=R("/1k "))])]),e("div",Re,[u[4]||(u[4]=e("span",{class:"label"},"Output:",-1)),e("span",Ee,[e("span",Le,"$"+c(d((o.model.capabilities.outputCostPerToken||0)*1e3)),1),u[3]||(u[3]=R("/1k "))])]),e("div",De,[u[5]||(u[5]=e("span",{class:"label"},"COâ‚‚: ðŸ­",-1)),e("span",Oe,c(h()),1)]),e("div",Ne,[u[6]||(u[6]=e("span",{class:"label"},"Water: ðŸ’§",-1)),e("span",ze,c(h()),1)]),e("div",Be,[u[7]||(u[7]=e("span",{class:"label"},"Energy: âš¡",-1)),e("span",Fe,c(h()),1)])])):w("",!0)])):w("",!0)}}),Je=N(Ae,[["__scopeId","data-v-ce84a924"]]),Ue={class:"left-panel"},je={class:"panel-section"},qe={class:"panel-section"},He={class:"action-buttons"},We={key:0,class:"panel-section"},Ge={class:"template-buttons"},Xe=z({__name:"PlaygroundLeftPanelV3",props:{selectedModel:{},promptText:{}},emits:["open-model-selector","load-from-design","clear-prompt","load-template"],setup(E){const i=q(),l=B(()=>{const d=i.templates.templates.value||[],r=i.spreadsheet.prompts.prompts.value||[];return d.length>0||r.length>0}),a=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}];return(d,r)=>{const h=x("a-button");return n(),m("div",Ue,[e("div",je,[r[4]||(r[4]=e("h3",null,"Select Model",-1)),_(h,{type:"primary",size:"large",style:{width:"100%"},onClick:r[0]||(r[0]=o=>d.$emit("open-model-selector"))},{default:y(()=>r[3]||(r[3]=[R(" Select Model ")])),_:1,__:[3]}),_(Je,{model:d.selectedModel},null,8,["model"])]),e("div",qe,[r[7]||(r[7]=e("h3",null,"Actions",-1)),e("div",He,[_(h,{type:"default",onClick:r[1]||(r[1]=o=>d.$emit("load-from-design")),disabled:!l.value,block:""},{default:y(()=>r[5]||(r[5]=[R(" Load from Design ")])),_:1,__:[5]},8,["disabled"]),_(h,{type:"default",onClick:r[2]||(r[2]=o=>d.$emit("clear-prompt")),disabled:!d.promptText,block:""},{default:y(()=>r[6]||(r[6]=[R(" Clear Prompt ")])),_:1,__:[6]},8,["disabled"])])]),d.selectedModel?(n(),m("div",We,[r[8]||(r[8]=e("h3",null,"Quick Templates",-1)),e("div",Ge,[(n(),m(A,null,J(a,o=>_(h,{key:o.name,size:"small",onClick:u=>d.$emit("load-template",o.prompt)},{default:y(()=>[R(c(o.name),1)]),_:2},1032,["onClick"])),64))])])):w("",!0)])}}}),Ye=N(Xe,[["__scopeId","data-v-c9dee8ad"]]),Qe={class:"template-editor"},Ke=["placeholder","rows","data-testid","aria-label"],Ze=z({__name:"TemplateEditorV3",props:{modelValue:{},label:{},placeholder:{default:"Enter your prompt template..."},required:{type:Boolean},rows:{default:4},variables:{default:()=>[]},variableColors:{default:()=>({})}},emits:["update:modelValue"],setup(E,{expose:i,emit:l}){const a=E,d=l,r=I(),h=I(),o=I(!1),u=B({get:()=>a.modelValue,set:s=>d("update:modelValue",s)}),k=B(()=>{let s=L(u.value);return s=s.replace(/\{\{(\w+)\}\}/g,(v,p)=>{const f=/^\w+$/.test(p),V=a.variableColors[p];return f&&V?`<span class="variable-highlight" style="background-color: ${V.bg}; box-shadow: 0 0 0 1px ${V.bg};">${L(v)}</span>`:f?`<span class="variable-highlight">${L(v)}</span>`:`<span class="variable-error">${L(v)}</span>`}),s=s.replace(/\n/g,"<br>"),s=s.replace(/  /g," &nbsp;"),s.endsWith("<br>")||(s+="<br>"),s});function L(s){const v=document.createElement("div");return v.textContent=s,v.innerHTML}function t(){!r.value||!h.value||(h.value.scrollTop=r.value.scrollTop,h.value.scrollLeft=r.value.scrollLeft)}return Q(u,async()=>{await te(),t()}),i({focus:()=>{var s;return(s=r.value)==null?void 0:s.focus()}}),(s,v)=>{const p=ie("dompurify-html");return n(),m("div",Qe,[e("div",{class:ee(["editor-container",{focused:o.value}])},[G(e("div",{ref_key:"highlightRef",ref:h,class:"editor-highlight","aria-hidden":"true"},null,512),[[p,k.value,"template"]]),G(e("textarea",{ref_key:"textareaRef",ref:r,"onUpdate:modelValue":v[0]||(v[0]=f=>u.value=f),class:"editor-textarea",placeholder:s.placeholder,rows:s.rows,"data-testid":s.$attrs["data-testid"]||"textarea-template-editor","aria-label":s.$attrs["aria-label"]||"Template editor textarea",onFocus:v[1]||(v[1]=f=>o.value=!0),onBlur:v[2]||(v[2]=f=>o.value=!1),onScroll:t},null,40,Ke),[[de,u.value]])],2)])}}}),et=N(Ze,[["__scopeId","data-v-1880e5bc"]]),tt={class:"prompt-section"},st={class:"section-header"},ot={class:"character-count"},nt=z({__name:"PromptEditorSectionV3",props:{promptText:{}},emits:["update:prompt-text"],setup(E){return(i,l)=>(n(),m("div",tt,[e("div",st,[l[1]||(l[1]=e("h3",null,"Prompt",-1)),e("span",ot,c(i.promptText.length)+" characters",1)]),_(et,{"model-value":i.promptText,"onUpdate:modelValue":l[0]||(l[0]=a=>i.$emit("update:prompt-text",a)),rows:6,placeholder:"Enter your prompt here... No variables or placeholders in the playground, just one prompt at a time.","data-testid":"playground-prompt-editor"},null,8,["model-value"])]))}}),lt=N(nt,[["__scopeId","data-v-dffa2db6"]]),at={key:0,class:"logprobs-container"},rt={class:"logprobs-header"},it=["value"],dt={class:"logprobs-content"},ut=["onMouseenter"],pt={class:"tooltip-header"},ct={class:"tooltip-content"},mt={class:"tooltip-row"},vt={class:"tooltip-value"},gt={class:"tooltip-row"},ft={class:"tooltip-value"},_t={key:0,class:"tooltip-alternatives"},ht={class:"alt-token"},bt={class:"alt-prob"},yt={class:"logprobs-legend"},$t={class:"legend-bar"},kt=z({__name:"LogprobsDisplay",props:{logprobs:{}},setup(E){const i=I("viridis"),l=I(!1),a=I(null),d=I({}),r=I(null);function h(v){const p=Math.exp(v);return Math.sqrt(p)}function o(v){const p=Y[i.value];if(!p)return j.info("No color scale found for:",i.value),{};const f=h(v.logprob),V=Z(f,p.colors),D=ve(V);return{backgroundColor:`${V} !important`,color:`${D} !important`}}function u(v){const p=Y[i.value];return p?Z(v,p.colors):"transparent"}function k(v){return v===`
`?"\\n":v==="	"?"\\t":v===" "?"Â·":v.trim()===""?`[${v.length} spaces]`:v}function L(v,p){a.value=v,l.value=!0,s(p)}function t(){l.value=!1,a.value=null}function s(v){if(!l.value)return;const p=10,f=v.clientX+p,V=r.value,D=V?V.offsetHeight:100,F=v.clientY-D+p;d.value={position:"fixed",left:`${f}px`,top:`${F}px`,zIndex:"1000"}}return(v,p)=>{var f,V,D,F,U;return v.logprobs.hasLogprobs?(n(),m("div",at,[e("div",rt,[p[2]||(p[2]=e("h4",null,"Token Probabilities",-1)),G(e("select",{"onUpdate:modelValue":p[0]||(p[0]=M=>i.value=M),class:"color-scale-selector"},[(n(!0),m(A,null,J(W(Y),(M,b)=>(n(),m("option",{key:b,value:b},c(M.name),9,it))),128))],512),[[ue,i.value]])]),e("div",dt,[(n(!0),m(A,null,J(v.logprobs.content,(M,b)=>(n(),m("span",{key:b,style:X(o(M)),class:"logprob-token",onMouseenter:S=>L(M,S),onMouseleave:t,onMousemove:p[1]||(p[1]=S=>s(S))},c(k(M.token)),45,ut))),128))]),l.value?(n(),m("div",{key:0,ref_key:"tooltipRef",ref:r,class:"logprob-tooltip",style:X(d.value)},[e("div",pt,[e("strong",null,'"'+c((f=a.value)==null?void 0:f.token)+'"',1)]),e("div",ct,[e("div",mt,[p[3]||(p[3]=e("span",{class:"tooltip-label"},"Logprob:",-1)),e("span",vt,c((D=(V=a.value)==null?void 0:V.logprob)==null?void 0:D.toFixed(4)),1)]),e("div",gt,[p[4]||(p[4]=e("span",{class:"tooltip-label"},"Probability:",-1)),e("span",ft,c((Math.exp(((F=a.value)==null?void 0:F.logprob)||0)*100).toFixed(2))+"%",1)]),(U=a.value)!=null&&U.top_logprobs&&a.value.top_logprobs.length>0?(n(),m("div",_t,[p[5]||(p[5]=e("div",{class:"tooltip-section-header"},"Top alternatives:",-1)),(n(!0),m(A,null,J(a.value.top_logprobs,M=>(n(),m("div",{key:M.token,class:"tooltip-alt"},[e("span",ht,'"'+c(k(M.token))+'"',1),e("span",bt,c((Math.exp(M.logprob)*100).toFixed(2))+"%",1)]))),128))])):w("",!0)])],4)):w("",!0),e("div",yt,[e("div",$t,[(n(),m(A,null,J(10,(M,b)=>e("div",{key:b,style:X({backgroundColor:u(b/9)}),class:"legend-segment"},null,4)),64))]),p[6]||(p[6]=e("div",{class:"legend-labels"},[e("span",null,"Low probability"),e("span",null,"High probability")],-1))])])):w("",!0)}}}),Ct=N(kt,[["__scopeId","data-v-36cdf50b"]]),Pt={class:"response-display"},St={key:0,class:"loading-state"},Vt={key:1,class:"error-state"},Tt={class:"error-details"},wt={key:2,class:"response-content"},xt={class:"response-text"},It={class:"text-content"},Mt={class:"expand-icon"},Rt={class:"metadata-content"},Et={class:"metadata-grid"},Lt={class:"metadata-item"},Dt={class:"value"},Ot={key:0,class:"metadata-item"},Nt={class:"value"},zt={key:1,class:"metadata-item"},Bt={class:"value"},Ft={class:"cost-amount"},At={class:"cost-amount"},Jt={class:"cost-amount"},Ut={class:"metadata-item"},jt={class:"value env-costs"},qt={class:"env-item"},Ht={class:"env-item"},Wt={class:"env-item"},Gt={class:"raw-response"},Xt={class:"debug-sections"},Yt={class:"debug-section"},Qt={class:"debug-response"},Kt={class:"debug-section"},Zt={class:"debug-response"},es={class:"debug-section"},ts={class:"debug-response"},ss={key:3,class:"empty-state"},os=z({__name:"ResponseDisplayV3",props:{response:{},isLoading:{type:Boolean},error:{}},setup(E){const i=q(),l=B(()=>i.settings.core.preferences.value),a=I(!1);function d(t){return t<1e-4?t.toFixed(6):t<.01?t.toFixed(4):t.toFixed(3)}function r(t){if(!t)return"No raw response data";try{return JSON.stringify(t,null,2)}catch{return String(t)}}function h(t){if(!t)return"No error details available";try{if(t.debugInfo){const s=t.debugInfo;return`API Request Details:
URL: ${s.url}
Status: ${s.status}

Request Body:
${JSON.stringify(s.requestBody,null,2)}

Response Body:
${JSON.stringify(s.responseBody,null,2)}

Error Details:
${JSON.stringify(s.errorDetails,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`}return t.stack?`Stack Trace:
${t.stack}

Full Error Object:
${JSON.stringify(t,null,2)}`:t.details?`Error Details:
${JSON.stringify(t.details,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`:JSON.stringify(t,null,2)}catch{return String(t)}}function o(t){var s;return(s=l.value)!=null&&s.enableEnvironmentalCosts,"??"}function u(t){if(!t)return"No request data available";try{return JSON.stringify({url:t.url,method:t.method,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function k(t){if(!t)return"No response data available";try{return JSON.stringify({status:t.status,statusText:t.statusText,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function L(t){if(!t)return"No parsing data available";try{return JSON.stringify({providerId:t.providerId,modelId:t.modelId,parameters:t.parameters,parsedResponse:t.parsedResponse,contentExtracted:t.contentExtracted,contentLength:t.contentLength},null,2)}catch{return String(t)}}return(t,s)=>{const v=x("a-spin"),p=x("a-alert"),f=x("a-collapse-panel"),V=x("a-collapse");return n(),m("div",Pt,[t.isLoading?(n(),m("div",St,[_(v,{size:"large"},{tip:y(()=>s[1]||(s[1]=[R("Generating response...")])),_:1})])):t.error?(n(),m("div",Vt,[_(p,{type:"error",message:t.error.message||"API Error",description:t.error.details,"show-icon":""},null,8,["message","description"]),t.error?(n(),T(V,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:y(()=>[_(f,{key:"details",header:"Full API Request/Response"},{default:y(()=>[e("pre",Tt,c(h(t.error.response||t.error)),1)]),_:1})]),_:1})):w("",!0)])):t.response?(n(),m("div",wt,[e("div",xt,[e("pre",It,c(t.response.content),1)]),t.response.logprobs?(n(),T(Ct,{key:0,logprobs:t.response.logprobs},null,8,["logprobs"])):w("",!0),e("div",{class:ee(["response-metadata",{expanded:a.value}])},[e("h3",{class:"metadata-header",onClick:s[0]||(s[0]=D=>a.value=!a.value)},[e("span",Mt,[a.value?(n(),T(W(re),{key:1})):(n(),T(W(ae),{key:0}))]),s[2]||(s[2]=R(" Response Details "))]),G(e("div",Rt,[e("div",Et,[e("div",Lt,[s[3]||(s[3]=e("span",{class:"label"},"Latency:",-1)),e("span",Dt,c(t.response.latency)+"ms",1)]),t.response.tokens?(n(),m("div",Ot,[s[4]||(s[4]=e("span",{class:"label"},"Token Usage:",-1)),e("span",Nt,c(t.response.tokens.prompt_tokens||"?")+" input + "+c(t.response.tokens.completion_tokens||"?")+" output = "+c(t.response.tokens.total_tokens||"?")+" total tokens ",1)])):w("",!0),t.response.cost?(n(),m("div",zt,[s[8]||(s[8]=e("span",{class:"label"},"Cost Estimate:",-1)),e("span",Bt,[e("span",Ft,"$"+c(d(t.response.cost.input)),1),s[5]||(s[5]=R(" input + ")),e("span",At,"$"+c(d(t.response.cost.output)),1),s[6]||(s[6]=R(" output = ")),e("span",Jt,"$"+c(d(t.response.cost.total)),1),s[7]||(s[7]=R(" total "))])])):w("",!0),e("div",Ut,[s[9]||(s[9]=e("span",{class:"label"},"Environmental:",-1)),e("span",jt,[e("span",qt,"COâ‚‚ ðŸ­: "+c(o())+"Â Â ",1),e("span",Ht,"Water ðŸ’§: "+c(o())+"Â Â ",1),e("span",Wt,"Energy âš¡: "+c(o()),1)])])]),_(V,{ghost:"",style:{"margin-top":"16px"}},{default:y(()=>[_(f,{key:"raw",header:"Raw API Response"},{default:y(()=>[e("pre",Gt,c(r(t.response.raw)),1)]),_:1})]),_:1}),t.response.debug?(n(),T(V,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:y(()=>[_(f,{key:"debug",header:"ðŸ” Complete API Request/Response Debug"},{default:y(()=>[e("div",Xt,[e("div",Yt,[s[10]||(s[10]=e("h4",null,"ðŸ“¤ API Request",-1)),e("pre",Qt,c(u(t.response.debug.request)),1)]),e("div",Kt,[s[11]||(s[11]=e("h4",null,"ðŸ“¥ API Response",-1)),e("pre",Zt,c(k(t.response.debug.response)),1)]),e("div",es,[s[12]||(s[12]=e("h4",null,"âš™ï¸ Response Parser Details",-1)),e("pre",ts,c(L(t.response.debug.parsing)),1)])])]),_:1})]),_:1})):w("",!0)],512),[[pe,a.value]])],2)])):(n(),m("div",ss,s[13]||(s[13]=[e("div",{class:"empty-content"},[e("div",{class:"empty-icon"},"ðŸ’¬"),e("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),ns=N(os,[["__scopeId","data-v-70d773b1"]]),ls={key:0,class:"response-section"},as={class:"section-header"},rs={key:0,class:"response-meta"},is={class:"response-container"},ds=z({__name:"ResponseSectionV3",props:{hasExecuted:{type:Boolean},response:{},error:{},isLoading:{type:Boolean}},setup(E){return(i,l)=>{var a;return i.hasExecuted?(n(),m("div",ls,[e("div",as,[l[0]||(l[0]=e("h3",null,"Response",-1)),i.response&&!i.error?(n(),m("div",rs,[e("span",null,c(i.response.latency)+"ms",1),e("span",null,c(((a=i.response.tokens)==null?void 0:a.total_tokens)||"?")+" tokens",1)])):w("",!0)]),e("div",is,[_(ns,{response:i.response,"is-loading":i.isLoading,error:i.error},null,8,["response","is-loading","error"])])])):w("",!0)}}}),us=N(ds,[["__scopeId","data-v-cf6c2814"]]),ps={class:"center-panel"},cs=z({__name:"PlaygroundCenterPanelV3",props:{promptText:{},hasExecuted:{type:Boolean},response:{},error:{},isExecuting:{type:Boolean}},emits:["update:prompt-text"],setup(E){return(i,l)=>(n(),m("div",ps,[_(lt,{"prompt-text":i.promptText,"onUpdate:promptText":l[0]||(l[0]=a=>i.$emit("update:prompt-text",a))},null,8,["prompt-text"]),_(us,{"has-executed":i.hasExecuted,response:i.response,error:i.error,"is-loading":i.isExecuting},null,8,["has-executed","response","error","is-loading"])]))}}),ms=N(cs,[["__scopeId","data-v-e48f18da"]]),vs={class:"parameter-panel"},gs={key:0,class:"params-section"},fs={key:0,class:"reasoning-warning"},_s={key:5,class:"param-description"},hs={key:4,class:"param-description"},bs={class:"panel-actions"},ys=z({__name:"ModelParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(E,{emit:i}){const l=E,a=i,{getBasicParameters:d,getAdvancedParameters:r,getUIDefaults:h}=ge(),o=ce({}),u=B(()=>l.model?d(l.model.provider,l.model.modelId):{}),k=B(()=>l.model?r(l.model.provider,l.model.modelId):{}),L=B(()=>l.model?(l.model.provider==="openai-chat"||l.model.provider==="openai-responses")&&(l.model.modelId.match(/^o[0-9]/)||l.model.modelId.match(/^gpt-5/)):!1);function t(p,f){o[p]=f,a("update:modelValue",{...o}),a("change",{...o})}function s(p){return p.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())}function v(){if(!l.model)return;Object.keys(o).forEach(f=>delete o[f]);const p=h(l.model.provider,l.model.modelId);Object.assign(o,p),a("update:modelValue",{...o}),a("change",{...o})}return Q(()=>l.model,p=>{p&&v()},{immediate:!0}),Q(()=>l.modelValue,p=>{Object.assign(o,p)},{immediate:!0,deep:!0}),(p,f)=>{const V=x("a-alert"),D=x("a-input-number"),F=x("a-switch"),U=x("a-select-option"),M=x("a-select"),b=x("a-input"),S=x("a-form-item"),O=x("a-collapse-panel"),H=x("a-collapse"),C=x("a-button");return n(),m("div",vs,[Object.keys(u.value).length>0?(n(),m("div",gs,[f[1]||(f[1]=e("h4",null,"Basic Parameters",-1)),L.value?(n(),m("div",fs,[_(V,{message:"Reasoning models (O* and GPT-5*) do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):w("",!0),(n(!0),m(A,null,J(u.value,(g,P)=>(n(),T(S,{key:P,label:s(P)},{default:y(()=>[g.type==="number"?(n(),T(D,{key:0,value:o[P],onChange:$=>t(P,$),min:g.min,max:g.max,step:g.step||.1,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):g.type==="integer"?(n(),T(D,{key:1,value:o[P],onChange:$=>t(P,$),min:g.min,max:g.max,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder"])):g.type==="boolean"?(n(),T(F,{key:2,checked:o[P],onChange:$=>t(P,$),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):g.type==="string"&&g.enum?(n(),T(M,{key:3,value:o[P],onChange:$=>t(P,$),placeholder:g.default?String(g.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:y(()=>[_(U,{value:void 0},{default:y(()=>f[0]||(f[0]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[0]}),(n(!0),m(A,null,J(g.enum,$=>(n(),T(U,{key:$,value:$},{default:y(()=>[R(c($),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(n(),T(b,{key:4,value:o[P],onChange:$=>t(P,$.target.value),placeholder:String(g.default),size:"large"},null,8,["value","onChange","placeholder"])),g.description?(n(),m("div",_s,c(g.description),1)):w("",!0)]),_:2},1032,["label"]))),128))])):w("",!0),Object.keys(k.value).length>0?(n(),T(H,{key:1,ghost:""},{default:y(()=>[_(O,{key:"advanced",header:"Advanced Parameters"},{default:y(()=>[(n(!0),m(A,null,J(k.value,(g,P)=>(n(),T(S,{key:P,label:s(P)},{default:y(()=>[g.type==="number"||g.type==="integer"?(n(),T(D,{key:0,value:o[P],onChange:$=>t(P,$),min:g.min,max:g.max,step:g.type==="number"?g.step||.1:1,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):g.type==="boolean"?(n(),T(F,{key:1,checked:o[P],onChange:$=>t(P,$),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):g.type==="string"&&g.enum?(n(),T(M,{key:2,value:o[P],onChange:$=>t(P,$),placeholder:g.default?String(g.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:y(()=>[_(U,{value:void 0},{default:y(()=>f[2]||(f[2]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[2]}),(n(!0),m(A,null,J(g.enum,$=>(n(),T(U,{key:$,value:$},{default:y(()=>[R(c($),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(n(),T(b,{key:3,value:o[P],onChange:$=>t(P,$.target.value),placeholder:String(g.default),size:"large"},null,8,["value","onChange","placeholder"])),g.description?(n(),m("div",hs,c(g.description),1)):w("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):w("",!0),e("div",bs,[_(C,{onClick:v,size:"small"},{default:y(()=>f[3]||(f[3]=[R(" Reset to Defaults ")])),_:1,__:[3]})])])}}}),$s=N(ys,[["__scopeId","data-v-723ec687"]]),ks={class:"right-panel"},Cs={class:"panel-header"},Ps={key:0},Ss={key:1},Vs={key:0,class:"panel-content"},Ts={key:1,class:"no-model-message"},ws=z({__name:"PlaygroundRightPanelV3",props:{model:{},parameters:{}},emits:["update:parameters","parameters-change"],setup(E,{emit:i}){const l=i;function a(d){l("update:parameters",d),l("parameters-change",d)}return(d,r)=>(n(),m("div",ks,[e("div",Cs,[d.model?(n(),m("h3",Ps,c(d.model.displayName),1)):(n(),m("h3",Ss,"Select a Model"))]),d.model?(n(),m("div",Vs,[_($s,{model:d.model,modelValue:d.parameters,"onUpdate:modelValue":a,onChange:a},null,8,["model","modelValue"])])):(n(),m("div",Ts,r[0]||(r[0]=[e("p",null,"Choose a model from the left panel to configure parameters.",-1)])))]))}}),xs=N(ws,[["__scopeId","data-v-a054623d"]]),Is={class:"design-list"},Ms=["onClick"],Rs={class:"design-name"},Es={class:"design-description"},Ls={class:"design-preview"},Ds={class:"design-type"},Os=z({__name:"DesignSelectorModalV3",props:{open:{type:Boolean}},emits:["close","select"],setup(E,{emit:i}){const l=i,a=q(),d=B(()=>{const h=a.templates.templates.value||[],o=a.spreadsheet.prompts.prompts.value||[];return[...h.map(u=>({id:u.id,name:u.name,description:u.description,text:u.template,type:"template"})),...o.map(u=>({id:u.id,name:u.name,description:u.description,text:u.promptPattern,type:"spreadsheet"}))]});function r(h){l("select",h),l("close")}return(h,o)=>{const u=x("a-modal");return n(),T(u,{open:h.open,title:"Load from Design",width:"800px",footer:null,onCancel:o[0]||(o[0]=k=>h.$emit("close"))},{default:y(()=>[e("div",Is,[(n(!0),m(A,null,J(d.value,k=>(n(),m("div",{key:k.id,class:"design-item",onClick:L=>r(k)},[e("div",Rs,c(k.name),1),e("div",Es,c(k.description||"No description"),1),e("div",Ls,c(k.text.substring(0,100))+"...",1),e("div",Ds,c(k.type),1)],8,Ms))),128))])]),_:1},8,["open"])}}}),Ns=N(Os,[["__scopeId","data-v-5324ccd4"]]),zs={class:"playground-view","data-testid":"page-playground"},Bs={class:"playground-content"},Fs=z({__name:"PlaygroundViewV3",setup(E){const{enabledModels:i}=se(),l=q(),a=I(null),d=I(""),r=I({}),h=I(!1),o=I(!1),u=I(!1),k=I(!1),L=I(null),t=I(null),s=B(()=>a.value&&d.value.trim().length>0&&!k.value),v=B(()=>d.value?Math.ceil(d.value.length/4):0),p=B(()=>a.value?r.value.max_tokens||r.value.maxTokens||1e3:256);function f(b){r.value={...b},j.info("Parameters changed:",r.value)}function V(b){d.value=b.text}function D(b){d.value=b}function F(){d.value=""}function U(b){a.value=b,o.value=!1,r.value={},K.supportsLogprobs(b.provider,b.modelId)&&(j.info(`Auto-enabling logprobs for ${b.provider}/${b.modelId}`),te(()=>{r.value.logprobs=!0,r.value.top_logprobs=5,j.info("Logprobs parameters set after nextTick:",r.value)}))}async function M(){var b,S,O,H;if(!(!s.value||!a.value)){u.value=!0,k.value=!0,L.value=null,t.value=null;try{const C=await l.executeSingleCall(d.value,0,{provider:a.value.provider,modelId:a.value.modelId,...r.value});C.ok?(L.value={content:C.value.content||"",latency:C.value.latency||0,tokens:C.value.usage,cost:C.value.cost,logprobs:C.value.logprobs,features:C.value.features,raw:C.value.raw,debug:C.value.debug,model:a.value},j.info("Playground response set with logprobs:",C.value.logprobs)):t.value={message:((b=C.error)==null?void 0:b.message)||"Failed to execute prompt",details:((S=C.error)==null?void 0:S.details)||((O=C.error)==null?void 0:O.stack)||C.error,response:C.error,debugInfo:(H=C.error)==null?void 0:H.debugInfo}}catch(C){t.value={message:C.message||"An unexpected error occurred",details:C.stack||C.toString(),response:C}}finally{k.value=!1}}}return me(async()=>{setTimeout(()=>{!a.value&&i.value&&i.value.length>0&&(a.value=i.value[0],K.supportsLogprobs(a.value.provider,a.value.modelId)&&(j.info(`Auto-enabling logprobs for initial model ${a.value.provider}/${a.value.modelId}`),setTimeout(()=>{r.value.logprobs=!0,r.value.top_logprobs=5,j.info("Initial logprobs parameters set:",r.value)},200)))},100)}),(b,S)=>(n(),m("div",zs,[_($e,{"selected-model":a.value,"estimated-tokens":v.value,"output-token-limit":p.value,disabled:!s.value,loading:k.value,onExecute:M},null,8,["selected-model","estimated-tokens","output-token-limit","disabled","loading"]),e("div",Bs,[_(Ye,{"selected-model":a.value,"prompt-text":d.value,onOpenModelSelector:S[0]||(S[0]=O=>o.value=!0),onLoadFromDesign:S[1]||(S[1]=O=>h.value=!0),onClearPrompt:F,onLoadTemplate:D},null,8,["selected-model","prompt-text"]),_(ms,{"prompt-text":d.value,"has-executed":u.value,response:L.value,error:t.value,"is-executing":k.value,"onUpdate:promptText":S[2]||(S[2]=O=>d.value=O)},null,8,["prompt-text","has-executed","response","error","is-executing"]),_(xs,{model:a.value,parameters:r.value,"onUpdate:parameters":S[3]||(S[3]=O=>r.value=O),onParametersChange:f},null,8,["model","parameters"])]),_(Ns,{open:h.value,onClose:S[4]||(S[4]=O=>h.value=!1),onSelect:V},null,8,["open"]),_(ne,{visible:o.value,mode:"playground",title:"Select Model","onUpdate:visible":S[5]||(S[5]=O=>o.value=O),onSelectModel:U},null,8,["visible"])]))}}),Ks=N(Fs,[["__scopeId","data-v-e7ff4c3e"]]);export{Ks as default};

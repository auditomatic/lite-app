import{h as ee,u as ke,a as he}from"./index-Cl7pIQF6.js";import{d as te,R as m,Y as u,k as t,Z as a,S as n,V as p,_ as f,F as Q,G as d,W as we,$ as J,u as k,f as T,c as I,w as xe,o as Ce,X as $e}from"./vue-vendor-Dnvc27xK.js";import{a as Le}from"./useV4VariableLists-CxHEDf57.js";import{u as le,a as Ve}from"./useV4VariableListCommands-DddDa1LD.js";import{W as ne,T as De,m as ae,Z as oe,$ as ie,a0 as re,a1 as ue,a2 as Se,a3 as Ie,F as de,a4 as Te,J as Ee,M as ce,af as Fe,ag as Ue,N as pe,w as Oe,ah as Ne,ai as Re,R as _e,ab as Me,ac as Be,t as ze,I as Ke,u as je,v as Ae,s as Pe,G as qe,k as v,V as Je,aj as Ge,ak as We,al as Xe}from"./ui-vendor-x6pj6AZw.js";import"./utils-vendor-DgugrPw1.js";import"./data-vendor-Bm9xWgJa.js";import"./useV4LiveQuery-BxmuCaLK.js";const Ze={class:"variable-lists-table"},He={class:"name-cell"},Ye={class:"list-name"},Qe={key:0,class:"list-description"},et={class:"items-cell"},tt={class:"item-count"},at={class:"item-type"},st={key:0,class:"attribute-keys"},lt={key:0,class:"more-attributes"},nt={key:2,class:"created-cell"},ot={class:"created-date"},it={class:"created-time"},rt={key:3,class:"actions-cell"},ut={class:"empty-state"},dt={class:"empty-title"},ct={class:"empty-description"},pt=te({__name:"VariableListsTableV3",props:{lists:{},loading:{type:Boolean,default:!1},category:{}},emits:["edit","delete","duplicate","export"],setup(G,{emit:F}){const U=G,$=F,B=[{title:"Name",key:"name",dataIndex:"name",width:300,ellipsis:!0},{title:"Items",key:"items",width:200,align:"center"},{title:"Created",key:"created",width:150,align:"center"},{title:"Actions",key:"actions",width:120,align:"center"}];function z(l){switch(l){case"simple":return"blue";case"attributed":return"green";case"refusal":return"orange";case"tabular":return"purple";default:return"default"}}function K(l){switch(l){case"simple":return"Simple";case"attributed":return"Intersectional";case"refusal":return"Refusal";case"tabular":return"Tabular";default:return l}}function _(l){switch(l.category){case"simple":return"values";case"attributed":return"items";case"refusal":return"patterns";case"tabular":return"rows";default:return"items"}}function E(l){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(l))}function g(l){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).format(new Date(l))}function L(){switch(U.category){case"all":return"No variable lists yet";case"simple":return"No simple lists yet";case"attributed":return"No attributed lists yet";case"refusal":return"No refusal lists yet";default:return"No lists found"}}function j(){switch(U.category){case"all":return"Create your first variable list or import standard lists to get started";case"simple":return"Simple lists contain plain text values for template variables";case"attributed":return"Attributed lists contain values with additional metadata attributes";case"refusal":return"Refusal lists contain patterns to detect when models refuse requests";default:return"Create a new list to get started"}}function i(l,o){switch(l.key){case"duplicate":$("duplicate",o);break;case"export-csv":$("export",o,"csv");break;case"export-json":$("export",o,"json");break;case"delete":$("delete",o);break}}return(l,o)=>{const w=De,V=ae,y=ue,O=Te,A=re,P=oe,S=ne;return u(),m("div",Ze,[t(S,{dataSource:l.lists,columns:B,loading:l.loading,pagination:!1,scroll:{x:800,y:"calc(100vh - 320px)"},"row-key":"id"},{bodyCell:a(({column:h,record:r})=>[h.key==="name"?(u(),m(Q,{key:0},[n("div",He,[n("span",Ye,p(r.name),1),t(w,{color:z(r.category),class:"category-tag"},{default:a(()=>[d(p(K(r.category)),1)]),_:2},1032,["color"])]),r.description?(u(),m("div",Qe,p(r.description),1)):f("",!0)],64)):h.key==="items"?(u(),m(Q,{key:1},[n("div",et,[n("span",tt,p(r.itemCount),1),n("span",at,p(_(r)),1)]),r.category==="attributed"&&r.attributeKeys?(u(),m("div",st,[(u(!0),m(Q,null,we(r.attributeKeys.slice(0,3),b=>(u(),J(w,{key:b,size:"small",class:"attribute-key-tag"},{default:a(()=>[d(p(b),1)]),_:2},1024))),128)),r.attributeKeys.length>3?(u(),m("span",lt," +"+p(r.attributeKeys.length-3)+" more ",1)):f("",!0)])):f("",!0)],64)):h.key==="created"?(u(),m("div",nt,[n("div",ot,p(E(r.created)),1),n("div",it,p(g(r.created)),1)])):h.key==="actions"?(u(),m("div",rt,[t(V,{type:"text",size:"small",onClick:b=>l.$emit("edit",r),"data-testid":"btn-edit-list"},{default:a(()=>o[0]||(o[0]=[d(" Edit ")])),_:2,__:[0]},1032,["onClick"]),t(P,{trigger:["click"]},{overlay:a(()=>[t(A,{onClick:b=>i(b,r)},{default:a(()=>[t(y,{key:"duplicate"},{default:a(()=>[t(k(Se)),o[2]||(o[2]=d(" Duplicate "))]),_:1,__:[2]}),t(y,{key:"export-csv"},{default:a(()=>[t(k(Ie)),o[3]||(o[3]=d(" Export CSV "))]),_:1,__:[3]}),t(y,{key:"export-json"},{default:a(()=>[t(k(de)),o[4]||(o[4]=d(" Export JSON "))]),_:1,__:[4]}),t(O),t(y,{key:"delete",danger:""},{default:a(()=>[t(k(Ee)),o[5]||(o[5]=d(" Delete "))]),_:1,__:[5]})]),_:2},1032,["onClick"])]),default:a(()=>[t(V,{type:"text",size:"small"},{default:a(()=>[o[1]||(o[1]=d(" More ")),t(k(ie))]),_:1,__:[1]})]),_:2},1024)])):f("",!0)]),emptyText:a(()=>[n("div",ut,[o[6]||(o[6]=n("div",{class:"empty-icon"},"ðŸ“‹",-1)),n("div",dt,p(L()),1),n("div",ct,p(j()),1)])]),_:1},8,["dataSource","loading"])])}}}),X=ee(pt,[["__scopeId","data-v-79a16258"]]),_t={class:"import-modal"},mt={key:0,class:"step-content"},vt={class:"import-methods"},ft={class:"paste-section"},yt={key:0,class:"data-info"},gt={class:"upload-section"},bt={class:"ant-upload-drag-icon"},kt={key:0,class:"file-info"},ht={key:1,class:"step-content"},wt={class:"config-section"},xt={key:0,class:"format-info"},Ct={key:2,class:"step-content"},$t={class:"preview-section"},Lt={class:"preview-header"},Vt={class:"preview-stats"},Dt={key:0},St={class:"preview-table"},It={class:"modal-actions"},Tt=te({__name:"ImportModalV3",props:{open:{type:Boolean}},emits:["update:open","imported"],setup(G,{emit:F}){const U=G,$=F,{importFromCSV:B,isExecuting:z}=le(),{validateCSV:K}=Ve(),_=T(0),E=T("paste"),g=T(""),L=T(null),j=I(()=>z.value),i=T({name:"",description:"",category:"simple"}),l=I(()=>{const s=g.value.trim();if(!s)return null;const e=K(s,i.value.category);return e.valid?e.preview:null}),o=I(()=>{if(!l.value||l.value.rows.length===0)return null;const{headers:s,rows:e}=l.value;return s.length>1?{type:"success",message:`Detected attributed list format with ${s.length} columns: ${s.join(", ")}`}:s.length===1?{type:"info",message:`Detected simple list format with ${e.length} values`}:{type:"warning",message:"Unable to detect format - please check your data"}}),w=I(()=>l.value?i.value.category==="attributed"?l.value.rows.map((s,e)=>({key:e,...s})):l.value.rows.map((s,e)=>({key:e,value:s[l.value.headers[0]]||""})):[]),V=I(()=>l.value?i.value.category==="attributed"?l.value.headers.map(s=>({title:s,dataIndex:s,key:s,ellipsis:!0})):[{title:"Value",dataIndex:"value",key:"value",ellipsis:!0}]:[]),y=I(()=>{switch(_.value){case 0:return g.value.trim().length>0&&l.value?.rows.length>0;case 1:return i.value.name.trim().length>0&&i.value.category;case 2:return w.value.length>0;default:return!1}});function O(){l.value&&l.value.headers.length>1&&(i.value.category="attributed")}function A(s){L.value=s;const e=new FileReader;return e.onload=c=>{g.value=c.target?.result,E.value="upload",O()},e.readAsText(s),!1}function P(){}function S(s){if(s===0)return"0 Bytes";const e=1024,c=["Bytes","KB","MB"],x=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,x)).toFixed(2))+" "+c[x]}function h(){y.value&&_.value<2&&_.value++}function r(){_.value>0&&_.value--}async function b(){if(!y.value)return;const s=await B(g.value,i.value.name,i.value.category,i.value.description);if(!s.ok){v.error(`Import failed: ${s.error.message}`);return}v.success("Variable list imported successfully"),$("imported"),q()}function q(){$("update:open",!1)}return xe(()=>U.open,s=>{s&&(_.value=0,g.value="",L.value=null,i.value={name:"",description:"",category:"simple"})}),(s,e)=>{const c=Fe,x=Ue,N=Oe,C=pe,R=Ne,Z=_e,M=Ke,H=ze,se=Be,Y=Ae,me=je,ve=Me,fe=Pe,ye=qe,ge=ne,W=ae,be=ce;return u(),J(be,{open:s.open,title:"Import Variable List",width:"800px",footer:null,onCancel:q,"destroy-on-close":!0},{default:a(()=>[n("div",_t,[t(x,{current:_.value,class:"import-steps"},{default:a(()=>[t(c,{title:"Import Data"}),t(c,{title:"Configure"}),t(c,{title:"Preview"})]),_:1},8,["current"]),_.value===0?(u(),m("div",mt,[n("div",vt,[t(Z,{activeKey:E.value,"onUpdate:activeKey":e[1]||(e[1]=D=>E.value=D)},{default:a(()=>[t(C,{key:"paste",tab:"Paste Data"},{default:a(()=>[n("div",ft,[t(N,{value:g.value,"onUpdate:value":e[0]||(e[0]=D=>g.value=D),placeholder:`Paste your CSV data here...

Example for simple list:
red
blue
green

Example for attributed list:
name,gender,ethnicity
John Smith,Male,European
Maria Garcia,Female,Hispanic`,rows:12,size:"large",onChange:O},null,8,["value"]),g.value.trim()?(u(),m("div",yt,p(l.value?.rows.length||0)+" rows detected ",1)):f("",!0)])]),_:1}),t(C,{key:"upload",tab:"Upload File"},{default:a(()=>[n("div",gt,[t(R,{"before-upload":A,"show-upload-list":!1,accept:".csv,.txt"},{default:a(()=>[n("p",bt,[t(k(Re))]),e[5]||(e[5]=n("p",{class:"ant-upload-text"},"Click or drag file to upload",-1)),e[6]||(e[6]=n("p",{class:"ant-upload-hint"},"Supports CSV and TXT files",-1))]),_:1,__:[5,6]}),L.value?(u(),m("div",kt,[t(k(de)),d(" "+p(L.value.name)+" ("+p(S(L.value.size))+") ",1)])):f("",!0)])]),_:1})]),_:1},8,["activeKey"])])])):f("",!0),_.value===1?(u(),m("div",ht,[n("div",wt,[t(fe,{model:i.value,layout:"vertical"},{default:a(()=>[t(ve,{gutter:16},{default:a(()=>[t(se,{span:12},{default:a(()=>[t(H,{label:"List Name",required:""},{default:a(()=>[t(M,{value:i.value.name,"onUpdate:value":e[2]||(e[2]=D=>i.value.name=D),placeholder:"Enter list name",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(se,{span:12},{default:a(()=>[t(H,{label:"List Type",required:""},{default:a(()=>[t(me,{value:i.value.category,"onUpdate:value":e[3]||(e[3]=D=>i.value.category=D),size:"large",onChange:P},{default:a(()=>[t(Y,{value:"simple"},{default:a(()=>e[7]||(e[7]=[d("Simple List")])),_:1,__:[7]}),t(Y,{value:"attributed"},{default:a(()=>e[8]||(e[8]=[d("Attributed List")])),_:1,__:[8]}),t(Y,{value:"refusal"},{default:a(()=>e[9]||(e[9]=[d("Refusal List")])),_:1,__:[9]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(H,{label:"Description (Optional)"},{default:a(()=>[t(M,{value:i.value.description,"onUpdate:value":e[4]||(e[4]=D=>i.value.description=D),placeholder:"Optional description",size:"large"},null,8,["value"])]),_:1})]),_:1},8,["model"]),o.value?(u(),m("div",xt,[t(ye,{type:o.value.type,"show-icon":""},{message:a(()=>[d(p(o.value.message),1)]),_:1},8,["type"])])):f("",!0)])])):f("",!0),_.value===2?(u(),m("div",Ct,[n("div",$t,[n("div",Lt,[n("h4",null,"Preview ("+p(w.value.length)+" items)",1),n("div",Vt,[n("span",null,p(i.value.category)+" list",1),i.value.category==="attributed"&&l.value?.headers?(u(),m("span",Dt,p(l.value.headers.length)+" columns ",1)):f("",!0)])]),n("div",St,[t(ge,{dataSource:w.value,columns:V.value,pagination:{pageSize:10},size:"small",scroll:{x:600}},null,8,["dataSource","columns"])])])])):f("",!0),n("div",It,[t(W,{onClick:q},{default:a(()=>e[10]||(e[10]=[d(" Cancel ")])),_:1,__:[10]}),_.value>0?(u(),J(W,{key:0,onClick:r},{default:a(()=>e[11]||(e[11]=[d(" Previous ")])),_:1,__:[11]})):f("",!0),_.value<2?(u(),J(W,{key:1,type:"primary",onClick:h,disabled:!y.value},{default:a(()=>e[12]||(e[12]=[d(" Next ")])),_:1,__:[12]},8,["disabled"])):f("",!0),_.value===2?(u(),J(W,{key:2,type:"primary",onClick:b,loading:j.value},{default:a(()=>e[13]||(e[13]=[d(" Import List ")])),_:1,__:[13]},8,["loading"])):f("",!0)])])]),_:1},8,["open"])}}}),Et=ee(Tt,[["__scopeId","data-v-7a589775"]]),Ft={class:"variable-lists-view"},Ut={class:"view-header"},Ot={class:"header-actions"},Nt=te({__name:"VariableListsViewV3",setup(G){const F=$e(),{variableLists:U,simpleLists:$,attributedLists:B,refusalLists:z,loading:K}=Le(),{deleteVariableList:_,duplicateVariableList:E,exportToCSV:g,exportToJSON:L,isExecuting:j}=le(),i=ke(),l=T("all"),o=T(!1),w=T(!1),V=I(()=>K.value||j.value),y=I(()=>{switch(l.value){case"all":return U.value;case"simple":return $.value;case"attributed":return B.value;case"refusal":return z.value;default:return[]}});function O(s){l.value=s}async function A(){try{o.value=!0;const s=await i.defaultData.checkDefaultsNeeded();if(!s.ok){v.error("Failed to check default data status");return}if(!s.value){v.info("Standard lists are already imported");return}const e=await i.defaultData.importDefaults();if(!e.ok){const c=e;v.error(`Failed to import defaults: ${c.error.message}`);return}v.success(`Imported ${e.value.lists} variable lists and ${e.value.templates} templates`)}catch(s){he.error("Error importing defaults:",s),v.error("An unexpected error occurred while importing defaults")}finally{o.value=!1}}function P({key:s}){F.push(`/variables/new?category=${s}`)}function S(s){F.push(`/variables/${s.id}/edit`)}async function h(s){ce.confirm({title:"Delete Variable List",content:`Are you sure you want to delete "${s.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{const e=await _(s.id);if(!e.ok){v.error(`Failed to delete list: ${e.error.message}`);return}v.success("Variable list deleted successfully")}})}async function r(s){const e=await E(s.id);if(!e.ok){v.error(`Failed to duplicate list: ${e.error.message}`);return}v.success("Variable list duplicated successfully")}async function b(s,e){let c;if(e==="csv"?c=await g(s.id):c=await L(s.id),!c.ok){v.error(`Failed to export list: ${c.error.message}`);return}const x=new Blob([c.value],{type:e==="csv"?"text/csv":"application/json"}),N=URL.createObjectURL(x),C=document.createElement("a");C.href=N,C.download=`${s.name}.${e}`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(N),v.success(`List exported as ${e.toUpperCase()}`)}function q(){w.value=!1,v.success("Import completed successfully")}return Ce(()=>{}),(s,e)=>{const c=ae,x=ue,N=re,C=oe,R=pe,Z=_e;return u(),m("div",Ft,[n("div",Ut,[e[7]||(e[7]=n("h1",null,"Variable Lists",-1)),n("div",Ot,[t(c,{onClick:A,loading:o.value,"data-testid":"btn-import-defaults"},{default:a(()=>e[2]||(e[2]=[d(" Import Standard Lists ")])),_:1,__:[2]},8,["loading"]),t(C,{placement:"bottomRight"},{overlay:a(()=>[t(N,{onClick:P},{default:a(()=>[t(x,{key:"simple"},{icon:a(()=>[t(k(Ge))]),default:a(()=>[e[4]||(e[4]=d(" Simple List "))]),_:1,__:[4]}),t(x,{key:"attributed"},{icon:a(()=>[t(k(We))]),default:a(()=>[e[5]||(e[5]=d(" Intersectional List "))]),_:1,__:[5]}),t(x,{key:"refusal"},{icon:a(()=>[t(k(Xe))]),default:a(()=>[e[6]||(e[6]=d(" Refusal List "))]),_:1,__:[6]})]),_:1})]),default:a(()=>[t(c,{type:"primary","data-testid":"btn-create-new"},{icon:a(()=>[t(k(Je))]),default:a(()=>[e[3]||(e[3]=d(" Create New ")),t(k(ie))]),_:1,__:[3]})]),_:1})])]),t(Z,{activeKey:l.value,"onUpdate:activeKey":e[0]||(e[0]=M=>l.value=M),class:"lists-tabs",onChange:O},{default:a(()=>[t(R,{key:"all",tab:"All Lists"},{default:a(()=>[t(X,{lists:y.value,loading:V.value,category:"all",onEdit:S,onDelete:h,onDuplicate:r,onExport:b},null,8,["lists","loading"])]),_:1}),t(R,{key:"simple",tab:"Simple Lists"},{default:a(()=>[t(X,{lists:y.value,loading:V.value,category:"simple",onEdit:S,onDelete:h,onDuplicate:r,onExport:b},null,8,["lists","loading"])]),_:1}),t(R,{key:"attributed",tab:"Intersectional Lists"},{default:a(()=>[t(X,{lists:y.value,loading:V.value,category:"attributed",onEdit:S,onDelete:h,onDuplicate:r,onExport:b},null,8,["lists","loading"])]),_:1}),t(R,{key:"refusal",tab:"Refusal Lists"},{default:a(()=>[t(X,{lists:y.value,loading:V.value,category:"refusal",onEdit:S,onDelete:h,onDuplicate:r,onExport:b},null,8,["lists","loading"])]),_:1})]),_:1},8,["activeKey"]),t(Et,{open:w.value,"onUpdate:open":e[1]||(e[1]=M=>w.value=M),onImported:q},null,8,["open"])])}}}),qt=ee(Nt,[["__scopeId","data-v-f195479c"]]);export{qt as default};

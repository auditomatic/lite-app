const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/trial-bundle.service-CUz6ufnV.js","assets/index-Cl7pIQF6.js","assets/vue-vendor-Dnvc27xK.js","assets/ui-vendor-x6pj6AZw.js","assets/utils-vendor-DgugrPw1.js","assets/data-vendor-Bm9xWgJa.js","assets/index-B2v1RG59.css","assets/python-bundle-management-CoItlPgO.js"])))=>i.map(i=>d[i]);
var Zt=Object.defineProperty;var es=(l,t,s)=>t in l?Zt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s;var de=(l,t,s)=>es(l,typeof t!="symbol"?t+"":t,s);import{h as ae,a as V,u as Je,d as ze,b as at,_ as Qe}from"./index-Cl7pIQF6.js";import{d as le,f as j,c as U,o as ce,b as ge,w as oe,R as i,a0 as se,S as e,_ as R,a9 as $e,a2 as me,Y as n,y as _e,aa as ts,ab as ss,ac as as,$ as Q,ad as ls,ae as ns,af as vt,q as mt,n as Te,k as w,Z as E,F as Z,W as te,a5 as lt,ag as os,ah as is,u as z,a4 as He,V as y,G as D,s as Pe,M as we,ai as Se,U as gt,A as ht,aj as rs,B as yt,r as us,a7 as ds,a1 as _t,X as xe,a6 as Be}from"./vue-vendor-Dnvc27xK.js";import{aH as bt,C as $t,aT as cs,m as pe,V as ps,aU as Tt,aV as fs,Z as Ye,az as vs,a0 as Xe,a1 as Ze,a4 as ms,ai as kt,P as nt,aW as gs,al as hs,av as ys,aN as Ct,$ as _s,aI as bs,aK as $s,a2 as et,Y as Ts,J as ks,M as be,ax as wt,aO as Ce,T as tt,G as Le,D as Cs,k as Y,aJ as ws,am as St,u as Ss,v as Is,I as It,aX as Rs,y as Rt,E as Pt,a9 as Ps,aa as Es,s as Vs,t as As,ap as Fs,W as xs,ab as Ls,ac as Ds,aY as Ne,R as Os,N as Ms,au as Et,aw as Us,aZ as Vt,U as Ns,ah as Ws}from"./ui-vendor-x6pj6AZw.js";import{b as At}from"./utils-vendor-DgugrPw1.js";import{u as Ft}from"./useCostEstimation-B9Of6wR0.js";import{P as zs}from"./ParserSelector-DV29ODjp.js";import{u as Hs}from"./parser.store-CVHARzMS.js";import{v as ot,b as xt,u as Bs,a as js,c as qs}from"./useV4TrialCommands-BcZp6X9B.js";import{u as Gs}from"./useHeatmapStylingV3-3u3kWhI3.js";import{u as Ks}from"./useV4Models-D3tTJsWQ.js";import"./data-vendor-Bm9xWgJa.js";import"./useV4LiveQuery-BxmuCaLK.js";const Js={class:"right-panel"},Qs=le({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(l,{expose:t,emit:s}){const d=l,p=s,r=j(d.defaultWidth),f=j(!1),k=j(0),S=j(0),o=j(window.innerWidth),C=j(!1),T=U(()=>o.value<d.mobileBreakpoint),h=U(()=>T.value?{width:`${Math.min(o.value*.85,400)}px`}:{width:`${r.value}px`});function P(){const u=localStorage.getItem(d.storageKey);if(u){const g=parseInt(u,10);!isNaN(g)&&g>=d.minWidth&&g<=d.maxWidth&&(r.value=g)}}function _(u){localStorage.setItem(d.storageKey,u.toString()),p("resize",u)}function b(u){f.value=!0,k.value=u.clientX,S.value=r.value,document.addEventListener("mousemove",x),document.addEventListener("mouseup",W),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function x(u){if(!f.value)return;const g=u.clientX-k.value,K=Math.max(d.minWidth,Math.min(d.maxWidth,S.value+g));r.value=K}function W(){f.value&&(f.value=!1,_(r.value),document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",W),document.body.style.userSelect="",document.body.style.cursor="")}function A(){r.value=d.defaultWidth,_(d.defaultWidth)}function c(){o.value=window.innerWidth,!T.value&&C.value&&(C.value=!1,p("mobile-overlay-change",!1))}function v(){T.value&&(C.value=!C.value,p("mobile-overlay-change",C.value))}function F(){C.value=!1,p("mobile-overlay-change",!1)}return t({toggleMobileOverlay:v,closeMobileOverlay:F}),ce(()=>{P(),window.addEventListener("resize",c)}),ge(()=>{window.removeEventListener("resize",c),W()}),oe(()=>d.defaultWidth,u=>{r.value===d.defaultWidth&&(r.value=u)}),(u,g)=>(n(),i("div",{class:se(["resizable-panel-container",{"mobile-overlay":T.value}])},[e("div",{class:se(["left-panel",{"overlay-visible":T.value&&C.value}]),style:me(h.value)},[$e(u.$slots,"left",{},void 0,!0)],6),T.value?R("",!0):(n(),i("div",{key:0,class:se(["resize-handle",{dragging:f.value}]),onMousedown:b,onDblclick:A},g[0]||(g[0]=[e("div",{class:"handle-bar"},null,-1)]),34)),e("div",Js,[$e(u.$slots,"right",{},void 0,!0)]),T.value&&C.value?(n(),i("div",{key:1,class:"mobile-overlay-bg",onClick:F})):R("",!0)],2))}}),Ys=ae(Qs,[["__scopeId","data-v-949e1df1"]]);function Xs(){var l=window.navigator.userAgent,t=l.indexOf("MSIE ");if(t>0)return parseInt(l.substring(t+5,l.indexOf(".",t)),10);var s=l.indexOf("Trident/");if(s>0){var d=l.indexOf("rv:");return parseInt(l.substring(d+3,l.indexOf(".",d)),10)}var p=l.indexOf("Edge/");return p>0?parseInt(l.substring(p+5,l.indexOf(".",p)),10):-1}let Ee;function je(){je.init||(je.init=!0,Ee=Xs()!==-1)}var De={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){je(),_e(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const l=document.createElement("object");this._resizeObject=l,l.setAttribute("aria-hidden","true"),l.setAttribute("tabindex",-1),l.onload=this.addResizeHandlers,l.type="text/html",Ee&&this.$el.appendChild(l),l.data="about:blank",Ee||this.$el.appendChild(l)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Ee&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Zs=as();ts("data-v-b329ee4c");const ea={class:"resize-observer",tabindex:"-1"};ss();const ta=Zs((l,t,s,d,p,r)=>(n(),Q("div",ea)));De.render=ta;De.__scopeId="data-v-b329ee4c";De.__file="src/components/ResizeObserver.vue";function Ve(l){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ve=function(t){return typeof t}:Ve=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ve(l)}function sa(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function aa(l,t){for(var s=0;s<t.length;s++){var d=t[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(l,d.key,d)}}function la(l,t,s){return t&&aa(l.prototype,t),l}function it(l){return na(l)||oa(l)||ia(l)||ra()}function na(l){if(Array.isArray(l))return qe(l)}function oa(l){if(typeof Symbol<"u"&&Symbol.iterator in Object(l))return Array.from(l)}function ia(l,t){if(l){if(typeof l=="string")return qe(l,t);var s=Object.prototype.toString.call(l).slice(8,-1);if(s==="Object"&&l.constructor&&(s=l.constructor.name),s==="Map"||s==="Set")return Array.from(l);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return qe(l,t)}}function qe(l,t){(t==null||t>l.length)&&(t=l.length);for(var s=0,d=new Array(t);s<t;s++)d[s]=l[s];return d}function ra(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ua(l){var t;return typeof l=="function"?t={callback:l}:t=l,t}function da(l,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d,p,r,f=function(S){for(var o=arguments.length,C=new Array(o>1?o-1:0),T=1;T<o;T++)C[T-1]=arguments[T];if(r=C,!(d&&S===p)){var h=s.leading;typeof h=="function"&&(h=h(S,p)),(!d||S!==p)&&h&&l.apply(void 0,[S].concat(it(r))),p=S,clearTimeout(d),d=setTimeout(function(){l.apply(void 0,[S].concat(it(r))),d=0},t)}};return f._clear=function(){clearTimeout(d),d=null},f}function Lt(l,t){if(l===t)return!0;if(Ve(l)==="object"){for(var s in l)if(!Lt(l[s],t[s]))return!1;return!0}return!1}var ca=function(){function l(t,s,d){sa(this,l),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(s,d)}return la(l,[{key:"createObserver",value:function(s,d){var p=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=ua(s),this.callback=function(k,S){p.options.callback(k,S),k&&p.options.once&&(p.frozen=!0,p.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},f=r.leading;this.callback=da(this.callback,this.options.throttle,{leading:function(S){return f==="both"||f==="visible"&&S||f==="hidden"&&!S}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(k){var S=k[0];if(k.length>1){var o=k.find(function(T){return T.isIntersecting});o&&(S=o)}if(p.callback){var C=S.isIntersecting&&S.intersectionRatio>=p.threshold;if(C===p.oldResult)return;p.oldResult=C,p.callback(C,S)}},this.options.intersection),_e(function(){p.observer&&p.observer.observe(p.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),l}();function Dt(l,t,s){var d=t.value;if(d)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var p=new ca(l,d,s);l._vue_visibilityState=p}}function pa(l,t,s){var d=t.value,p=t.oldValue;if(!Lt(d,p)){var r=l._vue_visibilityState;if(!d){Ot(l);return}r?r.createObserver(d,s):Dt(l,{value:d},s)}}function Ot(l){var t=l._vue_visibilityState;t&&(t.destroyObserver(),delete l._vue_visibilityState)}var fa={beforeMount:Dt,updated:pa,unmounted:Ot},va={itemsLimit:1e3},ma=/(auto|scroll)/;function Mt(l,t){return l.parentNode===null?t:Mt(l.parentNode,t.concat([l]))}var We=function(t,s){return getComputedStyle(t,null).getPropertyValue(s)},ga=function(t){return We(t,"overflow")+We(t,"overflow-y")+We(t,"overflow-x")},ha=function(t){return ma.test(ga(t))};function rt(l){if(l instanceof HTMLElement||l instanceof SVGElement){for(var t=Mt(l.parentNode,[]),s=0;s<t.length;s+=1)if(ha(t[s]))return t[s];return document.scrollingElement||document.documentElement}}function Ge(l){"@babel/helpers - typeof";return Ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(l)}var ya={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function _a(){return this.items.length&&Ge(this.items[0])!=="object"}var Ke=!1;if(typeof window<"u"){Ke=!1;try{var ba=Object.defineProperty({},"passive",{get:function(){Ke=!0}});window.addEventListener("test",null,ba)}catch{}}let $a=0;var Oe={name:"RecycleScroller",components:{ResizeObserver:De},directives:{ObserveVisibility:fa},props:{...ya,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const l={"-1":{accumulator:0}},t=this.items,s=this.sizeField,d=this.minItemSize;let p=1e4,r=0,f;for(let k=0,S=t.length;k<S;k++)f=t[k][s]||d,f<p&&(p=f),r+=f,l[k]={accumulator:r,size:f};return this.$_computedMinItemSize=p,l}return[]},simpleArray:_a,itemIndexByKey(){const{keyField:l,items:t}=this,s={};for(let d=0,p=t.length;d<p;d++)s[t[d][l]]=d;return s}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const l=this.$_lastUpdateScrollPosition;typeof l=="number"&&this.$nextTick(()=>{this.scrollToPosition(l)})},beforeUnmount(){this.removeListeners()},methods:{addView(l,t,s,d,p){const r=ls({id:$a++,index:t,used:!0,key:d,type:p}),f=ns({item:s,position:0,nr:r});return l.push(f),f},unuseView(l,t=!1){const s=this.$_unusedViews,d=l.nr.type;let p=s.get(d);p||(p=[],s.set(d,p)),p.push(l),t||(l.nr.used=!1,l.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(l){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:s}=this.updateVisibleItems(!1,!0);s||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(l,t){this.ready&&(l||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(l,t=!1){const s=this.itemSize,d=this.gridItems||1,p=this.itemSecondarySize||s,r=this.$_computedMinItemSize,f=this.typeField,k=this.simpleArray?null:this.keyField,S=this.items,o=S.length,C=this.sizes,T=this.$_views,h=this.$_unusedViews,P=this.pool,_=this.itemIndexByKey;let b,x,W,A,c;if(!o)b=x=A=c=W=0;else if(this.$_prerender)b=A=0,x=c=Math.min(this.prerender,S.length),W=null;else{const L=this.getScroll();if(t){let I=L.start-this.$_lastUpdateScrollPosition;if(I<0&&(I=-I),s===null&&I<r||I<s)return{continuous:!0}}this.$_lastUpdateScrollPosition=L.start;const a=this.buffer;L.start-=a,L.end+=a;let m=0;if(this.$refs.before&&(m=this.$refs.before.scrollHeight,L.start-=m),this.$refs.after){const I=this.$refs.after.scrollHeight;L.end+=I}if(s===null){let I,H=0,M=o-1,G=~~(o/2),N;do N=G,I=C[G].accumulator,I<L.start?H=G:G<o-1&&C[G+1].accumulator>L.start&&(M=G),G=~~((H+M)/2);while(G!==N);for(G<0&&(G=0),b=G,W=C[o-1].accumulator,x=G;x<o&&C[x].accumulator<L.end;x++);for(x===-1?x=S.length-1:(x++,x>o&&(x=o)),A=b;A<o&&m+C[A].accumulator<L.start;A++);for(c=A;c<o&&m+C[c].accumulator<L.end;c++);}else{b=~~(L.start/s*d);const I=b%d;b-=I,x=Math.ceil(L.end/s*d),A=Math.max(0,Math.floor((L.start-m)/s*d)),c=Math.floor((L.end-m)/s*d),b<0&&(b=0),x>o&&(x=o),A<0&&(A=0),c>o&&(c=o),W=Math.ceil(o/d)*s}}x-b>va.itemsLimit&&this.itemsLimitError(),this.totalSize=W;let v;const F=b<=this.$_endIndex&&x>=this.$_startIndex;if(F)for(let L=0,a=P.length;L<a;L++)v=P[L],v.nr.used&&(l&&(v.nr.index=_[v.item[k]]),(v.nr.index==null||v.nr.index<b||v.nr.index>=x)&&this.unuseView(v));const u=F?null:new Map;let g,K,X;for(let L=b;L<x;L++){g=S[L];const a=k?g[k]:g;if(a==null)throw new Error(`Key is ${a} on item (keyField is '${k}')`);if(v=T.get(a),!s&&!C[L].size){v&&this.unuseView(v);continue}K=g[f];let m=h.get(K),I=!1;if(!v)F?m&&m.length?v=m.pop():v=this.addView(P,L,g,a,K):(X=u.get(K)||0,(!m||X>=m.length)&&(v=this.addView(P,L,g,a,K),this.unuseView(v,!0),m=h.get(K)),v=m[X],u.set(K,X+1)),T.delete(v.nr.key),v.nr.used=!0,v.nr.index=L,v.nr.key=a,v.nr.type=K,T.set(a,v),I=!0;else if(!v.nr.used&&(v.nr.used=!0,I=!0,m)){const H=m.indexOf(v);H!==-1&&m.splice(H,1)}v.item=g,I&&(L===S.length-1&&this.$emit("scroll-end"),L===0&&this.$emit("scroll-start")),s===null?(v.position=C[L-1].accumulator,v.offset=0):(v.position=Math.floor(L/d)*s,v.offset=L%d*p)}return this.$_startIndex=b,this.$_endIndex=x,this.emitUpdate&&this.$emit("update",b,x,A,c),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:F}},getListenerTarget(){let l=rt(this.$el);return window.document&&(l===window.document.documentElement||l===window.document.body)&&(l=window),l},getScroll(){const{$el:l,direction:t}=this,s=t==="vertical";let d;if(this.pageMode){const p=l.getBoundingClientRect(),r=s?p.height:p.width;let f=-(s?p.top:p.left),k=s?window.innerHeight:window.innerWidth;f<0&&(k+=f,f=0),f+k>r&&(k=r-f),d={start:f,end:f+k}}else s?d={start:l.scrollTop,end:l.scrollTop+l.clientHeight}:d={start:l.scrollLeft,end:l.scrollLeft+l.clientWidth};return d},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Ke?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(l){let t;const s=this.gridItems||1;this.itemSize===null?t=l>0?this.sizes[l-1].accumulator:0:t=Math.floor(l/s)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(l){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let s,d,p;if(this.pageMode){const r=rt(this.$el),f=r.tagName==="HTML"?0:r[t.scroll],k=r.getBoundingClientRect(),o=this.$el.getBoundingClientRect()[t.start]-k[t.start];s=r,d=t.scroll,p=l+f+o}else s=this.$el,d=t.scroll,p=l;s[d]=p},itemsLimitError(){throw setTimeout(()=>{this.$el}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((l,t)=>l.nr.index-t.nr.index)}}};const Ta={key:0,ref:"before",class:"vue-recycle-scroller__slot"},ka={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Ca(l,t,s,d,p,r){const f=vt("ResizeObserver"),k=mt("observe-visibility");return Te((n(),i("div",{class:se(["vue-recycle-scroller",{ready:p.ready,"page-mode":s.pageMode,[`direction-${l.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...S)=>r.handleScroll&&r.handleScroll(...S))},[l.$slots.before?(n(),i("div",Ta,[$e(l.$slots,"before")],512)):R("v-if",!0),(n(),Q(lt(s.listTag),{ref:"wrapper",style:me({[l.direction==="vertical"?"minHeight":"minWidth"]:p.totalSize+"px"}),class:se(["vue-recycle-scroller__item-wrapper",s.listClass])},{default:E(()=>[(n(!0),i(Z,null,te(p.pool,S=>(n(),Q(lt(s.itemTag),os({key:S.nr.id,style:p.ready?{transform:`translate${l.direction==="vertical"?"Y":"X"}(${S.position}px) translate${l.direction==="vertical"?"X":"Y"}(${S.offset}px)`,width:s.gridItems?`${l.direction==="vertical"&&s.itemSecondarySize||s.itemSize}px`:void 0,height:s.gridItems?`${l.direction==="horizontal"&&s.itemSecondarySize||s.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[s.itemClass,{hover:!s.skipHover&&p.hoverKey===S.nr.key}]]},is(s.skipHover?{}:{mouseenter:()=>{p.hoverKey=S.nr.key},mouseleave:()=>{p.hoverKey=null}})),{default:E(()=>[$e(l.$slots,"default",{item:S.item,index:S.nr.index,active:S.nr.used})]),_:2},1040,["style","class"]))),128)),$e(l.$slots,"empty")]),_:3},8,["style","class"])),l.$slots.after?(n(),i("div",ka,[$e(l.$slots,"after")],512)):R("v-if",!0),w(f,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[k,r.handleVisibilityChange]])}Oe.render=Ca;Oe.__file="src/components/RecycleScroller.vue";const wa={class:"trial-list-search"},Sa=["value"],Ia=le({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(l,{emit:t}){const s=t,d=j(),p=At(o=>{s("update:modelValue",o)},300);function r(o){const C=o.target.value;p(C)}function f(){s("update:modelValue",""),d.value?.focus()}function k(){d.value?.focus(),d.value?.select()}function S(o){o.type==="focus-trial-search"&&k()}return ce(()=>{window.addEventListener("focus-trial-search",S)}),ge(()=>{window.removeEventListener("focus-trial-search",S)}),(o,C)=>(n(),i("div",wa,[w(z(bt),{class:"search-icon"}),e("input",{ref_key:"searchInput",ref:d,type:"text",class:"search-input",placeholder:"Filter trials...",value:o.modelValue,onInput:r,onKeydown:He(f,["escape"])},null,40,Sa),o.modelValue?(n(),Q(z($t),{key:0,class:"clear-icon",onClick:f})):R("",!0)]))}}),Ra=ae(Ia,[["__scopeId","data-v-3a032c2b"]]),Pa={class:"item-content"},Ea={class:"item-header"},Va=["title"],Aa={key:0,class:"progress-bar"},Fa={class:"item-metadata"},xa={class:"meta-item"},La={class:"meta-item"},Da={key:0,class:"meta-separator"},Oa={key:1,class:"meta-item cost"},Ma=le({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(l){const t=l,{calculateTemplateTokens:s,calculatePromptTokens:d,estimateTotalCost:p,sumEstimates:r,formatCost:f}=Ft(),k=U(()=>{if(t.trial.progress.total===0)return 0;const T=t.trial.progress.completed+t.trial.progress.failed;return Math.round(T/t.trial.progress.total*100)}),S=U(()=>{const{completed:T,failed:h,total:P}=t.trial.progress;return t.trial.status==="draft"?`${P} tasks`:`${T+h}/${P} tasks`}),o=U(()=>{const T=t.trial.started||t.trial.created;if(!T)return"";const P=new Date().getTime()-T.getTime(),_=Math.floor(P/1e3),b=Math.floor(_/60),x=Math.floor(b/60),W=Math.floor(x/24);return _<60?"now":b<60?`${b}m`:x<24?`${x}h`:`${W}d`}),C=U(()=>{if(!t.trial.configurations||t.trial.configurations.length===0)return null;let T=null;if(t.trial.type==="template"&&t.trial.templateConfig?.template)T=s(t.trial.templateConfig.template,t.trial.templateConfig.variables||{});else if(t.trial.type==="spreadsheet"&&t.trial.spreadsheetConfig?.promptPattern){const _=d(t.trial.spreadsheetConfig.promptPattern),b=t.trial.progress.total/t.trial.configurations.length;T={totalTokens:_*b,combinationCount:b,perCallAverage:_}}else if(t.trial.type==="playground")return null;if(!T||T.totalTokens===0)return null;const h=t.trial.configurations.map(_=>{const b=_.modelSnapshot;return b?p(T.totalTokens,T.combinationCount,b,_.parameters):null}).filter(Boolean);if(h.length===0)return null;const P=r(h);return`$${f(P,"compact")} total`});return(T,h)=>(n(),i("div",{class:se(["trial-list-item",{selected:T.selected,"has-progress":T.trial.status==="running"}]),onClick:h[0]||(h[0]=P=>T.$emit("click"))},[e("div",{class:se(["status-indicator",`status-${T.trial.status}`])},null,2),e("div",Pa,[e("div",Ea,[e("span",{class:"trial-name",title:T.trial.name},y(T.trial.name),9,Va),e("span",{class:se(["status-tag",`status-${T.trial.status}`])},y(T.trial.status.toUpperCase()),3)]),T.trial.status==="running"?(n(),i("div",Aa,[e("div",{class:"progress-fill",style:me({width:`${k.value}%`})},null,4)])):R("",!0),e("div",Fa,[e("span",xa,y(S.value),1),h[1]||(h[1]=e("span",{class:"meta-separator"},"•",-1)),e("span",La,y(o.value),1),C.value?(n(),i("span",Da,"•")):R("",!0),C.value?(n(),i("span",Oa,y(C.value),1)):R("",!0)])])],2))}}),ut=ae(Ma,[["__scopeId","data-v-67909aef"]]),Ua={class:"section-title"},Na=le({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(l){return(t,s)=>(n(),i("div",{class:se(["trial-list-section",{"with-background":t.background}])},[e("span",Ua,y(t.title),1)],2))}}),dt=ae(Na,[["__scopeId","data-v-07a26c58"]]),Wa={class:"panel-header"},za={class:"header-title"},Ha={key:0,class:"title-text"},Ba={class:"trial-count"},ja={key:0,class:"header-actions"},qa={class:"filter-count"},Ga={class:"filter-count"},Ka={class:"filter-count"},Ja={class:"filter-count"},Qa={class:"filter-count"},Ya={key:1,class:"status-tabs"},Xa={class:"tab-count"},Za={class:"tab-count"},el={class:"tab-count"},tl={class:"trial-list-container"},sl={key:1,class:"trial-list"},al={key:2,class:"collapsed-list"},ll=["onClick"],nl={class:"collapsed-count"},ol={key:3,class:"empty-state"},il=le({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","import-trial","update-search","update-filter","refresh"],setup(l,{emit:t}){const s=l,d=t,p=j(!1),r=j("all"),f=j(250),k=U(()=>f.value<50),S=U(()=>s.trials.filter(u=>u.status==="running"||u.status==="paused").length),o=U(()=>s.trials.filter(u=>u.status==="completed"||u.status==="failed").length),C=U(()=>{let u=s.trials;if(s.searchQuery){const L=s.searchQuery.toLowerCase();u=u.filter(a=>{const m=a.name.toLowerCase().includes(L),I=a.templateConfig?.template?.toLowerCase().includes(L),H=a.configurations.some(M=>M.modelId.toLowerCase().includes(L)||M.provider.toLowerCase().includes(L));return m||I||H})}s.filterStatus!=="all"&&(u=u.filter(L=>L.status===s.filterStatus)),r.value==="active"?u=u.filter(L=>L.status==="running"||L.status==="paused"):r.value==="done"&&(u=u.filter(L=>L.status==="completed"||L.status==="failed"));const g=u.filter(L=>L.status==="running"),K=u.filter(L=>L.status!=="running"),X=[];return g.length>0&&(X.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),X.push(...g.sort((L,a)=>(a.started?.getTime()||0)-(L.started?.getTime()||0)))),K.length>0&&(g.length>0&&X.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),X.push(...K.sort((L,a)=>(a.created?.getTime()||0)-(L.created?.getTime()||0)))),X}),T=U(()=>C.value.map(u=>({...u,height:W(u)}))),h=U(()=>s.trials.filter(u=>r.value==="active"?u.status==="running"||u.status==="paused":r.value==="done"?u.status==="completed"||u.status==="failed":!0)),P=U(()=>s.searchQuery?"No trials found":s.filterStatus==="running"?"No trials are currently running":"No trials found"),_=U(()=>s.searchQuery?"No trials match your search":s.filterStatus!=="all"?`No ${s.filterStatus} trials`:"Create your first trial to get started"),b=U(()=>s.filterStatus==="all"&&!s.searchQuery);function x(u){return s.trials.filter(g=>g.status===u).length}function W(u){if(u.type==="section")return 32;const g=u.status==="running",K=u.configurations?.some(X=>X.repeatCount>1);return g||K?96:80}function A(u){const g=u.progress.completed+u.progress.failed;return u.status==="running"?`${Math.round(g/u.progress.total*100)}%`:g.toString()}async function c(){p.value=!0;try{await new Promise(u=>setTimeout(u,500)),d("refresh")}finally{p.value=!1}}function v({key:u}){d("update-filter",u)}function F(){const u=document.querySelector(".trial-list-panel");u&&(f.value=u.clientWidth)}return ce(()=>{F(),window.addEventListener("resize",F);const u=document.querySelector(".trial-list-panel");u&&new ResizeObserver(()=>F()).observe(u)}),ge(()=>{window.removeEventListener("resize",F)}),(u,g)=>{const K=pe,X=Ze,L=ms,a=Xe,m=Ye;return n(),i("div",{class:se(["trial-list-panel",{collapsed:k.value}])},[e("div",Wa,[e("div",za,[w(z(cs),{class:"title-icon"}),k.value?R("",!0):(n(),i("span",Ha,"Trials")),e("span",Ba,y(u.trials.length),1)]),k.value?R("",!0):(n(),i("div",ja,[w(K,{type:"primary",size:"small",onClick:g[0]||(g[0]=I=>u.$emit("create-trial"))},{default:E(()=>[w(z(ps)),g[7]||(g[7]=D(" New Trial "))]),_:1,__:[7]}),w(K,{size:"small",onClick:g[1]||(g[1]=I=>u.$emit("import-trial"))},{default:E(()=>[w(z(Tt)),g[8]||(g[8]=D(" Import "))]),_:1,__:[8]}),w(K,{size:"small",onClick:c,loading:p.value},{default:E(()=>[w(z(fs),{spin:p.value},null,8,["spin"])]),_:1},8,["loading"]),w(m,null,{overlay:E(()=>[w(a,{onClick:v},{default:E(()=>[w(X,{key:"all"},{default:E(()=>g[9]||(g[9]=[e("span",null,"All Trials",-1)])),_:1,__:[9]}),w(L),w(X,{key:"running"},{default:E(()=>[g[10]||(g[10]=e("span",null,"Running Only",-1)),e("span",qa,y(x("running")),1)]),_:1,__:[10]}),w(X,{key:"completed"},{default:E(()=>[g[11]||(g[11]=e("span",null,"Completed Only",-1)),e("span",Ga,y(x("completed")),1)]),_:1,__:[11]}),w(X,{key:"failed"},{default:E(()=>[g[12]||(g[12]=e("span",null,"Failed Only",-1)),e("span",Ka,y(x("failed")),1)]),_:1,__:[12]}),w(X,{key:"paused"},{default:E(()=>[g[13]||(g[13]=e("span",null,"Paused Only",-1)),e("span",Ja,y(x("paused")),1)]),_:1,__:[13]}),w(X,{key:"draft"},{default:E(()=>[g[14]||(g[14]=e("span",null,"Draft Only",-1)),e("span",Qa,y(x("draft")),1)]),_:1,__:[14]})]),_:1})]),default:E(()=>[w(K,{size:"small"},{default:E(()=>[w(z(vs))]),_:1})]),_:1})]))]),k.value?R("",!0):(n(),Q(Ra,{key:0,"model-value":u.searchQuery,"onUpdate:modelValue":g[2]||(g[2]=I=>u.$emit("update-search",I))},null,8,["model-value"])),k.value?R("",!0):(n(),i("div",Ya,[e("div",{class:se(["status-tab",{active:r.value==="all"}]),onClick:g[3]||(g[3]=I=>r.value="all")},[g[15]||(g[15]=e("span",{class:"tab-icon"},"📊",-1)),g[16]||(g[16]=e("span",{class:"tab-label"},"ALL",-1)),e("span",Xa,y(u.trials.length),1)],2),e("div",{class:se(["status-tab",{active:r.value==="active"}]),onClick:g[4]||(g[4]=I=>r.value="active")},[g[17]||(g[17]=e("span",{class:"tab-icon"},"🟢",-1)),g[18]||(g[18]=e("span",{class:"tab-label"},"Active",-1)),e("span",Za,y(S.value),1)],2),e("div",{class:se(["status-tab",{active:r.value==="done"}]),onClick:g[5]||(g[5]=I=>r.value="done")},[g[19]||(g[19]=e("span",{class:"tab-icon"},"✅",-1)),g[20]||(g[20]=e("span",{class:"tab-label"},"Done",-1)),e("span",el,y(o.value),1)],2)])),e("div",tl,[!k.value&&C.value.length>100?(n(),Q(z(Oe),{key:0,class:"trial-list virtual-list",items:T.value,"size-field":"height","key-field":"id",buffer:10},{default:E(({item:I})=>[I.type==="section"?(n(),Q(dt,{key:0,title:I.title,background:I.background},null,8,["title","background"])):(n(),Q(ut,{key:1,trial:I,selected:I.id===u.selectedTrialId,"data-trial-id":I.id,onClick:H=>u.$emit("select-trial",I.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):k.value?(n(),i("div",al,[(n(!0),i(Z,null,te(h.value,I=>(n(),i("div",{key:I.id,class:se(["collapsed-item",{selected:I.id===u.selectedTrialId}]),onClick:H=>u.$emit("select-trial",I.id)},[e("div",{class:se(["status-dot",`status-${I.status}`])},null,2),e("span",nl,y(A(I)),1)],10,ll))),128))])):(n(),i("div",sl,[(n(!0),i(Z,null,te(C.value,(I,H)=>(n(),i(Z,{key:I.id||`section-${H}`},[I.type==="section"?(n(),Q(dt,{key:0,title:I.title,background:I.background},null,8,["title","background"])):(n(),Q(ut,{key:1,trial:I,selected:I.id===u.selectedTrialId,"data-trial-id":I.id,onClick:M=>u.$emit("select-trial",I.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),C.value.length===0&&!k.value?(n(),i("div",ol,[w(z(kt),{class:"empty-icon"}),e("h3",null,y(P.value),1),e("p",null,y(_.value),1),b.value?(n(),Q(K,{key:0,type:"primary",size:"large",onClick:g[6]||(g[6]=I=>u.$emit("create-trial"))},{default:E(()=>g[21]||(g[21]=[D(" Create New Trial ")])),_:1,__:[21]})):R("",!0)])):R("",!0)])],2)}}}),rl=ae(il,[["__scopeId","data-v-ad2a17cf"]]),ul={class:"trial-header"},dl={class:"header-main"},cl={class:"header-title"},pl={class:"trial-name"},fl={key:0,class:"progress-container"},vl={class:"progress-bar"},ml={class:"progress-stats-inline"},gl={class:"progress-text"},hl={key:0,class:"progress-stat"},yl={class:"stat-number"},_l={key:1,class:"progress-stat"},bl={class:"stat-number"},$l={key:2,class:"progress-stat"},Tl={class:"stat-number"},kl=le({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(l){const t=l,s=U(()=>{let _=t.trial.name;return _=_.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),_=_.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),_.trim()}),d=U(()=>!0),p=U(()=>t.progress?t.progress.completed+t.progress.failed:0),r=U(()=>{if(!t.progress||t.progress.total===0)return 0;const _=t.progress.completed+t.progress.failed;return Math.round(_/t.progress.total*100)}),f=U(()=>{const _=t.trial.started||t.trial.created;if(!_)return"0m";let b;if(t.trial.status==="draft")return"0m";t.trial.completed?b=t.trial.completed:b=new Date;const x=b.getTime()-_.getTime(),W=Math.floor(x/(1e3*60*60)),A=Math.floor(x%(1e3*60*60)/(1e3*60));return W>0?`${W}h ${A}m`:`${A}m`}),k=U(()=>{if(!t.progress?.avgLatencyMs)return null;const _=t.progress.avgLatencyMs;return _<1e3?`${Math.round(_)}ms`:`${(_/1e3).toFixed(1)}s`}),{calculateTemplateTokens:S,calculatePromptTokens:o,estimateTotalCost:C,sumEstimates:T,formatCost:h}=Ft();U(()=>{if(!t.trial.configurations||t.trial.configurations.length===0)return null;let _=null;if(t.trial.type==="template"&&t.trial.templateConfig?.template)_=S(t.trial.templateConfig.template,t.trial.templateConfig.variables||{});else if(t.trial.type==="spreadsheet"&&t.trial.spreadsheetConfig?.promptPattern){const W=o(t.trial.spreadsheetConfig.promptPattern),c=(t.progress?.total||t.trial.progress.total)/t.trial.configurations.length;_={totalTokens:W*c,combinationCount:c,perCallAverage:W}}else if(t.trial.type==="playground")return null;if(!_||_.totalTokens===0)return null;const b=t.trial.configurations.map(W=>{const A=W.modelSnapshot;return A?C(_.totalTokens,_.combinationCount,A,W.parameters):null}).filter(Boolean);if(b.length===0)return null;const x=T(b);return`${h(x,"compact")} total`});const P=U(()=>{if(t.trial.status!=="running"||!t.progress||t.progress.completed===0)return null;const b=(Date.now()-(t.trial.started?.getTime()||0))/t.progress.completed,x=t.progress.pending*b,W=Math.floor(x/(1e3*60)),A=Math.floor(x%(1e3*60)/1e3);if(W>60){const c=Math.floor(W/60),v=W%60;return`${c}h ${v}m`}return`${W}m ${A}s`});return(_,b)=>(n(),i("div",ul,[e("div",dl,[e("div",cl,[e("h2",pl,y(s.value),1),e("span",{class:se(["status-tag",`status-${_.trial.status}`])},y(_.trial.status.toUpperCase()),3)]),d.value?(n(),i("div",fl,[e("div",vl,[e("div",{class:"progress-fill",style:me({width:`${r.value}%`})},null,4)]),e("div",ml,[e("span",gl,y(p.value)+"/"+y(_.progress?.total||0)+" ("+y(r.value)+"%) ",1),f.value?(n(),i("span",hl,[b[0]||(b[0]=e("span",{class:"stat-label"},"Duration:",-1)),b[1]||(b[1]=D()),e("span",yl,y(f.value),1)])):R("",!0),k.value?(n(),i("span",_l,[b[2]||(b[2]=e("span",{class:"stat-label"},"Avg:",-1)),b[3]||(b[3]=D()),e("span",bl,y(k.value),1)])):R("",!0),P.value?(n(),i("span",$l,[b[4]||(b[4]=e("span",{class:"stat-label"},"Remaining:",-1)),b[5]||(b[5]=D()),e("span",Tl,"~"+y(P.value),1)])):R("",!0)])])):R("",!0)]),R("",!0)]))}}),Cl=ae(kl,[["__scopeId","data-v-65916275"]]),wl={class:"trial-actions"},Sl={class:"action-group execution-controls"},Il={class:"action-group data-actions"},Rl={class:"action-group management-actions"},Pl=le({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(l,{emit:t}){const s=l,d=t,p=j(!1),r=j(!1),f=j(!1);U(()=>s.executionState?.currentTrialId===s.trial.id);const k=U(()=>["draft","failed","cancelled"].includes(s.trial.status)),S=U(()=>s.trial.status==="running"),o=U(()=>s.trial.status==="paused"),C=U(()=>["running","paused"].includes(s.trial.status));function T(){d("start")}async function h(){p.value=!0,r.value=!1,d("pause"),setTimeout(()=>{p.value=!1},1e3)}async function P(){r.value=!0,p.value=!1,d("resume"),setTimeout(()=>{r.value=!1},3e3)}function _(){be.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>d("cancel")})}async function b(){f.value=!0,d("refresh"),setTimeout(()=>{f.value=!1},500)}function x({key:v}){v==="data"?d("export-data"):v==="python"&&d("export-python")}function W(){d("duplicate")}function A(){d("edit")}function c(){const v=s.trial.progress.total;be.confirm({title:"Delete trial?",content:`Delete trial and all ${v} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{d("delete")}})}return(v,F)=>{const u=pe,g=Ze,K=Xe,X=Ye;return n(),i("div",wl,[e("div",Sl,[k.value?(n(),Q(u,{key:0,type:"primary",size:"large",disabled:!v.isLeader,onClick:T},{default:E(()=>[w(z(nt)),F[0]||(F[0]=D(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):R("",!0),S.value?(n(),Q(u,{key:1,size:"large",disabled:!v.isLeader,loading:p.value,onClick:h},{default:E(()=>[p.value?R("",!0):(n(),Q(z(gs),{key:0})),D(" "+y(p.value?"Pausing...":"Pause"),1)]),_:1},8,["disabled","loading"])):R("",!0),o.value?(n(),Q(u,{key:2,type:"primary",size:"large",disabled:!v.isLeader||r.value,loading:r.value,onClick:P},{default:E(()=>[r.value?R("",!0):(n(),Q(z(nt),{key:0})),D(" "+y(r.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):R("",!0),C.value?(n(),Q(u,{key:3,danger:"",size:"large",disabled:!v.isLeader,onClick:_},{default:E(()=>[w(z(hs)),F[1]||(F[1]=D(" Cancel "))]),_:1,__:[1]},8,["disabled"])):R("",!0)]),e("div",Il,[w(u,{size:"large",loading:f.value,onClick:b,title:"Refresh trial data from database"},{default:E(()=>[f.value?(n(),Q(z(Ct),{key:1,spin:""})):(n(),Q(z(ys),{key:0})),D(" "+y(f.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),w(X,null,{overlay:E(()=>[w(K,{onClick:x},{default:E(()=>[w(g,{key:"data"},{default:E(()=>[w(z(bs)),F[3]||(F[3]=D(" Export Data "))]),_:1,__:[3]}),w(g,{key:"python"},{default:E(()=>[w(z($s)),F[4]||(F[4]=D(" Export Python Script "))]),_:1,__:[4]})]),_:1})]),default:E(()=>[w(u,{size:"large"},{default:E(()=>[F[2]||(F[2]=D(" Export ")),w(z(_s))]),_:1,__:[2]})]),_:1})]),e("div",Rl,[w(u,{size:"large",disabled:!v.isLeader,onClick:W},{default:E(()=>[w(z(et)),F[5]||(F[5]=D(" Duplicate "))]),_:1,__:[5]},8,["disabled"]),v.trial.status==="draft"?(n(),Q(u,{key:0,size:"large",disabled:!v.isLeader,onClick:A},{default:E(()=>[w(z(Ts)),F[6]||(F[6]=D(" Edit "))]),_:1,__:[6]},8,["disabled"])):R("",!0),w(u,{danger:"",size:"large",disabled:!v.isLeader,onClick:c},{default:E(()=>[w(z(ks)),F[7]||(F[7]=D(" Delete "))]),_:1,__:[7]},8,["disabled"])])])}}}),El=ae(Pl,[["__scopeId","data-v-e642c431"]]),Vl={class:"snapshot-debug"},Al={class:"debug-header"},Fl={class:"status-row"},xl={key:0,class:"badge success"},Ll={key:1,class:"badge warning"},Dl={key:0,class:"status-row"},Ol={key:0,class:"variables-section"},Ml={class:"variable-header"},Ul={class:"var-name"},Nl={class:"var-type"},Wl={key:0,class:"snapshot-content"},zl={class:"snapshot-meta"},Hl={key:0},Bl={class:"snapshot-items"},jl={class:"items-preview"},ql={class:"item-index"},Gl={class:"item-value"},Kl={key:0,class:"item-attrs"},Jl={key:0,class:"more-indicator"},Ql={key:1,class:"no-snapshot"},Yl={key:0},Xl={key:1,class:"legacy-warning"},Zl={class:"debug-footer"},en=le({__name:"SnapshotDebugModal",props:{visible:{type:Boolean},trial:{},migrating:{type:Boolean}},emits:["close","migrate"],setup(l){const t=l,s=U(()=>t.trial.templateConfig?.hasSnapshots===!0),d=U(()=>t.trial.templateConfig?.variables||{});function p(o){return"snapshot"in o&&o.snapshot!=null}function r(o){return o.snapshot}function f(o){return p(o)?`${r(o).source.type} (snapshot)`:o.type==="value"?"Direct values":o.type==="list"?"List reference":"Unknown"}function k(){for(const o of Object.values(d.value))if(p(o)){const C=r(o);if(C.source?.snapshotDate)return new Date(C.source.snapshotDate).toLocaleString()}return"Unknown"}function S(){const o={trialId:t.trial.id,trialName:t.trial.name,hasSnapshots:s.value,variables:d.value};navigator.clipboard.writeText(JSON.stringify(o,null,2)),Y.success("Debug info copied to clipboard")}return(o,C)=>{const T=tt,h=Le,P=pe,_=be;return n(),Q(_,{visible:o.visible,title:"Variable Snapshot Debug View",width:"80%",footer:null,onCancel:C[2]||(C[2]=b=>o.$emit("close"))},{default:E(()=>[e("div",Vl,[e("div",Al,[e("div",Fl,[C[5]||(C[5]=e("span",{class:"label"},"Snapshot Status:",-1)),s.value?(n(),i("span",xl,[w(z(wt)),C[3]||(C[3]=D(" Snapshots Enabled "))])):(n(),i("span",Ll,[w(z(Ce)),C[4]||(C[4]=D(" Legacy Mode (No Snapshots) "))]))]),s.value?(n(),i("div",Dl,[C[6]||(C[6]=e("span",{class:"label"},"Snapshot Date:",-1)),e("span",null,y(k()),1)])):R("",!0)]),s.value?(n(),i("div",Ol,[C[8]||(C[8]=e("h3",null,"Variable Snapshots",-1)),(n(!0),i(Z,null,te(d.value,(b,x)=>(n(),i("div",{key:x,class:"variable-card"},[e("div",Ml,[e("span",Ul,y(x),1),e("span",Nl,y(f(b)),1)]),p(b)?(n(),i("div",Wl,[e("div",zl,[e("span",null,"Source: "+y(r(b).source.type),1),r(b).source.listName?(n(),i("span",Hl," List: "+y(r(b).source.listName),1)):R("",!0),e("span",null,"Items: "+y(r(b).items.length),1)]),e("div",Bl,[e("div",jl,[(n(!0),i(Z,null,te(r(b).items.slice(0,5),(W,A)=>(n(),i("div",{key:A,class:"item-row"},[e("span",ql,y(A+1)+".",1),e("span",Gl,y(W.value),1),W.attributes&&Object.keys(W.attributes).length>0?(n(),i("span",Kl,[(n(!0),i(Z,null,te(W.attributes,(c,v)=>(n(),Q(T,{key:v,size:"small"},{default:E(()=>[D(y(v)+": "+y(c),1)]),_:2},1024))),128))])):R("",!0)]))),128)),r(b).items.length>5?(n(),i("div",Jl," ... and "+y(r(b).items.length-5)+" more items ",1)):R("",!0)])])])):(n(),i("div",Ql,[w(z(Ce)),C[7]||(C[7]=D(" No snapshot - using live reference ")),b.listId?(n(),i("span",Yl,"List ID: "+y(b.listId),1)):R("",!0)]))]))),128))])):(n(),i("div",Xl,[w(h,{message:"Legacy Trial",description:"This trial was created before snapshots were implemented. Variable lists are loaded dynamically from the database, which means changes to lists will affect trial duplication.",type:"warning","show-icon":""}),w(P,{type:"primary",onClick:C[0]||(C[0]=b=>o.$emit("migrate")),loading:o.migrating,style:{"margin-top":"16px"}},{default:E(()=>[w(z(Cs)),C[9]||(C[9]=D(" Migrate to Snapshots "))]),_:1,__:[9]},8,["loading"])])),e("div",Zl,[w(P,{onClick:S},{default:E(()=>[w(z(et)),C[10]||(C[10]=D(" Copy Debug Info "))]),_:1,__:[10]}),w(P,{onClick:C[1]||(C[1]=b=>o.$emit("close"))},{default:E(()=>C[11]||(C[11]=[D("Close")])),_:1,__:[11]})])])]),_:1},8,["visible"])}}}),tn=ae(en,[["__scopeId","data-v-726379cc"]]),sn={class:"trial-detail-view"},an={key:0,class:"detail-content"},ln={class:"detail-section"},nn={class:"detail-grid"},on={class:"detail-item"},rn={key:0,class:"detail-item"},un={key:1,class:"detail-item"},dn={class:"detail-item"},cn={class:"detail-item"},pn={class:"detail-section"},fn={class:"detail-grid"},vn={key:0,class:"detail-item full-width"},mn={key:1,class:"detail-item full-width"},gn={class:"detail-item"},hn={class:"detail-item"},yn={style:{display:"flex","align-items":"center",gap:"8px"}},_n={key:0,class:"snapshot-badge success"},bn={key:1,class:"snapshot-badge warning"},$n={class:"detail-item"},Tn={key:2,class:"detail-item"},kn={key:0,class:"detail-section"},Cn={class:"detail-grid"},wn={class:"detail-item"},Sn={class:"detail-item"},In={class:"detail-item"},Rn={class:"detail-section"},Pn={class:"model-configs"},En={class:"config-header"},Vn=["src","alt"],An={class:"provider-name"},Fn={class:"config-details"},xn={class:"config-item"},Ln={class:"config-params"},Dn={class:"param-list"},On={key:0,class:"config-item"},Mn={class:"cost"},Un=le({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(l){const t=l,s=j(!1),d=U(()=>{const A=t.trial.started||t.trial.created,v=(t.trial.completed||new Date).getTime()-A.getTime(),F=Math.floor(v/(1e3*60*60)),u=Math.floor(v%(1e3*60*60)/(1e3*60));return F>0?`${F}h ${u}m`:`${u}m`}),p=U(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[t.trial.status]||t.trial.status),r=U(()=>t.trial.type==="template"&&t.trial.templateConfig?.variables?Object.keys(t.trial.templateConfig.variables).length:0),f=U(()=>Math.round(t.trial.progress.total*750)),k=U(()=>t.trial.type==="template"&&t.trial.templateConfig?t.trial.templateConfig.hasSnapshots===!0:!1),S=U(()=>"text"),o=U(()=>1),C=U(()=>t.trial.progress.total/o.value);function T(A){return A?new Date(A).toLocaleString():"N/A"}function h(){if(t.trial.templateConfig?.templateName)return t.trial.templateConfig.templateName;const A=t.trial.templateConfig?.template||"Unknown Template";return A.length>50?A.substring(0,50)+"...":A}function P(){return t.trial.spreadsheetConfig?.datasetId||"Unknown Dataset"}function _(A){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[A]||A}function b(A){}async function x(){try{Y.info("Migration feature coming soon"),s.value=!1}catch(A){Y.error("Failed to migrate trial"),V.error("Migration error:",A)}}function W(A){const c=A.modelSnapshot;return c?.capabilities?.inputCostPerToken?`$${((c.capabilities.inputCostPerToken+c.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(A,c)=>{const v=pe;return n(),i("div",sn,[e("div",{class:"detail-header",onClick:c[0]||(c[0]=F=>A.$emit("toggle-collapse"))},[c[3]||(c[3]=e("h3",null,"Trial Details",-1)),w(z(ws),{class:se(["collapse-icon",{rotated:A.isCollapsed}])},null,8,["class"])]),A.isCollapsed?R("",!0):(n(),i("div",an,[e("div",ln,[c[9]||(c[9]=e("h4",null,"Basic Information",-1)),e("div",nn,[e("div",on,[c[4]||(c[4]=e("label",null,"Created:",-1)),e("span",null,y(T(A.trial.created)),1)]),A.trial.started?(n(),i("div",rn,[c[5]||(c[5]=e("label",null,"Started:",-1)),e("span",null,y(T(A.trial.started)),1)])):R("",!0),A.trial.completed?(n(),i("div",un,[c[6]||(c[6]=e("label",null,"Completed:",-1)),e("span",null,y(T(A.trial.completed)),1)])):R("",!0),e("div",dn,[c[7]||(c[7]=e("label",null,"Duration:",-1)),e("span",null,y(d.value),1)]),e("div",cn,[c[8]||(c[8]=e("label",null,"Status:",-1)),e("span",null,y(A.trial.status)+" - "+y(p.value),1)])])]),e("div",pn,[c[19]||(c[19]=e("h4",null,"Configuration",-1)),e("div",fn,[A.trial.type==="template"?(n(),i("div",vn,[c[10]||(c[10]=e("label",null,"Template:",-1)),e("span",null,y(h()),1)])):R("",!0),A.trial.type==="spreadsheet"?(n(),i("div",mn,[c[11]||(c[11]=e("label",null,"Dataset:",-1)),e("span",null,y(P()),1)])):R("",!0),e("div",gn,[c[12]||(c[12]=e("label",null,"Variable Lists:",-1)),e("span",null,y(r.value)+" lists",1)]),e("div",hn,[c[16]||(c[16]=e("label",null,"Data Snapshot:",-1)),e("div",yn,[k.value?(n(),i("span",_n,[w(z(wt)),c[13]||(c[13]=D(" Captured "))])):(n(),i("span",bn,[w(z(Ce)),c[14]||(c[14]=D(" Live Reference "))])),A.trial.type==="template"?(n(),Q(v,{key:2,size:"small",type:"link",onClick:c[1]||(c[1]=F=>s.value=!0)},{default:E(()=>[w(z(St)),c[15]||(c[15]=D(" Debug "))]),_:1,__:[15]})):R("",!0)])]),e("div",$n,[c[17]||(c[17]=e("label",null,"Token Estimate:",-1)),e("span",null,"~"+y(f.value)+" tokens",1)]),S.value?(n(),i("div",Tn,[c[18]||(c[18]=e("label",null,"Output Type:",-1)),e("span",{class:se(["output-type",`type-${S.value}`])},y(S.value),3)])):R("",!0)])]),o.value>1?(n(),i("div",kn,[c[23]||(c[23]=e("h4",null,"Repeat Configuration",-1)),e("div",Cn,[e("div",wn,[c[20]||(c[20]=e("label",null,"Times per prompt:",-1)),e("span",null,y(o.value),1)]),e("div",Sn,[c[21]||(c[21]=e("label",null,"Total combinations:",-1)),e("span",null,y(C.value),1)]),e("div",In,[c[22]||(c[22]=e("label",null,"Total API calls:",-1)),e("span",null,y(A.trial.progress.total),1)])])])):R("",!0),e("div",Rn,[c[27]||(c[27]=e("h4",null,"Model Configurations",-1)),e("div",Pn,[(n(!0),i(Z,null,te(A.trial.configurations,(F,u)=>(n(),i("div",{key:u,class:"model-config-card"},[e("div",En,[(F.provider,void 0)?(n(),i("img",{key:0,src:(F.provider,void 0),alt:F.provider,class:"provider-logo"},null,8,Vn)):R("",!0),e("span",An,y(_(F.provider)),1)]),e("div",Fn,[e("div",xn,[c[24]||(c[24]=e("label",null,"Model:",-1)),e("span",null,y(F.modelId),1)]),e("div",Ln,[c[25]||(c[25]=e("label",null,"Parameters:",-1)),e("div",Dn,[(n(!0),i(Z,null,te(F.parameters,(g,K)=>(n(),i("span",{key:K,class:"param-tag"},y(K)+": "+y(g),1))),128))])]),W(F)?(n(),i("div",On,[c[26]||(c[26]=e("label",null,"Est. Cost:",-1)),e("span",Mn,y(W(F)),1)])):R("",!0)])]))),128))])])])),s.value?(n(),Q(tn,{key:1,visible:s.value,trial:A.trial,onClose:c[2]||(c[2]=F=>s.value=!1),onMigrate:x},null,8,["visible","trial"])):R("",!0)])}}}),Nn=ae(Un,[["__scopeId","data-v-a5e15d0c"]]),Wn={class:"filter-bar"},zn={class:"search-container"},Hn=le({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns","openPostProcessing"],setup(l,{emit:t}){const s=l,d=t,p=U(()=>{const o=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"postProcessedResponse",label:"Post-Processed"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return s.showRepeatColumn&&o.splice(2,0,{key:"repeat",label:"Repeat Index"}),o}),r=U(()=>{const o={total:s.apiCalls.length,completed:0,failed:0,running:0,pending:0};return s.apiCalls.forEach(C=>{C.status==="completed"?o.completed++:C.status==="failed"?o.failed++:C.status==="running"?o.running++:C.status==="pending"&&o.pending++}),o});function f(o){return o.modelSnapshot?.displayName||`${o.provider} - ${o.modelId}`}const k=At(o=>{const C=o.target.value;d("update:searchQuery",C)},300);function S(o){const C=[...s.visibleColumns],T=C.indexOf(o);if(T>-1)C.splice(T,1);else{const h=p.value.map(b=>b.key),P=h.indexOf(o);let _=0;for(let b=0;b<P;b++)C.includes(h[b])&&_++;C.splice(_,0,o)}d("update:visibleColumns",C)}return(o,C)=>{const T=Is,h=Ss,P=It,_=pe,b=Rt,x=Ze,W=Xe,A=Ye;return n(),i("div",Wn,[w(h,{value:o.statusFilter,onChange:C[0]||(C[0]=c=>o.$emit("update:statusFilter",c)),placeholder:"Filter by status",style:{width:"150px"}},{default:E(()=>[w(T,{value:"all"},{default:E(()=>[D(" All ("+y(r.value.total)+") ",1)]),_:1}),w(T,{value:"completed"},{default:E(()=>[D(" Completed ("+y(r.value.completed)+") ",1)]),_:1}),w(T,{value:"failed"},{default:E(()=>[D(" Failed ("+y(r.value.failed)+") ",1)]),_:1}),w(T,{value:"running"},{default:E(()=>[D(" Running ("+y(r.value.running)+") ",1)]),_:1}),w(T,{value:"pending"},{default:E(()=>[D(" Pending ("+y(r.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),w(h,{value:o.configFilter,onChange:C[1]||(C[1]=c=>o.$emit("update:configFilter",c)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:E(()=>[w(T,{value:""},{default:E(()=>C[3]||(C[3]=[D("All Configurations")])),_:1,__:[3]}),(n(!0),i(Z,null,te(o.configurations,(c,v)=>(n(),Q(T,{key:v,value:v.toString()},{default:E(()=>[D(y(f(c)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),e("div",zn,[w(P,{value:o.searchQuery,onInput:z(k),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:E(()=>[w(z(bt))]),_:1},8,["value","onInput"])]),w(A,null,{overlay:E(()=>[w(W,null,{default:E(()=>[(n(!0),i(Z,null,te(p.value,c=>(n(),Q(x,{key:c.key},{default:E(()=>[w(b,{checked:o.visibleColumns.includes(c.key),disabled:c.key==="status",onChange:v=>S(c.key)},{default:E(()=>[D(y(c.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:E(()=>[w(_,null,{default:E(()=>[w(z(Rs)),C[4]||(C[4]=D(" Columns "))]),_:1,__:[4]})]),_:1}),w(_,{type:"primary",onClick:C[2]||(C[2]=c=>o.$emit("openPostProcessing"))},{default:E(()=>[w(z(Pt)),C[5]||(C[5]=D(" Post-Process "))]),_:1,__:[5]})])}}}),Bn=ae(Hn,[["__scopeId","data-v-e6112af3"]]),jn={class:"modal-content"},qn={class:"section"},Gn={class:"info-grid"},Kn={class:"info-item"},Jn={class:"monospace"},Qn={class:"info-item"},Yn={class:"info-item"},Xn={key:0,class:"info-item"},Zn={class:"info-item"},eo={key:1,class:"info-item"},to={key:2,class:"info-item"},so={key:3,class:"info-item"},ao={key:0,class:"info-row"},lo={class:"monospace"},no={key:0,class:"section"},oo={class:"variables-list"},io={class:"variable-main"},ro={class:"variable-label"},uo={class:"variable-value"},co={key:0,class:"variable-attributes"},po={class:"attribute-label"},fo={class:"attribute-value"},vo={class:"section"},mo={class:"content-box prompt-display"},go={key:1,class:"section"},ho={key:0,class:"error-result"},yo={key:1,class:"success-result"},_o={class:"content-box response-content"},bo={key:0,class:"parsed-content-section"},$o={class:"content-box parsed-content"},To={key:1,class:"post-processed-section"},ko={class:"content-box post-processed-content"},Co={key:2,class:"refusal-warning"},wo={key:3,class:"refusal-warning"},So={class:"extraction-config-section"},Io={class:"config-grid"},Ro={key:0,class:"config-item"},Po={class:"config-value"},Eo={key:1,class:"config-item"},Vo={class:"config-value pattern"},Ao={key:2,class:"config-item"},Fo={class:"config-value"},xo={key:3,class:"config-item"},Lo={class:"config-value"},Do={key:4,class:"config-item no-extraction"},Oo={key:4,class:"post-processing-config-section"},Mo={class:"config-grid"},Uo={class:"config-item post-processing-item"},No={class:"config-value"},Wo={key:0,class:"config-item post-processing-item"},zo={class:"config-value"},Ho={key:1,class:"config-item post-processing-item"},Bo={class:"config-value pattern"},jo={key:2,class:"config-item post-processing-item"},qo={class:"config-value"},Go={key:3,class:"config-item post-processing-item"},Ko={class:"config-value"},Jo={key:4,class:"config-item post-processing-item"},Qo={class:"config-value"},Yo={key:5,class:"usage-info"},Xo={class:"info-grid"},Zo={class:"info-item"},ei={class:"info-item"},ti={class:"info-item"},si={key:0,class:"info-item"},ai={class:"raw-data-section"},li={class:"raw-data"},ni={key:0},oi={key:1,class:"raw-data"},ii={key:2},ri={key:3,class:"raw-data"},ui={class:"modal-footer"},di=le({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(l,{emit:t}){const s=l,d=t,p=Je(),r=U(()=>{if(!s.apiCall.completed||!s.apiCall.created)return null;const u=new Date(s.apiCall.created).getTime();return new Date(s.apiCall.completed).getTime()-u}),f=U(()=>{const u=s.trial.configurations[s.apiCall.configurationIndex];return u?`${u.provider} / ${u.modelId}`:null}),k=U(()=>{if(!s.apiCall.result?.usage)return null;const u=s.trial.configurations[s.apiCall.configurationIndex];if(!u)return null;const g=p.models.value.find(L=>L.provider===u.provider&&L.modelId===u.modelId);if(!g?.capabilities?.inputCostPerToken&&!g?.capabilities?.outputCostPerToken)return null;const K=(s.apiCall.result.usage.prompt_tokens||0)*(g.capabilities.inputCostPerToken||0),X=(s.apiCall.result.usage.completion_tokens||0)*(g.capabilities.outputCostPerToken||0);return K+X}),S=U(()=>{if(!s.apiCall.request)return"No request data";const u=JSON.parse(JSON.stringify(s.apiCall.request));return u.headers&&Object.keys(u.headers).forEach(g=>{(g.toLowerCase().includes("authorization")||g.toLowerCase().includes("api-key")||g.toLowerCase().includes("x-api-key"))&&(u.headers[g]="[REDACTED]")}),u.body&&typeof u.body=="object"&&(u.body.api_key&&(u.body.api_key="[REDACTED]"),u.body.apiKey&&(u.body.apiKey="[REDACTED]")),JSON.stringify(u,null,2)}),o=U(()=>s.trial.type!=="template"||!s.trial.templateConfig?{}:{outputType:s.trial.templateConfig.outputType,extractPattern:s.trial.templateConfig.extractPattern,refusalWords:s.trial.templateConfig.refusalWords,rejectRefusalWords:s.trial.templateConfig.rejectRefusalWords}),C=U(()=>{const u=o.value;return!!(u.outputType||u.extractPattern||u.refusalWords&&u.refusalWords.length>0)}),T=U(()=>s.trial.postProcessingConfig||null),h=U(()=>s.apiCall.response?JSON.stringify({status:s.apiCall.response.status,headers:s.apiCall.response.headers,body:s.apiCall.response.body,latencyMs:s.apiCall.response.latencyMs},null,2):"No response data available"),P=U(()=>s.apiCall.result?JSON.stringify(s.apiCall.result,null,2):"No processed result available");function _(u){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[u]||"default"}function b(){const u=s.trial.configurations[s.apiCall.configurationIndex];return u?.modelSnapshot?.displayName||u?.modelId||`Configuration ${s.apiCall.configurationIndex+1}`}function x(u){return(typeof u=="string"?new Date(u):u).toLocaleString()}function W(u){return u<1e3?`${u}ms`:u<6e4?`${(u/1e3).toFixed(1)}s`:`${Math.floor(u/6e4)}m ${(u%6e4/1e3).toFixed(0)}s`}function A(u){return u==null?"null":typeof u=="string"?u:typeof u=="number"||typeof u=="boolean"?String(u):JSON.stringify(u,null,2)}function c(u){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[u]||u}function v(){d("update:visible",!1)}async function F(){const u={id:s.apiCall.id,status:s.apiCall.status,configuration:b(),provider:f.value,variables:s.apiCall.variables,variableAttributes:s.apiCall.variableAttributes,prompt:s.apiCall.prompt,fullApiResponse:s.apiCall.response,processedResult:s.apiCall.result,extractionConfig:o.value,postProcessingConfig:T.value,created:s.apiCall.created,completed:s.apiCall.completed,duration:r.value?`${r.value}ms`:null,cost:k.value?`$${k.value.toFixed(4)}`:null},g=JSON.stringify(u,null,2);try{await navigator.clipboard.writeText(g),Y.success("Details copied to clipboard!")}catch(K){V.error("Failed to copy to clipboard",K),Y.error("Failed to copy to clipboard")}}return(u,g)=>{const K=tt,X=Le,L=Es,a=Ps,m=pe,I=be;return n(),Q(I,{open:u.visible,onCancel:g[0]||(g[0]=H=>d("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:E(()=>[e("div",jn,[e("div",qn,[g[10]||(g[10]=e("h3",null,"Overview",-1)),e("div",Gn,[e("div",Kn,[g[1]||(g[1]=e("label",null,"Call ID:",-1)),e("span",Jn,y(u.apiCall.id),1)]),e("div",Qn,[g[2]||(g[2]=e("label",null,"Status:",-1)),w(K,{color:_(u.apiCall.status)},{default:E(()=>[D(y(u.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),e("div",Yn,[g[3]||(g[3]=e("label",null,"Configuration:",-1)),e("span",null,y(b()),1)]),u.apiCall.repeatIndex!==void 0?(n(),i("div",Xn,[g[4]||(g[4]=e("label",null,"Repeat:",-1)),e("span",null,"#"+y(u.apiCall.repeatIndex+1),1)])):R("",!0),e("div",Zn,[g[5]||(g[5]=e("label",null,"Created:",-1)),e("span",null,y(x(u.apiCall.created)),1)]),u.apiCall.completed?(n(),i("div",eo,[g[6]||(g[6]=e("label",null,"Completed:",-1)),e("span",null,y(x(u.apiCall.completed)),1)])):R("",!0),r.value?(n(),i("div",to,[g[7]||(g[7]=e("label",null,"Duration:",-1)),e("span",null,y(W(r.value)),1)])):R("",!0),u.apiCall.result?.latency?(n(),i("div",so,[g[8]||(g[8]=e("label",null,"API Latency:",-1)),e("span",null,y(u.apiCall.result.latency)+"ms",1)])):R("",!0)]),f.value?(n(),i("div",ao,[g[9]||(g[9]=e("label",null,"Provider/Model:",-1)),e("span",lo,y(f.value),1)])):R("",!0)]),u.apiCall.variables&&Object.keys(u.apiCall.variables).length>0?(n(),i("div",no,[g[11]||(g[11]=e("h3",null,"Variables",-1)),e("div",oo,[(n(!0),i(Z,null,te(u.apiCall.variables,(H,M)=>(n(),i("div",{key:M,class:"variable-group"},[e("div",io,[e("label",ro,y(M)+":",1),e("span",uo,y(H),1)]),u.apiCall.variableAttributes&&u.apiCall.variableAttributes[M]?(n(),i("div",co,[(n(!0),i(Z,null,te(u.apiCall.variableAttributes[M],(G,N)=>(n(),i("div",{key:N,class:"attribute-item"},[e("label",po,y(N)+":",1),e("span",fo,y(G),1)]))),128))])):R("",!0)]))),128))])])):R("",!0),e("div",vo,[g[12]||(g[12]=e("h3",null,"Resolved Prompt",-1)),e("div",mo,y(u.apiCall.prompt),1)]),u.apiCall.result?(n(),i("div",go,[g[34]||(g[34]=e("h3",null,"Response",-1)),u.apiCall.status==="failed"&&u.apiCall.result.error?(n(),i("div",ho,[w(X,{type:"error",message:u.apiCall.result.error,description:u.apiCall.result.errorType?`Error Type: ${c(u.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):u.apiCall.result.content?(n(),i("div",yo,[e("div",_o,y(u.apiCall.result.content),1),u.apiCall.result.parsedContent!==void 0?(n(),i("div",bo,[g[13]||(g[13]=e("h4",null,"Extracted Value (Original)",-1)),e("div",$o,y(A(u.apiCall.result.parsedContent)),1)])):R("",!0),u.apiCall.result.postParsedContent!==void 0?(n(),i("div",To,[g[14]||(g[14]=e("h4",null,"Post-Processed Value",-1)),e("div",ko,y(A(u.apiCall.result.postParsedContent)),1)])):R("",!0),u.apiCall.result.refused?(n(),i("div",Co,[w(X,{type:"warning",message:"Response flagged as refusal (Original Extraction)",description:"This response matched configured refusal patterns","show-icon":""})])):R("",!0),u.apiCall.result.postRefused?(n(),i("div",wo,[w(X,{type:"warning",message:"Response flagged as refusal (Post-Processing)",description:"This response matched post-processing refusal patterns","show-icon":""})])):R("",!0),e("div",So,[g[20]||(g[20]=e("h4",null,"Original Extraction Configuration",-1)),e("div",Io,[o.value.outputType?(n(),i("div",Ro,[g[15]||(g[15]=e("label",null,"Output Type:",-1)),e("span",Po,y(o.value.outputType),1)])):R("",!0),o.value.extractPattern?(n(),i("div",Eo,[g[16]||(g[16]=e("label",null,"Extract Pattern:",-1)),e("span",Vo,y(o.value.extractPattern),1)])):R("",!0),o.value.refusalWords&&o.value.refusalWords.length>0?(n(),i("div",Ao,[g[17]||(g[17]=e("label",null,"Refusal Words:",-1)),e("span",Fo,y(o.value.refusalWords.join(", ")),1)])):R("",!0),o.value.rejectRefusalWords!==void 0?(n(),i("div",xo,[g[18]||(g[18]=e("label",null,"Reject on Refusal:",-1)),e("span",Lo,y(o.value.rejectRefusalWords?"Yes":"No"),1)])):R("",!0),C.value?R("",!0):(n(),i("div",Do,g[19]||(g[19]=[e("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),T.value&&T.value.enabled?(n(),i("div",Oo,[g[28]||(g[28]=e("h4",null,"Post-Processing Configuration",-1)),e("div",Mo,[e("div",Uo,[g[22]||(g[22]=e("label",null,"Status:",-1)),e("span",No,[w(K,{color:"processing"},{default:E(()=>g[21]||(g[21]=[D("Enabled")])),_:1,__:[21]})])]),T.value.outputType?(n(),i("div",Wo,[g[23]||(g[23]=e("label",null,"Output Type:",-1)),e("span",zo,y(T.value.outputType),1)])):R("",!0),T.value.extractPattern?(n(),i("div",Ho,[g[24]||(g[24]=e("label",null,"Extract Pattern:",-1)),e("span",Bo,y(T.value.extractPattern),1)])):R("",!0),T.value.refusalWords&&T.value.refusalWords.length>0?(n(),i("div",jo,[g[25]||(g[25]=e("label",null,"Refusal Words:",-1)),e("span",qo,y(T.value.refusalWords.join(", ")),1)])):R("",!0),T.value.rejectRefusalWords!==void 0?(n(),i("div",Go,[g[26]||(g[26]=e("label",null,"Reject on Refusal:",-1)),e("span",Ko,y(T.value.rejectRefusalWords?"Yes":"No"),1)])):R("",!0),T.value.updatedAt?(n(),i("div",Jo,[g[27]||(g[27]=e("label",null,"Last Updated:",-1)),e("span",Qo,y(x(T.value.updatedAt)),1)])):R("",!0)])])):R("",!0),u.apiCall.result.usage?(n(),i("div",Yo,[g[33]||(g[33]=e("h4",null,"Token Usage",-1)),e("div",Xo,[e("div",Zo,[g[29]||(g[29]=e("label",null,"Prompt Tokens:",-1)),e("span",null,y(u.apiCall.result.usage.prompt_tokens||0),1)]),e("div",ei,[g[30]||(g[30]=e("label",null,"Completion Tokens:",-1)),e("span",null,y(u.apiCall.result.usage.completion_tokens||0),1)]),e("div",ti,[g[31]||(g[31]=e("label",null,"Total Tokens:",-1)),e("span",null,y(u.apiCall.result.usage.total_tokens||0),1)]),k.value?(n(),i("div",si,[g[32]||(g[32]=e("label",null,"Cost:",-1)),e("span",null,"$"+y(k.value.toFixed(4)),1)])):R("",!0)])])):R("",!0)])):R("",!0)])):R("",!0),w(a,{ghost:""},{default:E(()=>[w(L,{key:"raw",header:"Raw Data"},{default:E(()=>[e("div",ai,[g[35]||(g[35]=e("h4",null,"HTTP Request",-1)),e("pre",li,y(S.value),1),u.apiCall.response?(n(),i("h4",ni,"Full API Response")):R("",!0),u.apiCall.response?(n(),i("pre",oi,y(h.value),1)):R("",!0),u.apiCall.result?(n(),i("h4",ii,"Processed Result")):R("",!0),u.apiCall.result?(n(),i("pre",ri,y(P.value),1)):R("",!0)])]),_:1})]),_:1})]),e("div",ui,[w(m,{onClick:v,size:"large"},{default:E(()=>g[36]||(g[36]=[D(" Close ")])),_:1,__:[36]}),w(m,{type:"primary",onClick:F,size:"large"},{default:E(()=>[w(z(et)),g[37]||(g[37]=D(" Copy Details "))]),_:1,__:[37]})])]),_:1},8,["open"])}}}),ci=ae(di,[["__scopeId","data-v-61b8259f"]]);class pi{constructor(){de(this,"apiCalls",Pe([]));de(this,"currentTrialId",Pe(null));de(this,"executionProgress",Pe(null));de(this,"isStreaming",Pe(!1));de(this,"progress",U(()=>{const t=performance.now(),s=this.apiCalls.value;if(s.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let d=0,p=0,r=0,f=0,k=0;`${s.length}`;for(const C of s)switch(C.status){case"completed":d++;break;case"failed":p++,C.result?.error?.includes("network");break;case"cancelled":r++;break;case"pending":f++;break;case"running":k++;break}const S=performance.now(),o={trialId:this.currentTrialId.value||"",total:s.length,completed:d,failed:p,cancelled:r,pending:f,running:k,lastUpdated:new Date};return`${(S-t).toFixed(1)}${d}${s.length}${k}${f}`,`${d}${p}${k}${f}${s.length}`,o}));de(this,"pivotData",U(()=>{const t=performance.now(),s=this.apiCalls.value,d={rows:[],columns:[],cells:new Map};if(s.length===0)return d;const p=new Set,r=new Set;for(const k of s){if(k.status!=="completed")continue;const S=`Config ${k.configurationIndex}`;p.add(S);const o=Object.keys(k.variables||{}),C=o.length>0?String(k.variables[o[0]]):"default";r.add(C),d.cells.has(S)||d.cells.set(S,new Map);const T=d.cells.get(S);T.has(C)||T.set(C,[]),T.get(C).push(k)}d.rows=Array.from(p).sort(),d.columns=Array.from(r).sort();const f=performance.now();return`${s.length}${(f-t).toFixed(1)}`,d}));de(this,"stats",U(()=>{const t=performance.now(),s=this.apiCalls.value,d=s.length;if(d===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let p=0,r=0,f=0,k=0,S=0,o=0;for(const T of s)switch(T.status){case"completed":p++,T.response?.latencyMs&&(S+=T.response.latencyMs,o++);break;case"failed":r++;break;case"pending":f++;break;case"running":k++;break}const C=performance.now();return`${s.length}${(C-t).toFixed(1)}`,{total:d,completed:p,failed:r,pending:f,running:k,avgLatency:o>0?S/o:0,errorRate:d>0?r/d*100:0}}))}updateApiCalls(t){for(const s of t)switch(s.status){}this.apiCalls.value=Object.freeze(t)}updateProgress(t){t.type,this.executionProgress.value=t}setStreaming(t){this.isStreaming.value=t}setCurrentTrial(t){this.currentTrialId.value=t,t||this.clear()}clear(){this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(t){try{const s=await ze.apiCalls.where("trialId").equals(t).toArray();`${s.length}`,s.sort((d,p)=>{const r=S=>{switch(S){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},f=r(d.status),k=r(p.status);return f!==k?f-k:d.order-p.order}),this.updateApiCalls(s),this.setCurrentTrial(t)}catch(s){throw V.error("STORE_V4: Failed to refresh from database:",s),s}}}let Ae=null;function Ie(){return Ae||(Ae=new pi),Ae}typeof window<"u"&&(window.__trialDataStoreV4=()=>Ae);const fi={class:"post-processing-modal"},vi={key:2,class:"current-extraction"},mi={class:"parser-info"},gi={class:"parser-name"},hi={key:0,class:"test-results"},yi={key:1,class:"statistics"},_i={class:"stat-item"},bi={class:"stat-value"},$i={class:"stat-item"},Ti={class:"stat-value"},ki={class:"stat-item"},Ci={class:"stat-value"},wi={class:"stat-item"},Si={class:"stat-value"},Ii={class:"modal-actions"},Ri=le({__name:"PostProcessingModalV2",props:{visible:{type:Boolean},trial:{}},emits:["close"],setup(l,{emit:t}){const s=l,d=t,p=Ie(),r=Hs(),f=j(s.visible),k=j(!1),S=j(!1),o=j(!1),C=j(null),T=j({enabled:!1,postParserId:null}),h=j([]),P=j(null),_=[{title:"Variables",dataIndex:"variables",key:"variables",width:200,customRender:({text:a})=>Object.entries(a).map(([m,I])=>`${m}: ${I}`).join(", ")},{title:"Original",dataIndex:"original",key:"original",slots:{customRender:"original"}},{title:"Post-Processed",dataIndex:"postProcessed",key:"postProcessed",slots:{customRender:"postProcessed"}},{title:"Changed",dataIndex:"changed",key:"changed",width:100,slots:{customRender:"changed"}}],b=U(()=>s.trial.parserId?r.parsers.find(a=>a.id===s.trial.parserId):null);function x(a){switch(a){case"regex":return"blue";case"javascript":return"orange";case"python":return"green";default:return"default"}}function W(a){return a===void 0?"(no match)":a===null?"null":typeof a=="string"&&a.length>50?a.substring(0,50)+"...":String(a)}function A(a){a||(h.value=[],P.value=null)}function c(){S.value=!0}function v(a){C.value=a,o.value=!0}async function F(a,m){if(!a||!m){h.value=[],P.value=null;return}await u(m),await g(m)}async function u(a){const m=p.apiCalls.value.filter(H=>H.result?.content).slice(0,10),I=[];for(const H of m){const M=await at.executeParser(H.result.content,a);I.push({id:H.id,variables:H.variables,original:H.result.parsedContent,postProcessed:M.success?M.value:null,changed:M.success&&M.value!==H.result.parsedContent})}h.value=I}async function g(a){if(!p.apiCalls.value.length){P.value=null;return}const m=p.apiCalls.value,I=m.length,H=m.filter(N=>N.result?.content).length;let M=0,G=0;for(const N of m){if(!N.result?.content)continue;const $=await at.executeParser(N.result.content,a);$.success&&$.value!==void 0&&(M++,$.value!==N.result.parsedContent&&G++)}P.value={total:I,withContent:H,matches:M,changed:G}}async function K(){k.value=!0;try{const a=await ot.updatePostParserId(s.trial.id,null,!1);if(a.ok)T.value.enabled=!1,T.value.postParserId=null,Y.success("Post-processing disabled"),await p.refreshFromDatabase(s.trial.id);else throw a.error}catch(a){V.error("Failed to reset post-processing:",a),Y.error("Failed to reset post-processing")}finally{k.value=!1}}async function X(){if(!T.value.enabled){Y.warning("Please enable post-processing");return}if(!T.value.postParserId){Y.warning("Please select a parser");return}k.value=!0;try{const a=p.apiCalls.value.some(H=>H.status==="completed"&&H.result?.content),m=a&&await new Promise(H=>{H(a?confirm("Apply post-processing to existing completed calls?"):!1)}),I=await ot.updatePostParserId(s.trial.id,T.value.postParserId,m);if(I.ok)Y.success(m?"Post-processing applied to all calls":"Post-processing will apply to future calls"),await p.refreshFromDatabase(s.trial.id),L();else throw I.error}catch(a){V.error("Failed to apply post-processing:",a),Y.error("Failed to apply post-processing")}finally{k.value=!1}}function L(){d("close")}return ce(async()=>{if(await r.initialize(),s.trial.postParserId){T.value.enabled=!0,T.value.postParserId=s.trial.postParserId;const a=r.parsers.find(m=>m.id===s.trial.postParserId);a&&(await u(a),await g(a))}else s.trial.postProcessingConfig?.enabled&&(T.value.enabled=!0,Y.info("Legacy post-processing config detected. Please select a parser to continue."))}),oe(()=>s.visible,a=>{f.value=a}),oe(f,a=>{a||d("close")}),(a,m)=>{const I=Le,H=tt,M=Fs,G=As,N=xs,$=Ds,q=Ls,J=pe,ne=Vs,re=be;return n(),Q(re,{visible:f.value,"onUpdate:visible":m[2]||(m[2]=ue=>f.value=ue),title:"Post-Process Extraction",width:"80%",footer:null,onCancel:L},{default:E(()=>[e("div",fi,[a.trial.status==="running"?(n(),Q(I,{key:0,message:"Trial is currently running",description:"Post-processing will apply to all completed calls and future results as they arrive.",type:"info","show-icon":"",style:{"margin-bottom":"20px"}})):a.trial.status==="draft"?(n(),Q(I,{key:1,message:"Trial not started",description:"Configure post-processing now. It will apply when the trial runs.",type:"warning","show-icon":"",style:{"margin-bottom":"20px"}})):R("",!0),b.value?(n(),i("div",vi,[m[3]||(m[3]=e("h4",null,"Current Primary Parser",-1)),e("div",mi,[e("span",gi,y(b.value.name),1),w(H,{color:x(b.value.type)},{default:E(()=>[D(y(b.value.type),1)]),_:1},8,["color"]),w(H,null,{default:E(()=>[D(y(b.value.outputType),1)]),_:1})])])):R("",!0),w(ne,{model:T.value,layout:"vertical",onFinish:X},{default:E(()=>[w(G,{label:"Enable Post-Processing"},{default:E(()=>[w(M,{checked:T.value.enabled,"onUpdate:checked":m[0]||(m[0]=ue=>T.value.enabled=ue),onChange:A},{checkedChildren:E(()=>m[4]||(m[4]=[D("ON")])),unCheckedChildren:E(()=>m[5]||(m[5]=[D("OFF")])),_:1},8,["checked"])]),_:1}),w(G,{label:"Post-Processing Parser",disabled:!T.value.enabled},{default:E(()=>[w(zs,{modelValue:T.value.postParserId,"onUpdate:modelValue":m[1]||(m[1]=ue=>T.value.postParserId=ue),disabled:!T.value.enabled,"allow-create":!0,"show-preview":!0,placeholder:"Select or create a parser for post-processing",onCreate:c,onTest:v,onChange:F},null,8,["modelValue","disabled"])]),_:1},8,["disabled"]),h.value.length>0&&T.value.enabled?(n(),i("div",hi,[m[6]||(m[6]=e("h4",null,"Preview Results (First 10 calls)",-1)),w(N,{columns:_,"data-source":h.value,pagination:!1,size:"small",scroll:{x:800}},{original:E(({text:ue})=>[e("code",null,y(W(ue)),1)]),postProcessed:E(({text:ue,record:Me})=>[e("code",{class:se({"value-changed":Me.changed})},y(W(ue)),3)]),changed:E(({text:ue})=>[w(H,{color:ue?"green":"default"},{default:E(()=>[D(y(ue?"Changed":"Same"),1)]),_:2},1032,["color"])]),_:1},8,["data-source"])])):R("",!0),P.value&&T.value.enabled?(n(),i("div",yi,[w(q,{gutter:16},{default:E(()=>[w($,{span:6},{default:E(()=>[e("div",_i,[m[7]||(m[7]=e("div",{class:"stat-label"},"Total Calls",-1)),e("div",bi,y(P.value.total),1)])]),_:1}),w($,{span:6},{default:E(()=>[e("div",$i,[m[8]||(m[8]=e("div",{class:"stat-label"},"With Content",-1)),e("div",Ti,y(P.value.withContent),1)])]),_:1}),w($,{span:6},{default:E(()=>[e("div",ki,[m[9]||(m[9]=e("div",{class:"stat-label"},"Matches",-1)),e("div",Ci,y(P.value.matches),1)])]),_:1}),w($,{span:6},{default:E(()=>[e("div",wi,[m[10]||(m[10]=e("div",{class:"stat-label"},"Changed",-1)),e("div",Si,y(P.value.changed),1)])]),_:1})]),_:1})])):R("",!0),e("div",Ii,[w(J,{onClick:K,disabled:!T.value.enabled},{default:E(()=>m[11]||(m[11]=[D(" Reset ")])),_:1,__:[11]},8,["disabled"]),w(J,{onClick:L},{default:E(()=>m[12]||(m[12]=[D(" Cancel ")])),_:1,__:[12]}),w(J,{type:"primary","html-type":"submit",loading:k.value,disabled:!T.value.enabled||!T.value.postParserId},{default:E(()=>m[13]||(m[13]=[D(" Apply Post-Processing ")])),_:1,__:[13]},8,["loading","disabled"])])]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),Pi=ae(Ri,[["__scopeId","data-v-2ab953e4"]]),Ei={class:"trial-results-table"},Vi={class:"table-container"},Ai={class:"results-table"},Fi={key:0,class:"col-status"},xi={key:1,class:"col-configuration"},Li={key:2,class:"col-repeat"},Di={key:3,class:"col-variables"},Oi={key:4,class:"col-response"},Mi={key:5,class:"col-parsed"},Ui={key:6,class:"col-post-processed"},Ni={key:0,class:"post-process-indicator"},Wi={key:7,class:"col-length"},zi={key:8,class:"col-latency"},Hi={class:"results-table"},Bi=["onClick"],ji={key:0,class:"col-status"},qi={class:"status-cell"},Gi={class:"status-time"},Ki={key:1,class:"col-configuration"},Ji={key:2,class:"col-repeat"},Qi={key:3,class:"col-variables"},Yi={class:"variable-tags"},Xi={key:0,class:"var-item"},Zi={key:1,class:"var-item"},er={key:2},tr={key:3},sr={key:4,class:"col-response"},ar={class:"response-content"},lr={key:5,class:"col-parsed"},nr={key:6,class:"col-post-processed"},or={key:7,class:"col-length"},ir={key:8,class:"col-latency"},rr={key:1,class:"results-table"},ur={key:0,class:"col-status"},dr={key:1,class:"col-configuration"},cr={key:2,class:"col-repeat"},pr={key:3,class:"col-variables"},fr={key:4,class:"col-response"},vr={key:5,class:"col-parsed"},mr={key:6,class:"col-post-processed"},gr={key:0,class:"post-process-indicator"},hr={key:7,class:"col-length"},yr={key:8,class:"col-latency"},_r=["onClick"],br={key:0,class:"col-status"},$r={class:"status-cell"},Tr={class:"status-time"},kr={key:1,class:"col-configuration"},Cr={key:2,class:"col-repeat"},wr={key:3,class:"col-variables"},Sr={class:"variable-tags"},Ir={key:0,class:"var-item"},Rr={key:1,class:"var-item"},Pr={key:2},Er={key:3},Vr={key:4,class:"col-response"},Ar={class:"response-content"},Fr={key:5,class:"col-parsed"},xr={key:6,class:"col-post-processed"},Lr={key:7,class:"col-length"},Dr={key:8,class:"col-latency"},Or={key:0},Mr=["colspan"],Ur={key:0},Nr={key:1},ct="trial-results-visible-columns",Wr=le({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(l){const t=l,s=j("all"),d=j([]),p=j(""),r=j(["status","configuration","variables","response","parsedResponse","postProcessedResponse","length","latency"]),f=j(null),k=j(!1),S=Ie(),o=U(()=>S.apiCalls?.value||[]),C=U(()=>t.apiCalls||o.value);oe(C,(m,I)=>{const H=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${I?.length||0} to ${m.length} calls`),setTimeout(()=>{const M=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(M-H).toFixed(1)}ms`)},0)});const T=m=>{if(!p.value)return m;const I=p.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),H=new RegExp(`(${I})`,"gi");return m.replace(H,"<mark>$1</mark>")},h=U(()=>{const m=performance.now();let I=[...C.value];if(s.value!=="all"&&(I=I.filter(M=>M.status===s.value)),d.value.length>0&&(I=I.filter(M=>d.value.includes(String(M.configurationIndex)))),p.value){const M=p.value.toLowerCase();I=I.filter(G=>!!(G.prompt?.toLowerCase().includes(M)||G.result?.content?.toLowerCase().includes(M)||G.result?.error?.toLowerCase().includes(M)))}const H=performance.now();return V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${I.length} calls in ${(H-m).toFixed(1)}ms`),I});oe(h,(m,I)=>{const H=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${I?.length||0} to ${m.length} items`),setTimeout(()=>{const M=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(M-H).toFixed(1)}ms`)},0)});const P=U(()=>C.value),_=U(()=>C.value.length),b=U(()=>t.trial.configurations.some(m=>m.repeatCount>1)),x=U(()=>60);function W(m){}function A(m){const I=t.trial.configurations[m];return I?I.modelSnapshot?.displayName||`${I.modelId}`:`Config ${m+1}`}function c(m){return m.status==="pending"?"Waiting...":m.status==="running"?"Processing...":m.status==="failed"?m.result?.errorType==="refusal_detected"||m.result?.error==="REFUSED"?m.result?.content||"REFUSED":m.result?.error||"Error occurred":m.result?.content||""}function v(m){if(!m.result)return"";if(m.result.parsedContent!==void 0){const I=m.result.parsedContent;return I===null?"null":typeof I=="string"?I:typeof I=="number"||typeof I=="boolean"?String(I):JSON.stringify(I)}return""}function F(m){if(!m.result||m.result.postParsedContent===void 0)return"";const I=m.result.postParsedContent;return I===null?"null":I==="REFUSED"||m.result.postRefused?"REFUSED":typeof I=="string"?I:typeof I=="number"||typeof I=="boolean"?String(I):JSON.stringify(I)}function u(m){const I=m.result?.content||"";if(!I)return"";const H=I.length;return H>1e3?`${(H/1e3).toFixed(1)}k chars`:`${H} chars`}function g(m){return m?m<1e3?`${m}ms`:`${(m/1e3).toFixed(1)}s`:""}function K(m){let I;switch(m.status){case"completed":case"failed":I=m.completed;break;case"running":I=m.started;break;case"pending":case"cancelled":I=m.created;break}if(!I)return"";const H=new Date(I),M=H.getHours().toString().padStart(2,"0"),G=H.getMinutes().toString().padStart(2,"0"),N=H.getSeconds().toString().padStart(2,"0");return`  ${M}:${G}:${N}`}function X(m){return m?m<1e3?"latency-fast":m<5e3?"latency-medium":"latency-slow":""}function L(m){return T(m)}function a(m){f.value=m}return oe(r,m=>{localStorage.setItem(ct,JSON.stringify(m))},{deep:!0}),ce(()=>{const m=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${C.value.length} calls`);const I=localStorage.getItem(ct);if(I)try{r.value=JSON.parse(I)}catch{}_e(()=>{const H=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(H-m).toFixed(1)}ms`),setTimeout(()=>{const M=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(M-m).toFixed(1)}ms`)},100)}),setTimeout(()=>{const H=performance.now();V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(H-m).toFixed(1)}ms`)},0)}),we(()=>{V.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${C.value.length} calls`)}),Se(()=>{V.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),ge(()=>{V.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(m,I)=>{const H=mt("dompurify-html");return n(),i("div",Ei,[w(Bn,{"status-filter":s.value,"onUpdate:statusFilter":I[0]||(I[0]=M=>s.value=M),"config-filter":d.value,"onUpdate:configFilter":I[1]||(I[1]=M=>d.value=M),"search-query":p.value,"onUpdate:searchQuery":I[2]||(I[2]=M=>p.value=M),"visible-columns":r.value,"onUpdate:visibleColumns":I[3]||(I[3]=M=>r.value=M),configurations:m.trial.configurations,"api-calls":P.value,"show-repeat-column":b.value,onOpenPostProcessing:I[4]||(I[4]=M=>k.value=!0)},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),e("div",Vi,[_.value>100?(n(),Q(z(Oe),{key:0,class:"results-scroller",items:h.value,"item-size":x.value,"key-field":"id",buffer:10,onVisibleRange:W},{before:E(()=>[e("table",Ai,[e("thead",null,[e("tr",null,[r.value.includes("status")?(n(),i("th",Fi,"Status")):R("",!0),r.value.includes("configuration")?(n(),i("th",xi,"Configuration")):R("",!0),r.value.includes("repeat")&&b.value?(n(),i("th",Li,"Repeat")):R("",!0),r.value.includes("variables")?(n(),i("th",Di,"Variables")):R("",!0),r.value.includes("response")?(n(),i("th",Oi,"Response")):R("",!0),r.value.includes("parsedResponse")?(n(),i("th",Mi,"Parsed Response")):R("",!0),r.value.includes("postProcessedResponse")?(n(),i("th",Ui,[I[7]||(I[7]=D(" Post-Processed ")),m.trial.postProcessingConfig?.enabled?(n(),i("span",Ni,"✨")):R("",!0)])):R("",!0),r.value.includes("length")?(n(),i("th",Wi,"Length")):R("",!0),r.value.includes("latency")?(n(),i("th",zi,"Latency")):R("",!0)])])])]),default:E(({item:M})=>[e("table",Hi,[e("tbody",null,[e("tr",{class:se(["result-row",`status-${M.status}`]),onClick:G=>a(M)},[r.value.includes("status")?(n(),i("td",ji,[e("div",qi,[e("span",{class:se(["status-tag",`status-${M.status}`])},y(M.status.toUpperCase()),3),e("span",Gi,y(K(M)),1)])])):R("",!0),r.value.includes("configuration")?(n(),i("td",Ki,y(A(M.configurationIndex)),1)):R("",!0),r.value.includes("repeat")&&b.value?(n(),i("td",Ji," #"+y((M.repeatIndex||0)+1),1)):R("",!0),r.value.includes("variables")?(n(),i("td",Qi,[e("div",Yi,[(n(!0),i(Z,null,te(Object.entries(M.variables),([G,N],$)=>(n(),i(Z,{key:G},[I[9]||(I[9]=e("span",{class:"var-bullet"},"• ",-1)),Object.keys(M.variables).length<=2?(n(),i("span",Xi,y(G)+": "+y(N),1)):(n(),i("span",Zi,y(N),1)),Object.keys(M.variables).length===2&&$===0?(n(),i("span",er,I[8]||(I[8]=[e("br",null,null,-1)]))):$<Object.keys(M.variables).length-1?(n(),i("span",tr,y("  "))):R("",!0)],64))),128))])])):R("",!0),r.value.includes("response")?(n(),i("td",sr,[Te(e("div",ar,null,512),[[H,L(c(M)),"apiResponse"]])])):R("",!0),r.value.includes("parsedResponse")?(n(),i("td",lr,y(v(M)),1)):R("",!0),r.value.includes("postProcessedResponse")?(n(),i("td",nr,y(F(M)),1)):R("",!0),r.value.includes("length")?(n(),i("td",or,y(u(M)),1)):R("",!0),r.value.includes("latency")?(n(),i("td",ir,[e("span",{class:se(X(M.response?.latencyMs))},y(g(M.response?.latencyMs)),3)])):R("",!0)],10,Bi)])])]),_:1},8,["items","item-size"])):(n(),i("table",rr,[e("thead",null,[e("tr",null,[r.value.includes("status")?(n(),i("th",ur,"Status")):R("",!0),r.value.includes("configuration")?(n(),i("th",dr,"Configuration")):R("",!0),r.value.includes("repeat")&&b.value?(n(),i("th",cr,"Repeat")):R("",!0),r.value.includes("variables")?(n(),i("th",pr,"Variables")):R("",!0),r.value.includes("response")?(n(),i("th",fr,"Response")):R("",!0),r.value.includes("parsedResponse")?(n(),i("th",vr,"Parsed Response")):R("",!0),r.value.includes("postProcessedResponse")?(n(),i("th",mr,[I[10]||(I[10]=D(" Post-Processed ")),m.trial.postProcessingConfig?.enabled?(n(),i("span",gr,"✨")):R("",!0)])):R("",!0),r.value.includes("length")?(n(),i("th",hr,"Length")):R("",!0),r.value.includes("latency")?(n(),i("th",yr,"Latency")):R("",!0)])]),e("tbody",null,[(n(!0),i(Z,null,te(h.value,M=>(n(),i("tr",{key:M.id,class:se(["result-row",`status-${M.status}`]),onClick:G=>a(M)},[r.value.includes("status")?(n(),i("td",br,[e("div",$r,[e("span",{class:se(["status-tag",`status-${M.status}`])},y(M.status.toUpperCase()),3),e("span",Tr,y(K(M)),1)])])):R("",!0),r.value.includes("configuration")?(n(),i("td",kr,y(A(M.configurationIndex)),1)):R("",!0),r.value.includes("repeat")&&b.value?(n(),i("td",Cr," #"+y((M.repeatIndex||0)+1),1)):R("",!0),r.value.includes("variables")?(n(),i("td",wr,[e("div",Sr,[(n(!0),i(Z,null,te(M.variables,(G,N,$)=>(n(),i(Z,{key:N},[I[12]||(I[12]=e("span",{class:"var-bullet"},"• ",-1)),Object.keys(M.variables).length<=2?(n(),i("span",Ir,y(N)+": "+y(G),1)):(n(),i("span",Rr,y(G),1)),Object.keys(M.variables).length===2&&$===0?(n(),i("span",Pr,I[11]||(I[11]=[e("br",null,null,-1)]))):$<Object.keys(M.variables).length-1?(n(),i("span",Er,y("  "))):R("",!0)],64))),128))])])):R("",!0),r.value.includes("response")?(n(),i("td",Vr,[Te(e("div",Ar,null,512),[[H,L(c(M)),"apiResponse"]])])):R("",!0),r.value.includes("parsedResponse")?(n(),i("td",Fr,y(v(M)),1)):R("",!0),r.value.includes("postProcessedResponse")?(n(),i("td",xr,y(F(M)),1)):R("",!0),r.value.includes("length")?(n(),i("td",Lr,y(u(M)),1)):R("",!0),r.value.includes("latency")?(n(),i("td",Dr,[e("span",{class:se(X(M.response?.latencyMs))},y(g(M.response?.latencyMs)),3)])):R("",!0)],10,_r))),128)),h.value.length===0?(n(),i("tr",Or,[e("td",{colspan:r.value.length,class:"empty-state"},[o.value.length===0?(n(),i("div",Ur," No API calls yet. Start the trial to begin execution. ")):(n(),i("div",Nr," No results match your filters. "))],8,Mr)])):R("",!0)])]))]),f.value?(n(),Q(ci,{key:0,visible:!!f.value,"api-call":f.value,trial:m.trial,"onUpdate:visible":I[5]||(I[5]=M=>f.value=null)},null,8,["visible","api-call","trial"])):R("",!0),k.value?(n(),Q(Pi,{key:1,visible:k.value,trial:m.trial,onClose:I[6]||(I[6]=M=>k.value=!1)},null,8,["visible","trial"])):R("",!0)])}}}),zr=ae(Wr,[["__scopeId","data-v-9a99db4e"]]),Hr={class:"trial-analysis-view"},Br=le({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(l){const t=l;return ce(()=>{const s=performance.now();V.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${t.trial.id}`),_e(()=>{const d=performance.now();V.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(d-s).toFixed(1)}ms`)}),setTimeout(()=>{const d=performance.now();V.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(d-s).toFixed(1)}ms`)},0)}),we(()=>{V.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${t.trial.id}`)}),Se(()=>{V.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${t.trial.id}`)}),ge(()=>{V.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${t.trial.id}`)}),(s,d)=>(n(),i("div",Hr,[w(zr,{trial:s.trial,progress:s.progress,"is-executing":s.isExecuting,"api-calls":s.apiCalls,"is-streaming":s.isStreaming,"is-loading":s.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),jr=ae(Br,[["__scopeId","data-v-602f5d5a"]]);function qr(l,t){const s=new Set,d=new Set,p=new Set;l.forEach(C=>{C.variables&&Object.keys(C.variables).forEach(T=>s.add(T)),C.variableAttributes&&Object.values(C.variableAttributes).forEach(T=>{T&&Object.keys(T).forEach(h=>d.add(h))})});const r=Array.from(s).sort(),f=Array.from(d).sort(),k=Array.from(p).sort(),S=[],o=["success","refused","parsed_response",...S,...k];return{categorical:[...r,...f,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...S].sort(),extracted:o}}function ke(l,t,s){switch(t){case"model":return s&&l.configurationIndex<s.configurations.length&&s.configurations[l.configurationIndex].modelId||"Unknown";case"status":return l.status;case"response_time":return l.response?.latencyMs||0;case"total_tokens":if(l.response?.body?.usage){const d=l.response.body.usage;return d.total_tokens||d.prompt_tokens+d.completion_tokens||0}return 0;case"prompt_tokens":return l.response?.body?.usage?.prompt_tokens||l.response?.body?.usage?.input_tokens||0;case"completion_tokens":return l.response?.body?.usage?.completion_tokens||l.response?.body?.usage?.output_tokens||0;case"error_type":return l.result?.errorType||(l.result?.success===!1?"api_error":"success");case"success":return l.result?.success?1:0;case"refused":return l.result?.refused?1:0;case"parsed_response":if(l.result?.parsedContent!==void 0){const d=l.result.parsedContent;return typeof d=="object"?JSON.stringify(d):d}return null}if(l.variables?.[t]!==void 0)return l.variables[t];if(l.variableAttributes)for(const d of Object.keys(l.variableAttributes)){const p=l.variableAttributes[d];if(p&&p[t]!==void 0)return p[t]}return null}const Re={count:{label:"Count",calculate:l=>l.length,format:l=>l.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?t.reduce((s,d)=>s+d,0):null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},mean:{label:"Mean",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?t.reduce((s,d)=>s+d,0)/t.length:null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},median:{label:"Median",calculate:l=>{const t=l.map(p=>typeof p=="number"?p:null).filter(p=>p!==null);if(t.length===0)return null;const s=[...t].sort((p,r)=>p-r),d=Math.floor(s.length/2);return s.length%2===0?(s[d-1]+s[d])/2:s[d]},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},mode:{label:"Mode",calculate:l=>{if(l.length===0)return null;const t=new Map;l.forEach(p=>t.set(p,(t.get(p)||0)+1));let s=0,d=null;return t.forEach((p,r)=>{p>s&&(s=p,d=r)}),{value:d,count:s,total:l.length}},format:l=>l?`${l.value} (${l.count}/${l.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:l=>{const t=l.map(p=>typeof p=="number"?p:null).filter(p=>p!==null);if(t.length<=1)return null;const s=t.reduce((p,r)=>p+r,0)/t.length;return t.reduce((p,r)=>p+Math.pow(r-s,2),0)/(t.length-1)},format:l=>l?.toFixed(3)||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:l=>{const t=Re.variance.calculate(l);return t!==null?Math.sqrt(t):null},format:l=>l?.toFixed(3)||"-",needsNumeric:!0},min:{label:"Min",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?Math.min(...t):null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},max:{label:"Max",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?Math.max(...t):null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(l,t)=>{const s=t.filter(d=>d.result?.success).length;return t.length>0?s/t.length:0},format:l=>`${Math.round(l*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(l,t)=>{const s=t.filter(d=>d.result?.refused).length;return t.length>0?s/t.length:0},format:l=>`${Math.round(l*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(l,t)=>{const s=t.filter(d=>d.response?.latencyMs).map(d=>d.response.latencyMs);return s.length>0?s.reduce((d,p)=>d+p,0)/s.length:null},format:l=>l?`${Math.round(l)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function pt(l,t,s){const d=new Map,p=new Set,r=new Set;l.forEach(_=>{const b=String(ke(_,t.rowField,s)||"Unknown"),x=String(ke(_,t.columnField,s)||"Unknown");p.add(b),r.add(x),d.has(b)||d.set(b,new Map),d.get(b).has(x)||d.get(b).set(x,[]),d.get(b).get(x).push(_)});const f=_=>_.every(x=>!isNaN(Number(x))&&x.trim()!=="")?_.sort((x,W)=>Number(x)-Number(W)):_.sort(),k=(_,b)=>(s&&(s.type,s.type),f(_)),S=t.rowSort==="original"?k(Array.from(p),t.rowField):f(Array.from(p)),o=t.columnSort==="original"?k(Array.from(r),t.columnField):f(Array.from(r)),C=Re[t.aggregation];function T(_){const b=_.map(c=>ke(c,t.valueField,s));if(!C||typeof C.calculate!="function")return V.error("Invalid aggregation function:",t.aggregation,C),{value:null,count:_.length,apiCalls:_,rawValues:b,error:"Invalid aggregation function"};const x={nonNumeric:0,nullUndefined:0};return C.needsNumeric&&(x.nonNumeric=b.filter(c=>typeof c!="number").length),x.nullUndefined=b.filter(c=>c==null).length,{value:C.usesApiCalls?C.calculate(b,_):C.calculate(b),count:_.length,apiCalls:_,rawValues:b,excludedCounts:x}}const h=S.map(_=>{const b=[],x=[];return o.forEach(W=>{const A=d.get(_)?.get(W)||[];b.push(A.length>0?T(A):null),x.push(...A)}),{label:_,cells:b,total:T(x)}}),P=o.map(_=>{const b=[];return S.forEach(x=>{const W=d.get(x)?.get(_)||[];b.push(...W)}),T(b)});return{rows:h,columns:o,totals:P,grandTotal:T(l)}}function he(l,t){return!l||l.value===null?"-":Re[t].format(l.value)}function Gr(l){if(!l||Object.keys(l).length===0)return"";const t=[];return l.temperature!==void 0&&t.push(`T:${l.temperature}`),l.max_tokens!==void 0?t.push(`${l.max_tokens}t`):l.maxTokens!==void 0?t.push(`${l.maxTokens}t`):l.num_predict!==void 0&&t.push(`${l.num_predict}t`),l.top_p!==void 0&&t.push(`p:${l.top_p}`),l.top_k!==void 0&&t.push(`k:${l.top_k}`),t.length>0?`(${t.join(", ")})`:""}function Kr(l,t,s,d=j({}),p={}){const{debounceMs:r=100}=p,f=j({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),k=j({categorical:[],numeric:[],extracted:[]}),S=j(!1),o=j(0),C=U(()=>{const _=d.value;return Object.values(_).some(x=>x!=="")?l.value.filter(x=>{if(_.model&&_.model!==""){if(!s.value||x.configurationIndex>=s.value.configurations.length)return!1;const W=s.value.configurations[x.configurationIndex],A=W.modelId||"Unknown",c=Gr(W.parameters);if((c?`${A} ${c}`:A)!==_.model)return!1}if(_.status&&_.status!==""&&x.status!==_.status)return!1;for(const[W,A]of Object.entries(_))if(A&&A!==""&&W!=="model"&&W!=="status"&&x.variables?.[W]!==A)return!1;return!0}):l.value}),T=Ne(()=>{if(C.value.length===0){f.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}S.value=!0;const _=performance.now();try{f.value=pt(C.value,t.value,s.value);const b=performance.now()-_;o.value=b,V.debug("Pivot data computed (config change)",{apiCallCount:C.value.length,computeTimeMs:b,rowCount:f.value.rows.length,columnCount:f.value.columns.length})}catch(b){V.error("Error computing pivot data",b)}finally{S.value=!1}},r),h=Ne(()=>{if(C.value.length===0){f.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}S.value=!0;const _=performance.now();try{f.value=pt(C.value,t.value,s.value);const b=performance.now()-_;o.value=b,V.debug("Pivot data computed (stream update)",{apiCallCount:C.value.length,computeTimeMs:b,rowCount:f.value.rows.length,columnCount:f.value.columns.length})}catch(b){V.error("Error computing pivot data",b)}finally{S.value=!1}},200),P=Ne(()=>{k.value=qr(l.value,s.value)},200);return oe([t],()=>{T()},{deep:!0}),oe(C,(_,b)=>{const x=b?.length||0,W=_.length;(x!==W||W>0)&&h()},{immediate:!0}),oe([l,s],()=>{`${l.value.length}`,P()},{immediate:!0}),P(),{pivotData:U(()=>f.value),availableFields:U(()=>k.value),isComputing:U(()=>S.value),lastComputeTime:U(()=>o.value),formatCellValue:he,extractFieldValue:ke,aggregationFunctions:Re}}const Jr={class:"pivot-config-v3"},Qr={class:"config-row"},Yr={class:"config-group"},Xr=["value","aria-label"],Zr={label:"Categorical"},eu=["value"],tu={class:"config-group sort-group"},su=["value","aria-label"],au={class:"config-group"},lu=["value","aria-label"],nu={label:"Categorical"},ou=["value"],iu={class:"config-group sort-group"},ru=["value","aria-label"],uu={class:"config-group"},du=["value","aria-label"],cu={label:"Extracted Values"},pu=["value"],fu={label:"Numeric Fields"},vu=["value"],mu={class:"config-group"},gu=["value","aria-label"],hu=le({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(l,{emit:t}){const s=t;function d(r,f){s("update-config",r,f)}function p(r){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[r]||r.replace(/_/g," ").replace(/\b\w/g,k=>k.toUpperCase())}return(r,f)=>(n(),i("div",Jr,[e("div",Qr,[e("div",Yr,[f[6]||(f[6]=e("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),e("select",{id:"pivot-row-field",value:r.config.rowField,"aria-label":"Group rows by "+p(r.config.rowField),onChange:f[0]||(f[0]=k=>d("rowField",k.target.value))},[e("optgroup",Zr,[(n(!0),i(Z,null,te(r.availableFields.categorical,k=>(n(),i("option",{key:k,value:k},y(p(k)),9,eu))),128))])],40,Xr)]),e("div",tu,[f[8]||(f[8]=e("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),e("select",{id:"pivot-row-sort",value:r.config.rowSort||"original","aria-label":"Sort rows by "+(r.config.rowSort||"original")+" order",onChange:f[1]||(f[1]=k=>d("rowSort",k.target.value))},f[7]||(f[7]=[e("option",{value:"original"},"Original",-1),e("option",{value:"alpha"},"Alphabetical",-1)]),40,su)]),e("div",au,[f[9]||(f[9]=e("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),e("select",{id:"pivot-column-field",value:r.config.columnField,"aria-label":"Group columns by "+p(r.config.columnField),onChange:f[2]||(f[2]=k=>d("columnField",k.target.value))},[e("optgroup",nu,[(n(!0),i(Z,null,te(r.availableFields.categorical,k=>(n(),i("option",{key:k,value:k},y(p(k)),9,ou))),128))])],40,lu)]),e("div",iu,[f[11]||(f[11]=e("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),e("select",{id:"pivot-column-sort",value:r.config.columnSort||"original","aria-label":"Sort columns by "+(r.config.columnSort||"original")+" order",onChange:f[3]||(f[3]=k=>d("columnSort",k.target.value))},f[10]||(f[10]=[e("option",{value:"original"},"Original",-1),e("option",{value:"alpha"},"Alphabetical",-1)]),40,ru)]),e("div",uu,[f[12]||(f[12]=e("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),e("select",{id:"pivot-value-field",value:r.config.valueField,"aria-label":"Aggregate "+r.config.valueField+" values",onChange:f[4]||(f[4]=k=>d("valueField",k.target.value))},[e("optgroup",cu,[(n(!0),i(Z,null,te(r.availableFields.extracted,k=>(n(),i("option",{key:k,value:k},y(k),9,pu))),128))]),e("optgroup",fu,[(n(!0),i(Z,null,te(r.availableFields.numeric,k=>(n(),i("option",{key:k,value:k},y(p(k)),9,vu))),128))])],40,du)]),e("div",mu,[f[14]||(f[14]=e("label",{for:"pivot-aggregation"},"Aggregation:",-1)),e("select",{id:"pivot-aggregation",value:r.config.aggregation,"aria-label":"Aggregation method: "+r.config.aggregation,onChange:f[5]||(f[5]=k=>d("aggregation",k.target.value))},f[13]||(f[13]=[gt('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,gu)])])]))}}),yu=ae(hu,[["__scopeId","data-v-0d3a0d50"]]),_u={class:"heatmap-controls-v3"},bu={class:"color-scale-selector"},$u=["value","aria-label"],Tu={class:"gradient-mode-selector"},ku={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},Cu=["aria-pressed"],wu=["aria-pressed"],Su=["aria-pressed"],Iu=["title","aria-label"],Ru=le({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(l,{emit:t}){const s=t;function d(r){const f=r.target.value;s("update-color-scale",f)}function p(r){s("update-gradient-mode",r)}return(r,f)=>(n(),i("div",_u,[e("div",bu,[f[5]||(f[5]=e("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),e("select",{id:"heatmap-color-scale",value:r.selectedColorScale,"aria-label":"Color scale: "+r.selectedColorScale,onChange:d},f[4]||(f[4]=[gt('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,$u)]),e("div",Tu,[f[6]||(f[6]=e("label",null,"Gradient Mode:",-1)),e("div",ku,[e("button",{type:"button",class:se(["toggle-btn",{active:r.gradientMode==="global"}]),"aria-pressed":r.gradientMode==="global",onClick:f[0]||(f[0]=k=>p("global"))}," Global ",10,Cu),e("button",{type:"button",class:se(["toggle-btn",{active:r.gradientMode==="column"}]),"aria-pressed":r.gradientMode==="column",onClick:f[1]||(f[1]=k=>p("column"))}," Per Column ",10,wu),e("button",{type:"button",class:se(["toggle-btn",{active:r.gradientMode==="row"}]),"aria-pressed":r.gradientMode==="row",onClick:f[2]||(f[2]=k=>p("row"))}," Per Row ",10,Su)])]),e("button",{type:"button",class:"fullscreen-btn",title:r.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":r.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:f[3]||(f[3]=k=>r.$emit("toggle-fullscreen"))},y(r.isFullscreen?"⊟":"⊞"),9,Iu)]))}}),Pu=ae(Ru,[["__scopeId","data-v-dcb6369b"]]),Eu={class:"pivot-filters-v3"},Vu={class:"filters-row"},Au={key:0,class:"filter-group"},Fu=["value"],xu=["value"],Lu=["for"],Du=["id","value","aria-label","onChange"],Ou={value:""},Mu=["value"],Uu={key:1,class:"filter-group"},Nu=["value"],Wu=["value"],zu=le({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(l,{emit:t}){const s=l,d=t,p=j({});let r=0;const f=()=>{if(s.apiCalls.length===0){p.value={};return}const h={};s.apiCalls.forEach(_=>{if(s.trial&&_.configurationIndex<s.trial.configurations.length){const b=s.trial.configurations[_.configurationIndex],x=b.modelId||"Unknown",W=o(b.parameters),A=W?`${x} ${W}`:x;h.model||(h.model=new Set),h.model.add(A)}_.status&&(h.status||(h.status=new Set),h.status.add(_.status)),_.variables&&Object.entries(_.variables).forEach(([b,x])=>{x&&String(x).trim()&&(h[b]||(h[b]=new Set),h[b].add(String(x)))})});const P={};Object.entries(h).forEach(([_,b])=>{P[_]=Array.from(b).sort()}),p.value=P};oe(()=>s.apiCalls.length,h=>{(h===0||r===0||h-r>=5)&&(f(),r=h)},{immediate:!0});const k=U(()=>{const{model:h,status:P,..._}=p.value;return _}),S=U(()=>Object.values(s.activeFilters).some(h=>h!==""));function o(h){if(!h||Object.keys(h).length===0)return"";const P=[];return h.temperature!==void 0&&P.push(`T:${h.temperature}`),h.max_tokens!==void 0?P.push(`${h.max_tokens}t`):h.maxTokens!==void 0?P.push(`${h.maxTokens}t`):h.num_predict!==void 0&&P.push(`${h.num_predict}t`),h.top_p!==void 0&&P.push(`p:${h.top_p}`),h.top_k!==void 0&&P.push(`k:${h.top_k}`),P.length>0?`(${P.join(", ")})`:""}function C(h){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[h]||h.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())}function T(h,P){const _={...s.activeFilters};P===""?delete _[h]:_[h]=P,d("update-filters",_)}return(h,P)=>(n(),i("div",Eu,[e("div",Vu,[p.value.model&&p.value.model.length>1?(n(),i("div",Au,[P[4]||(P[4]=e("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),e("select",{id:"filter-model",value:h.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:P[0]||(P[0]=_=>T("model",_.target.value))},[P[3]||(P[3]=e("option",{value:""},"All Models",-1)),(n(!0),i(Z,null,te(p.value.model,_=>(n(),i("option",{key:_,value:_},y(_),9,xu))),128))],40,Fu)])):R("",!0),(n(!0),i(Z,null,te(k.value,(_,b)=>(n(),i("div",{key:b,class:"filter-group"},[e("label",{for:`filter-${b}`,class:"filter-label"},y(C(String(b)))+": ",9,Lu),e("select",{id:`filter-${b}`,value:h.activeFilters[b]||"",class:"filter-select","aria-label":`Filter by ${C(String(b))}`,onChange:x=>T(String(b),x.target.value)},[e("option",Ou,"All "+y(C(String(b))),1),(n(!0),i(Z,null,te(_,x=>(n(),i("option",{key:x,value:x},y(x),9,Mu))),128))],40,Du)]))),128)),p.value.status&&p.value.status.length>1?(n(),i("div",Uu,[P[6]||(P[6]=e("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),e("select",{id:"filter-status",value:h.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:P[1]||(P[1]=_=>T("status",_.target.value))},[P[5]||(P[5]=e("option",{value:""},"All Statuses",-1)),(n(!0),i(Z,null,te(p.value.status,_=>(n(),i("option",{key:_,value:_},y(_),9,Wu))),128))],40,Nu)])):R("",!0),S.value?(n(),i("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:P[2]||(P[2]=_=>h.$emit("clear-filters"))}," Clear Filters ")):R("",!0)])]))}}),Hu=ae(zu,[["__scopeId","data-v-d5848163"]]),Bu={class:"collapse-icon"},ju={class:"options-content"},qu={class:"controls-row"},Gu={key:0,class:"performance-info"},Ku={class:"table-view"},Ju={key:0,class:"empty-state","data-testid":"empty-data-message"},Qu={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Yu={key:2,class:"loading-state","data-testid":"computing-state"},Xu={key:3,class:"pivot-table-container"},Zu={class:"pivot-table-grid responsive-table",role:"table"},ed={role:"row"},td={class:"corner-cell",role:"columnheader"},sd={key:0,class:"total-header",role:"columnheader"},ad={class:"row-header",role:"rowheader"},ld=["data-testid","title","aria-label","role","onClick","onKeydown"],nd={key:0,class:"cell-content"},od=["title"],id={class:"cell-value"},rd={class:"error-message"},ud={key:1},dd=le({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(l,{emit:t}){const s=l,d=t,p=j(!1),r=j("viridis"),f=j("global"),k=j(!1),S=j({rowField:s.config?.rowField||"",columnField:s.config?.columnField||"",valueField:s.config?.valueField||"",aggregation:s.config?.aggregation||"mean",rowSort:s.config?.rowSort||"original",columnSort:s.config?.columnSort||"original"});oe(()=>s.config,N=>{N&&Object.assign(S.value,N)},{deep:!0});const o=j({}),C=Ie(),T=U(()=>C.apiCalls?C.apiCalls.value||[]:s.apiCalls||[]),h=T,P=U(()=>s.trial),{pivotData:_,availableFields:b,isComputing:x,lastComputeTime:W}=Kr(h,S,P,o,{debounceMs:750});oe(_,(N,$)=>{const q=performance.now(),J=N?.rows?.length||0,ne=N?.columns?.length||0;V.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${J}x${ne} matrix`),setTimeout(()=>{const re=performance.now();V.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(re-q).toFixed(1)}ms`)},0)}),oe(x,N=>{N?V.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${T.value.length} API calls`):V.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${W.value.toFixed(1)}ms`)}),oe(T,(N,$)=>{const q=performance.now();V.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${$?.length||0} to ${N.length} calls`),setTimeout(()=>{const J=performance.now();V.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(J-q).toFixed(1)}ms`)},0)});const A=U(()=>_.value.rows.slice(0,s.maxTableRows)),c=U(()=>Object.values(o.value).some($=>$!=="")?T.value.filter($=>{if(o.value.model&&o.value.model!==""){if(!s.trial||$.configurationIndex>=s.trial.configurations.length)return!1;const q=s.trial.configurations[$.configurationIndex],J=q.modelId||"Unknown",ne=g(q.parameters);if((ne?`${J} ${ne}`:J)!==o.value.model)return!1}if(o.value.status&&o.value.status!==""&&$.status!==o.value.status)return!1;for(const[q,J]of Object.entries(o.value))if(J&&J!==""&&q!=="model"&&q!=="status"&&$.variables?.[q]!==J)return!1;return!0}).length:T.value.length),{getCellStyle:v,getSummaryStyle:F,styleKey:u}=Gs(_,r,f);function g(N){if(!N||Object.keys(N).length===0)return"";const $=[];return N.temperature!==void 0&&$.push(`T:${N.temperature}`),N.max_tokens!==void 0?$.push(`${N.max_tokens}t`):N.maxTokens!==void 0?$.push(`${N.maxTokens}t`):N.num_predict!==void 0&&$.push(`${N.num_predict}t`),N.top_p!==void 0&&$.push(`p:${N.top_p}`),N.top_k!==void 0&&$.push(`k:${N.top_k}`),$.length>0?`(${$.join(", ")})`:""}function K(N){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[N]||N.replace(/_/g," ").replace(/\b\w/g,q=>q.toUpperCase())}function X(N,$,q){if(!q)return`${N} × ${$}: No data`;const J=he(q,S.value.aggregation);let ne=`${N} × ${$}: ${J} (${q.count} calls)`;if(q.excludedCounts){const re=[];q.excludedCounts.nonNumeric>0&&re.push(`${q.excludedCounts.nonNumeric} non-numeric responses excluded`),q.excludedCounts.nullUndefined>0&&re.push(`${q.excludedCounts.nullUndefined} null/empty responses`),re.length>0&&(ne+=` | ${re.join(", ")}`)}return q.error&&(ne+=` - ERROR: ${q.error}`),ne}function L(N,$,q){if(!q)return`${N} by ${$}: No data`;const J=he(q,S.value.aggregation);return q.error?`${N} by ${$}: ${J} with data integrity error: ${q.error}`:`${N} by ${$}: ${J} from ${q.count} API calls`}function a(N,$){(N==="rowField"||N==="columnField"||N==="valueField"||N==="aggregation"||N==="rowSort"||N==="columnSort")&&(S.value[N]=$),d("config-change",{...S.value})}function m(N){o.value={...N}}function I(){o.value={}}function H(N,$,q){q&&d("cell-click",{row:N,column:$,cell:q})}function M(){k.value=!k.value}function G(){p.value=!p.value,p.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return ce(()=>{const N=performance.now();V.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${s.trial?.id||"unknown"} with ${T.value.length} calls`),_e(()=>{const $=performance.now();V.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${($-N).toFixed(1)}ms`)}),setTimeout(()=>{const $=performance.now();V.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${($-N).toFixed(1)}ms`)},0)}),we(()=>{V.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${s.trial?.id||"unknown"} with ${T.value.length} calls`)}),Se(()=>{V.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${s.trial?.id||"unknown"}`)}),ge(()=>{V.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${s.trial?.id||"unknown"}`),p.value&&(document.body.style.overflow="")}),oe([b,T],([N])=>{if(T.value.length>0&&(!S.value.rowField||S.value.rowField==="")&&N.categorical.length>0){if(S.value.rowField=N.categorical.find($=>$!=="model"&&$!=="status"&&$!=="error_type")||N.categorical[0]||"model",S.value.columnField=S.value.columnField||"model",S.value.valueField=S.value.valueField||"parsed_response",!S.value.aggregation||S.value.aggregation===""){const $=T.value.slice(0,3).map(J=>ke(J,S.value.valueField,s.trial)).filter(J=>J!=null),q=$.length>0&&$.every(J=>typeof J=="number");S.value.aggregation=q?"mean":"mode"}d("config-change",{...S.value})}},{immediate:!0}),(N,$)=>(n(),i("div",{class:se(["pivot-table-v3",{fullscreen:p.value}])},[e("div",{class:se(["pivot-options-container",{collapsed:k.value}])},[e("div",{class:"options-header",onClick:M},[$[3]||($[3]=e("span",{class:"options-title"},"Pivot Table Options",-1)),e("span",Bu,y(k.value?"▶":"▼"),1)]),Te(e("div",ju,[rs([z(b),S.value],()=>(n(),i("div",null,[w(yu,{config:S.value,"available-fields":z(b),onUpdateConfig:a},null,8,["config","available-fields"])])),$,0),e("div",qu,[T.value.length>0?(n(),Q(Hu,{key:0,"api-calls":T.value,trial:N.trial,"active-filters":o.value,onUpdateFilters:m,onClearFilters:I},null,8,["api-calls","trial","active-filters"])):R("",!0),w(Pu,{"selected-color-scale":r.value,"gradient-mode":f.value,"is-fullscreen":p.value,onUpdateColorScale:$[1]||($[1]=q=>r.value=q),onUpdateGradientMode:$[2]||($[2]=q=>f.value=q),onToggleFullscreen:G},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[ht,!k.value]])],2),N.showPerformanceInfo?(n(),i("div",Gu,[e("span",null,"Computing: "+y(z(x)?"Yes":"No"),1),e("span",null,"Last Compute: "+y(z(W).toFixed(1))+"ms",1),e("span",null,"API Calls: "+y(T.value.length),1),e("span",null,"Filtered: "+y(c.value),1)])):R("",!0),e("div",Ku,[T.value.length===0?(n(),i("div",Ju,$[4]||($[4]=[e("p",null,"No data available for pivot table analysis.",-1)]))):S.value.aggregation in z(Re)?z(x)?(n(),i("div",Yu,$[6]||($[6]=[e("p",null,"Computing pivot table...",-1)]))):(n(),i("div",Xu,[e("table",Zu,[e("thead",null,[e("tr",ed,[e("th",td,y(K(S.value.rowField)||"Items")+" / "+y(K(S.value.columnField)||"Aggregated"),1),(n(!0),i(Z,null,te(z(_).columns,q=>(n(),i("th",{key:q,class:"column-header",role:"columnheader"},y(q),1))),128)),S.value.columnField&&N.showTotals?(n(),i("th",sd," Total ")):R("",!0)])]),e("tbody",null,[(n(!0),i(Z,null,te(A.value,q=>(n(),i("tr",{key:`${q.label}-${z(u)}`,class:"data-row",role:"row"},[e("td",ad,y(q.label),1),(n(!0),i(Z,null,te(q.cells,(J,ne)=>(n(),i("td",{key:`${ne}-${z(u)}`,class:se(["data-cell",{"error-cell":J?.error}]),"data-testid":J?.error?"pivot-cell-error":"pivot-cell",style:me(z(v)(J,q.label,ne)),title:X(q.label,z(_).columns[ne],J),"aria-label":L(q.label,z(_).columns[ne],J),role:J?.error?"alert":"cell",tabindex:"0",onClick:re=>H(q.label,z(_).columns[ne],J),onKeydown:[He(re=>H(q.label,z(_).columns[ne],J),["enter"]),He(yt(re=>H(q.label,z(_).columns[ne],J),["prevent"]),["space"])]},[J?.error?(n(),i("div",nd,[e("span",{class:"error-indicator",title:J.error},"⚠️",8,od),e("span",id,y(J?z(he)(J,S.value.aggregation):"-"),1),e("div",rd,y(J.error),1)])):(n(),i("span",ud,y(J?z(he)(J,S.value.aggregation):"-"),1))],46,ld))),128)),S.value.columnField&&N.showTotals?(n(),i("td",{key:0,class:"total-cell",style:me(z(F)(q.total)),role:"cell"},y(z(he)(q.total,S.value.aggregation)),5)):R("",!0)]))),128)),S.value.rowField&&N.showTotals?(n(),i("tr",{key:`totals-${z(u)}`,class:"total-row",role:"row"},[$[7]||($[7]=e("td",{class:"row-header",role:"rowheader"},"Total",-1)),(n(!0),i(Z,null,te(z(_).totals,(q,J)=>(n(),i("td",{key:`total-${J}-${z(u)}`,class:"total-cell",style:me(z(F)(q)),role:"cell"},y(z(he)(q,S.value.aggregation)),5))),128)),S.value.columnField?(n(),i("td",{key:0,class:"grand-total-cell",style:me(z(F)(z(_).grandTotal)),role:"cell"},y(z(he)(z(_).grandTotal,S.value.aggregation)),5)):R("",!0)])):R("",!0)])])])):(n(),i("div",Qu,[e("p",null,"Invalid aggregation function: "+y(S.value.aggregation),1),$[5]||($[5]=e("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),cd=ae(dd,[["__scopeId","data-v-2d987e50"]]),pd={class:"modal-content"},fd={class:"modal-header"},vd={class:"modal-title"},md={class:"summary-row"},gd={key:0},hd={key:0,class:"filter-row"},yd=["onUpdate:modelValue","aria-label"],_d={value:""},bd=["value"],$d={class:"table-container"},Td={class:"api-calls-table"},kd=["title"],Cd=["title"],wd=le({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(l){const t=l,s=us({}),d=U(()=>{const c=new Set;return t.apiCalls.forEach(v=>{v.variables&&Object.keys(v.variables).forEach(F=>c.add(F)),v.attributedVariables&&Object.entries(v.attributedVariables).forEach(([F,u])=>{u&&typeof u=="object"&&Object.keys(u).forEach(g=>{c.add(`${F}.${g}`)})})}),Array.from(c).sort()}),p=U(()=>d.value.map(c=>({title:c,dataIndex:`var_${c}`,key:`var_${c}`,width:150}))),r=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],f=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],k=U(()=>[...r,...p.value,...f]),S=U(()=>`${t.row} × ${t.column} - ${t.apiCalls.length} API Calls`),o=U(()=>t.apiCalls.map(c=>{const v={id:c.id,status:c.status,model:c.model||"-",response:c.result?.content||c.result?.error||"-",extracted:c.extracted||"-",duration:c.duration?`${c.duration}ms`:"-",cost:c.cost||0};return d.value.forEach(F=>{if(F.includes(".")){const[u,g]=F.split("."),K=c.attributedVariables?.[u]?.[g];v[`var_${F}`]=K!==void 0?String(K):"-"}else v[`var_${F}`]=c.variables?.[F]||"-"}),v})),C=U(()=>Object.values(s).some(c=>c!==void 0&&c!=="")),T=U(()=>C.value?o.value.filter(c=>Object.entries(s).every(([v,F])=>F?c[v]===F:!0)):o.value),h=U(()=>{const c=t.apiCalls.filter(v=>v.status==="completed").length;return Math.round(c/t.apiCalls.length*100)}),P=U(()=>{const c=t.apiCalls.filter(v=>v.duration).map(v=>v.duration);return c.length===0?0:Math.round(c.reduce((v,F)=>v+F,0)/c.length)}),_=U(()=>t.apiCalls.filter(v=>v.cost).map(v=>v.cost).reduce((v,F)=>v+F,0));function b(c){switch(c){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function x(c,v){return c?c.length<=v?c:c.slice(0,v)+"...":""}function W(c){const v=new Set;return o.value.forEach(F=>{const u=F[c];u&&u!=="-"&&v.add(u)}),Array.from(v).sort()}function A(){Object.keys(s).forEach(c=>{delete s[c]})}return(c,v)=>(n(),i("div",{class:se(["pivot-cell-detail-modal-v3",{visible:c.visible}]),onClick:v[1]||(v[1]=yt(F=>c.$emit("close"),["self"]))},[e("div",pd,[e("div",fd,[e("h3",vd,y(S.value),1),e("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:v[0]||(v[0]=F=>c.$emit("close"))}," × ")]),e("div",md,[e("span",null,[v[2]||(v[2]=e("b",null,"Total:",-1)),D(" "+y(c.apiCalls.length),1)]),e("span",null,[v[3]||(v[3]=e("b",null,"Success Rate:",-1)),D(" "+y(h.value)+"%",1)]),e("span",null,[v[4]||(v[4]=e("b",null,"Avg Duration:",-1)),D(" "+y(P.value)+"ms",1)]),_.value>0?(n(),i("span",gd,[v[5]||(v[5]=e("b",null,"Total Cost:",-1)),D(" $"+y(_.value),1)])):R("",!0)]),p.value.length>0?(n(),i("div",hd,[(n(!0),i(Z,null,te(p.value,F=>(n(),i("div",{key:F.key,class:"variable-filter"},[Te(e("select",{"onUpdate:modelValue":u=>s[F.key]=u,"aria-label":`Filter ${F.title}`,class:"filter-select"},[e("option",_d,"All "+y(F.title),1),(n(!0),i(Z,null,te(W(F.key),u=>(n(),i("option",{key:u,value:u},y(u),9,bd))),128))],8,yd),[[ds,s[F.key]]])]))),128)),C.value?(n(),i("button",{key:0,type:"button",class:"clear-filters-btn",onClick:A}," Clear Filters ")):R("",!0)])):R("",!0),e("div",$d,[e("table",Td,[e("thead",null,[e("tr",null,[(n(!0),i(Z,null,te(k.value,F=>(n(),i("th",{key:F.key,class:"table-header",style:me({width:F.width?`${F.width}px`:"auto"})},y(F.title),5))),128))])]),e("tbody",null,[(n(!0),i(Z,null,te(T.value,F=>(n(),i("tr",{key:F.id,class:"table-row"},[(n(!0),i(Z,null,te(k.value,u=>(n(),i("td",{key:u.key,class:se(["table-cell",{"status-cell":u.key==="status"}])},[u.key==="status"?(n(),i("span",{key:0,class:se(["status-tag",b(F.status)])},y(F.status),3)):u.key==="response"?(n(),i("span",{key:1,class:"response-cell",title:F.response},y(x(F.response,100)),9,kd)):u.key==="cost"?(n(),i(Z,{key:2},[D(y(F.cost===0?"-":`$${F.cost.toFixed(4)}`),1)],64)):u.key.startsWith("var_")?(n(),i("span",{key:3,class:"variable-cell",title:F[u.key]},y(F[u.key]||"-"),9,Cd)):(n(),i(Z,{key:4},[D(y(F[u.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),Sd=ae(wd,[["__scopeId","data-v-2738b696"]]),Id={class:"trial-tab-content"},Rd={class:"tab-pane-content"},Pd={class:"tab-pane-content"},Ed={key:0,class:"no-data-message"},Vd={class:"tab-pane-content"},ft="trial-details-active-tab",Ad=le({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(l){const t=l,s=_t(),d=xe(),p=Ie(),r=U(()=>p.apiCalls?.value||[]),f=U(()=>p.isStreaming?.value||!1);oe(r,(A,c)=>{const v=performance.now();V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${c?.length||0} to ${A.length} calls`),setTimeout(()=>{const F=performance.now();V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(F-v).toFixed(1)}ms`)},0)});const k=U(()=>!1),o=j((()=>{const A=s.query.tab;return A==="status"?"details":A&&["details","tasks","pivot"].includes(A)?A:"tasks"})()),C=j(!1),T=j(!1),h=j({row:"",column:"",apiCalls:[],value:null}),P=U(()=>t.executionState?.status==="executing"&&t.executionState?.currentTrialId===t.trial.id),_=U(()=>t.trial.progress.completed>0);function b(){localStorage.setItem(ft,o.value);const A={...s.query};A.tab=o.value,s.query.tab!==o.value&&(d.replace({query:A}),`${o.value}`)}function x(){const A=localStorage.getItem(ft);A==="status"?o.value="details":A&&["details","tasks","pivot"].includes(A)&&(o.value=A)}function W(A){!A.cell||!A.cell.apiCalls.length||(h.value={row:A.row,column:A.column,apiCalls:A.cell.apiCalls,value:A.cell.value},T.value=!0)}return oe(o,()=>{b()}),oe(()=>s.query.tab,A=>{if(A&&typeof A=="string"){let c=A==="status"?"details":A;["details","tasks","pivot"].includes(c)&&o.value!==c&&(o.value=c)}}),ce(()=>{const A=performance.now();if(V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${t.trial.id}`),!s.query.tab){const c={...s.query};c.tab=o.value,d.replace({query:c}),`${o.value}`}x(),setTimeout(()=>{const c=performance.now();V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(c-A).toFixed(1)}ms`)},0)}),we(()=>{V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${t.trial.id}`)}),Se(()=>{V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${t.trial.id}`)}),ge(()=>{V.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${t.trial.id}`)}),(A,c)=>{const v=Ms,F=Os;return n(),i("div",Id,[w(F,{activeKey:o.value,"onUpdate:activeKey":c[1]||(c[1]=u=>o.value=u),type:"card",class:"trial-tabs"},{default:E(()=>[w(v,{key:"tasks",tab:"Task View"},{default:E(()=>[e("div",Rd,[(n(),Q(Be,null,[w(jr,{trial:A.trial,progress:A.progress,"is-executing":P.value,"api-calls":r.value,"is-streaming":f.value,"is-loading":k.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),w(v,{key:"pivot",tab:"Pivot Table"},{default:E(()=>[e("div",Pd,[(n(),Q(Be,null,[_.value&&r.value.length>0?(n(),Q(cd,{key:0,"api-calls":r.value,trial:A.trial,"show-performance-info":!1,onCellClick:W},null,8,["api-calls","trial"])):R("",!0)],1024)),_.value&&r.value.length>0?R("",!0):(n(),i("div",Ed,c[3]||(c[3]=[e("p",null,"No completed API calls available for pivot analysis.",-1),e("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),w(v,{key:"details",tab:"Details"},{default:E(()=>[e("div",Vd,[w(Nn,{trial:A.trial,"is-collapsed":C.value,onToggleCollapse:c[0]||(c[0]=u=>C.value=!C.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),T.value?(n(),Q(Sd,{key:0,visible:T.value,row:h.value.row,column:h.value.column,"api-calls":h.value.apiCalls,trial:A.trial,value:h.value.value,onClose:c[2]||(c[2]=u=>T.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):R("",!0)])}}}),Fd=ae(Ad,[["__scopeId","data-v-d2c24429"]]),xd={class:"export-content"},Ld={class:"section"},Dd={key:0,class:"section"},Od={class:"bundle-info"},Md={key:0},Ud={key:1,class:"section"},Nd={class:"field-actions"},Wd={class:"field-groups"},zd={class:"field-group"},Hd={class:"field-list"},Bd={class:"field-group"},jd={class:"field-list"},qd={class:"field-group"},Gd={class:"field-list"},Kd={class:"field-group"},Jd={class:"field-list"},Qd={class:"field-group"},Yd={class:"field-list"},Xd={key:0,class:"field-group"},Zd={class:"field-list"},ec={key:1,class:"field-group"},tc={class:"field-list"},sc={class:"section"},ac={class:"preview-info"},lc={class:"info-item"},nc={class:"value"},oc={class:"info-item"},ic={class:"value"},rc={class:"info-item"},uc={class:"value"},dc={class:"export-actions"},cc=le({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(l,{emit:t}){const s=l,d=t,p=Je(),r=j("csv"),f=j(["order","status","configuration","prompt","response","latency"]),k=j(!1),S=j("draft"),o=j({}),C=j([]),T=j([]),h=j([]),P=["order","status","configuration","prompt","response","latency"],_=j([]),b=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],x=U(()=>{const L=s.trial.progress?.completed||0,a=s.trial.progress?.failed||0;return L+a}),W=U(()=>{const a=f.value.length*50*x.value;return a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`});function A(){_.value.length,_.value.forEach(m=>{o.value[m]=!1}),P.forEach(m=>{o.value[m]=!0});const L=T.value.map(m=>m.id),a=h.value.map(m=>m.id);L.forEach(m=>{o.value[m]=!0}),a.forEach(m=>{o.value[m]=!0}),P.length,L.length,a.length,P.length+L.length+a.length,c()}function c(){f.value=_.value.filter(L=>o.value[L])}function v(L,a){o.value[L]=a,c()}function F(){_.value.forEach(L=>{o.value[L]=!0}),c()}function u(){_.value.forEach(m=>{o.value[m]=!1}),P.forEach(m=>{o.value[m]=!0});const L=T.value.map(m=>m.id),a=h.value.map(m=>m.id);L.forEach(m=>{o.value[m]=!0}),a.forEach(m=>{o.value[m]=!0}),c()}function g(){_.value.forEach(L=>{o.value[L]=!1}),c()}function K(){d("update:visible",!1)}async function X(){if(r.value==="bundle"){k.value=!0;try{const{trialBundleExportService:L}=await Qe(async()=>{const{trialBundleExportService:I}=await import("./trial-bundle.service-CUz6ufnV.js");return{trialBundleExportService:I}},__vite__mapDeps([0,1,2,3,4,5,6])),a=S.value==="completed",m=await L.exportTrialBundle(s.trial.id,{includeResults:a,includeApiCalls:a,format:"json"});m.ok?(Y.success(`Trial bundle exported: ${m.value.filename}`),d("update:visible",!1)):Y.error(`Bundle export failed: ${m.error.message}`)}catch(L){Y.error(`Bundle export failed: ${L instanceof Error?L.message:"Unknown error"}`)}finally{k.value=!1}return}if(f.value.length===0){Y.warning("Please select at least one field to export");return}k.value=!0;try{const L={format:r.value,fields:f.value,includeHeaders:!0,addBOM:r.value==="excel"||r.value==="csv"},a=await p.dataExport.exportTrialData(s.trial.id,L);a.ok?(Y.success("Export completed successfully"),d("update:visible",!1)):Y.error(`Export failed: ${a.error.message}`)}catch(L){Y.error("Export failed: "+L.message)}finally{k.value=!1}}return ce(async()=>{s.trial.id;const L=await p.dataExport.getAvailableFields(s.trial.id);if(L.ok){C.value=L.value.standardFields,T.value=L.value.parameterFields,h.value=L.value.variableFields||[];const a=L.value.standardFields.map(H=>H.id).filter(H=>H!=="parameters"&&H!=="variables"),m=L.value.parameterFields.map(H=>H.id),I=(L.value.variableFields||[]).map(H=>H.id);_.value=[...a,...m,...I],L.value.standardFields.length,L.value.parameterFields.length,(L.value.variableFields||[]).length,_.value.length,L.value.parameterFields.map(H=>H.id),(L.value.variableFields||[]).map(H=>H.id),_.value}else L.error,_.value=[...b];A()}),(L,a)=>{const m=Us,I=Et,H=Vt,M=pe,G=Rt,N=be;return n(),Q(N,{visible:L.visible,"onUpdate:visible":a[46]||(a[46]=$=>L.$emit("update:visible",$)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:E(()=>[e("div",xd,[e("div",Ld,[a[53]||(a[53]=e("h4",null,"Export Format",-1)),w(I,{value:r.value,"onUpdate:value":a[0]||(a[0]=$=>r.value=$),class:"format-options"},{default:E(()=>[w(m,{value:"csv"},{default:E(()=>a[47]||(a[47]=[D("CSV")])),_:1,__:[47]}),w(m,{value:"tsv"},{default:E(()=>a[48]||(a[48]=[D("TSV")])),_:1,__:[48]}),w(m,{value:"excel"},{default:E(()=>a[49]||(a[49]=[D("Excel")])),_:1,__:[49]}),w(m,{value:"json"},{default:E(()=>a[50]||(a[50]=[D("JSON")])),_:1,__:[50]}),w(m,{value:"jsonl"},{default:E(()=>a[51]||(a[51]=[D("JSONL")])),_:1,__:[51]}),w(m,{value:"bundle"},{default:E(()=>a[52]||(a[52]=[D("Bundle 📦")])),_:1,__:[52]})]),_:1},8,["value"])]),r.value==="bundle"?(n(),i("div",Dd,[a[62]||(a[62]=e("h4",null,"Bundle Export Options",-1)),e("div",Od,[w(I,{value:S.value,"onUpdate:value":a[1]||(a[1]=$=>S.value=$),style:{"margin-bottom":"16px"}},{default:E(()=>[w(H,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:E(()=>a[54]||(a[54]=[e("strong",null,"Export as Draft",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Configuration only - recipient can run fresh experiment ",-1)])),_:1,__:[54]}),w(H,{value:"completed",style:{display:"block"}},{default:E(()=>a[55]||(a[55]=[e("strong",null,"Export with Results",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Include all execution results for review/analysis ",-1)])),_:1,__:[55]})]),_:1},8,["value"]),a[61]||(a[61]=e("p",null,"The bundle will include:",-1)),e("ul",null,[a[56]||(a[56]=e("li",null,"✅ Complete trial configuration",-1)),a[57]||(a[57]=e("li",null,"✅ Template with metadata",-1)),a[58]||(a[58]=e("li",null,"✅ All variable lists",-1)),a[59]||(a[59]=e("li",null,"✅ Model configurations",-1)),S.value==="completed"?(n(),i("li",Md,"✅ Execution results and API calls")):R("",!0),a[60]||(a[60]=e("li",null,"✅ Variable index tracking for lineage",-1))]),e("p",null,[e("strong",null,y(S.value==="draft"?"Ready to run fresh experiment":"Complete historical record"),1)])])])):(n(),i("div",Ud,[a[95]||(a[95]=e("h4",null,"Fields to Export",-1)),e("div",Nd,[w(M,{size:"small",onClick:F},{default:E(()=>a[63]||(a[63]=[D("Select All")])),_:1,__:[63]}),w(M,{size:"small",onClick:u},{default:E(()=>a[64]||(a[64]=[D("Select Defaults")])),_:1,__:[64]}),w(M,{size:"small",onClick:g},{default:E(()=>a[65]||(a[65]=[D("Clear All")])),_:1,__:[65]})]),e("div",Wd,[e("div",zd,[a[71]||(a[71]=e("h5",null,"Basic Information",-1)),e("div",Hd,[w(G,{checked:o.value.id,"onUpdate:checked":a[2]||(a[2]=$=>o.value.id=$),onChange:a[3]||(a[3]=$=>v("id",$.target.checked))},{default:E(()=>a[66]||(a[66]=[D("Call ID")])),_:1,__:[66]},8,["checked"]),w(G,{checked:o.value.order,"onUpdate:checked":a[4]||(a[4]=$=>o.value.order=$),onChange:a[5]||(a[5]=$=>v("order",$.target.checked))},{default:E(()=>a[67]||(a[67]=[D("Order")])),_:1,__:[67]},8,["checked"]),w(G,{checked:o.value.status,"onUpdate:checked":a[6]||(a[6]=$=>o.value.status=$),onChange:a[7]||(a[7]=$=>v("status",$.target.checked))},{default:E(()=>a[68]||(a[68]=[D("Status")])),_:1,__:[68]},8,["checked"]),w(G,{checked:o.value.created,"onUpdate:checked":a[8]||(a[8]=$=>o.value.created=$),onChange:a[9]||(a[9]=$=>v("created",$.target.checked))},{default:E(()=>a[69]||(a[69]=[D("Created Time")])),_:1,__:[69]},8,["checked"]),w(G,{checked:o.value.completed,"onUpdate:checked":a[10]||(a[10]=$=>o.value.completed=$),onChange:a[11]||(a[11]=$=>v("completed",$.target.checked))},{default:E(()=>a[70]||(a[70]=[D("Completed Time")])),_:1,__:[70]},8,["checked"])])]),e("div",Bd,[a[76]||(a[76]=e("h5",null,"Configuration",-1)),e("div",jd,[w(G,{checked:o.value.configuration,"onUpdate:checked":a[12]||(a[12]=$=>o.value.configuration=$),onChange:a[13]||(a[13]=$=>v("configuration",$.target.checked))},{default:E(()=>a[72]||(a[72]=[D("Configuration Name")])),_:1,__:[72]},8,["checked"]),w(G,{checked:o.value.provider,"onUpdate:checked":a[14]||(a[14]=$=>o.value.provider=$),onChange:a[15]||(a[15]=$=>v("provider",$.target.checked))},{default:E(()=>a[73]||(a[73]=[D("Provider")])),_:1,__:[73]},8,["checked"]),w(G,{checked:o.value.modelId,"onUpdate:checked":a[16]||(a[16]=$=>o.value.modelId=$),onChange:a[17]||(a[17]=$=>v("modelId",$.target.checked))},{default:E(()=>a[74]||(a[74]=[D("Model ID")])),_:1,__:[74]},8,["checked"]),w(G,{checked:o.value.parameters,"onUpdate:checked":a[18]||(a[18]=$=>o.value.parameters=$),onChange:a[19]||(a[19]=$=>v("parameters",$.target.checked))},{default:E(()=>a[75]||(a[75]=[D("Parameters")])),_:1,__:[75]},8,["checked"])])]),e("div",qd,[a[81]||(a[81]=e("h5",null,"Content",-1)),e("div",Gd,[w(G,{checked:o.value.prompt,"onUpdate:checked":a[20]||(a[20]=$=>o.value.prompt=$),onChange:a[21]||(a[21]=$=>v("prompt",$.target.checked))},{default:E(()=>a[77]||(a[77]=[D("Prompt")])),_:1,__:[77]},8,["checked"]),w(G,{checked:o.value.variables,"onUpdate:checked":a[22]||(a[22]=$=>o.value.variables=$),onChange:a[23]||(a[23]=$=>v("variables",$.target.checked))},{default:E(()=>a[78]||(a[78]=[D("Variables")])),_:1,__:[78]},8,["checked"]),w(G,{checked:o.value.response,"onUpdate:checked":a[24]||(a[24]=$=>o.value.response=$),onChange:a[25]||(a[25]=$=>v("response",$.target.checked))},{default:E(()=>a[79]||(a[79]=[D("Response")])),_:1,__:[79]},8,["checked"]),w(G,{checked:o.value.parsedResponse,"onUpdate:checked":a[26]||(a[26]=$=>o.value.parsedResponse=$),onChange:a[27]||(a[27]=$=>v("parsedResponse",$.target.checked))},{default:E(()=>a[80]||(a[80]=[D("Parsed Response")])),_:1,__:[80]},8,["checked"])])]),e("div",Kd,[a[87]||(a[87]=e("h5",null,"Performance",-1)),e("div",Jd,[w(G,{checked:o.value.latency,"onUpdate:checked":a[28]||(a[28]=$=>o.value.latency=$),onChange:a[29]||(a[29]=$=>v("latency",$.target.checked))},{default:E(()=>a[82]||(a[82]=[D("Latency (ms)")])),_:1,__:[82]},8,["checked"]),w(G,{checked:o.value.promptTokens,"onUpdate:checked":a[30]||(a[30]=$=>o.value.promptTokens=$),onChange:a[31]||(a[31]=$=>v("promptTokens",$.target.checked))},{default:E(()=>a[83]||(a[83]=[D("Prompt Tokens")])),_:1,__:[83]},8,["checked"]),w(G,{checked:o.value.completionTokens,"onUpdate:checked":a[32]||(a[32]=$=>o.value.completionTokens=$),onChange:a[33]||(a[33]=$=>v("completionTokens",$.target.checked))},{default:E(()=>a[84]||(a[84]=[D("Completion Tokens")])),_:1,__:[84]},8,["checked"]),w(G,{checked:o.value.totalTokens,"onUpdate:checked":a[34]||(a[34]=$=>o.value.totalTokens=$),onChange:a[35]||(a[35]=$=>v("totalTokens",$.target.checked))},{default:E(()=>a[85]||(a[85]=[D("Total Tokens")])),_:1,__:[85]},8,["checked"]),w(G,{checked:o.value.cost,"onUpdate:checked":a[36]||(a[36]=$=>o.value.cost=$),onChange:a[37]||(a[37]=$=>v("cost",$.target.checked))},{default:E(()=>a[86]||(a[86]=[D("Cost (USD)")])),_:1,__:[86]},8,["checked"])])]),e("div",Qd,[a[92]||(a[92]=e("h5",null,"Technical Details",-1)),e("div",Yd,[w(G,{checked:o.value.request,"onUpdate:checked":a[38]||(a[38]=$=>o.value.request=$),onChange:a[39]||(a[39]=$=>v("request",$.target.checked))},{default:E(()=>a[88]||(a[88]=[D("Full Request")])),_:1,__:[88]},8,["checked"]),w(G,{checked:o.value.response_raw,"onUpdate:checked":a[40]||(a[40]=$=>o.value.response_raw=$),onChange:a[41]||(a[41]=$=>v("response_raw",$.target.checked))},{default:E(()=>a[89]||(a[89]=[D("Raw Response")])),_:1,__:[89]},8,["checked"]),w(G,{checked:o.value.error,"onUpdate:checked":a[42]||(a[42]=$=>o.value.error=$),onChange:a[43]||(a[43]=$=>v("error",$.target.checked))},{default:E(()=>a[90]||(a[90]=[D("Error Details")])),_:1,__:[90]},8,["checked"]),w(G,{checked:o.value.repeatIndex,"onUpdate:checked":a[44]||(a[44]=$=>o.value.repeatIndex=$),onChange:a[45]||(a[45]=$=>v("repeatIndex",$.target.checked))},{default:E(()=>a[91]||(a[91]=[D("Repeat Index")])),_:1,__:[91]},8,["checked"])])]),T.value.length>0?(n(),i("div",Xd,[a[93]||(a[93]=e("h5",null,"Parameters (Individual Columns)",-1)),e("div",Zd,[(n(!0),i(Z,null,te(T.value,$=>(n(),Q(G,{key:$.id,checked:o.value[$.id],"onUpdate:checked":q=>o.value[$.id]=q,onChange:q=>v($.id,q.target.checked)},{default:E(()=>[D(y($.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):R("",!0),h.value.length>0?(n(),i("div",ec,[a[94]||(a[94]=e("h5",null,"Attributes (Individual Columns)",-1)),e("div",tc,[(n(!0),i(Z,null,te(h.value,$=>(n(),Q(G,{key:$.id,checked:o.value[$.id],"onUpdate:checked":q=>o.value[$.id]=q,onChange:q=>v($.id,q.target.checked)},{default:E(()=>[D(y($.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):R("",!0)])])),e("div",sc,[a[99]||(a[99]=e("h4",null,"Export Preview",-1)),e("div",ac,[e("div",lc,[a[96]||(a[96]=e("span",{class:"label"},"Records:",-1)),e("span",nc,y(x.value),1)]),e("div",oc,[a[97]||(a[97]=e("span",{class:"label"},"Fields:",-1)),e("span",ic,y(f.value.length),1)]),e("div",rc,[a[98]||(a[98]=e("span",{class:"label"},"Estimated Size:",-1)),e("span",uc,y(W.value),1)])])]),e("div",dc,[w(M,{onClick:K},{default:E(()=>a[100]||(a[100]=[D("Cancel")])),_:1,__:[100]}),w(M,{type:"primary",onClick:X,loading:k.value,disabled:f.value.length===0},{default:E(()=>[w(z(Ns)),a[101]||(a[101]=D(" Export "))]),_:1,__:[101]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),pc=ae(cc,[["__scopeId","data-v-34965650"]]);class fc{constructor(){de(this,"subscription",null);de(this,"progressSubscription",null);de(this,"store",Ie());de(this,"v4Control",xt());de(this,"isActive",!1);de(this,"currentTrialId",null)}async startStreaming(t){const s=performance.now();this.cleanupSubscriptions();const d=performance.now();`${(d-s).toFixed(1)}`,this.isActive=!0,`${(d-s).toFixed(1)}`,this.currentTrialId=t,this.store.setCurrentTrial(t),this.store.setStreaming(!0),`${(performance.now()-d).toFixed(1)}`;const r=performance.now();await this.loadHistoricalData(t),`${(performance.now()-r).toFixed(1)}`;const k=performance.now(),S=this.v4Control.getActiveStreams(t);if(`${(performance.now()-k).toFixed(1)}`,!S){const C=await ze.trials.get(t);if(C&&C.status==="running"){let T=0;const h=5,P=setInterval(()=>{T++;const _=this.v4Control.getActiveStreams(t);_?(clearInterval(P),this.connectToTrialStream(t,_)):T>=h&&clearInterval(P)},500)}else`${C?.status||"NOT_FOUND"}`;return}this.connectToTrialStream(t,S)}connectToTrialStream(t,s){this.isActive=!0;const d=s.callsSubject||s.sharedCalls$;`${d?.constructor?.name}`,`${d?.constructor?.name}`,this.subscription=d.subscribe({next:p=>{if(p&&p.length>0){`${p.length}`;const r=[...this.store.apiCalls.value];p.forEach(f=>{const k=r.findIndex(S=>S.id===f.id);k>=0?r[k]=f:r.push(f)}),r.sort((f,k)=>{const S=T=>{switch(T){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},o=S(f.status),C=S(k.status);if(o!==C)return o-C;if(f.status==="completed"&&k.status==="completed"){const T=f.completed?new Date(f.completed).getTime():0;return(k.completed?new Date(k.completed).getTime():0)-T}if(f.status==="running"&&k.status==="running"){const T=f.started?new Date(f.started).getTime():0;return(k.started?new Date(k.started).getTime():0)-T}return f.order-k.order}),this.store.updateApiCalls(r)}},error:p=>{V.error("V4_STREAM_CONNECT: Stream error:",p),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(t)}}),s.sharedProgress$&&(s.sharedProgress$,this.progressSubscription=s.sharedProgress$.subscribe({next:p=>{p.type,`${p.type}`,`${p.type}${new Date().toISOString()}`,p.type==="completed"&&this.loadHistoricalData(t).then(()=>{}).catch(r=>{V.error("V4_TRIAL_COMPLETION: Failed to load final data:",r)}),this.store.updateProgress(p)},error:p=>{V.error("V4_STREAM_CONNECT: Progress stream error:",p)}}))}cleanupSubscriptions(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){`${this.currentTrialId}`,`${this.isActive}`,this.cleanupSubscriptions(),this.isActive=!1}async loadHistoricalData(t){const s=performance.now();try{`${(performance.now()-s).toFixed(1)}`,`${(performance.now()-s).toFixed(1)}`;const r=performance.now();`${(r-s).toFixed(1)}`;const f=await ze.apiCalls.where("trialId").equals(t).toArray(),k=performance.now();`${f.length}${(k-r).toFixed(1)}`,`${(k-s).toFixed(1)}`;const S=performance.now();f.sort((P,_)=>{const b=A=>{switch(A){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},x=b(P.status),W=b(_.status);if(x!==W)return x-W;if(P.status==="completed"&&_.status==="completed"){const A=P.completed?new Date(P.completed).getTime():0;return(_.completed?new Date(_.completed).getTime():0)-A}if(P.status==="running"&&_.status==="running"){const A=P.started?new Date(P.started).getTime():0;return(_.started?new Date(_.started).getTime():0)-A}return P.order-_.order});const o=performance.now();`${f.length}${(o-S).toFixed(1)}`;const C=performance.now();this.store.updateApiCalls(f),this.store.setStreaming(!1),`${(performance.now()-C).toFixed(1)}`,`${this.isActive}`,`${(performance.now()-s).toFixed(1)}`}catch(d){V.error("STREAM_MGR_V4: Failed to load historical data:",d),this.store.clear()}}destroy(){this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let Fe=null;function Ut(){return Fe||(Fe=new fc),Fe}typeof window<"u"&&(window.__trialStreamManagerV4=()=>Fe);const vc={class:"trial-details-panel"},mc={key:0,class:"loading-state"},gc={key:1,class:"error-state"},hc={class:"error-actions"},yc=le({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(l){const t=l,s=xe(),d=j(!1),p=j(null),r=j(!1),f=Ut(),k=U(()=>t.executionState?.status==="executing"&&t.executionState?.currentTrialId===t.trial?.id);function S(){p.value=null}function o(){s.push("/trials")}function C(){r.value=!0}async function T(){if(t.trial){`${t.trial.id}`;try{f.isActive&&f.currentTrialId===t.trial.id&&f.stopStreaming(),await f.loadHistoricalData(t.trial.id),`${t.trial.id}`,(t.trial.status==="running"||t.trial.status==="paused")&&await f.startStreaming(t.trial.id)}catch(h){V.error("REFRESH: Failed to refresh trial data:",h)}}}return oe(()=>t.trial,(h,P)=>{h&&h.id!==P?.id&&(p.value=null,V.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${P?.id} to ${h.id}`))}),ce(()=>{const h=t.trial?.id;V.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${h}`)}),we(()=>{const h=t.trial?.id;V.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${h}`)}),Se(()=>{const h=t.trial?.id;V.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${h}`)}),ge(()=>{const h=t.trial?.id;V.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${h}`)}),(h,P)=>{const _=pe;return n(),i("div",vc,[d.value?(n(),i("div",mc,[w(z(Ct),{class:"loading-spinner",spin:""}),P[9]||(P[9]=e("span",null,"Loading trial details...",-1))])):p.value?(n(),i("div",gc,[w(z(Ce),{class:"error-icon"}),P[12]||(P[12]=e("h3",null,"Failed to load trial",-1)),e("p",null,y(p.value),1),e("div",hc,[w(_,{onClick:S},{default:E(()=>P[10]||(P[10]=[D("Retry")])),_:1,__:[10]}),w(_,{type:"link",onClick:o},{default:E(()=>P[11]||(P[11]=[D("Go Back")])),_:1,__:[11]})])])):h.trial?(n(),i(Z,{key:2},[w(Cl,{trial:h.trial,progress:h.progress,"is-executing":k.value},null,8,["trial","progress","is-executing"]),w(El,{trial:h.trial,"is-leader":h.isLeader,"execution-state":h.executionState,onStart:P[0]||(P[0]=b=>h.$emit("start-trial")),onPause:P[1]||(P[1]=b=>h.$emit("pause-trial")),onResume:P[2]||(P[2]=b=>h.$emit("resume-trial")),onCancel:P[3]||(P[3]=b=>h.$emit("cancel-trial")),onDuplicate:P[4]||(P[4]=b=>h.$emit("duplicate-trial",h.trial.id)),onEdit:P[5]||(P[5]=b=>h.$emit("edit-trial",h.trial.id)),onDelete:P[6]||(P[6]=b=>h.$emit("delete-trial",h.trial.id)),onExportData:C,onExportPython:P[7]||(P[7]=b=>h.$emit("export-python",h.trial.id)),onRefresh:T},null,8,["trial","is-leader","execution-state"]),h.trial&&r.value?(n(),Q(pc,{key:0,visible:r.value,trial:h.trial,"onUpdate:visible":P[8]||(P[8]=b=>r.value=!1)},null,8,["visible","trial"])):R("",!0),w(Fd,{trial:h.trial,progress:h.progress,"is-leader":h.isLeader,"execution-state":h.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):R("",!0)])}}}),_c=ae(yc,[["__scopeId","data-v-081db72e"]]),bc={class:"import-content"},$c={class:"upload-section"},Tc={class:"ant-upload-drag-icon"},kc={key:0,class:"preview-section"},Cc={class:"bundle-details"},wc={class:"detail-row"},Sc={class:"value"},Ic={class:"detail-row"},Rc={class:"value"},Pc={class:"detail-row"},Ec={class:"value"},Vc={class:"detail-row"},Ac={class:"value"},Fc={key:0,style:{color:"green","margin-left":"8px"}},xc={key:1,style:{color:"orange","margin-left":"8px"}},Lc={key:0,class:"detail-row"},Dc={class:"value"},Oc={class:"detail-row"},Mc={class:"value"},Uc={class:"import-options"},Nc={key:0,style:{"margin-bottom":"12px"}},Wc={key:1,style:{"margin-bottom":"12px",padding:"8px",background:"#f0f0f0","border-radius":"4px"}},zc={key:0,class:"warnings"},Hc={class:"modal-actions"},Bc=le({__name:"ImportTrialDialog",props:{visible:{type:Boolean}},emits:["update:visible","trial-imported"],setup(l,{emit:t}){const s=l,d=t,p=xe(),r=j([]),f=j(null),k=j(!1),S=j([]),o=j({mode:"draft",namePrefix:"Imported: "}),C=U({get:()=>s.visible,set:c=>d("update:visible",c)}),T=U(()=>f.value?.execution?.apiCalls&&f.value.execution.apiCalls.length>0);function h(c){return!1}async function P(c){const v=c.file.originFileObj||c.file;if(v)try{const F=await _(v),u=JSON.parse(F);S.value=b(u),f.value=u,u.execution?.apiCalls&&u.execution.apiCalls.length>0,o.value.mode="draft"}catch{Y.error("Failed to read bundle file: Invalid JSON format"),f.value=null}}function _(c){return new Promise((v,F)=>{const u=new FileReader;u.onload=g=>v(g.target?.result),u.onerror=F,u.readAsText(c)})}function b(c){const v=[];return c.version||v.push("Bundle version is missing"),c.configuration?.trial||v.push("Trial configuration is missing"),(!c.configuration?.variableLists||c.configuration.variableLists.length===0)&&v.push("No variable lists found in bundle"),c.version!=="1.0"&&v.push(`Bundle version ${c.version} may not be fully compatible`),v}function x(c){return new Date(c).toLocaleString()}function W(){r.value=[],f.value=null,S.value=[],C.value=!1}async function A(){if(!f.value){Y.error("No bundle to import");return}k.value=!0;try{const{trialBundleImportService:c}=await Qe(async()=>{const{trialBundleImportService:u}=await import("./trial-bundle.service-CUz6ufnV.js");return{trialBundleImportService:u}},__vite__mapDeps([0,1,2,3,4,5,6])),v=T.value&&o.value.mode==="completed",F=await c.importTrialBundle(JSON.stringify(f.value),{importResults:v,importAsCompleted:v,namePrefix:o.value.namePrefix||void 0});F.ok?(Y.success("Trial imported successfully!"),p.push(`/trials?trialId=${F.value.trialId}`),d("trial-imported",F.value.trialId),W()):Y.error(`Import failed: ${F.error.message}`)}catch(c){Y.error(`Import failed: ${c instanceof Error?c.message:"Unknown error"}`)}finally{k.value=!1}}return(c,v)=>{const F=Ws,u=Vt,g=Et,K=It,X=Le,L=pe,a=be;return n(),Q(a,{visible:C.value,"onUpdate:visible":v[3]||(v[3]=m=>C.value=m),title:"Import Trial Bundle",width:600,footer:null,"destroy-on-close":!0,class:"import-trial-modal"},{default:E(()=>[e("div",bc,[e("div",$c,[w(F,{fileList:r.value,"onUpdate:fileList":v[0]||(v[0]=m=>r.value=m),"before-upload":h,"max-count":1,accept:".json",onChange:P},{default:E(()=>[e("p",Tc,[w(z(kt))]),v[4]||(v[4]=e("p",{class:"ant-upload-text"},"Click or drag trial bundle file here",-1)),v[5]||(v[5]=e("p",{class:"ant-upload-hint"}," Supports .json files exported from trials ",-1))]),_:1,__:[4,5]},8,["fileList"])]),f.value?(n(),i("div",kc,[v[17]||(v[17]=e("h3",null,"Bundle Contents",-1)),e("div",Cc,[e("div",wc,[v[6]||(v[6]=e("span",{class:"label"},"Trial Name:",-1)),e("span",Sc,y(f.value.metadata.trialName),1)]),e("div",Ic,[v[7]||(v[7]=e("span",{class:"label"},"Export Date:",-1)),e("span",Rc,y(x(f.value.metadata.exportDate)),1)]),e("div",Pc,[v[8]||(v[8]=e("span",{class:"label"},"Status:",-1)),e("span",Ec,y(f.value.metadata.trialStatus),1)]),e("div",Vc,[v[9]||(v[9]=e("span",{class:"label"},"API Calls:",-1)),e("span",Ac,[D(y(f.value.metadata.apiCallCount)+" ",1),T.value?(n(),i("span",Fc," (with results) ")):(n(),i("span",xc," (configuration only) "))])]),f.value.configuration.template?(n(),i("div",Lc,[v[10]||(v[10]=e("span",{class:"label"},"Template:",-1)),e("span",Dc,y(f.value.configuration.template.name),1)])):R("",!0),e("div",Oc,[v[11]||(v[11]=e("span",{class:"label"},"Variable Lists:",-1)),e("span",Mc,y(f.value.configuration.variableLists?.length||0),1)])]),e("div",Uc,[v[16]||(v[16]=e("h4",null,"Import Options",-1)),T.value?(n(),i("div",Nc,[w(g,{value:o.value.mode,"onUpdate:value":v[1]||(v[1]=m=>o.value.mode=m),style:{display:"block"}},{default:E(()=>[w(u,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:E(()=>v[12]||(v[12]=[e("strong",null,"Import as Draft",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Create fresh trial ready to run new experiment ",-1)])),_:1,__:[12]}),w(u,{value:"completed",style:{display:"block"}},{default:E(()=>v[13]||(v[13]=[e("strong",null,"Import as Completed",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Preserve historical results for review/analysis ",-1)])),_:1,__:[13]})]),_:1},8,["value"])])):(n(),i("div",Wc,v[14]||(v[14]=[e("strong",null,"Draft Trial",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px"}}," This bundle contains configuration only - will import as draft ready to run ",-1)]))),w(K,{value:o.value.namePrefix,"onUpdate:value":v[2]||(v[2]=m=>o.value.namePrefix=m),placeholder:"Name prefix (optional)",style:{"margin-top":"8px"}},{prefix:E(()=>v[15]||(v[15]=[D("Name:")])),_:1},8,["value"])]),S.value.length>0?(n(),i("div",zc,[w(X,{message:"Import Warnings",type:"warning","show-icon":""},{description:E(()=>[e("ul",null,[(n(!0),i(Z,null,te(S.value,m=>(n(),i("li",{key:m},y(m),1))),128))])]),_:1})])):R("",!0)])):R("",!0),e("div",Hc,[w(L,{onClick:W},{default:E(()=>v[18]||(v[18]=[D("Cancel")])),_:1,__:[18]}),w(L,{type:"primary",onClick:A,loading:k.value,disabled:!f.value},{default:E(()=>[w(z(Tt)),v[19]||(v[19]=D(" Import Trial "))]),_:1,__:[19]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),jc=ae(Bc,[["__scopeId","data-v-1d9366d6"]]),qc={class:"trials-view-v3"},Gc={key:0,class:"provider-warning-banner"},Kc={class:"banner-content"},Jc={key:1,class:"observer-mode-banner"},Qc={class:"banner-content"},Yc={key:1,class:"loading-left-pane"},Xc={key:0,class:"no-selection"},Zc={key:0,class:"observer-note"},ep=le({__name:"TrialsViewV3",setup(l){const t=xt(),{trials:s}=Bs(),{enabledModels:d}=Ks(),{duplicateTrial:p,deleteTrial:r}=js(),f=Ut(),k=Je(),S=_t(),o=xe(),C=j(),T=j(!0),h=j(null),P=j(""),_=j("all"),b=j(-1),x=j(!1),W=j(!1),A=j(!1),c=U(()=>d.value.length>0),v=U(()=>!c.value&&!A.value),F=t.isLeader,u=t.execution,{trial:g}=qs(h),K=U(()=>{const O=g.value?.progress;return O?{trialId:h.value||"",...O,lastUpdated:new Date}:null}),X=U(()=>{let O=s.value;if(P.value){const B=P.value.toLowerCase();O=O.filter(ee=>{const fe=ee.name.toLowerCase().includes(B),ve=ee.templateConfig?.template?.toLowerCase().includes(B),ie=ee.configurations.some(ye=>ye.modelId.toLowerCase().includes(B)||ye.provider.toLowerCase().includes(B));return fe||ve||ie})}return _.value!=="all"&&(O=O.filter(B=>B.status===_.value)),O});async function L(){const O=S.query;if(O.duplicate){const B=O.duplicate,ee=await p(B);ee.ok?await o.push({path:"/trials/create",query:{duplicate:ee.value,edit:O.edit==="true"?"true":void 0}}):Y.error(`Failed to duplicate trial: ${ee.error?.message||"Unknown error"}`),await o.replace({query:{}});return}if(O.designId||O.promptSource){await o.push({path:"/trials/create",query:O});return}if(S.query.trialId){const B=S.query.trialId;m(B)}}function a(){if(h.value||s.value.length===0)return;const O=s.value.find(B=>B.status==="running");if(O){m(O.id);return}m(s.value[0].id)}async function m(O){const B=performance.now();V.info(`V4_TRIAL_SWITCH: Starting trial selection: ${O}`),h.value=O;const ee=performance.now();if(V.info(`V4_TRIAL_SWITCH: UI updated in ${(ee-B).toFixed(1)}ms`),s.value.length>0){const ie=X.value.findIndex(ye=>ye.id===O);ie>=0&&(b.value=ie)}const fe=performance.now();if(V.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${O} at ${(fe-B).toFixed(1)}ms`),f.startStreaming(O).catch(ie=>{V.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${O}`,ie)}),S.query.trialId!==O){const ie={...S.query};ie.trialId=O,ie.tab||(ie.tab="status"),o.push({path:"/trials",query:ie}),V.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${ie.tab}' at ${(performance.now()-B).toFixed(1)}ms`)}C.value&&C.value.closeMobileOverlay();const ve=performance.now();V.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(ve-B).toFixed(1)}ms`)}function I(O){P.value=O,b.value=-1}function H(O){_.value=O,b.value=-1}async function M(){Y.info("Refreshing trial list...")}function G(O){const B=X.value;if(B.length!==0){if((O.metaKey||O.ctrlKey)&&O.key==="k"){O.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(O.key==="j"||O.key==="ArrowDown")&&(O.preventDefault(),b.value=Math.min(b.value+1,B.length-1),b.value>=0&&(m(B[b.value].id),N(B[b.value].id))),(O.key==="k"||O.key==="ArrowUp")&&(O.preventDefault(),b.value=Math.max(b.value-1,0),m(B[b.value].id),N(B[b.value].id)),O.key==="Enter"&&h.value,O.key==="Escape"&&(P.value="",h.value=null,b.value=-1)}}function N(O){_e(()=>{const B=document.querySelector(`[data-trial-id="${O}"]`);B&&B.scrollIntoView({behavior:"smooth",block:"nearest"})})}function $(O){V.debug("Trial list panel resized",{width:O})}function q(O){V.debug("Mobile overlay changed",{visible:O})}function J(){A.value=!0}async function ne(){await o.push("/trials/create")}function re(){W.value=!0}function ue(O){M(),m(O)}async function Me(){if(h.value&&!x.value){x.value=!0,t.execution?.value,t.execution?.value?.status;try{h.value;const O=await t.startTrialWithStreaming(h.value);if(!O.ok){Y.error(O.error?.message||"Unknown error");return}await f.startStreaming(h.value);const B={...S.query};B.tab="tasks",o.replace({query:B})}finally{x.value=!1}}}async function Nt(){`${h.value}`,`${t.execution.value.status}`,`${t.isLeader.value}`;const O=await t.pauseExecution();O.ok?`${t.execution.value.status}`:(O.error.message,Y.error(O.error?.message||"Unknown error"))}async function Wt(){if(!h.value)return;`${h.value}`,`${t.execution.value.status}`,`${t.isLeader.value}`;const O=t.execution.value?.status||"idle",B=t.execution.value?.currentTrialId;if(O==="paused"&&B===h.value){`${h.value}`;const ee=await t.resumeExecution(h.value);ee.ok||(ee.error.message,Y.error(ee.error.message))}else{const ee=await t.startTrialWithStreaming(h.value);ee.ok?await f.startStreaming(h.value):(ee.error.message,Y.error(ee.error?.message||"Unknown error"))}}async function zt(){const O=await t.cancelExecution();O.ok||Y.error(O.error?.message||"Unknown error")}async function Ht(O){const B=await p(O);B.ok?(Y.success("Trial duplicated"),B.value&&m(B.value)):Y.error(B.error?.message||"Unknown error")}async function Bt(O){await o.push({path:"/trials/create",query:{duplicate:O,edit:"true"}})}async function jt(O){const B=await r(O);B.ok?(Y.success("Trial deleted"),h.value===O&&(h.value=null)):Y.error(B.error?.message||"Unknown error")}async function qt(O,B){const ee=await k.dataExport.exportTrialData(O,{format:B,fields:void 0,includeHeaders:!0,addBOM:B==="excel"});ee.ok?Y.success(`Exported ${ee.value.recordCount} API calls to ${ee.value.filename}`):Y.error(ee.error?.message||"Unknown error")}function Gt(O){Kt(O,"minimal")}async function Kt(O,B="classic"){if(B==="bundle"){const{usePythonBundleManagement:ee}=await Qe(async()=>{const{usePythonBundleManagement:ie}=await import("./python-bundle-management-CoItlPgO.js");return{usePythonBundleManagement:ie}},__vite__mapDeps([7,1,2,3,4,5,6,0])),{exportPythonBundle:fe}=ee(),ve=await fe(O,{includeApiKeys:!0,showProgress:!0});ve.ok||Y.error(ve.error?.message||"Bundle export failed")}else if(B==="minimal"){const ee=await k.pythonGeneration.generatePythonScript(O,{template:"minimal",includeComments:!0});ee.ok?Y.success("Minimal Python script exported"):Y.error(ee.error?.message||"Minimal export failed")}else{const ee=await k.pythonGeneration.generatePythonScript(O,{template:"minimal",includeComments:!0});ee.ok?Y.success("Python script exported"):Y.error(ee.error?.message||"Classic export failed")}}return oe(()=>S.query.trialId,O=>{O&&O!==h.value&&m(O)}),oe(T,(O,B)=>{const ee=performance.now();V.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${B} to ${O} at ${ee}`),O||V.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),oe(s,(O,B)=>{const ee=performance.now();V.info(`V4_TRIAL_SWITCH: trials array changed from ${B?.length||0} to ${O.length} trials at ${ee}`)},{immediate:!0}),ce(async()=>{const O=performance.now();V.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${O}`);const B=performance.now();V.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(B-O).toFixed(1)}ms`);try{await t.initialize();const Ue=performance.now();V.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(Ue-B).toFixed(1)}ms`)}catch(Ue){const Xt=performance.now();V.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(Xt-B).toFixed(1)}ms:`,Ue)}const ee=performance.now();window.addEventListener("keydown",G),V.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(ee-O).toFixed(1)}ms`);const fe=performance.now();V.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(fe-O).toFixed(1)}ms`),await _e();const ve=performance.now();V.info(`V4_TRIAL_SWITCH: nextTick completed in ${(ve-fe).toFixed(1)}ms`);const ie=performance.now();T.value=!1,V.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(ie-O).toFixed(1)}ms`);const ye=performance.now();V.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(ye-O).toFixed(1)}ms`),await L();const Jt=performance.now();V.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Jt-ye).toFixed(1)}ms`);const st=performance.now();V.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(st-O).toFixed(1)}ms`),a();const Qt=performance.now();V.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Qt-st).toFixed(1)}ms`);const Yt=performance.now();V.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(Yt-O).toFixed(1)}ms`)}),ge(()=>{window.removeEventListener("keydown",G),f.destroy()}),(O,B)=>{const ee=vt("router-link"),fe=pe;return n(),i("div",qc,[v.value?(n(),i("div",Gc,[e("div",Kc,[w(z(Ce),{class:"warning-icon"}),B[2]||(B[2]=e("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),w(ee,{to:"/settings",class:"settings-link"},{default:E(()=>B[1]||(B[1]=[D("Go to Settings")])),_:1,__:[1]}),w(z($t),{class:"close-icon",onClick:J})]),B[3]||(B[3]=e("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):R("",!0),z(F)?R("",!0):(n(),i("div",Jc,[e("div",Qc,[w(z(St),{class:"observer-icon"}),B[4]||(B[4]=e("span",null,[e("strong",null,"Observer Mode: Multiple Tabs Detected")],-1)),B[5]||(B[5]=e("div",{class:"leader-hint"}," You can only open one Auditomatic tab at a time. Close other tabs, or refresh if this is your only tab. Your templates and trials are safely saved. ",-1))])])),w(Ys,{ref_key:"splitPanel",ref:C,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:$,onMobileOverlayChange:q},{left:E(()=>[T.value?(n(),i("div",Yc," Loading trials... ")):(n(),Q(rl,{key:0,trials:z(s),"selected-trial-id":h.value,"search-query":P.value,"filter-status":_.value,onSelectTrial:m,onCreateTrial:ne,onImportTrial:re,onUpdateSearch:I,onUpdateFilter:H,onRefresh:M},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:E(()=>[(n(),Q(Be,{max:5},[h.value?(n(),Q(_c,{key:h.value,trial:z(g),"is-leader":z(F),"execution-state":z(u),progress:K.value,onStartTrial:Me,onPauseTrial:Nt,onResumeTrial:Wt,onCancelTrial:zt,onDuplicateTrial:Ht,onEditTrial:Bt,onDeleteTrial:jt,onExportData:qt,onExportPython:Gt},null,8,["trial","is-leader","execution-state","progress"])):R("",!0)],1024)),!h.value||!z(g)?Te((n(),i("div",Xc,[w(z(Pt),{class:"empty-icon"}),B[7]||(B[7]=e("h3",null,"Select a trial to view details",-1)),B[8]||(B[8]=e("p",null,"Choose from the list or create a new one",-1)),w(fe,{type:"primary",size:"large",disabled:!z(F),onClick:ne},{default:E(()=>B[6]||(B[6]=[D(" Create New Trial ")])),_:1,__:[6]},8,["disabled"]),z(F)?R("",!0):(n(),i("div",Zc," Close other tabs to enable trial creation "))],512)),[[ht,!T.value]]):R("",!0)]),_:1},512),w(jc,{visible:W.value,"onUpdate:visible":B[0]||(B[0]=ve=>W.value=ve),onTrialImported:ue},null,8,["visible"])])}}}),vp=ae(ep,[["__scopeId","data-v-f189422f"]]);export{vp as default};

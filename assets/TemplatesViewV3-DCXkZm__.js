import{d as ee,c as $,f as b,o as te,w as re,$ as G,Z as o,Y as p,S as c,k as a,G as _,_ as q,V as g,R as y,W as ae,F as se,l as K,u as I,X as ce}from"./vue-vendor-DPw1dQYc.js";import{u as de}from"./useV4Templates-srXNjmpl.js";import{u as ue}from"./useV4TemplateCommands-B1a9P02B.js";import{a as pe}from"./useV4VariableLists-Ch2T_s1U.js";import{u as me,a as Y,h as le}from"./index-CMsjb5lT.js";import{M as ne,q as _e,v as fe,w as ve,L as ge,x as ye,T as be,y as he,m as oe,k,_ as ke,z as we,G as Ce,s as Te,H as xe,I as Ie,E as De,J as Le,K as $e,N as Ve,O as Se,Q as Oe,R as Ee,V as Ae,u as ze}from"./ui-vendor-Cd_RpDPr.js";import"./useV4LiveQuery-CU4Hu5jZ.js";import"./utils-vendor-CmlljHD3.js";import"./data-vendor-BDABXsBx.js";const Re={class:"import-defaults-content"},Ue={class:"section-header"},je={class:"item-content"},qe={class:"item-header"},Ne={class:"item-description"},Be={class:"item-meta"},Me={class:"section-header"},Fe={class:"item-content"},Pe={class:"item-header"},Ge={class:"item-description"},Ke={class:"item-meta"},Je={class:"modal-footer"},Qe=ee({__name:"ImportDefaultsModalV3",props:{open:{type:Boolean}},emits:["update:open","imported"],setup(Z,{emit:V}){const N=Z,B=V,D=me(),A=$({get:()=>N.open,set:i=>B("update:open",i)}),M=b("designs"),F=b(!1),z=b(!1),w=$(()=>{const i=D.templates.templates.value;return new Set(i.map(s=>s.name))}),L=$(()=>{const i=D.variableLists.value;return new Set(i.map(s=>s.name))}),C=b({}),h=b({}),R=b(!1),U=b(!1),S=b([{id:"default-1",name:"Simple Question",description:"A basic question-answering template",template:"Answer this question: {{question}}",variables:{question:{type:"value",placeholder:"Enter your question"}},category:"General",tags:["question","simple"],isDefault:!0},{id:"default-2",name:"Code Review",description:"Review code with language context",template:`Review this {{language}} code and provide feedback:

{{code}}`,variables:{language:{type:"list",listId:"default-list-1"},code:{type:"value",placeholder:"Paste your code here"}},category:"Development",tags:["code","review","development"],isDefault:!0},{id:"default-3",name:"Sentiment Analysis",description:"Analyze sentiment of text",template:'Analyze the sentiment of the following {{textType}}: "{{text}}". Is it positive, negative, or neutral?',variables:{textType:{type:"list",listId:"default-list-3"},text:{type:"value",placeholder:"Enter text to analyze"}},category:"Analysis",tags:["sentiment","analysis"],isDefault:!0},{id:"default-4",name:"Translation Request",description:"Translate text between languages",template:'Translate the following text from {{sourceLanguage}} to {{targetLanguage}}: "{{text}}"',variables:{sourceLanguage:{type:"list",listId:"default-list-1"},targetLanguage:{type:"list",listId:"default-list-1"},text:{type:"value",placeholder:"Text to translate"}},category:"Translation",tags:["translation","language"],isDefault:!0}]),T=b([{id:"default-list-1",name:"Common Programming Languages",description:"Popular programming languages",category:"simple",values:["JavaScript","Python","TypeScript","Java","C++","Go","Rust","Ruby"],itemCount:8},{id:"default-list-2",name:"Sentiment Types",description:"Common sentiment classifications",category:"simple",values:["positive","negative","neutral","mixed"],itemCount:4},{id:"default-list-3",name:"Text Types",description:"Different types of text content",category:"simple",values:["review","comment","article","tweet","email","message"],itemCount:6},{id:"default-list-4",name:"Refusal Phrases",description:"Common refusal indicators",category:"refusal",values:["I can't","I cannot","I'm unable","I won't","not possible","against my programming"],itemCount:6}]),J=$(()=>{const i=Object.values(C.value).some(t=>t),s=Object.values(h.value).some(t=>t);return i||s});te(()=>{P()}),re(()=>N.open,i=>{i&&P()});function P(){C.value={},h.value={},S.value.forEach(i=>{C.value[i.id]=!1}),T.value.forEach(i=>{h.value[i.id]=!1})}function Q(){S.value.forEach(i=>{w.value.has(i.name)||(C.value[i.id]=R.value)})}function H(){T.value.forEach(i=>{L.value.has(i.name)||(h.value[i.id]=U.value)})}async function W(){z.value=!0;try{const i=Object.entries(h.value).filter(([e,l])=>l).map(([e])=>e);for(const e of i){const l=T.value.find(r=>r.id===e);if(l){const r=await D.createVariableList(l.name,l.category,l.values,l.description);r.ok||Y.error(`Failed to import list ${l.name}:`,r.error)}}const s=Object.entries(C.value).filter(([e,l])=>l).map(([e])=>e);for(const e of s){const l=S.value.find(r=>r.id===e);if(l){const r={};for(const[m,O]of Object.entries(l.variables)){const f=O;if(f.type==="list"&&f.listId){const E=T.value.find(n=>n.id===f.listId);if(E){const n=D.variableLists.value.find(d=>d.name===E.name);n?r[m]={type:"list",listId:n.id}:r[m]=f}else r[m]=f}else r[m]=f}await D.templates.createTemplate({name:l.name,description:l.description,template:l.template,variables:r,category:l.category,tags:l.tags})||Y.error(`Failed to import template ${l.name}`)}}const t=s.length+i.length;t>0?k.success(`Successfully imported ${t} items`):k.info("No new items were imported"),B("imported"),j()}catch(i){Y.error("Import failed:",i),k.error("Failed to import selected items")}finally{z.value=!1}}function j(){A.value=!1}function X(i){switch(i){case"attributed":return"blue";case"refusal":return"red";default:return"green"}}return(i,s)=>{const t=_e,e=ve,l=be,r=ye,u=ge,m=fe,O=he,f=oe,E=ne;return p(),G(E,{open:A.value,"onUpdate:open":s[3]||(s[3]=n=>A.value=n),title:"Import Default Designs & Variables",width:"95vw",footer:null,onCancel:j,centered:!0,"body-style":{height:"90vh",overflow:"auto"},"data-testid":"modal-import-defaults"},{default:o(()=>[c("div",Re,[a(t,{type:"info",message:"Import pre-configured designs and variable lists",description:"Select which default designs and variable lists you want to import. These are carefully crafted templates for common LLM bias testing scenarios.","show-icon":!0,style:{marginBottom:"var(--spacing-xl)"}}),a(O,{activeKey:M.value,"onUpdate:activeKey":s[2]||(s[2]=n=>M.value=n)},{default:o(()=>[a(m,{key:"designs",tab:"Designs"},{default:o(()=>[c("div",Ue,[s[5]||(s[5]=c("h4",null,"Available Designs",-1)),a(e,{checked:R.value,"onUpdate:checked":s[0]||(s[0]=n=>R.value=n),onChange:Q,"data-testid":"checkbox-select-all-designs","aria-label":"Select all designs for import"},{default:o(()=>s[4]||(s[4]=[_(" Select All ")])),_:1,__:[4]},8,["checked"])]),a(u,{"data-source":S.value,loading:F.value,size:"small",class:"import-list"},{renderItem:o(({item:n})=>[a(r,null,{default:o(()=>[a(e,{checked:C.value[n.id],"onUpdate:checked":d=>C.value[n.id]=d,disabled:w.value.has(n.name)},{default:o(()=>[c("div",je,[c("div",qe,[c("strong",null,g(n.name),1),w.value.has(n.name)?(p(),G(l,{key:0,size:"small",color:"orange"},{default:o(()=>s[6]||(s[6]=[_(" Already Exists ")])),_:1,__:[6]})):q("",!0)]),c("div",Ne,g(n.description),1),c("div",Be,[(p(!0),y(se,null,ae(Object.keys(n.variables),d=>(p(),G(l,{key:d,size:"small"},{default:o(()=>[_(g(d),1)]),_:2},1024))),128))])])]),_:2},1032,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1}),a(m,{key:"variables",tab:"Variable Lists"},{default:o(()=>[c("div",Me,[s[8]||(s[8]=c("h4",null,"Available Variable Lists",-1)),a(e,{checked:U.value,"onUpdate:checked":s[1]||(s[1]=n=>U.value=n),onChange:H,"data-testid":"checkbox-select-all-variables","aria-label":"Select all variable lists for import"},{default:o(()=>s[7]||(s[7]=[_(" Select All ")])),_:1,__:[7]},8,["checked"])]),a(u,{"data-source":T.value,loading:F.value,size:"small",class:"import-list"},{renderItem:o(({item:n})=>[a(r,null,{default:o(()=>[a(e,{checked:h.value[n.id],"onUpdate:checked":d=>h.value[n.id]=d,disabled:L.value.has(n.name)},{default:o(()=>[c("div",Fe,[c("div",Pe,[c("strong",null,g(n.name),1),a(l,{size:"small",color:X(n.category)},{default:o(()=>[_(g(n.category),1)]),_:2},1032,["color"]),L.value.has(n.name)?(p(),G(l,{key:0,size:"small",color:"orange"},{default:o(()=>s[9]||(s[9]=[_(" Already Exists ")])),_:1,__:[9]})):q("",!0)]),c("div",Ge,g(n.description),1),c("div",Ke,g(n.itemCount)+" items ",1)])]),_:2},1032,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1})]),_:1},8,["activeKey"]),c("div",Je,[a(f,{onClick:j,size:"large",class:"footer-button","data-testid":"btn-cancel-import-defaults","aria-label":"Cancel import"},{default:o(()=>s[10]||(s[10]=[_(" Cancel ")])),_:1,__:[10]}),a(f,{type:"primary",onClick:W,loading:z.value,disabled:!J.value,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-confirm-import-defaults","aria-label":"Import selected designs and variables"},{default:o(()=>s[11]||(s[11]=[_(" Import Selected ")])),_:1,__:[11]},8,["loading","disabled"])])])]),_:1},8,["open"])}}}),He=le(Qe,[["__scopeId","data-v-b232c143"]]),We={class:"templates-view"},Xe={class:"view-header"},Ye={class:"header-actions"},Ze={key:0,class:"name-cell"},et={class:"template-name"},tt={key:0,class:"template-description"},at={key:1,class:"variables-cell"},st={key:0,class:"no-variables"},lt={key:1,class:"variable-calculation"},nt={class:"variable-name"},ot={class:"variable-count"},it={key:0,class:"operator"},rt={class:"total-combinations"},ct={key:2,class:"token-estimate"},dt={class:"token-count"},ut={key:3,class:"actions-cell"},pt=ee({__name:"TemplatesViewV3",setup(Z){const V=ce(),{templates:N,loading:B}=de(),{variableLists:D}=pe(),{duplicateTemplate:A,deleteTemplate:M,exportTemplates:F,isExecuting:z}=ue(),w=b(""),L=b(!1),C=$(()=>B.value||z.value),h=$(()=>N.value),R=$(()=>{if(!w.value.trim())return h.value;const t=w.value.toLowerCase();return h.value.filter(e=>e.name.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t)||e.tags.some(l=>l.toLowerCase().includes(t)))}),U=[{title:"Name",key:"name",dataIndex:"name",sorter:(t,e)=>t.name.localeCompare(e.name),width:250,ellipsis:!1},{title:"Variables",key:"variables",width:280},{title:"Tokens",key:"tokens",width:80,align:"center"},{title:"Created",key:"created",dataIndex:"created",sorter:(t,e)=>new Date(t.created).getTime()-new Date(e.created).getTime(),customRender:({value:t})=>new Date(t).toLocaleDateString(),width:100,align:"center"},{title:"Actions",key:"actions",width:90,align:"center"}];function S(t){return Object.keys(t.variables||{}).length}function T(t){const e=[],l=D.value;for(const[r,u]of Object.entries(t.variables||{})){let m=0;u.type==="list"&&u.listId?m=l.find(f=>f.id===u.listId)?.itemCount||0:u.values&&(m=u.values.length),e.push({name:r,count:m})}return e}function J(t){return Math.ceil(t.template.length/4)}function P(){V.push({name:"template-create"})}function Q(t){V.push({name:"template-edit",params:{id:t.id}})}async function H(t){const e=await A(t.id);e.ok?(k.success("Template duplicated successfully"),V.push({name:"template-edit",params:{id:e.value}})):k.error(`Failed to duplicate template: ${e.error.message}`)}async function W(t){ne.confirm({title:"Delete Template",content:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{const e=await M(t.id);e.ok?k.success("Template deleted successfully"):k.error(`Failed to delete template: ${e.error.message}`)}})}async function j(t){const e=await F([t.id]);if(e.ok){const l=new Blob([e.value],{type:"application/json"}),r=URL.createObjectURL(l),u=document.createElement("a");u.href=r,u.download=`${t.name.replace(/[^a-z0-9]/gi,"_")}_template.json`,u.click(),URL.revokeObjectURL(r),k.success("Template exported successfully")}else k.error(`Failed to export template: ${e.error.message}`)}function X(t){V.push({name:"trial-create",query:{designId:t.id,promptSource:"template"}})}function i(t){w.value=t}function s(){k.success("Default templates imported successfully")}return te(()=>{}),(t,e)=>{const l=ke,r=oe,u=xe,m=Se,O=Ae,f=Ve,E=Le,n=Te;return p(),y("div",We,[c("div",Xe,[e[5]||(e[5]=c("h1",null,"Template Prompts",-1)),c("div",Ye,[a(l,{value:w.value,"onUpdate:value":e[0]||(e[0]=d=>w.value=d),placeholder:"Search templates...",class:"search-input",style:{width:"300px"},onSearch:i},null,8,["value"]),a(r,{type:"default",onClick:e[1]||(e[1]=d=>L.value=!0),icon:K(I(we))},{default:o(()=>e[3]||(e[3]=[_(" Import Defaults ")])),_:1,__:[3]},8,["icon"]),a(r,{type:"primary",onClick:P,icon:K(I(Ce))},{default:o(()=>e[4]||(e[4]=[_(" New Template ")])),_:1,__:[4]},8,["icon"])])]),a(n,{columns:U,"data-source":R.value,loading:C.value,pagination:!1,scroll:{x:800,y:"calc(100vh - 280px)"},"row-key":d=>d.id,class:"templates-table"},{bodyCell:o(({column:d,record:v})=>[d.key==="name"?(p(),y("div",Ze,[c("div",et,g(v.name),1),v.description?(p(),y("div",tt,g(v.description),1)):q("",!0)])):d.key==="variables"?(p(),y("div",at,[S(v)===0?(p(),y("span",st," No variables ")):(p(),y("div",lt,[(p(!0),y(se,null,ae(T(v),(x,ie)=>(p(),y("span",{key:x.name,class:"variable-part"},[c("span",nt,g(x.name),1),c("span",ot,"("+g(x.count)+")",1),ie<T(v).length-1?(p(),y("span",it,"×")):q("",!0)]))),128)),e[6]||(e[6]=c("span",{class:"equals"},"=",-1)),c("span",rt,g(v.combinationCount||0)+" cases",1)]))])):d.key==="tokens"?(p(),y("div",ct,[a(u,{title:"Estimated tokens per prompt"},{default:o(()=>[c("span",dt,"~"+g(J(v)),1)]),_:2},1024)])):d.key==="actions"?(p(),y("div",ut,[a(u,{title:"Edit"},{default:o(()=>[a(r,{type:"link",size:"small",onClick:x=>Q(v),icon:K(I(Ie))},null,8,["onClick","icon"])]),_:2},1024),a(u,{title:"New Trial"},{default:o(()=>[a(r,{type:"link",size:"small",onClick:x=>X(v),icon:K(I(De))},null,8,["onClick","icon"])]),_:2},1024),a(E,null,{overlay:o(()=>[a(f,null,{default:o(()=>[a(m,{onClick:x=>H(v)},{default:o(()=>[a(I(Oe)),e[7]||(e[7]=_(" Duplicate "))]),_:2,__:[7]},1032,["onClick"]),a(m,{onClick:x=>j(v)},{default:o(()=>[a(I(Ee)),e[8]||(e[8]=_(" Export "))]),_:2,__:[8]},1032,["onClick"]),a(O),a(m,{onClick:x=>W(v),class:"danger-item"},{default:o(()=>[a(I(ze)),e[9]||(e[9]=_(" Delete "))]),_:2,__:[9]},1032,["onClick"])]),_:2},1024)]),default:o(()=>[a(r,{type:"link",size:"small"},{default:o(()=>[e[10]||(e[10]=_(" More ")),a(I($e))]),_:1,__:[10]})]),_:2},1024)])):q("",!0)]),_:1},8,["data-source","loading","row-key"]),a(He,{open:L.value,"onUpdate:open":e[2]||(e[2]=d=>L.value=d),onImported:s},null,8,["open"])])}}}),wt=le(pt,[["__scopeId","data-v-4c459eba"]]);export{wt as default};

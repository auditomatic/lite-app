const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webview-DLHLQmSD.js","assets/tauri-vendor-CZ7fMPM9.js"])))=>i.map(i=>d[i]);
import{d as ne,r as Q,f as C,c as ie,w as re,o as Re,y as ee,R as y,S as t,k as H,$ as W,_ as M,a0 as ue,V as g,u as O,Z as G,F as le,W as be,Y as d,a4 as Te,G as N,n as U,a7 as Ee,a8 as te,b as Ie,a2 as B,a3 as De,m as _e}from"./vue-vendor-DPw1dQYc.js";import{o as Pe,q as Fe,c as F,M as Oe,U as Le,j as oe,u as Me,a as I,v as Ke,A as Ne,d as j,w as $e,_ as Ve}from"./index-V1E7czL8.js";import{u as Be}from"./useV4Models-rJ6CsEGc.js";import{N as V,n as qe,a5 as ze,aF as Ge,a6 as We,x as fe}from"./ui-vendor-IRGmExUJ.js";import"./utils-vendor-B76-F3_P.js";import"./tauri-vendor-CZ7fMPM9.js";import"./useV4LiveQuery-Do0jdBW3.js";const je={class:"secure-api-keys-section"},Je={class:"section-header"},Ye={class:"security-overview"},He={class:"security-status"},Ze={class:"status-text"},Qe={class:"security-info-bar"},Xe={key:0,class:"first-time-setup"},et={key:1,class:"security-summary"},tt={class:"default-mode"},st={class:"mode"},nt={class:"key-counts"},ot={key:0,class:"count-item encrypted"},at={key:1,class:"count-item session"},it={key:2,class:"count-item plaintext"},lt={key:3,class:"count-item none"},rt={key:0,class:"no-providers"},ut={key:1,class:"providers-table"},dt={class:"provider-row"},ct={class:"provider-name"},pt={class:"provider-status"},mt={class:"security-mode-cell"},vt={class:"api-key-cell"},yt={class:"api-key-input-group"},ft={class:"actions-cell"},gt={class:"provider-details-row"},bt={colspan:"5",class:"provider-details"},kt={class:"detail-info"},wt={key:0},ht={key:1},St={key:2,class:"custom-url-indicator"},Ct=ne({__name:"SecureApiKeysSection",props:{onStatusMessage:{type:Function}},setup(J){const h=Pe(),l=Fe(),{modelsByProvider:i}=Be(),c=Q({}),S=Q({}),E=Q({}),b=C(!1),v=C(!1),L=C(!1),_=C(!1),T=C(!1),a=C(""),w=C(null),f=C(null),x=C(null),k=C(0),q=ie(()=>{if(k.value,!b.value)return[];const u=F.getAllGroups(),o=[];for(const n of u){if(n==="deterministic")continue;const e=F.getProvidersInGroup(n);if(e.length===0)continue;const s=e[0];if(!F.requiresApiKey(s.id))continue;const p=h.providers.get(n),r=n.charAt(0).toUpperCase()+n.slice(1),$=e.reduce((ye,xe)=>{const Ae=i.value[xe.id]||[];return ye+Ae.length},0),se=e.reduce((ye,xe)=>{const Ae=i.value[xe.id]||[];return ye+Ae.filter(Ue=>Ue.enabled).length},0);o.push({id:n,name:r,hasApiKey:!!h.getApiKey(n)||m(n),enabled:p?.enabled??!0,endpoints:e.map(ye=>ye.id),baseUrl:p?.baseUrl,totalModels:$,enabledModels:se})}return o}),A=ie(()=>l.securityStatus.value),Y=ie(()=>{const u=localStorage.getItem("v3-settings");if(!u)return{};try{const o=JSON.parse(u);return l.secureStorage.detectPlaintextKeys(o)}catch{return{}}});function Z(){return l.hasSetupApiKeySecurity()?!1:(_.value=!0,!0)}function z(u){return l.getEffectiveProviderMode(u)}function m(u){return l.hasApiKey(u)}function R(u){return z(u)==="encrypted"?l.hasApiKey(u)&&!l.isUnlocked.value:!1}function P(u){const o=m(u),n=R(u);return n&&o?"Click to unlock and view encrypted key":n&&!o?"Click to unlock and enter API key":o?"Key configured (hidden)":"Enter API key"}function D(){const{lockedProviderCount:u,sessionProviderCount:o,plaintextProviderCount:n}=A.value,e=u+o+n;return e===0?"none":n===e?"low":u>0?"high":"medium"}function de(){switch(D()){case"high":return"🔒";case"medium":return"⚠️";case"low":return"📝";default:return"❓"}}function X(){const{lockedProviderCount:u,sessionProviderCount:o,plaintextProviderCount:n}=A.value;if(u+o+n===0)return"No API keys configured";const s=[];return u>0&&s.push(`${u} encrypted`),o>0&&s.push(`${o} session-only`),n>0&&s.push(`${n} plaintext`),s.join(", ")}function ke(u){switch(u){case"encrypted":return"🔒";case"session":return"⚠️";case"plaintext":return"📝";default:return"📝"}}function K(u){switch(u){case"encrypted":return"Encrypted";case"session":return"Session Only";case"plaintext":return"Unencrypted";default:return"Unencrypted"}}function we(u){E[u]=!E[u]}function he(u){R(u)&&(T.value=!0)}async function ce(u,o){if(o==="encrypted"&&!l.hasMasterPassword.value){_.value=!0;return}L.value=!0;try{const n=await l.setProviderSecurityMode(u,o);if(!n.success){V.error(`Failed to change security mode: ${n.error}`);return}c[u]="",S[u]="",V.success(`Security mode changed to ${o}`),k.value++,await ee()}catch(n){const e=n instanceof Error?n.message:"Unknown error";V.error(`Failed to change security mode: ${e}`)}finally{L.value=!1}}async function pe(u){const o=S[u];if(!o||Z())return;const n=z(u);if(n==="encrypted"&&!l.isUnlocked.value){T.value=!0,f.value=u,x.value=o;return}v.value=!0;try{const e=await l.setApiKey(u,o,n);e.success?(V.success("API key saved successfully"),S[u]="",k.value++,await ee()):V.error(`Failed to save API key: ${e.error}`)}catch(e){const s=e instanceof Error?e.message:"Unknown error";V.error(`Failed to save API key: ${s}`)}finally{v.value=!1}}async function me(u){const o=c[u];if(o){v.value=!0;try{h.setApiKey(u,o),l.updateKeyCounts(),V.success("API key saved successfully"),c[u]="",k.value++,await ee()}finally{v.value=!1}}}async function ae(u){try{await l.clearApiKey(u),h.setApiKey(u,""),l.updateKeyCounts(),c[u]="",S[u]="",V.success("API key cleared"),k.value++,await ee()}catch(o){const n=o instanceof Error?o.message:"Unknown error";V.error(`Failed to clear API key: ${n}`)}}function ge(){l.lock(),V.info("All encrypted keys have been locked")}async function ve(u){try{const o=await l.unlock(u.password,u.rememberSession);if(o.success){if(T.value=!1,w.value?.handleUnlockSuccess(),V.success("API keys unlocked successfully"),f.value&&x.value){const n=f.value,e=x.value;f.value=null,x.value=null,v.value=!0;try{const s=z(n),p=await l.setApiKey(n,e,s);p.success?(V.success("API key saved successfully"),S[n]="",k.value++,await ee()):V.error(`Failed to save API key: ${p.error}`)}finally{v.value=!1}}}else w.value?.handleUnlockFailure(o.error||"Invalid password")}catch(o){const n=o instanceof Error?o.message:"Unknown error";w.value?.handleUnlockFailure(n)}}function Se(){fe.confirm({title:"Reset Auditomatic Local Store Password",content:"This will delete all encrypted API keys. You will need to re-enter them. Continue?",okText:"Yes, Reset",okType:"danger",onOk:async()=>{try{localStorage.removeItem("v3-security"),window.location.reload()}catch{V.error("Failed to reset password")}}})}async function Ce(u){if(_.value=!1,k.value++,await ee(),f.value&&x.value){const o=f.value,n=x.value;f.value=null,x.value=null,v.value=!0;try{const e=z(o),s=await l.setApiKey(o,n,e);s.success?(V.success("API key saved successfully"),S[o]=""):V.error(`Failed to save API key: ${s.error}`)}finally{v.value=!1}}await ee()}return re(()=>q.value,u=>{u.forEach(o=>{o.id in c||(c[o.id]=""),o.id in S||(S[o.id]=""),o.id in E||(E[o.id]=!1)})},{immediate:!0}),Re(async()=>{await F.waitForReady(),b.value=!0;const u=l.addEventListener(n=>{(n.type==="api_key_added"||n.type==="api_key_removed")&&k.value++}),o=Y.value;return Object.keys(o).length>0&&!l.hasMasterPassword.value&&ee(()=>{V.info({content:`${Object.keys(o).length} API keys found in insecure storage. Consider setting up encryption for better security.`,duration:10})}),()=>{u()}}),(u,o)=>{const n=qe,e=We,s=ze,p=Ge;return d(),y("div",je,[t("div",Je,[o[6]||(o[6]=t("h2",null,"API Keys",-1)),t("div",Ye,[t("div",He,[t("span",{class:ue(["security-indicator",D()])},g(de()),3),t("span",Ze,g(X()),1)]),O(l).isUnlocked.value?(d(),W(n,{key:0,size:"small",onClick:ge},{default:G(()=>o[5]||(o[5]=[N(" Lock All ")])),_:1,__:[5]})):M("",!0)])]),t("div",Qe,[O(l).hasSetupApiKeySecurity()?(d(),y("div",et,[t("div",tt,[o[10]||(o[10]=t("span",{class:"label"},"New keys will be stored as:",-1)),t("span",st,g(ke(O(l).getDefaultSecurityMode()))+" "+g(K(O(l).getDefaultSecurityMode())),1),H(n,{size:"small",onClick:o[1]||(o[1]=r=>_.value=!0)},{default:G(()=>o[9]||(o[9]=[N("Change")])),_:1,__:[9]})]),o[12]||(o[12]=t("div",{class:"divider"},"|",-1)),t("div",nt,[o[11]||(o[11]=t("span",{class:"label"},"Currently stored:",-1)),A.value.lockedProviderCount>0?(d(),y("span",ot," 🔒 "+g(A.value.lockedProviderCount)+" encrypted "+g(A.value.lockedProviderCount===1?"key":"keys"),1)):M("",!0),A.value.sessionProviderCount>0?(d(),y("span",at," ⚠️ "+g(A.value.sessionProviderCount)+" session-only "+g(A.value.sessionProviderCount===1?"key":"keys"),1)):M("",!0),A.value.plaintextProviderCount>0?(d(),y("span",it," 📝 "+g(A.value.plaintextProviderCount)+" unencrypted "+g(A.value.plaintextProviderCount===1?"key":"keys"),1)):M("",!0),A.value.lockedProviderCount+A.value.sessionProviderCount+A.value.plaintextProviderCount===0?(d(),y("span",lt," No API keys stored yet ")):M("",!0)]),!O(l).isUnlocked.value&&A.value.lockedProviderCount>0?(d(),W(n,{key:0,type:"primary",size:"small",onClick:o[2]||(o[2]=r=>T.value=!0)},{default:G(()=>[N(" Unlock "+g(A.value.lockedProviderCount)+" key"+g(A.value.lockedProviderCount===1?"":"s"),1)]),_:1})):M("",!0)])):(d(),y("div",Xe,[o[8]||(o[8]=t("span",null,"🔧 First time? Set up your default security mode:",-1)),H(n,{type:"primary",size:"small",onClick:o[0]||(o[0]=r=>_.value=!0)},{default:G(()=>o[7]||(o[7]=[N("Setup Security")])),_:1,__:[7]})]))]),q.value.length===0?(d(),y("div",rt,o[13]||(o[13]=[t("p",null,"No providers requiring API keys are currently configured.",-1)]))):(d(),y("table",ut,[o[20]||(o[20]=t("thead",null,[t("tr",null,[t("th",null,"Provider"),t("th",null,"Status"),t("th",null,"Security"),t("th",null,"API Key"),t("th",null,"Actions")])],-1)),t("tbody",null,[(d(!0),y(le,null,be(q.value,r=>(d(),y(le,{key:r.id},[t("tr",dt,[t("td",ct,[t("strong",null,g(r.name),1)]),t("td",pt,[t("span",{class:ue(["status-badge",{configured:r.hasApiKey}])},g(r.hasApiKey?"✓ Configured":"⚠️ Not set"),3)]),t("td",mt,[H(s,{value:z(r.id),onChange:$=>ce(r.id,$),class:"security-mode-select-compact",disabled:L.value,size:"small"},{default:G(()=>[H(e,{value:"encrypted"},{default:G(()=>o[14]||(o[14]=[N(" 🔒 Encrypted ")])),_:1,__:[14]}),H(e,{value:"session"},{default:G(()=>o[15]||(o[15]=[N(" ⚠️ Session ")])),_:1,__:[15]}),H(e,{value:"plaintext"},{default:G(()=>o[16]||(o[16]=[N(" 📝 Unencrypted ")])),_:1,__:[16]})]),_:2},1032,["value","onChange","disabled"])]),t("td",vt,[t("div",yt,[z(r.id)!=="plaintext"?(d(),W(p,{key:0,value:S[r.id],"onUpdate:value":$=>S[r.id]=$,type:E[r.id]?"text":"password",placeholder:P(r.id),class:"api-key-input-compact",size:"small",onFocus:$=>he(r.id),onKeyup:Te($=>pe(r.id),["enter"])},null,8,["value","onUpdate:value","type","placeholder","onFocus","onKeyup"])):(d(),W(p,{key:1,value:c[r.id],"onUpdate:value":$=>c[r.id]=$,type:E[r.id]?"text":"password",placeholder:r.hasApiKey?"Key configured":"Enter API key",class:"api-key-input-compact",size:"small",onKeyup:Te($=>me(r.id),["enter"])},null,8,["value","onUpdate:value","type","placeholder","onKeyup"])),H(n,{onClick:$=>we(r.id),size:"small",disabled:R(r.id)},{default:G(()=>[N(g(E[r.id]?"🙈":"👁️"),1)]),_:2},1032,["onClick","disabled"])])]),t("td",ft,[z(r.id)!=="plaintext"?(d(),W(n,{key:0,onClick:$=>pe(r.id),disabled:!S[r.id]||v.value,loading:v.value,type:"primary",size:"small"},{default:G(()=>o[17]||(o[17]=[N(" Save ")])),_:2,__:[17]},1032,["onClick","disabled","loading"])):(d(),W(n,{key:1,onClick:$=>me(r.id),disabled:!c[r.id]||v.value,loading:v.value,type:"primary",size:"small"},{default:G(()=>o[18]||(o[18]=[N(" Save ")])),_:2,__:[18]},1032,["onClick","disabled","loading"])),r.hasApiKey||m(r.id)?(d(),W(n,{key:2,onClick:$=>ae(r.id),disabled:v.value,size:"small"},{default:G(()=>o[19]||(o[19]=[N(" Clear ")])),_:2,__:[19]},1032,["onClick","disabled"])):M("",!0)])]),t("tr",gt,[t("td",bt,[t("span",kt,[N(g(r.endpoints.length)+" endpoint"+g(r.endpoints.length===1?"":"s")+" · ",1),r.hasApiKey?(d(),y("span",wt,g(r.enabledModels)+"/"+g(r.totalModels)+" models enabled ",1)):(d(),y("span",ht,g(r.totalModels)+" models available ",1)),r.baseUrl?(d(),y("span",St," · Custom URL configured")):M("",!0)])])])],64))),128))])])),H(Oe,{open:_.value,"migration-keys":Y.value,onClose:o[3]||(o[3]=r=>_.value=!1),onSuccess:Ce},null,8,["open","migration-keys"]),H(Le,{open:T.value,"locked-provider-count":A.value.lockedProviderCount,"password-hint":a.value,ref_key:"unlockModalRef",ref:w,onUnlock:ve,onReset:Se,onClose:o[4]||(o[4]=r=>T.value=!1)},null,8,["open","locked-provider-count","password-hint"])])}}}),xt=oe(Ct,[["__scopeId","data-v-d232a39b"]]),At={class:"preferences-section"},$t={class:"preferences-content"},Pt={class:"preference-item"},Mt={class:"preference-item environmental-costs"},Tt={class:"environmental-options"},Rt={class:"checkbox-item mandatory"},Ut={class:"checkbox-label disabled"},Et=["checked"],It={class:"checkbox-item"},Dt={class:"checkbox-label"},_t={class:"checkbox-item"},Ft={class:"checkbox-label"},Ot=ne({__name:"PreferencesSection",props:{onStatusMessage:{type:Function}},setup(J){const h=Me(),l=Pe(),i=J,c=Q({theme:"system",showCO2:!0,showWater:!0,showElectricity:!0});re(()=>h.settings.core.preferences.value,b=>{c.theme=b.theme},{immediate:!0}),re(()=>l.preferences,b=>{c.showCO2=b.showCO2,c.showWater=b.showWater,c.showElectricity=b.showElectricity},{immediate:!0,deep:!0});async function S(){const b=await h.settings.core.setTheme(c.theme);b.ok?i.onStatusMessage?.("Theme updated","success"):i.onStatusMessage?.(`Failed to update theme: ${b.error.message}`,"error")}async function E(){try{l.setEnvironmentalDisplaySettings({showCO2:c.showCO2,showWater:c.showWater,showElectricity:c.showElectricity}),i.onStatusMessage?.("Environmental display settings updated","success")}catch(b){i.onStatusMessage?.(`Failed to update settings: ${b}`,"error")}}return(b,v)=>(d(),y("div",At,[v[11]||(v[11]=t("h2",null,"Preferences",-1)),v[12]||(v[12]=t("p",{class:"tab-description"},"Configure application behavior and appearance.",-1)),t("div",$t,[t("div",Pt,[v[4]||(v[4]=t("label",{for:"theme-select"},"Theme:",-1)),U(t("select",{id:"theme-select","onUpdate:modelValue":v[0]||(v[0]=L=>c.theme=L),onChange:S,class:"preference-select"},v[3]||(v[3]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)]),544),[[Ee,c.theme]])]),t("div",Mt,[v[10]||(v[10]=t("label",null,"Environmental Cost Display:",-1)),t("div",Tt,[t("div",Rt,[t("label",Ut,[t("input",{type:"checkbox",checked:c.showCO2,disabled:"",class:"preference-checkbox"},null,8,Et),v[5]||(v[5]=t("span",null,"CO₂ Emissions",-1)),v[6]||(v[6]=t("span",{class:"mandatory-badge"},"Always shown",-1))]),v[7]||(v[7]=t("span",{class:"help-text"},"CO₂ tracking cannot be disabled to maintain awareness of climate impact.",-1))]),t("div",It,[t("label",Dt,[U(t("input",{type:"checkbox","onUpdate:modelValue":v[1]||(v[1]=L=>c.showWater=L),onChange:E,class:"preference-checkbox"},null,544),[[te,c.showWater]]),v[8]||(v[8]=t("span",null,"💧 Water Usage",-1))])]),t("div",_t,[t("label",Ft,[U(t("input",{type:"checkbox","onUpdate:modelValue":v[2]||(v[2]=L=>c.showElectricity=L),onChange:E,class:"preference-checkbox"},null,544),[[te,c.showElectricity]]),v[9]||(v[9]=t("span",null,"⚡ Electricity Consumption",-1))])])])])])]))}}),Lt=oe(Ot,[["__scopeId","data-v-0dac0274"]]),Kt={class:"performance-recorder"},Nt={class:"recorder-controls"},Vt=["disabled"],Bt=["disabled"],qt=["disabled"],zt={class:"recorder-status"},Gt={key:0,class:"status recording"},Wt={key:1,class:"status ready"},jt={key:2,class:"status idle"},Jt={key:0,class:"export-result"},Yt=ne({__name:"PerformanceRecorder",setup(J){const h=C(!1),l=C(!1),i=C([]),c=C(""),S=C(0),E=C(0),b=ie(()=>i.value.length>0);let v=null,L=null,_=null;function T(){h.value?w():a()}function a(){if(h.value=!0,S.value=Date.now(),E.value=0,i.value=[],v=window.setInterval(f,100),L=window.setInterval(()=>{E.value=Math.floor((Date.now()-S.value)/1e3)},1e3),"PerformanceObserver"in window)try{_=new PerformanceObserver(m=>{const R=m.getEntries(),P={};if(R.forEach(D=>{D.entryType==="paint"&&(P[D.name.replace("-","")]=D.startTime),D.entryType==="largest-contentful-paint"&&(P.largestContentfulPaint=D.startTime)}),i.value.length>0){const D=i.value[i.value.length-1];D.paint={...D.paint,...P}}}),_.observe({entryTypes:["paint","largest-contentful-paint"]})}catch{I.warn("Performance Observer not fully supported")}}function w(){h.value=!1,v&&(clearInterval(v),v=null),L&&(clearInterval(L),L=null),_&&(_.disconnect(),_=null),`${i.value.length}`}function f(){try{const m={timestamp:Date.now(),timing:x(),network:k(),userAgent:navigator.userAgent,url:window.location.href,customMetrics:q()};if("memory"in performance){const R=performance.memory;m.memory={used:R.usedJSHeapSize,total:R.totalJSHeapSize,limit:R.jsHeapSizeLimit}}i.value.push(m)}catch(m){I.warn("Failed to collect performance sample:",m)}}function x(){const m=performance.getEntriesByType("navigation")[0];return m?{navigation:m.loadEventEnd-m.fetchStart,domContentLoaded:m.domContentLoadedEventEnd-m.fetchStart,loadComplete:m.loadEventEnd-m.fetchStart}:{navigation:performance.now(),domContentLoaded:0,loadComplete:0}}function k(){const m=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return m?{downlink:m.downlink,effectiveType:m.effectiveType,rtt:m.rtt}:{}}function q(){const m={};m.domNodes=document.querySelectorAll("*").length,m.scripts=document.querySelectorAll("script").length,m.stylesheets=document.querySelectorAll('link[rel="stylesheet"]').length,window.__VUE__&&(m.vueVersion=window.__VUE__.version),window.React&&(m.reactVersion=window.React.version);const R=Array.from(document.querySelectorAll("script[src]"));return m.scriptSources=R.length,m}function A(){const m=[];if(i.value.length===0)return m;const R=i.value,P=R[R.length-1];if(P.memory){const D=P.memory.used/1048576,de=P.memory.limit/(1024*1024),X=D/de*100;X>80?m.push({type:"memory",severity:"critical",description:`Memory usage is ${X.toFixed(1)}% of limit`,value:D,recommendation:"Clear caches, reduce data in memory, check for memory leaks"}):X>60&&m.push({type:"memory",severity:"high",description:`Memory usage is ${X.toFixed(1)}% of limit`,value:D,recommendation:"Monitor memory usage, consider data pagination"})}return P.timing.navigation>3e3&&m.push({type:"timing",severity:"high",description:"Slow page load time",value:P.timing.navigation,recommendation:"Optimize bundle size, lazy load components, check network"}),P.network.rtt&&P.network.rtt>200&&m.push({type:"network",severity:"medium",description:"High network latency",value:P.network.rtt,recommendation:"Check network connection, consider CDN, reduce API calls"}),m}function Y(){l.value=!0;try{const m=A(),R={recordingInfo:{startTime:new Date(S.value).toISOString(),duration:E.value,sampleCount:i.value.length,url:window.location.href,userAgent:navigator.userAgent},performanceSummary:{avgMemoryUsage:i.value.filter(P=>P.memory).reduce((P,D)=>P+D.memory.used/(1024*1024),0)/i.value.filter(P=>P.memory).length,totalDOMNodes:i.value[i.value.length-1]?.customMetrics.domNodes,networkInfo:i.value[i.value.length-1]?.network},issues:m,topBottlenecks:m.sort((P,D)=>Z(D.severity)-Z(P.severity)).slice(0,5),detailedSamples:i.value.slice(-10),recommendations:[...new Set(m.map(P=>P.recommendation))]};c.value=JSON.stringify(R,null,2)}catch(m){I.error("Failed to export performance data:",m),c.value=`Export Error: ${m}`}finally{l.value=!1}}function Z(m){return{critical:4,high:3,medium:2,low:1}[m]||0}function z(){i.value=[],c.value="",E.value=0}return Ie(()=>{h.value&&w()}),(m,R)=>(d(),y("div",Kt,[t("div",Nt,[t("button",{onClick:T,class:ue(["record-btn",{recording:h.value}]),disabled:l.value},g(h.value?"Stop Recording":"Start Recording"),11,Vt),t("button",{onClick:Y,disabled:!b.value||l.value,class:"export-btn"},g(l.value?"Exporting...":"Export Logs"),9,Bt),t("button",{onClick:z,disabled:!b.value||h.value,class:"clear-btn"}," Clear ",8,qt)]),t("div",zt,[h.value?(d(),y("div",Gt," 🔴 Recording... ("+g(E.value)+"s) ",1)):b.value?(d(),y("div",Wt," ✅ "+g(i.value.length)+" samples recorded ",1)):(d(),y("div",jt," ⏸️ Ready to record "))]),c.value?(d(),y("div",Jt,[R[1]||(R[1]=t("h3",null,"Performance Data Ready",-1)),U(t("textarea",{"onUpdate:modelValue":R[0]||(R[0]=P=>c.value=P),readonly:"",rows:"10",placeholder:"Exported performance data will appear here..."},null,512),[[B,c.value]]),R[2]||(R[2]=t("div",{class:"copy-instructions"}," Copy this data and paste it to Claude for analysis ",-1))])):M("",!0)]))}}),Ht=oe(Yt,[["__scopeId","data-v-48cb70ff"]]),Zt={class:"advanced-section"},Qt={key:0},Xt={key:1},es={class:"sub-tabs"},ts=["onClick"],ss={class:"sub-tab-content"},ns={key:0,class:"provider-settings"},os={key:0,class:"no-providers"},as={key:0},is={key:1},ls={key:1,class:"provider-cards"},rs={key:0,class:"provider-advanced-card"},us={class:"setting-group"},ds=["onUpdate:modelValue","onChange"],cs={class:"setting-group"},ps=["onUpdate:modelValue","onChange"],ms={class:"setting-group"},vs=["onUpdate:modelValue","onChange"],ys={class:"setting-group"},fs=["onUpdate:modelValue","onChange"],gs={class:"setting-group"},bs=["onUpdate:modelValue","onChange"],ks={key:1,class:"execution-settings"},ws={class:"settings-grid"},hs={class:"setting-group"},Ss={class:"setting-group"},Cs={class:"setting-group"},xs={class:"setting-group"},As={class:"setting-group"},$s={key:2,class:"discovery-settings"},Ps={class:"settings-grid"},Ms={class:"setting-group"},Ts={class:"setting-group"},Rs={class:"setting-group"},Us={class:"setting-group"},Es={key:3,class:"coordination-settings"},Is={class:"settings-grid"},Ds={class:"setting-group"},_s={class:"setting-group"},Fs={class:"setting-group"},Os={class:"setting-group"},Ls={key:4,class:"performance-settings"},Ks={class:"settings-grid"},Ns={class:"setting-group"},Vs={class:"setting-group"},Bs={class:"setting-group"},qs={class:"setting-group"},zs={key:5,class:"system-settings"},Gs={key:6,class:"update-settings"},Ws={class:"update-info"},js={class:"info-row"},Js={class:"value"},Ys={key:0,class:"info-row"},Hs={class:"value highlight"},Zs={key:1,class:"info-row"},Qs={class:"value"},Xs={class:"update-actions"},en=["disabled"],tn={key:0,class:"download-progress"},sn={class:"progress-bar"},nn={class:"progress-text"},on={key:1,class:"error-message"},an=ne({__name:"AdvancedSection",props:{onStatusMessage:{type:Function}},setup(J){const h=Me(),l=Pe(),i=J;function c(n,e){i.onStatusMessage&&i.onStatusMessage(n,e)}const S=!!window.__TAURI__,E=[{id:"providers",label:"Provider Settings"},{id:"execution",label:"Execution"},{id:"discovery",label:"Discovery"},{id:"coordination",label:"Multi-Tab"},{id:"performance",label:"Performance"},{id:"system",label:"System"},...S?[{id:"updates",label:"Updates"}]:[]],b=C("providers"),v=C(!1),L=ie(()=>{const n=_.value;return n.length>0&&n.every(e=>a[e.id]&&typeof a[e.id].concurrency=="number")}),_=ie(()=>{try{const n=F.getAllGroups(),e=n.map(s=>{const p=F.getProvidersInGroup(s),r=p.some($=>F.requiresApiKey($.id));return{id:s,name:s.charAt(0).toUpperCase()+s.slice(1),requiresApiKey:r,endpoints:p.map($=>({id:$.id,name:$.name}))}});return e}catch(n){return I.error("Failed to get available provider groups:",n),[]}}),a=Q((()=>{try{const n=F.getAllGroups(),e={};return n.forEach(s=>{e[s]={concurrency:2,requestTimeout:30,maxRetries:3,backoffMultiplier:2}}),e}catch(n){return I.error("Failed to initialize provider settings:",n),{}}})());re(_,async n=>{await F.waitForReady(),n.length,n.forEach(e=>{if(!a[e.id]){const s=F.getProvidersInGroup(e.id),r=s[0]?.execution||{};`${e.id}`,s.map($=>$.id),a[e.id]={baseUrl:l.getProviderBaseUrl(e.id)||"",concurrency:r.defaultConcurrency||2,requestTimeout:Math.floor((r.timeout||3e4)/1e3),maxRetries:r.maxRetries||3,backoffMultiplier:r.backoffMultiplier||2}}})},{immediate:!0});const w=Q({defaultConcurrency:2,defaultTimeout:120,defaultMaxRetries:3,defaultTemperature:.7,progressBufferMs:0}),f=Q({autoDiscoverOnStartup:!0,discoveryInterval:24,discoveryTimeout:60,skipFailedProviders:!1}),x=Q({leaderElectionTimeout:1e3,syncInterval:500,enableBroadcastChannel:!0,enableWebLocks:!0}),k=Q({virtualScrollThreshold:1e3,debounceDelay:300,enableRequestIdleCallback:!0,enableProgressiveRendering:!0});Re(async()=>{try{await F.waitForReady();const n=await h.settings.system.getAllSettings(),e=F.getAllGroups();e.length,e.forEach(s=>{const p=F.getProviderExecutionOverrides(s);if(`${s}`,p&&a[s])p.concurrency!==void 0&&(a[s].concurrency=p.concurrency),p.timeout!==void 0&&(a[s].requestTimeout=Math.floor(p.timeout/1e3)),p.maxRetries!==void 0&&(a[s].maxRetries=p.maxRetries),p.backoffMultiplier!==void 0&&(a[s].backoffMultiplier=p.backoffMultiplier);else if(a[s]){const se=F.getProvidersInGroup(s)[0]?.execution||{};`${s}`,a[s].concurrency=se.defaultConcurrency||2,a[s].requestTimeout=Math.floor((se.timeout||3e4)/1e3),a[s].maxRetries=se.maxRetries||3,a[s].backoffMultiplier=se.backoffMultiplier||2}}),n.execution&&Object.assign(w,n.execution),n.discovery&&Object.assign(f,n.discovery),n.coordination&&Object.assign(x,n.coordination),n.performance&&Object.assign(k,n.performance),v.value=!0}catch(n){I.error("Failed to initialize advanced settings:",n),v.value=!0}});async function q(n,e){try{const s=e?.trim();if(s)try{new URL(s),l.setProviderBaseUrl(n,s),c("Custom API endpoint saved","success")}catch{c("Invalid URL format. Please enter a valid URL starting with http:// or https://","error"),a[n].baseUrl=l.getProviderBaseUrl(n)||""}else l.setProviderBaseUrl(n,""),c("Custom API endpoint cleared","success")}catch{c("Failed to update custom endpoint","error")}}async function A(n,e,s){try{switch(await F.waitForReady(),e){case"concurrency":F.setProviderConcurrency(n,s);break;case"requestTimeout":F.setProviderTimeout(n,s*1e3);break;case"maxRetries":F.setProviderMaxRetries(n,s);break;case"backoffMultiplier":F.setProviderBackoffMultiplier(n,s);break;default:throw new Error(`Unknown setting: ${e}`)}i.onStatusMessage?.(`Updated ${e} for ${n}`,"success")}catch(p){i.onStatusMessage?.(`Failed to update ${e}: ${p.message}`,"error");const $=F.getProvider(n)?.execution||{};switch(e){case"concurrency":a[n].concurrency=$.defaultConcurrency||2;break;case"requestTimeout":a[n].requestTimeout=Math.floor(($.timeout||3e4)/1e3);break;case"maxRetries":a[n].maxRetries=$.maxRetries||3;break;case"backoffMultiplier":a[n].backoffMultiplier=$.backoffMultiplier||2;break}}}async function Y(n,e){const s=await h.settings.system.setExecutionSetting(n,e);s.ok?i.onStatusMessage?.(`Updated ${n}`,"success"):i.onStatusMessage?.(`Failed to update ${n}: ${s.error.message}`,"error")}async function Z(n,e){const s=await h.settings.system.setDiscoverySetting(n,e);s.ok?i.onStatusMessage?.(`Updated ${n}`,"success"):i.onStatusMessage?.(`Failed to update ${n}: ${s.error.message}`,"error")}async function z(n,e){const s=await h.settings.system.setCoordinationSetting(n,e);s.ok?i.onStatusMessage?.(`Updated ${n}`,"success"):i.onStatusMessage?.(`Failed to update ${n}: ${s.error.message}`,"error")}async function m(n,e){const s=await h.settings.system.setPerformanceSetting(n,e);s.ok?i.onStatusMessage?.(`Updated ${n}`,"success"):i.onStatusMessage?.(`Failed to update ${n}: ${s.error.message}`,"error")}function R(){fe.confirm({title:"DELETE ALL DATA WARNING",content:`This will delete ALL data including:

• All trials and their results
• All API calls and responses
• All models and configurations
• All variable lists and datasets
• All settings and preferences

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Delete All Data",cancelText:"Cancel",okType:"danger",onOk(){fe.confirm({title:"FINAL WARNING",content:`You are about to delete EVERYTHING.

Click "Proceed" to confirm database deletion.`,okText:"Proceed with Deletion",cancelText:"Cancel",okType:"danger",onOk(){P()}})}})}async function P(){try{await j.transaction("rw",j.tables,async()=>{await Promise.all(j.tables.map(n=>n.clear()))}),localStorage.clear(),sessionStorage.clear(),i.onStatusMessage?.("Database and storage cleared successfully","success"),setTimeout(()=>{window.location.reload()},1500)}catch(n){I.error("Failed to clear database:",n),i.onStatusMessage?.(`Failed to clear database: ${n}`,"error")}}function D(){const e=$e()?`• All database data (trials, models, settings, API calls)
• All localStorage data
• All sessionStorage data
• All cookies for this domain
• All webview browsing data and cache (desktop app)
• All cached data and preferences
• All API keys and security settings`:`• All database data (trials, models, settings, API calls)
• All localStorage data
• All sessionStorage data
• All cookies for this domain
• All cached data and preferences
• All API keys and security settings`;fe.confirm({title:"FACTORY RESET WARNING",content:`This will completely reset the application to a fresh state.

This will clear:
${e}

The app will be restored to first-run state.

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Reset Everything",cancelText:"Cancel",okType:"danger",onOk(){fe.confirm({title:"FINAL FACTORY RESET WARNING",content:`You will lose EVERYTHING.

All data, settings, API keys, and preferences will be permanently deleted.

Click "Proceed" to confirm factory reset.`,okText:"Proceed with Reset",cancelText:"Cancel",okType:"danger",onOk(){de()}})}})}async function de(){try{if($e())try{const{getCurrentWebview:e}=await Ve(async()=>{const{getCurrentWebview:p}=await import("./webview-DLHLQmSD.js");return{getCurrentWebview:p}},__vite__mapDeps([0,1]));await e().clearAllBrowsingData(),i.onStatusMessage?.("Tauri webview data cleared","success")}catch(e){I.warn("Failed to clear Tauri webview data (non-fatal):",e),i.onStatusMessage?.("Warning: Could not clear all Tauri webview data","error")}if(await j.transaction("rw",j.tables,async()=>{await Promise.all(j.tables.map(e=>e.clear()))}),localStorage.clear(),sessionStorage.clear(),X(),await ke(),"caches"in window){const e=await caches.keys();await Promise.all(e.map(s=>caches.delete(s)))}const n=$e()?"Factory reset completed - all data and webview storage cleared":"Factory reset completed - all browser data cleared";i.onStatusMessage?.(n,"success"),setTimeout(()=>{window.location.reload()},2e3)}catch(n){I.error("Failed to perform factory reset:",n),i.onStatusMessage?.(`Factory reset failed: ${n}`,"error")}}function X(){const n=document.cookie.split(";");for(let e of n){const s=e.indexOf("="),p=s>-1?e.substr(0,s).trim():e.trim();document.cookie=`${p}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${p}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;`;const r=window.location.hostname;document.cookie=`${p}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${r}`,document.cookie=`${p}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${r}`}}async function ke(){if("indexedDB"in window&&indexedDB.databases)try{const n=await indexedDB.databases();await Promise.all(n.map(e=>{if(e.name)return new Promise((s,p)=>{const r=indexedDB.deleteDatabase(e.name);r.onsuccess=()=>s(),r.onerror=()=>p(r.error)})}))}catch(n){I.warn("Could not clear all IndexedDB databases:",n)}}const K=S?Ke():null,we=Ne.version,he=K?K.updateAvailable:C(!1),ce=K?K.updateInfo:C(null),pe=K?K.isChecking:C(!1),me=K?K.isDownloading:C(!1),ae=K?K.downloadProgress:C({event:"Started",downloaded:0,contentLength:0,percentage:0}),ge=K?K.error:C(null),ve=C(null);async function Se(){K&&(ve.value=new Date,await K.checkForUpdates(!1))}async function Ce(){K&&await K.downloadAndInstall()}function u(n){const s=new Date().getTime()-n.getTime(),p=Math.floor(s/6e4),r=Math.floor(s/36e5),$=Math.floor(s/864e5);return p<1?"Just now":p<60?`${p} minute${p!==1?"s":""} ago`:r<24?`${r} hour${r!==1?"s":""} ago`:`${$} day${$!==1?"s":""} ago`}function o(n){if(n===0)return"0 B";const e=1024,s=["B","KB","MB","GB"],p=Math.floor(Math.log(n)/Math.log(e));return Math.round(n/Math.pow(e,p)*100)/100+" "+s[p]}return(n,e)=>(d(),y("div",Zt,[v.value?(d(),y("div",Xt,[e[98]||(e[98]=t("h2",null,"Advanced Settings",-1)),e[99]||(e[99]=t("p",{class:"tab-description"},"Configure advanced settings for providers, execution, and system performance.",-1)),t("div",es,[(d(),y(le,null,be(E,s=>t("button",{key:s.id,class:ue(["sub-tab",{active:b.value===s.id}]),onClick:p=>b.value=s.id},g(s.label),11,ts)),64))]),t("div",ss,[b.value==="providers"?(d(),y("div",ns,[e[46]||(e[46]=t("h3",null,"Provider-Specific Settings",-1)),e[47]||(e[47]=t("p",{class:"section-description"},"Configure advanced settings for each provider",-1)),L.value?(d(),y("div",ls,[(d(!0),y(le,null,be(_.value,s=>(d(),y(le,{key:s.id},[s&&a[s.id]?(d(),y("div",rs,[t("h4",null,g(s.name)+" Group",1),e[45]||(e[45]=t("p",{class:"group-description"},"Settings apply to all endpoints in this provider group",-1)),t("div",us,[e[35]||(e[35]=t("label",null,"Custom API Endpoint",-1)),U(t("input",{type:"text","onUpdate:modelValue":p=>a[s.id].baseUrl=p,placeholder:"Use default API endpoint",onChange:p=>q(s.id,a[s.id]?.baseUrl)},null,40,ds),[[B,a[s.id].baseUrl]]),e[36]||(e[36]=t("span",{class:"hint"},"Override default API endpoint URL (optional)",-1))]),t("div",cs,[e[37]||(e[37]=t("label",null,"Concurrency Limit",-1)),U(t("input",{type:"number","onUpdate:modelValue":p=>a[s.id].concurrency=p,min:"1",max:"100",onChange:p=>A(s.id,"concurrency",a[s.id]?.concurrency)},null,40,ps),[[B,a[s.id].concurrency,void 0,{number:!0}]]),e[38]||(e[38]=t("span",{class:"hint"},"Max parallel requests (1-100)",-1))]),t("div",ms,[e[39]||(e[39]=t("label",null,"Request Timeout (seconds)",-1)),U(t("input",{type:"number","onUpdate:modelValue":p=>a[s.id].requestTimeout=p,min:"10",max:"600",onChange:p=>A(s.id,"requestTimeout",a[s.id]?.requestTimeout)},null,40,vs),[[B,a[s.id].requestTimeout,void 0,{number:!0}]]),e[40]||(e[40]=t("span",{class:"hint"},"Time before request fails (10-600s)",-1))]),t("div",ys,[e[41]||(e[41]=t("label",null,"Max Retries",-1)),U(t("input",{type:"number","onUpdate:modelValue":p=>a[s.id].maxRetries=p,min:"0",max:"10",onChange:p=>A(s.id,"maxRetries",a[s.id]?.maxRetries)},null,40,fs),[[B,a[s.id].maxRetries,void 0,{number:!0}]]),e[42]||(e[42]=t("span",{class:"hint"},"Retry attempts on failure (0-10)",-1))]),t("div",gs,[e[43]||(e[43]=t("label",null,"Backoff Multiplier",-1)),U(t("input",{type:"number","onUpdate:modelValue":p=>a[s.id].backoffMultiplier=p,min:"1",max:"5",step:"0.1",onChange:p=>A(s.id,"backoffMultiplier",a[s.id]?.backoffMultiplier)},null,40,bs),[[B,a[s.id].backoffMultiplier,void 0,{number:!0}]]),e[44]||(e[44]=t("span",{class:"hint"},"Exponential backoff factor (1-5)",-1))])])):M("",!0)],64))),128))])):(d(),y("div",os,[_.value.length===0?(d(),y("p",as,"No providers are currently configured. Add API keys in the API Keys tab first.")):(d(),y("p",is,"Loading provider settings..."))]))])):M("",!0),b.value==="execution"?(d(),y("div",ks,[e[58]||(e[58]=t("h3",null,"Execution Settings",-1)),e[59]||(e[59]=t("p",{class:"section-description"},"Configure how trials are executed",-1)),t("div",ws,[t("div",hs,[e[48]||(e[48]=t("label",null,"Progress Buffer Delay (ms)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>w.progressBufferMs=s),min:"0",max:"10000",step:"100",onChange:e[1]||(e[1]=s=>Y("progressBufferMs",w.progressBufferMs))},null,544),[[B,w.progressBufferMs,void 0,{number:!0}]]),e[49]||(e[49]=t("span",{class:"hint"},"Delay before updating progress (0-10000ms, 0 = immediate)",-1))]),t("div",Ss,[e[50]||(e[50]=t("label",null,"Fallback Trial Concurrency",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>w.defaultConcurrency=s),min:"1",max:"20",onChange:e[3]||(e[3]=s=>Y("defaultConcurrency",w.defaultConcurrency))},null,544),[[B,w.defaultConcurrency,void 0,{number:!0}]]),e[51]||(e[51]=t("span",{class:"hint"},"Only used if not set by provider or user override (1-20)",-1))]),t("div",Cs,[e[52]||(e[52]=t("label",null,"Default Timeout (seconds)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>w.defaultTimeout=s),min:"10",max:"600",onChange:e[5]||(e[5]=s=>Y("defaultTimeout",w.defaultTimeout))},null,544),[[B,w.defaultTimeout,void 0,{number:!0}]]),e[53]||(e[53]=t("span",{class:"hint"},"Default timeout for all calls (10-600s)",-1))]),t("div",xs,[e[54]||(e[54]=t("label",null,"Default Max Retries",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>w.defaultMaxRetries=s),min:"0",max:"5",onChange:e[7]||(e[7]=s=>Y("defaultMaxRetries",w.defaultMaxRetries))},null,544),[[B,w.defaultMaxRetries,void 0,{number:!0}]]),e[55]||(e[55]=t("span",{class:"hint"},"Default retry attempts (0-5)",-1))]),t("div",As,[e[56]||(e[56]=t("label",null,"Default Temperature",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>w.defaultTemperature=s),min:"0",max:"2",step:"0.1",onChange:e[9]||(e[9]=s=>Y("defaultTemperature",w.defaultTemperature))},null,544),[[B,w.defaultTemperature,void 0,{number:!0}]]),e[57]||(e[57]=t("span",{class:"hint"},"Default model temperature (0-2)",-1))])])])):M("",!0),b.value==="discovery"?(d(),y("div",$s,[e[66]||(e[66]=t("h3",null,"Model Discovery Settings",-1)),e[67]||(e[67]=t("p",{class:"section-description"},"Configure automatic model discovery",-1)),t("div",Ps,[t("div",Ms,[t("label",null,[U(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>f.autoDiscoverOnStartup=s),onChange:e[11]||(e[11]=s=>Z("autoDiscoverOnStartup",f.autoDiscoverOnStartup))},null,544),[[te,f.autoDiscoverOnStartup]]),e[60]||(e[60]=N(" Auto-discover models on startup "))])]),t("div",Ts,[e[61]||(e[61]=t("label",null,"Discovery Interval (hours)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>f.discoveryInterval=s),min:"1",max:"168",onChange:e[13]||(e[13]=s=>Z("discoveryInterval",f.discoveryInterval))},null,544),[[B,f.discoveryInterval,void 0,{number:!0}]]),e[62]||(e[62]=t("span",{class:"hint"},"Time between auto-discovery runs (1-168h)",-1))]),t("div",Rs,[e[63]||(e[63]=t("label",null,"Discovery Timeout (seconds)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=s=>f.discoveryTimeout=s),min:"10",max:"300",onChange:e[15]||(e[15]=s=>Z("discoveryTimeout",f.discoveryTimeout))},null,544),[[B,f.discoveryTimeout,void 0,{number:!0}]]),e[64]||(e[64]=t("span",{class:"hint"},"Max time for discovery operations (10-300s)",-1))]),t("div",Us,[t("label",null,[U(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=s=>f.skipFailedProviders=s),onChange:e[17]||(e[17]=s=>Z("skipFailedProviders",f.skipFailedProviders))},null,544),[[te,f.skipFailedProviders]]),e[65]||(e[65]=N(" Skip providers that previously failed "))])])])])):M("",!0),b.value==="coordination"?(d(),y("div",Es,[e[74]||(e[74]=t("h3",null,"Multi-Tab Coordination",-1)),e[75]||(e[75]=t("p",{class:"section-description"},"Configure how multiple tabs work together",-1)),t("div",Is,[t("div",Ds,[e[68]||(e[68]=t("label",null,"Leader Election Timeout (ms)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=s=>x.leaderElectionTimeout=s),min:"100",max:"5000",onChange:e[19]||(e[19]=s=>z("leaderElectionTimeout",x.leaderElectionTimeout))},null,544),[[B,x.leaderElectionTimeout,void 0,{number:!0}]]),e[69]||(e[69]=t("span",{class:"hint"},"Time to elect new leader tab (100-5000ms)",-1))]),t("div",_s,[e[70]||(e[70]=t("label",null,"Sync Interval (ms)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[20]||(e[20]=s=>x.syncInterval=s),min:"100",max:"2000",onChange:e[21]||(e[21]=s=>z("syncInterval",x.syncInterval))},null,544),[[B,x.syncInterval,void 0,{number:!0}]]),e[71]||(e[71]=t("span",{class:"hint"},"Tab synchronization frequency (100-2000ms)",-1))]),t("div",Fs,[t("label",null,[U(t("input",{type:"checkbox","onUpdate:modelValue":e[22]||(e[22]=s=>x.enableBroadcastChannel=s),onChange:e[23]||(e[23]=s=>z("enableBroadcastChannel",x.enableBroadcastChannel))},null,544),[[te,x.enableBroadcastChannel]]),e[72]||(e[72]=N(" Enable BroadcastChannel communication "))])]),t("div",Os,[t("label",null,[U(t("input",{type:"checkbox","onUpdate:modelValue":e[24]||(e[24]=s=>x.enableWebLocks=s),onChange:e[25]||(e[25]=s=>z("enableWebLocks",x.enableWebLocks))},null,544),[[te,x.enableWebLocks]]),e[73]||(e[73]=N(" Enable Web Locks API "))])])])])):M("",!0),b.value==="performance"?(d(),y("div",Ls,[e[82]||(e[82]=t("h3",null,"UI Performance",-1)),e[83]||(e[83]=t("p",{class:"section-description"},"Optimize UI performance for large datasets and debug performance issues",-1)),H(Ht),t("div",Ks,[t("div",Ns,[e[76]||(e[76]=t("label",null,"Virtual Scrolling Threshold",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[26]||(e[26]=s=>k.virtualScrollThreshold=s),min:"50",max:"10000",onChange:e[27]||(e[27]=s=>m("virtualScrollThreshold",k.virtualScrollThreshold))},null,544),[[B,k.virtualScrollThreshold,void 0,{number:!0}]]),e[77]||(e[77]=t("span",{class:"hint"},"Enable virtual scrolling above this row count (50-10000)",-1))]),t("div",Vs,[e[78]||(e[78]=t("label",null,"Debounce Delay (ms)",-1)),U(t("input",{type:"number","onUpdate:modelValue":e[28]||(e[28]=s=>k.debounceDelay=s),min:"100",max:"1000",onChange:e[29]||(e[29]=s=>m("debounceDelay",k.debounceDelay))},null,544),[[B,k.debounceDelay,void 0,{number:!0}]]),e[79]||(e[79]=t("span",{class:"hint"},"Search/filter debounce delay (100-1000ms)",-1))]),t("div",Bs,[t("label",null,[U(t("input",{type:"checkbox","onUpdate:modelValue":e[30]||(e[30]=s=>k.enableRequestIdleCallback=s),onChange:e[31]||(e[31]=s=>m("enableRequestIdleCallback",k.enableRequestIdleCallback))},null,544),[[te,k.enableRequestIdleCallback]]),e[80]||(e[80]=N(" Use requestIdleCallback for background tasks "))])]),t("div",qs,[t("label",null,[U(t("input",{type:"checkbox","onUpdate:modelValue":e[32]||(e[32]=s=>k.enableProgressiveRendering=s),onChange:e[33]||(e[33]=s=>m("enableProgressiveRendering",k.enableProgressiveRendering))},null,544),[[te,k.enableProgressiveRendering]]),e[81]||(e[81]=N(" Enable progressive rendering for large results "))])])])])):M("",!0),b.value==="system"?(d(),y("div",zs,[e[89]||(e[89]=t("h3",null,"System Management",-1)),e[90]||(e[90]=t("p",{class:"section-description"},"Manage database and storage",-1)),t("div",{class:"danger-zone"},[e[88]||(e[88]=t("h4",null,"⚠️ Danger Zone",-1)),t("div",{class:"danger-actions"},[t("div",{class:"action-card"},[e[84]||(e[84]=t("h5",null,"Clear All Data",-1)),e[85]||(e[85]=t("p",null,"Delete all trials, models, settings, and API calls from the database. This action cannot be undone.",-1)),t("button",{class:"danger-button",onClick:R}," Delete Database & Store ")]),t("div",{class:"action-card"},[e[86]||(e[86]=t("h5",null,"Factory Reset",-1)),e[87]||(e[87]=t("p",null,"Complete factory reset - clears database, localStorage, sessionStorage, cookies, webview browsing data (in desktop app), and all stored data. Restores app to fresh installation state.",-1)),t("button",{class:"danger-button",onClick:D}," Factory Reset Everything ")])])])])):M("",!0),b.value==="updates"&&S?(d(),y("div",Gs,[e[96]||(e[96]=t("h3",null,"Application Updates",-1)),e[97]||(e[97]=t("p",{class:"section-description"},"Manage automatic updates for the desktop application",-1)),t("div",Ws,[t("div",js,[e[91]||(e[91]=t("span",{class:"label"},"Current Version:",-1)),t("span",Js,"v"+g(O(we)),1)]),O(ce)?(d(),y("div",Ys,[e[92]||(e[92]=t("span",{class:"label"},"Available Update:",-1)),t("span",Hs,"v"+g(O(ce).version),1)])):M("",!0),ve.value?(d(),y("div",Zs,[e[93]||(e[93]=t("span",{class:"label"},"Last Checked:",-1)),t("span",Qs,g(u(ve.value)),1)])):M("",!0)]),t("div",Xs,[t("button",{class:"action-button primary",onClick:Se,disabled:O(pe)},g(O(pe)?"Checking...":"Check for Updates"),9,en),O(he)&&!O(me)?(d(),y("button",{key:0,class:"action-button success",onClick:Ce}," Install Update v"+g(O(ce)?.version),1)):M("",!0)]),O(me)?(d(),y("div",tn,[e[94]||(e[94]=t("h4",null,"Downloading Update...",-1)),t("div",sn,[t("div",{class:"progress-fill",style:De({width:`${O(ae).percentage}%`})},null,4)]),t("p",nn,g(o(O(ae).downloaded))+" / "+g(o(O(ae).contentLength))+" ("+g(O(ae).percentage)+"%) ",1)])):M("",!0),O(ge)?(d(),y("div",on,[e[95]||(e[95]=t("h4",null,"Update Error",-1)),t("p",null,g(O(ge)),1)])):M("",!0)])):M("",!0)])])):(d(),y("div",Qt,e[34]||(e[34]=[t("p",null,"Loading settings...",-1)])))]))}}),ln=oe(an,[["__scopeId","data-v-46b31341"]]),rn={class:"import-export-section"},un={class:"import-export-content"},dn={class:"import-section all-data"},cn={class:"file-input-wrapper"},pn={class:"import-section"},mn={class:"file-input-wrapper"},vn={class:"danger-section"},yn=["disabled"],fn=ne({__name:"ImportExportSection",props:{onStatusMessage:{type:Function}},setup(J){const h=Me(),l=J,i=C(),c=C(),S=C(!1);async function E(){const T=await h.settings.core.exportSettings();if(T.ok){const a=new Blob([T.value],{type:"application/json"}),w=URL.createObjectURL(a),f=document.createElement("a");f.href=w,f.download=`auditomatic-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(w),l.onStatusMessage?.("Settings exported successfully","success")}else l.onStatusMessage?.(`Failed to export settings: ${T.error.message}`,"error")}async function b(T){const a=T.target.files?.[0];if(a)try{const w=await a.text(),f=await h.settings.core.importSettings(w);f.ok?(l.onStatusMessage?.("Settings imported successfully","success"),i.value&&(i.value.value="")):l.onStatusMessage?.(`Failed to import settings: ${f.error.message}`,"error")}catch{l.onStatusMessage?.("Failed to read file","error")}}async function v(){if(!confirm("Are you sure you want to reset all settings? This cannot be undone."))return;S.value=!0;const T=await h.settings.core.resetSettings();S.value=!1,T.ok?l.onStatusMessage?.("All settings have been reset","success"):l.onStatusMessage?.(`Failed to reset settings: ${T.error.message}`,"error")}async function L(){try{l.onStatusMessage?.("Exporting all data...","success");const T={version:2,exported:new Date().toISOString(),app:"auditomatic-lite",tables:{}};for(const q of j.tables){const A=q.name;T.tables[A]=await q.toArray()}const a=JSON.stringify(T,null,2),w=(a.length/(1024*1024)).toFixed(2),f=new Blob([a],{type:"application/json"}),x=URL.createObjectURL(f),k=document.createElement("a");k.href=x,k.download=`auditomatic-all-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(x),l.onStatusMessage?.(`All data exported successfully (${w} MB)`,"success")}catch(T){I.error("Failed to export all data:",T),l.onStatusMessage?.(`Failed to export data: ${T}`,"error")}}async function _(T){const a=T.target.files?.[0];if(!a)return;if(!confirm(`WARNING: This will REPLACE ALL existing data with the imported data.

All current trials, models, settings, etc. will be deleted.

Are you absolutely sure?`)){c.value&&(c.value.value="");return}try{l.onStatusMessage?.("Importing all data...","success");const f=await a.text(),x=JSON.parse(f);if(!x.version||!x.tables)throw new Error("Invalid data format");await j.transaction("rw",j.tables,async()=>{await Promise.all(j.tables.map(k=>k.clear()));for(const[k,q]of Object.entries(x.tables)){const A=j[k];A&&Array.isArray(q)&&q.length>0&&await A.bulkAdd(q)}}),l.onStatusMessage?.("All data imported successfully","success"),c.value&&(c.value.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(f){I.error("Failed to import all data:",f),l.onStatusMessage?.(`Failed to import data: ${f}`,"error"),c.value&&(c.value.value="")}}return(T,a)=>(d(),y("div",rn,[a[13]||(a[13]=t("h2",null,"Import & Export",-1)),a[14]||(a[14]=t("p",{class:"tab-description"},"Backup and restore your settings. API keys are masked during export for security.",-1)),t("div",un,[t("div",{class:"export-section all-data"},[a[2]||(a[2]=t("h3",null,"📦 Export All Data",-1)),t("button",{onClick:L,class:"btn btn-primary btn-large"}," Export Everything to JSON "),a[3]||(a[3]=t("p",{class:"help-text"},"Downloads ALL data: trials, models, settings, variable lists, datasets, API calls, etc.",-1))]),t("div",dn,[a[4]||(a[4]=t("h3",null,"📥 Import All Data",-1)),t("div",cn,[t("input",{ref_key:"allDataFileInput",ref:c,type:"file",accept:".json",onChange:_,class:"file-input"},null,544),t("button",{onClick:a[0]||(a[0]=()=>c.value&&c.value.click()),class:"btn btn-primary btn-large"}," Import Everything from JSON ")]),a[5]||(a[5]=t("p",{class:"help-text"},"⚠️ WARNING: This will REPLACE all existing data with the imported data",-1))]),a[12]||(a[12]=t("hr",{class:"section-divider"},null,-1)),t("div",{class:"export-section"},[a[6]||(a[6]=t("h3",null,"Export Settings Only",-1)),t("button",{onClick:E,class:"btn btn-secondary"}," Export Settings to JSON "),a[7]||(a[7]=t("p",{class:"help-text"},"Downloads a JSON file with your settings (API keys will be masked)",-1))]),t("div",pn,[a[8]||(a[8]=t("h3",null,"Import Settings Only",-1)),t("div",mn,[t("input",{ref_key:"fileInput",ref:i,type:"file",accept:".json",onChange:b,class:"file-input"},null,544),t("button",{onClick:a[1]||(a[1]=()=>i.value&&i.value.click()),class:"btn btn-secondary"}," Choose File ")]),a[9]||(a[9]=t("p",{class:"help-text"},"Import settings from a previously exported JSON file",-1))]),t("div",vn,[a[10]||(a[10]=t("h3",null,"Reset Settings",-1)),t("button",{onClick:v,class:"btn btn-danger",disabled:S.value},g(S.value?"Resetting...":"Reset All Settings"),9,yn),a[11]||(a[11]=t("p",{class:"help-text"},"⚠️ This will clear all API keys and reset preferences to defaults",-1))])])]))}}),gn=oe(fn,[["__scopeId","data-v-7b20deaa"]]),bn=ne({__name:"StatusMessage",props:{text:{},type:{},duration:{default:5e3}},setup(J){const h=J,l=C(!1);let i=null;return re(()=>h.text,c=>{c&&(l.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{l.value=!1},h.duration))},{immediate:!0}),re(l,c=>{!c&&i&&(clearTimeout(i),i=null)}),(c,S)=>(d(),W(_e,{name:"slide"},{default:G(()=>[l.value?(d(),y("div",{key:0,class:ue(["status-message",c.type])},g(c.text),3)):M("",!0)]),_:1}))}}),kn=oe(bn,[["__scopeId","data-v-da279e0d"]]),wn={class:"settings-view","data-testid":"page-settings"},hn={class:"tabs"},Sn=["onClick"],Cn={class:"tab-content"},xn=ne({__name:"SettingsView",setup(J){const h=[{id:"api-keys",label:"API Keys"},{id:"preferences",label:"Preferences"},{id:"advanced",label:"Advanced"},{id:"import-export",label:"Import/Export"}],l=C("api-keys"),i=C(null);function c(S,E){i.value={text:S,type:E},setTimeout(()=>{i.value?.text===S&&(i.value=null)},5500)}return(S,E)=>(d(),y("div",wn,[E[0]||(E[0]=t("h1",{class:"settings-title"},"Settings",-1)),t("div",hn,[(d(),y(le,null,be(h,b=>t("button",{key:b.id,class:ue(["tab",{active:l.value===b.id}]),onClick:v=>l.value=b.id},g(b.label),11,Sn)),64))]),t("div",Cn,[l.value==="api-keys"?(d(),W(xt,{key:0,"on-status-message":c})):M("",!0),l.value==="preferences"?(d(),W(Lt,{key:1,"on-status-message":c})):M("",!0),l.value==="advanced"?(d(),W(ln,{key:2,"on-status-message":c})):M("",!0),l.value==="import-export"?(d(),W(gn,{key:3,"on-status-message":c})):M("",!0)]),i.value?(d(),W(kn,{key:0,text:i.value.text,type:i.value.type},null,8,["text","type"])):M("",!0)]))}}),En=oe(xn,[["__scopeId","data-v-ea1dc301"]]);export{En as default};

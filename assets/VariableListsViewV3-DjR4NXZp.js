import{j as te,D as ne,a as we}from"./index-B-A_sTss.js";import{d as ae,R as p,Y as d,k as t,Z as s,S as i,V as m,_ as y,F as G,$ as B,G as c,u as g,W as Ce,f as N,c as M,w as xe,o as $e,X as De}from"./vue-vendor-DPw1dQYc.js";import{u as Se}from"./useV4VariableLists-BEH9niiW.js";import{u as ie,a as Le}from"./useV4VariableListCommands-ByESalPL.js";import{o as re,T as Ve,p as Ie,q as Te,n as se,C as oe,r as Ee,s as ue,V as de,M as ce,t as pe,u as Fe,F as me,v as Me,w as Ne,x as ee,Z as Oe,$ as Ue,Y as _e,H as Re,a0 as ze,a1 as Be,R as fe,a2 as Ke,a3 as je,G as Ae,a4 as Pe,a5 as qe,a6 as Je,a7 as Ge,J as Ye,N as f,P as He,a8 as Xe,a9 as Ze,aa as We}from"./ui-vendor-IRGmExUJ.js";import"./utils-vendor-B76-F3_P.js";import"./useV4LiveQuery-Do0jdBW3.js";import"./useV4CrossTab-ClZtXMxB.js";const Qe={class:"variable-lists-table"},et={class:"name-cell"},tt={class:"list-name"},at={key:0,class:"list-description"},st={class:"items-cell"},lt={class:"item-count"},nt={class:"item-type"},ot={key:0,class:"attribute-keys"},it={key:0,class:"more-attributes"},rt={key:2,class:"created-cell"},ut={class:"created-date"},dt={class:"created-time"},ct={key:3,class:"actions-cell"},pt={class:"empty-state"},mt={class:"empty-title"},_t={class:"empty-description"},ft=ae({__name:"VariableListsTableV3",props:{lists:{},loading:{type:Boolean,default:!1},category:{}},emits:["edit","delete","duplicate","export"],setup(Y,{emit:O}){const U=Y,$=O,K=[{title:"Name",key:"name",dataIndex:"name",width:300,ellipsis:!0},{title:"Items",key:"items",width:200,align:"center"},{title:"Created",key:"created",width:150,align:"center"},{title:"Actions",key:"actions",width:120,align:"center"}];function j(l){switch(l){case"simple":return"blue";case"attributed":return"green";case"refusal":return"orange";case"tabular":return"purple";default:return"default"}}function A(l){switch(l){case"simple":return"Simple";case"attributed":return"Intersectional";case"refusal":return"Refusal";case"tabular":return"Tabular";default:return l}}function _(l){switch(l.category){case"simple":return"values";case"attributed":return"items";case"refusal":return"patterns";case"tabular":return"rows";default:return"items"}}function I(l){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(l))}function b(l){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).format(new Date(l))}function D(){switch(U.category){case"all":return"No variable lists yet";case"simple":return"No simple lists yet";case"attributed":return"No attributed lists yet";case"refusal":return"No refusal lists yet";default:return"No lists found"}}function P(){switch(U.category){case"all":return"Create your first variable list or import standard lists to get started";case"simple":return"Simple lists contain plain text values for template variables";case"attributed":return"Attributed lists contain values with additional metadata attributes";case"refusal":return"Refusal lists contain patterns to detect when models refuse requests";default:return"Create a new list to get started"}}function r(l,n){switch(l.key){case"duplicate":$("duplicate",n);break;case"export-csv":$("export",n,"csv");break;case"export-json":$("export",n,"json");break;case"delete":$("delete",n);break}}return(l,n)=>{const k=Ve,S=Te,T=se,L=pe,q=Me,J=ce,E=ue,F=re;return d(),p("div",Qe,[t(F,{dataSource:l.lists,columns:K,loading:l.loading,pagination:!1,scroll:{x:800,y:"calc(100vh - 320px)"},"row-key":"id"},{bodyCell:s(({column:w,record:u})=>[w.key==="name"?(d(),p(G,{key:0},[i("div",et,[i("span",tt,m(u.name),1),t(k,{color:j(u.category),class:"category-tag"},{default:s(()=>[c(m(A(u.category)),1)]),_:2},1032,["color"]),u.isDefault?(d(),B(S,{key:0,title:"Default list - editing will create a copy"},{default:s(()=>[t(k,{color:"blue",size:"small",style:{"margin-left":"4px"}},{default:s(()=>[t(g(Ie)),n[0]||(n[0]=c(" Default "))]),_:1,__:[0]})]),_:1})):y("",!0)]),u.description?(d(),p("div",at,m(u.description),1)):y("",!0)],64)):w.key==="items"?(d(),p(G,{key:1},[i("div",st,[i("span",lt,m(u.itemCount),1),i("span",nt,m(_(u)),1)]),u.category==="attributed"&&u.attributeKeys?(d(),p("div",ot,[(d(!0),p(G,null,Ce(u.attributeKeys.slice(0,3),C=>(d(),B(k,{key:C,size:"small",class:"attribute-key-tag"},{default:s(()=>[c(m(C),1)]),_:2},1024))),128)),u.attributeKeys.length>3?(d(),p("span",it," +"+m(u.attributeKeys.length-3)+" more ",1)):y("",!0)])):y("",!0)],64)):w.key==="created"?(d(),p("div",rt,[i("div",ut,m(I(u.created)),1),i("div",dt,m(b(u.created)),1)])):w.key==="actions"?(d(),p("div",ct,[t(S,{title:u.isDefault?"Creates a copy for editing":""},{default:s(()=>[t(T,{type:"text",size:"small",onClick:C=>l.$emit("edit",u),"data-testid":"btn-edit-list"},{default:s(()=>[u.isDefault?(d(),p(G,{key:0},[t(g(oe)),n[1]||(n[1]=c(" Edit (Copy) "))],64)):(d(),p(G,{key:1},[t(g(Ee)),n[2]||(n[2]=c(" Edit "))],64))]),_:2},1032,["onClick"])]),_:2},1032,["title"]),t(E,{trigger:["click"]},{overlay:s(()=>[t(J,{onClick:C=>r(C,u)},{default:s(()=>[t(L,{key:"duplicate"},{default:s(()=>[t(g(oe)),n[4]||(n[4]=c(" Duplicate "))]),_:1,__:[4]}),t(L,{key:"export-csv"},{default:s(()=>[t(g(Fe)),n[5]||(n[5]=c(" Export CSV "))]),_:1,__:[5]}),t(L,{key:"export-json"},{default:s(()=>[t(g(me)),n[6]||(n[6]=c(" Export JSON "))]),_:1,__:[6]}),t(q),t(L,{key:"delete",danger:""},{default:s(()=>[t(g(Ne)),n[7]||(n[7]=c(" Delete "))]),_:1,__:[7]})]),_:2},1032,["onClick"])]),default:s(()=>[t(T,{type:"text",size:"small"},{default:s(()=>[n[3]||(n[3]=c(" More ")),t(g(de))]),_:1,__:[3]})]),_:2},1024)])):y("",!0)]),emptyText:s(()=>[i("div",pt,[n[8]||(n[8]=i("div",{class:"empty-icon"},"ðŸ“‹",-1)),i("div",mt,m(D()),1),i("div",_t,m(P()),1)])]),_:1},8,["dataSource","loading"])])}}}),X=te(ft,[["__scopeId","data-v-a712cff4"]]),vt={class:"import-modal"},yt={key:0,class:"step-content"},gt={class:"import-methods"},bt={class:"paste-section"},kt={key:0,class:"data-info"},ht={class:"upload-section"},wt={class:"ant-upload-drag-icon"},Ct={key:0,class:"file-info"},xt={key:1,class:"step-content"},$t={class:"config-section"},Dt={key:0,class:"format-info"},St={key:2,class:"step-content"},Lt={class:"preview-section"},Vt={class:"preview-header"},It={class:"preview-stats"},Tt={key:0},Et={class:"preview-table"},Ft={class:"modal-actions"},Mt=ae({__name:"ImportModalV3",props:{open:{type:Boolean}},emits:["update:open","imported"],setup(Y,{emit:O}){const U=Y,$=O,{importFromCSV:K,isExecuting:j}=ie(),{validateCSV:A}=Le(),_=N(0),I=N("paste"),b=N(""),D=N(null),P=M(()=>j.value),r=N({name:"",description:"",category:"simple"}),l=M(()=>{const a=b.value.trim();if(!a)return null;const e=A(a,r.value.category);return e.valid?e.preview:null}),n=M(()=>{if(!l.value||l.value.rows.length===0)return null;const{headers:a,rows:e}=l.value;return a.length>1?{type:"success",message:`Detected attributed list format with ${a.length} columns: ${a.join(", ")}`}:a.length===1?{type:"info",message:`Detected simple list format with ${e.length} values`}:{type:"warning",message:"Unable to detect format - please check your data"}}),k=M(()=>l.value?r.value.category==="attributed"?l.value.rows.map((a,e)=>({key:e,...a})):l.value.rows.map((a,e)=>({key:e,value:a[l.value.headers[0]]||""})):[]),S=M(()=>l.value?r.value.category==="attributed"?l.value.headers.map(a=>({title:a,dataIndex:a,key:a,ellipsis:!0})):[{title:"Value",dataIndex:"value",key:"value",ellipsis:!0}]:[]),T=M(()=>{switch(_.value){case 0:return b.value.trim().length>0&&l.value?.rows.length>0;case 1:return r.value.name.trim().length>0&&r.value.category;case 2:return k.value.length>0;default:return!1}});function L(){l.value&&l.value.headers.length>1&&(r.value.category="attributed")}function q(a){D.value=a;const e=new FileReader;return e.onload=o=>{b.value=o.target?.result,I.value="upload",L()},e.readAsText(a),!1}function J(){}function E(a){if(a===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB"],v=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,v)).toFixed(2))+" "+o[v]}function F(){T.value&&_.value<2&&_.value++}function w(){_.value>0&&_.value--}async function u(){if(!T.value)return;const a=await K(b.value,r.value.name,r.value.category,r.value.description);if(!a.ok){f.error(`Import failed: ${a.error.message}`);return}f.success("Variable list imported successfully"),$("imported"),C()}function C(){$("update:open",!1)}return xe(()=>U.open,a=>{a&&(_.value=0,b.value="",D.value=null,r.value={name:"",description:"",category:"simple"})}),(a,e)=>{const o=Oe,v=Ue,h=Re,x=_e,R=ze,Z=fe,z=Pe,W=Ae,le=je,Q=Je,ve=qe,ye=Ke,ge=Ge,be=Ye,ke=re,H=se,he=ee;return d(),B(he,{open:a.open,title:"Import Variable List",width:"800px",footer:null,onCancel:C,"destroy-on-close":!0},{default:s(()=>[i("div",vt,[t(v,{current:_.value,class:"import-steps"},{default:s(()=>[t(o,{title:"Import Data"}),t(o,{title:"Configure"}),t(o,{title:"Preview"})]),_:1},8,["current"]),_.value===0?(d(),p("div",yt,[i("div",gt,[t(Z,{activeKey:I.value,"onUpdate:activeKey":e[1]||(e[1]=V=>I.value=V)},{default:s(()=>[t(x,{key:"paste",tab:"Paste Data"},{default:s(()=>[i("div",bt,[t(h,{value:b.value,"onUpdate:value":e[0]||(e[0]=V=>b.value=V),placeholder:`Paste your CSV data here...

Example for simple list:
red
blue
green

Example for attributed list:
name,gender,ethnicity
John Smith,Male,European
Maria Garcia,Female,Hispanic`,rows:12,size:"large",onChange:L},null,8,["value"]),b.value.trim()?(d(),p("div",kt,m(l.value?.rows.length||0)+" rows detected ",1)):y("",!0)])]),_:1}),t(x,{key:"upload",tab:"Upload File"},{default:s(()=>[i("div",ht,[t(R,{"before-upload":q,"show-upload-list":!1,accept:".csv,.txt"},{default:s(()=>[i("p",wt,[t(g(Be))]),e[5]||(e[5]=i("p",{class:"ant-upload-text"},"Click or drag file to upload",-1)),e[6]||(e[6]=i("p",{class:"ant-upload-hint"},"Supports CSV and TXT files",-1))]),_:1,__:[5,6]}),D.value?(d(),p("div",Ct,[t(g(me)),c(" "+m(D.value.name)+" ("+m(E(D.value.size))+") ",1)])):y("",!0)])]),_:1})]),_:1},8,["activeKey"])])])):y("",!0),_.value===1?(d(),p("div",xt,[i("div",$t,[t(ge,{model:r.value,layout:"vertical"},{default:s(()=>[t(ye,{gutter:16},{default:s(()=>[t(le,{span:12},{default:s(()=>[t(W,{label:"List Name",required:""},{default:s(()=>[t(z,{value:r.value.name,"onUpdate:value":e[2]||(e[2]=V=>r.value.name=V),placeholder:"Enter list name",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(le,{span:12},{default:s(()=>[t(W,{label:"List Type",required:""},{default:s(()=>[t(ve,{value:r.value.category,"onUpdate:value":e[3]||(e[3]=V=>r.value.category=V),size:"large",onChange:J},{default:s(()=>[t(Q,{value:"simple"},{default:s(()=>e[7]||(e[7]=[c("Simple List")])),_:1,__:[7]}),t(Q,{value:"attributed"},{default:s(()=>e[8]||(e[8]=[c("Attributed List")])),_:1,__:[8]}),t(Q,{value:"refusal"},{default:s(()=>e[9]||(e[9]=[c("Refusal List")])),_:1,__:[9]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(W,{label:"Description (Optional)"},{default:s(()=>[t(z,{value:r.value.description,"onUpdate:value":e[4]||(e[4]=V=>r.value.description=V),placeholder:"Optional description",size:"large"},null,8,["value"])]),_:1})]),_:1},8,["model"]),n.value?(d(),p("div",Dt,[t(be,{type:n.value.type,"show-icon":""},{message:s(()=>[c(m(n.value.message),1)]),_:1},8,["type"])])):y("",!0)])])):y("",!0),_.value===2?(d(),p("div",St,[i("div",Lt,[i("div",Vt,[i("h4",null,"Preview ("+m(k.value.length)+" items)",1),i("div",It,[i("span",null,m(r.value.category)+" list",1),r.value.category==="attributed"&&l.value?.headers?(d(),p("span",Tt,m(l.value.headers.length)+" columns ",1)):y("",!0)])]),i("div",Et,[t(ke,{dataSource:k.value,columns:S.value,pagination:{pageSize:10},size:"small",scroll:{x:600}},null,8,["dataSource","columns"])])])])):y("",!0),i("div",Ft,[t(H,{onClick:C},{default:s(()=>e[10]||(e[10]=[c(" Cancel ")])),_:1,__:[10]}),_.value>0?(d(),B(H,{key:0,onClick:w},{default:s(()=>e[11]||(e[11]=[c(" Previous ")])),_:1,__:[11]})):y("",!0),_.value<2?(d(),B(H,{key:1,type:"primary",onClick:F,disabled:!T.value},{default:s(()=>e[12]||(e[12]=[c(" Next ")])),_:1,__:[12]},8,["disabled"])):y("",!0),_.value===2?(d(),B(H,{key:2,type:"primary",onClick:u,loading:P.value},{default:s(()=>e[13]||(e[13]=[c(" Import List ")])),_:1,__:[13]},8,["loading"])):y("",!0)])])]),_:1},8,["open"])}}}),Nt=te(Mt,[["__scopeId","data-v-7a589775"]]),Ot={class:"variable-lists-view"},Ut={class:"view-header"},Rt={class:"header-actions"},zt=ae({__name:"VariableListsViewV3",setup(Y){const O=De(),{variableLists:U,simpleLists:$,attributedLists:K,refusalLists:j,loading:A}=Se(),{deleteVariableList:_,duplicateVariableList:I,exportToCSV:b,exportToJSON:D,isExecuting:P}=ie(),r=N("all"),l=N(!1),n=N(!1),k=M(()=>A.value||P.value),S=M(()=>{switch(r.value){case"all":return U.value;case"simple":return $.value;case"attributed":return K.value;case"refusal":return j.value;default:return[]}});function T(a){r.value=a}async function L(){try{l.value=!0;const a=await ne.checkDefaultsNeeded();if(!a.ok){f.error("Failed to check default data status");return}if(!a.value){f.info("Standard lists are already imported");return}const e=await ne.importDefaults();if(!e.ok){const o=e;f.error(`Failed to import defaults: ${o.error.message}`);return}f.success(`Imported ${e.value.lists} variable lists and ${e.value.templates} templates`)}catch(a){we.error("Error importing defaults:",a),f.error("An unexpected error occurred while importing defaults")}finally{l.value=!1}}function q({key:a}){O.push(`/variables/new?category=${a}`)}function J(a){const e=U.value.map(h=>h.name),o=a.replace(/ \(Modified.*\)$/,"");if(!e.includes(`${o} (Modified)`))return`${o} (Modified)`;let v=2;for(;e.includes(`${o} (Modified ${v})`);)v++;return`${o} (Modified ${v})`}async function E(a){if(a.isDefault){localStorage.getItem("skip-default-edit-message")?await o():ee.info({title:"Editing Default Content",content:"To preserve the original defaults, we'll create a personal copy for you to edit.",okText:"Create Copy",onOk:async()=>{localStorage.setItem("skip-default-edit-message","true"),await o()}});async function o(){f.info("Creating editable copy...");const v=J(a.name),h=await I(a.id,v);h.ok?O.push(`/variables/${h.value}/edit`):f.error("Failed to create copy: "+h.error.message)}}else O.push(`/variables/${a.id}/edit`)}async function F(a){let e=`Are you sure you want to delete "${a.name}"?`;a.isDefault?e+=`

This is a default list. You can restore it later using "Import Standard Lists".`:e+=" This action cannot be undone.",ee.confirm({title:"Delete Variable List",content:e,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{const o=await _(a.id);if(!o.ok){o.error.message.includes("referenced by")?f.error(o.error.message):f.error(`Failed to delete list: ${o.error.message}`);return}f.success("Variable list deleted successfully")}})}async function w(a){const e=await I(a.id);if(!e.ok){f.error(`Failed to duplicate list: ${e.error.message}`);return}f.success("Variable list duplicated successfully")}async function u(a,e){let o;if(e==="csv"?o=await b(a.id):o=await D(a.id),!o.ok){f.error(`Failed to export list: ${o.error.message}`);return}const v=new Blob([o.value],{type:e==="csv"?"text/csv":"application/json"}),h=URL.createObjectURL(v),x=document.createElement("a");x.href=h,x.download=`${a.name}.${e}`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(h),f.success(`List exported as ${e.toUpperCase()}`)}function C(){n.value=!1,f.success("Import completed successfully")}return $e(()=>{}),(a,e)=>{const o=se,v=pe,h=ce,x=ue,R=_e,Z=fe;return d(),p("div",Ot,[i("div",Ut,[e[7]||(e[7]=i("h1",null,"Variable Lists",-1)),i("div",Rt,[t(o,{onClick:L,loading:l.value,"data-testid":"btn-import-defaults"},{default:s(()=>e[2]||(e[2]=[c(" Import Standard Lists ")])),_:1,__:[2]},8,["loading"]),t(x,{placement:"bottomRight"},{overlay:s(()=>[t(h,{onClick:q},{default:s(()=>[t(v,{key:"simple"},{icon:s(()=>[t(g(Xe))]),default:s(()=>[e[4]||(e[4]=c(" Simple List "))]),_:1,__:[4]}),t(v,{key:"attributed"},{icon:s(()=>[t(g(Ze))]),default:s(()=>[e[5]||(e[5]=c(" Intersectional List "))]),_:1,__:[5]}),t(v,{key:"refusal"},{icon:s(()=>[t(g(We))]),default:s(()=>[e[6]||(e[6]=c(" Refusal List "))]),_:1,__:[6]})]),_:1})]),default:s(()=>[t(o,{type:"primary","data-testid":"btn-create-new"},{icon:s(()=>[t(g(He))]),default:s(()=>[e[3]||(e[3]=c(" Create New ")),t(g(de))]),_:1,__:[3]})]),_:1})])]),t(Z,{activeKey:r.value,"onUpdate:activeKey":e[0]||(e[0]=z=>r.value=z),class:"lists-tabs",onChange:T},{default:s(()=>[t(R,{key:"all",tab:"All Lists"},{default:s(()=>[t(X,{lists:S.value,loading:k.value,category:"all",onEdit:E,onDelete:F,onDuplicate:w,onExport:u},null,8,["lists","loading"])]),_:1}),t(R,{key:"simple",tab:"Simple Lists"},{default:s(()=>[t(X,{lists:S.value,loading:k.value,category:"simple",onEdit:E,onDelete:F,onDuplicate:w,onExport:u},null,8,["lists","loading"])]),_:1}),t(R,{key:"attributed",tab:"Intersectional Lists"},{default:s(()=>[t(X,{lists:S.value,loading:k.value,category:"attributed",onEdit:E,onDelete:F,onDuplicate:w,onExport:u},null,8,["lists","loading"])]),_:1}),t(R,{key:"refusal",tab:"Refusal Lists"},{default:s(()=>[t(X,{lists:S.value,loading:k.value,category:"refusal",onEdit:E,onDelete:F,onDuplicate:w,onExport:u},null,8,["lists","loading"])]),_:1})]),_:1},8,["activeKey"]),t(Nt,{open:n.value,"onUpdate:open":e[1]||(e[1]=z=>n.value=z),onImported:C},null,8,["open"])])}}}),Yt=te(zt,[["__scopeId","data-v-fbaeb0fc"]]);export{Yt as default};

var Nt=Object.defineProperty;var Wt=(n,e,t)=>e in n?Nt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ce=(n,e,t)=>Wt(n,typeof e!="symbol"?e+"":e,t);import{e as A,I as Xe,f as ie,r as q,c as M,t as ve,o as he,w as ue,h as p,ae as ee,i as s,A as O,aO as $e,aj as ge,j as o,k as re,ai as Te,aW as Ht,aX as zt,aY as Bt,v as J,aZ as Gt,a_ as jt,y as Z,ag as yt,af as Ce,x as F,F as X,C as se,aw as nt,a$ as qt,b0 as Kt,b1 as lt,G as H,aI as _t,ak as Ge,ap as Tt,B as w,b2 as Qt,z as W,P as Yt,ad as Jt,aL as ot,av as Xt,aQ as $t,L as Zt,M as Ct,J as es,N as ts,R as it,aK as ss,u as Ze,D as oe,a as g,s as Le,d as je,b3 as Ie,b4 as Re,b5 as ze,Y as kt,aV as St,b6 as as,al as wt,a6 as ns,aD as ls,Z as It,Q as et,az as qe,H as os,am as is,K as rs}from"./index-BjcyMJf8.js";import{c as Rt,F as us,C as ds,b as Et,u as cs,a as ps,d as fs}from"./useCostEstimation-C-Vl_bjA.js";import{F as ms}from"./FilterOutlined-Bx336SD8.js";import{I as vs}from"./InboxOutlined-CX9GbWIz.js";import{S as gs}from"./StopOutlined-BGOBgInM.js";import{u as hs}from"./useHeatmapStylingV3-CEqlSZ71.js";import{W as Vt}from"./WarningOutlined-B613K_vE.js";import{u as bs}from"./useV4Models-LvYBsRZc.js";import"./useV4LiveQuery-CHMCjA-b.js";var ys={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};function rt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),l.forEach(function(r){_s(n,r,t[r])})}return n}function _s(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var tt=function(e,t){var l=rt({},e,t.attrs);return A(Xe,rt({},l,{icon:ys}),null)};tt.displayName="ColumnHeightOutlined";tt.inheritAttrs=!1;var Ts={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function ut(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),l.forEach(function(r){$s(n,r,t[r])})}return n}function $s(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var st=function(e,t){var l=ut({},e,t.attrs);return A(Xe,ut({},l,{icon:Ts}),null)};st.displayName="PauseCircleOutlined";st.inheritAttrs=!1;var Cs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function dt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),l.forEach(function(r){ks(n,r,t[r])})}return n}function ks(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var at=function(e,t){var l=dt({},e,t.attrs);return A(Xe,dt({},l,{icon:Cs}),null)};at.displayName="SyncOutlined";at.inheritAttrs=!1;const Ss={class:"right-panel"},ws=ie({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(n,{expose:e,emit:t}){const l=n,r=t,i=q(l.defaultWidth),c=q(!1),T=q(0),u=q(0),m=q(window.innerWidth),S=q(!1),$=M(()=>m.value<l.mobileBreakpoint),h=M(()=>$.value?{width:`${Math.min(m.value*.85,400)}px`}:{width:`${i.value}px`});function y(){const d=localStorage.getItem(l.storageKey);if(d){const L=parseInt(d,10);!isNaN(L)&&L>=l.minWidth&&L<=l.maxWidth&&(i.value=L)}}function _(d){localStorage.setItem(l.storageKey,d.toString()),r("resize",d)}function v(d){c.value=!0,T.value=d.clientX,u.value=i.value,document.addEventListener("mousemove",C),document.addEventListener("mouseup",x),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function C(d){if(!c.value)return;const L=d.clientX-T.value,G=Math.max(l.minWidth,Math.min(l.maxWidth,u.value+L));i.value=G}function x(){c.value&&(c.value=!1,_(i.value),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",x),document.body.style.userSelect="",document.body.style.cursor="")}function V(){i.value=l.defaultWidth,_(l.defaultWidth)}function b(){m.value=window.innerWidth,!$.value&&S.value&&(S.value=!1,r("mobile-overlay-change",!1))}function E(){$.value&&(S.value=!S.value,r("mobile-overlay-change",S.value))}function f(){S.value=!1,r("mobile-overlay-change",!1)}return e({toggleMobileOverlay:E,closeMobileOverlay:f}),ve(()=>{y(),window.addEventListener("resize",b)}),he(()=>{window.removeEventListener("resize",b),x()}),ue(()=>l.defaultWidth,d=>{i.value===l.defaultWidth&&(i.value=d)}),(d,L)=>(o(),p("div",{class:ee(["resizable-panel-container",{"mobile-overlay":$.value}])},[s("div",{class:ee(["left-panel",{"overlay-visible":$.value&&S.value}]),style:ge(h.value)},[$e(d.$slots,"left",{},void 0,!0)],6),$.value?O("",!0):(o(),p("div",{key:0,class:ee(["resize-handle",{dragging:c.value}]),onMousedown:v,onDblclick:V},L[0]||(L[0]=[s("div",{class:"handle-bar"},null,-1)]),34)),s("div",Ss,[$e(d.$slots,"right",{},void 0,!0)]),$.value&&S.value?(o(),p("div",{key:1,class:"mobile-overlay-bg",onClick:f})):O("",!0)],2))}}),Is=re(ws,[["__scopeId","data-v-949e1df1"]]);function Rs(){var n=window.navigator.userAgent,e=n.indexOf("MSIE ");if(e>0)return parseInt(n.substring(e+5,n.indexOf(".",e)),10);var t=n.indexOf("Trident/");if(t>0){var l=n.indexOf("rv:");return parseInt(n.substring(l+3,n.indexOf(".",l)),10)}var r=n.indexOf("Edge/");return r>0?parseInt(n.substring(r+5,n.indexOf(".",r)),10):-1}let Fe;function Ke(){Ke.init||(Ke.init=!0,Fe=Rs()!==-1)}var xe={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ke(),Te(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const n=document.createElement("object");this._resizeObject=n,n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex",-1),n.onload=this.addResizeHandlers,n.type="text/html",Fe&&this.$el.appendChild(n),n.data="about:blank",Fe||this.$el.appendChild(n)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Fe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Es=Bt();Ht("data-v-b329ee4c");const Vs={class:"resize-observer",tabindex:"-1"};zt();const As=Es((n,e,t,l,r,i)=>(o(),J("div",Vs)));xe.render=As;xe.__scopeId="data-v-b329ee4c";xe.__file="src/components/ResizeObserver.vue";function Pe(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pe=function(e){return typeof e}:Pe=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(n)}function Os(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Ls(n,e){for(var t=0;t<e.length;t++){var l=e[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}function Fs(n,e,t){return e&&Ls(n.prototype,e),n}function ct(n){return Ps(n)||Ms(n)||Ds(n)||xs()}function Ps(n){if(Array.isArray(n))return Qe(n)}function Ms(n){if(typeof Symbol<"u"&&Symbol.iterator in Object(n))return Array.from(n)}function Ds(n,e){if(n){if(typeof n=="string")return Qe(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qe(n,e)}}function Qe(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,l=new Array(e);t<e;t++)l[t]=n[t];return l}function xs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Us(n){var e;return typeof n=="function"?e={callback:n}:e=n,e}function Ns(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l,r,i,c=function(u){for(var m=arguments.length,S=new Array(m>1?m-1:0),$=1;$<m;$++)S[$-1]=arguments[$];if(i=S,!(l&&u===r)){var h=t.leading;typeof h=="function"&&(h=h(u,r)),(!l||u!==r)&&h&&n.apply(void 0,[u].concat(ct(i))),r=u,clearTimeout(l),l=setTimeout(function(){n.apply(void 0,[u].concat(ct(i))),l=0},e)}};return c._clear=function(){clearTimeout(l),l=null},c}function At(n,e){if(n===e)return!0;if(Pe(n)==="object"){for(var t in n)if(!At(n[t],e[t]))return!1;return!0}return!1}var Ws=function(){function n(e,t,l){Os(this,n),this.el=e,this.observer=null,this.frozen=!1,this.createObserver(t,l)}return Fs(n,[{key:"createObserver",value:function(t,l){var r=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Us(t),this.callback=function(T,u){r.options.callback(T,u),T&&r.options.once&&(r.frozen=!0,r.destroyObserver())},this.callback&&this.options.throttle){var i=this.options.throttleOptions||{},c=i.leading;this.callback=Ns(this.callback,this.options.throttle,{leading:function(u){return c==="both"||c==="visible"&&u||c==="hidden"&&!u}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(T){var u=T[0];if(T.length>1){var m=T.find(function($){return $.isIntersecting});m&&(u=m)}if(r.callback){var S=u.isIntersecting&&u.intersectionRatio>=r.threshold;if(S===r.oldResult)return;r.oldResult=S,r.callback(S,u)}},this.options.intersection),Te(function(){r.observer&&r.observer.observe(r.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),n}();function Ot(n,e,t){var l=e.value;if(l)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var r=new Ws(n,l,t);n._vue_visibilityState=r}}function Hs(n,e,t){var l=e.value,r=e.oldValue;if(!At(l,r)){var i=n._vue_visibilityState;if(!l){Lt(n);return}i?i.createObserver(l,t):Ot(n,{value:l},t)}}function Lt(n){var e=n._vue_visibilityState;e&&(e.destroyObserver(),delete n._vue_visibilityState)}var zs={beforeMount:Ot,updated:Hs,unmounted:Lt},Bs={itemsLimit:1e3},Gs=/(auto|scroll)/;function Ft(n,e){return n.parentNode===null?e:Ft(n.parentNode,e.concat([n]))}var Be=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},js=function(e){return Be(e,"overflow")+Be(e,"overflow-y")+Be(e,"overflow-x")},qs=function(e){return Gs.test(js(e))};function pt(n){if(n instanceof HTMLElement||n instanceof SVGElement){for(var e=Ft(n.parentNode,[]),t=0;t<e.length;t+=1)if(qs(e[t]))return e[t];return document.scrollingElement||document.documentElement}}function Ye(n){"@babel/helpers - typeof";return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(n)}var Ks={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(e){return["vertical","horizontal"].includes(e)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Qs(){return this.items.length&&Ye(this.items[0])!=="object"}var Je=!1;if(typeof window<"u"){Je=!1;try{var Ys=Object.defineProperty({},"passive",{get:function(){Je=!0}});window.addEventListener("test",null,Ys)}catch{}}let Js=0;var Ue={name:"RecycleScroller",components:{ResizeObserver:xe},directives:{ObserveVisibility:zs},props:{...Ks,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const n={"-1":{accumulator:0}},e=this.items,t=this.sizeField,l=this.minItemSize;let r=1e4,i=0,c;for(let T=0,u=e.length;T<u;T++)c=e[T][t]||l,c<r&&(r=c),i+=c,n[T]={accumulator:i,size:c};return this.$_computedMinItemSize=r,n}return[]},simpleArray:Qs,itemIndexByKey(){const{keyField:n,items:e}=this,t={};for(let l=0,r=e.length;l<r;l++)t[e[l][n]]=l;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const n=this.$_lastUpdateScrollPosition;typeof n=="number"&&this.$nextTick(()=>{this.scrollToPosition(n)})},beforeUnmount(){this.removeListeners()},methods:{addView(n,e,t,l,r){const i=Gt({id:Js++,index:e,used:!0,key:l,type:r}),c=jt({item:t,position:0,nr:i});return n.push(c),c},unuseView(n,e=!1){const t=this.$_unusedViews,l=n.nr.type;let r=t.get(l);r||(r=[],t.set(l,r)),r.push(n),e||(n.nr.used=!1,n.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(n){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const e=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});e(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&e()},this.updateInterval))}},handleVisibilityChange(n,e){this.ready&&(n||e.boundingClientRect.width!==0||e.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(n,e=!1){const t=this.itemSize,l=this.gridItems||1,r=this.itemSecondarySize||t,i=this.$_computedMinItemSize,c=this.typeField,T=this.simpleArray?null:this.keyField,u=this.items,m=u.length,S=this.sizes,$=this.$_views,h=this.$_unusedViews,y=this.pool,_=this.itemIndexByKey;let v,C,x,V,b;if(!m)v=C=V=b=x=0;else if(this.$_prerender)v=V=0,C=b=Math.min(this.prerender,u.length),x=null;else{const a=this.getScroll();if(e){let k=a.start-this.$_lastUpdateScrollPosition;if(k<0&&(k=-k),t===null&&k<i||k<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=a.start;const I=this.buffer;a.start-=I,a.end+=I;let N=0;if(this.$refs.before&&(N=this.$refs.before.scrollHeight,a.start-=N),this.$refs.after){const k=this.$refs.after.scrollHeight;a.end+=k}if(t===null){let k,j=0,te=m-1,R=~~(m/2),ae;do ae=R,k=S[R].accumulator,k<a.start?j=R:R<m-1&&S[R+1].accumulator>a.start&&(te=R),R=~~((j+te)/2);while(R!==ae);for(R<0&&(R=0),v=R,x=S[m-1].accumulator,C=R;C<m&&S[C].accumulator<a.end;C++);for(C===-1?C=u.length-1:(C++,C>m&&(C=m)),V=v;V<m&&N+S[V].accumulator<a.start;V++);for(b=V;b<m&&N+S[b].accumulator<a.end;b++);}else{v=~~(a.start/t*l);const k=v%l;v-=k,C=Math.ceil(a.end/t*l),V=Math.max(0,Math.floor((a.start-N)/t*l)),b=Math.floor((a.end-N)/t*l),v<0&&(v=0),C>m&&(C=m),V<0&&(V=0),b>m&&(b=m),x=Math.ceil(m/l)*t}}C-v>Bs.itemsLimit&&this.itemsLimitError(),this.totalSize=x;let E;const f=v<=this.$_endIndex&&C>=this.$_startIndex;if(f)for(let a=0,I=y.length;a<I;a++)E=y[a],E.nr.used&&(n&&(E.nr.index=_[E.item[T]]),(E.nr.index==null||E.nr.index<v||E.nr.index>=C)&&this.unuseView(E));const d=f?null:new Map;let L,G,U;for(let a=v;a<C;a++){L=u[a];const I=T?L[T]:L;if(I==null)throw new Error(`Key is ${I} on item (keyField is '${T}')`);if(E=$.get(I),!t&&!S[a].size){E&&this.unuseView(E);continue}G=L[c];let N=h.get(G),k=!1;if(!E)f?N&&N.length?E=N.pop():E=this.addView(y,a,L,I,G):(U=d.get(G)||0,(!N||U>=N.length)&&(E=this.addView(y,a,L,I,G),this.unuseView(E,!0),N=h.get(G)),E=N[U],d.set(G,U+1)),$.delete(E.nr.key),E.nr.used=!0,E.nr.index=a,E.nr.key=I,E.nr.type=G,$.set(I,E),k=!0;else if(!E.nr.used&&(E.nr.used=!0,k=!0,N)){const j=N.indexOf(E);j!==-1&&N.splice(j,1)}E.item=L,k&&(a===u.length-1&&this.$emit("scroll-end"),a===0&&this.$emit("scroll-start")),t===null?(E.position=S[a-1].accumulator,E.offset=0):(E.position=Math.floor(a/l)*t,E.offset=a%l*r)}return this.$_startIndex=v,this.$_endIndex=C,this.emitUpdate&&this.$emit("update",v,C,V,b),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:f}},getListenerTarget(){let n=pt(this.$el);return window.document&&(n===window.document.documentElement||n===window.document.body)&&(n=window),n},getScroll(){const{$el:n,direction:e}=this,t=e==="vertical";let l;if(this.pageMode){const r=n.getBoundingClientRect(),i=t?r.height:r.width;let c=-(t?r.top:r.left),T=t?window.innerHeight:window.innerWidth;c<0&&(T+=c,c=0),c+T>i&&(T=i-c),l={start:c,end:c+T}}else t?l={start:n.scrollTop,end:n.scrollTop+n.clientHeight}:l={start:n.scrollLeft,end:n.scrollLeft+n.clientWidth};return l},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Je?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(n){let e;const t=this.gridItems||1;this.itemSize===null?e=n>0?this.sizes[n-1].accumulator:0:e=Math.floor(n/t)*this.itemSize,this.scrollToPosition(e)},scrollToPosition(n){const e=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,l,r;if(this.pageMode){const i=pt(this.$el),c=i.tagName==="HTML"?0:i[e.scroll],T=i.getBoundingClientRect(),m=this.$el.getBoundingClientRect()[e.start]-T[e.start];t=i,l=e.scroll,r=n+c+m}else t=this.$el,l=e.scroll,r=n;t[l]=r},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((n,e)=>n.nr.index-e.nr.index)}}};const Xs={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Zs={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function ea(n,e,t,l,r,i){const c=Z("ResizeObserver"),T=yt("observe-visibility");return Ce((o(),p("div",{class:ee(["vue-recycle-scroller",{ready:r.ready,"page-mode":t.pageMode,[`direction-${n.direction}`]:!0}]),onScrollPassive:e[0]||(e[0]=(...u)=>i.handleScroll&&i.handleScroll(...u))},[n.$slots.before?(o(),p("div",Xs,[$e(n.$slots,"before")],512)):O("v-if",!0),(o(),J(nt(t.listTag),{ref:"wrapper",style:ge({[n.direction==="vertical"?"minHeight":"minWidth"]:r.totalSize+"px"}),class:ee(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:F(()=>[(o(!0),p(X,null,se(r.pool,u=>(o(),J(nt(t.itemTag),qt({key:u.nr.id,style:r.ready?{transform:`translate${n.direction==="vertical"?"Y":"X"}(${u.position}px) translate${n.direction==="vertical"?"X":"Y"}(${u.offset}px)`,width:t.gridItems?`${n.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${n.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&r.hoverKey===u.nr.key}]]},Kt(t.skipHover?{}:{mouseenter:()=>{r.hoverKey=u.nr.key},mouseleave:()=>{r.hoverKey=null}})),{default:F(()=>[$e(n.$slots,"default",{item:u.item,index:u.nr.index,active:u.nr.used})]),_:2},1040,["style","class"]))),128)),$e(n.$slots,"empty")]),_:3},8,["style","class"])),n.$slots.after?(o(),p("div",Zs,[$e(n.$slots,"after")],512)):O("v-if",!0),A(c,{onNotify:i.handleResize},null,8,["onNotify"])],34)),[[T,i.handleVisibilityChange]])}Ue.render=ea;Ue.__file="src/components/RecycleScroller.vue";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ft=()=>{};function ta(n,e){function t(...l){return new Promise((r,i)=>{Promise.resolve(n(()=>e.apply(this,l),{fn:e,thisArg:this,args:l})).then(r).catch(i)})}return t}function sa(n,e={}){let t,l,r=ft;const i=u=>{clearTimeout(u),r(),r=ft};let c;return u=>{const m=lt(n),S=lt(e.maxWait);return t&&i(t),m<=0||S!==void 0&&S<=0?(l&&(i(l),l=void 0),Promise.resolve(u())):new Promise(($,h)=>{r=e.rejectOnCancel?h:$,c=u,S&&!l&&(l=setTimeout(()=>{t&&i(t),l=void 0,$(c())},S)),t=setTimeout(()=>{l&&i(l),l=void 0,$(u())},m)})}}function Pt(n,e=200,t={}){return ta(sa(e,t),n)}const aa={class:"trial-list-search"},na=["value"],la=ie({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=q(),r=Pt(m=>{t("update:modelValue",m)},300);function i(m){const S=m.target.value;r(S)}function c(){var m;t("update:modelValue",""),(m=l.value)==null||m.focus()}function T(){var m,S;(m=l.value)==null||m.focus(),(S=l.value)==null||S.select()}function u(m){m.type==="focus-trial-search"&&T()}return ve(()=>{window.addEventListener("focus-trial-search",u)}),he(()=>{window.removeEventListener("focus-trial-search",u)}),(m,S)=>(o(),p("div",aa,[A(H(_t),{class:"search-icon"}),s("input",{ref_key:"searchInput",ref:l,type:"text",class:"search-input",placeholder:"Filter trials...",value:m.modelValue,onInput:i,onKeydown:Ge(c,["escape"])},null,40,na),m.modelValue?(o(),J(H(Tt),{key:0,class:"clear-icon",onClick:c})):O("",!0)]))}}),oa=re(la,[["__scopeId","data-v-3a032c2b"]]),ia={class:"item-content"},ra={class:"item-header"},ua=["title"],da={key:0,class:"progress-bar"},ca={class:"item-metadata"},pa={class:"meta-item"},fa={class:"meta-item"},ma={key:0,class:"meta-separator"},va={key:1,class:"meta-item cost"},ga=ie({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(n){const e=n,{calculateTemplateTokens:t,calculatePromptTokens:l,estimateCost:r,sumEstimates:i,multiplyEstimate:c,formatCost:T}=Rt(),u=M(()=>{if(e.trial.progress.total===0)return 0;const h=e.trial.progress.completed+e.trial.progress.failed;return Math.round(h/e.trial.progress.total*100)}),m=M(()=>{const{completed:h,failed:y,total:_}=e.trial.progress;return e.trial.status==="draft"?`${_} tasks`:`${h+y}/${_} tasks`}),S=M(()=>{const h=e.trial.started||e.trial.created;if(!h)return"";const _=new Date().getTime()-h.getTime(),v=Math.floor(_/1e3),C=Math.floor(v/60),x=Math.floor(C/60),V=Math.floor(x/24);return v<60?"now":C<60?`${C}m`:x<24?`${x}h`:`${V}d`}),$=M(()=>{var x,V;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let h=0;if(e.trial.type==="template"&&((x=e.trial.templateConfig)!=null&&x.template))h=t(e.trial.templateConfig.template,e.trial.templateConfig.variables||{});else if(e.trial.type==="spreadsheet"&&((V=e.trial.spreadsheetConfig)!=null&&V.promptPattern))h=l(e.trial.spreadsheetConfig.promptPattern);else if(e.trial.type==="playground")return null;if(h===0)return null;const y=e.trial.configurations.map(b=>{const E=b.modelSnapshot;return E?r(h,E,b.parameters):null}).filter(Boolean);if(y.length===0)return null;const _=i(y),v=e.trial.progress.total/e.trial.configurations.length,C=c(_,v);return T(C,"range")});return(h,y)=>(o(),p("div",{class:ee(["trial-list-item",{selected:h.selected,"has-progress":h.trial.status==="running"}]),onClick:y[0]||(y[0]=_=>h.$emit("click"))},[s("div",{class:ee(["status-indicator",`status-${h.trial.status}`])},null,2),s("div",ia,[s("div",ra,[s("span",{class:"trial-name",title:h.trial.name},w(h.trial.name),9,ua),s("span",{class:ee(["status-tag",`status-${h.trial.status}`])},w(h.trial.status.toUpperCase()),3)]),h.trial.status==="running"?(o(),p("div",da,[s("div",{class:"progress-fill",style:ge({width:`${u.value}%`})},null,4)])):O("",!0),s("div",ca,[s("span",pa,w(m.value),1),y[1]||(y[1]=s("span",{class:"meta-separator"},"â€¢",-1)),s("span",fa,w(S.value),1),$.value?(o(),p("span",ma,"â€¢")):O("",!0),$.value?(o(),p("span",va,w($.value),1)):O("",!0)])])],2))}}),mt=re(ga,[["__scopeId","data-v-fd430f00"]]),ha={class:"section-title"},ba=ie({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(n){return(e,t)=>(o(),p("div",{class:ee(["trial-list-section",{"with-background":e.background}])},[s("span",ha,w(e.title),1)],2))}}),vt=re(ba,[["__scopeId","data-v-07a26c58"]]),ya={class:"panel-header"},_a={class:"header-title"},Ta={key:0,class:"title-text"},$a={class:"trial-count"},Ca={key:0,class:"header-actions"},ka={class:"filter-count"},Sa={class:"filter-count"},wa={class:"filter-count"},Ia={class:"filter-count"},Ra={class:"filter-count"},Ea={key:1,class:"status-tabs"},Va={class:"tab-count"},Aa={class:"tab-count"},Oa={class:"tab-count"},La={class:"trial-list-container"},Fa={key:1,class:"trial-list"},Pa={key:2,class:"collapsed-list"},Ma=["onClick"],Da={class:"collapsed-count"},xa={key:3,class:"empty-state"},Ua=ie({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","update-search","update-filter","refresh"],setup(n,{emit:e}){const t=n,l=e,r=q(!1),i=q("all"),c=q(250),T=M(()=>c.value<50),u=M(()=>t.trials.filter(d=>d.status==="running"||d.status==="paused").length),m=M(()=>t.trials.filter(d=>d.status==="completed"||d.status==="failed").length),S=M(()=>{let d=t.trials;if(t.searchQuery){const a=t.searchQuery.toLowerCase();d=d.filter(I=>{var te,R;const N=I.name.toLowerCase().includes(a),k=(R=(te=I.templateConfig)==null?void 0:te.template)==null?void 0:R.toLowerCase().includes(a),j=I.configurations.some(ae=>ae.modelId.toLowerCase().includes(a)||ae.provider.toLowerCase().includes(a));return N||k||j})}t.filterStatus!=="all"&&(d=d.filter(a=>a.status===t.filterStatus)),i.value==="active"?d=d.filter(a=>a.status==="running"||a.status==="paused"):i.value==="done"&&(d=d.filter(a=>a.status==="completed"||a.status==="failed"));const L=d.filter(a=>a.status==="running"),G=d.filter(a=>a.status!=="running"),U=[];return L.length>0&&(U.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),U.push(...L.sort((a,I)=>{var N,k;return(((N=I.started)==null?void 0:N.getTime())||0)-(((k=a.started)==null?void 0:k.getTime())||0)}))),G.length>0&&(L.length>0&&U.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),U.push(...G.sort((a,I)=>{var N,k;return(((N=I.created)==null?void 0:N.getTime())||0)-(((k=a.created)==null?void 0:k.getTime())||0)}))),U}),$=M(()=>S.value.map(d=>({...d,height:x(d)}))),h=M(()=>t.trials.filter(d=>i.value==="active"?d.status==="running"||d.status==="paused":i.value==="done"?d.status==="completed"||d.status==="failed":!0)),y=M(()=>t.searchQuery?"No trials found":t.filterStatus==="running"?"No trials are currently running":"No trials found"),_=M(()=>t.searchQuery?"No trials match your search":t.filterStatus!=="all"?`No ${t.filterStatus} trials`:"Create your first trial to get started"),v=M(()=>t.filterStatus==="all"&&!t.searchQuery);function C(d){return t.trials.filter(L=>L.status===d).length}function x(d){var U;if(d.type==="section")return 32;const L=d.status==="running",G=(U=d.configurations)==null?void 0:U.some(a=>a.repeatCount>1);return L||G?96:80}function V(d){const L=d.progress.completed+d.progress.failed;return d.status==="running"?`${Math.round(L/d.progress.total*100)}%`:L.toString()}async function b(){r.value=!0;try{await new Promise(d=>setTimeout(d,500)),l("refresh")}finally{r.value=!1}}function E({key:d}){l("update-filter",d)}function f(){const d=document.querySelector(".trial-list-panel");d&&(c.value=d.clientWidth)}return ve(()=>{f(),window.addEventListener("resize",f);const d=document.querySelector(".trial-list-panel");d&&new ResizeObserver(()=>f()).observe(d)}),he(()=>{window.removeEventListener("resize",f)}),(d,L)=>{const G=Z("a-button"),U=Z("a-menu-item"),a=Z("a-menu-divider"),I=Z("a-menu"),N=Z("a-dropdown");return o(),p("div",{class:ee(["trial-list-panel",{collapsed:T.value}])},[s("div",ya,[s("div",_a,[A(H(Qt),{class:"title-icon"}),T.value?O("",!0):(o(),p("span",Ta,"Trials")),s("span",$a,w(d.trials.length),1)]),T.value?O("",!0):(o(),p("div",Ca,[A(G,{type:"primary",size:"small",onClick:L[0]||(L[0]=k=>d.$emit("create-trial"))},{default:F(()=>[A(H(Yt)),L[6]||(L[6]=W(" New Trial "))]),_:1,__:[6]}),A(G,{size:"small",onClick:b,loading:r.value},{default:F(()=>[A(H(at),{spin:r.value},null,8,["spin"])]),_:1},8,["loading"]),A(N,null,{overlay:F(()=>[A(I,{onClick:E},{default:F(()=>[A(U,{key:"all"},{default:F(()=>L[7]||(L[7]=[s("span",null,"All Trials",-1)])),_:1,__:[7]}),A(a),A(U,{key:"running"},{default:F(()=>[L[8]||(L[8]=s("span",null,"Running Only",-1)),s("span",ka,w(C("running")),1)]),_:1,__:[8]}),A(U,{key:"completed"},{default:F(()=>[L[9]||(L[9]=s("span",null,"Completed Only",-1)),s("span",Sa,w(C("completed")),1)]),_:1,__:[9]}),A(U,{key:"failed"},{default:F(()=>[L[10]||(L[10]=s("span",null,"Failed Only",-1)),s("span",wa,w(C("failed")),1)]),_:1,__:[10]}),A(U,{key:"paused"},{default:F(()=>[L[11]||(L[11]=s("span",null,"Paused Only",-1)),s("span",Ia,w(C("paused")),1)]),_:1,__:[11]}),A(U,{key:"draft"},{default:F(()=>[L[12]||(L[12]=s("span",null,"Draft Only",-1)),s("span",Ra,w(C("draft")),1)]),_:1,__:[12]})]),_:1})]),default:F(()=>[A(G,{size:"small"},{default:F(()=>[A(H(ms))]),_:1})]),_:1})]))]),T.value?O("",!0):(o(),J(oa,{key:0,"model-value":d.searchQuery,"onUpdate:modelValue":L[1]||(L[1]=k=>d.$emit("update-search",k))},null,8,["model-value"])),T.value?O("",!0):(o(),p("div",Ea,[s("div",{class:ee(["status-tab",{active:i.value==="all"}]),onClick:L[2]||(L[2]=k=>i.value="all")},[L[13]||(L[13]=s("span",{class:"tab-icon"},"ðŸ“Š",-1)),L[14]||(L[14]=s("span",{class:"tab-label"},"ALL",-1)),s("span",Va,w(d.trials.length),1)],2),s("div",{class:ee(["status-tab",{active:i.value==="active"}]),onClick:L[3]||(L[3]=k=>i.value="active")},[L[15]||(L[15]=s("span",{class:"tab-icon"},"ðŸŸ¢",-1)),L[16]||(L[16]=s("span",{class:"tab-label"},"Active",-1)),s("span",Aa,w(u.value),1)],2),s("div",{class:ee(["status-tab",{active:i.value==="done"}]),onClick:L[4]||(L[4]=k=>i.value="done")},[L[17]||(L[17]=s("span",{class:"tab-icon"},"âœ…",-1)),L[18]||(L[18]=s("span",{class:"tab-label"},"Done",-1)),s("span",Oa,w(m.value),1)],2)])),s("div",La,[!T.value&&S.value.length>100?(o(),J(H(Ue),{key:0,class:"trial-list virtual-list",items:$.value,"size-field":"height","key-field":"id",buffer:10},{default:F(({item:k})=>[k.type==="section"?(o(),J(vt,{key:0,title:k.title,background:k.background},null,8,["title","background"])):(o(),J(mt,{key:1,trial:k,selected:k.id===d.selectedTrialId,"data-trial-id":k.id,onClick:j=>d.$emit("select-trial",k.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):T.value?(o(),p("div",Pa,[(o(!0),p(X,null,se(h.value,k=>(o(),p("div",{key:k.id,class:ee(["collapsed-item",{selected:k.id===d.selectedTrialId}]),onClick:j=>d.$emit("select-trial",k.id)},[s("div",{class:ee(["status-dot",`status-${k.status}`])},null,2),s("span",Da,w(V(k)),1)],10,Ma))),128))])):(o(),p("div",Fa,[(o(!0),p(X,null,se(S.value,(k,j)=>(o(),p(X,{key:k.id||`section-${j}`},[k.type==="section"?(o(),J(vt,{key:0,title:k.title,background:k.background},null,8,["title","background"])):(o(),J(mt,{key:1,trial:k,selected:k.id===d.selectedTrialId,"data-trial-id":k.id,onClick:te=>d.$emit("select-trial",k.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),S.value.length===0&&!T.value?(o(),p("div",xa,[A(H(vs),{class:"empty-icon"}),s("h3",null,w(y.value),1),s("p",null,w(_.value),1),v.value?(o(),J(G,{key:0,type:"primary",size:"large",onClick:L[5]||(L[5]=k=>d.$emit("create-trial"))},{default:F(()=>L[19]||(L[19]=[W(" Create New Trial ")])),_:1,__:[19]})):O("",!0)])):O("",!0)])],2)}}}),Na=re(Ua,[["__scopeId","data-v-46871462"]]),Wa={class:"trial-header"},Ha={class:"header-main"},za={class:"header-title"},Ba={class:"trial-name"},Ga={key:0,class:"progress-container"},ja={class:"progress-bar"},qa={class:"progress-stats-inline"},Ka={class:"progress-text"},Qa={key:0,class:"progress-stat"},Ya={class:"stat-number"},Ja={key:1,class:"progress-stat"},Xa={class:"stat-number"},Za={key:2,class:"progress-stat"},en={class:"stat-number"},tn=ie({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(n){const e=n,t=M(()=>{let _=e.trial.name;return _=_.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),_=_.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),_.trim()}),l=M(()=>!0),r=M(()=>e.progress?e.progress.completed+e.progress.failed:0),i=M(()=>{if(!e.progress||e.progress.total===0)return 0;const _=e.progress.completed+e.progress.failed;return Math.round(_/e.progress.total*100)}),c=M(()=>{const _=e.trial.started||e.trial.created;if(!_)return"0m";let v;if(e.trial.status==="draft")return"0m";e.trial.completed?v=e.trial.completed:v=new Date;const C=v.getTime()-_.getTime(),x=Math.floor(C/(1e3*60*60)),V=Math.floor(C%(1e3*60*60)/(1e3*60));return x>0?`${x}h ${V}m`:`${V}m`}),T=M(()=>{var v;if(!((v=e.progress)!=null&&v.avgLatencyMs))return null;const _=e.progress.avgLatencyMs;return _<1e3?`${Math.round(_)}ms`:`${(_/1e3).toFixed(1)}s`}),{calculateTemplateTokens:u,estimateCost:m,sumEstimates:S,multiplyEstimate:$,formatCost:h}=Rt();M(()=>{var E,f,d;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let _=0;if(e.trial.type==="template"&&((E=e.trial.templateConfig)!=null&&E.template))_=u(e.trial.templateConfig.template,e.trial.templateConfig.variables||{});else if(e.trial.type==="spreadsheet"&&((f=e.trial.spreadsheetConfig)!=null&&f.promptPattern))_=Jt().estimateTokens(e.trial.spreadsheetConfig.promptPattern);else if(e.trial.type==="playground")return null;if(_===0)return null;const v=((d=e.progress)==null?void 0:d.total)||e.trial.progress.total,C=Math.ceil(v/e.trial.configurations.length),x=e.trial.configurations.map(L=>{const G=L.modelSnapshot;return G?m(_,G,L.parameters):null}).filter(Boolean);if(x.length===0)return null;const V=S(x),b=$(V,C);if(e.progress&&e.progress.completed>0){const L=e.progress.completed/v,G=$(b,L);return h(G,"range")}return h(b,"range")});const y=M(()=>{var b;if(e.trial.status!=="running"||!e.progress||e.progress.completed===0)return null;const v=(Date.now()-(((b=e.trial.started)==null?void 0:b.getTime())||0))/e.progress.completed,C=e.progress.pending*v,x=Math.floor(C/(1e3*60)),V=Math.floor(C%(1e3*60)/1e3);if(x>60){const E=Math.floor(x/60),f=x%60;return`${E}h ${f}m`}return`${x}m ${V}s`});return(_,v)=>{var C;return o(),p("div",Wa,[s("div",Ha,[s("div",za,[s("h2",Ba,w(t.value),1),s("span",{class:ee(["status-tag",`status-${_.trial.status}`])},w(_.trial.status.toUpperCase()),3)]),l.value?(o(),p("div",Ga,[s("div",ja,[s("div",{class:"progress-fill",style:ge({width:`${i.value}%`})},null,4)]),s("div",qa,[s("span",Ka,w(r.value)+"/"+w(((C=_.progress)==null?void 0:C.total)||0)+" ("+w(i.value)+"%) ",1),c.value?(o(),p("span",Qa,[v[0]||(v[0]=s("span",{class:"stat-label"},"Duration:",-1)),v[1]||(v[1]=W()),s("span",Ya,w(c.value),1)])):O("",!0),T.value?(o(),p("span",Ja,[v[2]||(v[2]=s("span",{class:"stat-label"},"Avg:",-1)),v[3]||(v[3]=W()),s("span",Xa,w(T.value),1)])):O("",!0),y.value?(o(),p("span",Za,[v[4]||(v[4]=s("span",{class:"stat-label"},"Remaining:",-1)),v[5]||(v[5]=W()),s("span",en,"~"+w(y.value),1)])):O("",!0)])])):O("",!0)]),O("",!0)])}}}),sn=re(tn,[["__scopeId","data-v-f1c97bac"]]),an={class:"trial-actions"},nn={class:"action-group execution-controls"},ln={class:"action-group data-actions"},on={class:"action-group management-actions"},rn=ie({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(n,{emit:e}){const t=n,l=e,r=q(!1),i=q(!1),c=q(!1);M(()=>{var E;return((E=t.executionState)==null?void 0:E.currentTrialId)===t.trial.id});const T=M(()=>["draft","failed","cancelled"].includes(t.trial.status)),u=M(()=>t.trial.status==="running"),m=M(()=>t.trial.status==="paused"),S=M(()=>["running","paused"].includes(t.trial.status));function $(){l("start")}async function h(){r.value=!0,i.value=!1,l("pause"),setTimeout(()=>{r.value=!1},1e3)}async function y(){i.value=!0,r.value=!1,l("resume"),setTimeout(()=>{i.value=!1},3e3)}function _(){it.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>l("cancel")})}async function v(){c.value=!0,l("refresh"),setTimeout(()=>{c.value=!1},500)}function C({key:E}){E==="data"?l("export-data"):E==="python"&&l("export-python")}function x(){l("duplicate")}function V(){l("edit")}function b(){const E=t.trial.progress.total;it.confirm({title:"Delete trial?",content:`Delete trial and all ${E} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{l("delete")}})}return(E,f)=>{const d=Z("a-button"),L=Z("a-menu-item"),G=Z("a-menu"),U=Z("a-dropdown");return o(),p("div",an,[s("div",nn,[T.value?(o(),J(d,{key:0,type:"primary",size:"large",disabled:!E.isLeader,onClick:$},{default:F(()=>[A(H(ot)),f[0]||(f[0]=W(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):O("",!0),u.value?(o(),J(d,{key:1,size:"large",disabled:!E.isLeader,loading:r.value,onClick:h},{default:F(()=>[r.value?O("",!0):(o(),J(H(st),{key:0})),W(" "+w(r.value?"Pausing...":"Pause"),1)]),_:1},8,["disabled","loading"])):O("",!0),m.value?(o(),J(d,{key:2,type:"primary",size:"large",disabled:!E.isLeader||i.value,loading:i.value,onClick:y},{default:F(()=>[i.value?O("",!0):(o(),J(H(ot),{key:0})),W(" "+w(i.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):O("",!0),S.value?(o(),J(d,{key:3,danger:"",size:"large",disabled:!E.isLeader,onClick:_},{default:F(()=>[A(H(gs)),f[1]||(f[1]=W(" Cancel "))]),_:1,__:[1]},8,["disabled"])):O("",!0)]),s("div",ln,[A(d,{size:"large",loading:c.value,onClick:v,title:"Refresh trial data from database"},{default:F(()=>[c.value?(o(),J(H($t),{key:1,spin:""})):(o(),J(H(Xt),{key:0})),W(" "+w(c.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),A(U,null,{overlay:F(()=>[A(G,{onClick:C},{default:F(()=>[A(L,{key:"data"},{default:F(()=>[A(H(us)),f[3]||(f[3]=W(" Export Data "))]),_:1,__:[3]}),A(L,{key:"python"},{default:F(()=>[A(H(ds)),f[4]||(f[4]=W(" Export Python Script "))]),_:1,__:[4]})]),_:1})]),default:F(()=>[A(d,{size:"large"},{default:F(()=>[f[2]||(f[2]=W(" Export ")),A(H(Zt))]),_:1,__:[2]})]),_:1})]),s("div",on,[A(d,{size:"large",disabled:!E.isLeader,onClick:x},{default:F(()=>[A(H(Ct)),f[5]||(f[5]=W(" Duplicate "))]),_:1,__:[5]},8,["disabled"]),E.trial.status==="draft"?(o(),J(d,{key:0,size:"large",disabled:!E.isLeader,onClick:V},{default:F(()=>[A(H(es)),f[6]||(f[6]=W(" Edit "))]),_:1,__:[6]},8,["disabled"])):O("",!0),A(d,{danger:"",size:"large",disabled:!E.isLeader,onClick:b},{default:F(()=>[A(H(ts)),f[7]||(f[7]=W(" Delete "))]),_:1,__:[7]},8,["disabled"])])])}}}),un=re(rn,[["__scopeId","data-v-e642c431"]]),dn={class:"trial-detail-view"},cn={key:0,class:"detail-content"},pn={class:"detail-section"},fn={class:"detail-grid"},mn={class:"detail-item"},vn={key:0,class:"detail-item"},gn={key:1,class:"detail-item"},hn={class:"detail-item"},bn={class:"detail-item"},yn={class:"detail-section"},_n={class:"detail-grid"},Tn={key:0,class:"detail-item full-width"},$n={key:1,class:"detail-item full-width"},Cn={class:"detail-item"},kn={class:"detail-item"},Sn={key:2,class:"detail-item"},wn={key:0,class:"detail-section"},In={class:"detail-grid"},Rn={class:"detail-item"},En={class:"detail-item"},Vn={class:"detail-item"},An={class:"detail-section"},On={class:"model-configs"},Ln={class:"config-header"},Fn=["src","alt"],Pn={class:"provider-name"},Mn={class:"config-details"},Dn={class:"config-item"},xn={class:"config-params"},Un={class:"param-list"},Nn={key:0,class:"config-item"},Wn={class:"cost"},Hn=ie({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(n){const e=n,t=M(()=>{const v=e.trial.started||e.trial.created,x=(e.trial.completed||new Date).getTime()-v.getTime(),V=Math.floor(x/(1e3*60*60)),b=Math.floor(x%(1e3*60*60)/(1e3*60));return V>0?`${V}h ${b}m`:`${b}m`}),l=M(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[e.trial.status]||e.trial.status),r=M(()=>{var v;return e.trial.type==="template"&&((v=e.trial.templateConfig)!=null&&v.variables)?Object.keys(e.trial.templateConfig.variables).length:0}),i=M(()=>Math.round(e.trial.progress.total*750)),c=M(()=>"text"),T=M(()=>1),u=M(()=>e.trial.progress.total/T.value);function m(v){return v?new Date(v).toLocaleString():"N/A"}function S(){var v;return((v=e.trial.templateConfig)==null?void 0:v.template)||"Unknown Template"}function $(){var v;return((v=e.trial.spreadsheetConfig)==null?void 0:v.datasetId)||"Unknown Dataset"}function h(v){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[v]||v}function y(v){}function _(v){var V;const C=v.modelSnapshot;return(V=C==null?void 0:C.capabilities)!=null&&V.inputCostPerToken?`$${((C.capabilities.inputCostPerToken+C.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(v,C)=>(o(),p("div",dn,[s("div",{class:"detail-header",onClick:C[0]||(C[0]=x=>v.$emit("toggle-collapse"))},[C[1]||(C[1]=s("h3",null,"Trial Details",-1)),A(H(ss),{class:ee(["collapse-icon",{rotated:v.isCollapsed}])},null,8,["class"])]),v.isCollapsed?O("",!0):(o(),p("div",cn,[s("div",pn,[C[7]||(C[7]=s("h4",null,"Basic Information",-1)),s("div",fn,[s("div",mn,[C[2]||(C[2]=s("label",null,"Created:",-1)),s("span",null,w(m(v.trial.created)),1)]),v.trial.started?(o(),p("div",vn,[C[3]||(C[3]=s("label",null,"Started:",-1)),s("span",null,w(m(v.trial.started)),1)])):O("",!0),v.trial.completed?(o(),p("div",gn,[C[4]||(C[4]=s("label",null,"Completed:",-1)),s("span",null,w(m(v.trial.completed)),1)])):O("",!0),s("div",hn,[C[5]||(C[5]=s("label",null,"Duration:",-1)),s("span",null,w(t.value),1)]),s("div",bn,[C[6]||(C[6]=s("label",null,"Status:",-1)),s("span",null,w(v.trial.status)+" - "+w(l.value),1)])])]),s("div",yn,[C[13]||(C[13]=s("h4",null,"Configuration",-1)),s("div",_n,[v.trial.type==="template"?(o(),p("div",Tn,[C[8]||(C[8]=s("label",null,"Template:",-1)),s("span",null,w(S()),1)])):O("",!0),v.trial.type==="spreadsheet"?(o(),p("div",$n,[C[9]||(C[9]=s("label",null,"Dataset:",-1)),s("span",null,w($()),1)])):O("",!0),s("div",Cn,[C[10]||(C[10]=s("label",null,"Variable Lists:",-1)),s("span",null,w(r.value)+" lists",1)]),s("div",kn,[C[11]||(C[11]=s("label",null,"Token Estimate:",-1)),s("span",null,"~"+w(i.value)+" tokens",1)]),c.value?(o(),p("div",Sn,[C[12]||(C[12]=s("label",null,"Output Type:",-1)),s("span",{class:ee(["output-type",`type-${c.value}`])},w(c.value),3)])):O("",!0)])]),T.value>1?(o(),p("div",wn,[C[17]||(C[17]=s("h4",null,"Repeat Configuration",-1)),s("div",In,[s("div",Rn,[C[14]||(C[14]=s("label",null,"Times per prompt:",-1)),s("span",null,w(T.value),1)]),s("div",En,[C[15]||(C[15]=s("label",null,"Total combinations:",-1)),s("span",null,w(u.value),1)]),s("div",Vn,[C[16]||(C[16]=s("label",null,"Total API calls:",-1)),s("span",null,w(v.trial.progress.total),1)])])])):O("",!0),s("div",An,[C[21]||(C[21]=s("h4",null,"Model Configurations",-1)),s("div",On,[(o(!0),p(X,null,se(v.trial.configurations,(x,V)=>(o(),p("div",{key:V,class:"model-config-card"},[s("div",Ln,[(x.provider,void 0)?(o(),p("img",{key:0,src:(x.provider,void 0),alt:x.provider,class:"provider-logo"},null,8,Fn)):O("",!0),s("span",Pn,w(h(x.provider)),1)]),s("div",Mn,[s("div",Dn,[C[18]||(C[18]=s("label",null,"Model:",-1)),s("span",null,w(x.modelId),1)]),s("div",xn,[C[19]||(C[19]=s("label",null,"Parameters:",-1)),s("div",Un,[(o(!0),p(X,null,se(x.parameters,(b,E)=>(o(),p("span",{key:E,class:"param-tag"},w(E)+": "+w(b),1))),128))])]),_(x)?(o(),p("div",Nn,[C[20]||(C[20]=s("label",null,"Est. Cost:",-1)),s("span",Wn,w(_(x)),1)])):O("",!0)])]))),128))])])]))]))}}),zn=re(Hn,[["__scopeId","data-v-0613b5f7"]]),Bn={class:"filter-bar"},Gn={class:"search-container"},jn=ie({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns"],setup(n,{emit:e}){const t=n,l=e,r=M(()=>{const m=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return t.showRepeatColumn&&m.splice(2,0,{key:"repeat",label:"Repeat Index"}),m}),i=M(()=>{const m={total:t.apiCalls.length,completed:0,failed:0,running:0,pending:0};return t.apiCalls.forEach(S=>{S.status==="completed"?m.completed++:S.status==="failed"?m.failed++:S.status==="running"?m.running++:S.status==="pending"&&m.pending++}),m});function c(m){var S;return((S=m.modelSnapshot)==null?void 0:S.displayName)||`${m.provider} - ${m.modelId}`}const T=Pt(m=>{const S=m.target.value;l("update:searchQuery",S)},300);function u(m){const S=[...t.visibleColumns],$=S.indexOf(m);if($>-1)S.splice($,1);else{const h=r.value.map(v=>v.key),y=h.indexOf(m);let _=0;for(let v=0;v<y;v++)S.includes(h[v])&&_++;S.splice(_,0,m)}l("update:visibleColumns",S)}return(m,S)=>{const $=Z("a-select-option"),h=Z("a-select"),y=Z("a-input"),_=Z("a-button"),v=Z("a-checkbox"),C=Z("a-menu-item"),x=Z("a-menu"),V=Z("a-dropdown");return o(),p("div",Bn,[A(h,{value:m.statusFilter,onChange:S[0]||(S[0]=b=>m.$emit("update:statusFilter",b)),placeholder:"Filter by status",style:{width:"150px"}},{default:F(()=>[A($,{value:"all"},{default:F(()=>[W(" All ("+w(i.value.total)+") ",1)]),_:1}),A($,{value:"completed"},{default:F(()=>[W(" Completed ("+w(i.value.completed)+") ",1)]),_:1}),A($,{value:"failed"},{default:F(()=>[W(" Failed ("+w(i.value.failed)+") ",1)]),_:1}),A($,{value:"running"},{default:F(()=>[W(" Running ("+w(i.value.running)+") ",1)]),_:1}),A($,{value:"pending"},{default:F(()=>[W(" Pending ("+w(i.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),A(h,{value:m.configFilter,onChange:S[1]||(S[1]=b=>m.$emit("update:configFilter",b)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:F(()=>[A($,{value:""},{default:F(()=>S[2]||(S[2]=[W("All Configurations")])),_:1,__:[2]}),(o(!0),p(X,null,se(m.configurations,(b,E)=>(o(),J($,{key:E,value:E.toString()},{default:F(()=>[W(w(c(b)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),s("div",Gn,[A(y,{value:m.searchQuery,onInput:H(T),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:F(()=>[A(H(_t))]),_:1},8,["value","onInput"])]),A(V,null,{overlay:F(()=>[A(x,null,{default:F(()=>[(o(!0),p(X,null,se(r.value,b=>(o(),J(C,{key:b.key},{default:F(()=>[A(v,{checked:m.visibleColumns.includes(b.key),disabled:b.key==="status",onChange:E=>u(b.key)},{default:F(()=>[W(w(b.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:F(()=>[A(_,null,{default:F(()=>[A(H(tt)),S[3]||(S[3]=W(" Columns "))]),_:1,__:[3]})]),_:1})])}}}),qn=re(jn,[["__scopeId","data-v-1fdfdfd1"]]),Kn={class:"modal-content"},Qn={class:"section"},Yn={class:"info-grid"},Jn={class:"info-item"},Xn={class:"monospace"},Zn={class:"info-item"},el={class:"info-item"},tl={key:0,class:"info-item"},sl={class:"info-item"},al={key:1,class:"info-item"},nl={key:2,class:"info-item"},ll={key:3,class:"info-item"},ol={key:0,class:"info-row"},il={class:"monospace"},rl={key:0,class:"section"},ul={class:"variables-list"},dl={class:"variable-main"},cl={class:"variable-label"},pl={class:"variable-value"},fl={key:0,class:"variable-attributes"},ml={class:"attribute-label"},vl={class:"attribute-value"},gl={class:"section"},hl={class:"content-box prompt-display"},bl={key:1,class:"section"},yl={key:0,class:"error-result"},_l={key:1,class:"success-result"},Tl={class:"content-box response-content"},$l={key:0,class:"parsed-content-section"},Cl={class:"content-box parsed-content"},kl={key:1,class:"refusal-warning"},Sl={class:"extraction-config-section"},wl={class:"config-grid"},Il={key:0,class:"config-item"},Rl={class:"config-value"},El={key:1,class:"config-item"},Vl={class:"config-value pattern"},Al={key:2,class:"config-item"},Ol={class:"config-value"},Ll={key:3,class:"config-item"},Fl={class:"config-value"},Pl={key:4,class:"config-item no-extraction"},Ml={key:2,class:"usage-info"},Dl={class:"info-grid"},xl={class:"info-item"},Ul={class:"info-item"},Nl={class:"info-item"},Wl={key:0,class:"info-item"},Hl={class:"raw-data-section"},zl={class:"raw-data"},Bl={key:0},Gl={key:1,class:"raw-data"},jl={key:2},ql={key:3,class:"raw-data"},Kl={class:"modal-footer"},Ql=ie({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(n,{emit:e}){const t=n,l=e,r=Ze(),i=M(()=>{if(!t.apiCall.completed||!t.apiCall.created)return null;const f=new Date(t.apiCall.created).getTime();return new Date(t.apiCall.completed).getTime()-f}),c=M(()=>{const f=t.trial.configurations[t.apiCall.configurationIndex];return f?`${f.provider} / ${f.modelId}`:null}),T=M(()=>{var U,a,I;if(!((U=t.apiCall.result)!=null&&U.usage))return null;const f=t.trial.configurations[t.apiCall.configurationIndex];if(!f)return null;const d=r.models.value.find(N=>N.provider===f.provider&&N.modelId===f.modelId);if(!((a=d==null?void 0:d.capabilities)!=null&&a.inputCostPerToken)&&!((I=d==null?void 0:d.capabilities)!=null&&I.outputCostPerToken))return null;const L=(t.apiCall.result.usage.prompt_tokens||0)*(d.capabilities.inputCostPerToken||0),G=(t.apiCall.result.usage.completion_tokens||0)*(d.capabilities.outputCostPerToken||0);return L+G}),u=M(()=>{if(!t.apiCall.request)return"No request data";const f=JSON.parse(JSON.stringify(t.apiCall.request));return f.headers&&Object.keys(f.headers).forEach(d=>{(d.toLowerCase().includes("authorization")||d.toLowerCase().includes("api-key")||d.toLowerCase().includes("x-api-key"))&&(f.headers[d]="[REDACTED]")}),f.body&&typeof f.body=="object"&&(f.body.api_key&&(f.body.api_key="[REDACTED]"),f.body.apiKey&&(f.body.apiKey="[REDACTED]")),JSON.stringify(f,null,2)}),m=M(()=>t.trial.type!=="template"||!t.trial.templateConfig?{}:{outputType:t.trial.templateConfig.outputType,extractPattern:t.trial.templateConfig.extractPattern,refusalWords:t.trial.templateConfig.refusalWords,rejectRefusalWords:t.trial.templateConfig.rejectRefusalWords}),S=M(()=>{const f=m.value;return!!(f.outputType||f.extractPattern||f.refusalWords&&f.refusalWords.length>0)}),$=M(()=>t.apiCall.response?JSON.stringify({status:t.apiCall.response.status,headers:t.apiCall.response.headers,body:t.apiCall.response.body,latencyMs:t.apiCall.response.latencyMs},null,2):"No response data available"),h=M(()=>t.apiCall.result?JSON.stringify(t.apiCall.result,null,2):"No processed result available");function y(f){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[f]||"default"}function _(){var d;const f=t.trial.configurations[t.apiCall.configurationIndex];return((d=f==null?void 0:f.modelSnapshot)==null?void 0:d.displayName)||(f==null?void 0:f.modelId)||`Configuration ${t.apiCall.configurationIndex+1}`}function v(f){return(typeof f=="string"?new Date(f):f).toLocaleString()}function C(f){return f<1e3?`${f}ms`:f<6e4?`${(f/1e3).toFixed(1)}s`:`${Math.floor(f/6e4)}m ${(f%6e4/1e3).toFixed(0)}s`}function x(f){return f==null?"null":typeof f=="string"?f:typeof f=="number"||typeof f=="boolean"?String(f):JSON.stringify(f,null,2)}function V(f){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[f]||f}function b(){l("update:visible",!1)}async function E(){const f={id:t.apiCall.id,status:t.apiCall.status,configuration:_(),provider:c.value,variables:t.apiCall.variables,variableAttributes:t.apiCall.variableAttributes,prompt:t.apiCall.prompt,fullApiResponse:t.apiCall.response,processedResult:t.apiCall.result,extractionConfig:m.value,created:t.apiCall.created,completed:t.apiCall.completed,duration:i.value?`${i.value}ms`:null,cost:T.value?`$${T.value.toFixed(4)}`:null},d=JSON.stringify(f,null,2);try{await navigator.clipboard.writeText(d),oe.success("Details copied to clipboard!")}catch(L){g.error("Failed to copy to clipboard",L),oe.error("Failed to copy to clipboard")}}return(f,d)=>{const L=Z("a-tag"),G=Z("a-alert"),U=Z("a-collapse-panel"),a=Z("a-collapse"),I=Z("a-button"),N=Z("a-modal");return o(),J(N,{open:f.visible,onCancel:d[0]||(d[0]=k=>l("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:F(()=>{var k;return[s("div",Kn,[s("div",Qn,[d[10]||(d[10]=s("h3",null,"Overview",-1)),s("div",Yn,[s("div",Jn,[d[1]||(d[1]=s("label",null,"Call ID:",-1)),s("span",Xn,w(f.apiCall.id),1)]),s("div",Zn,[d[2]||(d[2]=s("label",null,"Status:",-1)),A(L,{color:y(f.apiCall.status)},{default:F(()=>[W(w(f.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),s("div",el,[d[3]||(d[3]=s("label",null,"Configuration:",-1)),s("span",null,w(_()),1)]),f.apiCall.repeatIndex!==void 0?(o(),p("div",tl,[d[4]||(d[4]=s("label",null,"Repeat:",-1)),s("span",null,"#"+w(f.apiCall.repeatIndex+1),1)])):O("",!0),s("div",sl,[d[5]||(d[5]=s("label",null,"Created:",-1)),s("span",null,w(v(f.apiCall.created)),1)]),f.apiCall.completed?(o(),p("div",al,[d[6]||(d[6]=s("label",null,"Completed:",-1)),s("span",null,w(v(f.apiCall.completed)),1)])):O("",!0),i.value?(o(),p("div",nl,[d[7]||(d[7]=s("label",null,"Duration:",-1)),s("span",null,w(C(i.value)),1)])):O("",!0),(k=f.apiCall.result)!=null&&k.latency?(o(),p("div",ll,[d[8]||(d[8]=s("label",null,"API Latency:",-1)),s("span",null,w(f.apiCall.result.latency)+"ms",1)])):O("",!0)]),c.value?(o(),p("div",ol,[d[9]||(d[9]=s("label",null,"Provider/Model:",-1)),s("span",il,w(c.value),1)])):O("",!0)]),f.apiCall.variables&&Object.keys(f.apiCall.variables).length>0?(o(),p("div",rl,[d[11]||(d[11]=s("h3",null,"Variables",-1)),s("div",ul,[(o(!0),p(X,null,se(f.apiCall.variables,(j,te)=>(o(),p("div",{key:te,class:"variable-group"},[s("div",dl,[s("label",cl,w(te)+":",1),s("span",pl,w(j),1)]),f.apiCall.variableAttributes&&f.apiCall.variableAttributes[te]?(o(),p("div",fl,[(o(!0),p(X,null,se(f.apiCall.variableAttributes[te],(R,ae)=>(o(),p("div",{key:ae,class:"attribute-item"},[s("label",ml,w(ae)+":",1),s("span",vl,w(R),1)]))),128))])):O("",!0)]))),128))])])):O("",!0),s("div",gl,[d[12]||(d[12]=s("h3",null,"Resolved Prompt",-1)),s("div",hl,w(f.apiCall.prompt),1)]),f.apiCall.result?(o(),p("div",bl,[d[25]||(d[25]=s("h3",null,"Response",-1)),f.apiCall.status==="failed"&&f.apiCall.result.error?(o(),p("div",yl,[A(G,{type:"error",message:f.apiCall.result.error,description:f.apiCall.result.errorType?`Error Type: ${V(f.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):f.apiCall.result.content?(o(),p("div",_l,[s("div",Tl,w(f.apiCall.result.content),1),f.apiCall.result.parsedContent!==void 0?(o(),p("div",$l,[d[13]||(d[13]=s("h4",null,"Extracted Value",-1)),s("div",Cl,w(x(f.apiCall.result.parsedContent)),1)])):O("",!0),f.apiCall.result.refused?(o(),p("div",kl,[A(G,{type:"warning",message:"Response flagged as refusal",description:"This response matched configured refusal patterns","show-icon":""})])):O("",!0),s("div",Sl,[d[19]||(d[19]=s("h4",null,"Extraction Configuration",-1)),s("div",wl,[m.value.outputType?(o(),p("div",Il,[d[14]||(d[14]=s("label",null,"Output Type:",-1)),s("span",Rl,w(m.value.outputType),1)])):O("",!0),m.value.extractPattern?(o(),p("div",El,[d[15]||(d[15]=s("label",null,"Extract Pattern:",-1)),s("span",Vl,w(m.value.extractPattern),1)])):O("",!0),m.value.refusalWords&&m.value.refusalWords.length>0?(o(),p("div",Al,[d[16]||(d[16]=s("label",null,"Refusal Words:",-1)),s("span",Ol,w(m.value.refusalWords.join(", ")),1)])):O("",!0),m.value.rejectRefusalWords!==void 0?(o(),p("div",Ll,[d[17]||(d[17]=s("label",null,"Reject on Refusal:",-1)),s("span",Fl,w(m.value.rejectRefusalWords?"Yes":"No"),1)])):O("",!0),S.value?O("",!0):(o(),p("div",Pl,d[18]||(d[18]=[s("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),f.apiCall.result.usage?(o(),p("div",Ml,[d[24]||(d[24]=s("h4",null,"Token Usage",-1)),s("div",Dl,[s("div",xl,[d[20]||(d[20]=s("label",null,"Prompt Tokens:",-1)),s("span",null,w(f.apiCall.result.usage.prompt_tokens||0),1)]),s("div",Ul,[d[21]||(d[21]=s("label",null,"Completion Tokens:",-1)),s("span",null,w(f.apiCall.result.usage.completion_tokens||0),1)]),s("div",Nl,[d[22]||(d[22]=s("label",null,"Total Tokens:",-1)),s("span",null,w(f.apiCall.result.usage.total_tokens||0),1)]),T.value?(o(),p("div",Wl,[d[23]||(d[23]=s("label",null,"Cost:",-1)),s("span",null,"$"+w(T.value.toFixed(4)),1)])):O("",!0)])])):O("",!0)])):O("",!0)])):O("",!0),A(a,{ghost:""},{default:F(()=>[A(U,{key:"raw",header:"Raw Data"},{default:F(()=>[s("div",Hl,[d[26]||(d[26]=s("h4",null,"HTTP Request",-1)),s("pre",zl,w(u.value),1),f.apiCall.response?(o(),p("h4",Bl,"Full API Response")):O("",!0),f.apiCall.response?(o(),p("pre",Gl,w($.value),1)):O("",!0),f.apiCall.result?(o(),p("h4",jl,"Processed Result")):O("",!0),f.apiCall.result?(o(),p("pre",ql,w(h.value),1)):O("",!0)])]),_:1})]),_:1})]),s("div",Kl,[A(I,{onClick:b,size:"large"},{default:F(()=>d[27]||(d[27]=[W(" Close ")])),_:1,__:[27]}),A(I,{type:"primary",onClick:E,size:"large"},{default:F(()=>[A(H(Ct)),d[28]||(d[28]=W(" Copy Details "))]),_:1,__:[28]})])]}),_:1},8,["open"])}}}),Yl=re(Ql,[["__scopeId","data-v-bd0d6ad2"]]);class Jl{constructor(){ce(this,"apiCalls",Le([]));ce(this,"currentTrialId",Le(null));ce(this,"executionProgress",Le(null));ce(this,"isStreaming",Le(!1));ce(this,"progress",M(()=>{var S,$;const e=performance.now(),t=this.apiCalls.value;if(t.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let l=0,r=0,i=0,c=0,T=0;g.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Computing progress from ${t.length} calls in store`);for(const h of t)switch(h.status){case"completed":l++;break;case"failed":r++,($=(S=h.result)==null?void 0:S.error)!=null&&$.includes("network");break;case"cancelled":i++;break;case"pending":c++;break;case"running":T++;break}const u=performance.now(),m={trialId:this.currentTrialId.value||"",total:t.length,completed:l,failed:r,cancelled:i,pending:c,running:T,lastUpdated:new Date};return g.info(`V4_STORE_PROGRESS: Computed in ${(u-e).toFixed(1)}ms - ${l}/${t.length} completed, ${T} running, ${c} pending`),g.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Final result - completed: ${l}, failed: ${r}, running: ${T}, pending: ${c}, total: ${t.length}`),m}));ce(this,"pivotData",M(()=>{const e=performance.now(),t=this.apiCalls.value,l={rows:[],columns:[],cells:new Map};if(t.length===0)return l;const r=new Set,i=new Set;for(const T of t){if(T.status!=="completed")continue;const u=`Config ${T.configurationIndex}`;r.add(u);const m=Object.keys(T.variables||{}),S=m.length>0?String(T.variables[m[0]]):"default";i.add(S),l.cells.has(u)||l.cells.set(u,new Map);const $=l.cells.get(u);$.has(S)||$.set(S,[]),$.get(S).push(T)}l.rows=Array.from(r).sort(),l.columns=Array.from(i).sort();const c=performance.now();return g.info(`V4_TRIAL_SWITCH: Store pivotData computed for ${t.length} calls in ${(c-e).toFixed(1)}ms`),l}));ce(this,"stats",M(()=>{var $;const e=performance.now(),t=this.apiCalls.value,l=t.length;if(l===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let r=0,i=0,c=0,T=0,u=0,m=0;for(const h of t)switch(h.status){case"completed":r++,($=h.response)!=null&&$.latencyMs&&(u+=h.response.latencyMs,m++);break;case"failed":i++;break;case"pending":c++;break;case"running":T++;break}const S=performance.now();return g.info(`V4_TRIAL_SWITCH: Store stats computed for ${t.length} calls in ${(S-e).toFixed(1)}ms`),{total:l,completed:r,failed:i,pending:c,running:T,avgLatency:m>0?u/m:0,errorRate:l>0?i/l*100:0}}))}updateApiCalls(e){for(const t of e)switch(t.status){}this.apiCalls.value=Object.freeze(e)}updateProgress(e){g.info("STORE_V4: Updating progress:",e.type),this.executionProgress.value=e}setStreaming(e){g.info(`STORE_V4: Set streaming: ${e}`),this.isStreaming.value=e}setCurrentTrial(e){g.info(`STORE_V4: Set current trial: ${e}`),this.currentTrialId.value=e,e||this.clear()}clear(){g.info("STORE_V4: Clearing store data"),this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(e){g.info(`STORE_V4: Refreshing data from database for trial ${e}`);try{const t=await je.apiCalls.where("trialId").equals(e).toArray();g.info(`STORE_V4: Loaded ${t.length} calls from database`),t.sort((l,r)=>{const i=u=>{switch(u){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},c=i(l.status),T=i(r.status);return c!==T?c-T:l.order-r.order}),this.updateApiCalls(t),this.setCurrentTrial(e),g.info("STORE_V4: Refresh complete - store updated with fresh data")}catch(t){throw g.error("STORE_V4: Failed to refresh from database:",t),t}}}let Me=null;function Ne(){return Me||(Me=new Jl,g.info("STORE_V4: Created singleton store instance")),Me}typeof window<"u"&&(window.__trialDataStoreV4=()=>Me);const Xl={class:"trial-results-table"},Zl={class:"table-container"},eo={class:"results-table"},to={key:0,class:"col-status"},so={key:1,class:"col-configuration"},ao={key:2,class:"col-repeat"},no={key:3,class:"col-variables"},lo={key:4,class:"col-response"},oo={key:5,class:"col-parsed"},io={key:6,class:"col-length"},ro={key:7,class:"col-latency"},uo={class:"results-table"},co=["onClick"],po={key:0,class:"col-status"},fo={class:"status-cell"},mo={class:"status-time"},vo={key:1,class:"col-configuration"},go={key:2,class:"col-repeat"},ho={key:3,class:"col-variables"},bo={class:"variable-tags"},yo={key:0,class:"var-item"},_o={key:1,class:"var-item"},To={key:2},$o={key:3},Co={key:4,class:"col-response"},ko={class:"response-content"},So={key:5,class:"col-parsed"},wo={key:6,class:"col-length"},Io={key:7,class:"col-latency"},Ro={key:1,class:"results-table"},Eo={key:0,class:"col-status"},Vo={key:1,class:"col-configuration"},Ao={key:2,class:"col-repeat"},Oo={key:3,class:"col-variables"},Lo={key:4,class:"col-response"},Fo={key:5,class:"col-parsed"},Po={key:6,class:"col-length"},Mo={key:7,class:"col-latency"},Do=["onClick"],xo={key:0,class:"col-status"},Uo={class:"status-cell"},No={class:"status-time"},Wo={key:1,class:"col-configuration"},Ho={key:2,class:"col-repeat"},zo={key:3,class:"col-variables"},Bo={class:"variable-tags"},Go={key:0,class:"var-item"},jo={key:1,class:"var-item"},qo={key:2},Ko={key:3},Qo={key:4,class:"col-response"},Yo={class:"response-content"},Jo={key:5,class:"col-parsed"},Xo={key:6,class:"col-length"},Zo={key:7,class:"col-latency"},ei={key:0},ti=["colspan"],si={key:0},ai={key:1},gt="trial-results-visible-columns",ni=ie({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(n){const e=n,t=q("all"),l=q([]),r=q(""),i=q(["status","configuration","variables","response","parsedResponse","length","latency"]),c=q(null),T=Ne(),u=M(()=>{var a;return((a=T.apiCalls)==null?void 0:a.value)||[]}),m=M(()=>e.apiCalls||u.value);ue(m,(a,I)=>{const N=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${(I==null?void 0:I.length)||0} to ${a.length} calls`),setTimeout(()=>{const k=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(k-N).toFixed(1)}ms`)},0)});const S=a=>{if(!r.value)return a;const I=r.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N=new RegExp(`(${I})`,"gi");return a.replace(N,"<mark>$1</mark>")},$=M(()=>{const a=performance.now();let I=[...m.value];if(t.value!=="all"&&(I=I.filter(k=>k.status===t.value)),l.value.length>0&&(I=I.filter(k=>l.value.includes(String(k.configurationIndex)))),r.value){const k=r.value.toLowerCase();I=I.filter(j=>{var te,R,ae,pe,ye;return!!((te=j.prompt)!=null&&te.toLowerCase().includes(k)||(ae=(R=j.result)==null?void 0:R.content)!=null&&ae.toLowerCase().includes(k)||(ye=(pe=j.result)==null?void 0:pe.error)!=null&&ye.toLowerCase().includes(k))})}const N=performance.now();return g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${I.length} calls in ${(N-a).toFixed(1)}ms`),I});ue($,(a,I)=>{const N=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${(I==null?void 0:I.length)||0} to ${a.length} items`),setTimeout(()=>{const k=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(k-N).toFixed(1)}ms`)},0)});const h=M(()=>m.value),y=M(()=>m.value.length),_=M(()=>e.trial.configurations.some(a=>a.repeatCount>1)),v=M(()=>60);function C(a){}function x(a){var N;const I=e.trial.configurations[a];return I?((N=I.modelSnapshot)==null?void 0:N.displayName)||`${I.modelId}`:`Config ${a+1}`}function V(a){var I,N,k,j,te;return a.status==="pending"?"Waiting...":a.status==="running"?"Processing...":a.status==="failed"?((I=a.result)==null?void 0:I.errorType)==="refusal_detected"||((N=a.result)==null?void 0:N.error)==="REFUSED"?((k=a.result)==null?void 0:k.content)||"REFUSED":((j=a.result)==null?void 0:j.error)||"Error occurred":((te=a.result)==null?void 0:te.content)||""}function b(a){if(!a.result)return"";if(a.result.parsedContent!==void 0){const I=a.result.parsedContent;return I===null?"null":typeof I=="string"?I:typeof I=="number"||typeof I=="boolean"?String(I):JSON.stringify(I)}return""}function E(a){var k;const I=((k=a.result)==null?void 0:k.content)||"";if(!I)return"";const N=I.length;return N>1e3?`${(N/1e3).toFixed(1)}k chars`:`${N} chars`}function f(a){return a?a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`:""}function d(a){let I;switch(a.status){case"completed":case"failed":I=a.completed;break;case"running":I=a.started;break;case"pending":case"cancelled":I=a.created;break}if(!I)return"";const N=new Date(I),k=N.getHours().toString().padStart(2,"0"),j=N.getMinutes().toString().padStart(2,"0"),te=N.getSeconds().toString().padStart(2,"0");return`Â Â ${k}:${j}:${te}`}function L(a){return a?a<1e3?"latency-fast":a<5e3?"latency-medium":"latency-slow":""}function G(a){return S(a)}function U(a){c.value=a}return ue(i,a=>{localStorage.setItem(gt,JSON.stringify(a))},{deep:!0}),ve(()=>{const a=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${m.value.length} calls`);const I=localStorage.getItem(gt);if(I)try{i.value=JSON.parse(I)}catch{}Te(()=>{const N=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(N-a).toFixed(1)}ms`),setTimeout(()=>{const k=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(k-a).toFixed(1)}ms`)},100)}),setTimeout(()=>{const N=performance.now();g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(N-a).toFixed(1)}ms`)},0)}),Ie(()=>{g.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${m.value.length} calls`)}),Re(()=>{g.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),he(()=>{g.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(a,I)=>{const N=yt("dompurify-html");return o(),p("div",Xl,[A(qn,{"status-filter":t.value,"onUpdate:statusFilter":I[0]||(I[0]=k=>t.value=k),"config-filter":l.value,"onUpdate:configFilter":I[1]||(I[1]=k=>l.value=k),"search-query":r.value,"onUpdate:searchQuery":I[2]||(I[2]=k=>r.value=k),"visible-columns":i.value,"onUpdate:visibleColumns":I[3]||(I[3]=k=>i.value=k),configurations:a.trial.configurations,"api-calls":h.value,"show-repeat-column":_.value},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),s("div",Zl,[y.value>100?(o(),J(H(Ue),{key:0,class:"results-scroller",items:$.value,"item-size":v.value,"key-field":"id",buffer:10,onVisibleRange:C},{before:F(()=>[s("table",eo,[s("thead",null,[s("tr",null,[i.value.includes("status")?(o(),p("th",to,"Status")):O("",!0),i.value.includes("configuration")?(o(),p("th",so,"Configuration")):O("",!0),i.value.includes("repeat")&&_.value?(o(),p("th",ao,"Repeat")):O("",!0),i.value.includes("variables")?(o(),p("th",no,"Variables")):O("",!0),i.value.includes("response")?(o(),p("th",lo,"Response")):O("",!0),i.value.includes("parsedResponse")?(o(),p("th",oo,"Parsed Response")):O("",!0),i.value.includes("length")?(o(),p("th",io,"Length")):O("",!0),i.value.includes("latency")?(o(),p("th",ro,"Latency")):O("",!0)])])])]),default:F(({item:k})=>{var j,te;return[s("table",uo,[s("tbody",null,[s("tr",{class:ee(["result-row",`status-${k.status}`]),onClick:R=>U(k)},[i.value.includes("status")?(o(),p("td",po,[s("div",fo,[s("span",{class:ee(["status-tag",`status-${k.status}`])},w(k.status.toUpperCase()),3),s("span",mo,w(d(k)),1)])])):O("",!0),i.value.includes("configuration")?(o(),p("td",vo,w(x(k.configurationIndex)),1)):O("",!0),i.value.includes("repeat")&&_.value?(o(),p("td",go," #"+w((k.repeatIndex||0)+1),1)):O("",!0),i.value.includes("variables")?(o(),p("td",ho,[s("div",bo,[(o(!0),p(X,null,se(Object.entries(k.variables),([R,ae],pe)=>(o(),p(X,{key:R},[I[6]||(I[6]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(k.variables).length<=2?(o(),p("span",yo,w(R)+": "+w(ae),1)):(o(),p("span",_o,w(ae),1)),Object.keys(k.variables).length===2&&pe===0?(o(),p("span",To,I[5]||(I[5]=[s("br",null,null,-1)]))):pe<Object.keys(k.variables).length-1?(o(),p("span",$o,w("Â Â "))):O("",!0)],64))),128))])])):O("",!0),i.value.includes("response")?(o(),p("td",Co,[Ce(s("div",ko,null,512),[[N,G(V(k)),"apiResponse"]])])):O("",!0),i.value.includes("parsedResponse")?(o(),p("td",So,w(b(k)),1)):O("",!0),i.value.includes("length")?(o(),p("td",wo,w(E(k)),1)):O("",!0),i.value.includes("latency")?(o(),p("td",Io,[s("span",{class:ee(L((j=k.response)==null?void 0:j.latencyMs))},w(f((te=k.response)==null?void 0:te.latencyMs)),3)])):O("",!0)],10,co)])])]}),_:1},8,["items","item-size"])):(o(),p("table",Ro,[s("thead",null,[s("tr",null,[i.value.includes("status")?(o(),p("th",Eo,"Status")):O("",!0),i.value.includes("configuration")?(o(),p("th",Vo,"Configuration")):O("",!0),i.value.includes("repeat")&&_.value?(o(),p("th",Ao,"Repeat")):O("",!0),i.value.includes("variables")?(o(),p("th",Oo,"Variables")):O("",!0),i.value.includes("response")?(o(),p("th",Lo,"Response")):O("",!0),i.value.includes("parsedResponse")?(o(),p("th",Fo,"Parsed Response")):O("",!0),i.value.includes("length")?(o(),p("th",Po,"Length")):O("",!0),i.value.includes("latency")?(o(),p("th",Mo,"Latency")):O("",!0)])]),s("tbody",null,[(o(!0),p(X,null,se($.value,k=>{var j,te;return o(),p("tr",{key:k.id,class:ee(["result-row",`status-${k.status}`]),onClick:R=>U(k)},[i.value.includes("status")?(o(),p("td",xo,[s("div",Uo,[s("span",{class:ee(["status-tag",`status-${k.status}`])},w(k.status.toUpperCase()),3),s("span",No,w(d(k)),1)])])):O("",!0),i.value.includes("configuration")?(o(),p("td",Wo,w(x(k.configurationIndex)),1)):O("",!0),i.value.includes("repeat")&&_.value?(o(),p("td",Ho," #"+w((k.repeatIndex||0)+1),1)):O("",!0),i.value.includes("variables")?(o(),p("td",zo,[s("div",Bo,[(o(!0),p(X,null,se(k.variables,(R,ae,pe)=>(o(),p(X,{key:ae},[I[8]||(I[8]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(k.variables).length<=2?(o(),p("span",Go,w(ae)+": "+w(R),1)):(o(),p("span",jo,w(R),1)),Object.keys(k.variables).length===2&&pe===0?(o(),p("span",qo,I[7]||(I[7]=[s("br",null,null,-1)]))):pe<Object.keys(k.variables).length-1?(o(),p("span",Ko,w("Â Â "))):O("",!0)],64))),128))])])):O("",!0),i.value.includes("response")?(o(),p("td",Qo,[Ce(s("div",Yo,null,512),[[N,G(V(k)),"apiResponse"]])])):O("",!0),i.value.includes("parsedResponse")?(o(),p("td",Jo,w(b(k)),1)):O("",!0),i.value.includes("length")?(o(),p("td",Xo,w(E(k)),1)):O("",!0),i.value.includes("latency")?(o(),p("td",Zo,[s("span",{class:ee(L((j=k.response)==null?void 0:j.latencyMs))},w(f((te=k.response)==null?void 0:te.latencyMs)),3)])):O("",!0)],10,Do)}),128)),$.value.length===0?(o(),p("tr",ei,[s("td",{colspan:i.value.length,class:"empty-state"},[u.value.length===0?(o(),p("div",si," No API calls yet. Start the trial to begin execution. ")):(o(),p("div",ai," No results match your filters. "))],8,ti)])):O("",!0)])]))]),c.value?(o(),J(Yl,{key:0,visible:!!c.value,"api-call":c.value,trial:a.trial,"onUpdate:visible":I[4]||(I[4]=k=>c.value=null)},null,8,["visible","api-call","trial"])):O("",!0)])}}}),li=re(ni,[["__scopeId","data-v-95899931"]]),oi={class:"trial-analysis-view"},ii=ie({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(n){const e=n;return ve(()=>{const t=performance.now();g.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${e.trial.id}`),Te(()=>{const l=performance.now();g.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(l-t).toFixed(1)}ms`)}),setTimeout(()=>{const l=performance.now();g.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(l-t).toFixed(1)}ms`)},0)}),Ie(()=>{g.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Re(()=>{g.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${e.trial.id}`)}),he(()=>{g.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(t,l)=>(o(),p("div",oi,[A(li,{trial:t.trial,progress:t.progress,"is-executing":t.isExecuting,"api-calls":t.apiCalls,"is-streaming":t.isStreaming,"is-loading":t.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),ri=re(ii,[["__scopeId","data-v-602f5d5a"]]);function ui(n,e){const t=new Set,l=new Set,r=new Set;n.forEach(S=>{S.variables&&Object.keys(S.variables).forEach($=>t.add($)),S.variableAttributes&&Object.values(S.variableAttributes).forEach($=>{$&&Object.keys($).forEach(h=>l.add(h))})});const i=Array.from(t).sort(),c=Array.from(l).sort(),T=Array.from(r).sort(),u=[],m=["success","refused","parsed_response",...u,...T];return{categorical:[...i,...c,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...u].sort(),extracted:m}}function we(n,e,t){var l,r,i,c,T,u,m,S,$,h,y,_,v,C,x,V,b,E,f,d,L;switch(e){case"model":return t&&n.configurationIndex<t.configurations.length&&t.configurations[n.configurationIndex].modelId||"Unknown";case"status":return n.status;case"response_time":return((l=n.response)==null?void 0:l.latencyMs)||0;case"total_tokens":if((i=(r=n.response)==null?void 0:r.body)!=null&&i.usage){const G=n.response.body.usage;return G.total_tokens||G.prompt_tokens+G.completion_tokens||0}return 0;case"prompt_tokens":return((u=(T=(c=n.response)==null?void 0:c.body)==null?void 0:T.usage)==null?void 0:u.prompt_tokens)||(($=(S=(m=n.response)==null?void 0:m.body)==null?void 0:S.usage)==null?void 0:$.input_tokens)||0;case"completion_tokens":return((_=(y=(h=n.response)==null?void 0:h.body)==null?void 0:y.usage)==null?void 0:_.completion_tokens)||((x=(C=(v=n.response)==null?void 0:v.body)==null?void 0:C.usage)==null?void 0:x.output_tokens)||0;case"error_type":return((V=n.result)==null?void 0:V.errorType)||(((b=n.result)==null?void 0:b.success)===!1?"api_error":"success");case"success":return(E=n.result)!=null&&E.success?1:0;case"refused":return(f=n.result)!=null&&f.refused?1:0;case"parsed_response":if(((d=n.result)==null?void 0:d.parsedContent)!==void 0){const G=n.result.parsedContent;return typeof G=="object"?JSON.stringify(G):G}return null}if(((L=n.variables)==null?void 0:L[e])!==void 0)return n.variables[e];if(n.variableAttributes)for(const G of Object.keys(n.variableAttributes)){const U=n.variableAttributes[G];if(U&&U[e]!==void 0)return U[e]}return null}const Ee={count:{label:"Count",calculate:n=>n.length,format:n=>n.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},mean:{label:"Mean",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0)/e.length:null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},median:{label:"Median",calculate:n=>{const e=n.map(r=>typeof r=="number"?r:null).filter(r=>r!==null);if(e.length===0)return null;const t=[...e].sort((r,i)=>r-i),l=Math.floor(t.length/2);return t.length%2===0?(t[l-1]+t[l])/2:t[l]},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},mode:{label:"Mode",calculate:n=>{if(n.length===0)return null;const e=new Map;n.forEach(r=>e.set(r,(e.get(r)||0)+1));let t=0,l=null;return e.forEach((r,i)=>{r>t&&(t=r,l=i)}),{value:l,count:t,total:n.length}},format:n=>n?`${n.value} (${n.count}/${n.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:n=>{const e=n.map(r=>typeof r=="number"?r:null).filter(r=>r!==null);if(e.length<=1)return null;const t=e.reduce((r,i)=>r+i,0)/e.length;return e.reduce((r,i)=>r+Math.pow(i-t,2),0)/(e.length-1)},format:n=>(n==null?void 0:n.toFixed(3))||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:n=>{const e=Ee.variance.calculate(n);return e!==null?Math.sqrt(e):null},format:n=>(n==null?void 0:n.toFixed(3))||"-",needsNumeric:!0},min:{label:"Min",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.min(...e):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},max:{label:"Max",calculate:n=>{const e=n.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.max(...e):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(n,e)=>{const t=e.filter(l=>{var r;return(r=l.result)==null?void 0:r.success}).length;return e.length>0?t/e.length:0},format:n=>`${Math.round(n*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(n,e)=>{const t=e.filter(l=>{var r;return(r=l.result)==null?void 0:r.refused}).length;return e.length>0?t/e.length:0},format:n=>`${Math.round(n*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(n,e)=>{const t=e.filter(l=>{var r;return(r=l.response)==null?void 0:r.latencyMs}).map(l=>l.response.latencyMs);return t.length>0?t.reduce((l,r)=>l+r,0)/t.length:null},format:n=>n?`${Math.round(n)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function ht(n,e,t){const l=new Map,r=new Set,i=new Set;n.forEach(_=>{const v=String(we(_,e.rowField,t)||"Unknown"),C=String(we(_,e.columnField,t)||"Unknown");r.add(v),i.add(C),l.has(v)||l.set(v,new Map),l.get(v).has(C)||l.get(v).set(C,[]),l.get(v).get(C).push(_)});const c=_=>_.every(C=>!isNaN(Number(C))&&C.trim()!=="")?_.sort((C,x)=>Number(C)-Number(x)):_.sort(),T=(_,v)=>(t&&(t.type,t.type),c(_)),u=e.rowSort==="original"?T(Array.from(r),e.rowField):c(Array.from(r)),m=e.columnSort==="original"?T(Array.from(i),e.columnField):c(Array.from(i)),S=Ee[e.aggregation];function $(_){const v=_.map(b=>we(b,e.valueField,t));if(!S||typeof S.calculate!="function")return g.error("Invalid aggregation function:",e.aggregation,S),{value:null,count:_.length,apiCalls:_,rawValues:v,error:"Invalid aggregation function"};const C={nonNumeric:0,nullUndefined:0};return S.needsNumeric&&(C.nonNumeric=v.filter(b=>typeof b!="number").length),C.nullUndefined=v.filter(b=>b==null).length,{value:S.usesApiCalls?S.calculate(v,_):S.calculate(v),count:_.length,apiCalls:_,rawValues:v,excludedCounts:C}}const h=u.map(_=>{const v=[],C=[];return m.forEach(x=>{var b;const V=((b=l.get(_))==null?void 0:b.get(x))||[];v.push(V.length>0?$(V):null),C.push(...V)}),{label:_,cells:v,total:$(C)}}),y=m.map(_=>{const v=[];return u.forEach(C=>{var V;const x=((V=l.get(C))==null?void 0:V.get(_))||[];v.push(...x)}),$(v)});return{rows:h,columns:m,totals:y,grandTotal:$(n)}}function be(n,e){return!n||n.value===null?"-":Ee[e].format(n.value)}function di(n,e,t,l=q({}),r={}){const{debounceMs:i=100}=r,c=q({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),T=q({categorical:[],numeric:[],extracted:[]}),u=q(!1),m=q(0),S=M(()=>{const _=l.value;return Object.values(_).some(C=>C!=="")?n.value.filter(C=>{var x;if(_.model&&_.model!==""&&(!t.value||C.configurationIndex>=t.value.configurations.length||(t.value.configurations[C.configurationIndex].modelId||"Unknown")!==_.model)||_.status&&_.status!==""&&C.status!==_.status)return!1;for(const[V,b]of Object.entries(_))if(b&&b!==""&&V!=="model"&&V!=="status"&&((x=C.variables)==null?void 0:x[V])!==b)return!1;return!0}):n.value}),$=ze(()=>{if(S.value.length===0){c.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}u.value=!0;const _=performance.now();try{c.value=ht(S.value,e.value,t.value);const v=performance.now()-_;m.value=v,g.debug("Pivot data computed (config change)",{apiCallCount:S.value.length,computeTimeMs:v,rowCount:c.value.rows.length,columnCount:c.value.columns.length})}catch(v){g.error("Error computing pivot data",v)}finally{u.value=!1}},i),h=ze(()=>{if(S.value.length===0){c.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}u.value=!0;const _=performance.now();try{c.value=ht(S.value,e.value,t.value);const v=performance.now()-_;m.value=v,g.debug("Pivot data computed (stream update)",{apiCallCount:S.value.length,computeTimeMs:v,rowCount:c.value.rows.length,columnCount:c.value.columns.length})}catch(v){g.error("Error computing pivot data",v)}finally{u.value=!1}},1e3),y=ze(()=>{T.value=ui(n.value,t.value)},200);return ue([e],()=>{h.cancel(),$()},{deep:!0}),ue(()=>S.value,(_,v)=>{g.info(`PIVOT_DEBUG: filteredApiCalls changed from ${(v==null?void 0:v.length)||0} to ${_.length}`),h()},{immediate:!1}),ue(()=>[n.value,t.value],()=>{g.info("PIVOT_DEBUG: apiCalls or trial changed, updating fields"),y(),h()},{immediate:!1}),y(),$(),{pivotData:M(()=>c.value),availableFields:M(()=>T.value),isComputing:M(()=>u.value),lastComputeTime:M(()=>m.value),formatCellValue:be,extractFieldValue:we,aggregationFunctions:Ee}}const ci={class:"pivot-config-v3"},pi={class:"config-row"},fi={class:"config-group"},mi=["value","aria-label"],vi={label:"Categorical"},gi=["value"],hi={class:"config-group sort-group"},bi=["value","aria-label"],yi={class:"config-group"},_i=["value","aria-label"],Ti={label:"Categorical"},$i=["value"],Ci={class:"config-group sort-group"},ki=["value","aria-label"],Si={class:"config-group"},wi=["value","aria-label"],Ii={label:"Extracted Values"},Ri=["value"],Ei={label:"Numeric Fields"},Vi=["value"],Ai={class:"config-group"},Oi=["value","aria-label"],Li=ie({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(n,{emit:e}){const t=e;function l(i,c){t("update-config",i,c)}function r(i){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[i]||i.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase())}return(i,c)=>(o(),p("div",ci,[s("div",pi,[s("div",fi,[c[6]||(c[6]=s("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),s("select",{id:"pivot-row-field",value:i.config.rowField,"aria-label":"Group rows by "+r(i.config.rowField),onChange:c[0]||(c[0]=T=>l("rowField",T.target.value))},[s("optgroup",vi,[(o(!0),p(X,null,se(i.availableFields.categorical,T=>(o(),p("option",{key:T,value:T},w(r(T)),9,gi))),128))])],40,mi)]),s("div",hi,[c[8]||(c[8]=s("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),s("select",{id:"pivot-row-sort",value:i.config.rowSort||"original","aria-label":"Sort rows by "+(i.config.rowSort||"original")+" order",onChange:c[1]||(c[1]=T=>l("rowSort",T.target.value))},c[7]||(c[7]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,bi)]),s("div",yi,[c[9]||(c[9]=s("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),s("select",{id:"pivot-column-field",value:i.config.columnField,"aria-label":"Group columns by "+r(i.config.columnField),onChange:c[2]||(c[2]=T=>l("columnField",T.target.value))},[s("optgroup",Ti,[(o(!0),p(X,null,se(i.availableFields.categorical,T=>(o(),p("option",{key:T,value:T},w(r(T)),9,$i))),128))])],40,_i)]),s("div",Ci,[c[11]||(c[11]=s("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),s("select",{id:"pivot-column-sort",value:i.config.columnSort||"original","aria-label":"Sort columns by "+(i.config.columnSort||"original")+" order",onChange:c[3]||(c[3]=T=>l("columnSort",T.target.value))},c[10]||(c[10]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,ki)]),s("div",Si,[c[12]||(c[12]=s("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),s("select",{id:"pivot-value-field",value:i.config.valueField,"aria-label":"Aggregate "+i.config.valueField+" values",onChange:c[4]||(c[4]=T=>l("valueField",T.target.value))},[s("optgroup",Ii,[(o(!0),p(X,null,se(i.availableFields.extracted,T=>(o(),p("option",{key:T,value:T},w(T),9,Ri))),128))]),s("optgroup",Ei,[(o(!0),p(X,null,se(i.availableFields.numeric,T=>(o(),p("option",{key:T,value:T},w(r(T)),9,Vi))),128))])],40,wi)]),s("div",Ai,[c[14]||(c[14]=s("label",{for:"pivot-aggregation"},"Aggregation:",-1)),s("select",{id:"pivot-aggregation",value:i.config.aggregation,"aria-label":"Aggregation method: "+i.config.aggregation,onChange:c[5]||(c[5]=T=>l("aggregation",T.target.value))},c[13]||(c[13]=[kt('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,Oi)])])]))}}),Fi=re(Li,[["__scopeId","data-v-0d3a0d50"]]),Pi={class:"heatmap-controls-v3"},Mi={class:"color-scale-selector"},Di=["value","aria-label"],xi={class:"gradient-mode-selector"},Ui={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},Ni=["aria-pressed"],Wi=["aria-pressed"],Hi=["aria-pressed"],zi=["title","aria-label"],Bi=ie({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(n,{emit:e}){const t=e;function l(i){const c=i.target.value;t("update-color-scale",c)}function r(i){t("update-gradient-mode",i)}return(i,c)=>(o(),p("div",Pi,[s("div",Mi,[c[5]||(c[5]=s("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),s("select",{id:"heatmap-color-scale",value:i.selectedColorScale,"aria-label":"Color scale: "+i.selectedColorScale,onChange:l},c[4]||(c[4]=[kt('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,Di)]),s("div",xi,[c[6]||(c[6]=s("label",null,"Gradient Mode:",-1)),s("div",Ui,[s("button",{type:"button",class:ee(["toggle-btn",{active:i.gradientMode==="global"}]),"aria-pressed":i.gradientMode==="global",onClick:c[0]||(c[0]=T=>r("global"))}," Global ",10,Ni),s("button",{type:"button",class:ee(["toggle-btn",{active:i.gradientMode==="column"}]),"aria-pressed":i.gradientMode==="column",onClick:c[1]||(c[1]=T=>r("column"))}," Per Column ",10,Wi),s("button",{type:"button",class:ee(["toggle-btn",{active:i.gradientMode==="row"}]),"aria-pressed":i.gradientMode==="row",onClick:c[2]||(c[2]=T=>r("row"))}," Per Row ",10,Hi)])]),s("button",{type:"button",class:"fullscreen-btn",title:i.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":i.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:c[3]||(c[3]=T=>i.$emit("toggle-fullscreen"))},w(i.isFullscreen?"âŠŸ":"âŠž"),9,zi)]))}}),Gi=re(Bi,[["__scopeId","data-v-dcb6369b"]]),ji={class:"pivot-filters-v3"},qi={class:"filters-row"},Ki={key:0,class:"filter-group"},Qi=["value"],Yi=["value"],Ji=["for"],Xi=["id","value","aria-label","onChange"],Zi={value:""},er=["value"],tr={key:1,class:"filter-group"},sr=["value"],ar=["value"],nr=ie({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(n,{emit:e}){const t=n,l=e,r=q({});let i=0;const c=()=>{if(t.apiCalls.length===0){r.value={};return}const $={};t.apiCalls.forEach(y=>{if(t.trial&&y.configurationIndex<t.trial.configurations.length){const v=t.trial.configurations[y.configurationIndex].modelId||"Unknown";$.model||($.model=new Set),$.model.add(v)}y.status&&($.status||($.status=new Set),$.status.add(y.status)),y.variables&&Object.entries(y.variables).forEach(([_,v])=>{v&&String(v).trim()&&($[_]||($[_]=new Set),$[_].add(String(v)))})});const h={};Object.entries($).forEach(([y,_])=>{h[y]=Array.from(_).sort()}),r.value=h};ue(()=>t.apiCalls.length,$=>{($===0||i===0||$-i>=5)&&(c(),i=$)},{immediate:!0});const T=M(()=>{const{model:$,status:h,...y}=r.value;return y}),u=M(()=>Object.values(t.activeFilters).some($=>$!==""));function m($){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[$]||$.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase())}function S($,h){const y={...t.activeFilters};h===""?delete y[$]:y[$]=h,l("update-filters",y)}return($,h)=>(o(),p("div",ji,[s("div",qi,[r.value.model&&r.value.model.length>1?(o(),p("div",Ki,[h[4]||(h[4]=s("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),s("select",{id:"filter-model",value:$.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:h[0]||(h[0]=y=>S("model",y.target.value))},[h[3]||(h[3]=s("option",{value:""},"All Models",-1)),(o(!0),p(X,null,se(r.value.model,y=>(o(),p("option",{key:y,value:y},w(y),9,Yi))),128))],40,Qi)])):O("",!0),(o(!0),p(X,null,se(T.value,(y,_)=>(o(),p("div",{key:_,class:"filter-group"},[s("label",{for:`filter-${_}`,class:"filter-label"},w(m(String(_)))+": ",9,Ji),s("select",{id:`filter-${_}`,value:$.activeFilters[_]||"",class:"filter-select","aria-label":`Filter by ${m(String(_))}`,onChange:v=>S(String(_),v.target.value)},[s("option",Zi,"All "+w(m(String(_))),1),(o(!0),p(X,null,se(y,v=>(o(),p("option",{key:v,value:v},w(v),9,er))),128))],40,Xi)]))),128)),r.value.status&&r.value.status.length>1?(o(),p("div",tr,[h[6]||(h[6]=s("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),s("select",{id:"filter-status",value:$.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:h[1]||(h[1]=y=>S("status",y.target.value))},[h[5]||(h[5]=s("option",{value:""},"All Statuses",-1)),(o(!0),p(X,null,se(r.value.status,y=>(o(),p("option",{key:y,value:y},w(y),9,ar))),128))],40,sr)])):O("",!0),u.value?(o(),p("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:h[2]||(h[2]=y=>$.$emit("clear-filters"))}," Clear Filters ")):O("",!0)])]))}}),lr=re(nr,[["__scopeId","data-v-99c57ee0"]]),or={class:"collapse-icon"},ir={class:"options-content"},rr={class:"controls-row"},ur={key:0,class:"performance-info"},dr={class:"table-view"},cr={key:0,class:"empty-state","data-testid":"empty-data-message"},pr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},fr={key:2,class:"loading-state","data-testid":"computing-state"},mr={key:3,class:"pivot-table-container"},vr={class:"pivot-table-grid responsive-table",role:"table"},gr={role:"row"},hr={class:"corner-cell",role:"columnheader"},br={key:0,class:"total-header",role:"columnheader"},yr={class:"row-header",role:"rowheader"},_r=["data-testid","title","aria-label","role","onClick","onKeydown"],Tr={key:0,class:"cell-content"},$r=["title"],Cr={class:"cell-value"},kr={class:"error-message"},Sr={key:1},wr=ie({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(n,{emit:e}){var R,ae,pe,ye,ke,Ve;const t=n,l=e,r=q(!1),i=q("viridis"),c=q("global"),T=q(!1),u=q({rowField:((R=t.config)==null?void 0:R.rowField)||"",columnField:((ae=t.config)==null?void 0:ae.columnField)||"",valueField:((pe=t.config)==null?void 0:pe.valueField)||"",aggregation:((ye=t.config)==null?void 0:ye.aggregation)||"mean",rowSort:((ke=t.config)==null?void 0:ke.rowSort)||"original",columnSort:((Ve=t.config)==null?void 0:Ve.columnSort)||"original"});ue(()=>t.config,z=>{z&&Object.assign(u.value,z)},{deep:!0});const m=q({}),S=Ne(),$=M(()=>S.apiCalls?S.apiCalls.value||[]:t.apiCalls||[]),h=$,y=M(()=>t.trial),{pivotData:_,availableFields:v,isComputing:C,lastComputeTime:x}=di(h,u,y,m,{debounceMs:750});ue(_,(z,K)=>{var fe,Ae;const B=performance.now(),Q=((fe=z==null?void 0:z.rows)==null?void 0:fe.length)||0,de=((Ae=z==null?void 0:z.columns)==null?void 0:Ae.length)||0;g.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${Q}x${de} matrix`),setTimeout(()=>{const We=performance.now();g.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(We-B).toFixed(1)}ms`)},0)}),ue(C,z=>{z?g.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${$.value.length} API calls`):g.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${x.value.toFixed(1)}ms`)}),ue($,(z,K)=>{const B=performance.now();g.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${(K==null?void 0:K.length)||0} to ${z.length} calls`),setTimeout(()=>{const Q=performance.now();g.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(Q-B).toFixed(1)}ms`)},0)});const V=M(()=>_.value.rows.slice(0,t.maxTableRows)),b=M(()=>Object.values(m.value).some(K=>K!=="")?$.value.filter(K=>{var B;if(m.value.model&&m.value.model!==""&&(!t.trial||K.configurationIndex>=t.trial.configurations.length||(t.trial.configurations[K.configurationIndex].modelId||"Unknown")!==m.value.model)||m.value.status&&m.value.status!==""&&K.status!==m.value.status)return!1;for(const[Q,de]of Object.entries(m.value))if(de&&de!==""&&Q!=="model"&&Q!=="status"&&((B=K.variables)==null?void 0:B[Q])!==de)return!1;return!0}).length:$.value.length),{getCellStyle:E,getSummaryStyle:f,styleKey:d}=hs(_,i,c);function L(z){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[z]||z.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase())}function G(z,K,B){if(!B)return`${z} Ã— ${K}: No data`;const Q=be(B,u.value.aggregation);let de=`${z} Ã— ${K}: ${Q} (${B.count} calls)`;if(B.excludedCounts){const fe=[];B.excludedCounts.nonNumeric>0&&fe.push(`${B.excludedCounts.nonNumeric} non-numeric responses excluded`),B.excludedCounts.nullUndefined>0&&fe.push(`${B.excludedCounts.nullUndefined} null/empty responses`),fe.length>0&&(de+=` | ${fe.join(", ")}`)}return B.error&&(de+=` - ERROR: ${B.error}`),de}function U(z,K,B){if(!B)return`${z} by ${K}: No data`;const Q=be(B,u.value.aggregation);return B.error?`${z} by ${K}: ${Q} with data integrity error: ${B.error}`:`${z} by ${K}: ${Q} from ${B.count} API calls`}function a(z,K){(z==="rowField"||z==="columnField"||z==="valueField"||z==="aggregation"||z==="rowSort"||z==="columnSort")&&(u.value[z]=K),l("config-change",{...u.value})}function I(z){m.value={...z}}function N(){m.value={}}function k(z,K,B){B&&l("cell-click",{row:z,column:K,cell:B})}function j(){T.value=!T.value}function te(){r.value=!r.value,r.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return ve(()=>{var K;const z=performance.now();g.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${((K=t.trial)==null?void 0:K.id)||"unknown"} with ${$.value.length} calls`),Te(()=>{const B=performance.now();g.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(B-z).toFixed(1)}ms`)}),setTimeout(()=>{const B=performance.now();g.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(B-z).toFixed(1)}ms`)},0)}),Ie(()=>{var z;g.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${((z=t.trial)==null?void 0:z.id)||"unknown"} with ${$.value.length} calls`)}),Re(()=>{var z;g.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${((z=t.trial)==null?void 0:z.id)||"unknown"}`)}),he(()=>{var z;g.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${((z=t.trial)==null?void 0:z.id)||"unknown"}`),r.value&&(document.body.style.overflow="")}),ue([v,$],([z])=>{if($.value.length>0&&(!u.value.rowField||u.value.rowField==="")&&z.categorical.length>0){if(u.value.rowField=z.categorical.find(K=>K!=="model"&&K!=="status"&&K!=="error_type")||z.categorical[0]||"model",u.value.columnField=u.value.columnField||"model",u.value.valueField=u.value.valueField||"parsed_response",!u.value.aggregation||u.value.aggregation===""){const K=$.value.slice(0,3).map(Q=>we(Q,u.value.valueField,t.trial)).filter(Q=>Q!=null),B=K.length>0&&K.every(Q=>typeof Q=="number");u.value.aggregation=B?"mean":"mode"}l("config-change",{...u.value})}},{immediate:!0}),(z,K)=>(o(),p("div",{class:ee(["pivot-table-v3",{fullscreen:r.value}])},[s("div",{class:ee(["pivot-options-container",{collapsed:T.value}])},[s("div",{class:"options-header",onClick:j},[K[3]||(K[3]=s("span",{class:"options-title"},"Pivot Table Options",-1)),s("span",or,w(T.value?"â–¶":"â–¼"),1)]),Ce(s("div",ir,[as([H(v),u.value],()=>(o(),p("div",null,[A(Fi,{config:u.value,"available-fields":H(v),onUpdateConfig:a},null,8,["config","available-fields"])])),K,0),s("div",rr,[$.value.length>0?(o(),J(lr,{key:0,"api-calls":$.value,trial:z.trial,"active-filters":m.value,onUpdateFilters:I,onClearFilters:N},null,8,["api-calls","trial","active-filters"])):O("",!0),A(Gi,{"selected-color-scale":i.value,"gradient-mode":c.value,"is-fullscreen":r.value,onUpdateColorScale:K[1]||(K[1]=B=>i.value=B),onUpdateGradientMode:K[2]||(K[2]=B=>c.value=B),onToggleFullscreen:te},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[St,!T.value]])],2),z.showPerformanceInfo?(o(),p("div",ur,[s("span",null,"Computing: "+w(H(C)?"Yes":"No"),1),s("span",null,"Last Compute: "+w(H(x).toFixed(1))+"ms",1),s("span",null,"API Calls: "+w($.value.length),1),s("span",null,"Filtered: "+w(b.value),1)])):O("",!0),s("div",dr,[$.value.length===0?(o(),p("div",cr,K[4]||(K[4]=[s("p",null,"No data available for pivot table analysis.",-1)]))):u.value.aggregation in H(Ee)?H(C)?(o(),p("div",fr,K[6]||(K[6]=[s("p",null,"Computing pivot table...",-1)]))):(o(),p("div",mr,[s("table",vr,[s("thead",null,[s("tr",gr,[s("th",hr,w(L(u.value.rowField)||"Items")+" / "+w(L(u.value.columnField)||"Aggregated"),1),(o(!0),p(X,null,se(H(_).columns,B=>(o(),p("th",{key:B,class:"column-header",role:"columnheader"},w(B),1))),128)),u.value.columnField&&z.showTotals?(o(),p("th",br," Total ")):O("",!0)])]),s("tbody",null,[(o(!0),p(X,null,se(V.value,B=>(o(),p("tr",{key:`${B.label}-${H(d)}`,class:"data-row",role:"row"},[s("td",yr,w(B.label),1),(o(!0),p(X,null,se(B.cells,(Q,de)=>(o(),p("td",{key:`${de}-${H(d)}`,class:ee(["data-cell",{"error-cell":Q==null?void 0:Q.error}]),"data-testid":Q!=null&&Q.error?"pivot-cell-error":"pivot-cell",style:ge(H(E)(Q,B.label,de)),title:G(B.label,H(_).columns[de],Q),"aria-label":U(B.label,H(_).columns[de],Q),role:Q!=null&&Q.error?"alert":"cell",tabindex:"0",onClick:fe=>k(B.label,H(_).columns[de],Q),onKeydown:[Ge(fe=>k(B.label,H(_).columns[de],Q),["enter"]),Ge(wt(fe=>k(B.label,H(_).columns[de],Q),["prevent"]),["space"])]},[Q!=null&&Q.error?(o(),p("div",Tr,[s("span",{class:"error-indicator",title:Q.error},"âš ï¸",8,$r),s("span",Cr,w(Q?H(be)(Q,u.value.aggregation):"-"),1),s("div",kr,w(Q.error),1)])):(o(),p("span",Sr,w(Q?H(be)(Q,u.value.aggregation):"-"),1))],46,_r))),128)),u.value.columnField&&z.showTotals?(o(),p("td",{key:0,class:"total-cell",style:ge(H(f)(B.total)),role:"cell"},w(H(be)(B.total,u.value.aggregation)),5)):O("",!0)]))),128)),u.value.rowField&&z.showTotals?(o(),p("tr",{key:`totals-${H(d)}`,class:"total-row",role:"row"},[K[7]||(K[7]=s("td",{class:"row-header",role:"rowheader"},"Total",-1)),(o(!0),p(X,null,se(H(_).totals,(B,Q)=>(o(),p("td",{key:`total-${Q}-${H(d)}`,class:"total-cell",style:ge(H(f)(B)),role:"cell"},w(H(be)(B,u.value.aggregation)),5))),128)),u.value.columnField?(o(),p("td",{key:0,class:"grand-total-cell",style:ge(H(f)(H(_).grandTotal)),role:"cell"},w(H(be)(H(_).grandTotal,u.value.aggregation)),5)):O("",!0)])):O("",!0)])])])):(o(),p("div",pr,[s("p",null,"Invalid aggregation function: "+w(u.value.aggregation),1),K[5]||(K[5]=s("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),Ir=re(wr,[["__scopeId","data-v-64ef72f7"]]),Rr={class:"modal-content"},Er={class:"modal-header"},Vr={class:"modal-title"},Ar={class:"summary-row"},Or={key:0},Lr={key:0,class:"filter-row"},Fr=["onUpdate:modelValue","aria-label"],Pr={value:""},Mr=["value"],Dr={class:"table-container"},xr={class:"api-calls-table"},Ur=["title"],Nr=["title"],Wr=ie({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(n){const e=n,t=ns({}),l=M(()=>{const b=new Set;return e.apiCalls.forEach(E=>{E.variables&&Object.keys(E.variables).forEach(f=>b.add(f)),E.attributedVariables&&Object.entries(E.attributedVariables).forEach(([f,d])=>{d&&typeof d=="object"&&Object.keys(d).forEach(L=>{b.add(`${f}.${L}`)})})}),Array.from(b).sort()}),r=M(()=>l.value.map(b=>({title:b,dataIndex:`var_${b}`,key:`var_${b}`,width:150}))),i=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],c=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],T=M(()=>[...i,...r.value,...c]),u=M(()=>`${e.row} Ã— ${e.column} - ${e.apiCalls.length} API Calls`),m=M(()=>e.apiCalls.map(b=>{var f,d;const E={id:b.id,status:b.status,model:b.model||"-",response:((f=b.result)==null?void 0:f.content)||((d=b.result)==null?void 0:d.error)||"-",extracted:b.extracted||"-",duration:b.duration?`${b.duration}ms`:"-",cost:b.cost||0};return l.value.forEach(L=>{var G,U,a;if(L.includes(".")){const[I,N]=L.split("."),k=(U=(G=b.attributedVariables)==null?void 0:G[I])==null?void 0:U[N];E[`var_${L}`]=k!==void 0?String(k):"-"}else E[`var_${L}`]=((a=b.variables)==null?void 0:a[L])||"-"}),E})),S=M(()=>Object.values(t).some(b=>b!==void 0&&b!=="")),$=M(()=>S.value?m.value.filter(b=>Object.entries(t).every(([E,f])=>f?b[E]===f:!0)):m.value),h=M(()=>{const b=e.apiCalls.filter(E=>E.status==="completed").length;return Math.round(b/e.apiCalls.length*100)}),y=M(()=>{const b=e.apiCalls.filter(E=>E.duration).map(E=>E.duration);return b.length===0?0:Math.round(b.reduce((E,f)=>E+f,0)/b.length)}),_=M(()=>e.apiCalls.filter(E=>E.cost).map(E=>E.cost).reduce((E,f)=>E+f,0));function v(b){switch(b){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function C(b,E){return b?b.length<=E?b:b.slice(0,E)+"...":""}function x(b){const E=new Set;return m.value.forEach(f=>{const d=f[b];d&&d!=="-"&&E.add(d)}),Array.from(E).sort()}function V(){Object.keys(t).forEach(b=>{delete t[b]})}return(b,E)=>(o(),p("div",{class:ee(["pivot-cell-detail-modal-v3",{visible:b.visible}]),onClick:E[1]||(E[1]=wt(f=>b.$emit("close"),["self"]))},[s("div",Rr,[s("div",Er,[s("h3",Vr,w(u.value),1),s("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:E[0]||(E[0]=f=>b.$emit("close"))}," Ã— ")]),s("div",Ar,[s("span",null,[E[2]||(E[2]=s("b",null,"Total:",-1)),W(" "+w(b.apiCalls.length),1)]),s("span",null,[E[3]||(E[3]=s("b",null,"Success Rate:",-1)),W(" "+w(h.value)+"%",1)]),s("span",null,[E[4]||(E[4]=s("b",null,"Avg Duration:",-1)),W(" "+w(y.value)+"ms",1)]),_.value>0?(o(),p("span",Or,[E[5]||(E[5]=s("b",null,"Total Cost:",-1)),W(" $"+w(_.value),1)])):O("",!0)]),r.value.length>0?(o(),p("div",Lr,[(o(!0),p(X,null,se(r.value,f=>(o(),p("div",{key:f.key,class:"variable-filter"},[Ce(s("select",{"onUpdate:modelValue":d=>t[f.key]=d,"aria-label":`Filter ${f.title}`,class:"filter-select"},[s("option",Pr,"All "+w(f.title),1),(o(!0),p(X,null,se(x(f.key),d=>(o(),p("option",{key:d,value:d},w(d),9,Mr))),128))],8,Fr),[[ls,t[f.key]]])]))),128)),S.value?(o(),p("button",{key:0,type:"button",class:"clear-filters-btn",onClick:V}," Clear Filters ")):O("",!0)])):O("",!0),s("div",Dr,[s("table",xr,[s("thead",null,[s("tr",null,[(o(!0),p(X,null,se(T.value,f=>(o(),p("th",{key:f.key,class:"table-header",style:ge({width:f.width?`${f.width}px`:"auto"})},w(f.title),5))),128))])]),s("tbody",null,[(o(!0),p(X,null,se($.value,f=>(o(),p("tr",{key:f.id,class:"table-row"},[(o(!0),p(X,null,se(T.value,d=>(o(),p("td",{key:d.key,class:ee(["table-cell",{"status-cell":d.key==="status"}])},[d.key==="status"?(o(),p("span",{key:0,class:ee(["status-tag",v(f.status)])},w(f.status),3)):d.key==="response"?(o(),p("span",{key:1,class:"response-cell",title:f.response},w(C(f.response,100)),9,Ur)):d.key==="cost"?(o(),p(X,{key:2},[W(w(f.cost===0?"-":`$${f.cost.toFixed(4)}`),1)],64)):d.key.startsWith("var_")?(o(),p("span",{key:3,class:"variable-cell",title:f[d.key]},w(f[d.key]||"-"),9,Nr)):(o(),p(X,{key:4},[W(w(f[d.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),Hr=re(Wr,[["__scopeId","data-v-2738b696"]]),zr={class:"trial-tab-content"},Br={class:"tab-pane-content"},Gr={class:"tab-pane-content"},jr={key:0,class:"no-data-message"},qr={class:"tab-pane-content"},bt="trial-details-active-tab",Kr=ie({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(n){const e=n,t=It(),l=et(),r=Ne(),i=M(()=>{var V;return((V=r.apiCalls)==null?void 0:V.value)||[]}),c=M(()=>{var V;return((V=r.isStreaming)==null?void 0:V.value)||!1});ue(i,(V,b)=>{const E=performance.now();g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${(b==null?void 0:b.length)||0} to ${V.length} calls`),setTimeout(()=>{const f=performance.now();g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(f-E).toFixed(1)}ms`)},0)});const T=M(()=>!1),m=q((()=>{const V=t.query.tab;return V==="status"?"details":V&&["details","tasks","pivot"].includes(V)?V:"tasks"})()),S=q(!1),$=q(!1),h=q({row:"",column:"",apiCalls:[],value:null}),y=M(()=>{var V,b;return((V=e.executionState)==null?void 0:V.status)==="executing"&&((b=e.executionState)==null?void 0:b.currentTrialId)===e.trial.id}),_=M(()=>e.trial.progress.completed>0);function v(){localStorage.setItem(bt,m.value);const V={...t.query};V.tab=m.value,t.query.tab!==m.value&&(l.replace({query:V}),g.info(`TAB_ROUTING: Updated URL tab parameter to '${m.value}'`))}function C(){const V=localStorage.getItem(bt);V==="status"?m.value="details":V&&["details","tasks","pivot"].includes(V)&&(m.value=V)}function x(V){!V.cell||!V.cell.apiCalls.length||(h.value={row:V.row,column:V.column,apiCalls:V.cell.apiCalls,value:V.cell.value},$.value=!0)}return ue(m,()=>{v()}),ue(()=>t.query.tab,V=>{if(V&&typeof V=="string"){let b=V==="status"?"details":V;["details","tasks","pivot"].includes(b)&&m.value!==b&&(m.value=b,g.info(`TAB_ROUTING: Synced tab to URL parameter '${b}'`))}}),ve(()=>{const V=performance.now();if(g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${e.trial.id}`),!t.query.tab){const b={...t.query};b.tab=m.value,l.replace({query:b}),g.info(`TAB_ROUTING: Set initial URL tab parameter to '${m.value}'`)}C(),setTimeout(()=>{const b=performance.now();g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(b-V).toFixed(1)}ms`)},0)}),Ie(()=>{g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Re(()=>{g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${e.trial.id}`)}),he(()=>{g.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(V,b)=>{const E=Z("a-tab-pane"),f=Z("a-tabs");return o(),p("div",zr,[A(f,{activeKey:m.value,"onUpdate:activeKey":b[1]||(b[1]=d=>m.value=d),type:"card",class:"trial-tabs"},{default:F(()=>[A(E,{key:"tasks",tab:"Task View"},{default:F(()=>[s("div",Br,[(o(),J(qe,null,[A(ri,{trial:V.trial,progress:V.progress,"is-executing":y.value,"api-calls":i.value,"is-streaming":c.value,"is-loading":T.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),A(E,{key:"pivot",tab:"Pivot Table"},{default:F(()=>[s("div",Gr,[(o(),J(qe,null,[_.value&&i.value.length>0?(o(),J(Ir,{key:0,"api-calls":i.value,trial:V.trial,"show-performance-info":!1,onCellClick:x},null,8,["api-calls","trial"])):O("",!0)],1024)),_.value&&i.value.length>0?O("",!0):(o(),p("div",jr,b[3]||(b[3]=[s("p",null,"No completed API calls available for pivot analysis.",-1),s("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),A(E,{key:"details",tab:"Details"},{default:F(()=>[s("div",qr,[A(zn,{trial:V.trial,"is-collapsed":S.value,onToggleCollapse:b[0]||(b[0]=d=>S.value=!S.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),$.value?(o(),J(Hr,{key:0,visible:$.value,row:h.value.row,column:h.value.column,"api-calls":h.value.apiCalls,trial:V.trial,value:h.value.value,onClose:b[2]||(b[2]=d=>$.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):O("",!0)])}}}),Qr=re(Kr,[["__scopeId","data-v-d2c24429"]]),Yr={class:"export-content"},Jr={class:"section"},Xr={class:"section"},Zr={class:"field-actions"},eu={class:"field-groups"},tu={class:"field-group"},su={class:"field-list"},au={class:"field-group"},nu={class:"field-list"},lu={class:"field-group"},ou={class:"field-list"},iu={class:"field-group"},ru={class:"field-list"},uu={class:"field-group"},du={class:"field-list"},cu={key:0,class:"field-group"},pu={class:"field-list"},fu={key:1,class:"field-group"},mu={class:"field-list"},vu={class:"section"},gu={class:"preview-info"},hu={class:"info-item"},bu={class:"value"},yu={class:"info-item"},_u={class:"value"},Tu={class:"info-item"},$u={class:"value"},Cu={class:"export-actions"},ku=ie({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(n,{emit:e}){const t=n,l=e,r=Ze(),i=q("csv"),c=q(["order","status","configuration","prompt","response","latency"]),T=q(!1),u=q({}),m=q([]),S=q([]),$=q([]),h=["order","status","configuration","prompt","response","latency"],y=q([]),_=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],v=M(()=>{var I,N;const U=((I=t.trial.progress)==null?void 0:I.completed)||0,a=((N=t.trial.progress)==null?void 0:N.failed)||0;return U+a}),C=M(()=>{const a=c.value.length*50*v.value;return a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`});function x(){g.info("EXPORT_DEBUG: ExportModal initializeFieldSelection with allFields",y.value.length),y.value.forEach(I=>{u.value[I]=!1}),h.forEach(I=>{u.value[I]=!0});const U=S.value.map(I=>I.id),a=$.value.map(I=>I.id);U.forEach(I=>{u.value[I]=!0}),a.forEach(I=>{u.value[I]=!0}),g.info("EXPORT_DEBUG: ExportModal default selection includes",{standardDefaults:h.length,parameterDefaults:U.length,variableDefaults:a.length,totalDefaults:h.length+U.length+a.length}),V()}function V(){c.value=y.value.filter(U=>u.value[U])}function b(U,a){u.value[U]=a,V()}function E(){y.value.forEach(U=>{u.value[U]=!0}),V()}function f(){y.value.forEach(I=>{u.value[I]=!1}),h.forEach(I=>{u.value[I]=!0});const U=S.value.map(I=>I.id),a=$.value.map(I=>I.id);U.forEach(I=>{u.value[I]=!0}),a.forEach(I=>{u.value[I]=!0}),V()}function d(){y.value.forEach(U=>{u.value[U]=!1}),V()}function L(){l("update:visible",!1)}async function G(){if(c.value.length===0){oe.warning("Please select at least one field to export");return}T.value=!0;try{const U={format:i.value,fields:c.value,includeHeaders:!0,addBOM:i.value==="excel"||i.value==="csv"},a=await r.dataExport.exportTrialData(t.trial.id,U);a.ok?(oe.success("Export completed successfully"),l("update:visible",!1)):oe.error(`Export failed: ${a.error.message}`)}catch(U){oe.error("Export failed: "+U.message)}finally{T.value=!1}}return ve(async()=>{g.info("EXPORT_DEBUG: ExportModal discovering available fields for trial",t.trial.id);const U=await r.dataExport.getAvailableFields(t.trial.id);if(U.ok){m.value=U.value.standardFields,S.value=U.value.parameterFields,$.value=U.value.variableFields||[];const a=U.value.standardFields.map(k=>k.id).filter(k=>k!=="parameters"&&k!=="variables"),I=U.value.parameterFields.map(k=>k.id),N=(U.value.variableFields||[]).map(k=>k.id);y.value=[...a,...I,...N],g.info("EXPORT_DEBUG: ExportModal discovered fields",{standardFields:U.value.standardFields.length,parameterFields:U.value.parameterFields.length,variableFields:(U.value.variableFields||[]).length,totalFields:y.value.length,parameterFieldNames:U.value.parameterFields.map(k=>k.id),variableFieldNames:(U.value.variableFields||[]).map(k=>k.id),allFieldNames:y.value})}else g.info("EXPORT_DEBUG: ExportModal field discovery failed",U.error),y.value=[..._];x()}),(U,a)=>{const I=Z("a-radio-button"),N=Z("a-radio-group"),k=Z("a-button"),j=Z("a-checkbox"),te=Z("a-modal");return o(),J(te,{visible:U.visible,"onUpdate:visible":a[45]||(a[45]=R=>U.$emit("update:visible",R)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:F(()=>[s("div",Yr,[s("div",Jr,[a[51]||(a[51]=s("h4",null,"Export Format",-1)),A(N,{value:i.value,"onUpdate:value":a[0]||(a[0]=R=>i.value=R),class:"format-options"},{default:F(()=>[A(I,{value:"csv"},{default:F(()=>a[46]||(a[46]=[W("CSV")])),_:1,__:[46]}),A(I,{value:"tsv"},{default:F(()=>a[47]||(a[47]=[W("TSV")])),_:1,__:[47]}),A(I,{value:"excel"},{default:F(()=>a[48]||(a[48]=[W("Excel")])),_:1,__:[48]}),A(I,{value:"json"},{default:F(()=>a[49]||(a[49]=[W("JSON")])),_:1,__:[49]}),A(I,{value:"jsonl"},{default:F(()=>a[50]||(a[50]=[W("JSONL")])),_:1,__:[50]})]),_:1},8,["value"])]),s("div",Xr,[a[84]||(a[84]=s("h4",null,"Fields to Export",-1)),s("div",Zr,[A(k,{size:"small",onClick:E},{default:F(()=>a[52]||(a[52]=[W("Select All")])),_:1,__:[52]}),A(k,{size:"small",onClick:f},{default:F(()=>a[53]||(a[53]=[W("Select Defaults")])),_:1,__:[53]}),A(k,{size:"small",onClick:d},{default:F(()=>a[54]||(a[54]=[W("Clear All")])),_:1,__:[54]})]),s("div",eu,[s("div",tu,[a[60]||(a[60]=s("h5",null,"Basic Information",-1)),s("div",su,[A(j,{checked:u.value.id,"onUpdate:checked":a[1]||(a[1]=R=>u.value.id=R),onChange:a[2]||(a[2]=R=>b("id",R.target.checked))},{default:F(()=>a[55]||(a[55]=[W("Call ID")])),_:1,__:[55]},8,["checked"]),A(j,{checked:u.value.order,"onUpdate:checked":a[3]||(a[3]=R=>u.value.order=R),onChange:a[4]||(a[4]=R=>b("order",R.target.checked))},{default:F(()=>a[56]||(a[56]=[W("Order")])),_:1,__:[56]},8,["checked"]),A(j,{checked:u.value.status,"onUpdate:checked":a[5]||(a[5]=R=>u.value.status=R),onChange:a[6]||(a[6]=R=>b("status",R.target.checked))},{default:F(()=>a[57]||(a[57]=[W("Status")])),_:1,__:[57]},8,["checked"]),A(j,{checked:u.value.created,"onUpdate:checked":a[7]||(a[7]=R=>u.value.created=R),onChange:a[8]||(a[8]=R=>b("created",R.target.checked))},{default:F(()=>a[58]||(a[58]=[W("Created Time")])),_:1,__:[58]},8,["checked"]),A(j,{checked:u.value.completed,"onUpdate:checked":a[9]||(a[9]=R=>u.value.completed=R),onChange:a[10]||(a[10]=R=>b("completed",R.target.checked))},{default:F(()=>a[59]||(a[59]=[W("Completed Time")])),_:1,__:[59]},8,["checked"])])]),s("div",au,[a[65]||(a[65]=s("h5",null,"Configuration",-1)),s("div",nu,[A(j,{checked:u.value.configuration,"onUpdate:checked":a[11]||(a[11]=R=>u.value.configuration=R),onChange:a[12]||(a[12]=R=>b("configuration",R.target.checked))},{default:F(()=>a[61]||(a[61]=[W("Configuration Name")])),_:1,__:[61]},8,["checked"]),A(j,{checked:u.value.provider,"onUpdate:checked":a[13]||(a[13]=R=>u.value.provider=R),onChange:a[14]||(a[14]=R=>b("provider",R.target.checked))},{default:F(()=>a[62]||(a[62]=[W("Provider")])),_:1,__:[62]},8,["checked"]),A(j,{checked:u.value.modelId,"onUpdate:checked":a[15]||(a[15]=R=>u.value.modelId=R),onChange:a[16]||(a[16]=R=>b("modelId",R.target.checked))},{default:F(()=>a[63]||(a[63]=[W("Model ID")])),_:1,__:[63]},8,["checked"]),A(j,{checked:u.value.parameters,"onUpdate:checked":a[17]||(a[17]=R=>u.value.parameters=R),onChange:a[18]||(a[18]=R=>b("parameters",R.target.checked))},{default:F(()=>a[64]||(a[64]=[W("Parameters")])),_:1,__:[64]},8,["checked"])])]),s("div",lu,[a[70]||(a[70]=s("h5",null,"Content",-1)),s("div",ou,[A(j,{checked:u.value.prompt,"onUpdate:checked":a[19]||(a[19]=R=>u.value.prompt=R),onChange:a[20]||(a[20]=R=>b("prompt",R.target.checked))},{default:F(()=>a[66]||(a[66]=[W("Prompt")])),_:1,__:[66]},8,["checked"]),A(j,{checked:u.value.variables,"onUpdate:checked":a[21]||(a[21]=R=>u.value.variables=R),onChange:a[22]||(a[22]=R=>b("variables",R.target.checked))},{default:F(()=>a[67]||(a[67]=[W("Variables")])),_:1,__:[67]},8,["checked"]),A(j,{checked:u.value.response,"onUpdate:checked":a[23]||(a[23]=R=>u.value.response=R),onChange:a[24]||(a[24]=R=>b("response",R.target.checked))},{default:F(()=>a[68]||(a[68]=[W("Response")])),_:1,__:[68]},8,["checked"]),A(j,{checked:u.value.parsedResponse,"onUpdate:checked":a[25]||(a[25]=R=>u.value.parsedResponse=R),onChange:a[26]||(a[26]=R=>b("parsedResponse",R.target.checked))},{default:F(()=>a[69]||(a[69]=[W("Parsed Response")])),_:1,__:[69]},8,["checked"])])]),s("div",iu,[a[76]||(a[76]=s("h5",null,"Performance",-1)),s("div",ru,[A(j,{checked:u.value.latency,"onUpdate:checked":a[27]||(a[27]=R=>u.value.latency=R),onChange:a[28]||(a[28]=R=>b("latency",R.target.checked))},{default:F(()=>a[71]||(a[71]=[W("Latency (ms)")])),_:1,__:[71]},8,["checked"]),A(j,{checked:u.value.promptTokens,"onUpdate:checked":a[29]||(a[29]=R=>u.value.promptTokens=R),onChange:a[30]||(a[30]=R=>b("promptTokens",R.target.checked))},{default:F(()=>a[72]||(a[72]=[W("Prompt Tokens")])),_:1,__:[72]},8,["checked"]),A(j,{checked:u.value.completionTokens,"onUpdate:checked":a[31]||(a[31]=R=>u.value.completionTokens=R),onChange:a[32]||(a[32]=R=>b("completionTokens",R.target.checked))},{default:F(()=>a[73]||(a[73]=[W("Completion Tokens")])),_:1,__:[73]},8,["checked"]),A(j,{checked:u.value.totalTokens,"onUpdate:checked":a[33]||(a[33]=R=>u.value.totalTokens=R),onChange:a[34]||(a[34]=R=>b("totalTokens",R.target.checked))},{default:F(()=>a[74]||(a[74]=[W("Total Tokens")])),_:1,__:[74]},8,["checked"]),A(j,{checked:u.value.cost,"onUpdate:checked":a[35]||(a[35]=R=>u.value.cost=R),onChange:a[36]||(a[36]=R=>b("cost",R.target.checked))},{default:F(()=>a[75]||(a[75]=[W("Cost (USD)")])),_:1,__:[75]},8,["checked"])])]),s("div",uu,[a[81]||(a[81]=s("h5",null,"Technical Details",-1)),s("div",du,[A(j,{checked:u.value.request,"onUpdate:checked":a[37]||(a[37]=R=>u.value.request=R),onChange:a[38]||(a[38]=R=>b("request",R.target.checked))},{default:F(()=>a[77]||(a[77]=[W("Full Request")])),_:1,__:[77]},8,["checked"]),A(j,{checked:u.value.response_raw,"onUpdate:checked":a[39]||(a[39]=R=>u.value.response_raw=R),onChange:a[40]||(a[40]=R=>b("response_raw",R.target.checked))},{default:F(()=>a[78]||(a[78]=[W("Raw Response")])),_:1,__:[78]},8,["checked"]),A(j,{checked:u.value.error,"onUpdate:checked":a[41]||(a[41]=R=>u.value.error=R),onChange:a[42]||(a[42]=R=>b("error",R.target.checked))},{default:F(()=>a[79]||(a[79]=[W("Error Details")])),_:1,__:[79]},8,["checked"]),A(j,{checked:u.value.repeatIndex,"onUpdate:checked":a[43]||(a[43]=R=>u.value.repeatIndex=R),onChange:a[44]||(a[44]=R=>b("repeatIndex",R.target.checked))},{default:F(()=>a[80]||(a[80]=[W("Repeat Index")])),_:1,__:[80]},8,["checked"])])]),S.value.length>0?(o(),p("div",cu,[a[82]||(a[82]=s("h5",null,"Parameters (Individual Columns)",-1)),s("div",pu,[(o(!0),p(X,null,se(S.value,R=>(o(),J(j,{key:R.id,checked:u.value[R.id],"onUpdate:checked":ae=>u.value[R.id]=ae,onChange:ae=>b(R.id,ae.target.checked)},{default:F(()=>[W(w(R.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):O("",!0),$.value.length>0?(o(),p("div",fu,[a[83]||(a[83]=s("h5",null,"Attributes (Individual Columns)",-1)),s("div",mu,[(o(!0),p(X,null,se($.value,R=>(o(),J(j,{key:R.id,checked:u.value[R.id],"onUpdate:checked":ae=>u.value[R.id]=ae,onChange:ae=>b(R.id,ae.target.checked)},{default:F(()=>[W(w(R.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):O("",!0)])]),s("div",vu,[a[88]||(a[88]=s("h4",null,"Export Preview",-1)),s("div",gu,[s("div",hu,[a[85]||(a[85]=s("span",{class:"label"},"Records:",-1)),s("span",bu,w(v.value),1)]),s("div",yu,[a[86]||(a[86]=s("span",{class:"label"},"Fields:",-1)),s("span",_u,w(c.value.length),1)]),s("div",Tu,[a[87]||(a[87]=s("span",{class:"label"},"Estimated Size:",-1)),s("span",$u,w(C.value),1)])])]),s("div",Cu,[A(k,{onClick:L},{default:F(()=>a[89]||(a[89]=[W("Cancel")])),_:1,__:[89]}),A(k,{type:"primary",onClick:G,loading:T.value,disabled:c.value.length===0},{default:F(()=>[A(H(os)),a[90]||(a[90]=W(" Export "))]),_:1,__:[90]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),Su=re(ku,[["__scopeId","data-v-d6076c55"]]);class wu{constructor(){ce(this,"subscription",null);ce(this,"progressSubscription",null);ce(this,"store",Ne());ce(this,"v4Control",Et());ce(this,"isActive",!1);ce(this,"currentTrialId",null)}async startStreaming(e){const t=performance.now();g.info(`V4_TRIAL_SWITCH: Stream manager starting for trial ${e}`),this.cleanupSubscriptions();const l=performance.now();g.info(`V4_TRIAL_SWITCH: Stream cleanup completed in ${(l-t).toFixed(1)}ms`),this.isActive=!0,g.info(`V4_TRIAL_SWITCH: Set isActive = true to pause reactive queries at ${(l-t).toFixed(1)}ms`),this.currentTrialId=e,this.store.setCurrentTrial(e),this.store.setStreaming(!0);const r=performance.now();g.info(`V4_TRIAL_SWITCH: Store updated in ${(r-l).toFixed(1)}ms`);const i=performance.now();g.info("V4_TRIAL_SWITCH: ALWAYS loading complete historical data first"),await this.loadHistoricalData(e);const c=performance.now();g.info(`V4_TRIAL_SWITCH: Historical data loading completed in ${(c-i).toFixed(1)}ms - store now has complete dataset`);const T=performance.now();g.info("V4_TRIAL_SWITCH: Checking for active streams to overlay updates");const u=this.v4Control.getActiveStreams(e),m=performance.now();if(g.info(`V4_TRIAL_SWITCH: Stream check completed in ${(m-T).toFixed(1)}ms, result: ${u?"FOUND":"NONE"}`),!u){g.info(`V4_TRIAL_SWITCH: No active streams for trial ${e}, using complete historical data only`);const S=await je.trials.get(e);if(S&&S.status==="running"){g.info(`V4_TRIAL_SWITCH: Running trial ${e}, setting up retry for potential streaming`);let $=0;const h=5,y=setInterval(()=>{$++,g.info(`V4_TRIAL_SWITCH: Retry ${$}/${h} checking for active streams`);const _=this.v4Control.getActiveStreams(e);_?(g.info(`V4_TRIAL_SWITCH: Found active streams after ${$} retries - starting live updates`),clearInterval(y),this.connectToTrialStream(e,_)):$>=h&&(g.info(`V4_TRIAL_SWITCH: No streams after ${h} retries - staying with historical data only`),clearInterval(y))},500)}else g.info(`V4_TRIAL_SWITCH: Non-running trial ${(S==null?void 0:S.status)||"NOT_FOUND"} - complete with historical data only`);return}this.connectToTrialStream(e,u)}connectToTrialStream(e,t){var r,i;g.info(`V4_STREAM_CONNECT: Connecting to streams for trial ${e} with historical foundation`),g.info(`V4_STREAM_CONNECT: Entry point - starting stream connection for trial ${e}`),this.isActive=!0;const l=t.callsSubject||t.sharedCalls$;g.info(`V4_STREAM_CONNECT: Subscribing to calls stream for updates, type: ${(r=l==null?void 0:l.constructor)==null?void 0:r.name}`),g.info(`V4_STREAM_CONNECT: Calls stream available: ${!!l}, type: ${(i=l==null?void 0:l.constructor)==null?void 0:i.name}`),this.subscription=l.subscribe({next:c=>{if(c&&c.length>0){g.info(`V4_STREAM_CONNECT: Merging ${c.length} streaming updates`);const T=[...this.store.apiCalls.value];c.forEach(u=>{const m=T.findIndex(S=>S.id===u.id);m>=0?T[m]=u:T.push(u)}),T.sort((u,m)=>{const S=y=>{switch(y){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},$=S(u.status),h=S(m.status);if($!==h)return $-h;if(u.status==="completed"&&m.status==="completed"){const y=u.completed?new Date(u.completed).getTime():0;return(m.completed?new Date(m.completed).getTime():0)-y}if(u.status==="running"&&m.status==="running"){const y=u.started?new Date(u.started).getTime():0;return(m.started?new Date(m.started).getTime():0)-y}return u.order-m.order}),this.store.updateApiCalls(T)}},error:c=>{g.error("V4_STREAM_CONNECT: Stream error:",c),g.info("V4_STREAM_CONNECT: Calls stream ERROR:",c),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{g.info(`V4_TRIAL_DEBUG_STREAMS_MGR: Stream completed for trial ${e}`),g.info(`V4_TRIAL_DEBUG_STREAMS: Calls stream COMPLETED for trial ${e}`),this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(e)}}),t.sharedProgress$&&(g.info("V4_STREAM_CONNECT: Subscribing to progress stream"),g.info(`V4_STREAM_CONNECT: Progress stream available: ${!!t.sharedProgress$}`),this.progressSubscription=t.sharedProgress$.subscribe({next:c=>{g.info("V4_STREAM_CONNECT: Received progress update:",c.type),g.info(`V4_STREAM_CONNECT: Progress update - ${c.type}`),g.info(`ðŸš¨ COMPLETION_DEBUG: Stream manager received progress event: ${c.type} at ${new Date().toISOString()}`),c.type==="completed"&&(g.info(`V4_TRIAL_DEBUG_STREAMS: Trial ${e} COMPLETED via progress stream`),g.info("ðŸš¨ COMPLETION_DEBUG: âœ… TRIAL COMPLETED EVENT RECEIVED BY STREAM MANAGER!"),g.info(`V4_TRIAL_COMPLETION: Loading final data from database for completed trial ${e}`),this.loadHistoricalData(e).then(()=>{g.info("V4_TRIAL_COMPLETION: Final data loaded - UI should now show accurate completion counts"),g.info("ðŸš¨ COMPLETION_DEBUG: âœ… UI SHOULD BE UPDATED NOW!")}).catch(T=>{g.error("V4_TRIAL_COMPLETION: Failed to load final data:",T)})),this.store.updateProgress(c)},error:c=>{g.error("V4_STREAM_CONNECT: Progress stream error:",c),g.info("V4_STREAM_CONNECT: Progress stream ERROR:",c)}})),g.info("V4_STREAM_CONNECT: Successfully connected to streams with historical foundation"),g.info(`V4_STREAM_CONNECT: Stream subscriptions complete for trial ${e}`)}cleanupSubscriptions(){g.info("STREAM_MGR_V4: Cleaning up existing subscriptions"),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){g.info("STREAM_MGR_V4: Stopping streaming"),g.info(`V4_TRIAL_DEBUG_STREAMS: stopStreaming() called for trial ${this.currentTrialId}`),g.info(`V4_TRIAL_DEBUG_STREAMS: Current isActive: ${this.isActive}`),this.cleanupSubscriptions(),this.isActive=!1,g.info("V4_TRIAL_DEBUG_STREAMS: Stopped streaming, isActive set to false")}async loadHistoricalData(e){const t=performance.now();g.info(`V4_TRIAL_SWITCH: loadHistoricalData() ENTRY for trial ${e}`);try{const l=performance.now();g.info(`V4_TRIAL_SWITCH: Checking database availability at ${(l-t).toFixed(1)}ms`);const r=performance.now();g.info(`V4_TRIAL_SWITCH: Preparing database query at ${(r-t).toFixed(1)}ms`);const i=performance.now();g.info(`V4_TRIAL_SWITCH: Starting IndexedDB query at ${(i-t).toFixed(1)}ms`);const c=await je.apiCalls.where("trialId").equals(e).toArray(),T=performance.now();g.info(`V4_TRIAL_SWITCH: IndexedDB query COMPLETED - loaded ${c.length} calls in ${(T-i).toFixed(1)}ms`),g.info(`V4_TRIAL_SWITCH: Total time to query completion: ${(T-t).toFixed(1)}ms`);const u=performance.now();c.sort((y,_)=>{const v=V=>{switch(V){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},C=v(y.status),x=v(_.status);if(C!==x)return C-x;if(y.status==="completed"&&_.status==="completed"){const V=y.completed?new Date(y.completed).getTime():0;return(_.completed?new Date(_.completed).getTime():0)-V}if(y.status==="running"&&_.status==="running"){const V=y.started?new Date(y.started).getTime():0;return(_.started?new Date(_.started).getTime():0)-V}return y.order-_.order});const m=performance.now();g.info(`V4_TRIAL_SWITCH: Sorting ${c.length} calls took ${(m-u).toFixed(1)}ms`);const S=performance.now();this.store.updateApiCalls(c),this.store.setStreaming(!1);const $=performance.now();g.info(`V4_TRIAL_SWITCH: Store update took ${($-S).toFixed(1)}ms`),g.info(`V4_TRIAL_SWITCH: loadHistoricalData keeping isActive = ${this.isActive} to maintain reactive query pause`);const h=performance.now();g.info(`V4_TRIAL_SWITCH: loadHistoricalData TOTAL: ${(h-t).toFixed(1)}ms`)}catch(l){g.error("STREAM_MGR_V4: Failed to load historical data:",l),this.store.clear()}}destroy(){g.info("STREAM_MGR_V4: Destroying stream manager"),this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let De=null;function Mt(){return De||(De=new wu,g.info("STREAM_MGR_V4: Created singleton manager instance")),De}typeof window<"u"&&(window.__trialStreamManagerV4=()=>De);const Iu={class:"trial-details-panel"},Ru={key:0,class:"loading-state"},Eu={key:1,class:"error-state"},Vu={class:"error-actions"},Au=ie({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(n){const e=n,t=et(),l=q(!1),r=q(null),i=q(!1),c=Mt(),T=M(()=>{var h,y,_;return((h=e.executionState)==null?void 0:h.status)==="executing"&&((y=e.executionState)==null?void 0:y.currentTrialId)===((_=e.trial)==null?void 0:_.id)});function u(){r.value=null}function m(){t.push("/trials")}function S(){i.value=!0}async function $(){if(e.trial){g.info(`REFRESH: Manually refreshing trial ${e.trial.id} data from database`);try{c.isActive&&c.currentTrialId===e.trial.id&&(g.info("REFRESH: Temporarily stopping active stream to reload data"),c.stopStreaming()),await c.loadHistoricalData(e.trial.id),g.info(`REFRESH: Successfully refreshed trial ${e.trial.id} data`),(e.trial.status==="running"||e.trial.status==="paused")&&(g.info("REFRESH: Restarting streaming for active trial"),await c.startStreaming(e.trial.id))}catch(h){g.error("REFRESH: Failed to refresh trial data:",h)}}}return ue(()=>e.trial,(h,y)=>{h&&h.id!==(y==null?void 0:y.id)&&(r.value=null,g.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${y==null?void 0:y.id} to ${h.id}`))}),ve(()=>{var y;const h=(y=e.trial)==null?void 0:y.id;g.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${h}`)}),Ie(()=>{var y;const h=(y=e.trial)==null?void 0:y.id;g.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${h}`)}),Re(()=>{var y;const h=(y=e.trial)==null?void 0:y.id;g.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${h}`)}),he(()=>{var y;const h=(y=e.trial)==null?void 0:y.id;g.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${h}`)}),(h,y)=>{const _=Z("a-button");return o(),p("div",Iu,[l.value?(o(),p("div",Ru,[A(H($t),{class:"loading-spinner",spin:""}),y[9]||(y[9]=s("span",null,"Loading trial details...",-1))])):r.value?(o(),p("div",Eu,[A(H(Vt),{class:"error-icon"}),y[12]||(y[12]=s("h3",null,"Failed to load trial",-1)),s("p",null,w(r.value),1),s("div",Vu,[A(_,{onClick:u},{default:F(()=>y[10]||(y[10]=[W("Retry")])),_:1,__:[10]}),A(_,{type:"link",onClick:m},{default:F(()=>y[11]||(y[11]=[W("Go Back")])),_:1,__:[11]})])])):h.trial?(o(),p(X,{key:2},[A(sn,{trial:h.trial,progress:h.progress,"is-executing":T.value},null,8,["trial","progress","is-executing"]),A(un,{trial:h.trial,"is-leader":h.isLeader,"execution-state":h.executionState,onStart:y[0]||(y[0]=v=>h.$emit("start-trial")),onPause:y[1]||(y[1]=v=>h.$emit("pause-trial")),onResume:y[2]||(y[2]=v=>h.$emit("resume-trial")),onCancel:y[3]||(y[3]=v=>h.$emit("cancel-trial")),onDuplicate:y[4]||(y[4]=v=>h.$emit("duplicate-trial",h.trial.id)),onEdit:y[5]||(y[5]=v=>h.$emit("edit-trial",h.trial.id)),onDelete:y[6]||(y[6]=v=>h.$emit("delete-trial",h.trial.id)),onExportData:S,onExportPython:y[7]||(y[7]=v=>h.$emit("export-python",h.trial.id)),onRefresh:$},null,8,["trial","is-leader","execution-state"]),h.trial&&i.value?(o(),J(Su,{key:0,visible:i.value,trial:h.trial,"onUpdate:visible":y[8]||(y[8]=v=>i.value=!1)},null,8,["visible","trial"])):O("",!0),A(Qr,{trial:h.trial,progress:h.progress,"is-leader":h.isLeader,"execution-state":h.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):O("",!0)])}}}),Ou=re(Au,[["__scopeId","data-v-081db72e"]]),Lu={class:"trials-view-v3"},Fu={key:0,class:"provider-warning-banner"},Pu={class:"banner-content"},Mu={key:1,class:"observer-mode-banner"},Du={class:"banner-content"},xu={key:1,class:"loading-left-pane"},Uu={key:0,class:"no-selection"},Nu={key:0,class:"observer-note"},Wu=ie({__name:"TrialsViewV3",setup(n){const e=Et(),{trials:t}=cs(),{enabledModels:l}=bs(),{duplicateTrial:r,deleteTrial:i}=ps(),c=Mt(),T=Ze(),u=It(),m=et(),S=q(),$=q(!0),h=q(null),y=q(""),_=q("all"),v=q(-1),C=q(!1),x=q(!1),V=M(()=>l.value.length>0),b=M(()=>!V.value&&!x.value),E=e.isLeader,f=e.execution,{trial:d}=fs(h),L=M(()=>{var D;const P=(D=d.value)==null?void 0:D.progress;return P?{trialId:h.value||"",...P,lastUpdated:new Date}:null}),G=M(()=>{let P=t.value;if(y.value){const D=y.value.toLowerCase();P=P.filter(Y=>{var _e,Oe;const le=Y.name.toLowerCase().includes(D),me=(Oe=(_e=Y.templateConfig)==null?void 0:_e.template)==null?void 0:Oe.toLowerCase().includes(D),ne=Y.configurations.some(Se=>Se.modelId.toLowerCase().includes(D)||Se.provider.toLowerCase().includes(D));return le||me||ne})}return _.value!=="all"&&(P=P.filter(D=>D.status===_.value)),P});async function U(){var D;const P=u.query;if(P.duplicate){const Y=P.duplicate,le=await r(Y);le.ok?await m.push({path:"/trials/create",query:{duplicate:le.value,edit:P.edit==="true"?"true":void 0}}):oe.error(`Failed to duplicate trial: ${((D=le.error)==null?void 0:D.message)||"Unknown error"}`),await m.replace({query:{}});return}if(P.designId||P.promptSource){await m.push({path:"/trials/create",query:P});return}if(u.query.trialId){const Y=u.query.trialId;I(Y)}}function a(){if(h.value)return;if(t.value.length===0){g.info("V4_TRIALS: No trials available for auto-selection");return}const P=t.value.find(D=>D.status==="running");if(P){I(P.id);return}I(t.value[0].id)}async function I(P){const D=performance.now();g.info(`V4_TRIAL_SWITCH: Starting trial selection: ${P}`),h.value=P;const Y=performance.now();if(g.info(`V4_TRIAL_SWITCH: UI updated in ${(Y-D).toFixed(1)}ms`),t.value.length>0){const ne=G.value.findIndex(_e=>_e.id===P);ne>=0&&(v.value=ne)}const le=performance.now();if(g.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${P} at ${(le-D).toFixed(1)}ms`),c.startStreaming(P).catch(ne=>{g.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${P}`,ne)}),u.query.trialId!==P){const ne={...u.query};ne.trialId=P,ne.tab||(ne.tab="status"),m.push({path:"/trials",query:ne}),g.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${ne.tab}' at ${(performance.now()-D).toFixed(1)}ms`)}S.value&&S.value.closeMobileOverlay();const me=performance.now();g.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(me-D).toFixed(1)}ms`)}function N(P){y.value=P,v.value=-1}function k(P){_.value=P,v.value=-1}async function j(){oe.info("Refreshing trial list...")}function te(P){const D=G.value;if(D.length!==0){if((P.metaKey||P.ctrlKey)&&P.key==="k"){P.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(P.key==="j"||P.key==="ArrowDown")&&(P.preventDefault(),v.value=Math.min(v.value+1,D.length-1),v.value>=0&&(I(D[v.value].id),R(D[v.value].id))),(P.key==="k"||P.key==="ArrowUp")&&(P.preventDefault(),v.value=Math.max(v.value-1,0),I(D[v.value].id),R(D[v.value].id)),P.key==="Enter"&&h.value,P.key==="Escape"&&(y.value="",h.value=null,v.value=-1)}}function R(P){Te(()=>{const D=document.querySelector(`[data-trial-id="${P}"]`);D&&D.scrollIntoView({behavior:"smooth",block:"nearest"})})}function ae(P){g.debug("Trial list panel resized",{width:P})}function pe(P){g.debug("Mobile overlay changed",{visible:P})}function ye(){x.value=!0}async function ke(){await m.push("/trials/create")}async function Ve(){var P,D,Y,le;if(h.value){if(C.value){g.info("Start trial already in progress, ignoring duplicate request");return}C.value=!0,g.info("V4_EXECUTION:",(P=e.execution)==null?void 0:P.value),g.info("V4_STATUS:",(Y=(D=e.execution)==null?void 0:D.value)==null?void 0:Y.status);try{g.info("V4: Starting trial with streaming",h.value);const me=await e.startTrialWithStreaming(h.value);if(!me.ok){oe.error(((le=me.error)==null?void 0:le.message)||"Unknown error");return}g.info("V4_STREAMING: Restarting stream manager after trial start"),await c.startStreaming(h.value),g.info("V4: Trial started with streaming, stream manager connected");const ne={...u.query};ne.tab="tasks",m.replace({query:ne})}finally{C.value=!1}}}async function z(){var D;g.info(`V4_TRIAL_DEBUG_PAUSE: UI pauseTrial() called for trial: ${h.value}`),g.info(`V4_TRIAL_DEBUG_PAUSE: Current execution state: ${e.execution.value.status}`),g.info(`V4_TRIAL_DEBUG_PAUSE: Is leader: ${e.isLeader.value}`);const P=await e.pauseExecution();g.info("V4_TRIAL_DEBUG_PAUSE: UI pauseTrial result:",P),P.ok?g.info(`V4_TRIAL_DEBUG_PAUSE: Pause successful, execution state: ${e.execution.value.status}`):(g.info("V4_TRIAL_DEBUG_PAUSE: Pause failed from UI:",P.error.message),oe.error(((D=P.error)==null?void 0:D.message)||"Unknown error"))}async function K(){var Y,le,me;if(!h.value)return;g.info(`V4_TRIAL_DEBUG_RESUME: UI resumeTrial() called for trial: ${h.value}`),g.info(`V4_TRIAL_DEBUG_RESUME: Current execution state: ${e.execution.value.status}`),g.info(`V4_TRIAL_DEBUG_RESUME: Is leader: ${e.isLeader.value}`);const P=((Y=e.execution.value)==null?void 0:Y.status)||"idle";g.info(`V4_TRIAL_DEBUG_RESUME: Current execution status: ${P}`);const D=(le=e.execution.value)==null?void 0:le.currentTrialId;if(P==="paused"&&D===h.value){g.info(`V4_TRIAL_DEBUG_RESUME: Execution is paused for THIS trial (${h.value}), using resumeExecution()`);const ne=await e.resumeExecution(h.value);g.info("V4_TRIAL_DEBUG_RESUME: resumeExecution result:",ne),ne.ok?(g.info("V4_TRIAL_DEBUG_RESUME: Resume successful - existing pipeline will continue automatically via pause$ = false"),g.info("V4_TRIAL_DEBUG_RESUME: Resume complete - existing V3 pipeline should continue processing pending calls")):(g.info("V4_TRIAL_DEBUG_RESUME: Resume failed:",ne.error.message),oe.error(ne.error.message))}else{g.info("V4_TRIAL_DEBUG_RESUME: No paused execution found, using startTrialWithStreaming (fresh start)");const ne=await e.startTrialWithStreaming(h.value);g.info("V4_TRIAL_DEBUG_RESUME: startTrialWithStreaming result for fresh start:",ne),ne.ok?(g.info("V4_TRIAL_DEBUG_RESUME: Fresh start successful, starting stream manager"),await c.startStreaming(h.value),g.info("V4_TRIAL_DEBUG_RESUME: Stream manager started for fresh execution")):(g.info("V4_TRIAL_DEBUG_RESUME: Fresh start failed:",ne.error.message),oe.error(((me=ne.error)==null?void 0:me.message)||"Unknown error"))}}async function B(){var D;const P=await e.cancelExecution();P.ok||oe.error(((D=P.error)==null?void 0:D.message)||"Unknown error")}async function Q(P){var Y;const D=await r(P);D.ok?(oe.success("Trial duplicated"),D.value&&I(D.value)):oe.error(((Y=D.error)==null?void 0:Y.message)||"Unknown error")}async function de(P){await m.push({path:"/trials/create",query:{duplicate:P,edit:"true"}})}async function fe(P){var Y;const D=await i(P);D.ok?(oe.success("Trial deleted"),h.value===P&&(h.value=null)):oe.error(((Y=D.error)==null?void 0:Y.message)||"Unknown error")}async function Ae(P,D){var le;const Y=await T.dataExport.exportTrialData(P,{format:D,fields:void 0,includeHeaders:!0,addBOM:D==="excel"});Y.ok?oe.success(`Exported ${Y.value.recordCount} API calls to ${Y.value.filename}`):oe.error(((le=Y.error)==null?void 0:le.message)||"Unknown error")}async function We(P){var Y;const D=await T.pythonGeneration.generatePythonScript(P,{template:"basic",includeAnalysis:!0,includeComments:!0});D.ok?oe.success("Python script exported"):oe.error(((Y=D.error)==null?void 0:Y.message)||"Unknown error")}return ue(()=>u.query.trialId,P=>{P&&P!==h.value&&I(P)}),ue($,(P,D)=>{const Y=performance.now();g.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${D} to ${P} at ${Y}`),P||g.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),ue(t,(P,D)=>{const Y=performance.now();g.info(`V4_TRIAL_SWITCH: trials array changed from ${(D==null?void 0:D.length)||0} to ${P.length} trials at ${Y}`)},{immediate:!0}),ve(async()=>{const P=performance.now();g.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${P}`);const D=performance.now();g.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(D-P).toFixed(1)}ms`);try{await e.initialize();const He=performance.now();g.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(He-D).toFixed(1)}ms`)}catch(He){const Ut=performance.now();g.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(Ut-D).toFixed(1)}ms:`,He)}const Y=performance.now();window.addEventListener("keydown",te),g.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(Y-P).toFixed(1)}ms`);const le=performance.now();g.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(le-P).toFixed(1)}ms`),await Te();const me=performance.now();g.info(`V4_TRIAL_SWITCH: nextTick completed in ${(me-le).toFixed(1)}ms`);const ne=performance.now();$.value=!1,g.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(ne-P).toFixed(1)}ms`);const _e=performance.now();g.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(_e-P).toFixed(1)}ms`),await U();const Oe=performance.now();g.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Oe-_e).toFixed(1)}ms`);const Se=performance.now();g.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(Se-P).toFixed(1)}ms`),a();const Dt=performance.now();g.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Dt-Se).toFixed(1)}ms`);const xt=performance.now();g.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(xt-P).toFixed(1)}ms`)}),he(()=>{g.info("V4_SINGLETON_DEBUG: TrialsViewV3 onUnmounted() - NOT calling v4ExecutionControl.cleanup() to preserve singleton"),window.removeEventListener("keydown",te),c.destroy(),g.info("V4_SINGLETON_DEBUG: V4 execution system preserved, initialized flag should remain true")}),(P,D)=>{const Y=Z("router-link"),le=Z("a-button");return o(),p("div",Lu,[b.value?(o(),p("div",Fu,[s("div",Pu,[A(H(Vt),{class:"warning-icon"}),D[1]||(D[1]=s("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),A(Y,{to:"/settings",class:"settings-link"},{default:F(()=>D[0]||(D[0]=[W("Go to Settings")])),_:1,__:[0]}),A(H(Tt),{class:"close-icon",onClick:ye})]),D[2]||(D[2]=s("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):O("",!0),H(E)?O("",!0):(o(),p("div",Mu,[s("div",Du,[A(H(is),{class:"observer-icon"}),D[3]||(D[3]=s("span",null,[s("strong",null,"Observer Mode: Multiple Tabs Detected")],-1)),D[4]||(D[4]=s("div",{class:"leader-hint"}," You can only open one Auditomatic tab at a time. Close other tabs, or refresh if this is your only tab. Your templates and trials are safely saved. ",-1))])])),A(Is,{ref_key:"splitPanel",ref:S,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:ae,onMobileOverlayChange:pe},{left:F(()=>[$.value?(o(),p("div",xu," Loading trials... ")):(o(),J(Na,{key:0,trials:H(t),"selected-trial-id":h.value,"search-query":y.value,"filter-status":_.value,onSelectTrial:I,onCreateTrial:ke,onUpdateSearch:N,onUpdateFilter:k,onRefresh:j},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:F(()=>[(o(),J(qe,{max:5},[h.value?(o(),J(Ou,{key:h.value,trial:H(d),"is-leader":H(E),"execution-state":H(f),progress:L.value,onStartTrial:Ve,onPauseTrial:z,onResumeTrial:K,onCancelTrial:B,onDuplicateTrial:Q,onEditTrial:de,onDeleteTrial:fe,onExportData:Ae,onExportPython:We},null,8,["trial","is-leader","execution-state","progress"])):O("",!0)],1024)),!h.value||!H(d)?Ce((o(),p("div",Uu,[A(H(rs),{class:"empty-icon"}),D[6]||(D[6]=s("h3",null,"Select a trial to view details",-1)),D[7]||(D[7]=s("p",null,"Choose from the list or create a new one",-1)),A(le,{type:"primary",size:"large",disabled:!H(E),onClick:ke},{default:F(()=>D[5]||(D[5]=[W(" Create New Trial ")])),_:1,__:[5]},8,["disabled"]),H(E)?O("",!0):(o(),p("div",Nu," Close other tabs to enable trial creation "))],512)),[[St,!$.value]]):O("",!0)]),_:1},512)])}}}),Xu=re(Wu,[["__scopeId","data-v-d3804fd9"]]);export{Xu as default};

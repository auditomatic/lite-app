import{f as ie,ax as Ae,ao as Me,a6 as ne,r as F,c as de,p as O,w as pe,t as ge,ag as fe,D as V,h as b,i as t,e as J,v as se,A as N,ac as ae,B as R,G as ue,y as ce,x as W,z as L,F as me,C as ye,ay as Pe,az as Te,j as m,R as Re,a as M,k as le,u as ve,ad as T,aA as Ee,aB as oe,o as Ie,af as q,d as X,aC as Ue}from"./index-C_Jm4ddV.js";const De={class:"secure-api-keys-section"},Fe={class:"section-header"},Ke={class:"security-overview"},Le={class:"security-status"},Oe={class:"status-text"},Ne={class:"global-security-settings"},Be={class:"default-mode-display"},Ve={class:"current-default"},_e={class:"mode-icon"},qe={class:"mode-text"},ze={class:"mode-description"},Ge={key:0,class:"setup-prompt"},je={class:"security-dashboard"},Je={class:"dashboard-cards"},We={class:"security-card encrypted"},Ye={class:"card-value"},He={class:"security-card session"},Ze={class:"card-value"},Qe={class:"security-card plaintext"},Xe={class:"card-value"},et={key:0,class:"unlock-prompt"},tt={key:0,class:"no-providers"},st={key:1,class:"providers-grid"},nt={class:"provider-header"},ot={class:"provider-status"},at={class:"provider-info"},it={class:"endpoints-count"},lt={key:0,class:"base-url"},rt={class:"security-mode-section"},ut={class:"api-key-section"},dt=["for"],ct={key:0,class:"secure-key-input"},mt={class:"input-group"},pt={key:0,class:"locked-message"},yt={key:1,class:"legacy-key-input"},ft={class:"input-group"},vt={class:"key-actions"},gt={class:"security-info"},bt={key:0,class:"security-note encrypted"},kt={key:1,class:"security-note session"},St={key:2,class:"security-note plaintext"},wt=ie({__name:"SecureApiKeysSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=Ae(),n=Me(),r=ne({}),p=ne({}),$=ne({}),P=F(!1),d=F(!1),K=F(!1),f=F(!1),k=F(!1),h=F(""),l=F(null),S=F(null),E=F(null),I=de(()=>{var g;if(!P.value)return[];const i=O.getAllGroups(),o=[];for(const C of i){if(C==="deterministic")continue;const _=O.getProvidersInGroup(C);if(_.length===0)continue;const Q=_[0];if(!O.requiresApiKey(Q.id))continue;const te=w.providers.get(C),y=C.charAt(0).toUpperCase()+C.slice(1);o.push({id:C,name:y,hasApiKey:!!w.getApiKey(C)||c(C),enabled:(te==null?void 0:te.enabled)??!0,endpoints:_.map(G=>G.id),baseUrl:(te==null?void 0:te.baseUrl)||((g=Q.api)==null?void 0:g.baseUrl)||""})}return o}),x=de(()=>n.securityStatus.value),z=de(()=>{const i=localStorage.getItem("v3-settings");if(!i)return{};try{const o=JSON.parse(i);return n.secureStorage.detectPlaintextKeys(o)}catch{return{}}});function B(){return n.hasSetupApiKeySecurity()?!1:(f.value=!0,!0)}function U(i){return n.getEffectiveProviderMode(i)}function Y(i){switch(U(i)){case"encrypted":return"ðŸ”’ Encrypted";case"session":return"âš ï¸ Session";case"plaintext":return"ðŸ“ Plaintext";default:return"ðŸ“ Plaintext"}}function Z(i){const o=U(i);return c(i)||!!w.getApiKey(i)?o==="encrypted"&&!n.isUnlocked.value?"Locked":"Configured":"Not configured"}function c(i){return n.hasApiKey(i)}function A(i){return U(i)==="encrypted"?n.hasApiKey(i)&&!n.isUnlocked.value:!1}function D(i){const o=c(i),g=A(i);return g&&o?"Click to unlock and view encrypted key":g&&!o?"Click to unlock and enter API key":o?"Key configured (hidden)":"Enter API key"}function a(){const{lockedProviderCount:i,sessionProviderCount:o,plaintextProviderCount:g}=x.value,C=i+o+g;return C===0?"none":g===C?"low":i>0?"high":"medium"}function e(){switch(a()){case"high":return"ðŸ”’";case"medium":return"âš ï¸";case"low":return"ðŸ“";default:return"â“"}}function s(){const{lockedProviderCount:i,sessionProviderCount:o,plaintextProviderCount:g}=x.value;if(i+o+g===0)return"No API keys configured";const _=[];return i>0&&_.push(`${i} encrypted`),o>0&&_.push(`${o} session-only`),g>0&&_.push(`${g} plaintext`),_.join(", ")}function u(i){switch(i){case"encrypted":return"ðŸ”’";case"session":return"âš ï¸";case"plaintext":return"ðŸ“";default:return"ðŸ“"}}function v(i){switch(i){case"encrypted":return"Encrypted";case"session":return"Session Only";case"plaintext":return"Plaintext";default:return"Plaintext"}}function j(i){switch(i){case"encrypted":return"Keys protected with Auditomatic local store password";case"session":return"Keys stored in memory only";case"plaintext":return"Keys stored without encryption";default:return"Keys stored without encryption"}}function H(i){$[i]=!$[i]}function re(i){A(i)&&(k.value=!0)}async function be(i,o){if(o==="encrypted"&&!n.hasMasterPassword.value){f.value=!0;return}K.value=!0;try{const g=await n.setProviderSecurityMode(i,o);if(!g.success){V.error(`Failed to change security mode: ${g.error}`);return}r[i]="",p[i]="",V.success(`Security mode changed to ${o}`),await fe()}catch(g){const C=g instanceof Error?g.message:"Unknown error";V.error(`Failed to change security mode: ${C}`)}finally{K.value=!1}}async function ke(i){const o=p[i];if(!o||B())return;const g=U(i);if(g==="encrypted"&&!n.isUnlocked.value){k.value=!0,S.value=i,E.value=o;return}d.value=!0;try{const C=await n.setApiKey(i,o,g);C.success?(V.success("API key saved successfully"),p[i]=""):V.error(`Failed to save API key: ${C.error}`)}catch(C){const _=C instanceof Error?C.message:"Unknown error";V.error(`Failed to save API key: ${_}`)}finally{d.value=!1}}async function Se(i){const o=r[i];if(o){d.value=!0;try{w.setApiKey(i,o),V.success("API key saved successfully"),r[i]=""}finally{d.value=!1}}}async function we(i){try{await n.clearApiKey(i),w.setApiKey(i,""),r[i]="",p[i]="",V.success("API key cleared")}catch(o){const g=o instanceof Error?o.message:"Unknown error";V.error(`Failed to clear API key: ${g}`)}}function he(){n.lock(),V.info("All encrypted keys have been locked")}async function xe(i){var o,g,C;try{const _=await n.unlock(i.password,i.rememberSession);if(_.success){if(k.value=!1,(o=l.value)==null||o.handleUnlockSuccess(),V.success("API keys unlocked successfully"),S.value&&E.value){const Q=S.value,te=E.value;S.value=null,E.value=null,d.value=!0;try{const y=U(Q),G=await n.setApiKey(Q,te,y);G.success?(V.success("API key saved successfully"),p[Q]=""):V.error(`Failed to save API key: ${G.error}`)}finally{d.value=!1}}}else(g=l.value)==null||g.handleUnlockFailure(_.error||"Invalid password")}catch(_){const Q=_ instanceof Error?_.message:"Unknown error";(C=l.value)==null||C.handleUnlockFailure(Q)}}function Ce(){Re.confirm({title:"Reset Auditomatic Local Store Password",content:"This will delete all encrypted API keys. You will need to re-enter them. Continue?",okText:"Yes, Reset",okType:"danger",onOk:async()=>{try{localStorage.removeItem("v3-security"),window.location.reload()}catch{V.error("Failed to reset password")}}})}async function $e(i){try{if(M.info("handleSetupSuccess called with:",i),i.mode==="encrypted"&&i.password){const C=await n.setupMasterPassword(i.password);if(!C.success){V.error(`Failed to setup Auditomatic local store password: ${C.error}`);return}M.info("Auditomatic local store password setup complete")}const o=n.setupGlobalSecurity(i.mode,i.password);if(!o.success){V.error(`Failed to setup security: ${o.error}`);return}M.info("Global security setup complete");const g=localStorage.getItem("v3-security");M.info("Verification - localStorage v3-security:",g),f.value=!1,V.success(`Security setup complete! Default mode: ${i.mode}`),await fe()}catch(o){const g=o instanceof Error?o.message:"Unknown error";M.error("Setup failed:",o),V.error(`Setup failed: ${g}`)}}return pe(()=>I.value,i=>{i.forEach(o=>{o.id in r||(r[o.id]=""),o.id in p||(p[o.id]=""),o.id in $||($[o.id]=!1)})},{immediate:!0}),ge(async()=>{await O.waitForReady(),P.value=!0;const i=z.value;Object.keys(i).length>0&&!n.hasMasterPassword.value&&fe(()=>{V.info({content:`${Object.keys(i).length} API keys found in insecure storage. Consider setting up encryption for better security.`,duration:10})})}),(i,o)=>{const g=ce("a-button"),C=ce("a-select-option"),_=ce("a-select"),Q=ce("a-input-password"),te=ce("a-tooltip");return m(),b("div",De,[t("div",Fe,[o[5]||(o[5]=t("h2",null,"API Keys",-1)),t("div",Ke,[t("div",Le,[t("span",{class:ae(["security-indicator",a()])},R(e()),3),t("span",Oe,R(s()),1)]),ue(n).isUnlocked.value?(m(),se(g,{key:0,size:"small",onClick:he},{default:W(()=>o[4]||(o[4]=[L(" Lock All ")])),_:1,__:[4]})):N("",!0)])]),o[27]||(o[27]=t("p",{class:"section-description"}," Configure API keys with multiple security options. Choose the right protection level for each provider. ",-1)),t("div",Ne,[o[8]||(o[8]=t("h3",null,"ðŸ”§ Default Security Mode",-1)),t("div",Be,[t("div",Ve,[t("span",_e,R(u(ue(n).getDefaultSecurityMode())),1),t("span",qe,R(v(ue(n).getDefaultSecurityMode())),1),t("span",ze,R(j(ue(n).getDefaultSecurityMode())),1)]),J(g,{onClick:o[0]||(o[0]=y=>f.value=!0)},{default:W(()=>o[6]||(o[6]=[L("Change Default")])),_:1,__:[6]})]),o[9]||(o[9]=t("p",{class:"default-explanation"}," New API keys will use this security mode by default. You can override for individual providers below. ",-1)),ue(n).hasSetupApiKeySecurity()?N("",!0):(m(),b("p",Ge,o[7]||(o[7]=[t("strong",null,"First time?",-1),L(' Click "Change Default" to set up your security preferences. ')])))]),t("div",je,[t("div",Je,[t("div",We,[o[10]||(o[10]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"ðŸ”’"),t("h4",null,"Encrypted")],-1)),t("div",Ye,R(x.value.lockedProviderCount),1),o[11]||(o[11]=t("div",{class:"card-label"},"Protected keys",-1))]),t("div",He,[o[12]||(o[12]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"âš ï¸"),t("h4",null,"Session Only")],-1)),t("div",Ze,R(x.value.sessionProviderCount),1),o[13]||(o[13]=t("div",{class:"card-label"},"Memory only",-1))]),t("div",Qe,[o[14]||(o[14]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"ðŸ“"),t("h4",null,"Plaintext")],-1)),t("div",Xe,R(x.value.plaintextProviderCount),1),o[15]||(o[15]=t("div",{class:"card-label"},"Unsecured keys",-1))])]),!ue(n).isUnlocked.value&&x.value.lockedProviderCount>0?(m(),b("div",et,[J(g,{type:"primary",onClick:o[1]||(o[1]=y=>k.value=!0)},{default:W(()=>[L(" Unlock "+R(x.value.lockedProviderCount)+" Encrypted Key"+R(x.value.lockedProviderCount===1?"":"s"),1)]),_:1})])):N("",!0)]),I.value.length===0?(m(),b("div",tt,o[16]||(o[16]=[t("p",null,"No providers requiring API keys are currently configured.",-1)]))):(m(),b("div",st,[(m(!0),b(me,null,ye(I.value,y=>(m(),b("div",{key:y.id,class:"provider-card"},[t("div",nt,[t("h3",null,R(y.name),1),t("div",ot,[t("span",{class:ae(["security-badge",U(y.id)])},R(Y(y.id)),3),t("span",{class:ae(["status",{"has-key":y.hasApiKey}])},R(Z(y.id)),3)])]),t("div",at,[t("p",it,R(y.endpoints.length)+" endpoint(s) available",1),y.baseUrl?(m(),b("p",lt,"Base URL: "+R(y.baseUrl),1)):N("",!0)]),t("div",rt,[o[20]||(o[20]=t("label",null,"Security Mode:",-1)),J(_,{value:U(y.id),onChange:G=>be(y.id,G),class:"security-mode-select",disabled:K.value},{default:W(()=>[J(C,{value:"encrypted"},{default:W(()=>o[17]||(o[17]=[L(" ðŸ”’ Encrypted (Auditomatic local store password required) ")])),_:1,__:[17]}),J(C,{value:"session"},{default:W(()=>o[18]||(o[18]=[L(" âš ï¸ Session Only (Lost on browser close) ")])),_:1,__:[18]}),J(C,{value:"plaintext"},{default:W(()=>o[19]||(o[19]=[L(" ðŸ“ Plaintext (Not recommended) ")])),_:1,__:[19]})]),_:2},1032,["value","onChange","disabled"])]),t("div",ut,[t("label",{for:`api-key-${y.id}`},"API Key:",8,dt),U(y.id)!=="plaintext"?(m(),b("div",ct,[t("div",mt,[J(Q,{id:`api-key-${y.id}`,value:p[y.id],"onUpdate:value":G=>p[y.id]=G,type:$[y.id]?"text":"password",placeholder:D(y.id),class:"api-key-input",disabled:!1,onFocus:G=>re(y.id)},null,8,["id","value","onUpdate:value","type","placeholder","onFocus"]),J(te,{title:A(y.id)?"Unlock to manage key":$[y.id]?"Hide":"Show"},{default:W(()=>[J(g,{onClick:G=>H(y.id),class:"toggle-visibility",disabled:A(y.id)},{default:W(()=>[L(R($[y.id]?"ðŸ™ˆ":"ðŸ‘ï¸"),1)]),_:2},1032,["onClick","disabled"])]),_:2},1032,["title"])]),A(y.id)?(m(),b("div",pt," ðŸ”’ Key is encrypted and locked - click field to unlock ")):N("",!0)])):(m(),b("div",yt,[t("div",ft,[J(Q,{id:`api-key-${y.id}`,value:r[y.id],"onUpdate:value":G=>r[y.id]=G,type:$[y.id]?"text":"password",placeholder:y.hasApiKey?"Key configured (hidden)":"Enter API key",class:"api-key-input"},null,8,["id","value","onUpdate:value","type","placeholder"]),J(g,{onClick:G=>H(y.id),class:"toggle-visibility"},{default:W(()=>[L(R($[y.id]?"ðŸ™ˆ":"ðŸ‘ï¸"),1)]),_:2},1032,["onClick"])])])),t("div",vt,[U(y.id)!=="plaintext"?(m(),se(g,{key:0,onClick:G=>ke(y.id),disabled:!p[y.id]||d.value,loading:d.value,type:"primary"},{default:W(()=>o[21]||(o[21]=[L(" Save ")])),_:2,__:[21]},1032,["onClick","disabled","loading"])):(m(),se(g,{key:1,onClick:G=>Se(y.id),disabled:!r[y.id]||d.value,loading:d.value,type:"primary"},{default:W(()=>o[22]||(o[22]=[L(" Save ")])),_:2,__:[22]},1032,["onClick","disabled","loading"])),y.hasApiKey||c(y.id)?(m(),se(g,{key:2,onClick:G=>we(y.id),disabled:d.value,class:"clear-button"},{default:W(()=>o[23]||(o[23]=[L(" Clear ")])),_:2,__:[23]},1032,["onClick","disabled"])):N("",!0)]),t("div",gt,[U(y.id)==="encrypted"?(m(),b("div",bt,o[24]||(o[24]=[L(" ðŸ›¡ï¸ "),t("span",null,"Key will be encrypted with your Auditomatic local store password",-1)]))):U(y.id)==="session"?(m(),b("div",kt,o[25]||(o[25]=[L(" ðŸ• "),t("span",null,"Key stored in memory only - lost on browser refresh",-1)]))):(m(),b("div",St,o[26]||(o[26]=[L(" âš ï¸ "),t("span",null,"Key stored in plaintext - vulnerable to attacks",-1)])))])])]))),128))])),J(Pe,{open:f.value,"migration-keys":z.value,onClose:o[2]||(o[2]=y=>f.value=!1),onSuccess:$e},null,8,["open","migration-keys"]),J(Te,{open:k.value,"locked-provider-count":x.value.lockedProviderCount,"password-hint":h.value,ref_key:"unlockModalRef",ref:l,onUnlock:xe,onReset:Ce,onClose:o[3]||(o[3]=y=>k.value=!1)},null,8,["open","locked-provider-count","password-hint"])])}}}),ht=le(wt,[["__scopeId","data-v-e344f90c"]]),xt={class:"preferences-section"},Ct={class:"preferences-content"},$t={class:"preference-item"},At={class:"preference-item"},Mt={class:"checkbox-label"},Pt=ie({__name:"PreferencesSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=ve(),n=ee,r=ne({theme:"system",enableEnvironmentalCosts:!1});pe(()=>w.settings.core.preferences.value,P=>{r.theme=P.theme,r.enableEnvironmentalCosts=P.enableEnvironmentalCosts},{immediate:!0});async function p(){var d,K;const P=await w.settings.core.setTheme(r.theme);P.ok?(d=n.onStatusMessage)==null||d.call(n,"Theme updated","success"):(K=n.onStatusMessage)==null||K.call(n,`Failed to update theme: ${P.error.message}`,"error")}async function $(){var d,K;const P=await w.settings.core.setEnvironmentalCosts(r.enableEnvironmentalCosts);P.ok?(d=n.onStatusMessage)==null||d.call(n,"Environmental costs setting updated","success"):(K=n.onStatusMessage)==null||K.call(n,`Failed to update setting: ${P.error.message}`,"error")}return(P,d)=>(m(),b("div",xt,[d[5]||(d[5]=t("h2",null,"Preferences",-1)),d[6]||(d[6]=t("p",{class:"tab-description"},"Configure application behavior and appearance.",-1)),t("div",Ct,[t("div",$t,[d[3]||(d[3]=t("label",{for:"theme-select"},"Theme:",-1)),T(t("select",{id:"theme-select","onUpdate:modelValue":d[0]||(d[0]=K=>r.theme=K),onChange:p,class:"preference-select"},d[2]||(d[2]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)]),544),[[Ee,r.theme]])]),t("div",At,[t("label",Mt,[T(t("input",{type:"checkbox","onUpdate:modelValue":d[1]||(d[1]=K=>r.enableEnvironmentalCosts=K),onChange:$,class:"preference-checkbox"},null,544),[[oe,r.enableEnvironmentalCosts]]),d[4]||(d[4]=L(" Show environmental cost estimates "))])])])]))}}),Tt=le(Pt,[["__scopeId","data-v-5569800c"]]),Rt={class:"performance-recorder"},Et={class:"recorder-controls"},It=["disabled"],Ut=["disabled"],Dt=["disabled"],Ft={class:"recorder-status"},Kt={key:0,class:"status recording"},Lt={key:1,class:"status ready"},Ot={key:2,class:"status idle"},Nt={key:0,class:"export-result"},Bt=ie({__name:"PerformanceRecorder",setup(ee){const w=F(!1),n=F(!1),r=F([]),p=F(""),$=F(0),P=F(0),d=de(()=>r.value.length>0);let K=null,f=null,k=null;function h(){w.value?S():l()}function l(){if(w.value=!0,$.value=Date.now(),P.value=0,r.value=[],K=window.setInterval(E,100),f=window.setInterval(()=>{P.value=Math.floor((Date.now()-$.value)/1e3)},1e3),"PerformanceObserver"in window)try{k=new PerformanceObserver(c=>{const A=c.getEntries(),D={};if(A.forEach(a=>{a.entryType==="paint"&&(D[a.name.replace("-","")]=a.startTime),a.entryType==="largest-contentful-paint"&&(D.largestContentfulPaint=a.startTime)}),r.value.length>0){const a=r.value[r.value.length-1];a.paint={...a.paint,...D}}}),k.observe({entryTypes:["paint","largest-contentful-paint"]})}catch{M.warn("Performance Observer not fully supported")}M.info("ðŸ”´ Performance recording started")}function S(){w.value=!1,K&&(clearInterval(K),K=null),f&&(clearInterval(f),f=null),k&&(k.disconnect(),k=null),M.info(`ðŸŸ¡ Performance recording stopped. Collected ${r.value.length} samples`)}function E(){try{const c={timestamp:Date.now(),timing:I(),network:x(),userAgent:navigator.userAgent,url:window.location.href,customMetrics:z()};if("memory"in performance){const A=performance.memory;c.memory={used:A.usedJSHeapSize,total:A.totalJSHeapSize,limit:A.jsHeapSizeLimit}}r.value.push(c)}catch(c){M.warn("Failed to collect performance sample:",c)}}function I(){const c=performance.getEntriesByType("navigation")[0];return c?{navigation:c.loadEventEnd-c.fetchStart,domContentLoaded:c.domContentLoadedEventEnd-c.fetchStart,loadComplete:c.loadEventEnd-c.fetchStart}:{navigation:performance.now(),domContentLoaded:0,loadComplete:0}}function x(){const c=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return c?{downlink:c.downlink,effectiveType:c.effectiveType,rtt:c.rtt}:{}}function z(){const c={};c.domNodes=document.querySelectorAll("*").length,c.scripts=document.querySelectorAll("script").length,c.stylesheets=document.querySelectorAll('link[rel="stylesheet"]').length,window.__VUE__&&(c.vueVersion=window.__VUE__.version),window.React&&(c.reactVersion=window.React.version);const A=Array.from(document.querySelectorAll("script[src]"));return c.scriptSources=A.length,c}function B(){const c=[];if(r.value.length===0)return c;const A=r.value,D=A[A.length-1];if(D.memory){const a=D.memory.used/1048576,e=D.memory.limit/(1024*1024),s=a/e*100;s>80?c.push({type:"memory",severity:"critical",description:`Memory usage is ${s.toFixed(1)}% of limit`,value:a,recommendation:"Clear caches, reduce data in memory, check for memory leaks"}):s>60&&c.push({type:"memory",severity:"high",description:`Memory usage is ${s.toFixed(1)}% of limit`,value:a,recommendation:"Monitor memory usage, consider data pagination"})}return D.timing.navigation>3e3&&c.push({type:"timing",severity:"high",description:"Slow page load time",value:D.timing.navigation,recommendation:"Optimize bundle size, lazy load components, check network"}),D.network.rtt&&D.network.rtt>200&&c.push({type:"network",severity:"medium",description:"High network latency",value:D.network.rtt,recommendation:"Check network connection, consider CDN, reduce API calls"}),c}function U(){var c,A;n.value=!0;try{const D=B(),a={recordingInfo:{startTime:new Date($.value).toISOString(),duration:P.value,sampleCount:r.value.length,url:window.location.href,userAgent:navigator.userAgent},performanceSummary:{avgMemoryUsage:r.value.filter(e=>e.memory).reduce((e,s)=>e+s.memory.used/(1024*1024),0)/r.value.filter(e=>e.memory).length,totalDOMNodes:(c=r.value[r.value.length-1])==null?void 0:c.customMetrics.domNodes,networkInfo:(A=r.value[r.value.length-1])==null?void 0:A.network},issues:D,topBottlenecks:D.sort((e,s)=>Y(s.severity)-Y(e.severity)).slice(0,5),detailedSamples:r.value.slice(-10),recommendations:[...new Set(D.map(e=>e.recommendation))]};p.value=JSON.stringify(a,null,2),M.info("ðŸ“Š Performance data exported")}catch(D){M.error("Failed to export performance data:",D),p.value=`Export Error: ${D}`}finally{n.value=!1}}function Y(c){return{critical:4,high:3,medium:2,low:1}[c]||0}function Z(){r.value=[],p.value="",P.value=0,M.info("ðŸ—‘ï¸ Performance data cleared")}return Ie(()=>{w.value&&S()}),(c,A)=>(m(),b("div",Rt,[t("div",Et,[t("button",{onClick:h,class:ae(["record-btn",{recording:w.value}]),disabled:n.value},R(w.value?"Stop Recording":"Start Recording"),11,It),t("button",{onClick:U,disabled:!d.value||n.value,class:"export-btn"},R(n.value?"Exporting...":"Export Logs"),9,Ut),t("button",{onClick:Z,disabled:!d.value||w.value,class:"clear-btn"}," Clear ",8,Dt)]),t("div",Ft,[w.value?(m(),b("div",Kt," ðŸ”´ Recording... ("+R(P.value)+"s) ",1)):d.value?(m(),b("div",Lt," âœ… "+R(r.value.length)+" samples recorded ",1)):(m(),b("div",Ot," â¸ï¸ Ready to record "))]),p.value?(m(),b("div",Nt,[A[1]||(A[1]=t("h3",null,"Performance Data Ready",-1)),T(t("textarea",{"onUpdate:modelValue":A[0]||(A[0]=D=>p.value=D),readonly:"",rows:"10",placeholder:"Exported performance data will appear here..."},null,512),[[q,p.value]]),A[2]||(A[2]=t("div",{class:"copy-instructions"}," Copy this data and paste it to Claude for analysis ",-1))])):N("",!0)]))}}),Vt=le(Bt,[["__scopeId","data-v-48cb70ff"]]),_t={class:"advanced-section"},qt={key:0},zt={key:1},Gt={class:"sub-tabs"},jt=["onClick"],Jt={class:"sub-tab-content"},Wt={key:0,class:"provider-settings"},Yt={key:0,class:"no-providers"},Ht={key:0},Zt={key:1},Qt={key:1,class:"provider-cards"},Xt={key:0,class:"provider-advanced-card"},es={class:"setting-group"},ts=["onUpdate:modelValue","onChange"],ss={class:"setting-group"},ns=["onUpdate:modelValue","onChange"],os={class:"setting-group"},as=["onUpdate:modelValue","onChange"],is={class:"setting-group"},ls=["onUpdate:modelValue","onChange"],rs={key:1,class:"execution-settings"},us={class:"settings-grid"},ds={class:"setting-group"},cs={class:"setting-group"},ms={class:"setting-group"},ps={class:"setting-group"},ys={class:"setting-group"},fs={class:"setting-group"},vs={class:"setting-group"},gs={key:2,class:"discovery-settings"},bs={class:"settings-grid"},ks={class:"setting-group"},Ss={class:"setting-group"},ws={class:"setting-group"},hs={class:"setting-group"},xs={key:3,class:"coordination-settings"},Cs={class:"settings-grid"},$s={class:"setting-group"},As={class:"setting-group"},Ms={class:"setting-group"},Ps={class:"setting-group"},Ts={key:4,class:"performance-settings"},Rs={class:"settings-grid"},Es={class:"setting-group"},Is={class:"setting-group"},Us={class:"setting-group"},Ds={class:"setting-group"},Fs={key:5,class:"system-settings"},Ks=ie({__name:"AdvancedSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=ve(),n=ee,r=[{id:"providers",label:"Provider Settings"},{id:"execution",label:"Execution"},{id:"discovery",label:"Discovery"},{id:"coordination",label:"Multi-Tab"},{id:"performance",label:"Performance"},{id:"system",label:"System"}],p=F("providers"),$=F(!1),P=de(()=>{const a=d.value;return a.length>0&&a.every(e=>f[e.id]&&typeof f[e.id].concurrency=="number")}),d=de(()=>{try{const a=O.getAllGroups();M.info("Available group IDs from registry:",a);const e=a.map(s=>{const u=O.getProvidersInGroup(s),v=u.some(j=>O.requiresApiKey(j.id));return{id:s,name:s.charAt(0).toUpperCase()+s.slice(1),requiresApiKey:v,endpoints:u.map(j=>({id:j.id,name:j.name}))}});return M.info("Computed availableProviders:",e),e}catch(a){return M.error("Failed to get available provider groups:",a),[]}}),f=ne((()=>{try{const a=O.getAllGroups();M.info("Initializing provider settings for groups:",a);const e={};return a.forEach(s=>{e[s]={concurrency:2,requestTimeout:30,maxRetries:3,backoffMultiplier:2}}),M.info("Initial provider settings:",e),e}catch(a){return M.error("Failed to initialize provider settings:",a),{}}})());pe(d,async a=>{await O.waitForReady(),M.info("Initializing settings for",a.length,"provider groups"),a.forEach(e=>{if(!f[e.id]){const s=O.getProvidersInGroup(e.id),u=s[0],v=(u==null?void 0:u.execution)||{};M.info(`Initializing settings for provider group ${e.id}:`,{endpoints:s.map(j=>j.id),execution:v}),f[e.id]={concurrency:v.defaultConcurrency||2,requestTimeout:Math.floor((v.timeout||3e4)/1e3),maxRetries:v.maxRetries||3,backoffMultiplier:v.backoffMultiplier||2}}})},{immediate:!0});const k=ne({defaultConcurrency:1,defaultTimeout:120,defaultMaxRetries:3,defaultTemperature:.7,batchSize:1,maxConcurrentBatches:2,progressBufferMs:0}),h=ne({autoDiscoverOnStartup:!0,discoveryInterval:24,discoveryTimeout:60,skipFailedProviders:!1}),l=ne({leaderElectionTimeout:1e3,syncInterval:500,enableBroadcastChannel:!0,enableWebLocks:!0}),S=ne({virtualScrollThreshold:1e3,debounceDelay:300,enableRequestIdleCallback:!0,enableProgressiveRendering:!0});ge(async()=>{try{await O.waitForReady();const a=await w.settings.system.getAllSettings(),e=O.getAllGroups();M.info("Loading existing settings from provider registry for",e.length,"provider groups"),e.forEach(s=>{const u=O.getProviderExecutionOverrides(s);if(M.info(`Loading registry overrides for group ${s}:`,u),u&&f[s])u.concurrency!==void 0&&(f[s].concurrency=u.concurrency),u.timeout!==void 0&&(f[s].requestTimeout=Math.floor(u.timeout/1e3)),u.maxRetries!==void 0&&(f[s].maxRetries=u.maxRetries),u.backoffMultiplier!==void 0&&(f[s].backoffMultiplier=u.backoffMultiplier);else if(f[s]){const j=O.getProvidersInGroup(s)[0],H=(j==null?void 0:j.execution)||{};M.info(`No overrides for group ${s}, using provider defaults:`,H),f[s].concurrency=H.defaultConcurrency||2,f[s].requestTimeout=Math.floor((H.timeout||3e4)/1e3),f[s].maxRetries=H.maxRetries||3,f[s].backoffMultiplier=H.backoffMultiplier||2}}),a.execution&&Object.assign(k,a.execution),a.discovery&&Object.assign(h,a.discovery),a.coordination&&Object.assign(l,a.coordination),a.performance&&Object.assign(S,a.performance),$.value=!0}catch(a){M.error("Failed to initialize advanced settings:",a),$.value=!0}});async function E(a,e,s){var u,v;try{switch(await O.waitForReady(),e){case"concurrency":O.setProviderConcurrency(a,s);break;case"requestTimeout":O.setProviderTimeout(a,s*1e3);break;case"maxRetries":O.setProviderMaxRetries(a,s);break;case"backoffMultiplier":O.setProviderBackoffMultiplier(a,s);break;default:throw new Error(`Unknown setting: ${e}`)}(u=n.onStatusMessage)==null||u.call(n,`Updated ${e} for ${a}`,"success")}catch(j){(v=n.onStatusMessage)==null||v.call(n,`Failed to update ${e}: ${j.message}`,"error");const H=O.getProvider(a),re=(H==null?void 0:H.execution)||{};switch(e){case"concurrency":f[a].concurrency=re.defaultConcurrency||2;break;case"requestTimeout":f[a].requestTimeout=Math.floor((re.timeout||3e4)/1e3);break;case"maxRetries":f[a].maxRetries=re.maxRetries||3;break;case"backoffMultiplier":f[a].backoffMultiplier=re.backoffMultiplier||2;break}}}async function I(a,e){var u,v;const s=await w.settings.system.setExecutionSetting(a,e);s.ok?(u=n.onStatusMessage)==null||u.call(n,`Updated ${a}`,"success"):(v=n.onStatusMessage)==null||v.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}async function x(a,e){var u,v;const s=await w.settings.system.setDiscoverySetting(a,e);s.ok?(u=n.onStatusMessage)==null||u.call(n,`Updated ${a}`,"success"):(v=n.onStatusMessage)==null||v.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}async function z(a,e){var u,v;const s=await w.settings.system.setCoordinationSetting(a,e);s.ok?(u=n.onStatusMessage)==null||u.call(n,`Updated ${a}`,"success"):(v=n.onStatusMessage)==null||v.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}async function B(a,e){var u,v;const s=await w.settings.system.setPerformanceSetting(a,e);s.ok?(u=n.onStatusMessage)==null||u.call(n,`Updated ${a}`,"success"):(v=n.onStatusMessage)==null||v.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}function U(){window.confirm(`WARNING: This will delete ALL data including:

â€¢ All trials and their results
â€¢ All API calls and responses
â€¢ All models and configurations
â€¢ All variable lists and datasets
â€¢ All settings and preferences

This action CANNOT be undone.

Are you absolutely sure?`)&&window.confirm(`FINAL WARNING: You are about to delete EVERYTHING.

Type "DELETE" to confirm.`)&&Y()}async function Y(){var a,e;try{await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),(a=n.onStatusMessage)==null||a.call(n,"Database and storage cleared successfully","success"),setTimeout(()=>{window.location.reload()},1500)}catch(s){M.error("Failed to clear database:",s),(e=n.onStatusMessage)==null||e.call(n,`Failed to clear database: ${s}`,"error")}}function Z(){window.confirm(`FACTORY RESET WARNING: This will completely reset the application to a fresh state.

This will clear:
â€¢ All database data (trials, models, settings, API calls)
â€¢ All localStorage data
â€¢ All sessionStorage data
â€¢ All cookies for this domain
â€¢ All cached data and preferences
â€¢ All API keys and security settings

The app will be restored to first-run state.

This action CANNOT be undone.

Are you absolutely sure?`)&&window.confirm(`FINAL FACTORY RESET WARNING: You will lose EVERYTHING.

All data, settings, API keys, and preferences will be permanently deleted.

Click OK to proceed with factory reset.`)&&c()}async function c(){var a,e;try{if(await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),A(),await D(),"caches"in window){const s=await caches.keys();await Promise.all(s.map(u=>caches.delete(u)))}(a=n.onStatusMessage)==null||a.call(n,"Factory reset completed - all data cleared","success"),setTimeout(()=>{window.location.reload()},2e3)}catch(s){M.error("Failed to perform factory reset:",s),(e=n.onStatusMessage)==null||e.call(n,`Factory reset failed: ${s}`,"error")}}function A(){const a=document.cookie.split(";");for(let e of a){const s=e.indexOf("="),u=s>-1?e.substr(0,s).trim():e.trim();document.cookie=`${u}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${u}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;`;const v=window.location.hostname;document.cookie=`${u}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${v}`,document.cookie=`${u}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${v}`}}async function D(){if("indexedDB"in window&&indexedDB.databases)try{const a=await indexedDB.databases();await Promise.all(a.map(e=>{if(e.name)return new Promise((s,u)=>{const v=indexedDB.deleteDatabase(e.name);v.onsuccess=()=>s(),v.onerror=()=>u(v.error)})}))}catch(a){M.warn("Could not clear all IndexedDB databases:",a)}}return(a,e)=>(m(),b("div",_t,[$.value?(m(),b("div",zt,[e[97]||(e[97]=t("h2",null,"Advanced Settings",-1)),e[98]||(e[98]=t("p",{class:"tab-description"},"Configure advanced settings for providers, execution, and system performance.",-1)),t("div",Gt,[(m(),b(me,null,ye(r,s=>t("button",{key:s.id,class:ae(["sub-tab",{active:p.value===s.id}]),onClick:u=>p.value=s.id},R(s.label),11,jt)),64))]),t("div",Jt,[p.value==="providers"?(m(),b("div",Wt,[e[48]||(e[48]=t("h3",null,"Provider-Specific Settings",-1)),e[49]||(e[49]=t("p",{class:"section-description"},"Configure advanced settings for each provider",-1)),P.value?(m(),b("div",Qt,[(m(!0),b(me,null,ye(d.value,s=>(m(),b(me,{key:s.id},[s&&f[s.id]?(m(),b("div",Xt,[t("h4",null,R(s.name)+" Group",1),e[47]||(e[47]=t("p",{class:"group-description"},"Settings apply to all endpoints in this provider group",-1)),t("div",es,[e[39]||(e[39]=t("label",null,"Concurrency Limit",-1)),T(t("input",{type:"number","onUpdate:modelValue":u=>f[s.id].concurrency=u,min:"1",max:"100",onChange:u=>{var v;return E(s.id,"concurrency",(v=f[s.id])==null?void 0:v.concurrency)}},null,40,ts),[[q,f[s.id].concurrency,void 0,{number:!0}]]),e[40]||(e[40]=t("span",{class:"hint"},"Max parallel requests (1-100)",-1))]),t("div",ss,[e[41]||(e[41]=t("label",null,"Request Timeout (seconds)",-1)),T(t("input",{type:"number","onUpdate:modelValue":u=>f[s.id].requestTimeout=u,min:"10",max:"600",onChange:u=>{var v;return E(s.id,"requestTimeout",(v=f[s.id])==null?void 0:v.requestTimeout)}},null,40,ns),[[q,f[s.id].requestTimeout,void 0,{number:!0}]]),e[42]||(e[42]=t("span",{class:"hint"},"Time before request fails (10-600s)",-1))]),t("div",os,[e[43]||(e[43]=t("label",null,"Max Retries",-1)),T(t("input",{type:"number","onUpdate:modelValue":u=>f[s.id].maxRetries=u,min:"0",max:"10",onChange:u=>{var v;return E(s.id,"maxRetries",(v=f[s.id])==null?void 0:v.maxRetries)}},null,40,as),[[q,f[s.id].maxRetries,void 0,{number:!0}]]),e[44]||(e[44]=t("span",{class:"hint"},"Retry attempts on failure (0-10)",-1))]),t("div",is,[e[45]||(e[45]=t("label",null,"Backoff Multiplier",-1)),T(t("input",{type:"number","onUpdate:modelValue":u=>f[s.id].backoffMultiplier=u,min:"1",max:"5",step:"0.1",onChange:u=>{var v;return E(s.id,"backoffMultiplier",(v=f[s.id])==null?void 0:v.backoffMultiplier)}},null,40,ls),[[q,f[s.id].backoffMultiplier,void 0,{number:!0}]]),e[46]||(e[46]=t("span",{class:"hint"},"Exponential backoff factor (1-5)",-1))])])):N("",!0)],64))),128))])):(m(),b("div",Yt,[d.value.length===0?(m(),b("p",Ht,"No providers are currently configured. Add API keys in the API Keys tab first.")):(m(),b("p",Zt,"Loading provider settings..."))]))])):N("",!0),p.value==="execution"?(m(),b("div",rs,[e[64]||(e[64]=t("h3",null,"Execution Settings",-1)),e[65]||(e[65]=t("p",{class:"section-description"},"Configure how trials are executed",-1)),t("div",us,[t("div",ds,[e[50]||(e[50]=t("label",null,"Default Trial Concurrency",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>k.defaultConcurrency=s),min:"1",max:"20",onChange:e[1]||(e[1]=s=>I("defaultConcurrency",k.defaultConcurrency))},null,544),[[q,k.defaultConcurrency,void 0,{number:!0}]]),e[51]||(e[51]=t("span",{class:"hint"},"Default parallel API calls per trial (1-20)",-1))]),t("div",cs,[e[52]||(e[52]=t("label",null,"Default Timeout (seconds)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>k.defaultTimeout=s),min:"10",max:"600",onChange:e[3]||(e[3]=s=>I("defaultTimeout",k.defaultTimeout))},null,544),[[q,k.defaultTimeout,void 0,{number:!0}]]),e[53]||(e[53]=t("span",{class:"hint"},"Default timeout for all calls (10-600s)",-1))]),t("div",ms,[e[54]||(e[54]=t("label",null,"Default Max Retries",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>k.defaultMaxRetries=s),min:"0",max:"5",onChange:e[5]||(e[5]=s=>I("defaultMaxRetries",k.defaultMaxRetries))},null,544),[[q,k.defaultMaxRetries,void 0,{number:!0}]]),e[55]||(e[55]=t("span",{class:"hint"},"Default retry attempts (0-5)",-1))]),t("div",ps,[e[56]||(e[56]=t("label",null,"Default Temperature",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>k.defaultTemperature=s),min:"0",max:"2",step:"0.1",onChange:e[7]||(e[7]=s=>I("defaultTemperature",k.defaultTemperature))},null,544),[[q,k.defaultTemperature,void 0,{number:!0}]]),e[57]||(e[57]=t("span",{class:"hint"},"Default model temperature (0-2)",-1))]),t("div",ys,[e[58]||(e[58]=t("label",null,"Batch Size",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>k.batchSize=s),min:"1",max:"1000",onChange:e[9]||(e[9]=s=>I("batchSize",k.batchSize))},null,544),[[q,k.batchSize,void 0,{number:!0}]]),e[59]||(e[59]=t("span",{class:"hint"},"API calls per batch (1-1000, lower = more responsive)",-1))]),t("div",fs,[e[60]||(e[60]=t("label",null,"Max Concurrent Batches",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=s=>k.maxConcurrentBatches=s),min:"1",max:"20",onChange:e[11]||(e[11]=s=>I("maxConcurrentBatches",k.maxConcurrentBatches))},null,544),[[q,k.maxConcurrentBatches,void 0,{number:!0}]]),e[61]||(e[61]=t("span",{class:"hint"},"Batches processed simultaneously (1-20)",-1))]),t("div",vs,[e[62]||(e[62]=t("label",null,"Progress Buffer Delay (ms)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>k.progressBufferMs=s),min:"0",max:"10000",step:"100",onChange:e[13]||(e[13]=s=>I("progressBufferMs",k.progressBufferMs))},null,544),[[q,k.progressBufferMs,void 0,{number:!0}]]),e[63]||(e[63]=t("span",{class:"hint"},"Delay before updating progress (0-10000ms, 0 = immediate)",-1))])])])):N("",!0),p.value==="discovery"?(m(),b("div",gs,[e[72]||(e[72]=t("h3",null,"Model Discovery Settings",-1)),e[73]||(e[73]=t("p",{class:"section-description"},"Configure automatic model discovery",-1)),t("div",bs,[t("div",ks,[t("label",null,[T(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>h.autoDiscoverOnStartup=s),onChange:e[15]||(e[15]=s=>x("autoDiscoverOnStartup",h.autoDiscoverOnStartup))},null,544),[[oe,h.autoDiscoverOnStartup]]),e[66]||(e[66]=L(" Auto-discover models on startup "))])]),t("div",Ss,[e[67]||(e[67]=t("label",null,"Discovery Interval (hours)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>h.discoveryInterval=s),min:"1",max:"168",onChange:e[17]||(e[17]=s=>x("discoveryInterval",h.discoveryInterval))},null,544),[[q,h.discoveryInterval,void 0,{number:!0}]]),e[68]||(e[68]=t("span",{class:"hint"},"Time between auto-discovery runs (1-168h)",-1))]),t("div",ws,[e[69]||(e[69]=t("label",null,"Discovery Timeout (seconds)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=s=>h.discoveryTimeout=s),min:"10",max:"300",onChange:e[19]||(e[19]=s=>x("discoveryTimeout",h.discoveryTimeout))},null,544),[[q,h.discoveryTimeout,void 0,{number:!0}]]),e[70]||(e[70]=t("span",{class:"hint"},"Max time for discovery operations (10-300s)",-1))]),t("div",hs,[t("label",null,[T(t("input",{type:"checkbox","onUpdate:modelValue":e[20]||(e[20]=s=>h.skipFailedProviders=s),onChange:e[21]||(e[21]=s=>x("skipFailedProviders",h.skipFailedProviders))},null,544),[[oe,h.skipFailedProviders]]),e[71]||(e[71]=L(" Skip providers that previously failed "))])])])])):N("",!0),p.value==="coordination"?(m(),b("div",xs,[e[80]||(e[80]=t("h3",null,"Multi-Tab Coordination",-1)),e[81]||(e[81]=t("p",{class:"section-description"},"Configure how multiple tabs work together",-1)),t("div",Cs,[t("div",$s,[e[74]||(e[74]=t("label",null,"Leader Election Timeout (ms)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[22]||(e[22]=s=>l.leaderElectionTimeout=s),min:"100",max:"5000",onChange:e[23]||(e[23]=s=>z("leaderElectionTimeout",l.leaderElectionTimeout))},null,544),[[q,l.leaderElectionTimeout,void 0,{number:!0}]]),e[75]||(e[75]=t("span",{class:"hint"},"Time to elect new leader tab (100-5000ms)",-1))]),t("div",As,[e[76]||(e[76]=t("label",null,"Sync Interval (ms)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[24]||(e[24]=s=>l.syncInterval=s),min:"100",max:"2000",onChange:e[25]||(e[25]=s=>z("syncInterval",l.syncInterval))},null,544),[[q,l.syncInterval,void 0,{number:!0}]]),e[77]||(e[77]=t("span",{class:"hint"},"Tab synchronization frequency (100-2000ms)",-1))]),t("div",Ms,[t("label",null,[T(t("input",{type:"checkbox","onUpdate:modelValue":e[26]||(e[26]=s=>l.enableBroadcastChannel=s),onChange:e[27]||(e[27]=s=>z("enableBroadcastChannel",l.enableBroadcastChannel))},null,544),[[oe,l.enableBroadcastChannel]]),e[78]||(e[78]=L(" Enable BroadcastChannel communication "))])]),t("div",Ps,[t("label",null,[T(t("input",{type:"checkbox","onUpdate:modelValue":e[28]||(e[28]=s=>l.enableWebLocks=s),onChange:e[29]||(e[29]=s=>z("enableWebLocks",l.enableWebLocks))},null,544),[[oe,l.enableWebLocks]]),e[79]||(e[79]=L(" Enable Web Locks API "))])])])])):N("",!0),p.value==="performance"?(m(),b("div",Ts,[e[88]||(e[88]=t("h3",null,"UI Performance",-1)),e[89]||(e[89]=t("p",{class:"section-description"},"Optimize UI performance for large datasets and debug performance issues",-1)),J(Vt),t("div",Rs,[t("div",Es,[e[82]||(e[82]=t("label",null,"Virtual Scrolling Threshold",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=s=>S.virtualScrollThreshold=s),min:"50",max:"10000",onChange:e[31]||(e[31]=s=>B("virtualScrollThreshold",S.virtualScrollThreshold))},null,544),[[q,S.virtualScrollThreshold,void 0,{number:!0}]]),e[83]||(e[83]=t("span",{class:"hint"},"Enable virtual scrolling above this row count (50-10000)",-1))]),t("div",Is,[e[84]||(e[84]=t("label",null,"Debounce Delay (ms)",-1)),T(t("input",{type:"number","onUpdate:modelValue":e[32]||(e[32]=s=>S.debounceDelay=s),min:"100",max:"1000",onChange:e[33]||(e[33]=s=>B("debounceDelay",S.debounceDelay))},null,544),[[q,S.debounceDelay,void 0,{number:!0}]]),e[85]||(e[85]=t("span",{class:"hint"},"Search/filter debounce delay (100-1000ms)",-1))]),t("div",Us,[t("label",null,[T(t("input",{type:"checkbox","onUpdate:modelValue":e[34]||(e[34]=s=>S.enableRequestIdleCallback=s),onChange:e[35]||(e[35]=s=>B("enableRequestIdleCallback",S.enableRequestIdleCallback))},null,544),[[oe,S.enableRequestIdleCallback]]),e[86]||(e[86]=L(" Use requestIdleCallback for background tasks "))])]),t("div",Ds,[t("label",null,[T(t("input",{type:"checkbox","onUpdate:modelValue":e[36]||(e[36]=s=>S.enableProgressiveRendering=s),onChange:e[37]||(e[37]=s=>B("enableProgressiveRendering",S.enableProgressiveRendering))},null,544),[[oe,S.enableProgressiveRendering]]),e[87]||(e[87]=L(" Enable progressive rendering for large results "))])])])])):N("",!0),p.value==="system"?(m(),b("div",Fs,[e[95]||(e[95]=t("h3",null,"System Management",-1)),e[96]||(e[96]=t("p",{class:"section-description"},"Manage database and storage",-1)),t("div",{class:"danger-zone"},[e[94]||(e[94]=t("h4",null,"âš ï¸ Danger Zone",-1)),t("div",{class:"danger-actions"},[t("div",{class:"action-card"},[e[90]||(e[90]=t("h5",null,"Clear All Data",-1)),e[91]||(e[91]=t("p",null,"Delete all trials, models, settings, and API calls from the database. This action cannot be undone.",-1)),t("button",{class:"danger-button",onClick:U}," Delete Database & Store ")]),t("div",{class:"action-card"},[e[92]||(e[92]=t("h5",null,"Factory Reset",-1)),e[93]||(e[93]=t("p",null,"Complete factory reset - clears database, localStorage, sessionStorage, cookies, and all browser data. Restores app to fresh installation state.",-1)),t("button",{class:"danger-button",onClick:Z}," Factory Reset Everything ")])])])])):N("",!0)])])):(m(),b("div",qt,e[38]||(e[38]=[t("p",null,"Loading settings...",-1)])))]))}}),Ls=le(Ks,[["__scopeId","data-v-3629e935"]]),Os={class:"import-export-section"},Ns={class:"import-export-content"},Bs={class:"import-section all-data"},Vs={class:"file-input-wrapper"},_s={class:"import-section"},qs={class:"file-input-wrapper"},zs={class:"danger-section"},Gs=["disabled"],js=ie({__name:"ImportExportSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=ve(),n=ee,r=F(),p=F(),$=F(!1);async function P(){var l,S;const h=await w.settings.core.exportSettings();if(h.ok){const E=new Blob([h.value],{type:"application/json"}),I=URL.createObjectURL(E),x=document.createElement("a");x.href=I,x.download=`auditomatic-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(I),(l=n.onStatusMessage)==null||l.call(n,"Settings exported successfully","success")}else(S=n.onStatusMessage)==null||S.call(n,`Failed to export settings: ${h.error.message}`,"error")}async function d(h){var S,E,I,x;const l=(S=h.target.files)==null?void 0:S[0];if(l)try{const z=await l.text(),B=await w.settings.core.importSettings(z);B.ok?((E=n.onStatusMessage)==null||E.call(n,"Settings imported successfully","success"),r.value&&(r.value.value="")):(I=n.onStatusMessage)==null||I.call(n,`Failed to import settings: ${B.error.message}`,"error")}catch{(x=n.onStatusMessage)==null||x.call(n,"Failed to read file","error")}}async function K(){var l,S;if(!confirm("Are you sure you want to reset all settings? This cannot be undone."))return;$.value=!0;const h=await w.settings.core.resetSettings();$.value=!1,h.ok?(l=n.onStatusMessage)==null||l.call(n,"All settings have been reset","success"):(S=n.onStatusMessage)==null||S.call(n,`Failed to reset settings: ${h.error.message}`,"error")}async function f(){var h,l,S;try{(h=n.onStatusMessage)==null||h.call(n,"Exporting all data...","success");const E={version:2,exported:new Date().toISOString(),app:"auditomatic-lite",tables:{}};for(const Y of X.tables){const Z=Y.name;E.tables[Z]=await Y.toArray()}const I=JSON.stringify(E,null,2),x=(I.length/(1024*1024)).toFixed(2),z=new Blob([I],{type:"application/json"}),B=URL.createObjectURL(z),U=document.createElement("a");U.href=B,U.download=`auditomatic-all-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(B),(l=n.onStatusMessage)==null||l.call(n,`All data exported successfully (${x} MB)`,"success")}catch(E){M.error("Failed to export all data:",E),(S=n.onStatusMessage)==null||S.call(n,`Failed to export data: ${E}`,"error")}}async function k(h){var E,I,x,z;const l=(E=h.target.files)==null?void 0:E[0];if(!l)return;if(!confirm(`WARNING: This will REPLACE ALL existing data with the imported data.

All current trials, models, settings, etc. will be deleted.

Are you absolutely sure?`)){p.value&&(p.value.value="");return}try{(I=n.onStatusMessage)==null||I.call(n,"Importing all data...","success");const B=await l.text(),U=JSON.parse(B);if(!U.version||!U.tables)throw new Error("Invalid data format");await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(Y=>Y.clear()));for(const[Y,Z]of Object.entries(U.tables)){const c=X[Y];c&&Array.isArray(Z)&&Z.length>0&&await c.bulkAdd(Z)}}),(x=n.onStatusMessage)==null||x.call(n,"All data imported successfully","success"),p.value&&(p.value.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(B){M.error("Failed to import all data:",B),(z=n.onStatusMessage)==null||z.call(n,`Failed to import data: ${B}`,"error"),p.value&&(p.value.value="")}}return(h,l)=>(m(),b("div",Os,[l[13]||(l[13]=t("h2",null,"Import & Export",-1)),l[14]||(l[14]=t("p",{class:"tab-description"},"Backup and restore your settings. API keys are masked during export for security.",-1)),t("div",Ns,[t("div",{class:"export-section all-data"},[l[2]||(l[2]=t("h3",null,"ðŸ“¦ Export All Data",-1)),t("button",{onClick:f,class:"btn btn-primary btn-large"}," Export Everything to JSON "),l[3]||(l[3]=t("p",{class:"help-text"},"Downloads ALL data: trials, models, settings, variable lists, datasets, API calls, etc.",-1))]),t("div",Bs,[l[4]||(l[4]=t("h3",null,"ðŸ“¥ Import All Data",-1)),t("div",Vs,[t("input",{ref_key:"allDataFileInput",ref:p,type:"file",accept:".json",onChange:k,class:"file-input"},null,544),t("button",{onClick:l[0]||(l[0]=()=>p.value&&p.value.click()),class:"btn btn-primary btn-large"}," Import Everything from JSON ")]),l[5]||(l[5]=t("p",{class:"help-text"},"âš ï¸ WARNING: This will REPLACE all existing data with the imported data",-1))]),l[12]||(l[12]=t("hr",{class:"section-divider"},null,-1)),t("div",{class:"export-section"},[l[6]||(l[6]=t("h3",null,"Export Settings Only",-1)),t("button",{onClick:P,class:"btn btn-secondary"}," Export Settings to JSON "),l[7]||(l[7]=t("p",{class:"help-text"},"Downloads a JSON file with your settings (API keys will be masked)",-1))]),t("div",_s,[l[8]||(l[8]=t("h3",null,"Import Settings Only",-1)),t("div",qs,[t("input",{ref_key:"fileInput",ref:r,type:"file",accept:".json",onChange:d,class:"file-input"},null,544),t("button",{onClick:l[1]||(l[1]=()=>r.value&&r.value.click()),class:"btn btn-secondary"}," Choose File ")]),l[9]||(l[9]=t("p",{class:"help-text"},"Import settings from a previously exported JSON file",-1))]),t("div",zs,[l[10]||(l[10]=t("h3",null,"Reset Settings",-1)),t("button",{onClick:K,class:"btn btn-danger",disabled:$.value},R($.value?"Resetting...":"Reset All Settings"),9,Gs),l[11]||(l[11]=t("p",{class:"help-text"},"âš ï¸ This will clear all API keys and reset preferences to defaults",-1))])])]))}}),Js=le(js,[["__scopeId","data-v-7b20deaa"]]),Ws=ie({__name:"StatusMessage",props:{text:{},type:{},duration:{default:5e3}},setup(ee){const w=ee,n=F(!1);let r=null;return pe(()=>w.text,p=>{p&&(n.value=!0,r&&clearTimeout(r),r=setTimeout(()=>{n.value=!1},w.duration))},{immediate:!0}),pe(n,p=>{!p&&r&&(clearTimeout(r),r=null)}),(p,$)=>(m(),se(Ue,{name:"slide"},{default:W(()=>[n.value?(m(),b("div",{key:0,class:ae(["status-message",p.type])},R(p.text),3)):N("",!0)]),_:1}))}}),Ys=le(Ws,[["__scopeId","data-v-da279e0d"]]),Hs={class:"settings-view","data-testid":"page-settings"},Zs={class:"tabs"},Qs=["onClick"],Xs={class:"tab-content"},en=ie({__name:"SettingsView",setup(ee){const w=[{id:"api-keys",label:"API Keys"},{id:"preferences",label:"Preferences"},{id:"advanced",label:"Advanced"},{id:"import-export",label:"Import/Export"}],n=F("api-keys"),r=F(null);function p($,P){r.value={text:$,type:P},setTimeout(()=>{var d;((d=r.value)==null?void 0:d.text)===$&&(r.value=null)},5500)}return($,P)=>(m(),b("div",Hs,[P[0]||(P[0]=t("h1",{class:"settings-title"},"Settings",-1)),t("div",Zs,[(m(),b(me,null,ye(w,d=>t("button",{key:d.id,class:ae(["tab",{active:n.value===d.id}]),onClick:K=>n.value=d.id},R(d.label),11,Qs)),64))]),t("div",Xs,[n.value==="api-keys"?(m(),se(ht,{key:0,"on-status-message":p})):N("",!0),n.value==="preferences"?(m(),se(Tt,{key:1,"on-status-message":p})):N("",!0),n.value==="advanced"?(m(),se(Ls,{key:2,"on-status-message":p})):N("",!0),n.value==="import-export"?(m(),se(Js,{key:3,"on-status-message":p})):N("",!0)]),r.value?(m(),se(Ys,{key:0,text:r.value.text,type:r.value.type},null,8,["text","type"])):N("",!0)]))}}),sn=le(en,[["__scopeId","data-v-ea1dc301"]]);export{sn as default};

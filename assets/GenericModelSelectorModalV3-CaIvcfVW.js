import{d as Z,c as E,R as f,Y as s,S as c,k as P,a0 as ie,F as j,_ as h,G as I,V as b,f as Q,$ as M,Z as _,W as Y,B as _e,u as J,r as ue,w as te,o as de,X as ke}from"./vue-vendor-DPw1dQYc.js";import{u as he}from"./useV4Models-DAvBQgSK.js";import{u as re}from"./useV4ProviderParameters-zwYNCGfm.js";import{h as ee,m as Ce,a as q,n as $e}from"./index-COaxREvt.js";import{u as ye}from"./useCostEstimation-DR_TI3jm.js";import{_ as Me,ak as ce,al as pe,m as oe,ao as be,C as Te,o as xe,a5 as Pe,a3 as Oe,a4 as we,aj as Fe,ap as De,a6 as Ie,a7 as Se,T as Ve,a8 as qe,q as Ee,M as Ue,W as Ae,a2 as ze,S as Ke}from"./ui-vendor-BMnJXXRj.js";const Re={class:"model-search-filters"},Ne={class:"panel-header"},Be={class:"search-container"},Ge=Z({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(L,{emit:n}){const t=L,O=n,$=E({get:()=>t.modelValue,set:w=>O("update:modelValue",w)});return(w,x)=>{const S=Me;return s(),f("div",Re,[c("div",Ne,[x[2]||(x[2]=c("h3",null,"Available Models",-1)),c("div",Be,[x[1]||(x[1]=c("span",{class:"search-label"},"Search:",-1)),P(S,{value:$.value,"onUpdate:value":x[0]||(x[0]=v=>$.value=v),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),je=ee(Ge,[["__scopeId","data-v-56bdd915"]]),Le=["title"],We={key:0,class:"cost-group"},Je={class:"cost-item"},Qe={class:"cost-value"},Ye={class:"cost-value"},He={key:1,class:"cost-group"},Xe={class:"enviro-group"},Ze={key:0,class:"enviro-item"},et={key:1,class:"cost-tab"},tt={key:2,class:"enviro-item"},ot={key:3,class:"cost-tab"},nt={key:4,class:"enviro-item"},st={key:0,class:"cost-group"},lt={class:"cost-item"},at={class:"cost-value"},ut={class:"cost-value"},it={class:"enviro-group"},dt={key:0,class:"enviro-item"},rt={key:1,class:"cost-tab"},ct={key:2,class:"enviro-item"},pt={key:3,class:"cost-tab"},mt={key:4,class:"enviro-item"},ft={key:0,class:"cost-item financial"},vt={key:0,class:"cost-value"},gt={key:1,class:"cost-value"},_t={key:1,class:"cost-item environmental"},kt={key:0,class:"enviro-item"},ht={class:"enviro-value"},Ct={key:1,class:"enviro-item"},$t={class:"enviro-value"},yt={key:2,class:"enviro-item"},Mt={class:"enviro-value"},bt={key:3,class:"cost-unit"},Tt=Z({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(L){const n=L,t=Ce(),O=E(()=>!0),$=E(()=>t.preferences.showCO2),w=E(()=>t.preferences.showWater),x=E(()=>t.preferences.showElectricity);function S(){if(!n.model.capabilities)return"â€”";const e=n.model.capabilities.inputCostPerToken||0,i=n.model.capabilities.outputCostPerToken||0;if(n.mode==="per-thousand"){const g=(e+i)*1e3;return v(g)}else if(n.mode==="total")if(n.inputTokens!=null&&n.outputTokens!=null){const g=e*n.inputTokens+i*n.outputTokens;return v(g)}else return"??";return"â€”"}function v(e){if(e===0)return"0.00";if(e<.01){let i=2,g=e;for(;g<.1;)g*=10,i++;return e.toFixed(i)}return e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):Math.round(e).toLocaleString()}function C(e){if(e===0)return"0.00";if(e<.01){let i=2,g=e;for(;g<.1;)g*=10,i++;return e.toFixed(i)}return e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):Math.round(e).toLocaleString()}function F(){if(!n.model.capabilities)return"0";const e=(n.model.capabilities.inputCostPerToken||0)*1e3;return C(e)}function U(){if(!n.model.capabilities)return"0";const e=(n.model.capabilities.outputCostPerToken||0)*1e3;return C(e)}function W(){if(!n.model.capabilities||n.inputTokens==null||n.minOutputTokens==null)return"??";const e=n.model.capabilities.inputCostPerToken||0,i=n.model.capabilities.outputCostPerToken||0,g=e*n.inputTokens+i*n.minOutputTokens;return C(g)}function B(){if(!n.model.capabilities||n.inputTokens==null||n.maxOutputTokens==null)return"??";const e=n.model.capabilities.inputCostPerToken||0,i=n.model.capabilities.outputCostPerToken||0,g=e*n.inputTokens+i*n.maxOutputTokens;return C(g)}function N(e){return"??"}function R(e){return"??"}const D=E(()=>{const e=[];e.push("=== ModelCostDisplayV3 Debug ==="),e.push(`Mode: ${n.mode}`),e.push(`Model: ${n.model.provider}:${n.model.modelId}`),e.push(`Layout: ${n.layout}, Size: ${n.size}`),e.push(""),e.push("=== Token Input Data ==="),n.inputTokens&&e.push(`Input Tokens: ${n.inputTokens}`),n.outputTokens&&e.push(`Output Tokens: ${n.outputTokens}`),n.minOutputTokens&&e.push(`Min Output Tokens: ${n.minOutputTokens}`),n.maxOutputTokens&&e.push(`Max Output Tokens: ${n.maxOutputTokens}`),e.push(""),e.push("=== Model Pricing Rates ===");const i=n.model.capabilities?.inputCostPerToken||0,g=n.model.capabilities?.outputCostPerToken||0;if(e.push(`Input Rate: $${i} per token ($${(i*1e3).toFixed(4)}/1K)`),e.push(`Output Rate: $${g} per token ($${(g*1e3).toFixed(4)}/1K)`),e.push(""),e.push(`=== Calculations (Mode: ${n.mode}) ===`),n.mode==="per-thousand"){const T=(i+g)*1e3;e.push(`Combined rate per 1K: ($${i} + $${g}) Ã— 1000 = $${T.toFixed(6)}`),e.push(`Display: ${S()}`)}else if(n.mode==="total"&&n.inputTokens!=null&&n.outputTokens!=null){const T=i*n.inputTokens,K=g*n.outputTokens,G=T+K;e.push(`Input cost: $${i} Ã— ${n.inputTokens} = $${T.toFixed(6)}`),e.push(`Output cost: $${g} Ã— ${n.outputTokens} = $${K.toFixed(6)}`),e.push(`Total cost: $${T.toFixed(6)} + $${K.toFixed(6)} = $${G.toFixed(6)}`),e.push(`Display: ${S()}`)}else if(n.mode==="range"&&n.inputTokens!=null&&n.minOutputTokens!=null&&n.maxOutputTokens!=null){const T=i*n.inputTokens,K=g*n.minOutputTokens,G=g*n.maxOutputTokens,H=T+K,X=T+G;e.push(`Input cost: $${i} Ã— ${n.inputTokens} = $${T.toFixed(6)}`),e.push(`Min output cost: $${g} Ã— ${n.minOutputTokens} = $${K.toFixed(6)}`),e.push(`Max output cost: $${g} Ã— ${n.maxOutputTokens} = $${G.toFixed(6)}`),e.push(`Min total: $${T.toFixed(6)} + $${K.toFixed(6)} = $${H.toFixed(6)}`),e.push(`Max total: $${T.toFixed(6)} + $${G.toFixed(6)} = $${X.toFixed(6)}`),e.push(`Display: ${W()} - ${B()}`)}else if(n.mode==="input-output"){const T=i*1e3,K=g*1e3;e.push(`Input per 1K: $${i} Ã— 1000 = $${T.toFixed(6)}`),e.push(`Output per 1K: $${g} Ã— 1000 = $${K.toFixed(6)}`),e.push(`Display: $${F()}/1K input + $${U()}/1K output`)}else e.push("No calculations available for this mode/input combination");return e.join(`
`)});function z(){const e=D.value;q.info("ðŸ” ModelCostDisplayV3 Debug Info:",{mode:n.mode,model:`${n.model.provider}:${n.model.modelId}`,inputTokens:n.inputTokens,outputTokens:n.outputTokens,minOutputTokens:n.minOutputTokens,maxOutputTokens:n.maxOutputTokens,layout:n.layout,size:n.size,inputRate:n.model.capabilities?.inputCostPerToken,outputRate:n.model.capabilities?.outputCostPerToken,calculations:e.split(`
`).filter(i=>i.includes("=")).join(" | ")})}return(e,i)=>(s(),f("div",{class:ie(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]]),title:D.value,onMouseenter:z},[e.mode==="range"?(s(),f(j,{key:0},[O.value&&e.maxOutputTokens?(s(),f("span",We,[c("span",Je,[i[0]||(i[0]=c("span",{class:"debug-mode"},"range:",-1)),c("span",Qe,"$"+b(W()),1),i[1]||(i[1]=I(" - ")),c("span",Ye,"$"+b(B()),1)])])):O.value?(s(),f("span",He,i[2]||(i[2]=[c("span",{class:"cost-item"},[c("span",{class:"debug-mode"},"range:"),c("span",{class:"cost-value"},"Cost: ??")],-1)]))):h("",!0),i[3]||(i[3]=c("span",{class:"cost-tab"},null,-1)),c("span",Xe,[$.value?(s(),f("span",Ze,"COâ‚‚ "+b(R()),1)):h("",!0),$.value&&w.value?(s(),f("span",et)):h("",!0),w.value?(s(),f("span",tt,"ðŸ’§"+b(R()),1)):h("",!0),($.value||w.value)&&x.value?(s(),f("span",ot)):h("",!0),x.value?(s(),f("span",nt,"âš¡"+b(R()),1)):h("",!0)])],64)):e.mode==="input-output"?(s(),f(j,{key:1},[O.value?(s(),f("span",st,[c("span",lt,[i[4]||(i[4]=c("span",{class:"debug-mode"},"input-output:",-1)),c("span",at,"$"+b(F()),1),i[5]||(i[5]=I("/1K input + ")),c("span",ut,"$"+b(U()),1),i[6]||(i[6]=I("/1K output "))])])):h("",!0),i[7]||(i[7]=c("span",{class:"cost-tab"},null,-1)),c("span",it,[$.value?(s(),f("span",dt,"COâ‚‚ "+b(N()),1)):h("",!0),$.value&&w.value?(s(),f("span",rt)):h("",!0),w.value?(s(),f("span",ct,"ðŸ’§"+b(N()),1)):h("",!0),($.value||w.value)&&x.value?(s(),f("span",pt)):h("",!0),x.value?(s(),f("span",mt,"âš¡"+b(N()),1)):h("",!0)])],64)):(s(),f(j,{key:2},[O.value?(s(),f("div",ft,[e.mode==="per-thousand"?(s(),f("span",vt,[i[8]||(i[8]=c("span",{class:"debug-mode"},"per-thousand:",-1)),I(" "+b(S())+" ",1),i[9]||(i[9]=c("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):e.mode==="total"?(s(),f("span",gt,[i[10]||(i[10]=c("span",{class:"debug-mode"},"total:",-1)),I(" "+b(S()),1)])):h("",!0)])):h("",!0),$.value||w.value||x.value?(s(),f("div",_t,[$.value?(s(),f("span",kt,[i[11]||(i[11]=c("span",{class:"enviro-icon"},"COâ‚‚",-1)),c("span",ht,b(N()),1)])):h("",!0),w.value?(s(),f("span",Ct,[i[12]||(i[12]=c("span",{class:"enviro-icon"},"ðŸ’§",-1)),c("span",$t,b(N()),1)])):h("",!0),x.value?(s(),f("span",yt,[i[13]||(i[13]=c("span",{class:"enviro-icon"},"âš¡",-1)),c("span",Mt,b(N()),1)])):h("",!0),e.mode==="per-thousand"?(s(),f("span",bt,"/ 1,000")):h("",!0)])):h("",!0)],64))],42,Le))}}),me=ee(Tt,[["__scopeId","data-v-9626c100"]]),xt={class:"provider-header"},Pt={class:"provider-name"},Ot={class:"provider-model-count"},wt={key:0,class:"api-key-warning"},Ft={class:"provider-models"},Dt=["onClick"],It={class:"model-name"},St={key:0,class:"model-specs"},Vt=Z({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(L){const n=Q(void 0);function t($){return $}function O($){n.value===$?n.value=void 0:n.value=$}return($,w)=>{const x=oe,S=pe,v=ce;return s(),M(v,{activeKey:n.value,"onUpdate:activeKey":w[0]||(w[0]=C=>n.value=C),bordered:!1,accordion:""},{default:_(()=>[(s(!0),f(j,null,Y($.groupedModels,(C,F)=>(s(),M(S,{key:F,class:"provider-panel","data-provider":F},{header:_(()=>[c("div",xt,[c("span",Pt,b(F),1),c("span",Ot,b(C.length)+" models",1),$.requiresApiKey(F)&&!$.hasApiKey($.getProviderGroup(F))?(s(),f("div",wt,[P(J(be)),w[1]||(w[1]=c("span",null,"API Key Missing",-1))])):h("",!0)])]),extra:_(()=>[P(x,{size:"small",type:"text",onClick:_e(U=>O(F),["stop"])},{default:_(()=>[I(b(n.value===F?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:_(()=>[c("div",Ft,[(s(!0),f(j,null,Y(C,U=>(s(),f("div",{key:U.id,class:ie(["model-row",{selected:$.selectedModelId===U.id}]),onClick:W=>$.$emit("select-model",U)},[c("div",It,b(U.displayName),1),$.hasConfigPanel?h("",!0):(s(),f("div",St,[P(me,{model:U,mode:$.mode==="trial"?"range":"input-output","input-tokens":$.getInputTokensForModel(U),"min-output-tokens":10,"max-output-tokens":$.getOutputTokensForModel(U),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,Dt))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),qt=ee(Vt,[["__scopeId","data-v-7ff59b1f"]]),Et={class:"config-panel"},Ut={class:"config-header"},At={class:"config-header-title"},zt={key:0,class:"total-cost"},Kt={key:0,class:"cost-info"},Rt={class:"config-content"},Nt={class:"param-description"},Bt={class:"param-description"},Gt={key:0,class:"config-footer"},jt={key:0,class:"duplicate-error"},Lt=Z({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},tokenData:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(L,{emit:n}){const t=L,O=n,{getBasicParameters:$,getAdvancedParameters:w,getParametersForModel:x}=re(),S=Q(""),v=ue({}),C=ue({}),F=Q(""),U=E(()=>t.selectedModel?$(t.selectedModel.provider,t.selectedModel.modelId):{}),W=E(()=>t.selectedModel?w(t.selectedModel.provider,t.selectedModel.modelId):{}),B=E(()=>{if(t.tokenData)return t.tokenData.totalTokens;const l=t.costEstimate?.inputTokens?.avgTokens??t.getInputTokensForModel?.(t.selectedModel);return l==null?null:l*(t.totalCalls??1)}),N=E(()=>{const l=t.getOutputTokensForModel?.(t.selectedModel);return t.costEstimate?.outputTokens&&t.tokenData?t.costEstimate.outputTokens*t.tokenData.combinationCount:l??null}),R=E(()=>{if(t.tokenData)return 10*t.tokenData.combinationCount;const l=t.totalCalls;return l==null?null:10*l}),D=E(()=>t.getOutputTokensForModel?.(t.selectedModel)??null);function z(l){if(!l)return;l.provider,l.modelId,t.mode,t.mode==="trial"&&(S.value=l.displayName),Object.keys(v).forEach(r=>delete v[r]),Object.keys(C).forEach(r=>delete C[r]);const a=x(l.provider,l.modelId);if(t.initialParameters&&Object.keys(t.initialParameters).length>0){t.initialParameters,Object.assign(v,t.initialParameters);for(const[r,o]of Object.entries(t.initialParameters)){const u=a[r];o===u?.default?C[r]={mode:"default"}:C[r]={mode:"custom",value:o}}}else{for(const[r,o]of Object.entries(a))o.required?o.default!==void 0?(C[r]={mode:"default"},v[r]=o.default,o.default):(C[r]={mode:"custom",value:null},v[r]=null):o.default!==void 0?(C[r]={mode:"default"},v[r]=o.default,o.default):(C[r]={mode:"unset"},v[r]=null);({...v},{...C})}}te(()=>t.selectedModel,l=>{z(l),F.value=""},{immediate:!0}),te(v,()=>{F.value=""},{deep:!0}),de(()=>{t.selectedModel&&z(t.selectedModel)});function e(l,a){const r=C[l],o=v[l];return r?.mode,a.default,!a.required&&(o==null||o==="")||r?.mode==="unset"?"Not set (parameter will be omitted)":a.default!==void 0?r?.mode==="default"?`Using default: ${a.default}`:`Default: ${a.default} (enter to override)`:a.required?"Required - enter value":"Enter value (optional)"}function i(l){const a=C[l],r=t.selectedModel?x(t.selectedModel.provider,t.selectedModel.modelId)[l]:void 0;if(r?.required&&a?.mode==="unset"||r?.required&&a?.mode==="custom"&&!a.value)return"error";if(a?.mode==="default")return"warning"}function g(l){return l.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function T(l,a,r){!r&&t.selectedModel&&(r=x(t.selectedModel.provider,t.selectedModel.modelId)[l]),r?.required,a==null||a===""?r?.required?r.default!==void 0&&(v[l]=r.default,C[l]={mode:"default"},r.default):(v[l]=null,C[l]={mode:"unset"}):(v[l]=a,a===r?.default?C[l]={mode:"default"}:C[l]={mode:"custom",value:a});const o=K({...v});O("parameters-changed",o)}function K(l){const a={...l};return Object.keys(a).filter(o=>o.includes(".")).forEach(o=>{const u=o.split(".")[0];u in a&&(a[u]===null||a[u]===void 0)&&delete a[u]}),a}function G(){const l=[],a=t.selectedModel?x(t.selectedModel.provider,t.selectedModel.modelId):{};for(const[r,o]of Object.entries(C)){const u=a[r];u?.required&&(o.mode==="unset"?l.push(`${g(r)} is required`):o.mode==="custom"&&(o.value===null||o.value===void 0||o.value==="")&&l.push(`${g(r)} needs a value`)),o.mode==="custom"&&o.value!==void 0&&o.value!==null&&(u?.min!==void 0&&o.value<u.min&&l.push(`${g(r)} must be >= ${u.min}`),u?.max!==void 0&&o.value>u.max&&l.push(`${g(r)} must be <= ${u.max}`))}return{valid:l.length===0,errors:l}}function H(){if(!t.selectedModel||t.mode==="trial"&&!S.value)return null;const l={},a=x(t.selectedModel.provider,t.selectedModel.modelId),r=(o,u,k)=>{const y=u.split(".");let V=o;for(let A=0;A<y.length-1;A++)V[y[A]]||(V[y[A]]={}),V=V[y[A]];V[y[y.length-1]]=k};for(const[o,u]of Object.entries(C)){const k=a[o];let y;switch(u.mode){case"default":y=k?.default;break;case"custom":y=u.value;break;case"unset":continue}y!=null&&y!==""?r(l,o,y):y===!1?r(l,o,!1):k?.required&&q.error(`Required parameter ${o} has no valid value`)}return{name:t.mode==="trial"?S.value:t.selectedModel.displayName,provider:t.selectedModel.provider,modelId:t.selectedModel.modelId,parameters:l}}function X(){F.value="";const l=G();if(!l.valid){F.value=`Invalid configuration: ${l.errors.join(", ")}`;return}const a=H();if(a){if(t.existingConfigurations&&t.existingConfigurations.some(o=>o.provider===a.provider&&o.modelId===a.modelId&&JSON.stringify(o.parameters)===JSON.stringify(a.parameters))){F.value=`${a.provider}:${a.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}O("add-configuration",a)}}return(l,a)=>{const r=oe,o=Pe,u=xe,k=Ve,y=Fe,V=De,A=Se,ne=Ie,se=we,le=Oe,ae=pe,fe=ce,ve=qe,ge=Ee;return s(),f("div",Et,[c("div",Ut,[c("div",At,[c("h3",null,b(l.mode==="trial"?"Configure":"Model Parameters")+": "+b(l.selectedModel.displayName),1),l.showCloseButton?(s(),M(r,{key:0,type:"text",onClick:a[0]||(a[0]=d=>l.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:_(()=>[P(J(Te))]),_:1})):h("",!0)]),l.mode==="trial"?(s(),f("div",zt,[P(me,{model:l.selectedModel,mode:"range","input-tokens":B.value,"output-tokens":N.value,"min-output-tokens":R.value,"max-output-tokens":D.value,layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens","min-output-tokens","max-output-tokens"]),l.totalCalls>1?(s(),f("span",Kt,"("+b(l.totalCalls)+" calls total)",1)):h("",!0)])):h("",!0)]),c("div",Rt,[P(ve,{layout:"vertical"},{default:_(()=>[l.mode==="trial"?(s(),M(u,{key:0,label:"Configuration Name",required:""},{default:_(()=>[P(o,{value:S.value,"onUpdate:value":a[1]||(a[1]=d=>S.value=d),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):h("",!0),P(fe,{"default-active-key":["basic"],ghost:""},{default:_(()=>[P(ae,{key:"basic",header:"Basic Parameters"},{default:_(()=>[P(le,{gutter:16},{default:_(()=>[(s(!0),f(j,null,Y(U.value,(d,p)=>(s(),M(se,{key:p,span:l.mode==="playground"?24:12},{default:_(()=>[P(u,null,{label:_(()=>[c("span",null,b(g(p)),1),d.required?(s(),M(k,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:_(()=>a[2]||(a[2]=[I("Required")])),_:1,__:[2]})):C[p]?.mode==="default"?(s(),M(k,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:_(()=>a[3]||(a[3]=[I("Default")])),_:1,__:[3]})):C[p]?.mode==="unset"?(s(),M(k,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:_(()=>a[4]||(a[4]=[I("Not Set")])),_:1,__:[4]})):h("",!0)]),default:_(()=>[d.type==="number"?(s(),M(y,{key:0,value:v[p],"onUpdate:value":m=>v[p]=m,min:d.min,max:d.max,step:.1,placeholder:e(p,d),"allow-clear":!d.required,status:i(p),style:{width:"100%"},size:"large",onChange:m=>T(p,m,d)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):d.type==="integer"?(s(),M(y,{key:1,value:v[p],"onUpdate:value":m=>v[p]=m,min:d.min,max:d.max,placeholder:e(p,d),"allow-clear":!d.required,status:i(p),style:{width:"100%"},size:"large",onChange:m=>T(p,m,d)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):d.type==="boolean"?(s(),M(V,{key:2,checked:v[p],"onUpdate:checked":m=>v[p]=m,"checked-children":"true","un-checked-children":"false",onChange:m=>T(p,m,d)},null,8,["checked","onUpdate:checked","onChange"])):d.type==="string"&&d.enum?(s(),M(ne,{key:3,value:v[p],"onUpdate:value":m=>v[p]=m,placeholder:d.default?`Default: ${d.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!d.required,status:i(p),onChange:m=>T(p,m,d)},{default:_(()=>[d.default?(s(),M(A,{key:0,value:d.default},{default:_(()=>[I(b(d.default)+" (default) ",1)]),_:2},1032,["value"])):h("",!0),d.required?h("",!0):(s(),M(A,{key:1,value:void 0},{default:_(()=>a[5]||(a[5]=[c("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(s(!0),f(j,null,Y(d.enum.filter(m=>m!==d.default),m=>(s(),M(A,{key:m,value:m},{default:_(()=>[I(b(m),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status","onChange"])):(s(),M(o,{key:4,value:v[p],"onUpdate:value":m=>v[p]=m,placeholder:e(p,d),"allow-clear":!d.required,status:i(p),size:"large",onChange:m=>T(p,m,d)},null,8,["value","onUpdate:value","placeholder","allow-clear","status","onChange"])),c("div",Nt,b(d.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(W.value).length>0?(s(),M(ae,{key:"advanced",header:"Advanced Parameters"},{default:_(()=>[P(le,{gutter:16},{default:_(()=>[(s(!0),f(j,null,Y(W.value,(d,p)=>(s(),M(se,{key:p,span:l.mode==="playground"?24:12},{default:_(()=>[P(u,null,{label:_(()=>[c("span",null,b(g(p)),1),d.required?(s(),M(k,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:_(()=>a[6]||(a[6]=[I("Required")])),_:1,__:[6]})):C[p]?.mode==="default"?(s(),M(k,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:_(()=>a[7]||(a[7]=[I("Default")])),_:1,__:[7]})):C[p]?.mode==="unset"?(s(),M(k,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:_(()=>a[8]||(a[8]=[I("Not Set")])),_:1,__:[8]})):h("",!0)]),default:_(()=>[d.type==="number"||d.type==="integer"?(s(),M(y,{key:0,value:v[p],"onUpdate:value":m=>v[p]=m,min:d.min,max:d.max,step:d.type==="number"?.1:1,placeholder:e(p,d),"allow-clear":!d.required,status:i(p),style:{width:"100%"},size:"large",onChange:m=>T(p,m,d)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):d.type==="boolean"?(s(),M(V,{key:1,checked:v[p],"onUpdate:checked":m=>v[p]=m,"checked-children":"true","un-checked-children":"false",onChange:m=>T(p,m,d)},null,8,["checked","onUpdate:checked","onChange"])):d.type==="string"&&d.enum?(s(),M(ne,{key:2,value:v[p],"onUpdate:value":m=>v[p]=m,placeholder:d.default?`Default: ${d.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!d.required,status:i(p),onChange:m=>T(p,m,d)},{default:_(()=>[d.default?(s(),M(A,{key:0,value:d.default},{default:_(()=>[I(b(d.default)+" (default) ",1)]),_:2},1032,["value"])):h("",!0),d.required?h("",!0):(s(),M(A,{key:1,value:void 0},{default:_(()=>a[9]||(a[9]=[c("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(s(!0),f(j,null,Y(d.enum.filter(m=>m!==d.default),m=>(s(),M(A,{key:m,value:m},{default:_(()=>[I(b(m),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status","onChange"])):(s(),M(o,{key:3,value:v[p],"onUpdate:value":m=>v[p]=m,placeholder:e(p,d),"allow-clear":!d.required,status:i(p),size:"large",onChange:m=>T(p,m,d)},null,8,["value","onUpdate:value","placeholder","allow-clear","status","onChange"])),c("div",Bt,b(d.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):h("",!0)]),_:1})]),_:1})]),l.mode==="trial"?(s(),f("div",Gt,[F.value?(s(),f("div",jt,[P(ge,{message:F.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):h("",!0),P(r,{type:"primary",size:"large",onClick:X,disabled:!S.value||!l.selectedModel},{default:_(()=>a[10]||(a[10]=[I(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):h("",!0)])}}}),Wt=ee(Lt,[["__scopeId","data-v-952d98c3"]]),Jt={class:"modal-content-wrapper"},Qt={key:0,class:"loading-container"},Yt={key:1,class:"no-models-container"},Ht={class:"no-models-content"},Xt={key:2,class:"modal-content"},Zt={class:"models-panel"},eo={class:"models-list"},to=Z({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(L,{emit:n}){const t=L,O=n,$=ke(),{enabledModels:w,loading:x}=he(),{requiresApiKey:S,getProviderGroup:v,getUIDefaults:C}=re(),{hasApiKey:F}=$e(),{estimateCost:U,estimateTotalCost:W}=ye(),B=E(()=>w.value||[]),N=E(()=>{const o=B.value.length>0;return x.value&&!o}),R=Q(""),D=Q(null),z=Q(null),e=Q({}),i=E(()=>{if(!B.value)return{};let o=B.value;if(R.value){const k=R.value.toLowerCase();o=o.filter(y=>y.displayName.toLowerCase().includes(k)||y.modelId.toLowerCase().includes(k))}const u={};for(const k of o)u[k.provider]||(u[k.provider]=[]),u[k.provider].push(k);for(const k in u)u[k].sort((y,V)=>y.displayName.localeCompare(V.displayName));return u}),g=E(()=>{if(t.mode!=="trial")return 1;if(t.trialContext)return t.trialContext.totalCombinations;if(t.design){let o=1;for(const u of Object.values(t.design.variableBindings))u.type==="direct"&&(o*=u.values?.length||1);return o}return 1});te([D,e],async()=>{if(!D.value||t.mode!=="trial"){z.value=null;return}if(!t.trialContext&&!t.design){z.value=null;return}try{const o=Object.keys(e.value).length>0?e.value:C(D.value.provider,D.value.modelId);if(t.mode==="trial"&&t.trialContext?.tokenData){const u=W(t.trialContext.tokenData.totalTokens,t.trialContext.tokenData.combinationCount,D.value,o);u.meta.hasValidCost&&u.cost.total.expected>0?z.value={inputTokens:{avgTokens:t.trialContext.tokenData.perCallAverage},outputTokens:u.tokens.output.expected,totalCost:u.cost.total.expected,inputCost:u.cost.input,outputCost:u.cost.output.expected,costRange:{min:u.cost.total.min,max:u.cost.total.max,expected:u.cost.total.expected}}:z.value=null}else{const u=a(D.value);if(u===null){z.value=null;return}const k=U(u,D.value,o);k.meta.hasValidCost&&k.cost.total.expected>0?z.value={inputTokens:{avgTokens:u},outputTokens:k.tokens.output.expected,totalCost:k.cost.total.expected,inputCost:k.cost.input,outputCost:k.cost.output.expected,costRange:{min:k.cost.total.min,max:k.cost.total.max,expected:k.cost.total.expected}}:z.value=null}}catch(o){q.error("Failed to calculate cost estimate:",o),z.value=null}},{deep:!0});function T(){O("update:visible",!1),$.push("/models")}function K(o){if(D.value=o,t.mode==="trial"&&(e.value={}),t.mode==="playground"){O("select-model",o),O("update:visible",!1);return}}function G(o){q.debug("GenericModelSelectorModalV3: Parameters changed",o),e.value={...o}}function H(o){q.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:o,mode:t.mode}),t.mode==="single"?(O("confirm",{model:D.value,configuration:o}),O("update:visible",!1)):O("add-configuration",o)}function X(o){O("select-model",o),O("update:visible",!1)}function l(){D.value=null}function a(o){return t.mode==="trial"?t.trialContext&&t.trialContext.tokenData?t.trialContext.tokenData.totalTokens:t.design?.tokenEstimate?.avgTokens?t.design.tokenEstimate.avgTokens*g.value:null:1e3}function r(o){if(t.mode==="trial"){const u=Object.keys(e.value).length>0?e.value:C(o.provider,o.modelId),k=["max_tokens","max_completion_tokens","max_output_tokens","num_predict","maxTokens"];let y=null;for(const V of k)if(u[V]!==void 0&&u[V]!==null&&u[V]>0){y=u[V];break}return y===null?null:t.trialContext?.tokenData?y*t.trialContext.tokenData.combinationCount:y*g.value}return 1e3}return te(()=>t.visible,o=>{o&&(D.value=null,R.value="",e.value={},q.debug("GenericModelSelectorModalV3 opened - reset selection"))}),de(()=>{q.debug("GenericModelSelectorModalV3 mounted",{mode:t.mode,visible:t.visible})}),(o,u)=>{const k=Ae,y=oe,V=Ue;return s(),M(V,{open:o.visible,onCancel:u[1]||(u[1]=A=>o.$emit("update:visible",!1)),title:o.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:_(()=>[c("div",Jt,[N.value?(s(),f("div",Qt,[P(k,{size:"large",tip:"Loading models..."})])):B.value.length===0?(s(),f("div",Yt,[c("div",Ht,[P(J(ze),{class:"no-models-icon"}),u[3]||(u[3]=c("h3",null,"No Models Available",-1)),u[4]||(u[4]=c("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),P(y,{type:"primary",size:"large",onClick:T},{default:_(()=>[P(J(Ke)),u[2]||(u[2]=I(" Go to Models View "))]),_:1,__:[2]})])])):(s(),f("div",Xt,[c("div",Zt,[P(je,{modelValue:R.value,"onUpdate:modelValue":u[0]||(u[0]=A=>R.value=A)},null,8,["modelValue"]),c("div",eo,[P(qt,{"grouped-models":i.value,"selected-model-id":D.value?.id,mode:o.mode,"get-input-tokens-for-model":a,"get-output-tokens-for-model":r,"has-config-panel":!!D.value,"requires-api-key":J(S),"get-provider-group":J(v),"has-api-key":J(F),onSelectModel:K},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),D.value&&o.mode==="trial"?(s(),M(Wt,{key:0,"selected-model":D.value,mode:o.mode,"total-calls":g.value,"cost-estimate":z.value,"token-data":o.trialContext?.tokenData,"get-input-tokens-for-model":a,"get-output-tokens-for-model":r,"existing-configurations":o.existingConfigurations,onClose:l,onAddConfiguration:H,onConfirmSelection:X,onParametersChanged:G},null,8,["selected-model","mode","total-calls","cost-estimate","token-data","existing-configurations"])):h("",!0)]))])]),_:1},8,["open","title"])}}}),io=ee(to,[["__scopeId","data-v-11663c6f"]]);export{io as G,me as M};

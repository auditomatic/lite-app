import{d as H,f as y,w as ae,$ as g,Z as e,Y as p,S as l,k as t,G as i,V as r,R as N,_ as f,l as C,u as x,a2 as ge,c as Q,o as be,X as ke,F as he,W as Te}from"./vue-vendor-Cg89ltm_.js";import{u as le}from"./parser.store-DS33XZVo.js";import{M as ne,a5 as we,T as oe,a6 as Ce,N as xe,t as Pe,w as Re,I as Se,m as ue,P as q,a7 as $e,a8 as Ie,a2 as re,a9 as Me,aa as Be,W as ie,ab as de,ac as ce,z as Ee,ad as Ne,R as Oe,k,V as Fe,_ as Ve,u as ze,v as Ue,ae as De,X as je,Y as Ae,J as Je}from"./ui-vendor-COTxn_WH.js";import{h as ee}from"./index-BbRRImK4.js";import"./utils-vendor-BXgHPvEJ.js";import"./data-vendor-lJS7wsn4.js";const Qe={class:"parser-tester"},Ke={class:"parser-info"},We={class:"manual-test"},Xe={key:0,class:"test-result"},Ye={class:"result-value"},Ge={style:{color:"#ff4d4f"}},Le={key:0,class:"metadata"},Ze={class:"test-cases"},qe={key:1,class:"test-summary"},He={class:"stat-item"},et={class:"stat-value"},tt={class:"stat-item"},st={class:"stat-value",style:{color:"#52c41a"}},at={class:"stat-item"},lt={class:"stat-value",style:{color:"#ff4d4f"}},nt={class:"stat-item"},ot={class:"stat-value"},ut={class:"benchmark"},rt={key:0,class:"benchmark-result"},it={class:"stat-item"},dt={class:"stat-value"},ct={class:"stat-item"},pt={class:"stat-value"},_t={class:"stat-item"},mt={class:"stat-value"},vt={class:"stat-item"},ft={class:"stat-value"},yt={class:"tester-actions"},gt=H({__name:"ParserTester",props:{visible:{type:Boolean},parser:{}},emits:["close"],setup(W,{emit:D}){const d=W,S=D,$=le(),O=y(d.visible),K=y("manual"),T=y(!1),F=y(!1),I=y(""),M=y(""),_=y(null),b=y([]),V=y(""),j=y(100),w=y(null),X=[{title:"Name",dataIndex:["testCase","name"],key:"name",width:"20%"},{title:"Status",key:"status",width:"10%",slots:{customRender:"status"}},{title:"Input",dataIndex:["testCase","input"],key:"input",width:"25%",ellipsis:!0},{title:"Expected",key:"expected",width:"15%",slots:{customRender:"expected"}},{title:"Actual",key:"actual",width:"15%",slots:{customRender:"actual"}},{title:"Message",key:"message",width:"15%",slots:{customRender:"message"}}];function Y(a){switch(a){case"regex":return"blue";case"javascript":return"orange";case"python":return"green";default:return"default"}}function z(a){if(a===void 0)return"undefined";if(a===null)return"null";if(typeof a=="object")try{return JSON.stringify(a,null,2)}catch{return String(a)}return String(a)}function c(a,s){let m=s;if(d.parser.outputType==="number")m=parseFloat(s);else if(d.parser.outputType==="boolean")m=s==="true";else if(d.parser.outputType==="json")try{m=JSON.parse(s)}catch{}return typeof a=="number"&&typeof m=="number"?Math.abs(a-m)<1e-4:typeof a=="object"&&typeof m=="object"?JSON.stringify(a)===JSON.stringify(m):a===m}async function o(a){try{await navigator.clipboard.writeText(z(a)),k.success("Value copied to clipboard")}catch{k.error("Failed to copy value")}}async function B(){if(!I.value){k.warning("Please enter some content to test");return}T.value=!0,_.value=null;try{const a=await $.executeParser(I.value,d.parser.id);_.value=a}catch(a){k.error("Test failed: "+(a instanceof Error?a.message:"Unknown error"))}finally{T.value=!1}}async function G(){if(!d.parser.testCases?.length){k.warning("No test cases defined");return}T.value=!0,b.value=[];try{const a=await $.testParser(d.parser,"");b.value=a}catch(a){k.error("Tests failed: "+(a instanceof Error?a.message:"Unknown error"))}finally{T.value=!1}}async function A(){if(!V.value){k.warning("Please enter content for benchmarking");return}F.value=!0,w.value=null;try{const a=[],s=performance.now();for(let v=0;v<j.value;v++){const h=performance.now();await $.testParser(d.parser,V.value);const U=performance.now();a.push(U-h)}const m=performance.now();w.value={totalTime:Math.round(m-s),avgTime:a.reduce((v,h)=>v+h,0)/a.length,minTime:Math.min(...a),maxTime:Math.max(...a)}}catch(a){k.error("Benchmark failed: "+(a instanceof Error?a.message:"Unknown error"))}finally{F.value=!1}}function E(){S("close")}return ae(()=>d.visible,a=>{O.value=a}),ae(O,a=>{a||S("close")}),(a,s)=>{const m=oe,v=we,h=Ce,U=Re,n=Pe,P=Se,J=ue,te=$e,L=Ie,pe=Be,_e=Me,Z=xe,me=ie,R=ce,se=de,ve=Ee,fe=Oe,ye=ne;return p(),g(ye,{visible:O.value,"onUpdate:visible":s[6]||(s[6]=u=>O.value=u),title:`Test Parser: ${a.parser.name}`,width:"70%",footer:null,onCancel:E},{default:e(()=>[l("div",Qe,[l("div",Ke,[t(h,{column:3,size:"small",bordered:""},{default:e(()=>[t(v,{label:"Type"},{default:e(()=>[t(m,{color:Y(a.parser.type)},{default:e(()=>[i(r(a.parser.type.toUpperCase()),1)]),_:1},8,["color"])]),_:1}),t(v,{label:"Output Type"},{default:e(()=>[t(m,null,{default:e(()=>[i(r(a.parser.outputType),1)]),_:1})]),_:1}),t(v,{label:"Test Cases"},{default:e(()=>[i(r(a.parser.testCases?.length||0),1)]),_:1})]),_:1})]),t(fe,{activeKey:K.value,"onUpdate:activeKey":s[5]||(s[5]=u=>K.value=u)},{default:e(()=>[t(Z,{key:"manual",tab:"Manual Test"},{default:e(()=>[l("div",We,[t(n,{label:"Input Content"},{default:e(()=>[t(U,{value:I.value,"onUpdate:value":s[0]||(s[0]=u=>I.value=u),placeholder:"Enter or paste content to test the parser...",rows:8,style:{"font-family":"monospace","font-size":"12px"}},null,8,["value"])]),_:1}),t(n,{label:"Expected Result (Optional)"},{default:e(()=>[t(P,{value:M.value,"onUpdate:value":s[1]||(s[1]=u=>M.value=u),placeholder:"Enter expected result for comparison"},null,8,["value"])]),_:1}),t(J,{type:"primary",onClick:B,loading:T.value,icon:C(x(q))},{default:e(()=>s[7]||(s[7]=[i(" Run Test ")])),_:1,__:[7]},8,["loading","icon"]),_.value?(p(),N("div",Xe,[t(te,null,{default:e(()=>s[8]||(s[8]=[i("Result")])),_:1,__:[8]}),t(h,{column:1,bordered:""},{default:e(()=>[t(v,{label:"Status"},{default:e(()=>[t(L,{status:_.value.success?"success":"error",text:_.value.success?"Success":"Failed"},null,8,["status","text"])]),_:1}),_.value.success?(p(),g(v,{key:0,label:"Extracted Value"},{default:e(()=>[l("div",Ye,[l("code",null,r(z(_.value.value)),1),t(J,{size:"small",onClick:s[2]||(s[2]=u=>o(_.value.value)),icon:C(x(re))},null,8,["icon"])])]),_:1})):f("",!0),_.value.refused?(p(),g(v,{key:1,label:"Refused"},{default:e(()=>[t(m,{color:"warning"},{default:e(()=>s[9]||(s[9]=[i("Response Refused")])),_:1,__:[9]})]),_:1})):f("",!0),_.value.error?(p(),g(v,{key:2,label:"Error"},{default:e(()=>[l("span",Ge,r(_.value.error),1)]),_:1})):f("",!0),t(v,{label:"Execution Time"},{default:e(()=>[i(r(_.value.executionTimeMs||0)+"ms ",1)]),_:1}),M.value&&_.value.success?(p(),g(v,{key:3,label:"Match Expected"},{default:e(()=>[t(L,{status:c(_.value.value,M.value)?"success":"error",text:c(_.value.value,M.value)?"Match":"No Match"},null,8,["status","text"])]),_:1})):f("",!0)]),_:1}),_.value.metadata?(p(),N("div",Le,[t(_e,null,{default:e(()=>[t(pe,{key:"metadata",header:"Metadata"},{default:e(()=>[l("pre",null,r(JSON.stringify(_.value.metadata,null,2)),1)]),_:1})]),_:1})])):f("",!0)])):f("",!0)])]),_:1}),t(Z,{key:"cases",tab:"Test Cases",disabled:!a.parser.testCases?.length},{default:e(()=>[l("div",Ze,[t(J,{type:"primary",onClick:G,loading:T.value,icon:C(x(q)),style:{"margin-bottom":"16px"}},{default:e(()=>s[10]||(s[10]=[i(" Run All Test Cases ")])),_:1,__:[10]},8,["loading","icon"]),b.value.length>0?(p(),g(me,{key:0,columns:X,"data-source":b.value,pagination:!1,"row-key":"name"},{status:e(({record:u})=>[t(L,{status:u.passed?"success":"error",text:u.passed?"Passed":"Failed"},null,8,["status","text"])]),actual:e(({record:u})=>[l("code",null,r(z(u.result.value)),1)]),expected:e(({record:u})=>[l("code",null,r(z(u.testCase.expected)),1)]),message:e(({record:u})=>[l("span",{style:ge({color:u.passed?"#52c41a":"#ff4d4f"})},r(u.message),5)]),_:1},8,["data-source"])):f("",!0),b.value.length>0?(p(),N("div",qe,[t(se,{gutter:16},{default:e(()=>[t(R,{span:6},{default:e(()=>[l("div",He,[s[11]||(s[11]=l("div",{class:"stat-label"},"Total",-1)),l("div",et,r(b.value.length),1)])]),_:1}),t(R,{span:6},{default:e(()=>[l("div",tt,[s[12]||(s[12]=l("div",{class:"stat-label"},"Passed",-1)),l("div",st,r(b.value.filter(u=>u.passed).length),1)])]),_:1}),t(R,{span:6},{default:e(()=>[l("div",at,[s[13]||(s[13]=l("div",{class:"stat-label"},"Failed",-1)),l("div",lt,r(b.value.filter(u=>!u.passed).length),1)])]),_:1}),t(R,{span:6},{default:e(()=>[l("div",nt,[s[14]||(s[14]=l("div",{class:"stat-label"},"Success Rate",-1)),l("div",ot,r(Math.round(b.value.filter(u=>u.passed).length/b.value.length*100))+"% ",1)])]),_:1})]),_:1})])):f("",!0)])]),_:1},8,["disabled"]),t(Z,{key:"benchmark",tab:"Benchmark"},{default:e(()=>[l("div",ut,[t(n,{label:"Sample Content"},{default:e(()=>[t(U,{value:V.value,"onUpdate:value":s[3]||(s[3]=u=>V.value=u),placeholder:"Enter content for benchmarking...",rows:6},null,8,["value"])]),_:1}),t(n,{label:"Iterations"},{default:e(()=>[t(ve,{value:j.value,"onUpdate:value":s[4]||(s[4]=u=>j.value=u),min:1,max:1e4,step:10},null,8,["value"])]),_:1}),t(J,{type:"primary",onClick:A,loading:F.value,icon:C(x(Ne))},{default:e(()=>s[15]||(s[15]=[i(" Run Benchmark ")])),_:1,__:[15]},8,["loading","icon"]),w.value?(p(),N("div",rt,[t(te,null,{default:e(()=>s[16]||(s[16]=[i("Benchmark Results")])),_:1,__:[16]}),t(se,{gutter:16},{default:e(()=>[t(R,{span:6},{default:e(()=>[l("div",it,[s[17]||(s[17]=l("div",{class:"stat-label"},"Total Time",-1)),l("div",dt,r(w.value.totalTime)+"ms",1)])]),_:1}),t(R,{span:6},{default:e(()=>[l("div",ct,[s[18]||(s[18]=l("div",{class:"stat-label"},"Average Time",-1)),l("div",pt,r(w.value.avgTime.toFixed(2))+"ms",1)])]),_:1}),t(R,{span:6},{default:e(()=>[l("div",_t,[s[19]||(s[19]=l("div",{class:"stat-label"},"Min Time",-1)),l("div",mt,r(w.value.minTime.toFixed(2))+"ms",1)])]),_:1}),t(R,{span:6},{default:e(()=>[l("div",vt,[s[20]||(s[20]=l("div",{class:"stat-label"},"Max Time",-1)),l("div",ft,r(w.value.maxTime.toFixed(2))+"ms",1)])]),_:1})]),_:1})])):f("",!0)])]),_:1})]),_:1},8,["activeKey"]),l("div",yt,[t(J,{onClick:E},{default:e(()=>s[21]||(s[21]=[i("Close")])),_:1,__:[21]})])])]),_:1},8,["visible","title"])}}}),bt=ee(gt,[["__scopeId","data-v-630d3624"]]),kt={class:"parser-manager"},ht={class:"parser-header"},Tt={class:"parser-filters"},wt={class:"parser-list"},Ct={class:"parser-name"},xt=H({__name:"ParserManager",setup(W){const D=ke(),d=le(),S=y(!1),$=y(void 0),O=Q(()=>d.loading),K=Q(()=>d.filteredParsers),T=Q(()=>d.parserCount),F=Q({get:()=>d.searchQuery,set:c=>d.setSearchQuery(c)}),I=Q({get:()=>d.typeFilter,set:c=>d.setTypeFilter(c)}),M=[{title:"Name",dataIndex:"name",key:"name",width:"25%",slots:{customRender:"name"}},{title:"Type",dataIndex:"type",key:"type",width:"10%",slots:{customRender:"type"}},{title:"Output",dataIndex:"outputType",key:"outputType",width:"10%",slots:{customRender:"outputType"}},{title:"Description",dataIndex:"description",key:"description",width:"25%",ellipsis:!0},{title:"Tags",dataIndex:"tags",key:"tags",width:"15%",slots:{customRender:"tags"}},{title:"Actions",key:"actions",width:"15%",align:"center",slots:{customRender:"actions"}}];function _(c){switch(c){case"regex":return"blue";case"javascript":return"orange";case"python":return"green";default:return"default"}}function b(c){d.setSearchQuery(c)}function V(){D.push("/parsers/new")}function j(c){D.push(`/parsers/${c.id}/edit`)}function w(c){$.value=c,S.value=!0}async function X(c){try{const o=`${c.name} (Copy)`;await d.duplicateParser(c.id,o),k.success("Parser duplicated successfully")}catch{k.error("Failed to duplicate parser")}}async function Y(c){ne.confirm({title:"Delete Parser",content:`Are you sure you want to delete "${c.name}"?`,okText:"Delete",okType:"danger",cancelText:"Cancel",async onOk(){try{await d.deleteParser(c.id),k.success("Parser deleted successfully")}catch(o){k.error(o instanceof Error?o.message:"Failed to delete parser")}}})}function z(){S.value=!1,$.value=void 0}return be(()=>{d.initialize()}),(c,o)=>{const B=ue,G=Ve,A=ce,E=Ue,a=ze,s=oe,m=De,v=de,h=je,U=ie;return p(),N("div",kt,[l("div",ht,[o[3]||(o[3]=l("h2",null,"Parser Manager",-1)),t(B,{type:"primary",onClick:V,icon:C(x(Fe))},{default:e(()=>o[2]||(o[2]=[i(" New Parser ")])),_:1,__:[2]},8,["icon"])]),l("div",Tt,[t(v,{gutter:16},{default:e(()=>[t(A,{span:8},{default:e(()=>[t(G,{value:F.value,"onUpdate:value":o[0]||(o[0]=n=>F.value=n),placeholder:"Search parsers...","allow-clear":"",onSearch:b},null,8,["value"])]),_:1}),t(A,{span:6},{default:e(()=>[t(a,{value:I.value,"onUpdate:value":o[1]||(o[1]=n=>I.value=n),style:{width:"100%"},placeholder:"Filter by type"},{default:e(()=>[t(E,{value:"all"},{default:e(()=>o[4]||(o[4]=[i("All Types")])),_:1,__:[4]}),t(E,{value:"regex"},{default:e(()=>o[5]||(o[5]=[i("Regex")])),_:1,__:[5]}),t(E,{value:"javascript"},{default:e(()=>o[6]||(o[6]=[i("JavaScript")])),_:1,__:[6]}),t(E,{value:"python"},{default:e(()=>o[7]||(o[7]=[i("Python")])),_:1,__:[7]})]),_:1},8,["value"])]),_:1}),t(A,{span:10},{default:e(()=>[t(m,null,{default:e(()=>[t(s,{color:"blue"},{default:e(()=>[i("Total: "+r(T.value.total),1)]),_:1}),t(s,{color:"green"},{default:e(()=>[i("Built-in: "+r(T.value.builtIn),1)]),_:1}),t(s,{color:"orange"},{default:e(()=>[i("Custom: "+r(T.value.user),1)]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",wt,[t(U,{columns:M,"data-source":K.value,loading:O.value,pagination:{pageSize:20,showSizeChanger:!0,showTotal:n=>`Total ${n} parsers`},"row-key":"id"},{name:e(({record:n})=>[l("div",Ct,[l("span",null,r(n.name),1),n.isBuiltIn?(p(),g(s,{key:0,color:"blue",size:"small"},{default:e(()=>o[8]||(o[8]=[i("Built-in")])),_:1,__:[8]})):f("",!0),n.isPublic?(p(),g(s,{key:1,color:"green",size:"small"},{default:e(()=>o[9]||(o[9]=[i("Public")])),_:1,__:[9]})):f("",!0)])]),type:e(({record:n})=>[t(s,{color:_(n.type)},{default:e(()=>[i(r(n.type.toUpperCase()),1)]),_:2},1032,["color"])]),outputType:e(({record:n})=>[t(s,null,{default:e(()=>[i(r(n.outputType),1)]),_:2},1024)]),tags:e(({record:n})=>[t(m,{wrap:""},{default:e(()=>[(p(!0),N(he,null,Te(n.tags.slice(0,3),P=>(p(),g(s,{key:P},{default:e(()=>[i(r(P),1)]),_:2},1024))),128)),n.tags.length>3?(p(),g(s,{key:0},{default:e(()=>[i(" +"+r(n.tags.length-3),1)]),_:2},1024)):f("",!0)]),_:2},1024)]),actions:e(({record:n})=>[t(m,null,{default:e(()=>[t(h,{title:"Test"},{default:e(()=>[t(B,{size:"small",onClick:P=>w(n),icon:C(x(q))},null,8,["onClick","icon"])]),_:2},1024),n.isBuiltIn?f("",!0):(p(),g(h,{key:0,title:"Edit"},{default:e(()=>[t(B,{size:"small",onClick:P=>j(n),icon:C(x(Ae))},null,8,["onClick","icon"])]),_:2},1024)),t(h,{title:"Duplicate"},{default:e(()=>[t(B,{size:"small",onClick:P=>X(n),icon:C(x(re))},null,8,["onClick","icon"])]),_:2},1024),n.isBuiltIn?f("",!0):(p(),g(h,{key:1,title:"Delete"},{default:e(()=>[t(B,{size:"small",danger:"",onClick:P=>Y(n),icon:C(x(Je))},null,8,["onClick","icon"])]),_:2},1024))]),_:2},1024)]),_:1},8,["data-source","loading","pagination"])]),S.value?(p(),g(bt,{key:0,visible:S.value,parser:$.value,onClose:z},null,8,["visible","parser"])):f("",!0)])}}}),Pt=ee(xt,[["__scopeId","data-v-cb2fe35c"]]),Rt={class:"parsers-view"},St=H({__name:"ParsersViewV3",setup(W){return(D,d)=>(p(),N("div",Rt,[t(Pt)]))}}),Ot=ee(St,[["__scopeId","data-v-9b5fa542"]]);export{Ot as default};

var e=Object.defineProperty,t=(t,r,a)=>((t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a)(t,"symbol"!=typeof r?r+"":r,a);import{d as r,r as a,o as s,i as o,b as n,e as i,n as l,f as c,t as d,p as u,g as p,w as m,l as f,F as h,D as v,I as y,q as g,O as _,_ as $,u as b,$ as w,k}from"./vendor-DdqHZeTC.js";import{d as S,_ as E,b as P}from"./index-D607EoCk.js";import{P as x,T as j}from"./TaskDetailModal-bVSQsMTz.js";import{g as C}from"./db-ftwlfnxb.js";import"./apiLogger-wE3EW76_.js";import"./safeJson-BfKuju6h.js";const R=class e{static getInstance(){return e.instance||(e.instance=new e),e.instance}generateExportData(e,t,r){return{metadata:this.generateMetadata(e),run:this.extractRunInfo(e),experiment:this.generateExperimentStats(t,r),results:this.generateResultsData(t,r),cost_analysis:this.generateCostAnalysis(t,r),verification:this.generateVerificationData(t,r.totalCost)}}async exportRunAsJSON(e,t,r){const a=this.generateExportData(e,t,r),s=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),o=`run-${e.id}-export-${(new Date).toISOString().split("T")[0]}.json`;this.downloadBlob(s,o)}async exportRunAsCSV(e,t){const r=this.generateCSVContent(t),a=new Blob([r],{type:"text/csv"}),s=`run-${e.id}-results-${(new Date).toISOString().split("T")[0]}.csv`;this.downloadBlob(a,s)}calculateExportStats(e){const t=e.filter(e=>"completed"===e.status),r=e.filter(e=>"error"===e.status),a=t.length,s=r.length,o=e.length,n=o>0?a/o*100:0,i=o>0?s/o*100:0,l=t.map(e=>e.response_time).filter(e=>null!=e),c=l.length>0?l.reduce((e,t)=>e+t,0)/l.length:0,d=[...new Set(e.map(e=>e.model))],u=e.flatMap(e=>Object.keys(e.variables||{})),p=[...new Set(u)],m=d.map(t=>{const r=e.filter(e=>e.model===t),a=r.filter(e=>"completed"===e.status),s=a.map(e=>e.response_time).filter(e=>null!=e);return{name:t,count:r.length,successRate:r.length>0?a.length/r.length*100:0,avgResponseTime:s.length>0?s.reduce((e,t)=>e+t,0)/s.length:0}}),f=p.map(t=>{const r=e.map(e=>e.variables?.[t]).filter(e=>null!=e);return{name:t,uniqueValues:new Set(r).size}}),h=e.reduce((e,t)=>e+(t.api_call_log?.cost_estimate?.estimated_cost_usd||0),0),v=e.length>0?h/e.length:0;return{successCount:a,errorCount:s,successRate:n,errorRate:i,avgResponseTime:c,uniqueModels:d,availableVariables:p,modelStats:m,variableStats:f,totalCost:h.toFixed(4),avgCostPerTask:v.toFixed(6)}}generateMetadata(e){return{exported_at:(new Date).toISOString(),auditomatic_version:"2.0.0",export_type:"complete_run",reproducible_hash:btoa(JSON.stringify({design_id:e.design_id,parameters:e.parameters}))}}extractRunInfo(e){return{id:e.id,name:e.name,design_id:e.design_id,status:e.status,created_at:e.created_at,updated_at:e.updated_at,parameters:e.parameters}}generateExperimentStats(e,t){return{total_tasks:e.length,completed_tasks:t.successCount,failed_tasks:t.errorCount,success_rate:t.successRate,error_rate:t.errorRate,avg_response_time:t.avgResponseTime,models_used:t.uniqueModels,variables:t.availableVariables}}generateResultsData(e,t){return{tasks:e.map(e=>({id:e.id,model:e.model,status:e.status,variables:e.variables||{},prompt:e.prompt,result:e.result,error:e.error,parsed_results:e.parsed_results,response_time:e.response_time,created_at:e.created_at,completed_at:e.completed_at,api_call_log:e.api_call_log})),summary_statistics:{by_model:t.modelStats,by_variable:t.variableStats}}}generateCostAnalysis(e,t){const r=t.modelStats.map(t=>({model:t.name,total_cost:e.filter(e=>e.model===t.name&&e.api_call_log?.cost_estimate).reduce((e,t)=>e+(t.api_call_log?.cost_estimate.estimated_cost_usd||0),0).toFixed(4)}));return{total_cost:t.totalCost,avg_cost_per_task:t.avgCostPerTask,cost_by_model:r}}generateVerificationData(e,t){return{total_tasks:e.length,tasks_with_api_logs:e.filter(e=>e.api_call_log).length,tasks_with_results:e.filter(e=>e.result).length,tasks_with_errors:e.filter(e=>e.error).length,estimated_total_cost:t}}generateCSVContent(e){if(0===e.length)return"No data to export";const t=new Set;e.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>t.add(e))});const r=Array.from(t).sort(),a=["task_id","model","status","prompt","result","error","response_time","created_at","completed_at","estimated_cost",...r.map(e=>`var_${e}`)],s=e.map(e=>[...[e.id,e.model,e.status,e.prompt?`"${e.prompt.replace(/"/g,'""')}"`:"",e.result?`"${e.result.replace(/"/g,'""')}"`:"",e.error?`"${e.error.replace(/"/g,'""')}"`:"",e.response_time||"",e.created_at,e.completed_at||"",e.api_call_log?.cost_estimate?.estimated_cost_usd||""],...r.map(t=>{const r=e.variables?.[t];return null!=r?String(r):""})]);return[a.join(","),...s.map(e=>e.join(","))].join("\n")}downloadBlob(e,t){const r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}};t(R,"instance");let N=R;const I={class:"run-name"},O={class:"design-name"},T={class:"created-date"},M={class:"progress-info"},D={key:0},V={class:"models-info"},A={class:"actions"},z=["disabled"],q=E(r({__name:"RunSelectionRow",props:{run:{},isSelected:{type:Boolean}},emits:["select","view-results","delete"],setup(e){const t=e,r=a("...");s(async()=>{if(t.run.design_id){const e=await S.designs.get(t.run.design_id);r.value=e?.name||"Unknown"}});const f=o(()=>"completed"===t.run.status||"stopped"===t.run.status),h=o(()=>{if(!t.run.completed_tasks||0===t.run.completed_tasks)return null;const e=t.run.completed_tasks-(t.run.error_count||0);return Math.round(e/t.run.completed_tasks*100)}),v=e=>{const t=new Date(e),r=(new Date).getTime()-t.getTime(),a=Math.floor(r/864e5);return 0===a?t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):1===a?"Yesterday":a<7?`${a}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(e,t)=>(i(),n("div",{class:l(["run-row",{incomplete:!f.value,selected:e.isSelected}]),onClick:t[1]||(t[1]=t=>e.$emit("view-results",e.run))},[c("div",{class:l(["status-dot",`status-${e.run.status}`])},null,2),c("div",I,d(e.run.name),1),c("div",O,d(r.value),1),c("div",T,d(v(e.run.created_at)),1),c("div",M,[u(d(e.run.completed_tasks||0)+"/"+d(e.run.total_tasks||0)+" processed ",1),null!==h.value?(i(),n("span",D,"("+d(h.value)+"%)",1)):p("",!0)]),c("div",V,d(e.run.models.length)+" models ",1),c("div",A,[c("button",{class:"action-btn",disabled:"running"===e.run.status,title:"Delete",onClick:t[0]||(t[0]=m(t=>e.$emit("delete",e.run),["stop"]))}," 🗑️ ",8,z)])],2))}}),[["__scopeId","data-v-ac88a851"]]),F={class:"run-selection-container"},U={class:"grid-header"},L={class:"filter-controls"},K={class:"toggle-control"},B=["checked"],G={class:"sort-control"},J=["value"],H={class:"grid-info"},W={class:"run-count"},Q={key:0,class:"loading-state"},Z={key:1,class:"empty-state"},X={key:0},Y={key:1},ee={key:2,class:"runs-list"},te=E(r({__name:"RunSelectionGrid",props:{runs:{},filteredRuns:{},loading:{type:Boolean},selectedRunId:{},showIncompleteRuns:{type:Boolean},sortBy:{},hasIncompleteRuns:{type:Boolean}},emits:["select-run","view-results","edit-run","delete-run","update:show-incomplete","update:sort-by"],setup:e=>(e,t)=>(i(),n("div",F,[c("div",U,[c("div",L,[c("label",K,[c("input",{type:"checkbox",checked:e.showIncompleteRuns,onChange:t[0]||(t[0]=t=>e.$emit("update:show-incomplete",t.target.checked))},null,40,B),t[3]||(t[3]=c("span",null,"Show incomplete runs",-1))]),c("div",G,[t[5]||(t[5]=c("label",null,"Sort by:",-1)),c("select",{value:e.sortBy,onChange:t[1]||(t[1]=t=>e.$emit("update:sort-by",t.target.value))},t[4]||(t[4]=[f('<option value="created_at" data-v-953cccfe> Most Recent </option><option value="name" data-v-953cccfe> Name </option><option value="updated_at" data-v-953cccfe> Last Updated </option><option value="status" data-v-953cccfe> Status </option><option value="completion" data-v-953cccfe> Completion % </option>',5)]),40,J)])]),c("div",H,[c("span",W,d(e.filteredRuns.length)+" runs",1)])]),e.loading?(i(),n("div",Q,t[6]||(t[6]=[c("div",{class:"spinner"},null,-1),c("p",null,"Loading runs...",-1)]))):0===e.filteredRuns.length?(i(),n("div",Z,[e.showIncompleteRuns?(i(),n("p",X," No runs found ")):(i(),n("p",Y," No completed runs found ")),!e.showIncompleteRuns&&e.hasIncompleteRuns?(i(),n("button",{key:2,class:"btn btn-secondary",onClick:t[2]||(t[2]=t=>e.$emit("update:show-incomplete",!0))}," Show incomplete runs ")):p("",!0)])):(i(),n("div",ee,[(i(!0),n(h,null,v(e.filteredRuns,t=>(i(),y(q,{key:t.id,run:t,"is-selected":e.selectedRunId===t.id,onSelect:r=>e.$emit("select-run",t),onViewResults:r=>e.$emit("view-results",t),onEdit:r=>e.$emit("edit-run",t),onDelete:r=>e.$emit("delete-run",t)},null,8,["run","is-selected","onSelect","onViewResults","onEdit","onDelete"]))),128))]))]))}),[["__scopeId","data-v-953cccfe"]]),re={class:"run-selection-view"},ae={class:"header"},se={class:"header-actions"},oe={key:0,class:"empty-state"},ne={class:"modal-content"},ie={class:"modal-body"},le=E(r({__name:"RunSelectionView",props:{runs:{default:()=>[]},filteredRuns:{default:()=>[]},loading:{type:Boolean,default:!1},selectedRunId:{default:null},showIncompleteRuns:{type:Boolean,default:!1},sortBy:{default:"created_at"},hasIncompleteRuns:{type:Boolean,default:!1}},emits:["select-run","view-results","edit-run","delete-run","create-run","refresh-runs","update:show-incomplete","update:sort-by"],setup(e,{emit:t}){const r=e,s=t,l=a(null),f=o(()=>r.runs.length>0);function h(){s("refresh-runs")}function v(e){l.value=e}function y(){l.value&&(s("delete-run",l.value),l.value=null)}function _(){l.value=null}return(e,t)=>(i(),n("div",re,[c("div",ae,[t[6]||(t[6]=c("h2",null,"Results",-1)),c("div",se,[f.value?(i(),n("button",{key:0,class:"btn btn-sm btn-outline",onClick:h}," 🔄 Refresh ")):p("",!0)])]),g(te,{runs:e.runs,"filtered-runs":e.filteredRuns,loading:e.loading,"selected-run-id":e.selectedRunId,"show-incomplete-runs":e.showIncompleteRuns,"sort-by":e.sortBy,"has-incomplete-runs":e.hasIncompleteRuns,onSelectRun:t[0]||(t[0]=t=>e.$emit("select-run",t)),onViewResults:t[1]||(t[1]=t=>e.$emit("view-results",t)),onEditRun:t[2]||(t[2]=t=>e.$emit("edit-run",t)),onDeleteRun:v,"onUpdate:showIncomplete":t[3]||(t[3]=t=>e.$emit("update:show-incomplete",t)),"onUpdate:sortBy":t[4]||(t[4]=t=>e.$emit("update:sort-by",t))},null,8,["runs","filtered-runs","loading","selected-run-id","show-incomplete-runs","sort-by","has-incomplete-runs"]),e.loading||0!==e.runs.length?p("",!0):(i(),n("div",oe,[t[7]||(t[7]=c("div",{class:"empty-icon"}," 📊 ",-1)),t[8]||(t[8]=c("h3",null,"No runs found",-1)),t[9]||(t[9]=c("p",null,"Create your first run to see results here.",-1)),c("button",{class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("create-run"))}," Create New Run ")])),l.value?(i(),n("div",{key:1,class:"modal-overlay",onClick:m(_,["self"])},[c("div",ne,[c("div",{class:"modal-header"},[t[10]||(t[10]=c("h3",null,"Delete Run",-1)),c("button",{class:"close-btn",onClick:_}," × ")]),c("div",ie,[c("p",null,[t[11]||(t[11]=u("Are you sure you want to delete run ")),c("strong",null,'"'+d(l.value.name)+'"',1),t[12]||(t[12]=u("?"))]),t[13]||(t[13]=c("p",{class:"warning-text"}," This action cannot be undone. ",-1)),c("div",{class:"modal-actions"},[c("button",{class:"btn btn-outline",onClick:_}," Cancel "),c("button",{class:"btn btn-danger",onClick:y}," Delete Run ")])])])])):p("",!0)]))}}),[["__scopeId","data-v-c2de282d"]]),ce={class:"view-mode-controller"},de={class:"view-mode-toggle"},ue={key:0,class:"mode-info"},pe={class:"mode-description"},me=E(r({__name:"ViewModeController",props:{viewMode:{default:"summary"},showModeInfo:{type:Boolean,default:!1}},emits:["update:view-mode"],setup(e,{emit:t}){const r=e,a=t,s=o(()=>({summary:"Overview of key metrics and performance statistics",pivot:"Interactive cross-tabulation analysis",table:"Complete dataset with filtering and export options"}[r.viewMode]));function u(e){e!==r.viewMode&&a("update:view-mode",e)}return(e,t)=>(i(),n("div",ce,[c("div",de,[c("button",{class:l(["btn","btn-sm",{active:"summary"===e.viewMode}]),onClick:t[0]||(t[0]=e=>u("summary"))}," 📊 Summary ",2),c("button",{class:l(["btn","btn-sm",{active:"pivot"===e.viewMode}]),onClick:t[1]||(t[1]=e=>u("pivot"))}," 📈 Pivot ",2),c("button",{class:l(["btn","btn-sm",{active:"table"===e.viewMode}]),onClick:t[2]||(t[2]=e=>u("table"))}," 📋 Raw Data ",2)]),e.showModeInfo?(i(),n("div",ue,[c("span",pe,d(s.value),1)])):p("",!0)]))}}),[["__scopeId","data-v-7d95af6f"]]);var fe={exports:{}},he={},ve={},ye={},ge={},_e={},$e={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class a extends t{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function s(e,...t){const r=[e[0]];let s=0;for(;s<t.length;)i(r,t[s]),r.push(e[++s]);return new a(r)}e._Code=a,e.nil=new a(""),e._=s;const o=new a("+");function n(e,...t){const r=[c(e[0])];let s=0;for(;s<t.length;)r.push(o),i(r,t[s]),r.push(o,c(e[++s]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===o){const r=l(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new a(r)}function i(e,t){var s;t instanceof a?e.push(...t._items):t instanceof r?e.push(t):e.push("number"==typeof(s=t)||"boolean"==typeof s||null===s?s:c(Array.isArray(s)?s.join(","):s))}function l(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof r||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function c(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=n,e.addCodeArg=i,e.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:n`${e}${t}`},e.stringify=function(e){return new a(c(e))},e.safeStringify=c,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new a(`.${t}`):s`[${t}]`},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new a(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)},e.regexpCode=function(e){return new a(e.toString())}}($e);var be={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=$e;class r extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var a,s;(s=a||(e.UsedValueState=a={}))[s.Started=0]="Started",s[s.Completed=1]="Completed",e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof t.Name?e:this.name(e)}name(e){return new t.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}e.Scope=o;class n extends t.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:r,itemIndex:a}){this.value=e,this.scopePath=t._`.${new t.Name(r)}[${a}]`}}e.ValueScopeName=n;const i=t._`\n`;e.ValueScope=class extends o{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?i:t.nil}}get(){return this._scope}name(e){return new n(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const a=this.toName(e),{prefix:s}=a,o=null!==(r=t.key)&&void 0!==r?r:t.ref;let n=this._values[s];if(n){const e=n.get(o);if(e)return e}else n=this._values[s]=new Map;n.set(o,a);const i=this._scope[s]||(this._scope[s]=[]),l=i.length;return i[l]=t.ref,a.setValue(t,{property:s,itemIndex:l}),a}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,r=this._values){return this._reduceValues(r,r=>{if(void 0===r.scopePath)throw new Error(`CodeGen: name "${r}" has no value`);return t._`${e}${r.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(s,o,n={},i){let l=t.nil;for(const c in s){const d=s[c];if(!d)continue;const u=n[c]=n[c]||new Map;d.forEach(s=>{if(u.has(s))return;u.set(s,a.Started);let n=o(s);if(n){const r=this.opts.es5?e.varKinds.var:e.varKinds.const;l=t._`${l}${r} ${s} = ${n};${this.opts._n}`}else{if(!(n=null==i?void 0:i(s)))throw new r(s);l=t._`${l}${n}${this.opts._n}`}u.set(s,a.Completed)})}return l}}}(be),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=$e,r=be;var a=$e;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return a._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return a.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return a.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return a.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return a.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return a.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return a.Name}});var s=be;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(e,t){return this}}class n extends o{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const a=e?r.varKinds.var:this.varKind,s=void 0===this.rhs?"":` = ${this.rhs}`;return`${a} ${this.name}${s};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=C(this.rhs,e,t)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class i extends o{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=C(this.rhs,e,r),this}get names(){return j(this.lhs instanceof t.Name?{}:{...this.lhs.names},this.rhs)}}class l extends i{constructor(e,t,r,a){super(e,r,a),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class c extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class d extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}}class u extends o{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class p extends o{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=C(this.code,e,t),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class m extends o{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let a=r.length;for(;a--;){const s=r[a];s.optimizeNames(e,t)||(R(e,s.names),r.splice(a,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>x(e,t.names),{})}}class f extends m{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class h extends m{}class v extends f{}v.kind="else";class y extends f{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new v(e):e}return t?!1===e?t instanceof y?t:t.nodes:this.nodes.length?this:new y(N(e),t instanceof y?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=C(this.condition,e,t),this}get names(){const e=super.names;return j(e,this.condition),this.else&&x(e,this.else.names),e}}y.kind="if";class g extends f{}g.kind="for";class _ extends g{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=C(this.iteration,e,t),this}get names(){return x(super.names,this.iteration.names)}}class $ extends g{constructor(e,t,r,a){super(),this.varKind=e,this.name=t,this.from=r,this.to=a}render(e){const t=e.es5?r.varKinds.var:this.varKind,{name:a,from:s,to:o}=this;return`for(${t} ${a}=${s}; ${a}<${o}; ${a}++)`+super.render(e)}get names(){const e=j(super.names,this.from);return j(e,this.to)}}class b extends g{constructor(e,t,r,a){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=a}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=C(this.iterable,e,t),this}get names(){return x(super.names,this.iterable.names)}}class w extends f{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}w.kind="func";class k extends m{render(e){return"return "+super.render(e)}}k.kind="return";class S extends f{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,a;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(a=this.finally)||void 0===a||a.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&x(e,this.catch.names),this.finally&&x(e,this.finally.names),e}}class E extends f{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}E.kind="catch";class P extends f{render(e){return"finally"+super.render(e)}}P.kind="finally";function x(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function j(e,r){return r instanceof t._CodeOrName?x(e,r.names):e}function C(e,r,a){return e instanceof t.Name?o(e):(s=e)instanceof t._Code&&s._items.some(e=>e instanceof t.Name&&1===r[e.str]&&void 0!==a[e.str])?new t._Code(e._items.reduce((e,r)=>(r instanceof t.Name&&(r=o(r)),r instanceof t._Code?e.push(...r._items):e.push(r),e),[])):e;var s;function o(e){const t=a[e.str];return void 0===t||1!==r[e.str]?e:(delete r[e.str],t)}}function R(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function N(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:t._`!${M(e)}`}e.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new h]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,a){const s=this._scope.toName(t);return void 0!==r&&a&&(this._constants[s.str]=r),this._leafNode(new n(e,s,r)),s}const(e,t,a){return this._def(r.varKinds.const,e,t,a)}let(e,t,a){return this._def(r.varKinds.let,e,t,a)}var(e,t,a){return this._def(r.varKinds.var,e,t,a)}assign(e,t,r){return this._leafNode(new i(e,t,r))}add(t,r){return this._leafNode(new l(t,e.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==t.nil&&this._leafNode(new p(e)),this}object(...e){const r=["{"];for(const[a,s]of e)r.length>1&&r.push(","),r.push(a),(a!==s||this.opts.es5)&&(r.push(":"),(0,t.addCodeArg)(r,s));return r.push("}"),new t._Code(r)}if(e,t,r){if(this._blockNode(new y(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new y(e))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(y,v)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new _(e),t)}forRange(e,t,a,s,o=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const n=this._scope.toName(e);return this._for(new $(o,n,t,a),()=>s(n))}forOf(e,a,s,o=r.varKinds.const){const n=this._scope.toName(e);if(this.opts.es5){const e=a instanceof t.Name?a:this.var("_arr",a);return this.forRange("_i",0,t._`${e}.length`,r=>{this.var(n,t._`${e}[${r}]`),s(n)})}return this._for(new b("of",o,n,a),()=>s(n))}forIn(e,a,s,o=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,t._`Object.keys(${a})`,s);const n=this._scope.toName(e);return this._for(new b("in",o,n,a),()=>s(n))}endFor(){return this._endBlockNode(g)}label(e){return this._leafNode(new c(e))}break(e){return this._leafNode(new d(e))}return(e){const t=new k;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const a=new S;if(this._blockNode(a),this.code(e),t){const e=this.name("e");this._currNode=a.catch=new E(e),t(e)}return r&&(this._currNode=a.finally=new P,this.code(r)),this._endBlockNode(E,P)}throw(e){return this._leafNode(new u(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,r=t.nil,a,s){return this._blockNode(new w(e,r,a)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(w)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},e.not=N;const I=T(e.operators.AND);e.and=function(...e){return e.reduce(I)};const O=T(e.operators.OR);function T(e){return(r,a)=>r===t.nil?a:a===t.nil?r:t._`${M(r)} ${e} ${M(a)}`}function M(e){return e instanceof t.Name?e:t._`(${e})`}e.or=function(...e){return e.reduce(O)}}(_e);var we={};Object.defineProperty(we,"__esModule",{value:!0}),we.checkStrictMode=we.getErrorPath=we.Type=we.useFunc=we.setEvaluated=we.evaluatedPropsToName=we.mergeEvaluated=we.eachItem=we.unescapeJsonPointer=we.escapeJsonPointer=we.escapeFragment=we.unescapeFragment=we.schemaRefOrVal=we.schemaHasRulesButRef=we.schemaHasRules=we.checkUnknownRules=we.alwaysValidSchema=we.toHash=void 0;const ke=_e,Se=$e;function Ee(e,t=e.schema){const{opts:r,self:a}=e;if(!r.strictSchema)return;if("boolean"==typeof t)return;const s=a.RULES.keywords;for(const o in t)s[o]||Me(e,`unknown keyword: "${o}"`)}function Pe(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function xe(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function je(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Ce({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:a}){return(s,o,n,i)=>{const l=void 0===n?o:n instanceof ke.Name?(o instanceof ke.Name?e(s,o,n):t(s,o,n),n):o instanceof ke.Name?(t(s,n,o),o):r(o,n);return i!==ke.Name||l instanceof ke.Name?l:a(s,l)}}function Re(e,t){if(!0===t)return e.var("props",!0);const r=e.var("props",ke._`{}`);return void 0!==t&&Ne(e,r,t),r}function Ne(e,t,r){Object.keys(r).forEach(r=>e.assign(ke._`${t}${(0,ke.getProperty)(r)}`,!0))}we.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},we.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(Ee(e,t),!Pe(t,e.self.RULES.all))},we.checkUnknownRules=Ee,we.schemaHasRules=Pe,we.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},we.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,a,s){if(!s){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return ke._`${r}`}return ke._`${e}${t}${(0,ke.getProperty)(a)}`},we.unescapeFragment=function(e){return je(decodeURIComponent(e))},we.escapeFragment=function(e){return encodeURIComponent(xe(e))},we.escapeJsonPointer=xe,we.unescapeJsonPointer=je,we.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},we.mergeEvaluated={props:Ce({mergeNames:(e,t,r)=>e.if(ke._`${r} !== true && ${t} !== undefined`,()=>{e.if(ke._`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,ke._`${r} || {}`).code(ke._`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if(ke._`${r} !== true`,()=>{!0===t?e.assign(r,!0):(e.assign(r,ke._`${r} || {}`),Ne(e,r,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:Re}),items:Ce({mergeNames:(e,t,r)=>e.if(ke._`${r} !== true && ${t} !== undefined`,()=>e.assign(r,ke._`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if(ke._`${r} !== true`,()=>e.assign(r,!0===t||ke._`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},we.evaluatedPropsToName=Re,we.setEvaluated=Ne;const Ie={};var Oe,Te;function Me(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}we.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:Ie[t.code]||(Ie[t.code]=new Se._Code(t.code))})},(Te=Oe||(we.Type=Oe={}))[Te.Num=0]="Num",Te[Te.Str=1]="Str",we.getErrorPath=function(e,t,r){if(e instanceof ke.Name){const a=t===Oe.Num;return r?a?ke._`"[" + ${e} + "]"`:ke._`"['" + ${e} + "']"`:a?ke._`"/" + ${e}`:ke._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ke.getProperty)(e).toString():"/"+xe(e)},we.checkStrictMode=Me;var De={};Object.defineProperty(De,"__esModule",{value:!0});const Ve=_e,Ae={data:new Ve.Name("data"),valCxt:new Ve.Name("valCxt"),instancePath:new Ve.Name("instancePath"),parentData:new Ve.Name("parentData"),parentDataProperty:new Ve.Name("parentDataProperty"),rootData:new Ve.Name("rootData"),dynamicAnchors:new Ve.Name("dynamicAnchors"),vErrors:new Ve.Name("vErrors"),errors:new Ve.Name("errors"),this:new Ve.Name("this"),self:new Ve.Name("self"),scope:new Ve.Name("scope"),json:new Ve.Name("json"),jsonPos:new Ve.Name("jsonPos"),jsonLen:new Ve.Name("jsonLen"),jsonPart:new Ve.Name("jsonPart")};De.default=Ae,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=_e,r=we,a=De;function s(e,r){const s=e.const("err",r);e.if(t._`${a.default.vErrors} === null`,()=>e.assign(a.default.vErrors,t._`[${s}]`),t._`${a.default.vErrors}.push(${s})`),e.code(t._`${a.default.errors}++`)}function o(e,r){const{gen:a,validateName:s,schemaEnv:o}=e;o.$async?a.throw(t._`new ${e.ValidationError}(${r})`):(a.assign(t._`${s}.errors`,r),a.return(!1))}e.keywordError={message:({keyword:e})=>t.str`must pass "${e}" keyword validation`},e.keyword$DataError={message:({keyword:e,schemaType:r})=>r?t.str`"${e}" keyword must be ${r} ($data)`:t.str`"${e}" keyword is invalid ($data)`},e.reportError=function(r,a=e.keywordError,n,l){const{it:c}=r,{gen:d,compositeRule:u,allErrors:p}=c,m=i(r,a,n);(null!=l?l:u||p)?s(d,m):o(c,t._`[${m}]`)},e.reportExtraError=function(t,r=e.keywordError,n){const{it:l}=t,{gen:c,compositeRule:d,allErrors:u}=l;s(c,i(t,r,n)),d||u||o(l,a.default.vErrors)},e.resetErrorsCount=function(e,r){e.assign(a.default.errors,r),e.if(t._`${a.default.vErrors} !== null`,()=>e.if(r,()=>e.assign(t._`${a.default.vErrors}.length`,r),()=>e.assign(a.default.vErrors,null)))},e.extendErrors=function({gen:e,keyword:r,schemaValue:s,data:o,errsCount:n,it:i}){if(void 0===n)throw new Error("ajv implementation error");const l=e.name("err");e.forRange("i",n,a.default.errors,n=>{e.const(l,t._`${a.default.vErrors}[${n}]`),e.if(t._`${l}.instancePath === undefined`,()=>e.assign(t._`${l}.instancePath`,(0,t.strConcat)(a.default.instancePath,i.errorPath))),e.assign(t._`${l}.schemaPath`,t.str`${i.errSchemaPath}/${r}`),i.opts.verbose&&(e.assign(t._`${l}.schema`,s),e.assign(t._`${l}.data`,o))})};const n={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function i(e,r,s){const{createErrors:o}=e.it;return!1===o?t._`{}`:function(e,r,s={}){const{gen:o,it:i}=e,d=[l(i,s),c(e,s)];return function(e,{params:r,message:s},o){const{keyword:i,data:l,schemaValue:c,it:d}=e,{opts:u,propertyName:p,topSchemaRef:m,schemaPath:f}=d;o.push([n.keyword,i],[n.params,"function"==typeof r?r(e):r||t._`{}`]),u.messages&&o.push([n.message,"function"==typeof s?s(e):s]);u.verbose&&o.push([n.schema,c],[n.parentSchema,t._`${m}${f}`],[a.default.data,l]);p&&o.push([n.propertyName,p])}(e,r,d),o.object(...d)}(e,r,s)}function l({errorPath:e},{instancePath:s}){const o=s?t.str`${e}${(0,r.getErrorPath)(s,r.Type.Str)}`:e;return[a.default.instancePath,(0,t.strConcat)(a.default.instancePath,o)]}function c({keyword:e,it:{errSchemaPath:a}},{schemaPath:s,parentSchema:o}){let i=o?a:t.str`${a}/${e}`;return s&&(i=t.str`${i}${(0,r.getErrorPath)(s,r.Type.Str)}`),[n.schemaPath,i]}}(ge),Object.defineProperty(ye,"__esModule",{value:!0}),ye.boolOrEmptySchema=ye.topBoolOrEmptySchema=void 0;const ze=ge,qe=_e,Fe=De,Ue={message:"boolean schema is false"};function Le(e,t){const{gen:r,data:a}=e;(0,ze.reportError)({gen:r,keyword:"false schema",data:a,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e},Ue,void 0,t)}ye.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:a}=e;!1===r?Le(e,!1):"object"==typeof r&&!0===r.$async?t.return(Fe.default.data):(t.assign(qe._`${a}.errors`,null),t.return(!0))},ye.boolOrEmptySchema=function(e,t){const{gen:r,schema:a}=e;!1===a?(r.var(t,!1),Le(e)):r.var(t,!0)};var Ke={},Be={};Object.defineProperty(Be,"__esModule",{value:!0}),Be.getRules=Be.isJSONType=void 0;const Ge=new Set(["string","number","integer","boolean","null","object","array"]);Be.isJSONType=function(e){return"string"==typeof e&&Ge.has(e)},Be.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var Je={};function He(e,t){return t.rules.some(t=>We(e,t))}function We(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(Je,"__esModule",{value:!0}),Je.shouldUseRule=Je.shouldUseGroup=Je.schemaHasRulesForType=void 0,Je.schemaHasRulesForType=function({schema:e,self:t},r){const a=t.RULES.types[r];return a&&!0!==a&&He(e,a)},Je.shouldUseGroup=He,Je.shouldUseRule=We,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.reportTypeError=Ke.checkDataTypes=Ke.checkDataType=Ke.coerceAndCheckDataType=Ke.getJSONTypes=Ke.getSchemaTypes=Ke.DataType=void 0;const Qe=Be,Ze=Je,Xe=ge,Ye=_e,et=we;var tt,rt;function at(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(Qe.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}(rt=tt||(Ke.DataType=tt={}))[rt.Correct=0]="Correct",rt[rt.Wrong=1]="Wrong",Ke.getSchemaTypes=function(e){const t=at(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},Ke.getJSONTypes=at,Ke.coerceAndCheckDataType=function(e,t){const{gen:r,data:a,opts:s}=e,o=function(e,t){return t?e.filter(e=>st.has(e)||"array"===t&&"array"===e):[]}(t,s.coerceTypes),n=t.length>0&&!(0===o.length&&1===t.length&&(0,Ze.schemaHasRulesForType)(e,t[0]));if(n){const n=nt(t,a,s.strictNumbers,tt.Wrong);r.if(n,()=>{o.length?function(e,t,r){const{gen:a,data:s,opts:o}=e,n=a.let("dataType",Ye._`typeof ${s}`),i=a.let("coerced",Ye._`undefined`);"array"===o.coerceTypes&&a.if(Ye._`${n} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>a.assign(s,Ye._`${s}[0]`).assign(n,Ye._`typeof ${s}`).if(nt(t,s,o.strictNumbers),()=>a.assign(i,s)));a.if(Ye._`${i} !== undefined`);for(const c of r)(st.has(c)||"array"===c&&"array"===o.coerceTypes)&&l(c);function l(e){switch(e){case"string":return void a.elseIf(Ye._`${n} == "number" || ${n} == "boolean"`).assign(i,Ye._`"" + ${s}`).elseIf(Ye._`${s} === null`).assign(i,Ye._`""`);case"number":return void a.elseIf(Ye._`${n} == "boolean" || ${s} === null
              || (${n} == "string" && ${s} && ${s} == +${s})`).assign(i,Ye._`+${s}`);case"integer":return void a.elseIf(Ye._`${n} === "boolean" || ${s} === null
              || (${n} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(i,Ye._`+${s}`);case"boolean":return void a.elseIf(Ye._`${s} === "false" || ${s} === 0 || ${s} === null`).assign(i,!1).elseIf(Ye._`${s} === "true" || ${s} === 1`).assign(i,!0);case"null":return a.elseIf(Ye._`${s} === "" || ${s} === 0 || ${s} === false`),void a.assign(i,null);case"array":a.elseIf(Ye._`${n} === "string" || ${n} === "number"
              || ${n} === "boolean" || ${s} === null`).assign(i,Ye._`[${s}]`)}}a.else(),lt(e),a.endIf(),a.if(Ye._`${i} !== undefined`,()=>{a.assign(s,i),function({gen:e,parentData:t,parentDataProperty:r},a){e.if(Ye._`${t} !== undefined`,()=>e.assign(Ye._`${t}[${r}]`,a))}(e,i)})}(e,t,o):lt(e)})}return n};const st=new Set(["string","number","integer","boolean","null"]);function ot(e,t,r,a=tt.Correct){const s=a===tt.Correct?Ye.operators.EQ:Ye.operators.NEQ;let o;switch(e){case"null":return Ye._`${t} ${s} null`;case"array":o=Ye._`Array.isArray(${t})`;break;case"object":o=Ye._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=n(Ye._`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=n();break;default:return Ye._`typeof ${t} ${s} ${e}`}return a===tt.Correct?o:(0,Ye.not)(o);function n(e=Ye.nil){return(0,Ye.and)(Ye._`typeof ${t} == "number"`,e,r?Ye._`isFinite(${t})`:Ye.nil)}}function nt(e,t,r,a){if(1===e.length)return ot(e[0],t,r,a);let s;const o=(0,et.toHash)(e);if(o.array&&o.object){const e=Ye._`typeof ${t} != "object"`;s=o.null?e:Ye._`!${t} || ${e}`,delete o.null,delete o.array,delete o.object}else s=Ye.nil;o.number&&delete o.integer;for(const n in o)s=(0,Ye.and)(s,ot(n,t,r,a));return s}Ke.checkDataType=ot,Ke.checkDataTypes=nt;const it={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?Ye._`{type: ${e}}`:Ye._`{type: ${t}}`};function lt(e){const t=function(e){const{gen:t,data:r,schema:a}=e,s=(0,et.schemaRefOrVal)(e,a,"type");return{gen:t,keyword:"type",data:r,schema:a.type,schemaCode:s,schemaValue:s,parentSchema:a,params:{},it:e}}(e);(0,Xe.reportError)(t,it)}Ke.reportTypeError=lt;var ct={};Object.defineProperty(ct,"__esModule",{value:!0}),ct.assignDefaults=void 0;const dt=_e,ut=we;function pt(e,t,r){const{gen:a,compositeRule:s,data:o,opts:n}=e;if(void 0===r)return;const i=dt._`${o}${(0,dt.getProperty)(t)}`;if(s)return void(0,ut.checkStrictMode)(e,`default is ignored for: ${i}`);let l=dt._`${i} === undefined`;"empty"===n.useDefaults&&(l=dt._`${l} || ${i} === null || ${i} === ""`),a.if(l,dt._`${i} = ${(0,dt.stringify)(r)}`)}ct.assignDefaults=function(e,t){const{properties:r,items:a}=e.schema;if("object"===t&&r)for(const s in r)pt(e,s,r[s].default);else"array"===t&&Array.isArray(a)&&a.forEach((t,r)=>pt(e,r,t.default))};var mt={},ft={};Object.defineProperty(ft,"__esModule",{value:!0}),ft.validateUnion=ft.validateArray=ft.usePattern=ft.callValidateCode=ft.schemaProperties=ft.allSchemaProperties=ft.noPropertyInData=ft.propertyInData=ft.isOwnProperty=ft.hasPropFunc=ft.reportMissingProp=ft.checkMissingProp=ft.checkReportMissingProp=void 0;const ht=_e,vt=we,yt=De,gt=we;function _t(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:ht._`Object.prototype.hasOwnProperty`})}function $t(e,t,r){return ht._`${_t(e)}.call(${t}, ${r})`}function bt(e,t,r,a){const s=ht._`${t}${(0,ht.getProperty)(r)} === undefined`;return a?(0,ht.or)(s,(0,ht.not)($t(e,t,r))):s}function wt(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}ft.checkReportMissingProp=function(e,t){const{gen:r,data:a,it:s}=e;r.if(bt(r,a,t,s.opts.ownProperties),()=>{e.setParams({missingProperty:ht._`${t}`},!0),e.error()})},ft.checkMissingProp=function({gen:e,data:t,it:{opts:r}},a,s){return(0,ht.or)(...a.map(a=>(0,ht.and)(bt(e,t,a,r.ownProperties),ht._`${s} = ${a}`)))},ft.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},ft.hasPropFunc=_t,ft.isOwnProperty=$t,ft.propertyInData=function(e,t,r,a){const s=ht._`${t}${(0,ht.getProperty)(r)} !== undefined`;return a?ht._`${s} && ${$t(e,t,r)}`:s},ft.noPropertyInData=bt,ft.allSchemaProperties=wt,ft.schemaProperties=function(e,t){return wt(t).filter(r=>!(0,vt.alwaysValidSchema)(e,t[r]))},ft.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:a,schemaPath:s,errorPath:o},it:n},i,l,c){const d=c?ht._`${e}, ${t}, ${a}${s}`:t,u=[[yt.default.instancePath,(0,ht.strConcat)(yt.default.instancePath,o)],[yt.default.parentData,n.parentData],[yt.default.parentDataProperty,n.parentDataProperty],[yt.default.rootData,yt.default.rootData]];n.opts.dynamicRef&&u.push([yt.default.dynamicAnchors,yt.default.dynamicAnchors]);const p=ht._`${d}, ${r.object(...u)}`;return l!==ht.nil?ht._`${i}.call(${l}, ${p})`:ht._`${i}(${p})`};const kt=ht._`new RegExp`;ft.usePattern=function({gen:e,it:{opts:t}},r){const a=t.unicodeRegExp?"u":"",{regExp:s}=t.code,o=s(r,a);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:ht._`${"new RegExp"===s.code?kt:(0,gt.useFunc)(e,s)}(${r}, ${a})`})},ft.validateArray=function(e){const{gen:t,data:r,keyword:a,it:s}=e,o=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return n(()=>t.assign(e,!1)),e}return t.var(o,!0),n(()=>t.break()),o;function n(s){const n=t.const("len",ht._`${r}.length`);t.forRange("i",0,n,r=>{e.subschema({keyword:a,dataProp:r,dataPropType:vt.Type.Num},o),t.if((0,ht.not)(o),s)})}},ft.validateUnion=function(e){const{gen:t,schema:r,keyword:a,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(e=>(0,vt.alwaysValidSchema)(s,e))&&!s.opts.unevaluated)return;const o=t.let("valid",!1),n=t.name("_valid");t.block(()=>r.forEach((r,s)=>{const i=e.subschema({keyword:a,schemaProp:s,compositeRule:!0},n);t.assign(o,ht._`${o} || ${n}`);e.mergeValidEvaluated(i,n)||t.if((0,ht.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))},Object.defineProperty(mt,"__esModule",{value:!0}),mt.validateKeywordUsage=mt.validSchemaType=mt.funcKeywordCode=mt.macroKeywordCode=void 0;const St=_e,Et=De,Pt=ft,xt=ge;function jt(e){const{gen:t,data:r,it:a}=e;t.if(a.parentData,()=>t.assign(r,St._`${a.parentData}[${a.parentDataProperty}]`))}function Ct(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,St.stringify)(r)})}mt.macroKeywordCode=function(e,t){const{gen:r,keyword:a,schema:s,parentSchema:o,it:n}=e,i=t.macro.call(n.self,s,o,n),l=Ct(r,a,i);!1!==n.opts.validateSchema&&n.self.validateSchema(i,!0);const c=r.name("valid");e.subschema({schema:i,schemaPath:St.nil,errSchemaPath:`${n.errSchemaPath}/${a}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))},mt.funcKeywordCode=function(e,t){var r;const{gen:a,keyword:s,schema:o,parentSchema:n,$data:i,it:l}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(l,t);const c=!i&&t.compile?t.compile.call(l.self,o,n,l):t.validate,d=Ct(a,s,c),u=a.let("valid");function p(r=(t.async?St._`await `:St.nil)){const s=l.opts.passContext?Et.default.this:Et.default.self,o=!("compile"in t&&!i||!1===t.schema);a.assign(u,St._`${r}${(0,Pt.callValidateCode)(e,d,s,o)}`,t.modifying)}function m(e){var r;a.if((0,St.not)(null!==(r=t.valid)&&void 0!==r?r:u),e)}e.block$data(u,function(){if(!1===t.errors)p(),t.modifying&&jt(e),m(()=>e.error());else{const r=t.async?function(){const e=a.let("ruleErrs",null);return a.try(()=>p(St._`await `),t=>a.assign(u,!1).if(St._`${t} instanceof ${l.ValidationError}`,()=>a.assign(e,St._`${t}.errors`),()=>a.throw(t))),e}():function(){const e=St._`${d}.errors`;return a.assign(e,null),p(St.nil),e}();t.modifying&&jt(e),m(()=>function(e,t){const{gen:r}=e;r.if(St._`Array.isArray(${t})`,()=>{r.assign(Et.default.vErrors,St._`${Et.default.vErrors} === null ? ${t} : ${Et.default.vErrors}.concat(${t})`).assign(Et.default.errors,St._`${Et.default.vErrors}.length`),(0,xt.extendErrors)(e)},()=>e.error())}(e,r))}}),e.ok(null!==(r=t.valid)&&void 0!==r?r:u)},mt.validSchemaType=function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e)},mt.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:a},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");const n=s.dependencies;if(null==n?void 0:n.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${o}: ${n.join(",")}`);if(s.validateSchema){if(!s.validateSchema(e[o])){const e=`keyword "${o}" value is invalid at path "${a}": `+r.errorsText(s.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}};var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.extendSubschemaMode=Rt.extendSubschemaData=Rt.getSubschema=void 0;const Nt=_e,It=we;Rt.getSubschema=function(e,{keyword:t,schemaProp:r,schema:a,schemaPath:s,errSchemaPath:o,topSchemaRef:n}){if(void 0!==t&&void 0!==a)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const a=e.schema[t];return void 0===r?{schema:a,schemaPath:Nt._`${e.schemaPath}${(0,Nt.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:a[r],schemaPath:Nt._`${e.schemaPath}${(0,Nt.getProperty)(t)}${(0,Nt.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,It.escapeFragment)(r)}`}}if(void 0!==a){if(void 0===s||void 0===o||void 0===n)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:a,schemaPath:s,topSchemaRef:n,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')},Rt.extendSubschemaData=function(e,t,{dataProp:r,dataPropType:a,data:s,dataTypes:o,propertyName:n}){if(void 0!==s&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:i}=t;if(void 0!==r){const{errorPath:s,dataPathArr:o,opts:n}=t;l(i.let("data",Nt._`${t.data}${(0,Nt.getProperty)(r)}`,!0)),e.errorPath=Nt.str`${s}${(0,It.getErrorPath)(r,a,n.jsPropertySyntax)}`,e.parentDataProperty=Nt._`${r}`,e.dataPathArr=[...o,e.parentDataProperty]}if(void 0!==s){l(s instanceof Nt.Name?s:i.let("data",s,!0)),void 0!==n&&(e.propertyName=n)}function l(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}o&&(e.dataTypes=o)},Rt.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:a,createErrors:s,allErrors:o}){void 0!==a&&(e.compositeRule=a),void 0!==s&&(e.createErrors=s),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r};var Ot={},Tt=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var a,s,o;if(Array.isArray(t)){if((a=t.length)!=r.length)return!1;for(s=a;0!==s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((a=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=a;0!==s--;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=a;0!==s--;){var n=o[s];if(!e(t[n],r[n]))return!1}return!0}return t!=t&&r!=r},Mt={exports:{}},Dt=Mt.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),Vt(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function Vt(e,t,r,a,s,o,n,i,l,c){if(a&&"object"==typeof a&&!Array.isArray(a)){for(var d in t(a,s,o,n,i,l,c),a){var u=a[d];if(Array.isArray(u)){if(d in Dt.arrayKeywords)for(var p=0;p<u.length;p++)Vt(e,t,r,u[p],s+"/"+d+"/"+p,o,s,d,a,p)}else if(d in Dt.propsKeywords){if(u&&"object"==typeof u)for(var m in u)Vt(e,t,r,u[m],s+"/"+d+"/"+At(m),o,s,d,a,m)}else(d in Dt.keywords||e.allKeys&&!(d in Dt.skipKeywords))&&Vt(e,t,r,u,s+"/"+d,o,s,d,a)}r(a,s,o,n,i,l,c)}}function At(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Dt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},Dt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},Dt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},Dt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};var zt=Mt.exports;Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.getSchemaRefs=Ot.resolveUrl=Ot.normalizeId=Ot._getFullPath=Ot.getFullPath=Ot.inlineRef=void 0;const qt=we,Ft=Tt,Ut=zt,Lt=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);Ot.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!Bt(e):!!t&&Gt(e)<=t)};const Kt=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Bt(e){for(const t in e){if(Kt.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(Bt))return!0;if("object"==typeof r&&Bt(r))return!0}return!1}function Gt(e){let t=0;for(const r in e){if("$ref"===r)return 1/0;if(t++,!Lt.has(r)&&("object"==typeof e[r]&&(0,qt.eachItem)(e[r],e=>t+=Gt(e)),t===1/0))return 1/0}return t}function Jt(e,t="",r){!1!==r&&(t=Qt(t));const a=e.parse(t);return Ht(e,a)}function Ht(e,t){return e.serialize(t).split("#")[0]+"#"}Ot.getFullPath=Jt,Ot._getFullPath=Ht;const Wt=/#\/?$/;function Qt(e){return e?e.replace(Wt,""):""}Ot.normalizeId=Qt,Ot.resolveUrl=function(e,t,r){return r=Qt(r),e.resolve(t,r)};const Zt=/^[a-z_][-a-z0-9._]*$/i;Ot.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:r,uriResolver:a}=this.opts,s=Qt(e[r]||t),o={"":s},n=Jt(a,s,!1),i={},l=new Set;return Ut(e,{allKeys:!0},(e,t,a,s)=>{if(void 0===s)return;const u=n+t;let p=o[s];function m(t){const r=this.opts.uriResolver.resolve;if(t=Qt(p?r(p,t):t),l.has(t))throw d(t);l.add(t);let a=this.refs[t];return"string"==typeof a&&(a=this.refs[a]),"object"==typeof a?c(e,a.schema,t):t!==Qt(u)&&("#"===t[0]?(c(e,i[t],t),i[t]=e):this.refs[t]=u),t}function f(e){if("string"==typeof e){if(!Zt.test(e))throw new Error(`invalid anchor "${e}"`);m.call(this,`#${e}`)}}"string"==typeof e[r]&&(p=m.call(this,e[r])),f.call(this,e.$anchor),f.call(this,e.$dynamicAnchor),o[t]=p}),i;function c(e,t,r){if(void 0!==t&&!Ft(e,t))throw d(r)}function d(e){return new Error(`reference "${e}" resolves to more than one schema`)}},Object.defineProperty(ve,"__esModule",{value:!0}),ve.getData=ve.KeywordCxt=ve.validateFunctionCode=void 0;const Xt=ye,Yt=Ke,er=Je,tr=Ke,rr=ct,ar=mt,sr=Rt,or=_e,nr=De,ir=Ot,lr=we,cr=ge;function dr({gen:e,validateName:t,schema:r,schemaEnv:a,opts:s},o){s.code.es5?e.func(t,or._`${nr.default.data}, ${nr.default.valCxt}`,a.$async,()=>{e.code(or._`"use strict"; ${ur(r,s)}`),function(e,t){e.if(nr.default.valCxt,()=>{e.var(nr.default.instancePath,or._`${nr.default.valCxt}.${nr.default.instancePath}`),e.var(nr.default.parentData,or._`${nr.default.valCxt}.${nr.default.parentData}`),e.var(nr.default.parentDataProperty,or._`${nr.default.valCxt}.${nr.default.parentDataProperty}`),e.var(nr.default.rootData,or._`${nr.default.valCxt}.${nr.default.rootData}`),t.dynamicRef&&e.var(nr.default.dynamicAnchors,or._`${nr.default.valCxt}.${nr.default.dynamicAnchors}`)},()=>{e.var(nr.default.instancePath,or._`""`),e.var(nr.default.parentData,or._`undefined`),e.var(nr.default.parentDataProperty,or._`undefined`),e.var(nr.default.rootData,nr.default.data),t.dynamicRef&&e.var(nr.default.dynamicAnchors,or._`{}`)})}(e,s),e.code(o)}):e.func(t,or._`${nr.default.data}, ${function(e){return or._`{${nr.default.instancePath}="", ${nr.default.parentData}, ${nr.default.parentDataProperty}, ${nr.default.rootData}=${nr.default.data}${e.dynamicRef?or._`, ${nr.default.dynamicAnchors}={}`:or.nil}}={}`}(s)}`,a.$async,()=>e.code(ur(r,s)).code(o))}function ur(e,t){const r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?or._`/*# sourceURL=${r} */`:or.nil}function pr(e,t){fr(e)&&(hr(e),mr(e))?function(e,t){const{schema:r,gen:a,opts:s}=e;s.$comment&&r.$comment&&yr(e);(function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,ir.resolveUrl)(e.opts.uriResolver,e.baseId,t))})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=a.const("_errs",nr.default.errors);vr(e,o),a.var(t,or._`${o} === ${nr.default.errors}`)}(e,t):(0,Xt.boolOrEmptySchema)(e,t)}function mr({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function fr(e){return"boolean"!=typeof e.schema}function hr(e){(0,lr.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:r,opts:a,self:s}=e;t.$ref&&a.ignoreKeywordsWithRef&&(0,lr.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function vr(e,t){if(e.opts.jtd)return gr(e,[],!1,t);const r=(0,Yt.getSchemaTypes)(e.schema);gr(e,r,!(0,Yt.coerceAndCheckDataType)(e,r),t)}function yr({gen:e,schemaEnv:t,schema:r,errSchemaPath:a,opts:s}){const o=r.$comment;if(!0===s.$comment)e.code(or._`${nr.default.self}.logger.log(${o})`);else if("function"==typeof s.$comment){const r=or.str`${a}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code(or._`${nr.default.self}.opts.$comment(${o}, ${r}, ${s}.schema)`)}}function gr(e,t,r,a){const{gen:s,schema:o,data:n,allErrors:i,opts:l,self:c}=e,{RULES:d}=c;function u(c){(0,er.shouldUseGroup)(o,c)&&(c.type?(s.if((0,tr.checkDataType)(c.type,n,l.strictNumbers)),_r(e,c),1===t.length&&t[0]===c.type&&r&&(s.else(),(0,tr.reportTypeError)(e)),s.endIf()):_r(e,c),i||s.if(or._`${nr.default.errors} === ${a||0}`))}!o.$ref||!l.ignoreKeywordsWithRef&&(0,lr.schemaHasRulesButRef)(o,d)?(l.jtd||function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(t=>{br(e.dataTypes,t)||wr(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),function(e,t){const r=[];for(const a of e.dataTypes)br(t,a)?r.push(a):t.includes("integer")&&"number"===a&&r.push("integer");e.dataTypes=r}(e,t)})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&wr(e,"use allowUnionTypes to allow union type keyword")}(e,t);!function(e,t){const r=e.self.RULES.all;for(const a in r){const s=r[a];if("object"==typeof s&&(0,er.shouldUseRule)(e.schema,s)){const{type:r}=s.definition;r.length&&!r.some(e=>$r(t,e))&&wr(e,`missing type "${r.join(",")}" for keyword "${a}"`)}}}(e,e.dataTypes)}(e,t),s.block(()=>{for(const e of d.rules)u(e);u(d.post)})):s.block(()=>Sr(e,"$ref",d.all.$ref.definition))}function _r(e,t){const{gen:r,schema:a,opts:{useDefaults:s}}=e;s&&(0,rr.assignDefaults)(e,t.type),r.block(()=>{for(const r of t.rules)(0,er.shouldUseRule)(a,r)&&Sr(e,r.keyword,r.definition,t.type)})}function $r(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function br(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function wr(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,lr.checkStrictMode)(e,t,e.opts.strictTypes)}ve.validateFunctionCode=function(e){fr(e)&&(hr(e),mr(e))?function(e){const{schema:t,opts:r,gen:a}=e;dr(e,()=>{r.$comment&&t.$comment&&yr(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,lr.checkStrictMode)(e,"default is ignored in the schema root")}(e),a.let(nr.default.vErrors,null),a.let(nr.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",or._`${r}.evaluated`),t.if(or._`${e.evaluated}.dynamicProps`,()=>t.assign(or._`${e.evaluated}.props`,or._`undefined`)),t.if(or._`${e.evaluated}.dynamicItems`,()=>t.assign(or._`${e.evaluated}.items`,or._`undefined`))}(e),vr(e),function(e){const{gen:t,schemaEnv:r,validateName:a,ValidationError:s,opts:o}=e;r.$async?t.if(or._`${nr.default.errors} === 0`,()=>t.return(nr.default.data),()=>t.throw(or._`new ${s}(${nr.default.vErrors})`)):(t.assign(or._`${a}.errors`,nr.default.vErrors),o.unevaluated&&function({gen:e,evaluated:t,props:r,items:a}){r instanceof or.Name&&e.assign(or._`${t}.props`,r);a instanceof or.Name&&e.assign(or._`${t}.items`,a)}(e),t.return(or._`${nr.default.errors} === 0`))}(e)})}(e):dr(e,()=>(0,Xt.topBoolOrEmptySchema)(e))};class kr{constructor(e,t,r){if((0,ar.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,lr.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",xr(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,ar.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",nr.default.errors))}result(e,t,r){this.failResult((0,or.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,or.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(or._`${t} !== undefined && (${(0,or.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?cr.reportExtraError:cr.reportError)(this,this.def.error,t)}$dataError(){(0,cr.reportError)(this,this.def.$dataError||cr.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,cr.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=or.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=or.nil,t=or.nil){if(!this.$data)return;const{gen:r,schemaCode:a,schemaType:s,def:o}=this;r.if((0,or.or)(or._`${a} === undefined`,t)),e!==or.nil&&r.assign(e,!0),(s.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==or.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:a,it:s}=this;return(0,or.or)(function(){if(r.length){if(!(t instanceof or.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return or._`${(0,tr.checkDataTypes)(e,t,s.opts.strictNumbers,tr.DataType.Wrong)}`}return or.nil}(),function(){if(a.validateSchema){const r=e.scopeValue("validate$data",{ref:a.validateSchema});return or._`!${r}(${t})`}return or.nil}())}subschema(e,t){const r=(0,sr.getSubschema)(this.it,e);(0,sr.extendSubschemaData)(r,this.it,e),(0,sr.extendSubschemaMode)(r,e);const a={...this.it,...r,items:void 0,props:void 0};return pr(a,t),a}mergeEvaluated(e,t){const{it:r,gen:a}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=lr.mergeEvaluated.props(a,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=lr.mergeEvaluated.items(a,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:a}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return a.if(t,()=>this.mergeEvaluated(e,or.Name)),!0}}function Sr(e,t,r,a){const s=new kr(e,r,t);"code"in r?r.code(s,a):s.$data&&r.validate?(0,ar.funcKeywordCode)(s,r):"macro"in r?(0,ar.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,ar.funcKeywordCode)(s,r)}ve.KeywordCxt=kr;const Er=/^\/(?:[^~]|~0|~1)*$/,Pr=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function xr(e,{dataLevel:t,dataNames:r,dataPathArr:a}){let s,o;if(""===e)return nr.default.rootData;if("/"===e[0]){if(!Er.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);s=e,o=nr.default.rootData}else{const n=Pr.exec(e);if(!n)throw new Error(`Invalid JSON-pointer: ${e}`);const i=+n[1];if(s=n[2],"#"===s){if(i>=t)throw new Error(l("property/index",i));return a[t-i]}if(i>t)throw new Error(l("data",i));if(o=r[t-i],!s)return o}let n=o;const i=s.split("/");for(const c of i)c&&(o=or._`${o}${(0,or.getProperty)((0,lr.unescapeJsonPointer)(c))}`,n=or._`${n} && ${o}`);return n;function l(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}ve.getData=xr;var jr={};Object.defineProperty(jr,"__esModule",{value:!0});class Cr extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}jr.default=Cr;var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});const Nr=Ot;class Ir extends Error{constructor(e,t,r,a){super(a||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,Nr.resolveUrl)(e,t,r),this.missingSchema=(0,Nr.normalizeId)((0,Nr.getFullPath)(e,this.missingRef))}}Rr.default=Ir;var Or={};Object.defineProperty(Or,"__esModule",{value:!0}),Or.resolveSchema=Or.getCompilingSchema=Or.resolveRef=Or.compileSchema=Or.SchemaEnv=void 0;const Tr=_e,Mr=jr,Dr=De,Vr=Ot,Ar=we,zr=ve;class qr{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,Vr.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function Fr(e){const t=Lr.call(this,e);if(t)return t;const r=(0,Vr.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:a,lines:s}=this.opts.code,{ownProperties:o}=this.opts,n=new Tr.CodeGen(this.scope,{es5:a,lines:s,ownProperties:o});let i;e.$async&&(i=n.scopeValue("Error",{ref:Mr.default,code:Tr._`require("ajv/dist/runtime/validation_error").default`}));const l=n.scopeName("validate");e.validateName=l;const c={gen:n,allErrors:this.opts.allErrors,data:Dr.default.data,parentData:Dr.default.parentData,parentDataProperty:Dr.default.parentDataProperty,dataNames:[Dr.default.data],dataPathArr:[Tr.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:n.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,Tr.stringify)(e.schema)}:{ref:e.schema}),validateName:l,ValidationError:i,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Tr.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:Tr._`""`,opts:this.opts,self:this};let d;try{this._compilations.add(e),(0,zr.validateFunctionCode)(c),n.optimize(this.opts.code.optimize);const t=n.toString();d=`${n.scopeRefs(Dr.default.scope)}return ${t}`,this.opts.code.process&&(d=this.opts.code.process(d,e));const r=new Function(`${Dr.default.self}`,`${Dr.default.scope}`,d)(this,this.scope.get());if(this.scope.value(l,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:l,validateCode:t,scopeValues:n._values}),this.opts.unevaluated){const{props:e,items:t}=c;r.evaluated={props:e instanceof Tr.Name?void 0:e,items:t instanceof Tr.Name?void 0:t,dynamicProps:e instanceof Tr.Name,dynamicItems:t instanceof Tr.Name},r.source&&(r.source.evaluated=(0,Tr.stringify)(r.evaluated))}return e.validate=r,e}catch(u){throw delete e.validate,delete e.validateName,d&&this.logger.error("Error compiling schema, function code:",d),u}finally{this._compilations.delete(e)}}function Ur(e){return(0,Vr.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Fr.call(this,e)}function Lr(e){for(const t of this._compilations)if(Kr(t,e))return t}function Kr(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Br(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||Gr.call(this,e,t)}function Gr(e,t){const r=this.opts.uriResolver.parse(t),a=(0,Vr._getFullPath)(this.opts.uriResolver,r);let s=(0,Vr.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&a===s)return Hr.call(this,r,e);const o=(0,Vr.normalizeId)(a),n=this.refs[o]||this.schemas[o];if("string"==typeof n){const t=Gr.call(this,e,n);if("object"!=typeof(null==t?void 0:t.schema))return;return Hr.call(this,r,t)}if("object"==typeof(null==n?void 0:n.schema)){if(n.validate||Fr.call(this,n),o===(0,Vr.normalizeId)(t)){const{schema:t}=n,{schemaId:r}=this.opts,a=t[r];return a&&(s=(0,Vr.resolveUrl)(this.opts.uriResolver,s,a)),new qr({schema:t,schemaId:r,root:e,baseId:s})}return Hr.call(this,r,n)}}Or.SchemaEnv=qr,Or.compileSchema=Fr,Or.resolveRef=function(e,t,r){var a;r=(0,Vr.resolveUrl)(this.opts.uriResolver,t,r);const s=e.refs[r];if(s)return s;let o=Br.call(this,e,r);if(void 0===o){const s=null===(a=e.localRefs)||void 0===a?void 0:a[r],{schemaId:n}=this.opts;s&&(o=new qr({schema:s,schemaId:n,root:e,baseId:t}))}return void 0!==o?e.refs[r]=Ur.call(this,o):void 0},Or.getCompilingSchema=Lr,Or.resolveSchema=Gr;const Jr=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Hr(e,{baseId:t,schema:r,root:a}){var s;if("/"!==(null===(s=e.fragment)||void 0===s?void 0:s[0]))return;for(const i of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;const e=r[(0,Ar.unescapeFragment)(i)];if(void 0===e)return;const a="object"==typeof(r=e)&&r[this.opts.schemaId];!Jr.has(i)&&a&&(t=(0,Vr.resolveUrl)(this.opts.uriResolver,t,a))}let o;if("boolean"!=typeof r&&r.$ref&&!(0,Ar.schemaHasRulesButRef)(r,this.RULES)){const e=(0,Vr.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=Gr.call(this,a,e)}const{schemaId:n}=this.opts;return o=o||new qr({schema:r,schemaId:n,root:a,baseId:t}),o.schema!==o.root.schema?o:void 0}const Wr={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var Qr={},Zr={exports:{}};var Xr={HEX:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15}};const{HEX:Yr}=Xr,ea=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function ta(e){if(oa(e,".")<3)return{host:e,isIPV4:!1};const t=e.match(ea)||[],[r]=t;return r?{host:sa(r,"."),isIPV4:!0}:{host:e,isIPV4:!1}}function ra(e,t=!1){let r="",a=!0;for(const s of e){if(void 0===Yr[s])return;"0"!==s&&!0===a&&(a=!1),a||(r+=s)}return t&&0===r.length&&(r="0"),r}function aa(e){if(oa(e,":")<2)return{host:e,isIPV6:!1};const t=function(e){let t=0;const r={error:!1,address:"",zone:""},a=[],s=[];let o=!1,n=!1,i=!1;function l(){if(s.length){if(!1===o){const e=ra(s);if(void 0===e)return r.error=!0,!1;a.push(e)}s.length=0}return!0}for(let c=0;c<e.length;c++){const d=e[c];if("["!==d&&"]"!==d)if(":"!==d)if("%"===d){if(!l())break;o=!0}else s.push(d);else{if(!0===n&&(i=!0),!l())break;if(t++,a.push(":"),t>7){r.error=!0;break}c-1>=0&&":"===e[c-1]&&(n=!0)}}return s.length&&(o?r.zone=s.join(""):i?a.push(s.join("")):a.push(ra(s))),r.address=a.join(""),r}(e);if(t.error)return{host:e,isIPV6:!1};{let e=t.address,r=t.address;return t.zone&&(e+="%"+t.zone,r+="%25"+t.zone),{host:e,escapedHost:r,isIPV6:!0}}}function sa(e,t){let r="",a=!0;const s=e.length;for(let o=0;o<s;o++){const n=e[o];"0"===n&&a?(o+1<=s&&e[o+1]===t||o+1===s)&&(r+=n,a=!1):(a=n===t,r+=n)}return r}function oa(e,t){let r=0;for(let a=0;a<e.length;a++)e[a]===t&&r++;return r}const na=/^\.\.?\//u,ia=/^\/\.(?:\/|$)/u,la=/^\/\.\.(?:\/|$)/u,ca=/^\/?(?:.|\n)*?(?=\/|$)/u;var da={recomposeAuthority:function(e){const t=[];if(void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host){let r=unescape(e.host);const a=ta(r);if(a.isIPV4)r=a.host;else{const t=aa(a.host);r=!0===t.isIPV6?`[${t.escapedHost}]`:e.host}t.push(r)}return"number"!=typeof e.port&&"string"!=typeof e.port||(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0},normalizeComponentEncoding:function(e,t){const r=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=r(e.scheme)),void 0!==e.userinfo&&(e.userinfo=r(e.userinfo)),void 0!==e.host&&(e.host=r(e.host)),void 0!==e.path&&(e.path=r(e.path)),void 0!==e.query&&(e.query=r(e.query)),void 0!==e.fragment&&(e.fragment=r(e.fragment)),e},removeDotSegments:function(e){const t=[];for(;e.length;)if(e.match(na))e=e.replace(na,"");else if(e.match(ia))e=e.replace(ia,"/");else if(e.match(la))e=e.replace(la,"/"),t.pop();else if("."===e||".."===e)e="";else{const r=e.match(ca);if(!r)throw new Error("Unexpected dot segment condition");{const a=r[0];e=e.slice(a.length),t.push(a)}}return t.join("")},normalizeIPv4:ta,normalizeIPv6:aa};const ua=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,pa=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function ma(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}function fa(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function ha(e){const t="https"===String(e.scheme).toLowerCase();return e.port!==(t?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}const va={scheme:"http",domainHost:!0,parse:fa,serialize:ha},ya={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=ma(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if(e.port!==(ma(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){const[t,r]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}},ga={http:va,https:{scheme:"https",domainHost:va.domainHost,parse:fa,serialize:ha},ws:ya,wss:{scheme:"wss",domainHost:ya.domainHost,parse:ya.parse,serialize:ya.serialize},urn:{scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;const r=e.path.match(pa);if(r){const a=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];const s=`${a}:${t.nid||e.nid}`,o=ga[s];e.path=void 0,o&&(e=o.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){const r=t.scheme||e.scheme||"urn",a=e.nid.toLowerCase(),s=`${r}:${t.nid||a}`,o=ga[s];o&&(e=o.serialize(e,t));const n=e,i=e.nss;return n.path=`${a||t.nid}:${i}`,t.skipEscape=!0,n},skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:function(e,t){const r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&ua.test(r.uuid)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e){const t=e;return t.nss=(e.uuid||"").toLowerCase(),t},skipNormalize:!0}};var _a=ga;const{normalizeIPv6:$a,normalizeIPv4:ba,removeDotSegments:wa,recomposeAuthority:ka,normalizeComponentEncoding:Sa}=da,Ea=_a;function Pa(e,t,r,a){const s={};return a||(e=Ra(xa(e,r),r),t=Ra(xa(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=wa(t.path||""),s.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=wa(t.path||""),s.query=t.query):(t.path?("/"===t.path.charAt(0)?s.path=wa(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?s.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:s.path=t.path:s.path="/"+t.path,s.path=wa(s.path)),s.query=t.query):(s.path=e.path,void 0!==t.query?s.query=t.query:s.query=e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s}function xa(e,t){const r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},a=Object.assign({},t),s=[],o=Ea[(a.scheme||r.scheme||"").toLowerCase()];o&&o.serialize&&o.serialize(r,a),void 0!==r.path&&(a.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),void 0!==r.scheme&&(r.path=r.path.split("%3A").join(":")))),"suffix"!==a.reference&&r.scheme&&s.push(r.scheme,":");const n=ka(r);if(void 0!==n&&("suffix"!==a.reference&&s.push("//"),s.push(n),r.path&&"/"!==r.path.charAt(0)&&s.push("/")),void 0!==r.path){let e=r.path;a.absolutePath||o&&o.absolutePath||(e=wa(e)),void 0===n&&(e=e.replace(/^\/\//u,"/%2F")),s.push(e)}return void 0!==r.query&&s.push("?",r.query),void 0!==r.fragment&&s.push("#",r.fragment),s.join("")}const ja=Array.from({length:127},(e,t)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(t)));const Ca=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Ra(e,t){const r=Object.assign({},t),a={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=-1!==e.indexOf("%");let o=!1;"suffix"===r.reference&&(e=(r.scheme?r.scheme+":":"")+"//"+e);const n=e.match(Ca);if(n){if(a.scheme=n[1],a.userinfo=n[3],a.host=n[4],a.port=parseInt(n[5],10),a.path=n[6]||"",a.query=n[7],a.fragment=n[8],isNaN(a.port)&&(a.port=n[5]),a.host){const e=ba(a.host);if(!1===e.isIPV4){const t=$a(e.host);a.host=t.host.toLowerCase(),o=t.isIPV6}else a.host=e.host,o=!0}void 0!==a.scheme||void 0!==a.userinfo||void 0!==a.host||void 0!==a.port||void 0!==a.query||a.path?void 0===a.scheme?a.reference="relative":void 0===a.fragment?a.reference="absolute":a.reference="uri":a.reference="same-document",r.reference&&"suffix"!==r.reference&&r.reference!==a.reference&&(a.error=a.error||"URI is not a "+r.reference+" reference.");const e=Ea[(r.scheme||a.scheme||"").toLowerCase()];if(!(r.unicodeSupport||e&&e.unicodeSupport)&&a.host&&(r.domainHost||e&&e.domainHost)&&!1===o&&function(e){let t=0;for(let r=0,a=e.length;r<a;++r)if(t=e.charCodeAt(r),t>126||ja[t])return!0;return!1}(a.host))try{a.host=URL.domainToASCII(a.host.toLowerCase())}catch(i){a.error=a.error||"Host's domain name can not be converted to ASCII: "+i}(!e||e&&!e.skipNormalize)&&(s&&void 0!==a.scheme&&(a.scheme=unescape(a.scheme)),s&&void 0!==a.host&&(a.host=unescape(a.host)),a.path&&(a.path=escape(unescape(a.path))),a.fragment&&(a.fragment=encodeURI(decodeURIComponent(a.fragment)))),e&&e.parse&&e.parse(a,r)}else a.error=a.error||"URI can not be parsed.";return a}const Na={SCHEMES:Ea,normalize:function(e,t){return"string"==typeof e?e=xa(Ra(e,t),t):"object"==typeof e&&(e=Ra(xa(e,t),t)),e},resolve:function(e,t,r){const a=Object.assign({scheme:"null"},r);return xa(Pa(Ra(e,a),Ra(t,a),a,!0),{...a,skipEscape:!0})},resolveComponents:Pa,equal:function(e,t,r){return"string"==typeof e?(e=unescape(e),e=xa(Sa(Ra(e,r),!0),{...r,skipEscape:!0})):"object"==typeof e&&(e=xa(Sa(e,!0),{...r,skipEscape:!0})),"string"==typeof t?(t=unescape(t),t=xa(Sa(Ra(t,r),!0),{...r,skipEscape:!0})):"object"==typeof t&&(t=xa(Sa(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()},serialize:xa,parse:Ra};Zr.exports=Na,Zr.exports.default=Na,Zr.exports.fastUri=Na;var Ia=Zr.exports;Object.defineProperty(Qr,"__esModule",{value:!0});const Oa=Ia;Oa.code='require("ajv/dist/runtime/uri").default',Qr.default=Oa,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=ve;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=_e;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const a=jr,s=Rr,o=Be,n=Or,i=_e,l=Ot,c=Ke,d=we,u=Wr,p=Qr,m=(e,t)=>new RegExp(e,t);m.code="new RegExp";const f=["removeAdditional","useDefaults","coerceTypes"],h=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),v={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},y={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function g(e){var t,r,a,s,o,n,i,l,c,d,u,f,h,v,y,g,_,$,b,w,k,S,E,P,x;const j=e.strict,C=null===(t=e.code)||void 0===t?void 0:t.optimize,R=!0===C||void 0===C?1:C||0,N=null!==(a=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==a?a:m,I=null!==(s=e.uriResolver)&&void 0!==s?s:p.default;return{strictSchema:null===(n=null!==(o=e.strictSchema)&&void 0!==o?o:j)||void 0===n||n,strictNumbers:null===(l=null!==(i=e.strictNumbers)&&void 0!==i?i:j)||void 0===l||l,strictTypes:null!==(d=null!==(c=e.strictTypes)&&void 0!==c?c:j)&&void 0!==d?d:"log",strictTuples:null!==(f=null!==(u=e.strictTuples)&&void 0!==u?u:j)&&void 0!==f?f:"log",strictRequired:null!==(v=null!==(h=e.strictRequired)&&void 0!==h?h:j)&&void 0!==v&&v,code:e.code?{...e.code,optimize:R,regExp:N}:{optimize:R,regExp:N},loopRequired:null!==(y=e.loopRequired)&&void 0!==y?y:200,loopEnum:null!==(g=e.loopEnum)&&void 0!==g?g:200,meta:null===(_=e.meta)||void 0===_||_,messages:null===($=e.messages)||void 0===$||$,inlineRefs:null===(b=e.inlineRefs)||void 0===b||b,schemaId:null!==(w=e.schemaId)&&void 0!==w?w:"$id",addUsedSchema:null===(k=e.addUsedSchema)||void 0===k||k,validateSchema:null===(S=e.validateSchema)||void 0===S||S,validateFormats:null===(E=e.validateFormats)||void 0===E||E,unicodeRegExp:null===(P=e.unicodeRegExp)||void 0===P||P,int32range:null===(x=e.int32range)||void 0===x||x,uriResolver:I}}class _{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...g(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new i.ValueScope({scope:{},prefixes:h,es5:t,lines:r}),this.logger=function(e){if(!1===e)return P;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const a=e.validateFormats;e.validateFormats=!1,this.RULES=(0,o.getRules)(),$.call(this,v,e,"NOT SUPPORTED"),$.call(this,y,e,"DEPRECATED","warn"),this._metaOpts=E.call(this),e.formats&&k.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&S.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),w.call(this),e.validateFormats=a}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:r}=this.opts;let a=u;"id"===r&&(a={...u},a.id=a.$id,delete a.$id),t&&e&&this.addMetaSchema(a,a[r],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const a=r(t);return"$async"in r||(this.errors=r.errors),a}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return a.call(this,e,t);async function a(e,t){await o.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||n.call(this,r)}async function o(e){e&&!this.getSchema(e)&&await a.call(this,{$ref:e},!0)}async function n(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof s.default))throw t;return i.call(this,t),await l.call(this,t.missingSchema),n.call(this,e)}}function i({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function l(e){const r=await c.call(this,e);this.refs[e]||await o.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function c(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,a=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,a);return this}let s;if("object"==typeof e){const{schemaId:t}=this.opts;if(s=e[t],void 0!==s&&"string"!=typeof s)throw new Error(`schema ${t} must be string`)}return t=(0,l.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,a,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const a=this.validate(r,e);if(!a&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return a}getSchema(e){let t;for(;"string"==typeof(t=b.call(this,e));)e=t;if(void 0===t){const{schemaId:r}=this.opts,a=new n.SchemaEnv({schema:{},schemaId:r});if(t=n.resolveSchema.call(this,a,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=b.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e[this.opts.schemaId];return r&&(r=(0,l.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(j.call(this,r,t),!t)return(0,d.eachItem)(r,e=>C.call(this,e)),this;N.call(this,t);const a={...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)};return(0,d.eachItem)(r,0===a.type.length?e=>C.call(this,e,a):e=>a.type.forEach(t=>C.call(this,e,a,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.instancePath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const a of t){const t=a.split("/").slice(1);let s=e;for(const e of t)s=s[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:a}=t.definition,o=s[e];a&&o&&(s[e]=O(o))}}return e}_removeAllSchemas(e,t){for(const r in e){const a=e[r];t&&!t.test(r)||("string"==typeof a?delete e[r]:a&&!a.meta&&(this._cache.delete(a.schema),delete e[r]))}}_addSchema(e,t,r,a=this.opts.validateSchema,s=this.opts.addUsedSchema){let o;const{schemaId:i}=this.opts;if("object"==typeof e)o=e[i];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(void 0!==c)return c;r=(0,l.normalizeId)(o||r);const d=l.getSchemaRefs.call(this,e,r);return c=new n.SchemaEnv({schema:e,schemaId:i,meta:t,baseId:r,localRefs:d}),this._cache.set(c.schema,c),s&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=c),a&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):n.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{n.compileSchema.call(this,e)}finally{this.opts=t}}}function $(e,t,r,a="error"){for(const s in e){const o=s;o in t&&this.logger[a](`${r}: option ${s}. ${e[o]}`)}}function b(e){return e=(0,l.normalizeId)(e),this.schemas[e]||this.refs[e]}function w(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function k(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function S(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function E(){const e={...this.opts};for(const t of f)delete e[t];return e}_.ValidationError=a.default,_.MissingRefError=s.default,e.default=_;const P={log(){},warn(){},error(){}};const x=/^[a-z_$][a-z0-9_$:-]*$/i;function j(e,t){const{RULES:r}=this;if((0,d.eachItem)(e,e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!x.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function C(e,t,r){var a;const s=null==t?void 0:t.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let n=s?o.post:o.rules.find(({type:e})=>e===r);if(n||(n={type:r,rules:[]},o.rules.push(n)),o.keywords[e]=!0,!t)return;const i={keyword:e,definition:{...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)}};t.before?R.call(this,n,i,t.before):n.rules.push(i),o.all[e]=i,null===(a=t.implements)||void 0===a||a.forEach(e=>this.addKeyword(e))}function R(e,t,r){const a=e.rules.findIndex(e=>e.keyword===r);a>=0?e.rules.splice(a,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function N(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=O(t)),e.validateSchema=this.compile(t,!0))}const I={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function O(e){return{anyOf:[e,I]}}}(he);var Ta={},Ma={},Da={};Object.defineProperty(Da,"__esModule",{value:!0});const Va={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Da.default=Va;var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.callRef=Aa.getValidate=void 0;const za=Rr,qa=ft,Fa=_e,Ua=De,La=Or,Ka=we,Ba={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:a}=e,{baseId:s,schemaEnv:o,validateName:n,opts:i,self:l}=a,{root:c}=o;if(("#"===r||"#/"===r)&&s===c.baseId)return function(){if(o===c)return Ja(e,n,o,o.$async);const r=t.scopeValue("root",{ref:c});return Ja(e,Fa._`${r}.validate`,c,c.$async)}();const d=La.resolveRef.call(l,c,s,r);if(void 0===d)throw new za.default(a.opts.uriResolver,s,r);return d instanceof La.SchemaEnv?function(t){const r=Ga(e,t);Ja(e,r,t,t.$async)}(d):function(a){const s=t.scopeValue("schema",!0===i.code.source?{ref:a,code:(0,Fa.stringify)(a)}:{ref:a}),o=t.name("valid"),n=e.subschema({schema:a,dataTypes:[],schemaPath:Fa.nil,topSchemaRef:s,errSchemaPath:r},o);e.mergeEvaluated(n),e.ok(o)}(d)}};function Ga(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):Fa._`${r.scopeValue("wrapper",{ref:t})}.validate`}function Ja(e,t,r,a){const{gen:s,it:o}=e,{allErrors:n,schemaEnv:i,opts:l}=o,c=l.passContext?Ua.default.this:Fa.nil;function d(e){const t=Fa._`${e}.errors`;s.assign(Ua.default.vErrors,Fa._`${Ua.default.vErrors} === null ? ${t} : ${Ua.default.vErrors}.concat(${t})`),s.assign(Ua.default.errors,Fa._`${Ua.default.vErrors}.length`)}function u(e){var t;if(!o.opts.unevaluated)return;const a=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==o.props)if(a&&!a.dynamicProps)void 0!==a.props&&(o.props=Ka.mergeEvaluated.props(s,a.props,o.props));else{const t=s.var("props",Fa._`${e}.evaluated.props`);o.props=Ka.mergeEvaluated.props(s,t,o.props,Fa.Name)}if(!0!==o.items)if(a&&!a.dynamicItems)void 0!==a.items&&(o.items=Ka.mergeEvaluated.items(s,a.items,o.items));else{const t=s.var("items",Fa._`${e}.evaluated.items`);o.items=Ka.mergeEvaluated.items(s,t,o.items,Fa.Name)}}a?function(){if(!i.$async)throw new Error("async schema referenced by sync schema");const r=s.let("valid");s.try(()=>{s.code(Fa._`await ${(0,qa.callValidateCode)(e,t,c)}`),u(t),n||s.assign(r,!0)},e=>{s.if(Fa._`!(${e} instanceof ${o.ValidationError})`,()=>s.throw(e)),d(e),n||s.assign(r,!1)}),e.ok(r)}():e.result((0,qa.callValidateCode)(e,t,c),()=>u(t),()=>d(t))}Aa.getValidate=Ga,Aa.callRef=Ja,Aa.default=Ba,Object.defineProperty(Ma,"__esModule",{value:!0});const Ha=Aa,Wa=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Da.default,Ha.default];Ma.default=Wa;var Qa={},Za={};Object.defineProperty(Za,"__esModule",{value:!0});const Xa=_e,Ya=Xa.operators,es={maximum:{okStr:"<=",ok:Ya.LTE,fail:Ya.GT},minimum:{okStr:">=",ok:Ya.GTE,fail:Ya.LT},exclusiveMaximum:{okStr:"<",ok:Ya.LT,fail:Ya.GTE},exclusiveMinimum:{okStr:">",ok:Ya.GT,fail:Ya.LTE}},ts={message:({keyword:e,schemaCode:t})=>Xa.str`must be ${es[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>Xa._`{comparison: ${es[e].okStr}, limit: ${t}}`},rs={keyword:Object.keys(es),type:"number",schemaType:"number",$data:!0,error:ts,code(e){const{keyword:t,data:r,schemaCode:a}=e;e.fail$data(Xa._`${r} ${es[t].fail} ${a} || isNaN(${r})`)}};Za.default=rs;var as={};Object.defineProperty(as,"__esModule",{value:!0});const ss=_e,os={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>ss.str`must be multiple of ${e}`,params:({schemaCode:e})=>ss._`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:a,it:s}=e,o=s.opts.multipleOfPrecision,n=t.let("res"),i=o?ss._`Math.abs(Math.round(${n}) - ${n}) > 1e-${o}`:ss._`${n} !== parseInt(${n})`;e.fail$data(ss._`(${a} === 0 || (${n} = ${r}/${a}, ${i}))`)}};as.default=os;var ns={},is={};function ls(e){const t=e.length;let r,a=0,s=0;for(;s<t;)a++,r=e.charCodeAt(s++),r>=55296&&r<=56319&&s<t&&(r=e.charCodeAt(s),56320==(64512&r)&&s++);return a}Object.defineProperty(is,"__esModule",{value:!0}),is.default=ls,ls.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(ns,"__esModule",{value:!0});const cs=_e,ds=we,us=is,ps={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>cs.str`must NOT have ${"maxLength"===e?"more":"fewer"} than ${t} characters`,params:({schemaCode:e})=>cs._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a,it:s}=e,o="maxLength"===t?cs.operators.GT:cs.operators.LT,n=!1===s.opts.unicode?cs._`${r}.length`:cs._`${(0,ds.useFunc)(e.gen,us.default)}(${r})`;e.fail$data(cs._`${n} ${o} ${a}`)}};ns.default=ps;var ms={};Object.defineProperty(ms,"__esModule",{value:!0});const fs=ft,hs=_e,vs={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>hs.str`must match pattern "${e}"`,params:({schemaCode:e})=>hs._`{pattern: ${e}}`},code(e){const{data:t,$data:r,schema:a,schemaCode:s,it:o}=e,n=o.opts.unicodeRegExp?"u":"",i=r?hs._`(new RegExp(${s}, ${n}))`:(0,fs.usePattern)(e,a);e.fail$data(hs._`!${i}.test(${t})`)}};ms.default=vs;var ys={};Object.defineProperty(ys,"__esModule",{value:!0});const gs=_e,_s={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>gs.str`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${t} properties`,params:({schemaCode:e})=>gs._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a}=e,s="maxProperties"===t?gs.operators.GT:gs.operators.LT;e.fail$data(gs._`Object.keys(${r}).length ${s} ${a}`)}};ys.default=_s;var $s={};Object.defineProperty($s,"__esModule",{value:!0});const bs=ft,ws=_e,ks=we,Ss={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>ws.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>ws._`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:a,data:s,$data:o,it:n}=e,{opts:i}=n;if(!o&&0===r.length)return;const l=r.length>=i.loopRequired;if(n.allErrors?function(){if(l||o)e.block$data(ws.nil,c);else for(const t of r)(0,bs.checkReportMissingProp)(e,t)}():function(){const n=t.let("missing");if(l||o){const r=t.let("valid",!0);e.block$data(r,()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,a,()=>{t.assign(o,(0,bs.propertyInData)(t,s,r,i.ownProperties)),t.if((0,ws.not)(o),()=>{e.error(),t.break()})},ws.nil)}(n,r)),e.ok(r)}else t.if((0,bs.checkMissingProp)(e,r,n)),(0,bs.reportMissingProp)(e,n),t.else()}(),i.strictRequired){const t=e.parentSchema.properties,{definedProperties:a}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!a.has(e)){const t=`required property "${e}" is not defined at "${n.schemaEnv.baseId+n.errSchemaPath}" (strictRequired)`;(0,ks.checkStrictMode)(n,t,n.opts.strictRequired)}}function c(){t.forOf("prop",a,r=>{e.setParams({missingProperty:r}),t.if((0,bs.noPropertyInData)(t,s,r,i.ownProperties),()=>e.error())})}}};$s.default=Ss;var Es={};Object.defineProperty(Es,"__esModule",{value:!0});const Ps=_e,xs={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>Ps.str`must NOT have ${"maxItems"===e?"more":"fewer"} than ${t} items`,params:({schemaCode:e})=>Ps._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a}=e,s="maxItems"===t?Ps.operators.GT:Ps.operators.LT;e.fail$data(Ps._`${r}.length ${s} ${a}`)}};Es.default=xs;var js={},Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});const Rs=Tt;Rs.code='require("ajv/dist/runtime/equal").default',Cs.default=Rs,Object.defineProperty(js,"__esModule",{value:!0});const Ns=Ke,Is=_e,Os=we,Ts=Cs,Ms={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>Is.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>Is._`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:a,schema:s,parentSchema:o,schemaCode:n,it:i}=e;if(!a&&!s)return;const l=t.let("valid"),c=o.items?(0,Ns.getSchemaTypes)(o.items):[];function d(a,s){const o=t.name("item"),n=(0,Ns.checkDataTypes)(c,o,i.opts.strictNumbers,Ns.DataType.Wrong),d=t.const("indices",Is._`{}`);t.for(Is._`;${a}--;`,()=>{t.let(o,Is._`${r}[${a}]`),t.if(n,Is._`continue`),c.length>1&&t.if(Is._`typeof ${o} == "string"`,Is._`${o} += "_"`),t.if(Is._`typeof ${d}[${o}] == "number"`,()=>{t.assign(s,Is._`${d}[${o}]`),e.error(),t.assign(l,!1).break()}).code(Is._`${d}[${o}] = ${a}`)})}function u(a,s){const o=(0,Os.useFunc)(t,Ts.default),n=t.name("outer");t.label(n).for(Is._`;${a}--;`,()=>t.for(Is._`${s} = ${a}; ${s}--;`,()=>t.if(Is._`${o}(${r}[${a}], ${r}[${s}])`,()=>{e.error(),t.assign(l,!1).break(n)})))}e.block$data(l,function(){const a=t.let("i",Is._`${r}.length`),s=t.let("j");e.setParams({i:a,j:s}),t.assign(l,!0),t.if(Is._`${a} > 1`,()=>(c.length>0&&!c.some(e=>"object"===e||"array"===e)?d:u)(a,s))},Is._`${n} === false`),e.ok(l)}};js.default=Ms;var Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});const Vs=_e,As=we,zs=Cs,qs={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:e})=>Vs._`{allowedValue: ${e}}`},code(e){const{gen:t,data:r,$data:a,schemaCode:s,schema:o}=e;a||o&&"object"==typeof o?e.fail$data(Vs._`!${(0,As.useFunc)(t,zs.default)}(${r}, ${s})`):e.fail(Vs._`${o} !== ${r}`)}};Ds.default=qs;var Fs={};Object.defineProperty(Fs,"__esModule",{value:!0});const Us=_e,Ls=we,Ks=Cs,Bs={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:e})=>Us._`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:a,schema:s,schemaCode:o,it:n}=e;if(!a&&0===s.length)throw new Error("enum must have non-empty array");const i=s.length>=n.opts.loopEnum;let l;const c=()=>null!=l?l:l=(0,Ls.useFunc)(t,Ks.default);let d;if(i||a)d=t.let("valid"),e.block$data(d,function(){t.assign(d,!1),t.forOf("v",o,e=>t.if(Us._`${c()}(${r}, ${e})`,()=>t.assign(d,!0).break()))});else{if(!Array.isArray(s))throw new Error("ajv implementation error");const e=t.const("vSchema",o);d=(0,Us.or)(...s.map((t,a)=>function(e,t){const a=s[t];return"object"==typeof a&&null!==a?Us._`${c()}(${r}, ${e}[${t}])`:Us._`${r} === ${a}`}(e,a)))}e.pass(d)}};Fs.default=Bs,Object.defineProperty(Qa,"__esModule",{value:!0});const Gs=as,Js=ns,Hs=ms,Ws=ys,Qs=$s,Zs=Es,Xs=js,Ys=Ds,eo=Fs,to=[Za.default,Gs.default,Js.default,Hs.default,Ws.default,Qs.default,Zs.default,Xs.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Ys.default,eo.default];Qa.default=to;var ro={},ao={};Object.defineProperty(ao,"__esModule",{value:!0}),ao.validateAdditionalItems=void 0;const so=_e,oo=we,no={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>so.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>so._`{limit: ${e}}`},code(e){const{parentSchema:t,it:r}=e,{items:a}=t;Array.isArray(a)?io(e,a):(0,oo.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas')}};function io(e,t){const{gen:r,schema:a,data:s,keyword:o,it:n}=e;n.items=!0;const i=r.const("len",so._`${s}.length`);if(!1===a)e.setParams({len:t.length}),e.pass(so._`${i} <= ${t.length}`);else if("object"==typeof a&&!(0,oo.alwaysValidSchema)(n,a)){const a=r.var("valid",so._`${i} <= ${t.length}`);r.if((0,so.not)(a),()=>function(a){r.forRange("i",t.length,i,t=>{e.subschema({keyword:o,dataProp:t,dataPropType:oo.Type.Num},a),n.allErrors||r.if((0,so.not)(a),()=>r.break())})}(a)),e.ok(a)}}ao.validateAdditionalItems=io,ao.default=no;var lo={},co={};Object.defineProperty(co,"__esModule",{value:!0}),co.validateTuple=void 0;const uo=_e,po=we,mo=ft,fo={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return ho(e,"additionalItems",t);r.items=!0,(0,po.alwaysValidSchema)(r,t)||e.ok((0,mo.validateArray)(e))}};function ho(e,t,r=e.schema){const{gen:a,parentSchema:s,data:o,keyword:n,it:i}=e;!function(e){const{opts:a,errSchemaPath:s}=i,o=r.length,l=o===e.minItems&&(o===e.maxItems||!1===e[t]);if(a.strictTuples&&!l){const e=`"${n}" is ${o}-tuple, but minItems or maxItems/${t} are not specified or different at path "${s}"`;(0,po.checkStrictMode)(i,e,a.strictTuples)}}(s),i.opts.unevaluated&&r.length&&!0!==i.items&&(i.items=po.mergeEvaluated.items(a,r.length,i.items));const l=a.name("valid"),c=a.const("len",uo._`${o}.length`);r.forEach((t,r)=>{(0,po.alwaysValidSchema)(i,t)||(a.if(uo._`${c} > ${r}`,()=>e.subschema({keyword:n,schemaProp:r,dataProp:r},l)),e.ok(l))})}co.validateTuple=ho,co.default=fo,Object.defineProperty(lo,"__esModule",{value:!0});const vo=co,yo={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,vo.validateTuple)(e,"items")};lo.default=yo;var go={};Object.defineProperty(go,"__esModule",{value:!0});const _o=_e,$o=we,bo=ft,wo=ao,ko={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:e}})=>_o.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>_o._`{limit: ${e}}`},code(e){const{schema:t,parentSchema:r,it:a}=e,{prefixItems:s}=r;a.items=!0,(0,$o.alwaysValidSchema)(a,t)||(s?(0,wo.validateAdditionalItems)(e,s):e.ok((0,bo.validateArray)(e)))}};go.default=ko;var So={};Object.defineProperty(So,"__esModule",{value:!0});const Eo=_e,Po=we,xo={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?Eo.str`must contain at least ${e} valid item(s)`:Eo.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?Eo._`{minContains: ${e}}`:Eo._`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:a,data:s,it:o}=e;let n,i;const{minContains:l,maxContains:c}=a;o.opts.next?(n=void 0===l?1:l,i=c):n=1;const d=t.const("len",Eo._`${s}.length`);if(e.setParams({min:n,max:i}),void 0===i&&0===n)return void(0,Po.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==i&&n>i)return(0,Po.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,Po.alwaysValidSchema)(o,r)){let t=Eo._`${d} >= ${n}`;return void 0!==i&&(t=Eo._`${t} && ${d} <= ${i}`),void e.pass(t)}o.items=!0;const u=t.name("valid");function p(){const e=t.name("_valid"),r=t.let("count",0);m(e,()=>t.if(e,()=>function(e){t.code(Eo._`${e}++`),void 0===i?t.if(Eo._`${e} >= ${n}`,()=>t.assign(u,!0).break()):(t.if(Eo._`${e} > ${i}`,()=>t.assign(u,!1).break()),1===n?t.assign(u,!0):t.if(Eo._`${e} >= ${n}`,()=>t.assign(u,!0)))}(r)))}function m(r,a){t.forRange("i",0,d,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:Po.Type.Num,compositeRule:!0},r),a()})}void 0===i&&1===n?m(u,()=>t.if(u,()=>t.break())):0===n?(t.let(u,!0),void 0!==i&&t.if(Eo._`${s}.length > 0`,p)):(t.let(u,!1),p()),e.result(u,()=>e.reset())}};So.default=xo;var jo={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=_e,r=we,a=ft;e.error={message:({params:{property:e,depsCount:r,deps:a}})=>t.str`must have ${1===r?"property":"properties"} ${a} when property ${e} is present`,params:({params:{property:e,depsCount:r,deps:a,missingProperty:s}})=>t._`{property: ${e},
    missingProperty: ${s},
    depsCount: ${r},
    deps: ${a}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const a in e){if("__proto__"===a)continue;(Array.isArray(e[a])?t:r)[a]=e[a]}return[t,r]}(e);o(e,t),n(e,r)}};function o(e,r=e.schema){const{gen:s,data:o,it:n}=e;if(0===Object.keys(r).length)return;const i=s.let("missing");for(const l in r){const c=r[l];if(0===c.length)continue;const d=(0,a.propertyInData)(s,o,l,n.opts.ownProperties);e.setParams({property:l,depsCount:c.length,deps:c.join(", ")}),n.allErrors?s.if(d,()=>{for(const t of c)(0,a.checkReportMissingProp)(e,t)}):(s.if(t._`${d} && (${(0,a.checkMissingProp)(e,c,i)})`),(0,a.reportMissingProp)(e,i),s.else())}}function n(e,t=e.schema){const{gen:s,data:o,keyword:n,it:i}=e,l=s.name("valid");for(const c in t)(0,r.alwaysValidSchema)(i,t[c])||(s.if((0,a.propertyInData)(s,o,c,i.opts.ownProperties),()=>{const t=e.subschema({keyword:n,schemaProp:c},l);e.mergeValidEvaluated(t,l)},()=>s.var(l,!0)),e.ok(l))}e.validatePropertyDeps=o,e.validateSchemaDeps=n,e.default=s}(jo);var Co={};Object.defineProperty(Co,"__esModule",{value:!0});const Ro=_e,No=we,Io={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:e})=>Ro._`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:a,it:s}=e;if((0,No.alwaysValidSchema)(s,r))return;const o=t.name("valid");t.forIn("key",a,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},o),t.if((0,Ro.not)(o),()=>{e.error(!0),s.allErrors||t.break()})}),e.ok(o)}};Co.default=Io;var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0});const To=ft,Mo=_e,Do=De,Vo=we,Ao={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:e})=>Mo._`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:a,data:s,errsCount:o,it:n}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:i,opts:l}=n;if(n.props=!0,"all"!==l.removeAdditional&&(0,Vo.alwaysValidSchema)(n,r))return;const c=(0,To.allSchemaProperties)(a.properties),d=(0,To.allSchemaProperties)(a.patternProperties);function u(e){t.code(Mo._`delete ${s}[${e}]`)}function p(a){if("all"===l.removeAdditional||l.removeAdditional&&!1===r)u(a);else{if(!1===r)return e.setParams({additionalProperty:a}),e.error(),void(i||t.break());if("object"==typeof r&&!(0,Vo.alwaysValidSchema)(n,r)){const r=t.name("valid");"failing"===l.removeAdditional?(m(a,r,!1),t.if((0,Mo.not)(r),()=>{e.reset(),u(a)})):(m(a,r),i||t.if((0,Mo.not)(r),()=>t.break()))}}}function m(t,r,a){const s={keyword:"additionalProperties",dataProp:t,dataPropType:Vo.Type.Str};!1===a&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,r)}t.forIn("key",s,r=>{c.length||d.length?t.if(function(r){let s;if(c.length>8){const e=(0,Vo.schemaRefOrVal)(n,a.properties,"properties");s=(0,To.isOwnProperty)(t,e,r)}else s=c.length?(0,Mo.or)(...c.map(e=>Mo._`${r} === ${e}`)):Mo.nil;return d.length&&(s=(0,Mo.or)(s,...d.map(t=>Mo._`${(0,To.usePattern)(e,t)}.test(${r})`))),(0,Mo.not)(s)}(r),()=>p(r)):p(r)}),e.ok(Mo._`${o} === ${Do.default.errors}`)}};Oo.default=Ao;var zo={};Object.defineProperty(zo,"__esModule",{value:!0});const qo=ve,Fo=ft,Uo=we,Lo=Oo,Ko={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:a,data:s,it:o}=e;"all"===o.opts.removeAdditional&&void 0===a.additionalProperties&&Lo.default.code(new qo.KeywordCxt(o,Lo.default,"additionalProperties"));const n=(0,Fo.allSchemaProperties)(r);for(const u of n)o.definedProperties.add(u);o.opts.unevaluated&&n.length&&!0!==o.props&&(o.props=Uo.mergeEvaluated.props(t,(0,Uo.toHash)(n),o.props));const i=n.filter(e=>!(0,Uo.alwaysValidSchema)(o,r[e]));if(0===i.length)return;const l=t.name("valid");for(const u of i)c(u)?d(u):(t.if((0,Fo.propertyInData)(t,s,u,o.opts.ownProperties)),d(u),o.allErrors||t.else().var(l,!0),t.endIf()),e.it.definedProperties.add(u),e.ok(l);function c(e){return o.opts.useDefaults&&!o.compositeRule&&void 0!==r[e].default}function d(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},l)}}};zo.default=Ko;var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0});const Go=ft,Jo=_e,Ho=we,Wo=we,Qo={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:a,parentSchema:s,it:o}=e,{opts:n}=o,i=(0,Go.allSchemaProperties)(r),l=i.filter(e=>(0,Ho.alwaysValidSchema)(o,r[e]));if(0===i.length||l.length===i.length&&(!o.opts.unevaluated||!0===o.props))return;const c=n.strictSchema&&!n.allowMatchingProperties&&s.properties,d=t.name("valid");!0===o.props||o.props instanceof Jo.Name||(o.props=(0,Wo.evaluatedPropsToName)(t,o.props));const{props:u}=o;function p(e){for(const t in c)new RegExp(e).test(t)&&(0,Ho.checkStrictMode)(o,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function m(r){t.forIn("key",a,a=>{t.if(Jo._`${(0,Go.usePattern)(e,r)}.test(${a})`,()=>{const s=l.includes(r);s||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:a,dataPropType:Wo.Type.Str},d),o.opts.unevaluated&&!0!==u?t.assign(Jo._`${u}[${a}]`,!0):s||o.allErrors||t.if((0,Jo.not)(d),()=>t.break())})})}!function(){for(const e of i)c&&p(e),o.allErrors?m(e):(t.var(d,!0),m(e),t.if(d))}()}};Bo.default=Qo;var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});const Xo=we,Yo={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:a}=e;if((0,Xo.alwaysValidSchema)(a,r))return void e.fail();const s=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.failResult(s,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};Zo.default=Yo;var en={};Object.defineProperty(en,"__esModule",{value:!0});const tn={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:ft.validateUnion,error:{message:"must match a schema in anyOf"}};en.default=tn;var rn={};Object.defineProperty(rn,"__esModule",{value:!0});const an=_e,sn=we,on={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:e})=>an._`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,parentSchema:a,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&a.discriminator)return;const o=r,n=t.let("valid",!1),i=t.let("passing",null),l=t.name("_valid");e.setParams({passing:i}),t.block(function(){o.forEach((r,a)=>{let o;(0,sn.alwaysValidSchema)(s,r)?t.var(l,!0):o=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},l),a>0&&t.if(an._`${l} && ${n}`).assign(n,!1).assign(i,an._`[${i}, ${a}]`).else(),t.if(l,()=>{t.assign(n,!0),t.assign(i,a),o&&e.mergeEvaluated(o,an.Name)})})}),e.result(n,()=>e.reset(),()=>e.error(!0))}};rn.default=on;var nn={};Object.defineProperty(nn,"__esModule",{value:!0});const ln=we,cn={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=t.name("valid");r.forEach((t,r)=>{if((0,ln.alwaysValidSchema)(a,t))return;const o=e.subschema({keyword:"allOf",schemaProp:r},s);e.ok(s),e.mergeEvaluated(o)})}};nn.default=cn;var dn={};Object.defineProperty(dn,"__esModule",{value:!0});const un=_e,pn=we,mn={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>un.str`must match "${e.ifClause}" schema`,params:({params:e})=>un._`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:a}=e;void 0===r.then&&void 0===r.else&&(0,pn.checkStrictMode)(a,'"if" without "then" and "else" is ignored');const s=fn(a,"then"),o=fn(a,"else");if(!s&&!o)return;const n=t.let("valid",!0),i=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},i);e.mergeEvaluated(t)}(),e.reset(),s&&o){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(i,l("then",r),l("else",r))}else s?t.if(i,l("then")):t.if((0,un.not)(i),l("else"));function l(r,a){return()=>{const s=e.subschema({keyword:r},i);t.assign(n,i),e.mergeValidEvaluated(s,n),a?t.assign(a,un._`${r}`):e.setParams({ifClause:r})}}e.pass(n,()=>e.error(!0))}};function fn(e,t){const r=e.schema[t];return void 0!==r&&!(0,pn.alwaysValidSchema)(e,r)}dn.default=mn;var hn={};Object.defineProperty(hn,"__esModule",{value:!0});const vn=we,yn={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,vn.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};hn.default=yn,Object.defineProperty(ro,"__esModule",{value:!0});const gn=ao,_n=lo,$n=co,bn=go,wn=So,kn=jo,Sn=Co,En=Oo,Pn=zo,xn=Bo,jn=Zo,Cn=en,Rn=rn,Nn=nn,In=dn,On=hn;ro.default=function(e=!1){const t=[jn.default,Cn.default,Rn.default,Nn.default,In.default,On.default,Sn.default,En.default,kn.default,Pn.default,xn.default];return e?t.push(_n.default,bn.default):t.push(gn.default,$n.default),t.push(wn.default),t};var Tn={},Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});const Dn=_e,Vn={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>Dn.str`must match format "${e}"`,params:({schemaCode:e})=>Dn._`{format: ${e}}`},code(e,t){const{gen:r,data:a,$data:s,schema:o,schemaCode:n,it:i}=e,{opts:l,errSchemaPath:c,schemaEnv:d,self:u}=i;l.validateFormats&&(s?function(){const s=r.scopeValue("formats",{ref:u.formats,code:l.code.formats}),o=r.const("fDef",Dn._`${s}[${n}]`),i=r.let("fType"),c=r.let("format");r.if(Dn._`typeof ${o} == "object" && !(${o} instanceof RegExp)`,()=>r.assign(i,Dn._`${o}.type || "string"`).assign(c,Dn._`${o}.validate`),()=>r.assign(i,Dn._`"string"`).assign(c,o)),e.fail$data((0,Dn.or)(!1===l.strictSchema?Dn.nil:Dn._`${n} && !${c}`,function(){const e=d.$async?Dn._`(${o}.async ? await ${c}(${a}) : ${c}(${a}))`:Dn._`${c}(${a})`,r=Dn._`(typeof ${c} == "function" ? ${e} : ${c}.test(${a}))`;return Dn._`${c} && ${c} !== true && ${i} === ${t} && !${r}`}()))}():function(){const s=u.formats[o];if(!s)return void function(){if(!1===l.strictSchema)return void u.logger.warn(e());throw new Error(e());function e(){return`unknown format "${o}" ignored in schema at path "${c}"`}}();if(!0===s)return;const[n,i,p]=function(e){const t=e instanceof RegExp?(0,Dn.regexpCode)(e):l.code.formats?Dn._`${l.code.formats}${(0,Dn.getProperty)(o)}`:void 0,a=r.scopeValue("formats",{key:o,ref:e,code:t});if("object"==typeof e&&!(e instanceof RegExp))return[e.type||"string",e.validate,Dn._`${a}.validate`];return["string",e,a]}(s);n===t&&e.pass(function(){if("object"==typeof s&&!(s instanceof RegExp)&&s.async){if(!d.$async)throw new Error("async format in sync schema");return Dn._`await ${p}(${a})`}return"function"==typeof i?Dn._`${p}(${a})`:Dn._`${p}.test(${a})`}())}())}};Mn.default=Vn,Object.defineProperty(Tn,"__esModule",{value:!0});const An=[Mn.default];Tn.default=An;var zn={};Object.defineProperty(zn,"__esModule",{value:!0}),zn.contentVocabulary=zn.metadataVocabulary=void 0,zn.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],zn.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(Ta,"__esModule",{value:!0});const qn=Qa,Fn=ro,Un=Tn,Ln=zn,Kn=[Ma.default,qn.default,(0,Fn.default)(),Un.default,Ln.metadataVocabulary,Ln.contentVocabulary];Ta.default=Kn;var Bn,Gn,Jn={},Hn={};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.DiscrError=void 0,(Gn=Bn||(Hn.DiscrError=Bn={})).Tag="tag",Gn.Mapping="mapping",Object.defineProperty(Jn,"__esModule",{value:!0});const Wn=_e,Qn=Hn,Zn=Or,Xn=Rr,Yn=we,ei={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:e,tagName:t}})=>e===Qn.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>Wn._`{error: ${e}, tag: ${r}, tagValue: ${t}}`},code(e){const{gen:t,data:r,schema:a,parentSchema:s,it:o}=e,{oneOf:n}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const i=a.propertyName;if("string"!=typeof i)throw new Error("discriminator: requires propertyName");if(a.mapping)throw new Error("discriminator: mapping is not supported");if(!n)throw new Error("discriminator: requires oneOf keyword");const l=t.let("valid",!1),c=t.const("tag",Wn._`${r}${(0,Wn.getProperty)(i)}`);function d(r){const a=t.name("valid"),s=e.subschema({keyword:"oneOf",schemaProp:r},a);return e.mergeEvaluated(s,Wn.Name),a}t.if(Wn._`typeof ${c} == "string"`,()=>function(){const r=function(){var e;const t={},r=l(s);let a=!0;for(let s=0;s<n.length;s++){let t=n[s];if((null==t?void 0:t.$ref)&&!(0,Yn.schemaHasRulesButRef)(t,o.self.RULES)){const e=t.$ref;if(t=Zn.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,e),t instanceof Zn.SchemaEnv&&(t=t.schema),void 0===t)throw new Xn.default(o.opts.uriResolver,o.baseId,e)}const d=null===(e=null==t?void 0:t.properties)||void 0===e?void 0:e[i];if("object"!=typeof d)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${i}"`);a=a&&(r||l(t)),c(d,s)}if(!a)throw new Error(`discriminator: "${i}" must be required`);return t;function l({required:e}){return Array.isArray(e)&&e.includes(i)}function c(e,t){if(e.const)d(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${i}" must have "const" or "enum"`);for(const r of e.enum)d(r,t)}}function d(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${i}" values must be unique strings`);t[e]=r}}();t.if(!1);for(const e in r)t.elseIf(Wn._`${c} === ${e}`),t.assign(l,d(r[e]));t.else(),e.error(!1,{discrError:Qn.DiscrError.Mapping,tag:c,tagName:i}),t.endIf()}(),()=>e.error(!1,{discrError:Qn.DiscrError.Tag,tag:c,tagName:i})),e.ok(l)}};Jn.default=ei;const ti={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=he,a=Ta,s=Jn,o=ti,n=["/properties"],i="http://json-schema.org/draft-07/schema";class l extends r.default{_addVocabularies(){super._addVocabularies(),a.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,n):o;this.addMetaSchema(e,i,!1),this.refs["http://json-schema.org/schema"]=i}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(i)?i:void 0)}}t.Ajv=l,e.exports=t=l,e.exports.Ajv=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var c=ve;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var d=_e;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var u=jr;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return u.default}});var p=Rr;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return p.default}})}(fe,fe.exports);var ri=fe.exports;const ai=C(ri);var si={exports:{}},oi={};!function(e){function t(e,t){return{validate:e,compare:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0,e.fullFormats={date:t(s,o),time:t(i(!0),l),"date-time":t(u(!0),p),"iso-time":t(i(),c),"iso-date-time":t(u(),m),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return f.test(e)&&h.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if($.test(e))return!1;try{return new RegExp(e),!0}catch(t){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return v.lastIndex=0,v.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=g&&e>=y}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:_},double:{type:"number",validate:_},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,l),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,p),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,m),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,a=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(e){const t=r.exec(e);if(!t)return!1;const s=+t[1],o=+t[2],n=+t[3];return o>=1&&o<=12&&n>=1&&n<=(2===o&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(s)?29:a[o])}function o(e,t){if(e&&t)return e>t?1:e<t?-1:0}const n=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function i(e){return function(t){const r=n.exec(t);if(!r)return!1;const a=+r[1],s=+r[2],o=+r[3],i=r[4],l="-"===r[5]?-1:1,c=+(r[6]||0),d=+(r[7]||0);if(c>23||d>59||e&&!i)return!1;if(a<=23&&s<=59&&o<60)return!0;const u=s-d*l,p=a-c*l-(u<0?1:0);return(23===p||-1===p)&&(59===u||-1===u)&&o<61}}function l(e,t){if(!e||!t)return;const r=new Date("2020-01-01T"+e).valueOf(),a=new Date("2020-01-01T"+t).valueOf();return r&&a?r-a:void 0}function c(e,t){if(!e||!t)return;const r=n.exec(e),a=n.exec(t);return r&&a?(e=r[1]+r[2]+r[3])>(t=a[1]+a[2]+a[3])?1:e<t?-1:0:void 0}const d=/t|\s/i;function u(e){const t=i(e);return function(e){const r=e.split(d);return 2===r.length&&s(r[0])&&t(r[1])}}function p(e,t){if(!e||!t)return;const r=new Date(e).valueOf(),a=new Date(t).valueOf();return r&&a?r-a:void 0}function m(e,t){if(!e||!t)return;const[r,a]=e.split(d),[s,n]=t.split(d),i=o(r,s);return void 0!==i?i||l(a,n):void 0}const f=/\/|:/,h=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;const v=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;const y=-2147483648,g=2**31-1;function _(){return!0}const $=/[^\\]\\Z/}(oi);var ni={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=ri,r=_e,a=r.operators,s={formatMaximum:{okStr:"<=",ok:a.LTE,fail:a.GT},formatMinimum:{okStr:">=",ok:a.GTE,fail:a.LT},formatExclusiveMaximum:{okStr:"<",ok:a.LT,fail:a.GTE},formatExclusiveMinimum:{okStr:">",ok:a.GT,fail:a.LTE}},o={message:({keyword:e,schemaCode:t})=>r.str`should be ${s[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>r._`{comparison: ${s[e].okStr}, limit: ${t}}`};e.formatLimitDefinition={keyword:Object.keys(s),type:"string",schemaType:"string",$data:!0,error:o,code(e){const{gen:a,data:o,schemaCode:n,keyword:i,it:l}=e,{opts:c,self:d}=l;if(!c.validateFormats)return;const u=new t.KeywordCxt(l,d.RULES.all.format.definition,"format");function p(e){return r._`${e}.compare(${o}, ${n}) ${s[i].fail} 0`}u.$data?function(){const t=a.scopeValue("formats",{ref:d.formats,code:c.code.formats}),s=a.const("fmt",r._`${t}[${u.schemaCode}]`);e.fail$data((0,r.or)(r._`typeof ${s} != "object"`,r._`${s} instanceof RegExp`,r._`typeof ${s}.compare != "function"`,p(s)))}():function(){const t=u.schema,s=d.formats[t];if(!s||!0===s)return;if("object"!=typeof s||s instanceof RegExp||"function"!=typeof s.compare)throw new Error(`"${i}": format "${t}" does not define "compare" function`);const o=a.scopeValue("formats",{key:t,ref:s,code:c.code.formats?r._`${c.code.formats}${(0,r.getProperty)(t)}`:void 0});e.fail$data(p(o))}()},dependencies:["format"]};e.default=t=>(t.addKeyword(e.formatLimitDefinition),t)}(ni),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=oi,a=ni,s=_e,o=new s.Name("fullFormats"),n=new s.Name("fastFormats"),i=(e,t={keywords:!0})=>{if(Array.isArray(t))return l(e,t,r.fullFormats,o),e;const[s,i]="fast"===t.mode?[r.fastFormats,n]:[r.fullFormats,o];return l(e,t.formats||r.formatNames,s,i),t.keywords&&(0,a.default)(e),e};function l(e,t,r,a){var o,n;null!==(o=(n=e.opts.code).formats)&&void 0!==o||(n.formats=s._`require("ajv-formats/dist/formats").${a}`);for(const s of t)e.addFormat(s,r[s])}i.get=(e,t="full")=>{const a=("fast"===t?r.fastFormats:r.fullFormats)[e];if(!a)throw new Error(`Unknown format "${e}"`);return a},e.exports=t=i,Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}(si,si.exports);const ii=C(si.exports),li={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://auditomatic.org/schemas/export-v1.json",title:"AudiomaticLite Export Format v1.0",description:"Standard export format for AudiomaticLite experimental data",type:"object",properties:{auditomatic_export:{type:"object",properties:{format_version:{type:"string",const:"1.0.0"},instrument_version:{type:"string",pattern:"^auditomatic-lite-v\\d+\\.\\d+\\.\\d+$"},export_timestamp:{type:"string",format:"date-time"},experiment:{$ref:"#/$defs/Experiment"},execution:{$ref:"#/$defs/Execution"},measurements:{type:"array",items:{$ref:"#/$defs/Measurement"}},integrity:{$ref:"#/$defs/Integrity"}},required:["format_version","instrument_version","export_timestamp","experiment","execution","measurements","integrity"],additionalProperties:!1}},required:["auditomatic_export"],additionalProperties:!1,$defs:{Experiment:{type:"object",properties:{design_id:{type:"integer"},name:{type:"string"},description:{type:"string"},prompt_template:{type:"string"},variables:{type:"object",additionalProperties:{type:"array",items:{type:"string"}}},variable_list_refs:{type:"object",additionalProperties:{type:"object",properties:{name:{type:"string"},id:{type:"integer"},checksum:{type:"string"}},required:["name","id","checksum"]}},output_format:{type:"string",enum:["text","json"]},output_type:{type:"string"},extract_pattern:{oneOf:[{type:"string"},{type:"object",properties:{match:{type:"string"},replace:{type:"string"}},required:["match"]}]},refusal_words:{type:"array",items:{type:"string"}},reject_refusal_words:{type:"boolean"},created_at:{type:"string",format:"date-time"},updated_at:{type:"string",format:"date-time"}},required:["design_id","name","prompt_template","variables","created_at","updated_at"]},Execution:{type:"object",properties:{run_id:{type:"integer"},run_name:{type:"string"},started_at:{type:"string",format:"date-time"},completed_at:{type:["string","null"],format:"date-time"},model_configuration:{type:"object",properties:{models:{type:"array",items:{type:"string"},minItems:1},parameters:{type:"object",properties:{temperature:{type:"number",minimum:0,maximum:2},max_tokens:{type:"integer",minimum:1},concurrency:{type:"integer",minimum:1}},required:["temperature","max_tokens","concurrency"]}},required:["models","parameters"]},total_tasks:{type:"integer",minimum:0},completed_tasks:{type:"integer",minimum:0},error_count:{type:"integer",minimum:0},status:{type:"string",enum:["draft","ready","pending","running","paused","completed","stopped","error"]}},required:["run_id","run_name","started_at","model_configuration","total_tasks","completed_tasks","error_count","status"]},Measurement:{type:"object",properties:{task_id:{type:"integer"},model:{type:"string"},variable_assignment:{type:"object",additionalProperties:{type:"string"}},prompt:{type:"string"},raw_response:{type:["string","null"]},extracted_value:{type:["string","null"]},parsed_results:{type:["object","null"]},response_time_ms:{type:["integer","null"],minimum:0},token_usage:{type:["object","null"],properties:{prompt_tokens:{type:"integer",minimum:0},completion_tokens:{type:"integer",minimum:0},total_tokens:{type:"integer",minimum:0}},required:["prompt_tokens","completion_tokens","total_tokens"]},timestamp:{type:"string",format:"date-time"},status:{type:"string",enum:["pending","processing","completed","error","cancelled"]},error:{type:["string","null"]},api_call_log:{type:["object","null"],description:"Complete API request/response log for research transparency"}},required:["task_id","model","variable_assignment","prompt","timestamp","status"]},Integrity:{type:"object",properties:{measurement_count:{type:"integer",minimum:0},checksum:{type:"string",pattern:"^sha256:[a-f0-9]{64}$"},validation_errors:{type:"array",items:{type:"string"}},completeness_check:{type:"object",properties:{expected_tasks:{type:"integer"},actual_tasks:{type:"integer"},missing_tasks:{type:"array",items:{type:"object",properties:{model:{type:"string"},variables:{type:"object"}}}}},required:["expected_tasks","actual_tasks","missing_tasks"]}},required:["measurement_count","checksum","validation_errors","completeness_check"]}}},ci={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://auditomatic.org/schemas/design-export-v1.json",title:"AudiomaticLite Design Export Format v1.0",description:"Standard export format for individual experimental designs",type:"object",properties:{auditomatic_design_export:{type:"object",properties:{format_version:{type:"string",const:"1.0.0"},instrument_version:{type:"string",pattern:"^auditomatic-lite-v\\d+\\.\\d+\\.\\d+$"},export_timestamp:{type:"string",format:"date-time"},design:{$ref:"#/$defs/Design"},variable_lists:{type:"array",items:{$ref:"#/$defs/VariableList"}},integrity:{$ref:"#/$defs/Integrity"}},required:["format_version","instrument_version","export_timestamp","design","variable_lists","integrity"],additionalProperties:!1}},required:["auditomatic_design_export"],additionalProperties:!1,$defs:{Design:{type:"object",properties:{id:{type:["integer","null"]},name:{type:"string"},description:{type:"string"},prompt_template:{type:"string"},variables:{type:"object",additionalProperties:{type:"array",items:{type:"string"}}},variable_list_refs:{type:"object",additionalProperties:{type:["integer","string"]}},attribute_keys:{type:"object",additionalProperties:{type:"array",items:{type:"string"}}},output_format:{type:"string",enum:["text","json"]},output_type:{type:"string"},extract_pattern:{oneOf:[{type:"string"},{type:"object",properties:{match:{type:"string"},replace:{type:"string"}},required:["match"]}]},refusal_words:{type:"array",items:{type:"string"}},reject_refusal_words:{type:"boolean"},created_at:{type:"string",format:"date-time"},updated_at:{type:"string",format:"date-time"}},required:["name","prompt_template","variables","created_at","updated_at"]},VariableList:{type:"object",properties:{id:{type:["integer","null"]},name:{type:"string"},description:{type:"string"},values:{type:"array",items:{type:"string"}},category:{type:"string",enum:["general","attributed"]},attribute_keys:{type:"array",items:{type:"string"}},attributed_items:{type:"array",items:{type:"object",properties:{value:{type:"string"},attributes:{type:"object",additionalProperties:{type:"string"}}},required:["value","attributes"]}},created_at:{type:"string",format:"date-time"},updated_at:{type:"string",format:"date-time"},checksum:{type:"string",pattern:"^sha256:[a-f0-9]{64}$"}},required:["name","values","created_at","updated_at","checksum"]},Integrity:{type:"object",properties:{design_checksum:{type:"string",pattern:"^sha256:[a-f0-9]{64}$"},variable_lists_count:{type:"integer",minimum:0},total_variable_combinations:{type:"integer",minimum:1},validation_errors:{type:"array",items:{type:"string"}}},required:["design_checksum","variable_lists_count","total_variable_combinations","validation_errors"]}}};const di=new class{constructor(){t(this,"ajv"),t(this,"initialized",!1),this.ajv=new ai({allErrors:!0,verbose:!1,strict:!1,validateSchema:!1});try{ii(this.ajv),this.ajv.addSchema(li,"export-v1"),this.ajv.addSchema(ci,"design-export-v1"),this.initialized=!0}catch(e){console.warn("Schema validator initialization failed:",e),this.initialized=!1}}validateRunExport(e){if(!this.initialized)return{valid:!1,errors:["Schema validator not initialized - validation skipped"]};const t=this.ajv.getSchema("export-v1");if(!t)return{valid:!1,errors:["Schema not found: export-v1"]};try{const r=t(e);return{valid:r,errors:r?[]:this.formatErrors(t.errors||[])}}catch(r){return{valid:!1,errors:[`Validation error: ${r instanceof Error?r.message:"Unknown error"}`]}}}validateDesignExport(e){if(!this.initialized)return{valid:!1,errors:["Schema validator not initialized - validation skipped"]};const t=this.ajv.getSchema("design-export-v1");if(!t)return{valid:!1,errors:["Schema not found: design-export-v1"]};try{const r=t(e);return{valid:r,errors:r?[]:this.formatErrors(t.errors||[])}}catch(r){return{valid:!1,errors:[`Validation error: ${r instanceof Error?r.message:"Unknown error"}`]}}}validateExport(e){return e&&"object"==typeof e&&"auditomatic_export"in e?this.validateRunExport(e):e&&"object"==typeof e&&"auditomatic_design_export"in e?this.validateDesignExport(e):{valid:!1,errors:["Unknown export format - missing auditomatic_export or auditomatic_design_export root property"]}}formatErrors(e){return e.map(e=>{const t=e.instancePath||"root",r=e.message||"validation failed";return"required"===e.keyword?`Missing required property: ${t}/${e.params.missingProperty}`:"type"===e.keyword?`Invalid type at ${t}: expected ${e.params.type}, got ${typeof e.data}`:"enum"===e.keyword?`Invalid value at ${t}: must be one of [${e.params.allowedValues.join(", ")}]`:"format"===e.keyword?`Invalid format at ${t}: ${r}`:`Validation error at ${t}: ${r}`})}getSchemaInfo(){return{availableSchemas:["export-v1","design-export-v1"],ajvVersion:"8.17.1"}}};async function ui(e){const t=JSON.stringify(e,null,0),r=(new TextEncoder).encode(t),a=await crypto.subtle.digest("SHA-256",r);return`sha256:${Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}`}function pi(e){const t=[];try{const a=(r=e,di.validateExport(r));a.valid||t.push(...a.errors.map(e=>`Schema validation: ${e}`))}catch(a){t.push(`Schema validation failed: ${a instanceof Error?a.message:"Unknown error"}`)}var r;if("auditomatic_export"in e){const r=e.auditomatic_export;r.measurements.length!==r.integrity.measurement_count&&t.push(`Measurement count mismatch: expected ${r.integrity.measurement_count}, got ${r.measurements.length}`);const{expected_tasks:a,actual_tasks:s}=r.integrity.completeness_check;s!==r.measurements.length&&t.push(`Task count inconsistency: integrity reports ${s}, but found ${r.measurements.length} measurements`);const o=new Set(r.execution.model_configuration.models),n=new Set(r.measurements.map(e=>e.model));for(const e of n)o.has(e)||t.push(`Model '${e}' used in measurements but not declared in configuration`);const i=new Date(r.export_timestamp);isNaN(i.getTime())&&t.push("Invalid export_timestamp format"),r.integrity.checksum.startsWith("sha256:")&&71===r.integrity.checksum.length||t.push('Invalid checksum format - must be "sha256:" followed by 64 hex characters')}return t}function mi(e,t,r="application/json"){const a=new Blob([e],{type:r}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}function fi(){const e=async(e,t)=>{const r=new Set;e.forEach(e=>{Object.keys(e.variables||{}).forEach(e=>{r.add(e)})});const a=Array.from(r).sort(),s=["Task ID","Model","Status","Response Time (ms)",...a,"Raw Response","Extracted Value","Error","Timestamp"],o=e.map(e=>[e.id||"",e.model,e.status,e.response_time||"",...a.map(t=>e.variables?.[t]||""),e.result||"",e.parsed_results?JSON.stringify(e.parsed_results):"",e.error||"",e.created_at]),n=e=>{let t=String(e);return t.match(/^[=+\-@]/)&&(t="'"+t),`"${t.replace(/"/g,'""')}"`};mi([s.join(","),...o.map(e=>e.map(n).join(","))].join("\n"),t?`results_run_${t}_${(new Date).toISOString().slice(0,10)}.csv`:`results_filtered_${(new Date).toISOString().slice(0,10)}.csv`,"text/csv")};return{exportCSV:e,exportJSON:async(e,t,r)=>{const a={format:"legacy_results_export",run_id:t,exported_at:(new Date).toISOString(),total_tasks:e.length,filters_applied:r,tasks:e},s=t?`results_legacy_run_${t}_${(new Date).toISOString().slice(0,10)}.json`:`results_legacy_filtered_${(new Date).toISOString().slice(0,10)}.json`;mi(JSON.stringify(a,null,2),s,"application/json")},exportStandardizedJSON:async(e,t,r)=>{if(!t)throw new Error("Standardized export requires a specific run ID");try{const[a,s,o]=await Promise.all([S.runs.get(t),S.runs.get(t).then(e=>e?S.designs.get(e.design_id):null),S.variable_lists.toArray()]);if(!a||!s)throw new Error("Run or design data not found");const n=new Map(o.map(e=>[e.id,e])),i={};if(s.variable_list_refs)for(const[e,t]of Object.entries(s.variable_list_refs)){const r="number"==typeof t?t:parseInt(t.toString()),a=n.get(r);if(a){const t=await ui(a);i[e]={name:a.name,id:a.id,checksum:t}}}const l=e.map(e=>{let t=e.api_call_log;if("completed"===e.status&&e.api_call_log){const r=e.api_call_log;r.request?.url&&r.request?.method&&r.request?.body&&r.response?.body||(console.warn(`Task ${e.id} has incomplete API call log - reproducibility may be compromised`),t={...r,metadata:{...r.metadata,_warning:"Incomplete API call log - missing required fields for reproducibility"}})}return{task_id:e.id,model:e.model,variable_assignment:e.variables,prompt:e.prompt,raw_response:e.result||null,extracted_value:e.parsed_results?JSON.stringify(e.parsed_results):null,parsed_results:e.parsed_results||null,response_time_ms:e.response_time||null,token_usage:e.usage||null,timestamp:e.created_at,status:e.status,error:e.error||null,api_call_log:t}}),c=function(e,t,r,a){const s={...e.variables};if(e.variable_list_refs)for(const[i,l]of Object.entries(e.variable_list_refs)){const e="number"==typeof l?l:parseInt(l.toString()),t=Object.values(r).find(t=>t.id===e);t&&("attributed"===t.category&&t.attributed_items?s[i]=t.attributed_items.map(e=>e.value):s[i]=t.values)}const o=Object.values(s),n=a?.repetitions_per_prompt||1;return 0===o.length?t.length*n:o.reduce((e,t)=>e*t.length,1)*t.length*n}(s,a.models,Object.fromEntries(n),{repetitions_per_prompt:a.parameters.repetitions_per_prompt}),d=await S.tasks.where("run_id").equals(t).toArray(),u=function(e,t,r,a){const s=[],o={...e.variables};if(e.variable_list_refs)for(const[c,d]of Object.entries(e.variable_list_refs)){const e="number"==typeof d?d:parseInt(d.toString()),t=Object.values(r).find(t=>t.id===e);t&&("attributed"===t.category&&t.attributed_items?o[c]=t.attributed_items.map(e=>e.value):o[c]=t.values)}const n=Object.keys(o),i=Object.values(o);if(0===i.length){for(const e of t)a.some(t=>t.model===e)||s.push({model:e,variables:{}});return s}const l=function e(t,r=[],a=0){if(a===t.length)return[r];const s=[];for(const o of t[a])s.push(...e(t,[...r,o],a+1));return s}(i);for(const c of t)for(const e of l){const t={};n.forEach((r,a)=>{t[r]=e[a]}),a.some(e=>e.model===c&&Object.entries(t).every(([t,r])=>e.variables[t]===r))||s.push({model:c,variables:t})}return s}(s,a.models,Object.fromEntries(n),d),p=await ui(l),m={auditomatic_export:{format_version:"1.0.0",instrument_version:"auditomatic-lite-v1.0.0",export_timestamp:(new Date).toISOString(),experiment:{design_id:s.id,name:s.name,description:s.description,prompt_template:s.prompt_template,variables:s.variables,variable_list_refs:i,output_format:s.output_format,output_type:s.output_type,extract_pattern:s.extract_pattern,refusal_words:s.refusal_words,reject_refusal_words:s.reject_refusal_words,created_at:s.created_at,updated_at:s.updated_at},execution:{run_id:a.id,run_name:a.name,started_at:a.created_at,completed_at:a.completed_at||null,model_configuration:{models:a.models,parameters:a.parameters},total_tasks:a.total_tasks,completed_tasks:a.completed_tasks,error_count:a.error_count,status:a.status},measurements:l,integrity:{measurement_count:l.length,checksum:p,validation_errors:[],completeness_check:{expected_tasks:c,actual_tasks:l.length,missing_tasks:u}}}};r&&Object.keys(r).length>0&&(m.auditomatic_export.export_metadata={filtered:!0,filters_applied:r,original_task_count:d.length});const f=pi(m);if(m.auditomatic_export.integrity.validation_errors=f,f.length>0)throw new Error(`Export validation failed with ${f.length} error(s):\n${f.join("\n")}`);const h=function(e,t,r,a){const s=a||new Date,o=s.toISOString().slice(0,10).replace(/-/g,""),n=s.toISOString().slice(11,19).replace(/:/g,""),i=t.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");switch(e){case"run":return`${i}_${o}_${n}_run${r||""}.json`;case"design":return`${i}_design${r||""}_${o}.json`;case"full-db":return`auditomatic_full_export_${o}_${n}.json`;default:return`auditomatic_export_${o}_${n}.json`}}("run",s.name,a.id,new Date);return mi(JSON.stringify(m,null,2),h,"application/json"),function(e,t,r,a,s=[],o){return{success:e,filename:t,recordCount:r,checksum:a,validationErrors:s,warning:o}}(!0,h,l.length,p,f,void 0)}catch(a){throw new Error(`Failed to create standardized export: ${a instanceof Error?a.message:"Unknown error"}`)}},exportExcel:async(t,r)=>{await e(t,r)}}}const hi={class:"pivot-table-wrapper"},vi=E(r({__name:"PivotTable",props:{tasks:{}},emits:["cell-click"],setup(e,{emit:t}){const r=e,s=t,{exportCSV:o}=fi(),l=a({rowField:"",columnField:"model",valueField:"match_1",aggregation:"mean"});function d(e){l.value=e}function p(e){e.cell&&s("cell-click",{row:e.row,column:e.column,tasks:e.cell.tasks})}async function m(){await o(r.tasks,null)}return(e,t)=>(i(),n("div",hi,[t[1]||(t[1]=c("div",{class:"pivot-header"},[c("h3",null,"Pivot Table Analysis"),c("p",{class:"pivot-description"}," Analyze your results by grouping data across different dimensions and aggregating values. ")],-1)),g(x,{tasks:e.tasks,config:l.value,"max-table-rows":1e4,"show-totals":!0,"hide-view-toggle":!1,onConfigChange:d,onCellClick:p},null,8,["tasks","config"]),c("div",{class:"export-controls"},[c("button",{class:"export-btn",onClick:m},t[0]||(t[0]=[c("svg",{class:"icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c("polyline",{points:"7 10 12 15 17 10"}),c("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),u(" Export Pivot Data ")]))])]))}}),[["__scopeId","data-v-4fe8c0b3"]]),yi={class:"filters-section"},gi={class:"filters-header"},_i={class:"filters-grid"},$i={class:"filter-group"},bi=["value"],wi={class:"filter-group"},ki=["value"],Si=["value"],Ei={class:"filter-group"},Pi=["value"],xi=["value","onChange"],ji={value:""},Ci=["value"],Ri=E(r({__name:"ResultsFilters",props:{filters:{},uniqueModels:{},availableVariables:{},getVariableValues:{type:Function}},emits:["update-filter","update-variable-filter","reset-filters"],setup(e,{emit:t}){const r=t,a=(e,t)=>{r("update-filter",e,t)};return(e,t)=>(i(),n("div",yi,[c("div",gi,[t[4]||(t[4]=c("h3",null,"Filters & Search",-1)),c("button",{class:"btn btn-secondary btn-sm",onClick:t[0]||(t[0]=t=>e.$emit("reset-filters"))}," Reset All ")]),c("div",_i,[c("div",$i,[t[5]||(t[5]=c("label",null,"Search Results:",-1)),c("input",{value:e.filters.search,type:"text",class:"form-control",placeholder:"Search in results content...",onInput:t[1]||(t[1]=e=>a("search",e.target.value))},null,40,bi)]),c("div",wi,[t[7]||(t[7]=c("label",null,"Model:",-1)),c("select",{value:e.filters.model,class:"form-control",onChange:t[2]||(t[2]=e=>a("model",e.target.value))},[t[6]||(t[6]=c("option",{value:""}," All Models ",-1)),(i(!0),n(h,null,v(e.uniqueModels,e=>(i(),n("option",{key:e,value:e},d(e),9,Si))),128))],40,ki)]),c("div",Ei,[t[9]||(t[9]=c("label",null,"Status:",-1)),c("select",{value:e.filters.status,class:"form-control",onChange:t[3]||(t[3]=e=>a("status",e.target.value))},t[8]||(t[8]=[c("option",{value:""}," All Statuses ",-1),c("option",{value:"completed"}," Completed ",-1),c("option",{value:"error"}," Error ",-1),c("option",{value:"processing"}," Processing ",-1)]),40,Pi)]),(i(!0),n(h,null,v(e.availableVariables,t=>(i(),n("div",{key:t,class:"filter-group"},[c("label",null,d(t)+":",1),c("select",{value:e.filters.variables[t]||"",class:"form-control",onChange:e=>((e,t)=>{r("update-variable-filter",e,t)})(t,e.target.value)},[c("option",ji," All "+d(t),1),(i(!0),n(h,null,v(e.getVariableValues(t),e=>(i(),n("option",{key:e,value:e},d(e),9,Ci))),128))],40,xi)]))),128))])]))}}),[["__scopeId","data-v-7f90c34c"]]),Ni={class:"table-view"},Ii={class:"table-section"},Oi={class:"table-header"},Ti={class:"table-controls"},Mi={class:"results-count"},Di={class:"export-buttons"},Vi={class:"table-container"},Ai={class:"results-table"},zi=["onClick"],qi={class:"model-name"},Fi=["onClick"],Ui={class:"variables-compact"},Li={class:"var-key"},Ki={class:"var-value"},Bi={class:"status-cell"},Gi=["title"],Ji=["onClick"],Hi=["title"],Wi={class:"raw-text"},Qi=["onClick"],Zi={class:"parsed-content"},Xi={key:0,class:"parsed-items"},Yi={class:"parsed-key"},el={key:1,class:"no-parsing"},tl={class:"time-cell"},rl={class:"timing-info"},al={class:"response-time"},sl={key:0,class:"timestamp"},ol={class:"actions-cell"},nl=["onClick"],il=E(r({__name:"ResultsTable",props:{tasks:{},resultsCount:{},getSortIcon:{type:Function}},emits:["export-csv","export-json","export-excel","sort-by","view-task"],setup(e,{emit:t}){const r=t,a=(e,t)=>!e||e.length<=t?e:e.substring(0,t)+"...",s=e=>null==e?"null":"boolean"==typeof e?e?"true":"false":"number"==typeof e?e.toString():"object"==typeof e?JSON.stringify(e):String(e),o=e=>null==e?"value-null":"boolean"==typeof e?e?"value-true":"value-false":"number"==typeof e?"value-number":"object"==typeof e?"value-object":"value-string";return(e,t)=>(i(),n("div",Ni,[c("div",Ii,[c("div",Oi,[t[6]||(t[6]=c("h3",null,"Results Data",-1)),c("div",Ti,[c("span",Mi,d(e.resultsCount),1),c("div",Di,[c("button",{class:"btn btn-secondary btn-sm",onClick:t[0]||(t[0]=e=>r("export-csv"))}," 📄 CSV "),c("button",{class:"btn btn-secondary btn-sm",onClick:t[1]||(t[1]=e=>r("export-json"))}," 📋 JSON "),c("button",{class:"btn btn-secondary btn-sm",onClick:t[2]||(t[2]=e=>r("export-excel"))}," 📊 Excel ")])])]),c("div",Vi,[c("table",Ai,[c("thead",null,[c("tr",null,[c("th",{class:"sortable",onClick:t[3]||(t[3]=e=>r("sort-by","model"))}," Model "+d(e.getSortIcon("model")),1),t[7]||(t[7]=c("th",{class:"variables-header"}," Variables ",-1)),c("th",{class:"sortable",onClick:t[4]||(t[4]=e=>r("sort-by","status"))}," Status "+d(e.getSortIcon("status")),1),t[8]||(t[8]=c("th",null,"Raw Response",-1)),t[9]||(t[9]=c("th",null,"Parsed Results",-1)),c("th",{class:"sortable",onClick:t[5]||(t[5]=e=>r("sort-by","response_time"))}," Time "+d(e.getSortIcon("response_time")),1),t[10]||(t[10]=c("th",null,"Actions",-1))])]),c("tbody",null,[(i(!0),n(h,null,v(e.tasks,e=>{return i(),n("tr",{key:e.id,class:"data-row"},[c("td",{class:"model-cell clickable",onClick:t=>r("view-task",e)},[c("span",qi,d(e.model),1)],8,zi),c("td",{class:"variables-cell clickable",onClick:t=>r("view-task",e)},[c("div",Ui,[(i(!0),n(h,null,v(e.variables,(e,t)=>(i(),n("div",{key:t,class:"variable-compact"},[c("span",Li,d(t)+":",1),c("span",Ki,d(a(String(e),20)),1)]))),128))])],8,Fi),c("td",Bi,[c("span",{class:l(["status-badge",`status-${e.status}`])},d(e.status),3),e.error?(i(),n("div",{key:0,class:"error-indicator",title:e.error}," ⚠️ ",8,Gi)):p("",!0)]),c("td",{class:"raw-response-cell clickable",onClick:t=>r("view-task",e)},[c("div",{class:"response-content",title:e.result},[c("pre",Wi,d(a(e.result||e.error||"No result",150)),1)],8,Hi)],8,Ji),c("td",{class:"parsed-results-cell clickable",onClick:t=>r("view-task",e)},[c("div",Zi,[e.parsed_results?(i(),n("div",Xi,[(i(!0),n(h,null,v(e.parsed_results,(e,t)=>(i(),n("div",{key:t,class:"parsed-item"},[c("span",Yi,d(t)+":",1),c("span",{class:l(["parsed-value",o(e)])},d(s(e)),3)]))),128))])):(i(),n("span",el,"No parsing"))])],8,Qi),c("td",tl,[c("div",rl,[c("div",al,d(e.response_time||"-")+"ms ",1),e.created_at?(i(),n("div",sl,d((t=e.created_at,new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}))),1)):p("",!0)])]),c("td",ol,[c("button",{class:"btn btn-sm btn-outline",onClick:t=>r("view-task",e)}," 📋 ",8,nl)])]);var t}),128))])])])])]))}}),[["__scopeId","data-v-872dcf2f"]]),ll={class:"summary-view"},cl={class:"summary-cards"},dl={class:"summary-card"},ul={class:"card-content"},pl={class:"card-value"},ml={class:"card-percentage"},fl={class:"summary-card"},hl={class:"card-content"},vl={class:"card-value"},yl={class:"card-percentage"},gl={class:"summary-card"},_l={class:"card-content"},$l={class:"card-value"},bl={class:"card-sublabel"},wl={class:"summary-card"},kl={class:"card-content"},Sl={class:"card-value"},El={class:"card-sublabel"},Pl={class:"summary-card cost-card"},xl={class:"card-content"},jl={class:"card-value cost-value"},Cl={class:"card-sublabel"},Rl={class:"summary-charts"},Nl={class:"chart-section"},Il={class:"model-breakdown"},Ol={class:"model-name"},Tl={class:"model-bar"},Ml={class:"model-percentage"},Dl={class:"model-count"},Vl={class:"chart-section"},Al={class:"variable-breakdown"},zl={class:"variable-values"},ql={class:"value-name"},Fl={class:"value-count"},Ul={class:"value-bar"},Ll=E(r({__name:"SummaryCards",props:{successCount:{},errorCount:{},successRate:{},errorRate:{},avgResponseTime:{},minMaxResponseTime:{},totalTasks:{},uniqueModelCount:{},totalCost:{},avgCostPerTask:{},modelStats:{},variableStats:{},getModelColor:{type:Function}},setup:e=>(e,t)=>(i(),n("div",ll,[c("div",cl,[c("div",dl,[t[1]||(t[1]=c("div",{class:"card-icon"}," 📈 ",-1)),c("div",ul,[c("div",pl,d(e.successCount),1),t[0]||(t[0]=c("div",{class:"card-label"}," Successful ",-1)),c("div",ml,d(e.successRate)+"% ",1)])]),c("div",fl,[t[3]||(t[3]=c("div",{class:"card-icon"}," ⚠️ ",-1)),c("div",hl,[c("div",vl,d(e.errorCount),1),t[2]||(t[2]=c("div",{class:"card-label"}," Failed ",-1)),c("div",yl,d(e.errorRate)+"% ",1)])]),c("div",gl,[t[5]||(t[5]=c("div",{class:"card-icon"}," ⏱️ ",-1)),c("div",_l,[c("div",$l,d(e.avgResponseTime)+"ms ",1),t[4]||(t[4]=c("div",{class:"card-label"}," Avg Response Time ",-1)),c("div",bl,d(e.minMaxResponseTime),1)])]),c("div",wl,[t[7]||(t[7]=c("div",{class:"card-icon"}," 🎯 ",-1)),c("div",kl,[c("div",Sl,d(e.totalTasks),1),t[6]||(t[6]=c("div",{class:"card-label"}," Total Tasks ",-1)),c("div",El,d(e.uniqueModelCount)+" models ",1)])]),c("div",Pl,[t[9]||(t[9]=c("div",{class:"card-icon"}," 💰 ",-1)),c("div",xl,[c("div",jl," $"+d(e.totalCost),1),t[8]||(t[8]=c("div",{class:"card-label"}," Total Cost ",-1)),c("div",Cl,d(e.avgCostPerTask)+" per task ",1)])])]),c("div",Rl,[c("div",Nl,[t[10]||(t[10]=c("h3",null,"Success Rate by Model",-1)),c("div",Il,[(i(!0),n(h,null,v(e.modelStats,t=>(i(),n("div",{key:t.name,class:"model-stat"},[c("div",Ol,d(t.name),1),c("div",Tl,[c("div",{class:"model-bar-fill",style:_({width:t.successRate+"%",backgroundColor:e.getModelColor(t.successRate)})},null,4)]),c("div",Ml,d(t.successRate.toFixed(1))+"% ",1),c("div",Dl," ("+d(t.successful)+"/"+d(t.total)+") ",1)]))),128))])]),c("div",Vl,[t[11]||(t[11]=c("h3",null,"Variable Distribution",-1)),c("div",Al,[(i(!0),n(h,null,v(e.variableStats,e=>(i(),n("div",{key:e.name,class:"variable-stat"},[c("h4",null,d(e.name),1),c("div",zl,[(i(!0),n(h,null,v(e.values,t=>(i(),n("div",{key:t.value,class:"value-stat"},[c("span",ql,d(t.value),1),c("span",Fl,d(t.count)+" tasks",1),c("div",Ul,[c("div",{class:"value-bar-fill",style:_({width:t.count/e.total*100+"%"})},null,4)])]))),128))])]))),128))])])])]))}),[["__scopeId","data-v-97a6bf5b"]]),Kl={class:"analysis-view"},Bl={class:"breadcrumb"},Gl={class:"breadcrumb-current"},Jl={class:"header"},Hl={class:"header-controls"},Wl={key:0,class:"loading-state"},Ql={key:1,class:"no-results"},Zl={class:"no-results-actions"},Xl={key:2,class:"results-container"},Yl={key:0},ec={key:1,class:"pivot-view"},tc={key:2},rc={class:"modal-content"},ac={class:"modal-header"},sc={class:"modal-body"},oc={class:"cell-tasks"},nc={class:"task-result"},ic=["onClick"],lc=E(r({__name:"ResultsAnalysisView",props:{selectedRun:{},tasks:{},filteredTasks:{},filters:{},viewMode:{},loading:{type:Boolean},analysisData:{},getVariableValues:{type:Function},getSortIcon:{type:Function},taskSortBy:{type:Function},resetFilters:{type:Function}},emits:["back-to-selection","update:view-mode","export-run","export-csv","export-json","export-excel","update-filter","update-variable-filter","rerun-analysis"],setup(e,{emit:t}){const r=t,s=a(null),o=a(null);function f(){r("export-run")}function _(){r("export-csv")}function $(){r("export-json")}function b(){r("export-excel")}function w(e,t){r("update-filter",e,t)}function k(e,t){r("update-variable-filter",e,t)}function S(e){s.value=e}function E(e){o.value=e}return(e,t)=>(i(),n("div",Kl,[c("nav",Bl,[c("button",{class:"breadcrumb-link",onClick:t[0]||(t[0]=t=>e.$emit("back-to-selection"))}," ← Results Overview "),t[7]||(t[7]=c("span",{class:"breadcrumb-separator"},"/",-1)),c("span",Gl,d(e.selectedRun.name),1)]),c("div",Jl,[c("h2",null,d(e.selectedRun.name),1),c("div",Hl,[g(me,{"view-mode":e.viewMode,"onUpdate:viewMode":t[1]||(t[1]=t=>e.$emit("update:view-mode",t))},null,8,["view-mode"]),e.tasks.length>0?(i(),n("button",{key:0,class:"btn btn-primary btn-sm export-run-btn",onClick:f}," 📤 Export Run ")):p("",!0)])]),e.loading?(i(),n("div",Wl,t[8]||(t[8]=[c("div",{class:"spinner"},null,-1),c("p",null,"Loading results...",-1)]))):0===e.tasks.length?(i(),n("div",Ql,[t[9]||(t[9]=c("div",{class:"empty-icon"}," ❌ ",-1)),t[10]||(t[10]=c("h3",null,"No results found",-1)),t[11]||(t[11]=c("p",null,"This run doesn't have any completed tasks or results to analyze.",-1)),c("div",Zl,[c("button",{class:"btn btn-outline",onClick:t[2]||(t[2]=t=>e.$emit("back-to-selection"))}," Back to Runs "),c("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=t=>e.$emit("rerun-analysis"))}," Retry Analysis ")])])):(i(),n("div",Xl,["summary"===e.viewMode?(i(),n("div",Yl,[g(Ll,{"success-count":e.analysisData.successCount,"error-count":e.analysisData.errorCount,"success-rate":e.analysisData.successRate,"error-rate":e.analysisData.errorRate,"avg-response-time":e.analysisData.avgResponseTime,"min-max-response-time":e.analysisData.minMaxResponseTime,"total-tasks":e.tasks.length,"unique-model-count":e.analysisData.uniqueModels.length,"total-cost":e.analysisData.totalCost,"avg-cost-per-task":e.analysisData.avgCostPerTask,"model-stats":e.analysisData.modelStats,"variable-stats":e.analysisData.variableStats,"get-model-color":e.analysisData.getModelColor},null,8,["success-count","error-count","success-rate","error-rate","avg-response-time","min-max-response-time","total-tasks","unique-model-count","total-cost","avg-cost-per-task","model-stats","variable-stats","get-model-color"])])):p("",!0),"pivot"===e.viewMode?(i(),n("div",ec,[g(vi,{tasks:e.filteredTasks,onCellClick:E},null,8,["tasks"])])):p("",!0),"table"===e.viewMode?(i(),n("div",tc,[g(Ri,{filters:e.filters,"unique-models":e.analysisData.uniqueModels,"available-variables":e.analysisData.availableVariables,"get-variable-values":e.getVariableValues,onUpdateFilter:w,onUpdateVariableFilter:k,onResetFilters:e.resetFilters},null,8,["filters","unique-models","available-variables","get-variable-values","onResetFilters"]),g(il,{tasks:e.filteredTasks,"results-count":`${e.filteredTasks.length} of ${e.tasks.length} results`,"get-sort-icon":e.getSortIcon,onExportCsv:_,onExportJson:$,onExportExcel:b,onSortBy:e.taskSortBy,onViewTask:S},null,8,["tasks","results-count","get-sort-icon","onSortBy"])])):p("",!0)])),s.value?(i(),y(j,{key:3,task:s.value,onClose:t[4]||(t[4]=e=>s.value=null)},null,8,["task"])):p("",!0),o.value?(i(),n("div",{key:4,class:"modal-overlay",onClick:t[6]||(t[6]=m(e=>o.value=null,["self"]))},[c("div",rc,[c("div",ac,[c("h3",null,d(o.value.row)+" × "+d(o.value.column),1),c("button",{class:"close-btn",onClick:t[5]||(t[5]=e=>o.value=null)}," × ")]),c("div",sc,[c("p",null,[c("strong",null,d(o.value.tasks.length),1),t[12]||(t[12]=u(" tasks in this cell:"))]),c("div",oc,[(i(!0),n(h,null,v(o.value.tasks,e=>{return i(),n("div",{key:e.id,class:"cell-task"},[c("span",{class:l(["task-status",`status-${e.status}`])},d(e.status),3),c("span",nc,d((t=e.result||e.error||"No result",r=80,t.length<=r?t:t.substring(0,r)+"...")),1),c("button",{class:"btn btn-sm btn-outline",onClick:t=>function(e){o.value=null,s.value=e}(e)}," View ",8,ic)]);var t,r}),128))])])])])):p("",!0)]))}}),[["__scopeId","data-v-cc6f818a"]]);const cc={class:"results-view"},dc=E(r({__name:"ResultsView",setup(e){const t=$(),r=b(),l=P(),c=N.getInstance(),d=a("run-selection"),u=a(null),m=a(null),f=a([]),h=a([]),v=a(!1),g=a(!1),_=a("summary"),{showIncompleteRuns:E,sortBy:x,setSortBy:j,filteredRuns:C,hasIncompleteRuns:R}=function(e){const t=a(!1),r=a("created_at"),s=a("desc"),n=o(()=>{let a=e.value;return t.value||(a=a.filter(e=>"completed"===e.status||"stopped"===e.status)),[...a].sort((e,t)=>{let a,o;switch(r.value){case"created_at":a=new Date(e.created_at).getTime(),o=new Date(t.created_at).getTime();break;case"updated_at":a=new Date(e.updated_at||e.created_at).getTime(),o=new Date(t.updated_at||t.created_at).getTime();break;case"name":a=e.name.toLowerCase(),o=t.name.toLowerCase();break;case"status":const r={error:0,running:1,paused:2,completed:3,stopped:4,pending:5,ready:6,draft:7};a=r[e.status]??8,o=r[t.status]??8;break;case"completion":a=e.total_tasks?e.completed_tasks/e.total_tasks:0,o=t.total_tasks?t.completed_tasks/t.total_tasks:0;break;default:return 0}return"desc"===s.value?o<a?-1:o>a?1:0:a<o?-1:a>o?1:0})}),i=o(()=>e.value.some(e=>"completed"!==e.status&&"stopped"!==e.status));return{showIncompleteRuns:t,sortBy:r,sortOrder:s,filteredRuns:n,hasIncompleteRuns:i,setSortBy:e=>{r.value===e?s.value="asc"===s.value?"desc":"asc":(r.value=e,s.value="name"===e?"asc":"desc")},toggleShowIncomplete:()=>{t.value=!t.value}}}(f),{uniqueModels:I,availableVariables:O,successCount:T,errorCount:M,successRate:D,errorRate:V,avgResponseTime:A,minMaxResponseTime:z,modelStats:q,variableStats:F,getModelColor:U}=function(e){const t=o(()=>[...new Set(e.value.map(e=>e.model))].sort()),r=o(()=>{const t=new Set;return e.value.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>t.add(e))}),Array.from(t).sort()}),a=o(()=>e.value.filter(e=>"completed"===e.status).length),s=o(()=>e.value.filter(e=>"error"===e.status).length),n=o(()=>0===e.value.length?0:Math.round(a.value/e.value.length*100)),i=o(()=>0===e.value.length?0:Math.round(s.value/e.value.length*100)),l=o(()=>{const t=e.value.filter(e=>"completed"===e.status&&e.response_time);if(0===t.length)return 0;const r=t.reduce((e,t)=>e+(t.response_time||0),0);return Math.round(r/t.length)}),c=o(()=>{const t=e.value.filter(e=>e.response_time&&e.response_time>0).map(e=>e.response_time);return 0===t.length?"-":`${Math.min(...t)}-${Math.max(...t)}ms`}),d=o(()=>t.value.map(t=>{const r=e.value.filter(e=>e.model===t),a=r.filter(e=>"completed"===e.status).length,s=r.length;return{name:t,successful:a,total:s,successRate:s>0?a/s*100:0}}).sort((e,t)=>t.successRate-e.successRate)),u=o(()=>r.value.map(t=>{const r=new Map;let a=0;e.value.forEach(e=>{if(e.variables&&e.variables[t]){const s=String(e.variables[t]);r.set(s,(r.get(s)||0)+1),a++}});const s=Array.from(r.entries()).map(([e,t])=>({value:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10);return{name:t,values:s,total:a}}));return{uniqueModels:t,availableVariables:r,successCount:a,errorCount:s,successRate:n,errorRate:i,avgResponseTime:l,minMaxResponseTime:c,modelStats:d,variableStats:u,getModelColor:e=>e>=80?"#10b981":e>=60?"#fbbf24":"#ef4444"}}(h),{filters:L,filteredTasks:K,getVariableValues:B,resetFilters:G,sortBy:J,getSortIcon:H}=function(e){const t=a({search:"",model:"",status:"",variables:{}}),r=a(""),s=a("asc"),n=o(()=>{let a=[...e.value];if(t.value.search){const e=t.value.search.toLowerCase();a=a.filter(t=>(t.result||"").toLowerCase().includes(e)||(t.error||"").toLowerCase().includes(e)||t.model.toLowerCase().includes(e))}return t.value.model&&(a=a.filter(e=>e.model===t.value.model)),t.value.status&&(a=a.filter(e=>e.status===t.value.status)),Object.entries(t.value.variables).forEach(([e,t])=>{t&&(a=a.filter(r=>r.variables&&String(r.variables[e])===t))}),r.value&&a.sort((e,t)=>{let a,o;switch(r.value){case"model":a=e.model,o=t.model;break;case"status":a=e.status,o=t.status;break;case"response_time":a=e.response_time||0,o=t.response_time||0;break;default:return 0}return a<o?"asc"===s.value?-1:1:a>o?"asc"===s.value?1:-1:0}),a});return{filters:t,filteredTasks:n,getVariableValues:t=>{const r=new Set;return e.value.forEach(e=>{e.variables&&e.variables[t]&&r.add(String(e.variables[t]))}),Array.from(r).sort()},resetFilters:()=>{t.value={search:"",model:"",status:"",variables:{}}},sortBy:e=>{r.value===e?s.value="asc"===s.value?"desc":"asc":(r.value=e,s.value="asc")},getSortIcon:e=>r.value!==e?"":"asc"===s.value?"↑":"↓"}}(h),{resetPagination:W}=function(e,t=50){const r=a(1),s=o(()=>Math.ceil(e.value.length/t)),n=o(()=>{const a=(r.value-1)*t,s=a+t;return e.value.slice(a,s)});return{currentPage:r,totalPages:s,paginatedTasks:n,resetPagination:()=>{r.value=1}}}(K),{exportCSV:Q,exportJSON:Z,exportExcel:X}=fi(),Y=o(()=>({successCount:T.value,errorCount:M.value,successRate:D.value,errorRate:V.value,avgResponseTime:A.value,minMaxResponseTime:z.value,uniqueModels:I.value,availableVariables:O.value,totalCost:ee.value,avgCostPerTask:te.value,modelStats:q.value.map(e=>({name:e.name,successful:e.successful,total:e.total,successRate:e.successRate})),variableStats:F.value.map(e=>({name:e.name,values:e.values,total:e.total})),getModelColor:e=>U(e)})),ee=o(()=>c.calculateExportStats(h.value).totalCost),te=o(()=>c.calculateExportStats(h.value).avgCostPerTask);async function re(){g.value=!0;try{await l.loadRuns();const{runs:e}=w(l);f.value=e.value}catch(e){console.error("Error loading runs:",e)}finally{g.value=!1}}async function ae(){if(u.value){v.value=!0;try{h.value=await S.tasks.where("run_id").equals(u.value).toArray(),G(),W()}catch(e){console.error("Error loading results:",e)}finally{v.value=!1}}}function se(e){u.value=e.id,m.value=e}async function oe(e){se(e),d.value="analysis",await ae(),r.replace(`/results/${e.id}`)}function ne(){d.value="run-selection",u.value=null,m.value=null,h.value=[],r.replace("/results")}async function ie(e){r.push(`/runs/edit/${e.id}`)}async function ce(e){try{await S.runs.delete(e.id),await re(),u.value===e.id&&ne()}catch(t){console.error("Error deleting run:",t),alert("Failed to delete run")}}function de(){r.push("/runs/new")}async function ue(){if(m.value&&0!==h.value.length)try{const e=c.calculateExportStats(h.value);await c.exportRunAsJSON(m.value,h.value,e)}catch(e){console.error("Error exporting run:",e),alert("Failed to export run")}}s(async()=>{if(await re(),t.params.id){const e=Number(t.params.id),r=f.value.find(t=>t.id===e);r&&await oe(r)}});const pe=(e,t)=>{L.value[e]=t,W()},me=(e,t)=>{L.value.variables[e]=t,W()},fe=()=>{Q(K.value,u.value)},he=()=>{Z(K.value,u.value,L.value)},ve=()=>{X(K.value,u.value)};return(e,t)=>(i(),n("div",cc,["run-selection"===d.value?(i(),y(le,{key:0,runs:f.value,"filtered-runs":k(C),loading:g.value,"selected-run-id":u.value,"show-incomplete-runs":k(E),"sort-by":k(x),"has-incomplete-runs":k(R),onSelectRun:se,onViewResults:oe,onEditRun:ie,onDeleteRun:ce,onCreateRun:de,onRefreshRuns:re,"onUpdate:showIncomplete":t[0]||(t[0]=e=>E.value=e),"onUpdate:sortBy":t[1]||(t[1]=e=>k(j)(e))},null,8,["runs","filtered-runs","loading","selected-run-id","show-incomplete-runs","sort-by","has-incomplete-runs"])):"analysis"===d.value&&m.value?(i(),y(lc,{key:1,"selected-run":m.value,tasks:h.value,"filtered-tasks":k(K),filters:k(L),"view-mode":_.value,loading:v.value,"analysis-data":Y.value,"get-variable-values":k(B),"get-sort-icon":k(H),"task-sort-by":k(J),"reset-filters":k(G),onBackToSelection:ne,"onUpdate:viewMode":t[2]||(t[2]=e=>_.value=e),onExportRun:ue,onExportCsv:fe,onExportJson:he,onExportExcel:ve,onUpdateFilter:pe,onUpdateVariableFilter:me,onRerunAnalysis:ae},null,8,["selected-run","tasks","filtered-tasks","filters","view-mode","loading","analysis-data","get-variable-values","get-sort-icon","task-sort-by","reset-filters"])):p("",!0)]))}}),[["__scopeId","data-v-53b9bd93"]]);export{dc as default};

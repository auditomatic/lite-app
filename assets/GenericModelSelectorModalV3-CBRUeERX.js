import{d as oe,c as R,V as f,_ as a,W as p,k as O,a1 as w,a5 as ie,F as W,a2 as C,G as E,X as b,f as H,$ as M,a0 as h,Y as Z,B as ve,u as Y,r as ue,w as se,o as de,Z as ge}from"./vue-vendor-BZxY9vkr.js";import{u as ke}from"./useV4Models-CKX4qZvU.js";import{u as re}from"./useV4ProviderParameters-BOtVSooM.js";import{e as ne,j as _e,a as x,k as he}from"./index-BRQLqOf1.js";import{u as Ce}from"./useCostEstimation-Dx3JjXP0.js";import{w as $e,x as ye,I as Me,S as be}from"./ui-vendor-DgwC-sRC.js";const Te={class:"model-search-filters"},xe={class:"panel-header"},Pe={class:"search-container"},Oe=oe({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(J,{emit:o}){const t=J,F=o,y=R({get:()=>t.modelValue,set:A=>F("update:modelValue",A)});return(A,P)=>{const V=w("a-input-search");return a(),f("div",Te,[p("div",xe,[P[2]||(P[2]=p("h3",null,"Available Models",-1)),p("div",Pe,[P[1]||(P[1]=p("span",{class:"search-label"},"Search:",-1)),O(V,{value:y.value,"onUpdate:value":P[0]||(P[0]=g=>y.value=g),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),De=ne(Oe,[["__scopeId","data-v-56bdd915"]]),we=["title"],Fe={key:0,class:"cost-group"},Ae={class:"cost-item"},Ie={class:"cost-value"},Ue={class:"cost-value"},Ee={key:1,class:"cost-group"},Ve={class:"enviro-group"},qe={key:0,class:"enviro-item"},Se={key:1,class:"cost-tab"},Re={key:2,class:"enviro-item"},Be={key:3,class:"cost-tab"},Ge={key:4,class:"enviro-item"},ze={key:0,class:"cost-group"},Ne={class:"cost-item"},Ke={class:"cost-value"},je={class:"cost-value"},Le={class:"enviro-group"},We={key:0,class:"enviro-item"},Je={key:1,class:"cost-tab"},Qe={key:2,class:"enviro-item"},Ye={key:3,class:"cost-tab"},He={key:4,class:"enviro-item"},Xe={key:0,class:"cost-item financial"},Ze={key:0,class:"cost-value"},et={key:1,class:"cost-value"},tt={key:1,class:"cost-item environmental"},ot={key:0,class:"enviro-item"},nt={class:"enviro-value"},lt={key:1,class:"enviro-item"},st={class:"enviro-value"},at={key:2,class:"enviro-item"},ut={class:"enviro-value"},it={key:3,class:"cost-unit"},dt=oe({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(J){const o=J,t=_e(),F=R(()=>!0),y=R(()=>t.preferences.showCO2),A=R(()=>t.preferences.showWater),P=R(()=>t.preferences.showElectricity);function V(){if(!o.model.capabilities)return"â€”";const e=o.model.capabilities.inputCostPerToken||0,u=o.model.capabilities.outputCostPerToken||0;if(o.mode==="per-thousand"){const _=(e+u)*1e3;return g(_)}else if(o.mode==="total")if(o.inputTokens!=null&&o.outputTokens!=null){const _=e*o.inputTokens+u*o.outputTokens;return g(_)}else return"??";return"â€”"}function g(e){if(e===0)return"0.00";if(e<.01){let u=2,_=e;for(;_<.1;)_*=10,u++;return e.toFixed(u)}return e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):Math.round(e).toLocaleString()}function $(e){if(e===0)return"0.00";if(e<.01){let u=2,_=e;for(;_<.1;)_*=10,u++;return e.toFixed(u)}return e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):Math.round(e).toLocaleString()}function I(){if(!o.model.capabilities)return"0";const e=(o.model.capabilities.inputCostPerToken||0)*1e3;return $(e)}function B(){if(!o.model.capabilities)return"0";const e=(o.model.capabilities.outputCostPerToken||0)*1e3;return $(e)}function Q(){if(!o.model.capabilities||o.inputTokens==null||o.minOutputTokens==null)return"??";const e=o.model.capabilities.inputCostPerToken||0,u=o.model.capabilities.outputCostPerToken||0,_=e*o.inputTokens+u*o.minOutputTokens;return $(_)}function L(){if(!o.model.capabilities||o.inputTokens==null||o.maxOutputTokens==null)return"??";const e=o.model.capabilities.inputCostPerToken||0,u=o.model.capabilities.outputCostPerToken||0,_=e*o.inputTokens+u*o.maxOutputTokens;return $(_)}function j(e){return"??"}function N(e){return"??"}const U=R(()=>{var S,X;const e=[];e.push("=== ModelCostDisplayV3 Debug ==="),e.push(`Mode: ${o.mode}`),e.push(`Model: ${o.model.provider}:${o.model.modelId}`),e.push(`Layout: ${o.layout}, Size: ${o.size}`),e.push(""),e.push("=== Token Input Data ==="),o.inputTokens&&e.push(`Input Tokens: ${o.inputTokens}`),o.outputTokens&&e.push(`Output Tokens: ${o.outputTokens}`),o.minOutputTokens&&e.push(`Min Output Tokens: ${o.minOutputTokens}`),o.maxOutputTokens&&e.push(`Max Output Tokens: ${o.maxOutputTokens}`),e.push(""),e.push("=== Model Pricing Rates ===");const u=((S=o.model.capabilities)==null?void 0:S.inputCostPerToken)||0,_=((X=o.model.capabilities)==null?void 0:X.outputCostPerToken)||0;if(e.push(`Input Rate: $${u} per token ($${(u*1e3).toFixed(4)}/1K)`),e.push(`Output Rate: $${_} per token ($${(_*1e3).toFixed(4)}/1K)`),e.push(""),e.push(`=== Calculations (Mode: ${o.mode}) ===`),o.mode==="per-thousand"){const q=(u+_)*1e3;e.push(`Combined rate per 1K: ($${u} + $${_}) Ã— 1000 = $${q.toFixed(6)}`),e.push(`Display: ${V()}`)}else if(o.mode==="total"&&o.inputTokens!=null&&o.outputTokens!=null){const q=u*o.inputTokens,z=_*o.outputTokens,n=q+z;e.push(`Input cost: $${u} Ã— ${o.inputTokens} = $${q.toFixed(6)}`),e.push(`Output cost: $${_} Ã— ${o.outputTokens} = $${z.toFixed(6)}`),e.push(`Total cost: $${q.toFixed(6)} + $${z.toFixed(6)} = $${n.toFixed(6)}`),e.push(`Display: ${V()}`)}else if(o.mode==="range"&&o.inputTokens!=null&&o.minOutputTokens!=null&&o.maxOutputTokens!=null){const q=u*o.inputTokens,z=_*o.minOutputTokens,n=_*o.maxOutputTokens,l=q+z,s=q+n;e.push(`Input cost: $${u} Ã— ${o.inputTokens} = $${q.toFixed(6)}`),e.push(`Min output cost: $${_} Ã— ${o.minOutputTokens} = $${z.toFixed(6)}`),e.push(`Max output cost: $${_} Ã— ${o.maxOutputTokens} = $${n.toFixed(6)}`),e.push(`Min total: $${q.toFixed(6)} + $${z.toFixed(6)} = $${l.toFixed(6)}`),e.push(`Max total: $${q.toFixed(6)} + $${n.toFixed(6)} = $${s.toFixed(6)}`),e.push(`Display: ${Q()} - ${L()}`)}else if(o.mode==="input-output"){const q=u*1e3,z=_*1e3;e.push(`Input per 1K: $${u} Ã— 1000 = $${q.toFixed(6)}`),e.push(`Output per 1K: $${_} Ã— 1000 = $${z.toFixed(6)}`),e.push(`Display: $${I()}/1K input + $${B()}/1K output`)}else e.push("No calculations available for this mode/input combination");return e.join(`
`)});function G(){var u,_;const e=U.value;x.info("ðŸ” ModelCostDisplayV3 Debug Info:",{mode:o.mode,model:`${o.model.provider}:${o.model.modelId}`,inputTokens:o.inputTokens,outputTokens:o.outputTokens,minOutputTokens:o.minOutputTokens,maxOutputTokens:o.maxOutputTokens,layout:o.layout,size:o.size,inputRate:(u=o.model.capabilities)==null?void 0:u.inputCostPerToken,outputRate:(_=o.model.capabilities)==null?void 0:_.outputCostPerToken,calculations:e.split(`
`).filter(S=>S.includes("=")).join(" | ")}),x.info(`ðŸ“Š ModelCostDisplayV3 Full Debug:
`+e)}return(e,u)=>(a(),f("div",{class:ie(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]]),title:U.value,onMouseenter:G},[e.mode==="range"?(a(),f(W,{key:0},[F.value&&e.maxOutputTokens?(a(),f("span",Fe,[p("span",Ae,[u[0]||(u[0]=p("span",{class:"debug-mode"},"range:",-1)),p("span",Ie,"$"+b(Q()),1),u[1]||(u[1]=E(" - ")),p("span",Ue,"$"+b(L()),1)])])):F.value?(a(),f("span",Ee,u[2]||(u[2]=[p("span",{class:"cost-item"},[p("span",{class:"debug-mode"},"range:"),p("span",{class:"cost-value"},"Cost: ??")],-1)]))):C("",!0),u[3]||(u[3]=p("span",{class:"cost-tab"},null,-1)),p("span",Ve,[y.value?(a(),f("span",qe,"COâ‚‚ "+b(N()),1)):C("",!0),y.value&&A.value?(a(),f("span",Se)):C("",!0),A.value?(a(),f("span",Re,"ðŸ’§"+b(N()),1)):C("",!0),(y.value||A.value)&&P.value?(a(),f("span",Be)):C("",!0),P.value?(a(),f("span",Ge,"âš¡"+b(N()),1)):C("",!0)])],64)):e.mode==="input-output"?(a(),f(W,{key:1},[F.value?(a(),f("span",ze,[p("span",Ne,[u[4]||(u[4]=p("span",{class:"debug-mode"},"input-output:",-1)),p("span",Ke,"$"+b(I()),1),u[5]||(u[5]=E("/1K input + ")),p("span",je,"$"+b(B()),1),u[6]||(u[6]=E("/1K output "))])])):C("",!0),u[7]||(u[7]=p("span",{class:"cost-tab"},null,-1)),p("span",Le,[y.value?(a(),f("span",We,"COâ‚‚ "+b(j()),1)):C("",!0),y.value&&A.value?(a(),f("span",Je)):C("",!0),A.value?(a(),f("span",Qe,"ðŸ’§"+b(j()),1)):C("",!0),(y.value||A.value)&&P.value?(a(),f("span",Ye)):C("",!0),P.value?(a(),f("span",He,"âš¡"+b(j()),1)):C("",!0)])],64)):(a(),f(W,{key:2},[F.value?(a(),f("div",Xe,[e.mode==="per-thousand"?(a(),f("span",Ze,[u[8]||(u[8]=p("span",{class:"debug-mode"},"per-thousand:",-1)),E(" "+b(V())+" ",1),u[9]||(u[9]=p("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):e.mode==="total"?(a(),f("span",et,[u[10]||(u[10]=p("span",{class:"debug-mode"},"total:",-1)),E(" "+b(V()),1)])):C("",!0)])):C("",!0),y.value||A.value||P.value?(a(),f("div",tt,[y.value?(a(),f("span",ot,[u[11]||(u[11]=p("span",{class:"enviro-icon"},"COâ‚‚",-1)),p("span",nt,b(j()),1)])):C("",!0),A.value?(a(),f("span",lt,[u[12]||(u[12]=p("span",{class:"enviro-icon"},"ðŸ’§",-1)),p("span",st,b(j()),1)])):C("",!0),P.value?(a(),f("span",at,[u[13]||(u[13]=p("span",{class:"enviro-icon"},"âš¡",-1)),p("span",ut,b(j()),1)])):C("",!0),e.mode==="per-thousand"?(a(),f("span",it,"/ 1,000")):C("",!0)])):C("",!0)],64))],42,we))}}),ce=ne(dt,[["__scopeId","data-v-9626c100"]]),rt={class:"provider-header"},ct={class:"provider-name"},pt={class:"provider-model-count"},mt={key:0,class:"api-key-warning"},ft={class:"provider-models"},vt=["onClick"],gt={class:"model-name"},kt={key:0,class:"model-specs"},_t=oe({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(J){const o=H(void 0);function t(y){return y}function F(y){o.value===y?o.value=void 0:o.value=y}return(y,A)=>{const P=w("a-button"),V=w("a-collapse-panel"),g=w("a-collapse");return a(),M(g,{activeKey:o.value,"onUpdate:activeKey":A[0]||(A[0]=$=>o.value=$),bordered:!1,accordion:""},{default:h(()=>[(a(!0),f(W,null,Z(y.groupedModels,($,I)=>(a(),M(V,{key:I,class:"provider-panel","data-provider":I},{header:h(()=>[p("div",rt,[p("span",ct,b(I),1),p("span",pt,b($.length)+" models",1),y.requiresApiKey(I)&&!y.hasApiKey(y.getProviderGroup(I))?(a(),f("div",mt,[O(Y($e)),A[1]||(A[1]=p("span",null,"API Key Missing",-1))])):C("",!0)])]),extra:h(()=>[O(P,{size:"small",type:"text",onClick:ve(B=>F(I),["stop"])},{default:h(()=>[E(b(o.value===I?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:h(()=>[p("div",ft,[(a(!0),f(W,null,Z($,B=>(a(),f("div",{key:B.id,class:ie(["model-row",{selected:y.selectedModelId===B.id}]),onClick:Q=>y.$emit("select-model",B)},[p("div",gt,b(B.displayName),1),y.hasConfigPanel?C("",!0):(a(),f("div",kt,[O(ce,{model:B,mode:y.mode==="trial"?"range":"input-output","input-tokens":y.getInputTokensForModel(B),"min-output-tokens":10,"max-output-tokens":y.getOutputTokensForModel(B),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,vt))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),ht=ne(_t,[["__scopeId","data-v-7ff59b1f"]]),Ct={class:"config-panel"},$t={class:"config-header"},yt={class:"config-header-title"},Mt={key:0,class:"total-cost"},bt={key:0,class:"cost-info"},Tt={class:"config-content"},xt={class:"param-description"},Pt={class:"param-description"},Ot={key:0,class:"config-footer"},Dt={key:0,class:"duplicate-error"},wt=oe({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},tokenData:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(J,{emit:o}){const t=J,F=o,{getBasicParameters:y,getAdvancedParameters:A,getParametersForModel:P}=re(),V=H(""),g=ue({}),$=ue({}),I=H(""),B=R(()=>t.selectedModel?y(t.selectedModel.provider,t.selectedModel.modelId):{}),Q=R(()=>t.selectedModel?A(t.selectedModel.provider,t.selectedModel.modelId):{}),L=R(()=>{var l,s,c;if(t.tokenData)return t.tokenData.totalTokens;const n=((s=(l=t.costEstimate)==null?void 0:l.inputTokens)==null?void 0:s.avgTokens)??((c=t.getInputTokensForModel)==null?void 0:c.call(t,t.selectedModel));return n==null?null:n*(t.totalCalls??1)}),j=R(()=>{var l,s;const n=(l=t.getOutputTokensForModel)==null?void 0:l.call(t,t.selectedModel);return(s=t.costEstimate)!=null&&s.outputTokens&&t.tokenData?t.costEstimate.outputTokens*t.tokenData.combinationCount:n??null}),N=R(()=>{if(t.tokenData)return 10*t.tokenData.combinationCount;const n=t.totalCalls;return n==null?null:10*n}),U=R(()=>{var n;return((n=t.getOutputTokensForModel)==null?void 0:n.call(t,t.selectedModel))??null});function G(n){if(!n)return;x.info("PARAMDEBUG: setModelDefaults called for",n.provider,n.modelId,"mode:",t.mode),t.mode==="trial"&&(V.value=n.displayName),Object.keys(g).forEach(s=>delete g[s]),Object.keys($).forEach(s=>delete $[s]);const l=P(n.provider,n.modelId);if(t.initialParameters&&Object.keys(t.initialParameters).length>0){x.info("PARAMDEBUG: using initial parameters:",t.initialParameters),Object.assign(g,t.initialParameters);for(const[s,c]of Object.entries(t.initialParameters)){const i=l[s];c===(i==null?void 0:i.default)?$[s]={mode:"default"}:$[s]={mode:"custom",value:c}}}else{x.info("PARAMDEBUG: allParams found:",Object.keys(l));for(const[s,c]of Object.entries(l))c.required?c.default!==void 0?($[s]={mode:"default"},g[s]=c.default,x.info("PARAMDEBUG: setting required param",s,"to default =",c.default)):($[s]={mode:"custom",value:null},g[s]=null,x.info("PARAMDEBUG: required param",s,"needs user input")):c.default!==void 0?($[s]={mode:"default"},g[s]=c.default,x.info("PARAMDEBUG: setting optional param",s,"to default =",c.default)):($[s]={mode:"unset"},g[s]=null,x.info("PARAMDEBUG: optional param",s,"starts unset"));x.info("PARAMDEBUG: final parameters:",{...g}),x.info("PARAMDEBUG: parameter states:",{...$})}}se(()=>t.selectedModel,n=>{G(n),I.value=""},{immediate:!0}),se(g,()=>{I.value=""},{deep:!0}),de(()=>{t.selectedModel&&G(t.selectedModel)});function e(n,l){const s=$[n],c=g[n];return x.info("PLACEHOLDER DEBUG:",n,"state:",s==null?void 0:s.mode,"value:",c,"param.default:",l.default),!l.required&&(c==null||c==="")||(s==null?void 0:s.mode)==="unset"?"Not set (parameter will be omitted)":l.default!==void 0?(s==null?void 0:s.mode)==="default"?`Using default: ${l.default}`:`Default: ${l.default} (enter to override)`:l.required?"Required - enter value":"Enter value (optional)"}function u(n){const l=$[n],s=t.selectedModel?P(t.selectedModel.provider,t.selectedModel.modelId)[n]:void 0;if(s!=null&&s.required&&(l==null?void 0:l.mode)==="unset"||s!=null&&s.required&&(l==null?void 0:l.mode)==="custom"&&!l.value)return"error";if((l==null?void 0:l.mode)==="default")return"warning"}function _(n){return n.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,l=>l.toUpperCase())}function S(n,l,s){x.info("PARAMDEBUG: handleParameterChange",n,"new value:",l,"param.required:",s.required),l==null||l===""?s!=null&&s.required?s.default!==void 0&&(g[n]=s.default,$[n]={mode:"default"},x.info("PARAMDEBUG: Required param",n,"cleared, reverting to default:",s.default)):(g[n]=null,$[n]={mode:"unset"},x.info("PARAMDEBUG: Optional param",n,"cleared, setting to unset")):(g[n]=l,l===(s==null?void 0:s.default)?$[n]={mode:"default"}:$[n]={mode:"custom",value:l}),F("parameters-changed",{...g})}function X(){const n=[],l=t.selectedModel?P(t.selectedModel.provider,t.selectedModel.modelId):{};for(const[s,c]of Object.entries($)){const i=l[s];i!=null&&i.required&&(c.mode==="unset"?n.push(`${_(s)} is required`):c.mode==="custom"&&(c.value===null||c.value===void 0||c.value==="")&&n.push(`${_(s)} needs a value`)),c.mode==="custom"&&c.value!==void 0&&c.value!==null&&((i==null?void 0:i.min)!==void 0&&c.value<i.min&&n.push(`${_(s)} must be >= ${i.min}`),(i==null?void 0:i.max)!==void 0&&c.value>i.max&&n.push(`${_(s)} must be <= ${i.max}`))}return{valid:n.length===0,errors:n}}function q(){if(!t.selectedModel||t.mode==="trial"&&!V.value)return null;const n={},l=P(t.selectedModel.provider,t.selectedModel.modelId),s=(c,i,m)=>{const d=i.split(".");let T=c;for(let D=0;D<d.length-1;D++)T[d[D]]||(T[d[D]]={}),T=T[d[D]];T[d[d.length-1]]=m};for(const[c,i]of Object.entries($)){const m=l[c];let d;switch(i.mode){case"default":d=m==null?void 0:m.default,x.info("PARAMDEBUG: Using default for",c,"=",d);break;case"custom":d=i.value,x.info("PARAMDEBUG: Using custom value for",c,"=",d);break;case"unset":x.info("PARAMDEBUG: Skipping unset param",c);continue}d!=null&&d!==""?s(n,c,d):d===!1?s(n,c,!1):m!=null&&m.required&&x.error(`Required parameter ${c} has no valid value`)}return{name:t.mode==="trial"?V.value:t.selectedModel.displayName,provider:t.selectedModel.provider,modelId:t.selectedModel.modelId,parameters:n}}function z(){I.value="";const n=X();if(!n.valid){I.value=`Invalid configuration: ${n.errors.join(", ")}`;return}const l=q();if(l){if(t.existingConfigurations&&t.existingConfigurations.some(c=>c.provider===l.provider&&c.modelId===l.modelId&&JSON.stringify(c.parameters)===JSON.stringify(l.parameters))){I.value=`${l.provider}:${l.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}F("add-configuration",l)}}return(n,l)=>{const s=w("a-button"),c=w("a-input"),i=w("a-form-item"),m=w("a-tag"),d=w("a-input-number"),T=w("a-switch"),D=w("a-select-option"),K=w("a-select"),ee=w("a-col"),le=w("a-row"),ae=w("a-collapse-panel"),pe=w("a-collapse"),me=w("a-form"),fe=w("a-alert");return a(),f("div",Ct,[p("div",$t,[p("div",yt,[p("h3",null,b(n.mode==="trial"?"Configure":"Model Parameters")+": "+b(n.selectedModel.displayName),1),n.showCloseButton?(a(),M(s,{key:0,type:"text",onClick:l[0]||(l[0]=r=>n.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:h(()=>[O(Y(ye))]),_:1})):C("",!0)]),n.mode==="trial"?(a(),f("div",Mt,[O(ce,{model:n.selectedModel,mode:"range","input-tokens":L.value,"output-tokens":j.value,"min-output-tokens":N.value,"max-output-tokens":U.value,layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens","min-output-tokens","max-output-tokens"]),n.totalCalls>1?(a(),f("span",bt,"("+b(n.totalCalls)+" calls total)",1)):C("",!0)])):C("",!0)]),p("div",Tt,[O(me,{layout:"vertical"},{default:h(()=>[n.mode==="trial"?(a(),M(i,{key:0,label:"Configuration Name",required:""},{default:h(()=>[O(c,{value:V.value,"onUpdate:value":l[1]||(l[1]=r=>V.value=r),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):C("",!0),O(pe,{"default-active-key":["basic"],ghost:""},{default:h(()=>[O(ae,{key:"basic",header:"Basic Parameters"},{default:h(()=>[O(le,{gutter:16},{default:h(()=>[(a(!0),f(W,null,Z(B.value,(r,v)=>(a(),M(ee,{key:v,span:n.mode==="playground"?24:12},{default:h(()=>[O(i,null,{label:h(()=>{var k,te;return[p("span",null,b(_(v)),1),r.required?(a(),M(m,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:h(()=>l[2]||(l[2]=[E("Required")])),_:1,__:[2]})):((k=$[v])==null?void 0:k.mode)==="default"?(a(),M(m,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:h(()=>l[3]||(l[3]=[E("Default")])),_:1,__:[3]})):((te=$[v])==null?void 0:te.mode)==="unset"?(a(),M(m,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:h(()=>l[4]||(l[4]=[E("Not Set")])),_:1,__:[4]})):C("",!0)]}),default:h(()=>[r.type==="number"?(a(),M(d,{key:0,value:g[v],"onUpdate:value":k=>g[v]=k,min:r.min,max:r.max,step:.1,placeholder:e(v,r),"allow-clear":!r.required,status:u(v),style:{width:"100%"},size:"large",onChange:k=>S(v,k,r)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):r.type==="integer"?(a(),M(d,{key:1,value:g[v],"onUpdate:value":k=>g[v]=k,min:r.min,max:r.max,placeholder:e(v,r),"allow-clear":!r.required,status:u(v),style:{width:"100%"},size:"large",onChange:k=>S(v,k,r)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):r.type==="boolean"?(a(),M(T,{key:2,checked:g[v],"onUpdate:checked":k=>g[v]=k,"checked-children":"true","un-checked-children":"false",onChange:S},null,8,["checked","onUpdate:checked"])):r.type==="string"&&r.enum?(a(),M(K,{key:3,value:g[v],"onUpdate:value":k=>g[v]=k,placeholder:r.default?`Default: ${r.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!r.required,status:u(v),onChange:S},{default:h(()=>[r.default?(a(),M(D,{key:0,value:r.default},{default:h(()=>[E(b(r.default)+" (default) ",1)]),_:2},1032,["value"])):C("",!0),r.required?C("",!0):(a(),M(D,{key:1,value:void 0},{default:h(()=>l[5]||(l[5]=[p("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(a(!0),f(W,null,Z(r.enum.filter(k=>k!==r.default),k=>(a(),M(D,{key:k,value:k},{default:h(()=>[E(b(k),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(a(),M(c,{key:4,value:g[v],"onUpdate:value":k=>g[v]=k,placeholder:e(v,r),"allow-clear":!r.required,status:u(v),size:"large",onChange:S},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),p("div",xt,b(r.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(Q.value).length>0?(a(),M(ae,{key:"advanced",header:"Advanced Parameters"},{default:h(()=>[O(le,{gutter:16},{default:h(()=>[(a(!0),f(W,null,Z(Q.value,(r,v)=>(a(),M(ee,{key:v,span:n.mode==="playground"?24:12},{default:h(()=>[O(i,null,{label:h(()=>{var k,te;return[p("span",null,b(_(v)),1),r.required?(a(),M(m,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:h(()=>l[6]||(l[6]=[E("Required")])),_:1,__:[6]})):((k=$[v])==null?void 0:k.mode)==="default"?(a(),M(m,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:h(()=>l[7]||(l[7]=[E("Default")])),_:1,__:[7]})):((te=$[v])==null?void 0:te.mode)==="unset"?(a(),M(m,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:h(()=>l[8]||(l[8]=[E("Not Set")])),_:1,__:[8]})):C("",!0)]}),default:h(()=>[r.type==="number"||r.type==="integer"?(a(),M(d,{key:0,value:g[v],"onUpdate:value":k=>g[v]=k,min:r.min,max:r.max,step:r.type==="number"?.1:1,placeholder:e(v,r),"allow-clear":!r.required,status:u(v),style:{width:"100%"},size:"large",onChange:k=>S(v,k,r)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):r.type==="boolean"?(a(),M(T,{key:1,checked:g[v],"onUpdate:checked":k=>g[v]=k,"checked-children":"true","un-checked-children":"false",onChange:S},null,8,["checked","onUpdate:checked"])):r.type==="string"&&r.enum?(a(),M(K,{key:2,value:g[v],"onUpdate:value":k=>g[v]=k,placeholder:r.default?`Default: ${r.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!r.required,status:u(v),onChange:S},{default:h(()=>[r.default?(a(),M(D,{key:0,value:r.default},{default:h(()=>[E(b(r.default)+" (default) ",1)]),_:2},1032,["value"])):C("",!0),r.required?C("",!0):(a(),M(D,{key:1,value:void 0},{default:h(()=>l[9]||(l[9]=[p("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(a(!0),f(W,null,Z(r.enum.filter(k=>k!==r.default),k=>(a(),M(D,{key:k,value:k},{default:h(()=>[E(b(k),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(a(),M(c,{key:3,value:g[v],"onUpdate:value":k=>g[v]=k,placeholder:e(v,r),"allow-clear":!r.required,status:u(v),size:"large",onChange:S},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),p("div",Pt,b(r.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1})]),n.mode==="trial"?(a(),f("div",Ot,[I.value?(a(),f("div",Dt,[O(fe,{message:I.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):C("",!0),O(s,{type:"primary",size:"large",onClick:z,disabled:!V.value||!n.selectedModel},{default:h(()=>l[10]||(l[10]=[E(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):C("",!0)])}}}),Ft=ne(wt,[["__scopeId","data-v-000fce1e"]]),At={class:"modal-content-wrapper"},It={key:0,class:"loading-container"},Ut={key:1,class:"no-models-container"},Et={class:"no-models-content"},Vt={key:2,class:"modal-content"},qt={class:"models-panel"},St={class:"models-list"},Rt=oe({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(J,{emit:o}){const t=J,F=o,y=ge(),{enabledModels:A,loading:P}=ke(),{requiresApiKey:V,getProviderGroup:g,getUIDefaults:$}=re(),{hasApiKey:I}=he(),{estimateCost:B,estimateTotalCost:Q}=Ce(),L=R(()=>A.value||[]),j=R(()=>{const i=L.value.length>0;return P.value&&!i}),N=H(""),U=H(null),G=H(null),e=H({}),u=R(()=>{if(!L.value)return{};let i=L.value;if(N.value){const d=N.value.toLowerCase();i=i.filter(T=>T.displayName.toLowerCase().includes(d)||T.modelId.toLowerCase().includes(d))}const m={};for(const d of i)m[d.provider]||(m[d.provider]=[]),m[d.provider].push(d);for(const d in m)m[d].sort((T,D)=>T.displayName.localeCompare(D.displayName));return m}),_=R(()=>{var i;if(t.mode!=="trial")return 1;if(t.trialContext)return t.trialContext.totalCombinations;if(t.design){let m=1;for(const d of Object.values(t.design.variableBindings))d.type==="direct"&&(m*=((i=d.values)==null?void 0:i.length)||1);return m}return 1});se([U,e],async()=>{var i;if(!U.value||t.mode!=="trial"){G.value=null;return}if(!t.trialContext&&!t.design){G.value=null;return}try{const m=Object.keys(e.value).length>0?e.value:$(U.value.provider,U.value.modelId);if(t.mode==="trial"&&((i=t.trialContext)!=null&&i.tokenData)){const d=Q(t.trialContext.tokenData.totalTokens,t.trialContext.tokenData.combinationCount,U.value,m);d.meta.hasValidCost&&d.cost.total.expected>0?G.value={inputTokens:{avgTokens:t.trialContext.tokenData.perCallAverage},outputTokens:d.tokens.output.expected,totalCost:d.cost.total.expected,inputCost:d.cost.input,outputCost:d.cost.output.expected,costRange:{min:d.cost.total.min,max:d.cost.total.max,expected:d.cost.total.expected}}:G.value=null}else{const d=s(U.value);if(d===null){G.value=null;return}const T=B(d,U.value,m);T.meta.hasValidCost&&T.cost.total.expected>0?G.value={inputTokens:{avgTokens:d},outputTokens:T.tokens.output.expected,totalCost:T.cost.total.expected,inputCost:T.cost.input,outputCost:T.cost.output.expected,costRange:{min:T.cost.total.min,max:T.cost.total.max,expected:T.cost.total.expected}}:G.value=null}}catch(m){x.error("Failed to calculate cost estimate:",m),G.value=null}},{deep:!0});function S(){F("update:visible",!1),y.push("/models")}function X(i){if(U.value=i,t.mode==="trial"&&(e.value={}),t.mode==="playground"){F("select-model",i),F("update:visible",!1);return}}function q(i){x.debug("GenericModelSelectorModalV3: Parameters changed",i),e.value={...i}}function z(i){x.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:i,mode:t.mode}),t.mode==="single"?(F("confirm",{model:U.value,configuration:i}),F("update:visible",!1)):F("add-configuration",i)}function n(i){F("select-model",i),F("update:visible",!1)}function l(){U.value=null}function s(i){var m,d;return t.mode==="trial"?t.trialContext&&t.trialContext.tokenData?t.trialContext.tokenData.totalTokens:(d=(m=t.design)==null?void 0:m.tokenEstimate)!=null&&d.avgTokens?t.design.tokenEstimate.avgTokens*_.value:null:1e3}function c(i){var m;if(t.mode==="trial"){const d=Object.keys(e.value).length>0?e.value:$(i.provider,i.modelId),T=["max_tokens","max_completion_tokens","max_output_tokens","num_predict","maxTokens"];let D=null;for(const K of T)if(d[K]!==void 0&&d[K]!==null&&d[K]>0){D=d[K];break}return D===null?null:(m=t.trialContext)!=null&&m.tokenData?D*t.trialContext.tokenData.combinationCount:D*_.value}return 1e3}return se(()=>t.visible,i=>{i&&(U.value=null,N.value="",e.value={},x.debug("GenericModelSelectorModalV3 opened - reset selection"))}),de(()=>{x.debug("GenericModelSelectorModalV3 mounted",{mode:t.mode,visible:t.visible})}),(i,m)=>{const d=w("a-spin"),T=w("a-button"),D=w("a-modal");return a(),M(D,{open:i.visible,onCancel:m[1]||(m[1]=K=>i.$emit("update:visible",!1)),title:i.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:h(()=>{var K,ee;return[p("div",At,[j.value?(a(),f("div",It,[O(d,{size:"large",tip:"Loading models..."})])):L.value.length===0?(a(),f("div",Ut,[p("div",Et,[O(Y(Me),{class:"no-models-icon"}),m[3]||(m[3]=p("h3",null,"No Models Available",-1)),m[4]||(m[4]=p("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),O(T,{type:"primary",size:"large",onClick:S},{default:h(()=>[O(Y(be)),m[2]||(m[2]=E(" Go to Models View "))]),_:1,__:[2]})])])):(a(),f("div",Vt,[p("div",qt,[O(De,{modelValue:N.value,"onUpdate:modelValue":m[0]||(m[0]=le=>N.value=le)},null,8,["modelValue"]),p("div",St,[O(ht,{"grouped-models":u.value,"selected-model-id":(K=U.value)==null?void 0:K.id,mode:i.mode,"get-input-tokens-for-model":s,"get-output-tokens-for-model":c,"has-config-panel":!!U.value,"requires-api-key":Y(V),"get-provider-group":Y(g),"has-api-key":Y(I),onSelectModel:X},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),U.value&&i.mode==="trial"?(a(),M(Ft,{key:0,"selected-model":U.value,mode:i.mode,"total-calls":_.value,"cost-estimate":G.value,"token-data":(ee=i.trialContext)==null?void 0:ee.tokenData,"get-input-tokens-for-model":s,"get-output-tokens-for-model":c,"existing-configurations":i.existingConfigurations,onClose:l,onAddConfiguration:z,onConfirmSelection:n,onParametersChanged:q},null,8,["selected-model","mode","total-calls","cost-estimate","token-data","existing-configurations"])):C("",!0)]))])]}),_:1},8,["open","title"])}}}),Lt=ne(Rt,[["__scopeId","data-v-11663c6f"]]);export{Lt as G,ce as M};

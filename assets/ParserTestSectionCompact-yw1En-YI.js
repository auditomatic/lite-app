import{b as D,j as H}from"./index-B-A_sTss.js";import{G as K,H as L,n as Y,I as Z,J as q,T as Q,K as W,o as X,L as ee,U as te,w as se,N as x}from"./ui-vendor-IRGmExUJ.js";import{d as ne,f as C,c as z,R as c,Y as u,S as i,_ as R,k as a,Z as o,G as g,u as S,V as m,$ as oe}from"./vue-vendor-DPw1dQYc.js";const ae={class:"form-section"},le={class:"test-input-area"},ie={class:"test-fields"},ue={class:"test-action"},re={key:0,class:"current-result"},ce={class:"result-details"},de={key:0},pe={key:1},me={key:1,class:"test-history"},fe={class:"history-header"},_e={class:"test-index"},ve=["title"],ye=["title"],ge={key:1,class:"not-run"},he=["title"],Te={key:1,class:"no-expected"},xe={key:1,class:"no-expected"},Ce={key:0,class:"exec-time"},ke={key:1,class:"no-expected"},we=ne({__name:"ParserTestSectionCompact",props:{parser:{},form:{},autoSaveTests:{type:Boolean}},emits:["update:testCases"],setup(I,{emit:O}){const d=I,M=O,_=C(""),f=C(""),l=C(null),N=C(!1),$=C(!1),V=[{title:"#",key:"index",width:50,slots:{customRender:"index"}},{title:"Input",dataIndex:"input",key:"input",ellipsis:!0,slots:{customRender:"input"}},{title:"Output",dataIndex:"output",key:"output",ellipsis:!0,slots:{customRender:"output"}},{title:"Expected",dataIndex:"expected",key:"expected",ellipsis:!0,slots:{customRender:"expected"}},{title:"Match",key:"match",width:80,align:"center",slots:{customRender:"match"}},{title:"Time",dataIndex:"executionTimeMs",key:"time",width:80,align:"right",slots:{customRender:"time"}},{title:"Actions",key:"actions",width:100,align:"center",slots:{customRender:"actions"}}],E=z(()=>d.form.testCases.map((e,t)=>({...e,id:e.id||`test-${t}`}))),k=z(()=>!l.value?.success||!f.value?!1:w(l.value.value,f.value)),A=z(()=>l.value?l.value.success?f.value?k.value?"Test passed - result matches expected":"Test executed - result does not match expected":"Test executed successfully":`Test failed: ${l.value.error}`:"");async function B(){if(!_.value){x.warning("Please enter test input");return}N.value=!0,l.value=null;try{const e={...d.parser,id:"temp-test",created:new Date,updated:new Date},t=performance.now(),n=await D.executeParser(_.value,e),v=Math.round(performance.now()-t);if(l.value=n,d.autoSaveTests!==!1){const r=[{id:`test-${Date.now()}`,input:_.value,output:n.success?n.value:void 0,expected:f.value||void 0,executionTimeMs:v,hasRun:!0,createdAt:new Date},...d.form.testCases];r.length>50&&r.pop(),M("update:testCases",r)}}catch(e){l.value={success:!1,error:e instanceof Error?e.message:"Test failed"}}finally{N.value=!1}}function j(e){_.value=e.input,f.value=e.expected!==void 0?String(e.expected):"",l.value=null}function J(e){const t=[...d.form.testCases];t.splice(e,1),M("update:testCases",t),x.success("Test case removed")}async function U(){if(d.form.testCases.length===0){x.warning("No test cases to run");return}$.value=!0;const e=[...d.form.testCases];let t=0,n=0;try{const v={...d.parser,id:"temp-test",created:new Date,updated:new Date};for(let p=0;p<e.length;p++){const r=e[p];try{const b=performance.now(),y=await D.executeParser(r.input,v),P=Math.round(performance.now()-b);e[p]={...r,output:y.success?y.value:void 0,executionTimeMs:P,hasRun:!0},y.success?r.expected!==void 0?w(y.value,r.expected)?t++:n++:t++:n++}catch{e[p]={...r,output:void 0,hasRun:!0},n++}}M("update:testCases",e),n===0?x.success(`All ${t} tests passed`):x.warning(`${t} passed, ${n} failed`)}finally{$.value=!1}}function G(e,t){return e?e.length<=t?e:e.substring(0,t)+"...":""}function h(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="boolean"||typeof e=="number")return String(e);if(typeof e=="string")return e.length>100?e.substring(0,100)+"...":e;if(typeof e=="object")try{const t=JSON.stringify(e);return t.length>100?t.substring(0,100)+"...":t}catch{return String(e)}return String(e)}function w(e,t){let n=t;if(typeof t=="string"){if(d.form.outputType==="number")n=parseFloat(t);else if(d.form.outputType==="boolean")n=t==="true";else if(d.form.outputType==="json")try{n=JSON.parse(t)}catch{}}return typeof e=="number"&&typeof n=="number"?Math.abs(e-n)<1e-4:typeof e=="object"&&typeof n=="object"?JSON.stringify(e)===JSON.stringify(n):e===n}return(e,t)=>{const n=L,v=K,p=Y,r=Q,b=q,y=ee,P=X;return u(),c("div",ae,[t[9]||(t[9]=i("div",{class:"section-header"},[i("h3",null,"Test Parser")],-1)),i("div",le,[i("div",ie,[a(v,{label:"Test Input",class:"test-field test-field-input"},{default:o(()=>[a(n,{value:_.value,"onUpdate:value":t[0]||(t[0]=s=>_.value=s),placeholder:"Enter text to test the parser...",rows:3,"auto-size":{minRows:2,maxRows:6}},null,8,["value"])]),_:1}),a(v,{label:"Expected Result",class:"test-field test-field-expected"},{default:o(()=>[a(n,{value:f.value,"onUpdate:value":t[1]||(t[1]=s=>f.value=s),placeholder:"Enter expected result (optional)",rows:3,"auto-size":{minRows:2,maxRows:6}},null,8,["value"])]),_:1})]),i("div",ue,[a(p,{onClick:B,loading:N.value,type:"primary",size:"large"},{icon:o(()=>[a(S(Z))]),default:o(()=>[t[3]||(t[3]=g(" Test "))]),_:1,__:[3]},8,["loading"])])]),l.value?(u(),c("div",re,[a(b,{type:l.value.success?k.value?"success":"warning":"error",message:A.value,"show-icon":"",closable:"",onClose:t[2]||(t[2]=s=>l.value=null)},{description:o(()=>[i("div",ce,[i("span",null,[t[4]||(t[4]=i("strong",null,"Result:",-1)),t[5]||(t[5]=g()),i("code",null,m(h(l.value.value)),1)]),f.value?(u(),c("span",de,[t[6]||(t[6]=i("strong",null,"Match:",-1)),a(r,{color:k.value?"success":"error",size:"small"},{default:o(()=>[g(m(k.value?"✓ Match":"✗ No Match"),1)]),_:1},8,["color"])])):R("",!0),l.value.executionTimeMs?(u(),c("span",pe,[t[7]||(t[7]=i("strong",null,"Time:",-1)),g(" "+m(l.value.executionTimeMs)+"ms ",1)])):R("",!0)])]),_:1},8,["type","message"])])):R("",!0),e.form.testCases&&e.form.testCases.length>0?(u(),c("div",me,[i("div",fe,[i("h4",null,"Test Cases ("+m(e.form.testCases.length)+")",1),a(p,{size:"small",onClick:U,loading:$.value,disabled:e.form.testCases.length===0},{icon:o(()=>[a(S(W))]),default:o(()=>[t[8]||(t[8]=g(" Run All Tests "))]),_:1,__:[8]},8,["loading","disabled"])]),a(P,{columns:V,"data-source":E.value,pagination:!1,size:"small","row-key":"id"},{index:o(({index:s})=>[i("span",_e,m(s+1),1)]),input:o(({text:s})=>[i("div",{class:"cell-content",title:s},m(G(s,50)),9,ve)]),output:o(({text:s,record:T})=>[T.hasRun?(u(),c("code",{key:0,class:"cell-code",title:h(s)},m(h(s)),9,ye)):(u(),c("span",ge,"Not run"))]),expected:o(({text:s})=>[s!==void 0&&s!==""?(u(),c("code",{key:0,class:"cell-code",title:h(s)},m(h(s)),9,he)):(u(),c("span",Te,"—"))]),match:o(({record:s})=>[s.expected!==void 0&&s.hasRun?(u(),oe(r,{key:0,color:w(s.output,s.expected)?"success":"error",size:"small"},{default:o(()=>[g(m(w(s.output,s.expected)?"✓":"✗"),1)]),_:2},1032,["color"])):(u(),c("span",xe,"—"))]),time:o(({text:s,record:T})=>[T.hasRun&&s?(u(),c("span",Ce,m(s)+"ms",1)):(u(),c("span",ke,"—"))]),actions:o(({record:s,index:T})=>[a(y,null,{default:o(()=>[a(p,{size:"small",type:"link",onClick:F=>j(s),title:"Load"},{icon:o(()=>[a(S(te))]),_:2},1032,["onClick"]),a(p,{size:"small",type:"link",danger:"",onClick:F=>J(T),title:"Delete"},{icon:o(()=>[a(S(se))]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data-source"])])):R("",!0)])}}}),Me=H(we,[["__scopeId","data-v-8b666b84"]]);export{Me as P};

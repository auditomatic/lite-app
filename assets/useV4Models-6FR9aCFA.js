import{a as c}from"./useV4LiveQuery-Do0jdBW3.js";import{l as d,d as l,a as u}from"./index-DXsg4a_x.js";import{c as s}from"./vue-vendor-DPw1dQYc.js";class R{liveModels(){return d(async()=>{const o=await l.models.toArray(),e=await l.settings.get("main");u.info("[V4-DB] liveModels query running, settings:",e),u.info("[V4-DB] OpenRouter models before filter:",o.filter(t=>t.provider==="openrouter").length);let i=o;if(e&&(e.hideOpenRouterAuto||e.hideOpenRouterFree)){const t=o.filter(n=>n.provider==="openrouter").length;i=o.filter(n=>{if(n.provider==="openrouter"){if(e.hideOpenRouterAuto&&n.modelId==="openrouter/auto")return u.info("[V4-DB] Filtering out openrouter/auto"),!1;if(e.hideOpenRouterFree&&n.capabilities?.inputCostPerToken===0)return u.info("[V4-DB] Filtering out free model:",n.modelId),!1}return!0});const a=i.filter(n=>n.provider==="openrouter").length;u.info(`[V4-DB] OpenRouter models after filter: ${a} (filtered ${t-a})`)}i.sort((t,a)=>(t.displayName||t.modelId).localeCompare(a.displayName||a.modelId));const r=i.map(t=>Object.freeze(t));return Object.freeze(r)})}liveModelsByProvider(){return d(async()=>{const o=await l.models.toArray(),e=await l.settings.get("main");let i=o;e&&(e.hideOpenRouterAuto||e.hideOpenRouterFree)&&(i=o.filter(a=>!(a.provider==="openrouter"&&(e.hideOpenRouterAuto&&a.modelId==="openrouter/auto"||e.hideOpenRouterFree&&a.capabilities?.inputCostPerToken===0))));const r={};for(const a of i)r[a.provider]||(r[a.provider]=[]),r[a.provider].push(Object.freeze(a));const t={};for(const[a,n]of Object.entries(r))n.sort((f,p)=>(f.displayName||f.modelId).localeCompare(p.displayName||p.modelId)),t[a]=Object.freeze(n);return Object.freeze(t)})}liveEnabledModels(){return d(async()=>{const o=await l.models.filter(t=>t.enabled===!0).toArray(),e=await l.settings.get("main");let i=o;e&&(e.hideOpenRouterAuto||e.hideOpenRouterFree)&&(i=o.filter(t=>!(t.provider==="openrouter"&&(e.hideOpenRouterAuto&&t.modelId==="openrouter/auto"||e.hideOpenRouterFree&&t.capabilities?.inputCostPerToken===0))));const r=i.map(t=>Object.freeze(t));return Object.freeze(r)})}liveModelsBySpecificProvider(o){return d(async()=>{const i=(await l.models.where("provider").equals(o).toArray()).map(r=>Object.freeze(r));return Object.freeze(i)})}liveModel(o){return d(async()=>{const e=await l.models.get(o);return e?Object.freeze(e):null})}liveModelStats(){return d(async()=>{const o=await l.models.toArray(),e=o.length,i=o.filter(r=>r.enabled===!0).length;return Object.freeze({total:e,enabled:i,disabled:e-i})})}liveProviderStats(){return d(async()=>{const o=await l.models.toArray(),e={};for(const r of o)e[r.provider]||(e[r.provider]={total:0,enabled:0,available:0}),e[r.provider].total++,r.enabled&&e[r.provider].enabled++,r.available!==!1&&e[r.provider].available++;const i={};for(const[r,t]of Object.entries(e))i[r]=Object.freeze(t);return Object.freeze(i)})}}const v=new R;function D(){const{data:m,loading:o,error:e}=c(()=>v.liveModels(),{initialValue:[]}),{data:i,loading:r,error:t}=c(()=>v.liveModelsByProvider(),{initialValue:{}}),{data:a,loading:n,error:f}=c(()=>v.liveEnabledModels(),{initialValue:[]}),{data:p,loading:g,error:O}=c(()=>v.liveModelStats(),{initialValue:{total:0,enabled:0,disabled:0}}),y=s(()=>o.value||r.value||n.value||g.value),M=s(()=>e.value||t.value||f.value||O.value);function h(b){return m.value.find(j=>j.id===b)}function z(b){return i.value[b]||[]}return{models:s(()=>m.value),modelsByProvider:s(()=>i.value),enabledModels:s(()=>a.value),stats:s(()=>p.value),loading:y,error:M,findModel:h,getProviderModels:z}}export{D as u};

import{f as W,c as z,h as d,j as o,i as u,e as w,z as A,k as X,ap as ge,af as de,F as x,B as _,A as D,C,r as j,x as y,y as v,D as L,am as _e,H as K,aq as he,a7 as ue,w as Y,v as re,ar as ke,a as T,as as ye,X as Ce,R as Me}from"./index-SihudOJq.js";import{u as be}from"./useV4Models-DMdNHk6U.js";import{u as ce}from"./useV4ProviderParameters-BBSpuE0i.js";import{I as Pe}from"./InboxOutlined-B0JUaRCm.js";const $e={class:"model-search-filters"},we={class:"panel-header"},Te={class:"search-container"},Ae=W({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(N,{emit:g}){const s=N,U=g,k=z({get:()=>s.modelValue,set:O=>U("update:modelValue",O)});return(O,b)=>{const F=A("a-input-search");return o(),d("div",$e,[u("div",we,[b[2]||(b[2]=u("h3",null,"Available Models",-1)),u("div",Te,[b[1]||(b[1]=u("span",{class:"search-label"},"Search:",-1)),w(F,{value:k.value,"onUpdate:value":b[0]||(b[0]=c=>k.value=c),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),Ue=X(Ae,[["__scopeId","data-v-56bdd915"]]),Oe={key:0,class:"cost-group"},qe={class:"cost-item"},Ee={class:"cost-value"},De={class:"cost-value"},Fe={key:1,class:"cost-group"},Ie={class:"enviro-group"},Be={key:0,class:"enviro-item"},Se={key:1,class:"cost-tab"},Ve={key:2,class:"enviro-item"},Ge={key:3,class:"cost-tab"},ze={key:4,class:"enviro-item"},Re={key:0,class:"cost-group"},xe={class:"cost-item"},Ne={class:"cost-value"},Ke={class:"cost-value"},Le={class:"enviro-group"},je={key:0,class:"enviro-item"},He={key:1,class:"cost-tab"},Je={key:2,class:"enviro-item"},Qe={key:3,class:"cost-tab"},We={key:4,class:"enviro-item"},Xe={key:0,class:"cost-item financial"},Ye={key:0,class:"cost-value"},Ze={key:1,class:"cost-value"},et={key:1,class:"cost-item environmental"},tt={key:0,class:"enviro-item"},ot={class:"enviro-value"},lt={key:1,class:"enviro-item"},st={class:"enviro-value"},nt={key:2,class:"enviro-item"},at={class:"enviro-value"},it={key:3,class:"cost-unit"},ut=W({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(N){const g=N,s=ge(),U=z(()=>!0),k=z(()=>s.preferences.showCO2),O=z(()=>s.preferences.showWater),b=z(()=>s.preferences.showElectricity);function F(){if(!g.model.capabilities)return"â€”";const i=g.model.capabilities.inputCostPerToken||0,f=g.model.capabilities.outputCostPerToken||0;if(g.mode==="per-thousand"){const B=(i+f)*1e3;return c(B)}else if(g.mode==="total"){const B=i*g.inputTokens+f*g.outputTokens;return c(B)}return"â€”"}function c(i){return i===0?"0.00":i<.01?"<0.01":i<1?i.toFixed(2):i<10?i.toFixed(1):Math.round(i).toString()}function h(i){if(i===0)return"0";if(i>=.01)return i.toFixed(2).replace(/\.?0+$/,"");const B=i.toFixed(10).match(/^0\.0*[1-9]/);if(B){const H=B[0].length-2;return i.toFixed(H)}return i.toFixed(4)}function P(){if(!g.model.capabilities)return"0";const i=(g.model.capabilities.inputCostPerToken||0)*1e3;return h(i)}function I(){if(!g.model.capabilities)return"0";const i=(g.model.capabilities.outputCostPerToken||0)*1e3;return h(i)}function G(){if(!g.model.capabilities)return"?";const i=g.model.capabilities.inputCostPerToken||0,f=g.model.capabilities.outputCostPerToken||0,B=i*g.inputTokens+f*g.minOutputTokens;return h(B)}function E(){if(!g.model.capabilities||!g.maxOutputTokens)return"?";const i=g.model.capabilities.inputCostPerToken||0,f=g.model.capabilities.outputCostPerToken||0,B=i*g.inputTokens+f*g.maxOutputTokens;return h(B)}function q(i){return"??"}function S(i){return"??"}return(i,f)=>(o(),d("div",{class:de(["model-cost-display",[`layout-${i.layout}`,`size-${i.size}`]])},[i.mode==="range"?(o(),d(x,{key:0},[U.value&&i.maxOutputTokens?(o(),d("span",Oe,[u("span",qe,[u("span",Ee,"$"+C(G()),1),f[0]||(f[0]=D(" - ")),u("span",De,"$"+C(E()),1)])])):U.value?(o(),d("span",Fe,f[1]||(f[1]=[u("span",{class:"cost-item"},[u("span",{class:"cost-value"},"Cost: ??")],-1)]))):_("",!0),f[2]||(f[2]=u("span",{class:"cost-tab"},null,-1)),u("span",Ie,[k.value?(o(),d("span",Be,"COâ‚‚ "+C(S()),1)):_("",!0),k.value&&O.value?(o(),d("span",Se)):_("",!0),O.value?(o(),d("span",Ve,"ðŸ’§"+C(S()),1)):_("",!0),(k.value||O.value)&&b.value?(o(),d("span",Ge)):_("",!0),b.value?(o(),d("span",ze,"âš¡"+C(S()),1)):_("",!0)])],64)):i.mode==="input-output"?(o(),d(x,{key:1},[U.value?(o(),d("span",Re,[u("span",xe,[u("span",Ne,"$"+C(P()),1),f[3]||(f[3]=D("/1K input + ")),u("span",Ke,"$"+C(I()),1),f[4]||(f[4]=D("/1K output "))])])):_("",!0),f[5]||(f[5]=u("span",{class:"cost-tab"},null,-1)),u("span",Le,[k.value?(o(),d("span",je,"COâ‚‚ "+C(q()),1)):_("",!0),k.value&&O.value?(o(),d("span",He)):_("",!0),O.value?(o(),d("span",Je,"ðŸ’§"+C(q()),1)):_("",!0),(k.value||O.value)&&b.value?(o(),d("span",Qe)):_("",!0),b.value?(o(),d("span",We,"âš¡"+C(q()),1)):_("",!0)])],64)):(o(),d(x,{key:2},[U.value?(o(),d("div",Xe,[i.mode==="per-thousand"?(o(),d("span",Ye,[D(C(F())+" ",1),f[6]||(f[6]=u("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):i.mode==="total"?(o(),d("span",Ze,C(F()),1)):_("",!0)])):_("",!0),k.value||O.value||b.value?(o(),d("div",et,[k.value?(o(),d("span",tt,[f[7]||(f[7]=u("span",{class:"enviro-icon"},"COâ‚‚",-1)),u("span",ot,C(q()),1)])):_("",!0),O.value?(o(),d("span",lt,[f[8]||(f[8]=u("span",{class:"enviro-icon"},"ðŸ’§",-1)),u("span",st,C(q()),1)])):_("",!0),b.value?(o(),d("span",nt,[f[9]||(f[9]=u("span",{class:"enviro-icon"},"âš¡",-1)),u("span",at,C(q()),1)])):_("",!0),i.mode==="per-thousand"?(o(),d("span",it,"/ 1,000")):_("",!0)])):_("",!0)],64))],2))}}),pe=X(ut,[["__scopeId","data-v-5a159e37"]]),dt={class:"provider-header"},rt={class:"provider-name"},ct={class:"provider-model-count"},pt={key:0,class:"api-key-warning"},ft={class:"provider-models"},mt=["onClick"],vt={class:"model-name"},gt={key:0,class:"model-specs"},_t=W({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(N){const g=j(void 0);function s(k){return k}function U(k){g.value===k?g.value=void 0:g.value=k}return(k,O)=>{const b=A("a-button"),F=A("a-collapse-panel"),c=A("a-collapse");return o(),y(c,{activeKey:g.value,"onUpdate:activeKey":O[0]||(O[0]=h=>g.value=h),bordered:!1,accordion:""},{default:v(()=>[(o(!0),d(x,null,L(k.groupedModels,(h,P)=>(o(),y(F,{key:P,class:"provider-panel","data-provider":P},{header:v(()=>[u("div",dt,[u("span",rt,C(P),1),u("span",ct,C(h.length)+" models",1),k.requiresApiKey(P)&&!k.hasApiKey(k.getProviderGroup(P))?(o(),d("div",pt,[w(K(he)),O[1]||(O[1]=u("span",null,"API Key Missing",-1))])):_("",!0)])]),extra:v(()=>[w(b,{size:"small",type:"text",onClick:_e(I=>U(P),["stop"])},{default:v(()=>[D(C(g.value===P?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:v(()=>[u("div",ft,[(o(!0),d(x,null,L(h,I=>(o(),d("div",{key:I.id,class:de(["model-row",{selected:k.selectedModelId===I.id}]),onClick:G=>k.$emit("select-model",I)},[u("div",vt,C(I.displayName),1),k.hasConfigPanel?_("",!0):(o(),d("div",gt,[w(pe,{model:I,mode:k.mode==="trial"?"range":"input-output","input-tokens":k.getInputTokensForModel(I),"min-output-tokens":10,"max-output-tokens":k.getOutputTokensForModel(I),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,mt))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),ht=X(_t,[["__scopeId","data-v-984223df"]]),kt={class:"config-panel"},yt={class:"config-header"},Ct={class:"config-header-title"},Mt={key:0,class:"total-cost"},bt={key:0,class:"cost-info"},Pt={class:"config-content"},$t={class:"param-description"},wt={class:"param-description"},Tt={key:0,class:"config-footer"},At={key:0,class:"duplicate-error"},Ut=W({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(N,{emit:g}){const s=N,U=g,{getBasicParameters:k,getAdvancedParameters:O,getParametersForModel:b}=ce(),F=j(""),c=ue({}),h=ue({}),P=j(""),I=z(()=>s.selectedModel?k(s.selectedModel.provider,s.selectedModel.modelId):{}),G=z(()=>s.selectedModel?O(s.selectedModel.provider,s.selectedModel.modelId):{});function E(n){if(!n)return;T.info("PARAMDEBUG: setModelDefaults called for",n.provider,n.modelId,"mode:",s.mode),s.mode==="trial"&&(F.value=n.displayName),Object.keys(c).forEach(t=>delete c[t]),Object.keys(h).forEach(t=>delete h[t]);const e=b(n.provider,n.modelId);if(s.initialParameters&&Object.keys(s.initialParameters).length>0){T.info("PARAMDEBUG: using initial parameters:",s.initialParameters),Object.assign(c,s.initialParameters);for(const[t,l]of Object.entries(s.initialParameters)){const m=e[t];l===(m==null?void 0:m.default)?h[t]={mode:"default"}:h[t]={mode:"custom",value:l}}}else{T.info("PARAMDEBUG: allParams found:",Object.keys(e));for(const[t,l]of Object.entries(e))l.required?l.default!==void 0?(h[t]={mode:"default"},c[t]=l.default,T.info("PARAMDEBUG: setting required param",t,"to default =",l.default)):(h[t]={mode:"custom",value:null},c[t]=null,T.info("PARAMDEBUG: required param",t,"needs user input")):l.default!==void 0?(h[t]={mode:"default"},c[t]=l.default,T.info("PARAMDEBUG: setting optional param",t,"to default =",l.default)):(h[t]={mode:"unset"},c[t]=null,T.info("PARAMDEBUG: optional param",t,"starts unset"));T.info("PARAMDEBUG: final parameters:",{...c}),T.info("PARAMDEBUG: parameter states:",{...h})}}Y(()=>s.selectedModel,n=>{E(n),P.value=""},{immediate:!0}),Y(c,()=>{P.value=""},{deep:!0}),re(()=>{s.selectedModel&&E(s.selectedModel)});function q(n,e){const t=h[n],l=c[n];return T.info("PLACEHOLDER DEBUG:",n,"state:",t==null?void 0:t.mode,"value:",l,"param.default:",e.default),!e.required&&(l==null||l==="")||(t==null?void 0:t.mode)==="unset"?"Not set (parameter will be omitted)":e.default!==void 0?(t==null?void 0:t.mode)==="default"?`Using default: ${e.default}`:`Default: ${e.default} (enter to override)`:e.required?"Required - enter value":"Enter value (optional)"}function S(n){const e=h[n],t=s.selectedModel?b(s.selectedModel.provider,s.selectedModel.modelId)[n]:void 0;if(t!=null&&t.required&&(e==null?void 0:e.mode)==="unset"||t!=null&&t.required&&(e==null?void 0:e.mode)==="custom"&&!e.value)return"error";if((e==null?void 0:e.mode)==="default")return"warning"}function i(n){return n.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function f(n,e,t){T.info("PARAMDEBUG: handleParameterChange",n,"new value:",e,"param.required:",t.required),e==null||e===""?t!=null&&t.required?t.default!==void 0&&(c[n]=t.default,h[n]={mode:"default"},T.info("PARAMDEBUG: Required param",n,"cleared, reverting to default:",t.default)):(c[n]=null,h[n]={mode:"unset"},T.info("PARAMDEBUG: Optional param",n,"cleared, setting to unset")):(c[n]=e,e===(t==null?void 0:t.default)?h[n]={mode:"default"}:h[n]={mode:"custom",value:e}),(s.mode==="playground"||s.mode==="standalone")&&U("parameters-changed",{...c})}function B(){const n=[],e=s.selectedModel?b(s.selectedModel.provider,s.selectedModel.modelId):{};for(const[t,l]of Object.entries(h)){const m=e[t];m!=null&&m.required&&(l.mode==="unset"?n.push(`${i(t)} is required`):l.mode==="custom"&&(l.value===null||l.value===void 0||l.value==="")&&n.push(`${i(t)} needs a value`)),l.mode==="custom"&&l.value!==void 0&&l.value!==null&&((m==null?void 0:m.min)!==void 0&&l.value<m.min&&n.push(`${i(t)} must be >= ${m.min}`),(m==null?void 0:m.max)!==void 0&&l.value>m.max&&n.push(`${i(t)} must be <= ${m.max}`))}return{valid:n.length===0,errors:n}}function H(){if(!s.selectedModel||s.mode==="trial"&&!F.value)return null;const n={},e=b(s.selectedModel.provider,s.selectedModel.modelId),t=(l,m,$)=>{const M=m.split(".");let R=l;for(let V=0;V<M.length-1;V++)R[M[V]]||(R[M[V]]={}),R=R[M[V]];R[M[M.length-1]]=$};for(const[l,m]of Object.entries(h)){const $=e[l];let M;switch(m.mode){case"default":M=$==null?void 0:$.default,T.info("PARAMDEBUG: Using default for",l,"=",M);break;case"custom":M=m.value,T.info("PARAMDEBUG: Using custom value for",l,"=",M);break;case"unset":T.info("PARAMDEBUG: Skipping unset param",l);continue}M!=null&&M!==""?t(n,l,M):M===!1?t(n,l,!1):$!=null&&$.required&&T.error(`Required parameter ${l} has no valid value`)}return{name:s.mode==="trial"?F.value:s.selectedModel.displayName,provider:s.selectedModel.provider,modelId:s.selectedModel.modelId,parameters:n}}function Z(){P.value="";const n=B();if(!n.valid){P.value=`Invalid configuration: ${n.errors.join(", ")}`;return}const e=H();if(e){if(s.existingConfigurations&&s.existingConfigurations.some(l=>l.provider===e.provider&&l.modelId===e.modelId&&JSON.stringify(l.parameters)===JSON.stringify(e.parameters))){P.value=`${e.provider}:${e.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}U("add-configuration",e)}}function ee(n){var e;return((e=s.getInputTokensForModel)==null?void 0:e.call(s,n))||1e3}function J(n){var e;return((e=s.getOutputTokensForModel)==null?void 0:e.call(s,n))||1e3}return(n,e)=>{var ne,ae,ie;const t=A("a-button"),l=A("a-input"),m=A("a-form-item"),$=A("a-tag"),M=A("a-input-number"),R=A("a-switch"),V=A("a-select-option"),te=A("a-select"),oe=A("a-col"),le=A("a-row"),se=A("a-collapse-panel"),fe=A("a-collapse"),me=A("a-form"),ve=A("a-alert");return o(),d("div",kt,[u("div",yt,[u("div",Ct,[u("h3",null,C(n.mode==="trial"?"Configure":"Model Parameters")+": "+C(n.selectedModel.displayName),1),n.showCloseButton?(o(),y(t,{key:0,type:"text",onClick:e[0]||(e[0]=a=>n.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:v(()=>[w(K(ke))]),_:1})):_("",!0)]),n.mode==="trial"?(o(),d("div",Mt,[w(pe,{model:n.selectedModel,mode:"total","input-tokens":((ae=(ne=n.costEstimate)==null?void 0:ne.inputTokens)==null?void 0:ae.avgTokens)||ee(n.selectedModel),"output-tokens":((ie=n.costEstimate)==null?void 0:ie.outputTokens)||J(n.selectedModel),layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens"]),n.totalCalls>1?(o(),d("span",bt,"("+C(n.totalCalls)+" calls)",1)):_("",!0)])):_("",!0)]),u("div",Pt,[w(me,{layout:"vertical"},{default:v(()=>[n.mode==="trial"?(o(),y(m,{key:0,label:"Configuration Name",required:""},{default:v(()=>[w(l,{value:F.value,"onUpdate:value":e[1]||(e[1]=a=>F.value=a),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):_("",!0),w(fe,{"default-active-key":["basic"],ghost:""},{default:v(()=>[w(se,{key:"basic",header:"Basic Parameters"},{default:v(()=>[w(le,{gutter:16},{default:v(()=>[(o(!0),d(x,null,L(I.value,(a,r)=>(o(),y(oe,{key:r,span:n.mode==="playground"?24:12},{default:v(()=>[w(m,null,{label:v(()=>{var p,Q;return[u("span",null,C(i(r)),1),a.required?(o(),y($,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[2]||(e[2]=[D("Required")])),_:1,__:[2]})):((p=h[r])==null?void 0:p.mode)==="default"?(o(),y($,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[3]||(e[3]=[D("Default")])),_:1,__:[3]})):((Q=h[r])==null?void 0:Q.mode)==="unset"?(o(),y($,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[4]||(e[4]=[D("Not Set")])),_:1,__:[4]})):_("",!0)]}),default:v(()=>[a.type==="number"?(o(),y(M,{key:0,value:c[r],"onUpdate:value":p=>c[r]=p,min:a.min,max:a.max,step:.1,placeholder:q(r,a),"allow-clear":!a.required,status:S(r),style:{width:"100%"},size:"large",onChange:p=>f(r,p,a)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):a.type==="integer"?(o(),y(M,{key:1,value:c[r],"onUpdate:value":p=>c[r]=p,min:a.min,max:a.max,placeholder:q(r,a),"allow-clear":!a.required,status:S(r),style:{width:"100%"},size:"large",onChange:p=>f(r,p,a)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):a.type==="boolean"?(o(),y(R,{key:2,checked:c[r],"onUpdate:checked":p=>c[r]=p,"checked-children":"true","un-checked-children":"false",onChange:f},null,8,["checked","onUpdate:checked"])):a.type==="string"&&a.enum?(o(),y(te,{key:3,value:c[r],"onUpdate:value":p=>c[r]=p,placeholder:a.default?`Default: ${a.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!a.required,status:S(r),onChange:f},{default:v(()=>[a.default?(o(),y(V,{key:0,value:a.default},{default:v(()=>[D(C(a.default)+" (default) ",1)]),_:2},1032,["value"])):_("",!0),a.required?_("",!0):(o(),y(V,{key:1,value:void 0},{default:v(()=>e[5]||(e[5]=[u("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(o(!0),d(x,null,L(a.enum.filter(p=>p!==a.default),p=>(o(),y(V,{key:p,value:p},{default:v(()=>[D(C(p),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(o(),y(l,{key:4,value:c[r],"onUpdate:value":p=>c[r]=p,placeholder:q(r,a),"allow-clear":!a.required,status:S(r),size:"large",onChange:f},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),u("div",$t,C(a.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(G.value).length>0?(o(),y(se,{key:"advanced",header:"Advanced Parameters"},{default:v(()=>[w(le,{gutter:16},{default:v(()=>[(o(!0),d(x,null,L(G.value,(a,r)=>(o(),y(oe,{key:r,span:n.mode==="playground"?24:12},{default:v(()=>[w(m,null,{label:v(()=>{var p,Q;return[u("span",null,C(i(r)),1),a.required?(o(),y($,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[6]||(e[6]=[D("Required")])),_:1,__:[6]})):((p=h[r])==null?void 0:p.mode)==="default"?(o(),y($,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[7]||(e[7]=[D("Default")])),_:1,__:[7]})):((Q=h[r])==null?void 0:Q.mode)==="unset"?(o(),y($,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[8]||(e[8]=[D("Not Set")])),_:1,__:[8]})):_("",!0)]}),default:v(()=>[a.type==="number"||a.type==="integer"?(o(),y(M,{key:0,value:c[r],"onUpdate:value":p=>c[r]=p,min:a.min,max:a.max,step:a.type==="number"?.1:1,placeholder:q(r,a),"allow-clear":!a.required,status:S(r),style:{width:"100%"},size:"large",onChange:p=>f(r,p,a)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):a.type==="boolean"?(o(),y(R,{key:1,checked:c[r],"onUpdate:checked":p=>c[r]=p,"checked-children":"true","un-checked-children":"false",onChange:f},null,8,["checked","onUpdate:checked"])):a.type==="string"&&a.enum?(o(),y(te,{key:2,value:c[r],"onUpdate:value":p=>c[r]=p,placeholder:a.default?`Default: ${a.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!a.required,status:S(r),onChange:f},{default:v(()=>[a.default?(o(),y(V,{key:0,value:a.default},{default:v(()=>[D(C(a.default)+" (default) ",1)]),_:2},1032,["value"])):_("",!0),a.required?_("",!0):(o(),y(V,{key:1,value:void 0},{default:v(()=>e[9]||(e[9]=[u("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(o(!0),d(x,null,L(a.enum.filter(p=>p!==a.default),p=>(o(),y(V,{key:p,value:p},{default:v(()=>[D(C(p),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(o(),y(l,{key:3,value:c[r],"onUpdate:value":p=>c[r]=p,placeholder:q(r,a),"allow-clear":!a.required,status:S(r),size:"large",onChange:f},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),u("div",wt,C(a.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})]),n.mode==="trial"?(o(),d("div",Tt,[P.value?(o(),d("div",At,[w(ve,{message:P.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):_("",!0),w(t,{type:"primary",size:"large",onClick:Z,disabled:!F.value||!n.selectedModel},{default:v(()=>e[10]||(e[10]=[D(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):_("",!0)])}}}),Ot=X(Ut,[["__scopeId","data-v-ec7bb56b"]]),qt={class:"modal-content-wrapper"},Et={key:0,class:"loading-container"},Dt={key:1,class:"no-models-container"},Ft={class:"no-models-content"},It={key:2,class:"modal-content"},Bt={class:"models-panel"},St={class:"models-list"},Vt=W({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(N,{emit:g}){const s=N,U=g,k=Me(),{enabledModels:O,loading:b}=be(),{requiresApiKey:F,getProviderGroup:c}=ce(),{hasApiKey:h}=ye(),P=z(()=>O.value||[]),I=z(()=>{const e=P.value.length>0;return b.value&&!e}),G=j(""),E=j(null),q=j(null),S=z(()=>{if(!P.value)return{};let e=P.value;if(G.value){const l=G.value.toLowerCase();e=e.filter(m=>m.displayName.toLowerCase().includes(l)||m.modelId.toLowerCase().includes(l))}const t={};for(const l of e)t[l.provider]||(t[l.provider]=[]),t[l.provider].push(l);for(const l in t)t[l].sort((m,$)=>m.displayName.localeCompare($.displayName));return t}),i=z(()=>{var e;if(s.mode!=="trial")return 1;if(s.trialContext)return s.trialContext.totalCombinations;if(s.design){let t=1;for(const l of Object.values(s.design.variableBindings))l.type==="direct"&&(t*=((e=l.values)==null?void 0:e.length)||1);return t}return 1});Y([E],async()=>{if(!E.value||s.mode!=="trial"){q.value=null;return}if(!s.trialContext&&!s.design){q.value=null;return}try{const e=J(E.value),t=n(E.value),l=E.value.capabilities;if(l!=null&&l.inputCostPerToken&&(l!=null&&l.outputCostPerToken)){const m=e*l.inputCostPerToken/1e3,$=t*l.outputCostPerToken/1e3,M=(m+$)*i.value;q.value={inputTokens:{avgTokens:e},outputTokens:t,totalCost:M,inputCost:m,outputCost:$}}else q.value=null}catch(e){T.error("Failed to calculate cost estimate:",e),q.value=null}});function f(){U("update:visible",!1),k.push("/models")}function B(e){if(E.value=e,s.mode==="playground"){U("select-model",e),U("update:visible",!1);return}}function H(e){T.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:e,mode:s.mode}),s.mode==="single"?(U("confirm",{model:E.value,configuration:e}),U("update:visible",!1)):U("add-configuration",e)}function Z(e){U("select-model",e),U("update:visible",!1)}function ee(){E.value=null}function J(e){var t;if(s.mode==="trial"){if(s.trialContext)return s.trialContext.avgTokens;if(s.design)return((t=s.design.tokenEstimate)==null?void 0:t.avgTokens)||150}return 1e3}function n(e){var t;return s.mode==="trial"?((t=e.capabilities)==null?void 0:t.maxTokens)||256:1e3}return Y(()=>s.visible,e=>{e&&(E.value=null,G.value="",T.debug("GenericModelSelectorModalV3 opened - reset selection"))}),re(()=>{T.debug("GenericModelSelectorModalV3 mounted",{mode:s.mode,visible:s.visible})}),(e,t)=>{const l=A("a-spin"),m=A("a-button"),$=A("a-modal");return o(),y($,{open:e.visible,onCancel:t[1]||(t[1]=M=>e.$emit("update:visible",!1)),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:v(()=>{var M;return[u("div",qt,[I.value?(o(),d("div",Et,[w(l,{size:"large",tip:"Loading models..."})])):P.value.length===0?(o(),d("div",Dt,[u("div",Ft,[w(K(Pe),{class:"no-models-icon"}),t[3]||(t[3]=u("h3",null,"No Models Available",-1)),t[4]||(t[4]=u("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),w(m,{type:"primary",size:"large",onClick:f},{default:v(()=>[w(K(Ce)),t[2]||(t[2]=D(" Go to Models View "))]),_:1,__:[2]})])])):(o(),d("div",It,[u("div",Bt,[w(Ue,{modelValue:G.value,"onUpdate:modelValue":t[0]||(t[0]=R=>G.value=R)},null,8,["modelValue"]),u("div",St,[w(ht,{"grouped-models":S.value,"selected-model-id":(M=E.value)==null?void 0:M.id,mode:e.mode,"get-input-tokens-for-model":J,"get-output-tokens-for-model":n,"has-config-panel":!!E.value,"requires-api-key":K(F),"get-provider-group":K(c),"has-api-key":K(h),onSelectModel:B},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),E.value&&e.mode==="trial"?(o(),y(Ot,{key:0,"selected-model":E.value,mode:e.mode,"total-calls":i.value,"cost-estimate":q.value,"get-input-tokens-for-model":J,"get-output-tokens-for-model":n,"existing-configurations":e.existingConfigurations,onClose:ee,onAddConfiguration:H,onConfirmSelection:Z},null,8,["selected-model","mode","total-calls","cost-estimate","existing-configurations"])):_("",!0)]))])]}),_:1},8,["open","title"])}}}),Nt=X(Vt,[["__scopeId","data-v-441cb40e"]]);export{Nt as G,pe as M};

import{f as Q,c as N,h as C,j as s,i as a,e as $,x as w,_ as H,ab as de,F as z,z as A,y as E,A as h,r as L,t as _,v as m,B as K,ai as ge,E as R,al as _e,a5 as ue,w as Y,q as re,am as he,a as T,an as Ce,V as Me,N as ke}from"./index-CvIbHGw4.js";import{u as ye}from"./useV4Models-BBzt_Qtj.js";import{u as ce}from"./useV4ProviderParameters-BFp2fvC6.js";import{I as be}from"./InboxOutlined-vBRpqLdA.js";const Pe={class:"model-search-filters"},$e={class:"panel-header"},Te={class:"search-container"},we=Q({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(x,{emit:v}){const o=x,U=v,y=N({get:()=>o.modelValue,set:O=>U("update:modelValue",O)});return(O,q)=>{const F=w("a-input-search");return s(),C("div",Pe,[a("div",$e,[q[2]||(q[2]=a("h3",null,"Available Models",-1)),a("div",Te,[q[1]||(q[1]=a("span",{class:"search-label"},"Search:",-1)),$(F,{value:y.value,"onUpdate:value":q[0]||(q[0]=p=>y.value=p),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),Ae=H(we,[["__scopeId","data-v-56bdd915"]]),Ue={key:0,class:"cost-group"},qe={class:"cost-item"},Ee={class:"cost-value"},Oe={class:"cost-value"},De={key:1,class:"cost-group"},Fe={class:"enviro-group"},Ie={class:"enviro-item"},Be={class:"enviro-item"},Ve={class:"enviro-item"},Ge={key:0,class:"cost-group"},Se={class:"cost-item"},ze={class:"cost-value"},xe={class:"cost-value"},Ne={class:"enviro-group"},Re={class:"enviro-item"},Ke={class:"enviro-item"},Le={class:"enviro-item"},je={key:0,class:"cost-item financial"},Je={key:0,class:"cost-value"},Qe={key:1,class:"cost-value"},He={class:"cost-item environmental"},Ye={class:"enviro-item"},Ze={class:"enviro-value"},We={class:"enviro-item"},Xe={class:"enviro-value"},et={class:"enviro-item"},tt={class:"enviro-value"},ot={key:0,class:"cost-unit"},lt=Q({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(x){const v=x,o=N(()=>!0);function U(){if(!v.model.capabilities)return"â€”";const d=v.model.capabilities.inputCostPerToken||0,u=v.model.capabilities.outputCostPerToken||0;if(v.mode==="per-thousand"){const b=(d+u)*1e3;return y(b)}else if(v.mode==="total"){const b=d*v.inputTokens+u*v.outputTokens;return y(b)}return"â€”"}function y(d){return d===0?"0.00":d<.01?"<0.01":d<1?d.toFixed(2):d<10?d.toFixed(1):Math.round(d).toString()}function O(d){if(d===0)return"0";if(d>=.01)return d.toFixed(2).replace(/\.?0+$/,"");const b=d.toFixed(10).match(/^0\.0*[1-9]/);if(b){const B=b[0].length-2;return d.toFixed(B)}return d.toFixed(4)}function q(){if(!v.model.capabilities)return"0";const d=(v.model.capabilities.inputCostPerToken||0)*1e3;return O(d)}function F(){if(!v.model.capabilities)return"0";const d=(v.model.capabilities.outputCostPerToken||0)*1e3;return O(d)}function p(){if(!v.model.capabilities)return"?";const d=v.model.capabilities.inputCostPerToken||0,u=v.model.capabilities.outputCostPerToken||0,b=d*v.inputTokens+u*v.minOutputTokens;return O(b)}function g(){if(!v.model.capabilities||!v.maxOutputTokens)return"?";const d=v.model.capabilities.inputCostPerToken||0,u=v.model.capabilities.outputCostPerToken||0,b=d*v.inputTokens+u*v.maxOutputTokens;return O(b)}function M(d){return"??"}function D(d){return"??"}return(d,u)=>(s(),C("div",{class:de(["model-cost-display",[`layout-${d.layout}`,`size-${d.size}`]])},[d.mode==="range"?(s(),C(z,{key:0},[o.value&&d.maxOutputTokens?(s(),C("span",Ue,[a("span",qe,[a("span",Ee,"$"+h(p()),1),u[0]||(u[0]=E(" - ")),a("span",Oe,"$"+h(g()),1)])])):o.value?(s(),C("span",De,u[1]||(u[1]=[a("span",{class:"cost-item"},[a("span",{class:"cost-value"},"Cost: ??")],-1)]))):A("",!0),u[4]||(u[4]=a("span",{class:"cost-tab"},null,-1)),a("span",Fe,[a("span",Ie,"COâ‚‚ "+h(D()),1),u[2]||(u[2]=a("span",{class:"cost-tab"},null,-1)),a("span",Be,"ðŸ’§"+h(D()),1),u[3]||(u[3]=a("span",{class:"cost-tab"},null,-1)),a("span",Ve,"âš¡"+h(D()),1)])],64)):d.mode==="input-output"?(s(),C(z,{key:1},[o.value?(s(),C("span",Ge,[a("span",Se,[a("span",ze,"$"+h(q()),1),u[5]||(u[5]=E("/1K input + ")),a("span",xe,"$"+h(F()),1),u[6]||(u[6]=E("/1K output "))])])):A("",!0),u[9]||(u[9]=a("span",{class:"cost-tab"},null,-1)),a("span",Ne,[a("span",Re,"COâ‚‚ "+h(M()),1),u[7]||(u[7]=a("span",{class:"cost-tab"},null,-1)),a("span",Ke,"ðŸ’§"+h(M()),1),u[8]||(u[8]=a("span",{class:"cost-tab"},null,-1)),a("span",Le,"âš¡"+h(M()),1)])],64)):(s(),C(z,{key:2},[o.value?(s(),C("div",je,[d.mode==="per-thousand"?(s(),C("span",Je,[E(h(U())+" ",1),u[10]||(u[10]=a("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):d.mode==="total"?(s(),C("span",Qe,h(U()),1)):A("",!0)])):A("",!0),a("div",He,[a("span",Ye,[u[11]||(u[11]=a("span",{class:"enviro-icon"},"COâ‚‚",-1)),a("span",Ze,h(M()),1)]),a("span",We,[u[12]||(u[12]=a("span",{class:"enviro-icon"},"ðŸ’§",-1)),a("span",Xe,h(M()),1)]),a("span",et,[u[13]||(u[13]=a("span",{class:"enviro-icon"},"âš¡",-1)),a("span",tt,h(M()),1)]),d.mode==="per-thousand"?(s(),C("span",ot,"/ 1,000")):A("",!0)])],64))],2))}}),pe=H(lt,[["__scopeId","data-v-3110a03b"]]),nt={class:"provider-header"},st={class:"provider-name"},at={class:"provider-model-count"},it={key:0,class:"api-key-warning"},ut={class:"provider-models"},dt=["onClick"],rt={class:"model-name"},ct={key:0,class:"model-specs"},pt=Q({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(x){const v=L(void 0);function o(y){return y}function U(y){v.value===y?v.value=void 0:v.value=y}return(y,O)=>{const q=w("a-button"),F=w("a-collapse-panel"),p=w("a-collapse");return s(),_(p,{activeKey:v.value,"onUpdate:activeKey":O[0]||(O[0]=g=>v.value=g),bordered:!1,accordion:""},{default:m(()=>[(s(!0),C(z,null,K(y.groupedModels,(g,M)=>(s(),_(F,{key:M,class:"provider-panel","data-provider":M},{header:m(()=>[a("div",nt,[a("span",st,h(M),1),a("span",at,h(g.length)+" models",1),y.requiresApiKey(M)&&!y.hasApiKey(y.getProviderGroup(M))?(s(),C("div",it,[$(R(_e)),O[1]||(O[1]=a("span",null,"API Key Missing",-1))])):A("",!0)])]),extra:m(()=>[$(q,{size:"small",type:"text",onClick:ge(D=>U(M),["stop"])},{default:m(()=>[E(h(v.value===M?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:m(()=>[a("div",ut,[(s(!0),C(z,null,K(g,D=>(s(),C("div",{key:D.id,class:de(["model-row",{selected:y.selectedModelId===D.id}]),onClick:d=>y.$emit("select-model",D)},[a("div",rt,h(D.displayName),1),y.hasConfigPanel?A("",!0):(s(),C("div",ct,[$(pe,{model:D,mode:y.mode==="trial"?"range":"input-output","input-tokens":y.getInputTokensForModel(D),"min-output-tokens":10,"max-output-tokens":y.getOutputTokensForModel(D),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,dt))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),ft=H(pt,[["__scopeId","data-v-984223df"]]),mt={class:"config-panel"},vt={class:"config-header"},gt={class:"config-header-title"},_t={key:0,class:"total-cost"},ht={key:0,class:"cost-info"},Ct={class:"config-content"},Mt={class:"param-description"},kt={class:"param-description"},yt={key:0,class:"config-footer"},bt={key:0,class:"duplicate-error"},Pt=Q({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(x,{emit:v}){const o=x,U=v,{getBasicParameters:y,getAdvancedParameters:O,getParametersForModel:q}=ce(),F=L(""),p=ue({}),g=ue({}),M=L(""),D=N(()=>o.selectedModel?y(o.selectedModel.provider,o.selectedModel.modelId):{}),d=N(()=>o.selectedModel?O(o.selectedModel.provider,o.selectedModel.modelId):{});function u(n){if(!n)return;T.info("PARAMDEBUG: setModelDefaults called for",n.provider,n.modelId,"mode:",o.mode),o.mode==="trial"&&(F.value=n.displayName),Object.keys(p).forEach(t=>delete p[t]),Object.keys(g).forEach(t=>delete g[t]);const e=q(n.provider,n.modelId);if(o.initialParameters&&Object.keys(o.initialParameters).length>0){T.info("PARAMDEBUG: using initial parameters:",o.initialParameters),Object.assign(p,o.initialParameters);for(const[t,l]of Object.entries(o.initialParameters)){const f=e[t];l===(f==null?void 0:f.default)?g[t]={mode:"default"}:g[t]={mode:"custom",value:l}}}else{T.info("PARAMDEBUG: allParams found:",Object.keys(e));for(const[t,l]of Object.entries(e))l.required?l.default!==void 0?(g[t]={mode:"default"},p[t]=l.default,T.info("PARAMDEBUG: setting required param",t,"to default =",l.default)):(g[t]={mode:"custom",value:null},p[t]=null,T.info("PARAMDEBUG: required param",t,"needs user input")):l.default!==void 0?(g[t]={mode:"default"},p[t]=l.default,T.info("PARAMDEBUG: setting optional param",t,"to default =",l.default)):(g[t]={mode:"unset"},p[t]=null,T.info("PARAMDEBUG: optional param",t,"starts unset"));T.info("PARAMDEBUG: final parameters:",{...p}),T.info("PARAMDEBUG: parameter states:",{...g})}}Y(()=>o.selectedModel,n=>{u(n),M.value=""},{immediate:!0}),Y(p,()=>{M.value=""},{deep:!0}),re(()=>{o.selectedModel&&u(o.selectedModel)});function b(n,e){const t=g[n],l=p[n];return T.info("PLACEHOLDER DEBUG:",n,"state:",t==null?void 0:t.mode,"value:",l,"param.default:",e.default),!e.required&&(l==null||l==="")||(t==null?void 0:t.mode)==="unset"?"Not set (parameter will be omitted)":e.default!==void 0?(t==null?void 0:t.mode)==="default"?`Using default: ${e.default}`:`Default: ${e.default} (enter to override)`:e.required?"Required - enter value":"Enter value (optional)"}function B(n){const e=g[n],t=o.selectedModel?q(o.selectedModel.provider,o.selectedModel.modelId)[n]:void 0;if(t!=null&&t.required&&(e==null?void 0:e.mode)==="unset"||t!=null&&t.required&&(e==null?void 0:e.mode)==="custom"&&!e.value)return"error";if((e==null?void 0:e.mode)==="default")return"warning"}function S(n){return n.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function V(n,e,t){T.info("PARAMDEBUG: handleParameterChange",n,"new value:",e,"param.required:",t.required),e==null||e===""?t!=null&&t.required?t.default!==void 0&&(p[n]=t.default,g[n]={mode:"default"},T.info("PARAMDEBUG: Required param",n,"cleared, reverting to default:",t.default)):(p[n]=null,g[n]={mode:"unset"},T.info("PARAMDEBUG: Optional param",n,"cleared, setting to unset")):(p[n]=e,e===(t==null?void 0:t.default)?g[n]={mode:"default"}:g[n]={mode:"custom",value:e}),(o.mode==="playground"||o.mode==="standalone")&&U("parameters-changed",{...p})}function Z(){const n=[],e=o.selectedModel?q(o.selectedModel.provider,o.selectedModel.modelId):{};for(const[t,l]of Object.entries(g)){const f=e[t];f!=null&&f.required&&(l.mode==="unset"?n.push(`${S(t)} is required`):l.mode==="custom"&&(l.value===null||l.value===void 0||l.value==="")&&n.push(`${S(t)} needs a value`)),l.mode==="custom"&&l.value!==void 0&&l.value!==null&&((f==null?void 0:f.min)!==void 0&&l.value<f.min&&n.push(`${S(t)} must be >= ${f.min}`),(f==null?void 0:f.max)!==void 0&&l.value>f.max&&n.push(`${S(t)} must be <= ${f.max}`))}return{valid:n.length===0,errors:n}}function W(){if(!o.selectedModel||o.mode==="trial"&&!F.value)return null;const n={},e=q(o.selectedModel.provider,o.selectedModel.modelId),t=(l,f,P)=>{const k=f.split(".");let G=l;for(let I=0;I<k.length-1;I++)G[k[I]]||(G[k[I]]={}),G=G[k[I]];G[k[k.length-1]]=P};for(const[l,f]of Object.entries(g)){const P=e[l];let k;switch(f.mode){case"default":k=P==null?void 0:P.default,T.info("PARAMDEBUG: Using default for",l,"=",k);break;case"custom":k=f.value,T.info("PARAMDEBUG: Using custom value for",l,"=",k);break;case"unset":T.info("PARAMDEBUG: Skipping unset param",l);continue}k!=null&&k!==""?t(n,l,k):k===!1?t(n,l,!1):P!=null&&P.required&&T.error(`Required parameter ${l} has no valid value`)}return{name:o.mode==="trial"?F.value:o.selectedModel.displayName,provider:o.selectedModel.provider,modelId:o.selectedModel.modelId,parameters:n}}function X(){M.value="";const n=Z();if(!n.valid){M.value=`Invalid configuration: ${n.errors.join(", ")}`;return}const e=W();if(e){if(o.existingConfigurations&&o.existingConfigurations.some(l=>l.provider===e.provider&&l.modelId===e.modelId&&JSON.stringify(l.parameters)===JSON.stringify(e.parameters))){M.value=`${e.provider}:${e.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}U("add-configuration",e)}}function ee(n){var e;return((e=o.getInputTokensForModel)==null?void 0:e.call(o,n))||1e3}function j(n){var e;return((e=o.getOutputTokensForModel)==null?void 0:e.call(o,n))||1e3}return(n,e)=>{var se,ae,ie;const t=w("a-button"),l=w("a-input"),f=w("a-form-item"),P=w("a-tag"),k=w("a-input-number"),G=w("a-switch"),I=w("a-select-option"),te=w("a-select"),oe=w("a-col"),le=w("a-row"),ne=w("a-collapse-panel"),fe=w("a-collapse"),me=w("a-form"),ve=w("a-alert");return s(),C("div",mt,[a("div",vt,[a("div",gt,[a("h3",null,h(n.mode==="trial"?"Configure":"Model Parameters")+": "+h(n.selectedModel.displayName),1),n.showCloseButton?(s(),_(t,{key:0,type:"text",onClick:e[0]||(e[0]=i=>n.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:m(()=>[$(R(he))]),_:1})):A("",!0)]),n.mode==="trial"?(s(),C("div",_t,[$(pe,{model:n.selectedModel,mode:"total","input-tokens":((ae=(se=n.costEstimate)==null?void 0:se.inputTokens)==null?void 0:ae.avgTokens)||ee(n.selectedModel),"output-tokens":((ie=n.costEstimate)==null?void 0:ie.outputTokens)||j(n.selectedModel),layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens"]),n.totalCalls>1?(s(),C("span",ht,"("+h(n.totalCalls)+" calls)",1)):A("",!0)])):A("",!0)]),a("div",Ct,[$(me,{layout:"vertical"},{default:m(()=>[n.mode==="trial"?(s(),_(f,{key:0,label:"Configuration Name",required:""},{default:m(()=>[$(l,{value:F.value,"onUpdate:value":e[1]||(e[1]=i=>F.value=i),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):A("",!0),$(fe,{"default-active-key":["basic"],ghost:""},{default:m(()=>[$(ne,{key:"basic",header:"Basic Parameters"},{default:m(()=>[$(le,{gutter:16},{default:m(()=>[(s(!0),C(z,null,K(D.value,(i,r)=>(s(),_(oe,{key:r,span:n.mode==="playground"?24:12},{default:m(()=>[$(f,null,{label:m(()=>{var c,J;return[a("span",null,h(S(r)),1),i.required?(s(),_(P,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[2]||(e[2]=[E("Required")])),_:1,__:[2]})):((c=g[r])==null?void 0:c.mode)==="default"?(s(),_(P,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[3]||(e[3]=[E("Default")])),_:1,__:[3]})):((J=g[r])==null?void 0:J.mode)==="unset"?(s(),_(P,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[4]||(e[4]=[E("Not Set")])),_:1,__:[4]})):A("",!0)]}),default:m(()=>[i.type==="number"?(s(),_(k,{key:0,value:p[r],"onUpdate:value":c=>p[r]=c,min:i.min,max:i.max,step:.1,placeholder:b(r,i),"allow-clear":!i.required,status:B(r),style:{width:"100%"},size:"large",onChange:c=>V(r,c,i)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):i.type==="integer"?(s(),_(k,{key:1,value:p[r],"onUpdate:value":c=>p[r]=c,min:i.min,max:i.max,placeholder:b(r,i),"allow-clear":!i.required,status:B(r),style:{width:"100%"},size:"large",onChange:c=>V(r,c,i)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):i.type==="boolean"?(s(),_(G,{key:2,checked:p[r],"onUpdate:checked":c=>p[r]=c,"checked-children":"true","un-checked-children":"false",onChange:V},null,8,["checked","onUpdate:checked"])):i.type==="string"&&i.enum?(s(),_(te,{key:3,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:i.default?`Default: ${i.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!i.required,status:B(r),onChange:V},{default:m(()=>[i.default?(s(),_(I,{key:0,value:i.default},{default:m(()=>[E(h(i.default)+" (default) ",1)]),_:2},1032,["value"])):A("",!0),i.required?A("",!0):(s(),_(I,{key:1,value:void 0},{default:m(()=>e[5]||(e[5]=[a("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(s(!0),C(z,null,K(i.enum.filter(c=>c!==i.default),c=>(s(),_(I,{key:c,value:c},{default:m(()=>[E(h(c),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(s(),_(l,{key:4,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:b(r,i),"allow-clear":!i.required,status:B(r),size:"large",onChange:V},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),a("div",Mt,h(i.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(d.value).length>0?(s(),_(ne,{key:"advanced",header:"Advanced Parameters"},{default:m(()=>[$(le,{gutter:16},{default:m(()=>[(s(!0),C(z,null,K(d.value,(i,r)=>(s(),_(oe,{key:r,span:n.mode==="playground"?24:12},{default:m(()=>[$(f,null,{label:m(()=>{var c,J;return[a("span",null,h(S(r)),1),i.required?(s(),_(P,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[6]||(e[6]=[E("Required")])),_:1,__:[6]})):((c=g[r])==null?void 0:c.mode)==="default"?(s(),_(P,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[7]||(e[7]=[E("Default")])),_:1,__:[7]})):((J=g[r])==null?void 0:J.mode)==="unset"?(s(),_(P,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[8]||(e[8]=[E("Not Set")])),_:1,__:[8]})):A("",!0)]}),default:m(()=>[i.type==="number"||i.type==="integer"?(s(),_(k,{key:0,value:p[r],"onUpdate:value":c=>p[r]=c,min:i.min,max:i.max,step:i.type==="number"?.1:1,placeholder:b(r,i),"allow-clear":!i.required,status:B(r),style:{width:"100%"},size:"large",onChange:c=>V(r,c,i)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):i.type==="boolean"?(s(),_(G,{key:1,checked:p[r],"onUpdate:checked":c=>p[r]=c,"checked-children":"true","un-checked-children":"false",onChange:V},null,8,["checked","onUpdate:checked"])):i.type==="string"&&i.enum?(s(),_(te,{key:2,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:i.default?`Default: ${i.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!i.required,status:B(r),onChange:V},{default:m(()=>[i.default?(s(),_(I,{key:0,value:i.default},{default:m(()=>[E(h(i.default)+" (default) ",1)]),_:2},1032,["value"])):A("",!0),i.required?A("",!0):(s(),_(I,{key:1,value:void 0},{default:m(()=>e[9]||(e[9]=[a("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(s(!0),C(z,null,K(i.enum.filter(c=>c!==i.default),c=>(s(),_(I,{key:c,value:c},{default:m(()=>[E(h(c),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(s(),_(l,{key:3,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:b(r,i),"allow-clear":!i.required,status:B(r),size:"large",onChange:V},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),a("div",kt,h(i.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})]),n.mode==="trial"?(s(),C("div",yt,[M.value?(s(),C("div",bt,[$(ve,{message:M.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):A("",!0),$(t,{type:"primary",size:"large",onClick:X,disabled:!F.value||!n.selectedModel},{default:m(()=>e[10]||(e[10]=[E(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):A("",!0)])}}}),$t=H(Pt,[["__scopeId","data-v-ec7bb56b"]]),Tt={class:"modal-content-wrapper"},wt={key:0,class:"loading-container"},At={key:1,class:"no-models-container"},Ut={class:"no-models-content"},qt={key:2,class:"modal-content"},Et={class:"models-panel"},Ot={class:"models-list"},Dt=Q({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(x,{emit:v}){const o=x,U=v,y=ke(),{enabledModels:O,loading:q}=ye(),{requiresApiKey:F,getProviderGroup:p}=ce(),{hasApiKey:g}=Ce(),M=N(()=>O.value||[]),D=N(()=>{const e=M.value.length>0;return q.value&&!e}),d=L(""),u=L(null),b=L(null),B=N(()=>{if(!M.value)return{};let e=M.value;if(d.value){const l=d.value.toLowerCase();e=e.filter(f=>f.displayName.toLowerCase().includes(l)||f.modelId.toLowerCase().includes(l))}const t={};for(const l of e)t[l.provider]||(t[l.provider]=[]),t[l.provider].push(l);for(const l in t)t[l].sort((f,P)=>f.displayName.localeCompare(P.displayName));return t}),S=N(()=>{var e;if(o.mode!=="trial")return 1;if(o.trialContext)return o.trialContext.totalCombinations;if(o.design){let t=1;for(const l of Object.values(o.design.variableBindings))l.type==="direct"&&(t*=((e=l.values)==null?void 0:e.length)||1);return t}return 1});Y([u],async()=>{if(!u.value||o.mode!=="trial"){b.value=null;return}if(!o.trialContext&&!o.design){b.value=null;return}try{const e=j(u.value),t=n(u.value),l=u.value.capabilities;if(l!=null&&l.inputCostPerToken&&(l!=null&&l.outputCostPerToken)){const f=e*l.inputCostPerToken/1e3,P=t*l.outputCostPerToken/1e3,k=(f+P)*S.value;b.value={inputTokens:{avgTokens:e},outputTokens:t,totalCost:k,inputCost:f,outputCost:P}}else b.value=null}catch(e){T.error("Failed to calculate cost estimate:",e),b.value=null}});function V(){U("update:visible",!1),y.push("/models")}function Z(e){if(u.value=e,o.mode==="playground"){U("select-model",e),U("update:visible",!1);return}}function W(e){T.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:e,mode:o.mode}),o.mode==="single"?(U("confirm",{model:u.value,configuration:e}),U("update:visible",!1)):U("add-configuration",e)}function X(e){U("select-model",e),U("update:visible",!1)}function ee(){u.value=null}function j(e){var t;if(o.mode==="trial"){if(o.trialContext)return o.trialContext.avgTokens;if(o.design)return((t=o.design.tokenEstimate)==null?void 0:t.avgTokens)||150}return 1e3}function n(e){var t;return o.mode==="trial"?((t=e.capabilities)==null?void 0:t.maxTokens)||256:1e3}return Y(()=>o.visible,e=>{e&&(u.value=null,d.value="",T.debug("GenericModelSelectorModalV3 opened - reset selection"))}),re(()=>{T.debug("GenericModelSelectorModalV3 mounted",{mode:o.mode,visible:o.visible})}),(e,t)=>{const l=w("a-spin"),f=w("a-button"),P=w("a-modal");return s(),_(P,{open:e.visible,onCancel:t[1]||(t[1]=k=>e.$emit("update:visible",!1)),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:m(()=>{var k;return[a("div",Tt,[D.value?(s(),C("div",wt,[$(l,{size:"large",tip:"Loading models..."})])):M.value.length===0?(s(),C("div",At,[a("div",Ut,[$(R(be),{class:"no-models-icon"}),t[3]||(t[3]=a("h3",null,"No Models Available",-1)),t[4]||(t[4]=a("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),$(f,{type:"primary",size:"large",onClick:V},{default:m(()=>[$(R(Me)),t[2]||(t[2]=E(" Go to Models View "))]),_:1,__:[2]})])])):(s(),C("div",qt,[a("div",Et,[$(Ae,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=G=>d.value=G)},null,8,["modelValue"]),a("div",Ot,[$(ft,{"grouped-models":B.value,"selected-model-id":(k=u.value)==null?void 0:k.id,mode:e.mode,"get-input-tokens-for-model":j,"get-output-tokens-for-model":n,"has-config-panel":!!u.value,"requires-api-key":R(F),"get-provider-group":R(p),"has-api-key":R(g),onSelectModel:Z},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),u.value&&e.mode==="trial"?(s(),_($t,{key:0,"selected-model":u.value,mode:e.mode,"total-calls":S.value,"cost-estimate":b.value,"get-input-tokens-for-model":j,"get-output-tokens-for-model":n,"existing-configurations":e.existingConfigurations,onClose:ee,onAddConfiguration:W,onConfirmSelection:X},null,8,["selected-model","mode","total-calls","cost-estimate","existing-configurations"])):A("",!0)]))])]}),_:1},8,["open","title"])}}}),Gt=H(Dt,[["__scopeId","data-v-441cb40e"]]);export{Gt as G,pe as M};

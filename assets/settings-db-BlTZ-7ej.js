import{ag as e,f as a,c as n}from"./vendor-BxfGckcK.js";import{l as t}from"./db-COX2g2xv.js";import{d as s}from"./index-D7qu21q1.js";const r=e("settings",()=>{const e=a(!0),r=a({}),i=a({}),o=a({}),l=a("light");let u=null;const c=e=>{const a={openai:["openai-chat","openai-responses"],anthropic:["anthropic"],ollama:["ollama-chat","ollama-generate"],openrouter:["openrouter"]};if(r.value[e])return r.value[e];for(const[n,t]of Object.entries(a))if(t.includes(e)&&r.value[n])return r.value[n]},p=n(()=>Object.keys(r.value).length>0),d=a({"openai-chat":{enabled:!0},"openai-responses":{enabled:!0},anthropic:{enabled:!0},"ollama-chat":{enabled:!0},"ollama-generate":{enabled:!0},openrouter:{enabled:!0}}),m=n(()=>Object.entries(d.value).filter(([e,a])=>a.enabled).map(([e])=>e)),v=n(()=>[{id:"openai",name:"OpenAI",providers:["openai-chat","openai-responses"]},{id:"anthropic",name:"Anthropic",providers:["anthropic"]},{id:"ollama",name:"Ollama",providers:["ollama-chat","ollama-generate"]},{id:"openrouter",name:"OpenRouter",providers:["openrouter"]}].map(e=>({...e,hasKey:!!r.value[e.id]})));return async function(){await s.open();let a=await s.settings.get("main");a||(a={id:"main",apiKeys:{},customBaseUrls:{}},await s.settings.put(a)),r.value=a.apiKeys||{},i.value=a.customBaseUrls||{},o.value=a.providerConcurrency||{},l.value=a.theme||"light",u=t(()=>s.settings.get("main")).subscribe({next:a=>{a&&(r.value=a.apiKeys||{},i.value=a.customBaseUrls||{},o.value=a.providerConcurrency||{},l.value=a.theme||"light"),e.value=!1},error:a=>{console.error("Settings subscription error:",a),e.value=!1}})}(),{isLoading:e,providers:d,enabledProviders:m,hasAnyApiKeys:p,apiKeyGroups:v,getApiKey:c,setApiKey:async function(e,a){const n=await s.settings.get("main");if(!n)return;const t={...n.apiKeys};a?t[e]=a:delete t[e],await s.settings.update("main",{apiKeys:t})},getBaseUrl:e=>i.value[e],setBaseUrl:async function(e,a){const n=await s.settings.get("main");if(!n)return;const t={...n.customBaseUrls};a?t[e]=a:delete t[e],await s.settings.update("main",{customBaseUrls:t})},getProviderConcurrency:e=>o.value[e],isProviderEnabled:e=>d.value[e]?.enabled??!1,setProviderEnabled:(e,a)=>{d.value[e]?d.value[e].enabled=a:d.value[e]={enabled:a}},hasApiKey:e=>!!c(e),setTheme:async function(e){await s.settings.update("main",{theme:e})},setProviderConcurrency:async function(e,a){const n=await s.settings.get("main"),t={...n?.providerConcurrency||{}};a>0&&a<=64?t[e]=a:delete t[e],await s.settings.update("main",{providerConcurrency:t})},cleanup:function(){u?.unsubscribe()}}});export{r as u};

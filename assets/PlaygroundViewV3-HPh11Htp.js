import{e as _,I as ne,f as N,h as m,i as e,z as E,A as x,y as I,x as y,j as a,G,al as le,B as c,k as z,u as q,c as B,F,C as j,r as M,w as Y,ac as se,ad as W,ae,af as re,ag as oe,aA as ie,ah as Q,a as J,v as V,aI as de,aU as ue,a6 as pe,t as ce,p as K}from"./index-8if2tzRy.js";import{u as me}from"./useV4Models-QI5LH92x.js";import{M as ve,G as ge}from"./GenericModelSelectorModalV3-BRBs_RN-.js";import{c as X,i as ee,g as fe}from"./useHeatmapStylingV3-BYmXqZ2C.js";import{u as _e}from"./useV4ProviderParameters-BVWaAQxs.js";import"./useV4LiveQuery-BpGHTaC2.js";import"./InboxOutlined-9nbeNqrC.js";var he={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};function te(k){for(var l=1;l<arguments.length;l++){var s=arguments[l]!=null?Object(arguments[l]):{},r=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable}))),r.forEach(function(d){be(k,d,s[d])})}return k}function be(k,l,s){return l in k?Object.defineProperty(k,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):k[l]=s,k}var Z=function(l,s){var r=te({},l,s.attrs);return _(ne,te({},r,{icon:he}),null)};Z.displayName="CaretRightOutlined";Z.inheritAttrs=!1;const ye={class:"page-header"},$e={class:"header-actions"},ke={key:0,class:"cost-estimate"},Ce={class:"cost-tooltip"},Pe=N({__name:"PlaygroundHeaderV3",props:{selectedModel:{},estimatedTokens:{},outputTokenLimit:{},disabled:{type:Boolean},loading:{type:Boolean}},emits:["execute"],setup(k){return(l,s)=>{const r=I("a-tooltip"),d=I("a-button");return a(),m("div",ye,[s[4]||(s[4]=e("div",{class:"header-content"},[e("h1",null,[E("LLM Playground "),e("span",{class:"description"},"Test one-off prompts and responses")])],-1)),e("div",$e,[l.selectedModel?(a(),m("div",ke,[_(r,{placement:"bottom"},{title:y(()=>[e("div",Ce,[s[1]||(s[1]=e("div",null,"Cost estimate based on:",-1)),e("div",null,"• Input: "+c(l.estimatedTokens)+" tokens",1),e("div",null,"• Output: 10 - "+c(l.outputTokenLimit)+" tokens",1),s[2]||(s[2]=e("div",null,"• Min assumes 10 token response",-1)),s[3]||(s[3]=e("div",null,"• Max assumes full response limit",-1))])]),default:y(()=>[_(G(le),{class:"info-icon"})]),_:1}),_(ve,{model:l.selectedModel,mode:"range","input-tokens":l.estimatedTokens,"min-output-tokens":10,"max-output-tokens":l.outputTokenLimit,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):x("",!0),_(d,{type:"primary",onClick:s[0]||(s[0]=i=>l.$emit("execute")),disabled:l.disabled,loading:l.loading},{default:y(()=>[E(c(l.loading?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])])}}}),Se=z(Pe,[["__scopeId","data-v-26164535"]]),we={key:0,class:"model-info"},Te={class:"info-header"},Ve={class:"model-name"},xe={class:"provider-badge"},Ie={key:0,class:"info-details"},Me={class:"detail-item"},Re={class:"value"},Ee={class:"detail-item"},Oe={class:"value"},Le={class:"dollar-amount"},De={class:"detail-item"},Ne={class:"value"},ze={class:"dollar-amount"},Be={class:"detail-item"},Ae={class:"value"},Fe={class:"detail-item"},je={class:"value"},Ue={class:"detail-item"},Je={class:"value"},qe=N({__name:"ModelInfoCardV3",props:{model:{}},setup(k){const l=k,s=q(),r=B(()=>s.settings.core.preferences.value);function d(n){return n<.01?n.toFixed(4):n<1?n.toFixed(3):n.toFixed(2)}function i(n){return n?n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(0)+"k":n.toString():"N/A"}function h(n){var u;return!l.model||!((u=r.value)!=null&&u.enableEnvironmentalCosts),"??"}return(n,u)=>n.model?(a(),m("div",we,[e("div",Te,[e("span",Ve,c(n.model.displayName),1),e("span",xe,c(n.model.provider),1)]),n.model.capabilities?(a(),m("div",Ie,[e("div",Me,[u[0]||(u[0]=e("span",{class:"label"},"Context:",-1)),e("span",Re,c(i(n.model.capabilities.contextWindow))+" tokens",1)]),e("div",Ee,[u[2]||(u[2]=e("span",{class:"label"},"Input:",-1)),e("span",Oe,[e("span",Le,"$"+c(d((n.model.capabilities.inputCostPerToken||0)*1e3)),1),u[1]||(u[1]=E("/1k "))])]),e("div",De,[u[4]||(u[4]=e("span",{class:"label"},"Output:",-1)),e("span",Ne,[e("span",ze,"$"+c(d((n.model.capabilities.outputCostPerToken||0)*1e3)),1),u[3]||(u[3]=E("/1k "))])]),e("div",Be,[u[5]||(u[5]=e("span",{class:"label"},"CO₂: 🏭",-1)),e("span",Ae,c(h()),1)]),e("div",Fe,[u[6]||(u[6]=e("span",{class:"label"},"Water: 💧",-1)),e("span",je,c(h()),1)]),e("div",Ue,[u[7]||(u[7]=e("span",{class:"label"},"Energy: ⚡",-1)),e("span",Je,c(h()),1)])])):x("",!0)])):x("",!0)}}),He=z(qe,[["__scopeId","data-v-ce84a924"]]),Ge={class:"left-panel"},We={class:"panel-section"},Qe={class:"panel-section"},Xe={class:"action-buttons"},Ye={key:0,class:"panel-section"},Ze={class:"template-buttons"},Ke=N({__name:"PlaygroundLeftPanelV3",props:{selectedModel:{},promptText:{}},emits:["open-model-selector","load-from-design","clear-prompt","load-template"],setup(k){const l=q(),s=B(()=>{const d=l.templates.templates.value||[],i=l.spreadsheet.prompts.prompts.value||[];return d.length>0||i.length>0}),r=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}];return(d,i)=>{const h=I("a-button");return a(),m("div",Ge,[e("div",We,[i[4]||(i[4]=e("h3",null,"Select Model",-1)),_(h,{type:"primary",size:"large",style:{width:"100%"},onClick:i[0]||(i[0]=n=>d.$emit("open-model-selector"))},{default:y(()=>i[3]||(i[3]=[E(" Select Model ")])),_:1,__:[3]}),_(He,{model:d.selectedModel},null,8,["model"])]),e("div",Qe,[i[7]||(i[7]=e("h3",null,"Actions",-1)),e("div",Xe,[_(h,{type:"default",onClick:i[1]||(i[1]=n=>d.$emit("load-from-design")),disabled:!s.value,block:""},{default:y(()=>i[5]||(i[5]=[E(" Load from Design ")])),_:1,__:[5]},8,["disabled"]),_(h,{type:"default",onClick:i[2]||(i[2]=n=>d.$emit("clear-prompt")),disabled:!d.promptText,block:""},{default:y(()=>i[6]||(i[6]=[E(" Clear Prompt ")])),_:1,__:[6]},8,["disabled"])])]),d.selectedModel?(a(),m("div",Ye,[i[8]||(i[8]=e("h3",null,"Quick Templates",-1)),e("div",Ze,[(a(),m(F,null,j(r,n=>_(h,{key:n.name,size:"small",onClick:u=>d.$emit("load-template",n.prompt)},{default:y(()=>[E(c(n.name),1)]),_:2},1032,["onClick"])),64))])])):x("",!0)])}}}),et=z(Ke,[["__scopeId","data-v-c9dee8ad"]]),tt={class:"template-editor"},st=["placeholder","rows","data-testid","aria-label"],ot=N({__name:"TemplateEditorV3",props:{modelValue:{},label:{},placeholder:{default:"Enter your prompt template..."},required:{type:Boolean},rows:{default:4},variables:{default:()=>[]},variableColors:{default:()=>({})}},emits:["update:modelValue"],setup(k,{expose:l,emit:s}){const r=k,d=s,i=M(),h=M(),n=M(!1),u=B({get:()=>r.modelValue,set:o=>d("update:modelValue",o)}),C=B(()=>{let o=O(u.value);return o=o.replace(/\{\{(\w+)\}\}/g,(v,p)=>{const f=/^\w+$/.test(p),T=r.variableColors[p];return f&&T?`<span class="variable-highlight" style="background-color: ${T.bg}; box-shadow: 0 0 0 1px ${T.bg};">${O(v)}</span>`:f?`<span class="variable-highlight">${O(v)}</span>`:`<span class="variable-error">${O(v)}</span>`}),o=o.replace(/\n/g,"<br>"),o=o.replace(/  /g," &nbsp;"),o.endsWith("<br>")||(o+="<br>"),o});function O(o){const v=document.createElement("div");return v.textContent=o,v.innerHTML}function t(){!i.value||!h.value||(h.value.scrollTop=i.value.scrollTop,h.value.scrollLeft=i.value.scrollLeft)}return Y(u,async()=>{await oe(),t()}),l({focus:()=>{var o;return(o=i.value)==null?void 0:o.focus()}}),(o,v)=>{const p=ae("dompurify-html");return a(),m("div",tt,[e("div",{class:se(["editor-container",{focused:n.value}])},[W(e("div",{ref_key:"highlightRef",ref:h,class:"editor-highlight","aria-hidden":"true"},null,512),[[p,C.value,"template"]]),W(e("textarea",{ref_key:"textareaRef",ref:i,"onUpdate:modelValue":v[0]||(v[0]=f=>u.value=f),class:"editor-textarea",placeholder:o.placeholder,rows:o.rows,"data-testid":o.$attrs["data-testid"]||"textarea-template-editor","aria-label":o.$attrs["aria-label"]||"Template editor textarea",onFocus:v[1]||(v[1]=f=>n.value=!0),onBlur:v[2]||(v[2]=f=>n.value=!1),onScroll:t},null,40,st),[[re,u.value]])],2)])}}}),nt=z(ot,[["__scopeId","data-v-1880e5bc"]]),lt={class:"prompt-section"},at={class:"section-header"},rt={class:"character-count"},it=N({__name:"PromptEditorSectionV3",props:{promptText:{}},emits:["update:prompt-text"],setup(k){return(l,s)=>(a(),m("div",lt,[e("div",at,[s[1]||(s[1]=e("h3",null,"Prompt",-1)),e("span",rt,c(l.promptText.length)+" characters",1)]),_(nt,{"model-value":l.promptText,"onUpdate:modelValue":s[0]||(s[0]=r=>l.$emit("update:prompt-text",r)),rows:6,placeholder:"Enter your prompt here... No variables or placeholders in the playground, just one prompt at a time.","data-testid":"playground-prompt-editor"},null,8,["model-value"])]))}}),dt=z(it,[["__scopeId","data-v-dffa2db6"]]),ut={key:0,class:"logprobs-container"},pt={class:"logprobs-header"},ct=["value"],mt={class:"logprobs-content"},vt=["onMouseenter"],gt={class:"tooltip-header"},ft={class:"tooltip-content"},_t={class:"tooltip-row"},ht={class:"tooltip-value"},bt={class:"tooltip-row"},yt={class:"tooltip-value"},$t={key:0,class:"tooltip-alternatives"},kt={class:"alt-token"},Ct={class:"alt-prob"},Pt={class:"logprobs-legend"},St={class:"legend-bar"},wt=N({__name:"LogprobsDisplay",props:{logprobs:{}},setup(k){const l=M("viridis"),s=M(!1),r=M(null),d=M({}),i=M(null);function h(v){const p=Math.exp(v);return Math.sqrt(p)}function n(v){const p=X[l.value];if(!p)return J.info("No color scale found for:",l.value),{};const f=h(v.logprob),T=ee(f,p.colors),L=fe(T);return{backgroundColor:`${T} !important`,color:`${L} !important`}}function u(v){const p=X[l.value];return p?ee(v,p.colors):"transparent"}function C(v){return v===`
`?"\\n":v==="	"?"\\t":v===" "?"·":v.trim()===""?`[${v.length} spaces]`:v}function O(v,p){r.value=v,s.value=!0,o(p)}function t(){s.value=!1,r.value=null}function o(v){if(!s.value)return;const p=10,f=v.clientX+p,T=i.value,L=T?T.offsetHeight:100,A=v.clientY-L+p;d.value={position:"fixed",left:`${f}px`,top:`${A}px`,zIndex:"1000"}}return(v,p)=>{var f,T,L,A,U;return v.logprobs.hasLogprobs?(a(),m("div",ut,[e("div",pt,[p[2]||(p[2]=e("h4",null,"Token Probabilities",-1)),W(e("select",{"onUpdate:modelValue":p[0]||(p[0]=R=>l.value=R),class:"color-scale-selector"},[(a(!0),m(F,null,j(G(X),(R,b)=>(a(),m("option",{key:b,value:b},c(R.name),9,ct))),128))],512),[[ie,l.value]])]),e("div",mt,[(a(!0),m(F,null,j(v.logprobs.content,(R,b)=>(a(),m("span",{key:b,style:Q(n(R)),class:"logprob-token",onMouseenter:w=>O(R,w),onMouseleave:t,onMousemove:p[1]||(p[1]=w=>o(w))},c(C(R.token)),45,vt))),128))]),s.value?(a(),m("div",{key:0,ref_key:"tooltipRef",ref:i,class:"logprob-tooltip",style:Q(d.value)},[e("div",gt,[e("strong",null,'"'+c((f=r.value)==null?void 0:f.token)+'"',1)]),e("div",ft,[e("div",_t,[p[3]||(p[3]=e("span",{class:"tooltip-label"},"Logprob:",-1)),e("span",ht,c((L=(T=r.value)==null?void 0:T.logprob)==null?void 0:L.toFixed(4)),1)]),e("div",bt,[p[4]||(p[4]=e("span",{class:"tooltip-label"},"Probability:",-1)),e("span",yt,c((Math.exp(((A=r.value)==null?void 0:A.logprob)||0)*100).toFixed(2))+"%",1)]),(U=r.value)!=null&&U.top_logprobs&&r.value.top_logprobs.length>0?(a(),m("div",$t,[p[5]||(p[5]=e("div",{class:"tooltip-section-header"},"Top alternatives:",-1)),(a(!0),m(F,null,j(r.value.top_logprobs,R=>(a(),m("div",{key:R.token,class:"tooltip-alt"},[e("span",kt,'"'+c(C(R.token))+'"',1),e("span",Ct,c((Math.exp(R.logprob)*100).toFixed(2))+"%",1)]))),128))])):x("",!0)])],4)):x("",!0),e("div",Pt,[e("div",St,[(a(),m(F,null,j(10,(R,b)=>e("div",{key:b,style:Q({backgroundColor:u(b/9)}),class:"legend-segment"},null,4)),64))]),p[6]||(p[6]=e("div",{class:"legend-labels"},[e("span",null,"Low probability"),e("span",null,"High probability")],-1))])])):x("",!0)}}}),Tt=z(wt,[["__scopeId","data-v-36cdf50b"]]),Vt={class:"response-display"},xt={key:0,class:"loading-state"},It={key:1,class:"error-state"},Mt={class:"error-details"},Rt={key:2,class:"response-content"},Et={class:"response-text"},Ot={class:"text-content"},Lt={class:"expand-icon"},Dt={class:"metadata-content"},Nt={class:"metadata-grid"},zt={class:"metadata-item"},Bt={class:"value"},At={key:0,class:"metadata-item"},Ft={class:"value"},jt={key:1,class:"metadata-item"},Ut={class:"value"},Jt={class:"cost-amount"},qt={class:"cost-amount"},Ht={class:"cost-amount"},Gt={class:"metadata-item"},Wt={class:"value env-costs"},Qt={class:"env-item"},Xt={class:"env-item"},Yt={class:"env-item"},Zt={class:"raw-response"},Kt={class:"debug-sections"},es={class:"debug-section"},ts={class:"debug-response"},ss={class:"debug-section"},os={class:"debug-response"},ns={class:"debug-section"},ls={class:"debug-response"},as={key:3,class:"empty-state"},rs=N({__name:"ResponseDisplayV3",props:{response:{},isLoading:{type:Boolean},error:{}},setup(k){const l=q(),s=B(()=>l.settings.core.preferences.value),r=M(!1);function d(t){return t<1e-4?t.toFixed(6):t<.01?t.toFixed(4):t.toFixed(3)}function i(t){if(!t)return"No raw response data";try{return JSON.stringify(t,null,2)}catch{return String(t)}}function h(t){if(!t)return"No error details available";try{if(t.debugInfo){const o=t.debugInfo;return`API Request Details:
URL: ${o.url}
Status: ${o.status}

Request Body:
${JSON.stringify(o.requestBody,null,2)}

Response Body:
${JSON.stringify(o.responseBody,null,2)}

Error Details:
${JSON.stringify(o.errorDetails,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`}return t.stack?`Stack Trace:
${t.stack}

Full Error Object:
${JSON.stringify(t,null,2)}`:t.details?`Error Details:
${JSON.stringify(t.details,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`:JSON.stringify(t,null,2)}catch{return String(t)}}function n(t){var o;return(o=s.value)!=null&&o.enableEnvironmentalCosts,"??"}function u(t){if(!t)return"No request data available";try{return JSON.stringify({url:t.url,method:t.method,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function C(t){if(!t)return"No response data available";try{return JSON.stringify({status:t.status,statusText:t.statusText,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function O(t){if(!t)return"No parsing data available";try{return JSON.stringify({providerId:t.providerId,modelId:t.modelId,parameters:t.parameters,parsedResponse:t.parsedResponse,contentExtracted:t.contentExtracted,contentLength:t.contentLength},null,2)}catch{return String(t)}}return(t,o)=>{const v=I("a-spin"),p=I("a-alert"),f=I("a-collapse-panel"),T=I("a-collapse");return a(),m("div",Vt,[t.isLoading?(a(),m("div",xt,[_(v,{size:"large"},{tip:y(()=>o[1]||(o[1]=[E("Generating response...")])),_:1})])):t.error?(a(),m("div",It,[_(p,{type:"error",message:t.error.message||"API Error",description:t.error.details,"show-icon":""},null,8,["message","description"]),t.error?(a(),V(T,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:y(()=>[_(f,{key:"details",header:"Full API Request/Response"},{default:y(()=>[e("pre",Mt,c(h(t.error.response||t.error)),1)]),_:1})]),_:1})):x("",!0)])):t.response?(a(),m("div",Rt,[e("div",Et,[e("pre",Ot,c(t.response.content),1)]),t.response.logprobs?(a(),V(Tt,{key:0,logprobs:t.response.logprobs},null,8,["logprobs"])):x("",!0),e("div",{class:se(["response-metadata",{expanded:r.value}])},[e("h3",{class:"metadata-header",onClick:o[0]||(o[0]=L=>r.value=!r.value)},[e("span",Lt,[r.value?(a(),V(G(de),{key:1})):(a(),V(G(Z),{key:0}))]),o[2]||(o[2]=E(" Response Details "))]),W(e("div",Dt,[e("div",Nt,[e("div",zt,[o[3]||(o[3]=e("span",{class:"label"},"Latency:",-1)),e("span",Bt,c(t.response.latency)+"ms",1)]),t.response.tokens?(a(),m("div",At,[o[4]||(o[4]=e("span",{class:"label"},"Token Usage:",-1)),e("span",Ft,c(t.response.tokens.prompt_tokens||"?")+" input + "+c(t.response.tokens.completion_tokens||"?")+" output = "+c(t.response.tokens.total_tokens||"?")+" total tokens ",1)])):x("",!0),t.response.cost?(a(),m("div",jt,[o[8]||(o[8]=e("span",{class:"label"},"Cost Estimate:",-1)),e("span",Ut,[e("span",Jt,"$"+c(d(t.response.cost.input)),1),o[5]||(o[5]=E(" input + ")),e("span",qt,"$"+c(d(t.response.cost.output)),1),o[6]||(o[6]=E(" output = ")),e("span",Ht,"$"+c(d(t.response.cost.total)),1),o[7]||(o[7]=E(" total "))])])):x("",!0),e("div",Gt,[o[9]||(o[9]=e("span",{class:"label"},"Environmental:",-1)),e("span",Wt,[e("span",Qt,"CO₂ 🏭: "+c(n())+"  ",1),e("span",Xt,"Water 💧: "+c(n())+"  ",1),e("span",Yt,"Energy ⚡: "+c(n()),1)])])]),_(T,{ghost:"",style:{"margin-top":"16px"}},{default:y(()=>[_(f,{key:"raw",header:"Raw API Response"},{default:y(()=>[e("pre",Zt,c(i(t.response.raw)),1)]),_:1})]),_:1}),t.response.debug?(a(),V(T,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:y(()=>[_(f,{key:"debug",header:"🔍 Complete API Request/Response Debug"},{default:y(()=>[e("div",Kt,[e("div",es,[o[10]||(o[10]=e("h4",null,"📤 API Request",-1)),e("pre",ts,c(u(t.response.debug.request)),1)]),e("div",ss,[o[11]||(o[11]=e("h4",null,"📥 API Response",-1)),e("pre",os,c(C(t.response.debug.response)),1)]),e("div",ns,[o[12]||(o[12]=e("h4",null,"⚙️ Response Parser Details",-1)),e("pre",ls,c(O(t.response.debug.parsing)),1)])])]),_:1})]),_:1})):x("",!0)],512),[[ue,r.value]])],2)])):(a(),m("div",as,o[13]||(o[13]=[e("div",{class:"empty-content"},[e("div",{class:"empty-icon"},"💬"),e("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),is=z(rs,[["__scopeId","data-v-70d773b1"]]),ds={key:0,class:"response-section"},us={class:"section-header"},ps={key:0,class:"response-meta"},cs={class:"response-container"},ms=N({__name:"ResponseSectionV3",props:{hasExecuted:{type:Boolean},response:{},error:{},isLoading:{type:Boolean}},setup(k){return(l,s)=>{var r;return l.hasExecuted?(a(),m("div",ds,[e("div",us,[s[0]||(s[0]=e("h3",null,"Response",-1)),l.response&&!l.error?(a(),m("div",ps,[e("span",null,c(l.response.latency)+"ms",1),e("span",null,c(((r=l.response.tokens)==null?void 0:r.total_tokens)||"?")+" tokens",1)])):x("",!0)]),e("div",cs,[_(is,{response:l.response,"is-loading":l.isLoading,error:l.error},null,8,["response","is-loading","error"])])])):x("",!0)}}}),vs=z(ms,[["__scopeId","data-v-cf6c2814"]]),gs={class:"center-panel"},fs=N({__name:"PlaygroundCenterPanelV3",props:{promptText:{},hasExecuted:{type:Boolean},response:{},error:{},isExecuting:{type:Boolean}},emits:["update:prompt-text"],setup(k){return(l,s)=>(a(),m("div",gs,[_(dt,{"prompt-text":l.promptText,"onUpdate:promptText":s[0]||(s[0]=r=>l.$emit("update:prompt-text",r))},null,8,["prompt-text"]),_(vs,{"has-executed":l.hasExecuted,response:l.response,error:l.error,"is-loading":l.isExecuting},null,8,["has-executed","response","error","is-loading"])]))}}),_s=z(fs,[["__scopeId","data-v-e48f18da"]]),hs={class:"parameter-panel"},bs={key:0,class:"params-section"},ys={key:0,class:"reasoning-warning"},$s={key:5,class:"param-description"},ks={key:4,class:"param-description"},Cs={class:"panel-actions"},Ps=N({__name:"ModelParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(k,{emit:l}){const s=k,r=l,{getBasicParameters:d,getAdvancedParameters:i,getUIDefaults:h}=_e(),n=pe({}),u=B(()=>s.model?d(s.model.provider,s.model.modelId):{}),C=B(()=>s.model?i(s.model.provider,s.model.modelId):{}),O=B(()=>s.model?(s.model.provider==="openai-chat"||s.model.provider==="openai-responses")&&(s.model.modelId.match(/^o[0-9]/)||s.model.modelId.match(/^gpt-5/)):!1);function t(p,f){n[p]=f,r("update:modelValue",{...n}),r("change",{...n})}function o(p){return p.replace(/\./g," › ").replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())}function v(){if(!s.model)return;Object.keys(n).forEach(f=>delete n[f]);const p=h(s.model.provider,s.model.modelId);Object.assign(n,p),r("update:modelValue",{...n}),r("change",{...n})}return Y(()=>s.model,p=>{p&&v()},{immediate:!0}),Y(()=>s.modelValue,p=>{Object.assign(n,p)},{immediate:!0,deep:!0}),(p,f)=>{const T=I("a-alert"),L=I("a-input-number"),A=I("a-switch"),U=I("a-select-option"),R=I("a-select"),b=I("a-input"),w=I("a-form-item"),D=I("a-collapse-panel"),H=I("a-collapse"),P=I("a-button");return a(),m("div",hs,[Object.keys(u.value).length>0?(a(),m("div",bs,[f[1]||(f[1]=e("h4",null,"Basic Parameters",-1)),O.value?(a(),m("div",ys,[_(T,{message:"Reasoning models (O* and GPT-5*) do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):x("",!0),(a(!0),m(F,null,j(u.value,(g,S)=>(a(),V(w,{key:S,label:o(S)},{default:y(()=>[g.type==="number"?(a(),V(L,{key:0,value:n[S],onChange:$=>t(S,$),min:g.min,max:g.max,step:g.step||.1,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):g.type==="integer"?(a(),V(L,{key:1,value:n[S],onChange:$=>t(S,$),min:g.min,max:g.max,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder"])):g.type==="boolean"?(a(),V(A,{key:2,checked:n[S],onChange:$=>t(S,$),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):g.type==="string"&&g.enum?(a(),V(R,{key:3,value:n[S],onChange:$=>t(S,$),placeholder:g.default?String(g.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:y(()=>[_(U,{value:void 0},{default:y(()=>f[0]||(f[0]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[0]}),(a(!0),m(F,null,j(g.enum,$=>(a(),V(U,{key:$,value:$},{default:y(()=>[E(c($),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(a(),V(b,{key:4,value:n[S],onChange:$=>t(S,$.target.value),placeholder:String(g.default),size:"large"},null,8,["value","onChange","placeholder"])),g.description?(a(),m("div",$s,c(g.description),1)):x("",!0)]),_:2},1032,["label"]))),128))])):x("",!0),Object.keys(C.value).length>0?(a(),V(H,{key:1,ghost:""},{default:y(()=>[_(D,{key:"advanced",header:"Advanced Parameters"},{default:y(()=>[(a(!0),m(F,null,j(C.value,(g,S)=>(a(),V(w,{key:S,label:o(S)},{default:y(()=>[g.type==="number"||g.type==="integer"?(a(),V(L,{key:0,value:n[S],onChange:$=>t(S,$),min:g.min,max:g.max,step:g.type==="number"?g.step||.1:1,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):g.type==="boolean"?(a(),V(A,{key:1,checked:n[S],onChange:$=>t(S,$),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):g.type==="string"&&g.enum?(a(),V(R,{key:2,value:n[S],onChange:$=>t(S,$),placeholder:g.default?String(g.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:y(()=>[_(U,{value:void 0},{default:y(()=>f[2]||(f[2]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[2]}),(a(!0),m(F,null,j(g.enum,$=>(a(),V(U,{key:$,value:$},{default:y(()=>[E(c($),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(a(),V(b,{key:3,value:n[S],onChange:$=>t(S,$.target.value),placeholder:String(g.default),size:"large"},null,8,["value","onChange","placeholder"])),g.description?(a(),m("div",ks,c(g.description),1)):x("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):x("",!0),e("div",Cs,[_(P,{onClick:v,size:"small"},{default:y(()=>f[3]||(f[3]=[E(" Reset to Defaults ")])),_:1,__:[3]})])])}}}),Ss=z(Ps,[["__scopeId","data-v-723ec687"]]),ws={class:"right-panel"},Ts={class:"panel-header"},Vs={key:0},xs={key:1},Is={key:0,class:"panel-content"},Ms={key:1,class:"no-model-message"},Rs=N({__name:"PlaygroundRightPanelV3",props:{model:{},parameters:{}},emits:["update:parameters","parameters-change"],setup(k,{emit:l}){const s=l;function r(d){s("update:parameters",d),s("parameters-change",d)}return(d,i)=>(a(),m("div",ws,[e("div",Ts,[d.model?(a(),m("h3",Vs,c(d.model.displayName),1)):(a(),m("h3",xs,"Select a Model"))]),d.model?(a(),m("div",Is,[_(Ss,{model:d.model,modelValue:d.parameters,"onUpdate:modelValue":r,onChange:r},null,8,["model","modelValue"])])):(a(),m("div",Ms,i[0]||(i[0]=[e("p",null,"Choose a model from the left panel to configure parameters.",-1)])))]))}}),Es=z(Rs,[["__scopeId","data-v-a054623d"]]),Os={class:"design-list"},Ls=["onClick"],Ds={class:"design-name"},Ns={class:"design-description"},zs={class:"design-preview"},Bs={class:"design-type"},As=N({__name:"DesignSelectorModalV3",props:{open:{type:Boolean}},emits:["close","select"],setup(k,{emit:l}){const s=l,r=q(),d=B(()=>{const h=r.templates.templates.value||[],n=r.spreadsheet.prompts.prompts.value||[];return[...h.map(u=>({id:u.id,name:u.name,description:u.description,text:u.template,type:"template"})),...n.map(u=>({id:u.id,name:u.name,description:u.description,text:u.promptPattern,type:"spreadsheet"}))]});function i(h){s("select",h),s("close")}return(h,n)=>{const u=I("a-modal");return a(),V(u,{open:h.open,title:"Load from Design",width:"800px",footer:null,onCancel:n[0]||(n[0]=C=>h.$emit("close"))},{default:y(()=>[e("div",Os,[(a(!0),m(F,null,j(d.value,C=>(a(),m("div",{key:C.id,class:"design-item",onClick:O=>i(C)},[e("div",Ds,c(C.name),1),e("div",Ns,c(C.description||"No description"),1),e("div",zs,c(C.text.substring(0,100))+"...",1),e("div",Bs,c(C.type),1)],8,Ls))),128))])]),_:1},8,["open"])}}}),Fs=z(As,[["__scopeId","data-v-5324ccd4"]]),js={class:"playground-view","data-testid":"page-playground"},Us={class:"playground-content"},Js=N({__name:"PlaygroundViewV3",setup(k){const{enabledModels:l}=me(),s=q(),r=M(null),d=M(""),i=M({}),h=M(!1),n=M(!1),u=M(!1),C=M(!1),O=M(null),t=M(null),o=B(()=>r.value&&d.value.trim().length>0&&!C.value),v=B(()=>d.value?Math.ceil(d.value.length/4):0),p=B(()=>r.value?i.value.max_tokens||i.value.maxTokens||1e3:256);function f(b){i.value={...b},J.info("Parameters changed:",i.value)}function T(b){d.value=b.text}function L(b){d.value=b}function A(){d.value=""}function U(b){r.value=b,n.value=!1,i.value={},K.supportsLogprobs(b.provider,b.modelId)&&(J.info(`Auto-enabling logprobs for ${b.provider}/${b.modelId}`),oe(()=>{i.value.logprobs=!0,i.value.top_logprobs=5,J.info("Logprobs parameters set after nextTick:",i.value)}))}async function R(){var b,w,D,H;if(!(!o.value||!r.value)){u.value=!0,C.value=!0,O.value=null,t.value=null;try{const P=await s.executeSingleCall(d.value,0,{provider:r.value.provider,modelId:r.value.modelId,...i.value});P.ok?(O.value={content:P.value.content||"",latency:P.value.latency||0,tokens:P.value.usage,cost:P.value.cost,logprobs:P.value.logprobs,features:P.value.features,raw:P.value.raw,debug:P.value.debug,model:r.value},J.info("Playground response set with logprobs:",P.value.logprobs)):t.value={message:((b=P.error)==null?void 0:b.message)||"Failed to execute prompt",details:((w=P.error)==null?void 0:w.details)||((D=P.error)==null?void 0:D.stack)||P.error,response:P.error,debugInfo:(H=P.error)==null?void 0:H.debugInfo}}catch(P){t.value={message:P.message||"An unexpected error occurred",details:P.stack||P.toString(),response:P}}finally{C.value=!1}}}return ce(async()=>{setTimeout(()=>{!r.value&&l.value&&l.value.length>0&&(r.value=l.value[0],K.supportsLogprobs(r.value.provider,r.value.modelId)&&(J.info(`Auto-enabling logprobs for initial model ${r.value.provider}/${r.value.modelId}`),setTimeout(()=>{i.value.logprobs=!0,i.value.top_logprobs=5,J.info("Initial logprobs parameters set:",i.value)},200)))},100)}),(b,w)=>(a(),m("div",js,[_(Se,{"selected-model":r.value,"estimated-tokens":v.value,"output-token-limit":p.value,disabled:!o.value,loading:C.value,onExecute:R},null,8,["selected-model","estimated-tokens","output-token-limit","disabled","loading"]),e("div",Us,[_(et,{"selected-model":r.value,"prompt-text":d.value,onOpenModelSelector:w[0]||(w[0]=D=>n.value=!0),onLoadFromDesign:w[1]||(w[1]=D=>h.value=!0),onClearPrompt:A,onLoadTemplate:L},null,8,["selected-model","prompt-text"]),_(_s,{"prompt-text":d.value,"has-executed":u.value,response:O.value,error:t.value,"is-executing":C.value,"onUpdate:promptText":w[2]||(w[2]=D=>d.value=D)},null,8,["prompt-text","has-executed","response","error","is-executing"]),_(Es,{model:r.value,parameters:i.value,"onUpdate:parameters":w[3]||(w[3]=D=>i.value=D),onParametersChange:f},null,8,["model","parameters"])]),_(Fs,{open:h.value,onClose:w[4]||(w[4]=D=>h.value=!1),onSelect:T},null,8,["open"]),_(ge,{visible:n.value,mode:"playground",title:"Select Model","onUpdate:visible":w[5]||(w[5]=D=>n.value=D),onSelectModel:U},null,8,["visible"])]))}}),Zs=z(Js,[["__scopeId","data-v-e7ff4c3e"]]);export{Zs as default};

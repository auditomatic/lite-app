var e=Object.defineProperty,o=(o,a,t)=>((o,a,t)=>a in o?e(o,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[a]=t)(o,"symbol"!=typeof a?a+"":a,t);import{d as a,R as t,a as i,_ as s}from"./index-JX8mTFJZ.js";import{d as n,f as r,c as l,o as c,a2 as p,Y as d,S as m,a3 as u,k as g,X as h,U as f,W as b,G as v,u as w,F as y,a4 as k,a5 as _,B as x}from"./vendor-BxfGckcK.js";import{u as L}from"./models-db-CmLn_MUd.js";import{p as q}from"./registry-aRYPBFJZ.js";import"./db-COX2g2xv.js";const P=["amazon/nova-lite-v1","amazon/nova-micro-v1","amazon/nova-pro-v1","anthropic/claude-3-haiku","anthropic/claude-3.5-haiku","anthropic/claude-3.5-sonnet","anthropic/claude-3.7-sonnet","anthropic/claude-3.7-sonnet:thinking","anthropic/claude-opus-4","anthropic/claude-sonnet-4","cohere/command-a","cohere/command-r","cohere/command-r-plus","deepseek/deepseek-chat","deepseek/deepseek-r1","google/gemini-2.0-flash-001","google/gemini-2.0-flash-lite-001","google/gemini-2.5-flash","google/gemini-2.5-flash-preview","google/gemini-2.5-flash-preview:thinking","google/gemini-2.5-pro","google/gemini-2.5-pro-preview","google/gemini-flash-1.5","google/gemini-flash-1.5-8b","google/gemini-pro-1.5","google/gemma-2-27b-it","google/gemma-2-9b-it","google/gemma-3-12b-it","google/gemma-3-27b-it","google/gemma-3-4b-it","meta-llama/llama-3-70b-instruct","meta-llama/llama-3-8b-instruct","meta-llama/llama-3.1-405b-instruct","meta-llama/llama-3.1-70b-instruct","meta-llama/llama-3.1-8b-instruct","meta-llama/llama-3.2-1b-instruct","meta-llama/llama-3.2-3b-instruct","meta-llama/llama-3.3-70b-instruct","meta-llama/llama-4-maverick","meta-llama/llama-4-scout","microsoft/phi-3-medium-128k-instruct","microsoft/phi-3-mini-128k-instruct","microsoft/phi-3.5-mini-128k-instruct","microsoft/phi-4","microsoft/phi-4-reasoning-plus","microsoft/wizardlm-2-8x22b","mistralai/ministral-3b","mistralai/ministral-8b","mistralai/mistral-7b-instruct-v0.3","mistralai/mistral-large","mistralai/mistral-large-2407","mistralai/mistral-large-2411","mistralai/mistral-small-24b-instruct-2501","mistralai/mistral-small-3.1-24b-instruct","mistralai/mistral-small-3.2-24b-instruct","mistralai/mistral-tiny","mistralai/mixtral-8x22b-instruct","mistralai/mixtral-8x7b-instruct","nvidia/llama-3.1-nemotron-70b-instruct","nvidia/llama-3.1-nemotron-ultra-253b-v1","nvidia/llama-3.3-nemotron-super-49b-v1","openai/gpt-3.5-turbo-0613","openai/gpt-4-0314","openai/gpt-4-1106-preview","openai/gpt-4.1","openai/gpt-4.1-mini","openai/gpt-4.1-nano","openai/gpt-4.5-preview","openai/gpt-4o-2024-05-13","openai/gpt-4o-2024-08-06","openai/gpt-4o-2024-11-20","openai/gpt-4o-mini-2024-07-18","openai/o1-mini-2024-09-12","openai/o1-preview-2024-09-12","openai/o1-pro","openai/o3","openai/o3-mini","openai/o3-mini-high","openai/o3-pro","openai/o4-mini","openai/o4-mini-high","perplexity/r1-1776","perplexity/sonar","perplexity/sonar-deep-research","perplexity/sonar-pro","perplexity/sonar-reasoning","perplexity/sonar-reasoning-pro","qwen/qwen-2-72b-instruct","qwen/qwen-2.5-72b-instruct","qwen/qwen-2.5-7b-instruct","qwen/qwen-2.5-vl-7b-instruct","qwen/qwen-max","qwen/qwen-plus","qwen/qwen-turbo","qwen/qwen3-14b","qwen/qwen3-235b-a22b","qwen/qwen3-32b","qwen/qwen3-8b","qwen/qwq-32b","x-ai/grok-2-1212","x-ai/grok-3","x-ai/grok-3-beta","x-ai/grok-3-mini","x-ai/grok-3-mini-beta","x-ai/grok-4"];class C{constructor(){o(this,"LITELLM_URL","https://raw.githubusercontent.com/BerriAI/litellm/main/model_prices_and_context_window.json")}async refreshAll(){console.log("ðŸ”„ Refreshing all model sources...");(await Promise.allSettled([this.refreshLiteLLM(),this.refreshOllama(),this.refreshOpenRouter()])).forEach((e,o)=>{"rejected"===e.status&&console.warn(`Model source ${o} failed:`,e.reason)})}async refreshLiteLLM(){try{console.log("Fetching fresh LiteLLM data...");const e=await fetch(this.LITELLM_URL);if(!e.ok)throw new Error(`HTTP ${e.status}`);const o=await e.json();await this.processLiteLLMData(o)}catch(e){console.error("Failed to refresh LiteLLM:",e)}}async processLiteLLMData(e){const o=[],t=new Date,i={openai:["openai-chat","openai-responses"],anthropic:["anthropic"]};for(const[a,s]of Object.entries(e)){const e=s.litellm_provider;if(e&&i[e])for(const n of i[e]){if(("openai-chat"===n||"openai-responses"===n)&&a.match(/(ft|image|dall|embedding|moderation|whisper|tts|transcribe|audio|realtime|search)/i))continue;if("openai-chat"===n&&a.match(/^o[0-9]/))continue;if("openai-responses"===n&&!a.match(/^(o[0-9]|gpt-3\.5|gpt-4)/))continue;const e=q.getProvider(n);if(!e)continue;const i=e.modelRules.find(e=>new RegExp(e.pattern).test(a));if(!i&&"openai-responses"===n)continue;const r=this.extractCapabilities(a,s);o.push({id:`${n}:${a}`,provider:n,modelId:a,displayName:a,enabled:!0,source:"litellm",discoveredAt:t,modifiedAt:t,...r,parameterRules:i?{allows:"*",requires:i.requiredParams||[],forbids:i.forbidden||[],defaults:{}}:void 0,capabilities:r,userModified:!1})}}await a.models.bulkPut(o),console.log(`âœ… Processed ${o.length} models from LiteLLM`)}async refreshOllama(){try{const e=await a.settings.get("main"),o=e?.customBaseUrls["ollama-chat"]||"http://localhost:11434",t=await fetch(`${o}/api/tags`,{signal:AbortSignal.timeout(3e3)});if(!t.ok)return void console.log("Ollama not available");const i=await t.json(),s=[],n=new Date;for(const a of i.models||[])for(const e of["ollama-chat","ollama-generate"]){const o=q.getProvider(e);if(!o)continue;const t=o.modelRules.find(e=>new RegExp(e.pattern).test(a.name));s.push({id:`${e}:${a.name}`,provider:e,modelId:a.name,displayName:a.name,enabled:!0,source:"ollama",discoveredAt:n,modifiedAt:n,parameterRules:t?{allows:"*",requires:t.requiredParams||[],forbids:t.forbidden||[],defaults:{}}:void 0,capabilities:{inputCostPerToken:0,outputCostPerToken:0},userModified:!1})}await a.models.bulkPut(s),console.log(`âœ… Discovered ${s.length} Ollama models`)}catch(e){console.log("Ollama discovery failed (this is normal if not running):",e)}}async refreshOpenRouter(){try{const e=0===await a.models.where("provider").equals("openrouter").count(),o=new Set(P),t=await fetch("https://openrouter.ai/api/v1/models");if(!t.ok)throw new Error(`HTTP ${t.status}`);const i=await t.json(),s=[],n=new Date,r=q.getProvider("openrouter");if(!r)return;for(const a of i.data||[]){const t=r.modelRules.find(e=>new RegExp(e.pattern).test(a.id)),i=parseFloat(a.pricing?.prompt||"0"),l=parseFloat(a.pricing?.completion||"0"),c=e&&o.has(a.id);s.push({id:`openrouter:${a.id}`,provider:"openrouter",modelId:a.id,displayName:a.id,enabled:c,source:"openrouter",discoveredAt:n,modifiedAt:n,capabilities:{contextWindow:a.context_length||4096,maxTokens:a.top_provider?.max_completion_tokens,inputCostPerToken:i,outputCostPerToken:l,supportsJsonMode:a.supported_parameters?.includes("response_format")||!1,supportsFunctionCalling:a.supported_parameters?.includes("tools")||!1,supportsStreaming:!0},parameterRules:t?{allows:"*",requires:t.requiredParams||[],forbids:t.forbidden||[],defaults:{}}:void 0,userModified:!1})}await a.models.bulkPut(s),console.log(`âœ… Fetched ${s.length} OpenRouter models`)}catch(e){console.error("Failed to fetch OpenRouter models:",e)}}async enableOpenRouterFavorites(){try{const e=new Set(P),o=(await a.models.where("provider").equals("openrouter").toArray()).map(o=>({key:o.id,changes:{enabled:e.has(o.modelId),modifiedAt:new Date}}));await a.models.bulkUpdate(o),console.log(`âœ… Enabled ${e.size} OpenRouter favorite models`)}catch(e){throw console.error("Failed to enable OpenRouter favorites:",e),e}}extractCapabilities(e,o){return{contextWindow:o.max_input_tokens||o.max_tokens,maxTokens:o.max_tokens,maxInputTokens:o.max_input_tokens,maxOutputTokens:o.max_output_tokens||o.max_tokens,inputCostPerToken:o.input_cost_per_token,outputCostPerToken:o.output_cost_per_token,supportsFunctionCalling:o.supports_function_calling||!1,supportsVision:o.supports_vision||!1,supportsParallelFunctionCalling:o.supports_parallel_function_calling||!1,supportsResponseSchema:o.supports_response_schema||!1,supportsJsonMode:this.inferJsonModeSupport(e,o),supportsStreaming:"bedrock"!==o.litellm_provider}}inferJsonModeSupport(e,o){return"openai"===o.litellm_provider&&(e.includes("gpt-4")||e.includes("gpt-3.5-turbo"))}}const M=new C,R=Object.freeze(Object.defineProperty({__proto__:null,ModelDiscovery:C,modelDiscovery:M},Symbol.toStringTag,{value:"Module"})),F={class:"models-view"},O={class:"page-header"},T={class:"provider-header"},j={class:"provider-name"},A={key:1},S={key:0},D={key:1,class:"text-secondary"},E={key:0,class:"cost-value"},$={key:1,class:"text-secondary"},z=s(n({__name:"ModelsView",setup(e){const o=L(),a=r(""),s=r(!1),n=r(""),P=r([]),C=[{title:"Enabled",key:"enabled",width:80,align:"center"},{title:"Model",key:"model",width:300},{title:"Source",key:"source",width:100,align:"center"},{title:"Context",key:"context",width:100,align:"right"},{title:"Cost/1M",key:"cost",width:100,align:"right"}],z=l(()=>{const e=a.value.toLowerCase(),t={};for(const[a,i]of Object.entries(o.modelsByProvider)){const o=i.filter(o=>o.displayName.toLowerCase().includes(e)||o.modelId.toLowerCase().includes(e)||a.toLowerCase().includes(e));o.length>0&&(t[a]=o)}return t}),I=l(()=>a.value?`No models found matching "${a.value}"`:'No models available. Click "Refresh Models" to discover models.');function U(e){const o=q.getProvider(e);return o?.name||e}function B(e){const a=o.modelsByProvider[e]||[];return a.length>0&&a.every(e=>e.enabled)}async function N(){try{const{modelDiscovery:e}=await i(async()=>{const{modelDiscovery:e}=await Promise.resolve().then(()=>R);return{modelDiscovery:e}},void 0,import.meta.url);await e.enableOpenRouterFavorites()}catch(e){console.error("Failed to enable OpenRouter favorites:",e),alert("Failed to enable OpenRouter favorites: "+(e instanceof Error?e.message:"Unknown error"))}}async function W(){s.value=!0,n.value="";try{await M.refreshAll()}catch(e){console.error("Failed to refresh models:",e),n.value="Failed to refresh models. Some sources may be unavailable."}finally{s.value=!1}}function J(e){const o=1e6*e;return o<.01?o.toFixed(4):o<1?o.toFixed(3):o<100?o.toFixed(2):o.toFixed(1)}return c(async()=>{0===o.allModels.length&&await W(),P.value=Object.keys(o.modelsByProvider)}),(e,i)=>{const r=f("a-button"),l=f("a-space"),c=f("a-alert"),L=f("a-input-search"),q=f("a-tag"),M=f("a-switch"),R=f("a-table"),K=f("a-collapse-panel"),V=f("a-collapse"),H=f("a-empty");return b(),p("div",F,[d("div",O,[i[5]||(i[5]=d("div",{class:"header-content"},[d("h1",null,"Model Management"),d("p",{class:"description"},"Configure and enable AI models for testing")],-1)),g(l,null,{default:h(()=>[g(r,{type:"primary",onClick:W,loading:s.value},{icon:h(()=>[g(w(t))]),default:h(()=>[i[4]||(i[4]=v(" Refresh Models "))]),_:1,__:[4]},8,["loading"])]),_:1})]),n.value?(b(),m(c,{key:0,type:"error",message:n.value,closable:"",onClose:i[0]||(i[0]=e=>n.value=""),class:"error-alert"},null,8,["message"])):u("",!0),g(L,{value:a.value,"onUpdate:value":i[1]||(i[1]=e=>a.value=e),placeholder:"Search models by name, provider, or ID...","allow-clear":"",size:"large",class:"search-bar"},null,8,["value"]),g(V,{activeKey:P.value,"onUpdate:activeKey":i[3]||(i[3]=e=>P.value=e),class:"provider-collapse",bordered:!1},{default:h(()=>[(b(!0),p(y,null,k(z.value,(e,a)=>(b(),m(K,{key:a},{header:h(()=>[d("div",T,[d("span",j,[d("strong",null,_(U(a)),1),g(q,{size:"small",color:"blue"},{default:h(()=>[v(_(e.length)+" models",1)]),_:2},1024)]),g(l,{size:"small",onClick:i[2]||(i[2]=x(()=>{},["stop"]))},{default:h(()=>["openrouter"===a?(b(),m(r,{key:0,size:"small",type:"primary",ghost:"",onClick:x(N,["stop"])},{default:h(()=>i[6]||(i[6]=[v(" Enable Favorites ")])),_:1,__:[6]})):u("",!0),g(r,{size:"small",type:B(a)?"default":"primary",onClick:x(e=>async function(e,a){await o.toggleProvider(e,a)}(a,!B(a)),["stop"])},{default:h(()=>[v(_(B(a)?"Disable All":"Enable All"),1)]),_:2},1032,["type","onClick"])]),_:2},1024)])]),default:h(()=>[g(R,{columns:C,"data-source":e,pagination:!1,size:"small",scroll:{y:"calc((100vh - 250px) * 0.75)"},"row-key":"id",class:"models-table"},{bodyCell:h(({column:e,record:a})=>{return["enabled"===e.key?(b(),m(M,{key:0,checked:a.enabled,onChange:e=>async function(e,a){await o.toggleModel(e,a)}(a.id,e),size:"small"},null,8,["checked","onChange"])):u("",!0),"model"===e.key?(b(),p("code",A,_(a.modelId),1)):u("",!0),"source"===e.key?(b(),p(y,{key:2},[a.source?(b(),m(q,{key:0,size:"small",color:"cyan"},{default:h(()=>[v(_(a.source),1)]),_:2},1024)):u("",!0)],64)):u("",!0),"context"===e.key?(b(),p(y,{key:3},[a.capabilities?.contextWindow?(b(),p("span",S,_((t=a.capabilities.contextWindow,t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(0)+"K":t.toString())),1)):(b(),p("span",D,"-"))],64)):u("",!0),"cost"===e.key?(b(),p(y,{key:4},[a.capabilities?.inputCostPerToken?(b(),p("span",E," $"+_(J(a.capabilities.inputCostPerToken)),1)):(b(),p("span",$,"-"))],64)):u("",!0)];var t}),_:2},1032,["data-source"])]),_:2},1024))),128))]),_:1},8,["activeKey"]),0===Object.keys(z.value).length?(b(),m(H,{key:1,description:I.value,class:"empty-state"},null,8,["description"])):u("",!0)])}}}),[["__scopeId","data-v-59418f7f"]]);export{z as default};

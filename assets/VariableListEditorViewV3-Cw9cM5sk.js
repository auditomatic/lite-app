import{d as Q,f as $,c as I,w as P,R as p,Y as c,S as a,_ as K,V as k,G as f,k as i,Z as r,F as X,W as Z,U as ae,$ as G,a1 as de,o as ce,X as ve,u as se}from"./vue-vendor-Cg89ltm_.js";import{a as le}from"./useV4VariableLists-D0rgacBk.js";import{u as pe}from"./useV4VariableListCommands-Do8qVU8R.js";import{w as ie,m as ee,T as ne,I as oe,W as me,o as fe,k as O,L as _e,p as ge,q as he,r as be,s as ye,t as we,u as ke,v as Ce,K as xe,H as Ve}from"./ui-vendor-COTxn_WH.js";import{h as te}from"./index-BbRRImK4.js";import"./useV4LiveQuery-BFmmrRUn.js";import"./utils-vendor-BXgHPvEJ.js";import"./data-vendor-lJS7wsn4.js";const Le={class:"simple-list-editor"},Ie={class:"editor-content"},$e={class:"bulk-entry-section"},Ee={class:"section-header"},Ae={class:"entry-stats"},Se={key:0,class:"duplicates-warning"},ze={class:"textarea-container"},Ue={class:"textarea-actions"},Ke={key:0,class:"preview-section"},Fe={class:"section-header"},Ne={class:"preview-grid"},Te={key:0,class:"preview-more"},Be=Q({__name:"SimpleListEditorV3",props:{values:{},category:{}},emits:["update:values"],setup(j,{emit:F}){const _=j,E=F,C=$(""),u=$(),d=I(()=>C.value.trim()?C.value.split(`
`).map(m=>m.trim()).filter(m=>m.length>0):[]),h=I(()=>{const m=new Set;return d.value.filter(g=>m.has(g)?!1:(m.add(g),!0))}),b=I(()=>d.value.length-h.value.length),N=I(()=>h.value.slice(0,20));function T(){E("update:values",h.value)}function M(){C.value="",E("update:values",[])}function s(){u.value?.click()}function v(m){const g=m.target.files?.[0];if(!g)return;const A=new FileReader;A.onload=S=>{const z=S.target?.result;z&&(C.value=z,T())},A.readAsText(g)}function x(){return _.category==="refusal"?`Enter refusal values, one per line:

I cannot help with that
I'm not able to assist with this request  
That's not something I can do
I don't feel comfortable with that

Tip: You can paste from spreadsheets or import from files`:`Enter values, one per line:

red
blue
green
yellow

Tip: You can paste from spreadsheets or import from files`}function V(){switch(_.category){case"simple":return"Simple List";case"refusal":return"Refusal List";default:return"List"}}return P(()=>_.values,m=>{m.length>0&&!C.value&&(C.value=m.join(`
`))},{immediate:!0}),(m,g)=>{const A=ie,S=ee,z=ne;return c(),p("div",Le,[a("div",Ie,[a("div",$e,[a("div",Ee,[a("h4",null,k(m.category==="refusal"?"Refusal Values":"Values"),1),a("div",Ae,[f(k(h.value.length)+" "+k(h.value.length===1?"value":"values")+" ",1),b.value>0?(c(),p("span",Se," ("+k(b.value)+" duplicates) ",1)):K("",!0)])]),a("div",ze,[i(A,{value:C.value,"onUpdate:value":g[0]||(g[0]=U=>C.value=U),placeholder:x(),rows:15,size:"large",class:"values-textarea",onChange:T},null,8,["value","placeholder"]),a("div",Ue,[i(S,{onClick:M,type:"text",danger:"",size:"small"},{default:r(()=>g[1]||(g[1]=[f(" Clear All ")])),_:1,__:[1]}),i(S,{onClick:s,type:"text",size:"small"},{default:r(()=>g[2]||(g[2]=[f(" Import from File ")])),_:1,__:[2]})])])]),h.value.length>0?(c(),p("div",Ke,[a("div",Fe,[g[3]||(g[3]=a("h4",null,"Preview",-1)),i(z,{color:m.category==="refusal"?"red":"blue"},{default:r(()=>[f(k(V()),1)]),_:1},8,["color"])]),a("div",Ne,[(c(!0),p(X,null,Z(N.value,(U,B)=>(c(),p("div",{key:B,class:"preview-item"},k(U),1))),128)),h.value.length>20?(c(),p("div",Te," ... and "+k(h.value.length-20)+" more ",1)):K("",!0)])])):K("",!0),a("input",{ref_key:"fileInput",ref:u,type:"file",accept:".txt,.csv",style:{display:"none"},onChange:v},null,544)])])}}}),Re=te(Be,[["__scopeId","data-v-1861ba6b"]]),De={class:"attributed-list-editor"},Me={class:"editor-content"},We={key:0,class:"progressive-disclosure-section"},qe={class:"disclosure-options"},Ye={key:1,class:"example-notice"},Oe={class:"notice-content"},Pe={class:"attribute-keys-section"},je={class:"section-header"},He={class:"attribute-keys-grid"},Ge={class:"items-section"},Xe={class:"section-header"},Ze={class:"items-actions"},Je={class:"items-table-container"},Qe={key:2,class:"stats-section"},et={class:"stats-grid"},tt={class:"stat-label"},at={class:"stat-values"},st=Q({__name:"AttributedListEditorV3",props:{items:{},attributeKeys:{},showExample:{type:Boolean}},emits:["update:items","update:attribute-keys"],setup(j,{emit:F}){const _=j,E=F,{attributedLists:C}=le(),u=$(_.attributeKeys.length>0?[..._.attributeKeys]:["attribute_1","attribute_2"]),d=$([]),h=$(!1),b=$(!1);let N=1;function T(){const t=C.value.find(e=>e.name==="Intersectional Names 24");t?.items&&t?.attributeKeys&&(u.value=[...t.attributeKeys],d.value=t.items.map(e=>({...e,id:N++})),v())}const M=I(()=>{const t=[{title:"Value",key:"value",dataIndex:"value",width:200,fixed:"left"}];return u.value.forEach(e=>{e.trim()&&t.push({title:e,key:`attr_${e}`,dataIndex:`attr_${e}`,width:150,fixed:void 0})}),t.push({title:"Actions",key:"actions",dataIndex:"actions",width:80,fixed:"left"}),t});function s(){const t={};return u.value.forEach(e=>{e.trim()&&(t[e]="")}),{id:N++,value:"",attributes:t}}function v(){const t=d.value.filter(n=>n.value.trim()).map(n=>({value:n.value.trim(),attributes:{...n.attributes}})),e=u.value.filter(n=>n.trim());E("update:items",t),E("update:attribute-keys",e)}function x(){h.value=!0,b.value=!0,T()}function V(){h.value=!0,b.value=!1,u.value=["attribute_1","attribute_2"],d.value=[s()],v()}function m(){u.value.length<10&&(u.value.push(`attribute${u.value.length+1}`),d.value.forEach(t=>{t.attributes[`attribute${u.value.length}`]=""}),v())}function g(t){if(u.value.length>1){const e=u.value[t];u.value.splice(t,1),d.value.forEach(n=>{delete n.attributes[e]}),v()}}function A(){d.value.forEach(t=>{const e={};u.value.forEach(n=>{n.trim()&&(e[n]=t.attributes[n]||"")}),t.attributes=e}),v()}function S(){d.value.push(s()),v()}function z(t){d.value.length>1&&(d.value.splice(t,1),v())}function U(){d.value=[s()],v()}function B(){v()}function H(t){const e=new Set;return d.value.forEach(n=>{const L=n.attributes[t]?.trim();L&&e.add(L)}),Array.from(e)}function J(t,e){return d.value.filter(n=>n.attributes[t]?.trim()===e).length}function l(t){const e=["blue","green","orange","purple","red","cyan","magenta","yellow"];let n=0;for(let L=0;L<t.length;L++)n=t.charCodeAt(L)+((n<<5)-n);return e[Math.abs(n)%e.length]}function o(){_.items.length>0?d.value=_.items.map(t=>({...t,id:N++})):d.value=[]}return P(()=>_.items,()=>{o(),_.items.length>0&&(h.value=!0,b.value=!1)},{immediate:!0}),P(()=>_.attributeKeys,t=>{t.length>0&&(u.value=[...t])},{immediate:!0}),P(()=>_.showExample,t=>{t&&_.items.length===0&&(h.value=!1,b.value=!1)},{immediate:!0}),(t,e)=>{const n=ee,L=oe,W=me,q=ne;return c(),p("div",De,[a("div",Me,[t.showExample&&!h.value&&d.value.length===0?(c(),p("div",We,[e[4]||(e[4]=a("div",{class:"disclosure-header"},[a("div",{class:"disclosure-icon"},"üöÄ"),a("div",{class:"disclosure-content"},[a("h3",null,"Create Your First Intersectional List"),a("p",null,"Intersectional lists will fill the variable placeholder in the prompt with a single text (e.g. name, city) that is tagged with one or more attributes (e.g. name ‚Üí gender and ethnicity, city ‚Üí region, size). Choose your starting point:")])],-1)),a("div",qe,[a("div",{class:"option-card example-option",onClick:x},[e[1]||(e[1]=ae('<div class="option-header" data-v-af07779a><span class="option-icon" data-v-af07779a>üéØ</span><h4 data-v-af07779a>Start with Example</h4><span class="option-badge recommended" data-v-af07779a>Recommended</span></div><p data-v-af07779a>Pre-loaded with 24 diverse names including race and gender attributes for bias testing. Perfect for beginners.</p><div class="option-preview" data-v-af07779a><div class="preview-items" data-v-af07779a><span class="preview-item" data-v-af07779a>Arjun Agarwal (Indian, Man)</span><span class="preview-item" data-v-af07779a>Latonya Booker (Black, Woman)</span><span class="preview-item" data-v-af07779a>MS [LAST NAME] (Control, Woman)</span><span class="preview-item" data-v-af07779a>A. Chen (Chinese, Control)</span><span class="preview-more" data-v-af07779a>+ 20 more names</span></div></div>',3)),i(n,{type:"primary",size:"large",block:""},{default:r(()=>e[0]||(e[0]=[f(" Use Example & Modify ")])),_:1,__:[0]})]),a("div",{class:"option-card fresh-option",onClick:V},[e[3]||(e[3]=ae('<div class="option-header" data-v-af07779a><span class="option-icon" data-v-af07779a>üìù</span><h4 data-v-af07779a>Start from Scratch</h4><span class="option-badge" data-v-af07779a>Advanced</span></div><p data-v-af07779a>Create your own intersectional list from scratch. Define your own attributes and add items manually.</p><div class="option-preview" data-v-af07779a><div class="preview-attributes" data-v-af07779a><span class="preview-attr" data-v-af07779a>attribute_1</span><span class="preview-attr" data-v-af07779a>attribute_2</span><span class="preview-more" data-v-af07779a>+ add more attributes</span></div></div>',3)),i(n,{size:"large",block:""},{default:r(()=>e[2]||(e[2]=[f(" Start Fresh ")])),_:1,__:[2]})])])])):K("",!0),b.value?(c(),p("div",Ye,[a("div",Oe,[e[6]||(e[6]=a("span",{class:"notice-icon"},"üéØ",-1)),e[7]||(e[7]=a("div",{class:"notice-text"},[a("strong",null,"Working with Intersectional Names 24 Example"),a("p",null,"You can modify these names and attributes, or add new ones. This is a great starting point for intersectional bias testing.")],-1)),i(n,{onClick:V,type:"text",size:"small"},{default:r(()=>e[5]||(e[5]=[f(" Clear & Start Fresh ")])),_:1,__:[5]})])])):K("",!0),a("div",Pe,[a("div",je,[e[9]||(e[9]=a("h4",null,"Attribute Keys",-1)),i(n,{size:"small",onClick:m,disabled:u.value.length>=10},{default:r(()=>e[8]||(e[8]=[f(" Add Key ")])),_:1,__:[8]},8,["disabled"])]),a("div",He,[(c(!0),p(X,null,Z(u.value,(w,y)=>(c(),p("div",{key:y,class:"attribute-key-item"},[i(L,{value:u.value[y],"onUpdate:value":R=>u.value[y]=R,placeholder:"e.g., race_signal, gender_signal",size:"large",onChange:A},null,8,["value","onUpdate:value"]),i(n,{type:"text",danger:"",onClick:R=>g(y),disabled:u.value.length<=1,class:"remove-key-btn"},{default:r(()=>e[10]||(e[10]=[f(" ‚úï ")])),_:2,__:[10]},1032,["onClick","disabled"])]))),128))]),e[11]||(e[11]=a("div",{class:"attributes-help"},[a("p",null,'Define the signal attributes each item will have (e.g., "race_signal", "gender_signal", "age_group").')],-1))]),a("div",Ge,[a("div",Xe,[a("h4",null,"Items ("+k(d.value.length)+")",1),a("div",Ze,[i(n,{size:"small",onClick:S},{default:r(()=>e[12]||(e[12]=[f(" Add Item ")])),_:1,__:[12]}),i(n,{size:"small",onClick:U,danger:"",type:"text"},{default:r(()=>e[13]||(e[13]=[f(" Clear All ")])),_:1,__:[13]})])]),a("div",Je,[i(W,{dataSource:d.value,columns:M.value,pagination:!1,scroll:{x:Math.max(600,u.value.length*150+300),y:500},size:"small","row-key":"id",class:"items-table"},{bodyCell:r(({column:w,record:y,index:R})=>[w.key==="value"?(c(),G(L,{key:0,value:y.value,"onUpdate:value":D=>y.value=D,placeholder:"Enter value",size:"small",onChange:B},null,8,["value","onUpdate:value"])):w.key.startsWith("attr_")?(c(),G(L,{key:1,value:y.attributes[w.key.replace("attr_","")],"onUpdate:value":D=>y.attributes[w.key.replace("attr_","")]=D,placeholder:"Enter attribute",size:"small",onChange:B},null,8,["value","onUpdate:value"])):w.key==="actions"?(c(),G(n,{key:2,type:"text",danger:"",size:"small",onClick:D=>z(R),disabled:d.value.length<=1},{default:r(()=>e[14]||(e[14]=[f(" Delete ")])),_:2,__:[14]},1032,["onClick","disabled"])):K("",!0)]),_:1},8,["dataSource","columns","scroll"])])]),d.value.length>0?(c(),p("div",Qe,[e[15]||(e[15]=a("div",{class:"section-header"},[a("h4",null,"Attribute Statistics")],-1)),a("div",et,[(c(!0),p(X,null,Z(u.value.filter(w=>w.trim()),w=>(c(),p("div",{key:w,class:"stat-item"},[a("div",tt,k(w),1),a("div",at,[(c(!0),p(X,null,Z(H(w),y=>(c(),G(q,{key:y,size:"small",color:l(y)},{default:r(()=>[f(k(y)+" ("+k(J(w,y))+") ",1)]),_:2},1032,["color"]))),128))])]))),128))])])):K("",!0)])])}}}),lt=te(st,[["__scopeId","data-v-af07779a"]]),it={class:"variable-list-editor-page"},nt={class:"header-content"},ot={class:"page-title"},rt={class:"editor-container"},ut={key:0,class:"loading-container"},dt={key:1,class:"editor-form"},ct={class:"form-section"},vt={class:"form-row"},pt={class:"form-section"},mt={class:"section-header"},ft={key:0},_t={key:1},gt={class:"footer-content"},ht={class:"footer-actions"},bt=Q({__name:"VariableListEditorViewV3",setup(j){const F=de(),_=ve(),{variableLists:E,loading:C}=le(),{createVariableList:u,updateVariableList:d,isExecuting:h}=pe(),b=I(()=>F.params.id),N=I(()=>F.query.category||"simple"),T=I(()=>C.value||h.value),M=I(()=>h.value),s=$({name:"",description:"",category:"simple"}),v=$([]),x=$([]),V=$(["attribute_1","attribute_2"]);function m(){if(!b.value){s.value.category=N.value;return}const l=E.value.find(o=>o.id===b.value);if(!l){C.value||(O.error("Variable list not found"),_.push("/variables"));return}s.value.name=l.name,s.value.description=l.description||"",s.value.category=l.category,l.category==="simple"||l.category==="refusal"?v.value=[...l.values||[]]:l.category==="attributed"&&(x.value=[...l.items||[]],V.value=[...l.attributeKeys||["attribute_1","attribute_2"]])}function g(){v.value=[],x.value=[],V.value=["attribute_1","attribute_2"]}function A(l){v.value=l}function S(l){x.value=l}function z(l){V.value=l}const U=I(()=>s.value.name.trim()?s.value.category==="simple"||s.value.category==="refusal"?v.value.length>0&&v.value.some(l=>l.trim()):s.value.category==="attributed"?x.value.length>0&&V.value.length>0&&x.value.some(l=>l.value.trim()):!1:!1);async function B(){if(U.value)if(b.value){const l={name:s.value.name.trim(),description:s.value.description?.trim()||void 0};s.value.category==="simple"||s.value.category==="refusal"?l.values=v.value.filter(t=>t.trim()):s.value.category==="attributed"&&(l.items=x.value.filter(t=>t.value.trim()),l.attributeKeys=V.value.filter(t=>t.trim()));const o=await d(b.value,l);o.ok?(O.success("Variable list updated successfully"),_.push("/variables")):O.error(`Failed to update variable list: ${o.error.message}`)}else{const l={name:s.value.name.trim(),description:s.value.description?.trim()||void 0,category:s.value.category};s.value.category==="simple"||s.value.category==="refusal"?l.values=v.value.filter(t=>t.trim()):s.value.category==="attributed"&&(l.items=x.value.filter(t=>t.value.trim()),l.attributeKeys=V.value.filter(t=>t.trim()));const o=await u(l);o.ok?(O.success("Variable list created successfully"),_.push("/variables")):O.error(`Failed to create variable list: ${o.error.message}`)}}function H(){_.push("/variables")}function J(l){switch(l){case"simple":return"Simple List";case"attributed":return"Intersectional List";case"refusal":return"Refusal List";default:return"List"}}return ce(()=>{m()}),P([()=>F.params.id,E],()=>{m()},{immediate:!0}),(l,o)=>{const t=ee,e=_e,n=be,L=oe,W=we,q=Ce,w=ke,y=ie,R=ye,D=he,re=xe,ue=fe;return c(),p("div",it,[i(ue,null,{default:r(()=>[i(e,{class:"editor-header"},{default:r(()=>[a("div",nt,[i(t,{type:"text",onClick:H,class:"back-button"},{icon:r(()=>[i(se(ge))]),default:r(()=>[o[3]||(o[3]=f(" Back to Variable Lists "))]),_:1,__:[3]}),a("h1",ot,k(b.value?"Edit Variable List":"Create Variable List"),1)])]),_:1}),i(D,{class:"editor-content"},{default:r(()=>[a("div",rt,[T.value?(c(),p("div",ut,[i(n,{size:"large",tip:"Loading variable list..."})])):(c(),p("div",dt,[i(R,{model:s.value,layout:"vertical"},{default:r(()=>[a("div",ct,[o[7]||(o[7]=a("div",{class:"section-header"},[a("h3",null,"Basic Information")],-1)),a("div",vt,[i(W,{label:"Name",rules:[{required:!0,message:"Name is required"}],class:"form-item"},{default:r(()=>[i(L,{value:s.value.name,"onUpdate:value":o[0]||(o[0]=Y=>s.value.name=Y),placeholder:"Enter variable list name",size:"large"},null,8,["value"])]),_:1}),i(W,{label:"Category",class:"form-item"},{default:r(()=>[i(w,{value:s.value.category,"onUpdate:value":o[1]||(o[1]=Y=>s.value.category=Y),size:"large",disabled:!!b.value,onChange:g},{default:r(()=>[i(q,{value:"simple"},{default:r(()=>o[4]||(o[4]=[f("Simple List")])),_:1,__:[4]}),i(q,{value:"attributed"},{default:r(()=>o[5]||(o[5]=[f("Attributed List")])),_:1,__:[5]}),i(q,{value:"refusal"},{default:r(()=>o[6]||(o[6]=[f("Refusal List")])),_:1,__:[6]})]),_:1},8,["value","disabled"])]),_:1})]),i(W,{label:"Description",class:"form-item full-width"},{default:r(()=>[i(y,{value:s.value.description,"onUpdate:value":o[2]||(o[2]=Y=>s.value.description=Y),placeholder:"Optional description",rows:2,size:"large"},null,8,["value"])]),_:1})]),a("div",pt,[a("div",mt,[a("h3",null,k(J(s.value.category))+" Content",1)]),s.value.category==="simple"||s.value.category==="refusal"?(c(),p("div",ft,[i(Re,{values:v.value,category:s.value.category,"onUpdate:values":A},null,8,["values","category"])])):s.value.category==="attributed"?(c(),p("div",_t,[i(lt,{items:x.value,"attribute-keys":V.value,"show-example":!b.value&&x.value.length===0,"onUpdate:items":S,"onUpdate:attributeKeys":z},null,8,["items","attribute-keys","show-example"])])):K("",!0)])]),_:1},8,["model"])]))])]),_:1}),i(re,{class:"editor-footer"},{default:r(()=>[a("div",gt,[o[9]||(o[9]=a("div",{class:"footer-stats"},null,-1)),a("div",ht,[i(t,{size:"large",onClick:H},{default:r(()=>o[8]||(o[8]=[f(" Cancel ")])),_:1,__:[8]}),i(t,{size:"large",type:"primary",onClick:B,loading:M.value,disabled:!U.value},{icon:r(()=>[i(se(Ve))]),default:r(()=>[f(" "+k(b.value?"Save Changes":"Create List"),1)]),_:1},8,["loading","disabled"])])])]),_:1})]),_:1})])}}}),$t=te(bt,[["__scopeId","data-v-2ba5fd4a"]]);export{$t as default};

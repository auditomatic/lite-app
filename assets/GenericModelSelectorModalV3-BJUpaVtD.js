import{d as te,c as j,R as v,Y as a,S as f,k as O,a0 as de,F as R,_,G as A,V as y,f as X,$,Z as k,W as Y,B as he,u as Q,r as ie,w as se,o as re,X as ke}from"./vue-vendor-DPw1dQYc.js";import{u as Ce}from"./useV4Models-BcjC2QYM.js";import{u as ce}from"./useV4ProviderParameters-Br_r3Hw8.js";import{j as oe,o as be,a as S,q as $e}from"./index-DNH2rO2k.js";import{u as ye}from"./useCostEstimation-DVsIZsKM.js";import{_ as Me,ak as pe,al as me,n as le,ao as Te,z as xe,G as Pe,a4 as Oe,a2 as we,a3 as Ie,aj as De,ap as Fe,a5 as Ue,a6 as Se,H as Ae,T as Ve,a7 as Ee,J as je,x as qe,O as ze,a1 as Ne,S as Re}from"./ui-vendor-IRGmExUJ.js";const Ke={class:"model-search-filters"},Be={class:"panel-header"},Ge={class:"search-container"},Le=te({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(J,{emit:l}){const e=J,I=l,h=j({get:()=>e.modelValue,set:T=>I("update:modelValue",T)});return(T,x)=>{const c=Me;return a(),v("div",Ke,[f("div",Be,[x[2]||(x[2]=f("h3",null,"Available Models",-1)),f("div",Ge,[x[1]||(x[1]=f("span",{class:"search-label"},"Search:",-1)),O(c,{value:h.value,"onUpdate:value":x[0]||(x[0]=C=>h.value=C),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),Je=oe(Le,[["__scopeId","data-v-56bdd915"]]),We=["title"],He={key:0,class:"cost-group"},Qe={class:"cost-item"},Xe={class:"cost-value"},Ye={class:"cost-value"},Ze={key:1,class:"cost-group"},et={class:"enviro-group"},tt={key:0,class:"enviro-item"},ot={key:1,class:"cost-tab"},st={key:2,class:"enviro-item"},lt={key:3,class:"cost-tab"},nt={key:4,class:"enviro-item"},at={key:0,class:"cost-group"},ut={class:"cost-item"},it={class:"cost-value"},dt={class:"cost-value"},rt={class:"enviro-group"},ct={key:0,class:"enviro-item"},pt={key:1,class:"cost-tab"},mt={key:2,class:"enviro-item"},ft={key:3,class:"cost-tab"},vt={key:4,class:"enviro-item"},gt={key:0,class:"cost-item financial"},_t={key:0,class:"cost-value"},ht={key:1,class:"cost-value"},kt={key:1,class:"cost-item environmental"},Ct={key:0,class:"enviro-item"},bt={class:"enviro-value"},$t={key:1,class:"enviro-item"},yt={class:"enviro-value"},Mt={key:2,class:"enviro-item"},Tt={class:"enviro-value"},xt={key:3,class:"cost-unit"},Pt=te({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(J){const l=J,e=be(),I=j(()=>!0),h=j(()=>e.preferences.showCO2),T=j(()=>e.preferences.showWater),x=j(()=>e.preferences.showElectricity);function c(){if(!l.model.capabilities)return"â€”";const t=l.model.capabilities.inputCostPerToken||0,p=l.model.capabilities.outputCostPerToken||0;if(l.mode==="per-thousand"){const g=(t+p)*1e3;return C(g)}else if(l.mode==="total")if(l.inputTokens!=null&&l.outputTokens!=null){const g=t*l.inputTokens+p*l.outputTokens;return C(g)}else return"??";return"â€”"}function C(t){if(t===0)return"0.00";if(t<.01){let p=2,g=t;for(;g<.1;)g*=10,p++;return t.toFixed(p)}return t<1?t.toFixed(3):t<10?t.toFixed(2):t<100?t.toFixed(1):Math.round(t).toLocaleString()}function D(t){if(t===0)return"0.00";if(t<.01){let p=2,g=t;for(;g<.1;)g*=10,p++;return t.toFixed(p)}return t<1?t.toFixed(3):t<10?t.toFixed(2):t<100?t.toFixed(1):Math.round(t).toLocaleString()}function q(){if(!l.model.capabilities)return"0";const t=(l.model.capabilities.inputCostPerToken||0)*1e3;return D(t)}function V(){if(!l.model.capabilities)return"0";const t=(l.model.capabilities.outputCostPerToken||0)*1e3;return D(t)}function H(){if(!l.model.capabilities||l.inputTokens==null||l.minOutputTokens==null)return"??";const t=l.model.capabilities.inputCostPerToken||0,p=l.model.capabilities.outputCostPerToken||0,g=t*l.inputTokens+p*l.minOutputTokens;return D(g)}function G(){if(!l.model.capabilities||l.inputTokens==null||l.maxOutputTokens==null)return"??";const t=l.model.capabilities.inputCostPerToken||0,p=l.model.capabilities.outputCostPerToken||0,g=t*l.inputTokens+p*l.maxOutputTokens;return D(g)}function K(t){return"??"}function N(t){return"??"}const w=j(()=>{const t=[];t.push("=== ModelCostDisplayV3 Debug ==="),t.push(`Mode: ${l.mode}`),t.push(`Model: ${l.model.provider}:${l.model.modelId}`),t.push(`Layout: ${l.layout}, Size: ${l.size}`),t.push(""),t.push("=== Token Input Data ==="),l.inputTokens&&t.push(`Input Tokens: ${l.inputTokens}`),l.outputTokens&&t.push(`Output Tokens: ${l.outputTokens}`),l.minOutputTokens&&t.push(`Min Output Tokens: ${l.minOutputTokens}`),l.maxOutputTokens&&t.push(`Max Output Tokens: ${l.maxOutputTokens}`),t.push(""),t.push("=== Model Pricing Rates ===");const p=l.model.capabilities?.inputCostPerToken||0,g=l.model.capabilities?.outputCostPerToken||0;if(t.push(`Input Rate: $${p} per token ($${(p*1e3).toFixed(4)}/1K)`),t.push(`Output Rate: $${g} per token ($${(g*1e3).toFixed(4)}/1K)`),t.push(""),t.push(`=== Calculations (Mode: ${l.mode}) ===`),l.mode==="per-thousand"){const U=(p+g)*1e3;t.push(`Combined rate per 1K: ($${p} + $${g}) Ã— 1000 = $${U.toFixed(6)}`),t.push(`Display: ${c()}`)}else if(l.mode==="total"&&l.inputTokens!=null&&l.outputTokens!=null){const U=p*l.inputTokens,z=g*l.outputTokens,L=U+z;t.push(`Input cost: $${p} Ã— ${l.inputTokens} = $${U.toFixed(6)}`),t.push(`Output cost: $${g} Ã— ${l.outputTokens} = $${z.toFixed(6)}`),t.push(`Total cost: $${U.toFixed(6)} + $${z.toFixed(6)} = $${L.toFixed(6)}`),t.push(`Display: ${c()}`)}else if(l.mode==="range"&&l.inputTokens!=null&&l.minOutputTokens!=null&&l.maxOutputTokens!=null){const U=p*l.inputTokens,z=g*l.minOutputTokens,L=g*l.maxOutputTokens,Z=U+z,ee=U+L;t.push(`Input cost: $${p} Ã— ${l.inputTokens} = $${U.toFixed(6)}`),t.push(`Min output cost: $${g} Ã— ${l.minOutputTokens} = $${z.toFixed(6)}`),t.push(`Max output cost: $${g} Ã— ${l.maxOutputTokens} = $${L.toFixed(6)}`),t.push(`Min total: $${U.toFixed(6)} + $${z.toFixed(6)} = $${Z.toFixed(6)}`),t.push(`Max total: $${U.toFixed(6)} + $${L.toFixed(6)} = $${ee.toFixed(6)}`),t.push(`Display: ${H()} - ${G()}`)}else if(l.mode==="input-output"){const U=p*1e3,z=g*1e3;t.push(`Input per 1K: $${p} Ã— 1000 = $${U.toFixed(6)}`),t.push(`Output per 1K: $${g} Ã— 1000 = $${z.toFixed(6)}`),t.push(`Display: $${q()}/1K input + $${V()}/1K output`)}else t.push("No calculations available for this mode/input combination");return t.join(`
`)});function F(){const t=w.value;S.info("ðŸ” ModelCostDisplayV3 Debug Info:",{mode:l.mode,model:`${l.model.provider}:${l.model.modelId}`,inputTokens:l.inputTokens,outputTokens:l.outputTokens,minOutputTokens:l.minOutputTokens,maxOutputTokens:l.maxOutputTokens,layout:l.layout,size:l.size,inputRate:l.model.capabilities?.inputCostPerToken,outputRate:l.model.capabilities?.outputCostPerToken,calculations:t.split(`
`).filter(p=>p.includes("=")).join(" | ")})}return(t,p)=>(a(),v("div",{class:de(["model-cost-display",[`layout-${t.layout}`,`size-${t.size}`]]),title:w.value,onMouseenter:F},[t.mode==="range"?(a(),v(R,{key:0},[I.value&&t.maxOutputTokens?(a(),v("span",He,[f("span",Qe,[p[0]||(p[0]=f("span",{class:"debug-mode"},"range:",-1)),f("span",Xe,"$"+y(H()),1),p[1]||(p[1]=A(" - ")),f("span",Ye,"$"+y(G()),1)])])):I.value?(a(),v("span",Ze,p[2]||(p[2]=[f("span",{class:"cost-item"},[f("span",{class:"debug-mode"},"range:"),f("span",{class:"cost-value"},"Cost: ??")],-1)]))):_("",!0),p[3]||(p[3]=f("span",{class:"cost-tab"},null,-1)),f("span",et,[h.value?(a(),v("span",tt,"COâ‚‚ "+y(N()),1)):_("",!0),h.value&&T.value?(a(),v("span",ot)):_("",!0),T.value?(a(),v("span",st,"ðŸ’§"+y(N()),1)):_("",!0),(h.value||T.value)&&x.value?(a(),v("span",lt)):_("",!0),x.value?(a(),v("span",nt,"âš¡"+y(N()),1)):_("",!0)])],64)):t.mode==="input-output"?(a(),v(R,{key:1},[I.value?(a(),v("span",at,[f("span",ut,[p[4]||(p[4]=f("span",{class:"debug-mode"},"input-output:",-1)),f("span",it,"$"+y(q()),1),p[5]||(p[5]=A("/1K input + ")),f("span",dt,"$"+y(V()),1),p[6]||(p[6]=A("/1K output "))])])):_("",!0),p[7]||(p[7]=f("span",{class:"cost-tab"},null,-1)),f("span",rt,[h.value?(a(),v("span",ct,"COâ‚‚ "+y(K()),1)):_("",!0),h.value&&T.value?(a(),v("span",pt)):_("",!0),T.value?(a(),v("span",mt,"ðŸ’§"+y(K()),1)):_("",!0),(h.value||T.value)&&x.value?(a(),v("span",ft)):_("",!0),x.value?(a(),v("span",vt,"âš¡"+y(K()),1)):_("",!0)])],64)):(a(),v(R,{key:2},[I.value?(a(),v("div",gt,[t.mode==="per-thousand"?(a(),v("span",_t,[p[8]||(p[8]=f("span",{class:"debug-mode"},"per-thousand:",-1)),A(" "+y(c())+" ",1),p[9]||(p[9]=f("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):t.mode==="total"?(a(),v("span",ht,[p[10]||(p[10]=f("span",{class:"debug-mode"},"total:",-1)),A(" "+y(c()),1)])):_("",!0)])):_("",!0),h.value||T.value||x.value?(a(),v("div",kt,[h.value?(a(),v("span",Ct,[p[11]||(p[11]=f("span",{class:"enviro-icon"},"COâ‚‚",-1)),f("span",bt,y(K()),1)])):_("",!0),T.value?(a(),v("span",$t,[p[12]||(p[12]=f("span",{class:"enviro-icon"},"ðŸ’§",-1)),f("span",yt,y(K()),1)])):_("",!0),x.value?(a(),v("span",Mt,[p[13]||(p[13]=f("span",{class:"enviro-icon"},"âš¡",-1)),f("span",Tt,y(K()),1)])):_("",!0),t.mode==="per-thousand"?(a(),v("span",xt,"/ 1,000")):_("",!0)])):_("",!0)],64))],42,We))}}),fe=oe(Pt,[["__scopeId","data-v-9626c100"]]),Ot={class:"provider-header"},wt={class:"provider-name"},It={class:"provider-model-count"},Dt={key:0,class:"api-key-warning"},Ft={class:"provider-models"},Ut=["onClick"],St={class:"model-name"},At={key:0,class:"model-specs"},Vt=te({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(J){const l=X(void 0);function e(h){return h}function I(h){l.value===h?l.value=void 0:l.value=h}return(h,T)=>{const x=le,c=me,C=pe;return a(),$(C,{activeKey:l.value,"onUpdate:activeKey":T[0]||(T[0]=D=>l.value=D),bordered:!1,accordion:""},{default:k(()=>[(a(!0),v(R,null,Y(h.groupedModels,(D,q)=>(a(),$(c,{key:q,class:"provider-panel","data-provider":q},{header:k(()=>[f("div",Ot,[f("span",wt,y(q),1),f("span",It,y(D.length)+" models",1),h.requiresApiKey(q)&&!h.hasApiKey(h.getProviderGroup(q))?(a(),v("div",Dt,[O(Q(Te)),T[1]||(T[1]=f("span",null,"API Key Missing",-1))])):_("",!0)])]),extra:k(()=>[O(x,{size:"small",type:"text",onClick:he(V=>I(q),["stop"])},{default:k(()=>[A(y(l.value===q?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:k(()=>[f("div",Ft,[(a(!0),v(R,null,Y(D,V=>(a(),v("div",{key:V.id,class:de(["model-row",{selected:h.selectedModelId===V.id}]),onClick:H=>h.$emit("select-model",V)},[f("div",St,y(V.displayName),1),h.hasConfigPanel?_("",!0):(a(),v("div",At,[O(fe,{model:V,mode:h.mode==="trial"?"range":"input-output","input-tokens":h.getInputTokensForModel(V),"min-output-tokens":10,"max-output-tokens":h.getOutputTokensForModel(V),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,Ut))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),Et=oe(Vt,[["__scopeId","data-v-7ff59b1f"]]),jt={class:"config-panel"},qt={class:"config-header"},zt={class:"config-header-title"},Nt={key:0,class:"total-cost"},Rt={key:0,class:"cost-info"},Kt={class:"config-content"},Bt={key:0,class:"json-error"},Gt={class:"param-description"},Lt={key:0,class:"json-error"},Jt={class:"param-description"},Wt={key:0,class:"config-footer"},Ht={key:0,class:"duplicate-error"},Qt=te({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},tokenData:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(J,{emit:l}){const e=J,I=l,{getBasicParameters:h,getAdvancedParameters:T}=ce(),x=X(""),c=ie({}),C=ie({}),D=X(""),q=j(()=>e.selectedModel?h(e.selectedModel.provider,e.selectedModel.modelId):{}),V=j(()=>e.selectedModel?T(e.selectedModel.provider,e.selectedModel.modelId):{}),H=j(()=>{if(e.tokenData)return e.tokenData.totalTokens;const n=e.costEstimate?.inputTokens?.avgTokens??e.getInputTokensForModel?.(e.selectedModel);return n==null?null:n*(e.totalCalls??1)}),G=j(()=>{const n=e.getOutputTokensForModel?.(e.selectedModel);return e.costEstimate?.outputTokens&&e.tokenData?e.costEstimate.outputTokens*e.tokenData.combinationCount:n??null}),K=j(()=>{if(e.tokenData)return 10*e.tokenData.combinationCount;const n=e.totalCalls;return n==null?null:10*n}),N=j(()=>e.getOutputTokensForModel?.(e.selectedModel)??null);function w(n){if(!n)return;n.provider,n.modelId,e.mode,e.mode==="trial"&&(x.value=n.displayName),Object.keys(c).forEach(o=>delete c[o]),Object.keys(C).forEach(o=>delete C[o]);const u=h(n.provider,n.modelId),b=T(n.provider,n.modelId),i={...u,...b};if(e.initialParameters&&Object.keys(e.initialParameters).length>0){e.initialParameters,Object.assign(c,e.initialParameters);for(const[o,d]of Object.entries(e.initialParameters)){const M=i[o];d===M?.default?C[o]={mode:"default"}:C[o]={mode:"custom",value:d}}}else{for(const[o,d]of Object.entries(i))d.fixed?d.default!==void 0?(C[o]={mode:"default"},c[o]=d.default,d.default):(S.warn("PARAMDEBUG: Fixed parameter",o,"has no default value!"),C[o]={mode:"unset"},c[o]=d.type==="array"?[]:null):d.required?d.default!==void 0?(C[o]={mode:"default"},c[o]=d.default,d.default):(C[o]={mode:"custom",value:null},c[o]=d.type==="array"?[]:null):d.default!==void 0?(C[o]={mode:"default"},c[o]=d.default,d.default):(C[o]={mode:"unset"},c[o]=d.type==="array"?[]:null);for(const[o,d]of Object.entries(i))d.type==="object"&&c[o]&&(c[o+"_json"]=JSON.stringify(c[o],null,2));({...c},{...C})}}se(()=>e.selectedModel,n=>{w(n),D.value=""},{immediate:!0}),se(c,()=>{D.value=""},{deep:!0}),re(()=>{e.selectedModel&&w(e.selectedModel)});function F(n,u){const b=C[n],i=c[n];return b?.mode,u.default,!u.required&&(i==null||i==="")||b?.mode==="unset"?"Not set (parameter will be omitted)":u.default!==void 0?b?.mode==="default"?`Using default: ${u.default}`:`Default: ${u.default} (enter to override)`:u.required?"Required - enter value":"Enter value (optional)"}function t(n){const u=C[n],b=e.selectedModel?h(e.selectedModel.provider,e.selectedModel.modelId):{},i=e.selectedModel?T(e.selectedModel.provider,e.selectedModel.modelId):{},o=b[n]||i[n];if(o?.required&&u?.mode==="unset"||o?.required&&u?.mode==="custom"&&!u.value)return"error";if(u?.mode==="default")return"warning"}function p(n){return n.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase())}function g(n,u,b){if(!b&&e.selectedModel){const o=h(e.selectedModel.provider,e.selectedModel.modelId),d=T(e.selectedModel.provider,e.selectedModel.modelId);b=o[n]||d[n]}b?.required,u==null||u===""||Array.isArray(u)&&u.length===0?b?.required?b.default!==void 0&&(c[n]=b.default,C[n]={mode:"default"},b.default):(c[n]=b?.type==="array"?[]:null,C[n]={mode:"unset"}):(c[n]=u,u===b?.default?C[n]={mode:"default"}:C[n]={mode:"custom",value:u});const i=z({...c});I("parameters-changed",i)}function U(n,u,b){try{if(!u.trim()){g(n,null,b);return}const i=JSON.parse(u);g(n,i,b),delete c[n+"_json_error"]}catch{c[n+"_json_error"]="Invalid JSON format"}}function z(n){const u={...n};return Object.keys(u).filter(i=>i.includes(".")).forEach(i=>{const o=i.split(".")[0];o in u&&(u[o]===null||u[o]===void 0)&&delete u[o]}),u}function L(){const n=[],u=e.selectedModel?h(e.selectedModel.provider,e.selectedModel.modelId):{},b=e.selectedModel?T(e.selectedModel.provider,e.selectedModel.modelId):{},i={...u,...b};for(const[o,d]of Object.entries(C)){const M=i[o];M?.required&&(d.mode==="unset"?n.push(`${p(o)} is required`):d.mode==="custom"&&(d.value===null||d.value===void 0||d.value==="")&&n.push(`${p(o)} needs a value`)),d.mode==="custom"&&d.value!==void 0&&d.value!==null&&(M?.min!==void 0&&d.value<M.min&&n.push(`${p(o)} must be >= ${M.min}`),M?.max!==void 0&&d.value>M.max&&n.push(`${p(o)} must be <= ${M.max}`))}return{valid:n.length===0,errors:n}}function Z(){if(!e.selectedModel||e.mode==="trial"&&!x.value)return null;const n={},u=h(e.selectedModel.provider,e.selectedModel.modelId),b=T(e.selectedModel.provider,e.selectedModel.modelId),i={...u,...b},o=(d,M,E)=>{const P=M.split(".");let B=d;for(let W=0;W<P.length-1;W++)B[P[W]]||(B[P[W]]={}),B=B[P[W]];B[P[P.length-1]]=E};for(const[d,M]of Object.entries(C)){const E=i[d];let P;switch(M.mode){case"default":P=E?.default;break;case"custom":P=M.value;break;case"unset":continue}P!=null&&P!==""?o(n,d,P):P===!1?o(n,d,!1):E?.required&&S.error(`Required parameter ${d} has no valid value`)}return{name:e.mode==="trial"?x.value:e.selectedModel.displayName,provider:e.selectedModel.provider,modelId:e.selectedModel.modelId,parameters:n}}function ee(){D.value="";const n=L();if(!n.valid){D.value=`Invalid configuration: ${n.errors.join(", ")}`;return}const u=Z();if(u){if(e.existingConfigurations&&e.existingConfigurations.some(i=>i.provider===u.provider&&i.modelId===u.modelId&&JSON.stringify(i.parameters)===JSON.stringify(u.parameters))){D.value=`${u.provider}:${u.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}I("add-configuration",u)}}return(n,u)=>{const b=le,i=Oe,o=Pe,d=Ve,M=De,E=Fe,P=Se,B=Ue,W=Ae,ne=Ie,ae=we,ue=me,ve=pe,ge=Ee,_e=je;return a(),v("div",jt,[f("div",qt,[f("div",zt,[f("h3",null,y(n.mode==="trial"?"Configure":"Model Parameters")+": "+y(n.selectedModel.displayName),1),n.showCloseButton?(a(),$(b,{key:0,type:"text",onClick:u[0]||(u[0]=s=>n.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:k(()=>[O(Q(xe))]),_:1})):_("",!0)]),n.mode==="trial"?(a(),v("div",Nt,[O(fe,{model:n.selectedModel,mode:"range","input-tokens":H.value,"output-tokens":G.value,"min-output-tokens":K.value,"max-output-tokens":N.value,layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens","min-output-tokens","max-output-tokens"]),n.totalCalls>1?(a(),v("span",Rt,"("+y(n.totalCalls)+" calls total)",1)):_("",!0)])):_("",!0)]),f("div",Kt,[O(ge,{layout:"vertical"},{default:k(()=>[n.mode==="trial"?(a(),$(o,{key:0,label:"Configuration Name",required:""},{default:k(()=>[O(i,{value:x.value,"onUpdate:value":u[1]||(u[1]=s=>x.value=s),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):_("",!0),O(ve,{"default-active-key":["basic"],ghost:""},{default:k(()=>[O(ue,{key:"basic",header:"Basic Parameters"},{default:k(()=>[O(ae,{gutter:16},{default:k(()=>[(a(!0),v(R,null,Y(q.value,(s,r)=>(a(),$(ne,{key:r,span:n.mode==="playground"?24:12},{default:k(()=>[O(o,null,{label:k(()=>[f("span",null,y(p(r)),1),s.required?(a(),$(d,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:k(()=>u[2]||(u[2]=[A("Required")])),_:1,__:[2]})):C[r]?.mode==="default"?(a(),$(d,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:k(()=>u[3]||(u[3]=[A("Default")])),_:1,__:[3]})):C[r]?.mode==="unset"?(a(),$(d,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:k(()=>u[4]||(u[4]=[A("Not Set")])),_:1,__:[4]})):_("",!0)]),default:k(()=>[s.type==="number"?(a(),$(M,{key:0,value:c[r],"onUpdate:value":m=>c[r]=m,min:s.min,max:s.max,step:.1,placeholder:F(r,s),"allow-clear":!s.required,status:t(r),disabled:s.fixed,style:{width:"100%"},size:"large",onChange:m=>g(r,m,s)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","disabled","onChange"])):s.type==="integer"?(a(),$(M,{key:1,value:c[r],"onUpdate:value":m=>c[r]=m,min:s.min,max:s.max,placeholder:F(r,s),"allow-clear":!s.required,status:t(r),disabled:s.fixed,style:{width:"100%"},size:"large",onChange:m=>g(r,m,s)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","disabled","onChange"])):s.type==="boolean"?(a(),$(E,{key:2,checked:c[r],"onUpdate:checked":m=>c[r]=m,"checked-children":"true","un-checked-children":"false",disabled:s.fixed,onChange:m=>g(r,m,s)},null,8,["checked","onUpdate:checked","disabled","onChange"])):s.type==="string"&&s.enum?(a(),$(B,{key:3,value:c[r],"onUpdate:value":m=>c[r]=m,placeholder:s.default?`Default: ${s.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!s.required,status:t(r),disabled:s.fixed,onChange:m=>g(r,m,s)},{default:k(()=>[s.default?(a(),$(P,{key:0,value:s.default},{default:k(()=>[A(y(s.default)+" (default) ",1)]),_:2},1032,["value"])):_("",!0),s.required?_("",!0):(a(),$(P,{key:1,value:void 0},{default:k(()=>u[5]||(u[5]=[f("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(a(!0),v(R,null,Y(s.enum.filter(m=>m!==s.default),m=>(a(),$(P,{key:m,value:m},{default:k(()=>[A(y(m),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status","disabled","onChange"])):s.type==="array"?(a(),$(B,{key:4,value:c[r],"onUpdate:value":m=>c[r]=m,mode:"tags",placeholder:F(r,s),disabled:s.fixed,size:"large",style:{width:"100%"},onChange:m=>g(r,m,s)},null,8,["value","onUpdate:value","placeholder","disabled","onChange"])):s.type==="object"?(a(),v(R,{key:5},[O(W,{value:c[r+"_json"],"onUpdate:value":m=>c[r+"_json"]=m,placeholder:JSON.stringify(s.default||{},null,2),disabled:s.fixed,rows:3,status:c[r+"_json_error"]?"error":"",onInput:m=>U(r,m.target.value,s)},null,8,["value","onUpdate:value","placeholder","disabled","status","onInput"]),c[r+"_json_error"]?(a(),v("div",Bt,y(c[r+"_json_error"]),1)):_("",!0)],64)):s.type==="string"?(a(),$(i,{key:6,value:c[r],"onUpdate:value":m=>c[r]=m,placeholder:F(r,s),"allow-clear":!s.required,status:t(r),disabled:s.fixed,size:"large"},null,8,["value","onUpdate:value","placeholder","allow-clear","status","disabled"])):_("",!0),f("div",Gt,y(s.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(V.value).length>0?(a(),$(ue,{key:"advanced",header:"Advanced Parameters"},{default:k(()=>[O(ae,{gutter:16},{default:k(()=>[(a(!0),v(R,null,Y(V.value,(s,r)=>(a(),$(ne,{key:r,span:n.mode==="playground"?24:12},{default:k(()=>[O(o,null,{label:k(()=>[f("span",null,y(p(r)),1),s.required?(a(),$(d,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:k(()=>u[6]||(u[6]=[A("Required")])),_:1,__:[6]})):C[r]?.mode==="default"?(a(),$(d,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:k(()=>u[7]||(u[7]=[A("Default")])),_:1,__:[7]})):C[r]?.mode==="unset"?(a(),$(d,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:k(()=>u[8]||(u[8]=[A("Not Set")])),_:1,__:[8]})):_("",!0)]),default:k(()=>[s.type==="number"||s.type==="integer"?(a(),$(M,{key:0,value:c[r],"onUpdate:value":m=>c[r]=m,min:s.min,max:s.max,step:s.type==="number"?.1:1,placeholder:F(r,s),"allow-clear":!s.required,status:t(r),disabled:s.fixed,style:{width:"100%"},size:"large",onChange:m=>g(r,m,s)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","disabled","onChange"])):s.type==="boolean"?(a(),$(E,{key:1,checked:c[r],"onUpdate:checked":m=>c[r]=m,"checked-children":"true","un-checked-children":"false",disabled:s.fixed,onChange:m=>g(r,m,s)},null,8,["checked","onUpdate:checked","disabled","onChange"])):s.type==="string"&&s.enum?(a(),$(B,{key:2,value:c[r],"onUpdate:value":m=>c[r]=m,placeholder:s.default?`Default: ${s.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!s.required,status:t(r),disabled:s.fixed,onChange:m=>g(r,m,s)},{default:k(()=>[s.default?(a(),$(P,{key:0,value:s.default},{default:k(()=>[A(y(s.default)+" (default) ",1)]),_:2},1032,["value"])):_("",!0),s.required?_("",!0):(a(),$(P,{key:1,value:void 0},{default:k(()=>u[9]||(u[9]=[f("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(a(!0),v(R,null,Y(s.enum.filter(m=>m!==s.default),m=>(a(),$(P,{key:m,value:m},{default:k(()=>[A(y(m),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status","disabled","onChange"])):s.type==="array"?(a(),$(B,{key:3,value:c[r],"onUpdate:value":m=>c[r]=m,mode:"tags",placeholder:F(r,s),disabled:s.fixed,size:"large",style:{width:"100%"},onChange:m=>g(r,m,s)},null,8,["value","onUpdate:value","placeholder","disabled","onChange"])):s.type==="object"?(a(),v(R,{key:4},[O(W,{value:c[r+"_json"],"onUpdate:value":m=>c[r+"_json"]=m,placeholder:JSON.stringify(s.default||{},null,2),disabled:s.fixed,rows:3,status:c[r+"_json_error"]?"error":"",onInput:m=>U(r,m.target.value,s)},null,8,["value","onUpdate:value","placeholder","disabled","status","onInput"]),c[r+"_json_error"]?(a(),v("div",Lt,y(c[r+"_json_error"]),1)):_("",!0)],64)):s.type==="string"?(a(),$(i,{key:5,value:c[r],"onUpdate:value":m=>c[r]=m,placeholder:F(r,s),"allow-clear":!s.required,status:t(r),disabled:s.fixed,size:"large"},null,8,["value","onUpdate:value","placeholder","allow-clear","status","disabled"])):_("",!0),f("div",Jt,y(s.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})]),n.mode==="trial"?(a(),v("div",Wt,[D.value?(a(),v("div",Ht,[O(_e,{message:D.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):_("",!0),O(b,{type:"primary",size:"large",onClick:ee,disabled:!x.value||!n.selectedModel},{default:k(()=>u[10]||(u[10]=[A(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):_("",!0)])}}}),Xt=oe(Qt,[["__scopeId","data-v-be7d1daf"]]),Yt={class:"modal-content-wrapper"},Zt={key:0,class:"loading-container"},eo={key:1,class:"no-models-container"},to={class:"no-models-content"},oo={key:2,class:"modal-content"},so={class:"models-panel"},lo={class:"models-list"},no=te({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(J,{emit:l}){const e=J,I=l,h=ke(),{enabledModels:T,loading:x}=Ce(),{requiresApiKey:c,getProviderGroup:C,getUIDefaults:D}=ce(),{hasApiKey:q}=$e(),{estimateCost:V,estimateTotalCost:H}=ye(),G=j(()=>T.value||[]),K=j(()=>{const i=G.value.length>0;return x.value&&!i}),N=X(""),w=X(null),F=X(null),t=X({}),p=j(()=>{if(!G.value)return{};let i=G.value;if(N.value){const d=N.value.toLowerCase();i=i.filter(M=>M.displayName.toLowerCase().includes(d)||M.modelId.toLowerCase().includes(d))}const o={};for(const d of i)o[d.provider]||(o[d.provider]=[]),o[d.provider].push(d);for(const d in o)o[d].sort((M,E)=>M.displayName.localeCompare(E.displayName));return o}),g=j(()=>{if(e.mode!=="trial")return 1;if(e.trialContext)return e.trialContext.totalCombinations;if(e.design){let i=1;for(const o of Object.values(e.design.variableBindings))o.type==="direct"&&(i*=o.values?.length||1);return i}return 1});se([w,t],async()=>{if(!w.value||e.mode!=="trial"){F.value=null;return}if(!e.trialContext&&!e.design){F.value=null;return}try{const i=Object.keys(t.value).length>0?t.value:D(w.value.provider,w.value.modelId);if(e.mode==="trial"&&e.trialContext?.tokenData){const o=H(e.trialContext.tokenData.totalTokens,e.trialContext.tokenData.combinationCount,w.value,i);o.meta.hasValidCost&&o.cost.total.expected>0?F.value={inputTokens:{avgTokens:e.trialContext.tokenData.perCallAverage},outputTokens:o.tokens.output.expected,totalCost:o.cost.total.expected,inputCost:o.cost.input,outputCost:o.cost.output.expected,costRange:{min:o.cost.total.min,max:o.cost.total.max,expected:o.cost.total.expected}}:F.value=null}else{const o=u(w.value);if(o===null){F.value=null;return}const d=V(o,w.value,i);d.meta.hasValidCost&&d.cost.total.expected>0?F.value={inputTokens:{avgTokens:o},outputTokens:d.tokens.output.expected,totalCost:d.cost.total.expected,inputCost:d.cost.input,outputCost:d.cost.output.expected,costRange:{min:d.cost.total.min,max:d.cost.total.max,expected:d.cost.total.expected}}:F.value=null}}catch(i){S.error("Failed to calculate cost estimate:",i),F.value=null}},{deep:!0});function U(){I("update:visible",!1),h.push("/models")}function z(i){if(w.value=i,e.mode==="trial"&&(t.value={}),e.mode==="playground"){I("select-model",i),I("update:visible",!1);return}}function L(i){S.debug("GenericModelSelectorModalV3: Parameters changed",i),t.value={...i}}function Z(i){S.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:i,mode:e.mode}),e.mode==="single"?(I("confirm",{model:w.value,configuration:i}),I("update:visible",!1)):I("add-configuration",i)}function ee(i){I("select-model",i),I("update:visible",!1)}function n(){w.value=null}function u(i){return e.mode==="trial"?e.trialContext&&e.trialContext.tokenData?e.trialContext.tokenData.totalTokens:e.design?.tokenEstimate?.avgTokens?e.design.tokenEstimate.avgTokens*g.value:null:1e3}function b(i){if(e.mode==="trial"){const o=Object.keys(t.value).length>0?t.value:D(i.provider,i.modelId),d=["max_tokens","max_completion_tokens","max_output_tokens","num_predict","maxTokens"];let M=null;for(const E of d)if(o[E]!==void 0&&o[E]!==null&&o[E]>0){M=o[E];break}return M===null?null:e.trialContext?.tokenData?M*e.trialContext.tokenData.combinationCount:M*g.value}return 1e3}return se(()=>e.visible,i=>{i&&(w.value=null,N.value="",t.value={},S.debug("GenericModelSelectorModalV3 opened - reset selection"))}),re(()=>{S.debug("GenericModelSelectorModalV3 mounted",{mode:e.mode,visible:e.visible})}),(i,o)=>{const d=ze,M=le,E=qe;return a(),$(E,{open:i.visible,onCancel:o[1]||(o[1]=P=>i.$emit("update:visible",!1)),title:i.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:k(()=>[f("div",Yt,[K.value?(a(),v("div",Zt,[O(d,{size:"large",tip:"Loading models..."})])):G.value.length===0?(a(),v("div",eo,[f("div",to,[O(Q(Ne),{class:"no-models-icon"}),o[3]||(o[3]=f("h3",null,"No Models Available",-1)),o[4]||(o[4]=f("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),O(M,{type:"primary",size:"large",onClick:U},{default:k(()=>[O(Q(Re)),o[2]||(o[2]=A(" Go to Models View "))]),_:1,__:[2]})])])):(a(),v("div",oo,[f("div",so,[O(Je,{modelValue:N.value,"onUpdate:modelValue":o[0]||(o[0]=P=>N.value=P)},null,8,["modelValue"]),f("div",lo,[O(Et,{"grouped-models":p.value,"selected-model-id":w.value?.id,mode:i.mode,"get-input-tokens-for-model":u,"get-output-tokens-for-model":b,"has-config-panel":!!w.value,"requires-api-key":Q(c),"get-provider-group":Q(C),"has-api-key":Q(q),onSelectModel:z},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),w.value&&i.mode==="trial"?(a(),$(Xt,{key:0,"selected-model":w.value,mode:i.mode,"total-calls":g.value,"cost-estimate":F.value,"token-data":i.trialContext?.tokenData,"get-input-tokens-for-model":u,"get-output-tokens-for-model":b,"existing-configurations":i.existingConfigurations,onClose:n,onAddConfiguration:Z,onConfirmSelection:ee,onParametersChanged:L},null,8,["selected-model","mode","total-calls","cost-estimate","token-data","existing-configurations"])):_("",!0)]))])]),_:1},8,["open","title"])}}}),mo=oe(no,[["__scopeId","data-v-11663c6f"]]);export{mo as G,fe as M};

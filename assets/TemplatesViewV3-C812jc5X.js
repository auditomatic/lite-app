import{u as ie,a as Q,e as te}from"./index-BRQLqOf1.js";import{d as ae,c as S,f as h,o as se,w as re,$ as K,a0 as o,a1 as m,_ as p,W as d,k as a,G as v,a2 as N,X as y,V as b,Y as le,F as ne,l as J,u as V,Z as de}from"./vue-vendor-BZxY9vkr.js";import{u as ce}from"./useV4Templates-zgRUXbhZ.js";import{u as ue}from"./useV4TemplateCommands-B-5AHBKo.js";import{a as me}from"./useV4VariableLists-DVOBW9Fj.js";import{k as w,m as pe,P as fe,n as ve,E as ge,o as _e,C as ye,p as be,q as he,M as ke}from"./ui-vendor-DgwC-sRC.js";import"./utils-vendor-X1Ah6TN4.js";import"./data-vendor-CllpzWXw.js";import"./useV4LiveQuery-CfOiSnL_.js";const we={class:"import-defaults-content"},Ce={class:"section-header"},Te={class:"item-content"},xe={class:"item-header"},Ie={class:"item-description"},De={class:"item-meta"},Ve={class:"section-header"},Le={class:"item-content"},$e={class:"item-header"},Se={class:"item-description"},Ee={class:"item-meta"},Oe={class:"modal-footer"},Ae=ae({__name:"ImportDefaultsModalV3",props:{open:{type:Boolean}},emits:["update:open","imported"],setup(ee,{emit:E}){const B=ee,F=E,L=ie(),z=S({get:()=>B.open,set:i=>F("update:open",i)}),M=h("designs"),P=h(!1),U=h(!1),C=S(()=>{const i=L.templates.templates.value;return new Set(i.map(s=>s.name))}),$=S(()=>{const i=L.variableLists.value;return new Set(i.map(s=>s.name))}),T=h({}),k=h({}),q=h(!1),R=h(!1),O=h([{id:"default-1",name:"Simple Question",description:"A basic question-answering template",template:"Answer this question: {{question}}",variables:{question:{type:"value",placeholder:"Enter your question"}},category:"General",tags:["question","simple"],isDefault:!0},{id:"default-2",name:"Code Review",description:"Review code with language context",template:`Review this {{language}} code and provide feedback:

{{code}}`,variables:{language:{type:"list",listId:"default-list-1"},code:{type:"value",placeholder:"Paste your code here"}},category:"Development",tags:["code","review","development"],isDefault:!0},{id:"default-3",name:"Sentiment Analysis",description:"Analyze sentiment of text",template:'Analyze the sentiment of the following {{textType}}: "{{text}}". Is it positive, negative, or neutral?',variables:{textType:{type:"list",listId:"default-list-3"},text:{type:"value",placeholder:"Enter text to analyze"}},category:"Analysis",tags:["sentiment","analysis"],isDefault:!0},{id:"default-4",name:"Translation Request",description:"Translate text between languages",template:'Translate the following text from {{sourceLanguage}} to {{targetLanguage}}: "{{text}}"',variables:{sourceLanguage:{type:"list",listId:"default-list-1"},targetLanguage:{type:"list",listId:"default-list-1"},text:{type:"value",placeholder:"Text to translate"}},category:"Translation",tags:["translation","language"],isDefault:!0}]),I=h([{id:"default-list-1",name:"Common Programming Languages",description:"Popular programming languages",category:"simple",values:["JavaScript","Python","TypeScript","Java","C++","Go","Rust","Ruby"],itemCount:8},{id:"default-list-2",name:"Sentiment Types",description:"Common sentiment classifications",category:"simple",values:["positive","negative","neutral","mixed"],itemCount:4},{id:"default-list-3",name:"Text Types",description:"Different types of text content",category:"simple",values:["review","comment","article","tweet","email","message"],itemCount:6},{id:"default-list-4",name:"Refusal Phrases",description:"Common refusal indicators",category:"refusal",values:["I can't","I cannot","I'm unable","I won't","not possible","against my programming"],itemCount:6}]),W=S(()=>{const i=Object.values(T.value).some(t=>t),s=Object.values(k.value).some(t=>t);return i||s});se(()=>{G()}),re(()=>B.open,i=>{i&&G()});function G(){T.value={},k.value={},O.value.forEach(i=>{T.value[i.id]=!1}),I.value.forEach(i=>{k.value[i.id]=!1})}function X(){O.value.forEach(i=>{C.value.has(i.name)||(T.value[i.id]=q.value)})}function Y(){I.value.forEach(i=>{$.value.has(i.name)||(k.value[i.id]=R.value)})}async function Z(){U.value=!0;try{const i=Object.entries(k.value).filter(([e,l])=>l).map(([e])=>e);for(const e of i){const l=I.value.find(r=>r.id===e);if(l){const r=await L.createVariableList(l.name,l.category,l.values,l.description);r.ok||Q.error(`Failed to import list ${l.name}:`,r.error)}}const s=Object.entries(T.value).filter(([e,l])=>l).map(([e])=>e);for(const e of s){const l=O.value.find(r=>r.id===e);if(l){const r={};for(const[f,x]of Object.entries(l.variables)){const g=x;if(g.type==="list"&&g.listId){const A=I.value.find(n=>n.id===g.listId);if(A){const n=L.variableLists.value.find(c=>c.name===A.name);n?r[f]={type:"list",listId:n.id}:r[f]=g}else r[f]=g}else r[f]=g}await L.templates.createTemplate({name:l.name,description:l.description,template:l.template,variables:r,category:l.category,tags:l.tags})||Q.error(`Failed to import template ${l.name}`)}}const t=s.length+i.length;t>0?w.success(`Successfully imported ${t} items`):w.info("No new items were imported"),F("imported"),j()}catch(i){Q.error("Import failed:",i),w.error("Failed to import selected items")}finally{U.value=!1}}function j(){z.value=!1}function H(i){switch(i){case"attributed":return"blue";case"refusal":return"red";default:return"green"}}return(i,s)=>{const t=m("a-alert"),e=m("a-checkbox"),l=m("a-tag"),r=m("a-list-item"),u=m("a-list"),f=m("a-tab-pane"),x=m("a-tabs"),g=m("a-button"),A=m("a-modal");return p(),K(A,{open:z.value,"onUpdate:open":s[3]||(s[3]=n=>z.value=n),title:"Import Default Designs & Variables",width:"95vw",footer:null,onCancel:j,centered:!0,"body-style":{height:"90vh",overflow:"auto"},"data-testid":"modal-import-defaults"},{default:o(()=>[d("div",we,[a(t,{type:"info",message:"Import pre-configured designs and variable lists",description:"Select which default designs and variable lists you want to import. These are carefully crafted templates for common LLM bias testing scenarios.","show-icon":!0,style:{marginBottom:"var(--spacing-xl)"}}),a(x,{activeKey:M.value,"onUpdate:activeKey":s[2]||(s[2]=n=>M.value=n)},{default:o(()=>[a(f,{key:"designs",tab:"Designs"},{default:o(()=>[d("div",Ce,[s[5]||(s[5]=d("h4",null,"Available Designs",-1)),a(e,{checked:q.value,"onUpdate:checked":s[0]||(s[0]=n=>q.value=n),onChange:X,"data-testid":"checkbox-select-all-designs","aria-label":"Select all designs for import"},{default:o(()=>s[4]||(s[4]=[v(" Select All ")])),_:1,__:[4]},8,["checked"])]),a(u,{"data-source":O.value,loading:P.value,size:"small",class:"import-list"},{renderItem:o(({item:n})=>[a(r,null,{default:o(()=>[a(e,{checked:T.value[n.id],"onUpdate:checked":c=>T.value[n.id]=c,disabled:C.value.has(n.name)},{default:o(()=>[d("div",Te,[d("div",xe,[d("strong",null,y(n.name),1),C.value.has(n.name)?(p(),K(l,{key:0,size:"small",color:"orange"},{default:o(()=>s[6]||(s[6]=[v(" Already Exists ")])),_:1,__:[6]})):N("",!0)]),d("div",Ie,y(n.description),1),d("div",De,[(p(!0),b(ne,null,le(Object.keys(n.variables),c=>(p(),K(l,{key:c,size:"small"},{default:o(()=>[v(y(c),1)]),_:2},1024))),128))])])]),_:2},1032,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1}),a(f,{key:"variables",tab:"Variable Lists"},{default:o(()=>[d("div",Ve,[s[8]||(s[8]=d("h4",null,"Available Variable Lists",-1)),a(e,{checked:R.value,"onUpdate:checked":s[1]||(s[1]=n=>R.value=n),onChange:Y,"data-testid":"checkbox-select-all-variables","aria-label":"Select all variable lists for import"},{default:o(()=>s[7]||(s[7]=[v(" Select All ")])),_:1,__:[7]},8,["checked"])]),a(u,{"data-source":I.value,loading:P.value,size:"small",class:"import-list"},{renderItem:o(({item:n})=>[a(r,null,{default:o(()=>[a(e,{checked:k.value[n.id],"onUpdate:checked":c=>k.value[n.id]=c,disabled:$.value.has(n.name)},{default:o(()=>[d("div",Le,[d("div",$e,[d("strong",null,y(n.name),1),a(l,{size:"small",color:H(n.category)},{default:o(()=>[v(y(n.category),1)]),_:2},1032,["color"]),$.value.has(n.name)?(p(),K(l,{key:0,size:"small",color:"orange"},{default:o(()=>s[9]||(s[9]=[v(" Already Exists ")])),_:1,__:[9]})):N("",!0)]),d("div",Se,y(n.description),1),d("div",Ee,y(n.itemCount)+" items ",1)])]),_:2},1032,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1})]),_:1},8,["activeKey"]),d("div",Oe,[a(g,{onClick:j,size:"large",class:"footer-button","data-testid":"btn-cancel-import-defaults","aria-label":"Cancel import"},{default:o(()=>s[10]||(s[10]=[v(" Cancel ")])),_:1,__:[10]}),a(g,{type:"primary",onClick:Z,loading:U.value,disabled:!W.value,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-confirm-import-defaults","aria-label":"Import selected designs and variables"},{default:o(()=>s[11]||(s[11]=[v(" Import Selected ")])),_:1,__:[11]},8,["loading","disabled"])])])]),_:1},8,["open"])}}}),ze=te(Ae,[["__scopeId","data-v-b232c143"]]),Ue={class:"templates-view"},qe={class:"view-header"},Re={class:"header-actions"},je={key:0,class:"name-cell"},Ne={class:"template-name"},Be={key:0,class:"template-description"},Fe={key:1,class:"variables-cell"},Me={key:0,class:"no-variables"},Pe={key:1,class:"variable-calculation"},Ge={class:"variable-name"},Ke={class:"variable-count"},Je={key:0,class:"operator"},Qe={class:"total-combinations"},We={key:2,class:"token-estimate"},Xe={class:"token-count"},Ye={key:3,class:"actions-cell"},Ze=ae({__name:"TemplatesViewV3",setup(ee){const E=de(),{templates:B,loading:F}=ce(),{variableLists:L}=me(),{duplicateTemplate:z,deleteTemplate:M,exportTemplates:P,isExecuting:U}=ue(),C=h(""),$=h(!1),T=S(()=>F.value||U.value),k=S(()=>B.value),q=S(()=>{if(!C.value.trim())return k.value;const t=C.value.toLowerCase();return k.value.filter(e=>{var l;return e.name.toLowerCase().includes(t)||((l=e.description)==null?void 0:l.toLowerCase().includes(t))||e.tags.some(r=>r.toLowerCase().includes(t))})}),R=[{title:"Name",key:"name",dataIndex:"name",sorter:(t,e)=>t.name.localeCompare(e.name),width:250,ellipsis:!1},{title:"Variables",key:"variables",width:280},{title:"Tokens",key:"tokens",width:80,align:"center"},{title:"Created",key:"created",dataIndex:"created",sorter:(t,e)=>new Date(t.created).getTime()-new Date(e.created).getTime(),customRender:({value:t})=>new Date(t).toLocaleDateString(),width:100,align:"center"},{title:"Actions",key:"actions",width:90,align:"center"}];function O(t){return Object.keys(t.variables||{}).length}function I(t){const e=[],l=L.value;for(const[r,u]of Object.entries(t.variables||{})){let f=0;if(u.type==="list"&&u.listId){const x=l.find(g=>g.id===u.listId);f=(x==null?void 0:x.itemCount)||0}else u.values&&(f=u.values.length);e.push({name:r,count:f})}return e}function W(t){return Math.ceil(t.template.length/4)}function G(){E.push({name:"template-create"})}function X(t){E.push({name:"template-edit",params:{id:t.id}})}async function Y(t){const e=await z(t.id);e.ok?(w.success("Template duplicated successfully"),E.push({name:"template-edit",params:{id:e.value}})):w.error(`Failed to duplicate template: ${e.error.message}`)}async function Z(t){ke.confirm({title:"Delete Template",content:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{const e=await M(t.id);e.ok?w.success("Template deleted successfully"):w.error(`Failed to delete template: ${e.error.message}`)}})}async function j(t){const e=await P([t.id]);if(e.ok){const l=new Blob([e.value],{type:"application/json"}),r=URL.createObjectURL(l),u=document.createElement("a");u.href=r,u.download=`${t.name.replace(/[^a-z0-9]/gi,"_")}_template.json`,u.click(),URL.revokeObjectURL(r),w.success("Template exported successfully")}else w.error(`Failed to export template: ${e.error.message}`)}function H(t){E.push({name:"trial-create",query:{designId:t.id,promptSource:"template"}})}function i(t){C.value=t}function s(){w.success("Default templates imported successfully")}return se(()=>{Q.info("TemplatesViewV3 mounted with V4 real-time queries")}),(t,e)=>{const l=m("a-input-search"),r=m("a-button"),u=m("a-tooltip"),f=m("a-menu-item"),x=m("a-menu-divider"),g=m("a-menu"),A=m("a-dropdown"),n=m("a-table");return p(),b("div",Ue,[d("div",qe,[e[5]||(e[5]=d("h1",null,"Template Prompts",-1)),d("div",Re,[a(l,{value:C.value,"onUpdate:value":e[0]||(e[0]=c=>C.value=c),placeholder:"Search templates...",class:"search-input",style:{width:"300px"},onSearch:i},null,8,["value"]),a(r,{type:"default",onClick:e[1]||(e[1]=c=>$.value=!0),icon:J(V(pe))},{default:o(()=>e[3]||(e[3]=[v(" Import Defaults ")])),_:1,__:[3]},8,["icon"]),a(r,{type:"primary",onClick:G,icon:J(V(fe))},{default:o(()=>e[4]||(e[4]=[v(" New Template ")])),_:1,__:[4]},8,["icon"])])]),a(n,{columns:R,"data-source":q.value,loading:T.value,pagination:!1,scroll:{x:800,y:"calc(100vh - 280px)"},"row-key":c=>c.id,class:"templates-table"},{bodyCell:o(({column:c,record:_})=>[c.key==="name"?(p(),b("div",je,[d("div",Ne,y(_.name),1),_.description?(p(),b("div",Be,y(_.description),1)):N("",!0)])):c.key==="variables"?(p(),b("div",Fe,[O(_)===0?(p(),b("span",Me," No variables ")):(p(),b("div",Pe,[(p(!0),b(ne,null,le(I(_),(D,oe)=>(p(),b("span",{key:D.name,class:"variable-part"},[d("span",Ge,y(D.name),1),d("span",Ke,"("+y(D.count)+")",1),oe<I(_).length-1?(p(),b("span",Je,"Ã—")):N("",!0)]))),128)),e[6]||(e[6]=d("span",{class:"equals"},"=",-1)),d("span",Qe,y(_.combinationCount||0)+" cases",1)]))])):c.key==="tokens"?(p(),b("div",We,[a(u,{title:"Estimated tokens per prompt"},{default:o(()=>[d("span",Xe,"~"+y(W(_)),1)]),_:2},1024)])):c.key==="actions"?(p(),b("div",Ye,[a(u,{title:"Edit"},{default:o(()=>[a(r,{type:"link",size:"small",onClick:D=>X(_),icon:J(V(ve))},null,8,["onClick","icon"])]),_:2},1024),a(u,{title:"New Trial"},{default:o(()=>[a(r,{type:"link",size:"small",onClick:D=>H(_),icon:J(V(ge))},null,8,["onClick","icon"])]),_:2},1024),a(A,null,{overlay:o(()=>[a(g,null,{default:o(()=>[a(f,{onClick:D=>Y(_)},{default:o(()=>[a(V(ye)),e[7]||(e[7]=v(" Duplicate "))]),_:2,__:[7]},1032,["onClick"]),a(f,{onClick:D=>j(_)},{default:o(()=>[a(V(be)),e[8]||(e[8]=v(" Export "))]),_:2,__:[8]},1032,["onClick"]),a(x),a(f,{onClick:D=>Z(_),class:"danger-item"},{default:o(()=>[a(V(he)),e[9]||(e[9]=v(" Delete "))]),_:2,__:[9]},1032,["onClick"])]),_:2},1024)]),default:o(()=>[a(r,{type:"link",size:"small"},{default:o(()=>[e[10]||(e[10]=v(" More ")),a(V(_e))]),_:1,__:[10]})]),_:2},1024)])):N("",!0)]),_:1},8,["data-source","loading","row-key"]),a(ze,{open:$.value,"onUpdate:open":e[2]||(e[2]=c=>$.value=c),onImported:s},null,8,["open"])])}}}),rt=te(Ze,[["__scopeId","data-v-4c459eba"]]);export{rt as default};

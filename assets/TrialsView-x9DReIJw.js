const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./APICallDetailModal-BGCLw6Ck.js","./vendor-DCf9YP3r.js","./designs-db-BcjIu_Fz.js","./db-CL8uhZCz.js","./index-HyoKRhI9.js","./index-izHpNa_W.css","./defaultData-DyqJdH2z.js","./variables-db-B4ebURAw.js","./logger.service-_k__GSpu.js","./registry-dHxpV8ha.js","./models-db-DCJIrR1U.js","./trials-db-w-1bpsX0.js","./mock-provider.service-BAPeV6CB.js","./settings-db-CbXALxZS.js","./ModelSelectionTable-B7DR3Hn0.js","./cost-formatting-D-OPWEvg.js","./ModelSelectionTable-B2A5b4Ts.css","./BaseModal.vue_vue_type_style_index_0_lang-Br6W_Dvv.js","./BaseModal-DbTyIa7L.css","./APICallDetailModal-BL_o4xQR.css"])))=>i.map(i=>d[i]);
import{h as e,_ as a,P as t,E as l,f as s,e as i,i as n,g as o}from"./index-HyoKRhI9.js";import{d as r,f as d,r as u,c,S as p,W as v,U as m,X as f,Y as g,a3 as y,a7 as h,k,u as b,a5 as _,F as C,ab as x,_ as w,B as T,G as I,o as P,b as S,w as $,a8 as E,q as z,ae as j,a4 as M,a9 as D,V as F,Z as L}from"./vendor-DCf9YP3r.js";import{u as N}from"./trials-db-w-1bpsX0.js";import{u as A}from"./settings-db-CbXALxZS.js";import{A as U,T as O,_ as R,a as q}from"./APICallDetailModal-BGCLw6Ck.js";import{u as B}from"./designs-db-BcjIu_Fz.js";import{u as V}from"./variables-db-B4ebURAw.js";import{u as K}from"./models-db-DCJIrR1U.js";import{p as J}from"./registry-dHxpV8ha.js";import{l as Y}from"./db-CL8uhZCz.js";import{u as W}from"./BaseModal.vue_vue_type_style_index_0_lang-Br6W_Dvv.js";import"./defaultData-DyqJdH2z.js";import"./mock-provider.service-BAPeV6CB.js";import"./logger.service-_k__GSpu.js";import"./ModelSelectionTable-B7DR3Hn0.js";import"./cost-formatting-D-OPWEvg.js";const H={class:"modal-content"},G={class:"models-panel"},Q={class:"panel-header"},X={class:"models-list"},Z={class:"provider-header"},ee={class:"provider-name"},ae={class:"provider-count"},te={class:"provider-models"},le=["onClick"],se={class:"model-info"},ie={class:"model-name"},ne={class:"model-cost"},oe={class:"cost-primary"},re={key:0,class:"config-panel"},de={class:"config-header"},ue={class:"total-cost"},ce={class:"config-content"},pe={key:0,class:"params-section"},ve={class:"param-description"},me={class:"config-footer"},fe=a(r({__name:"ModelSelectorModal",props:{design:{},existingConfigurations:{}},emits:["close","add-configuration"],setup(a,{emit:t}){const l=a,s=t,i=K(),n=d(""),o=d([]),r=d(null),P=d(""),S=u({}),$=c(()=>{let e=i.enabledModels;if(n.value){const a=n.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(a)||e.modelId.toLowerCase().includes(a))}const a={};for(const t of e)a[t.provider]||(a[t.provider]=[]),a[t.provider].push(t);for(const t in a)a[t].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a}),E=c(()=>{let e=1;for(const a of Object.values(l.design.variableBindings))"direct"===a.type?e*=a.values?.length||1:a.listId&&(e*=10);return e}),z=c(()=>{if(!r.value)return{};const e=J.getParametersForModel(r.value.provider,r.value.modelId),a={},t=(e,l="")=>{Object.entries(e).forEach(([e,s])=>{const i=l?`${l}.${e}`:e;"object"===s.type&&s.properties?t(s.properties,i):a[i]=s})};t(e);const l={};for(const[n,o]of Object.entries(a))o.basic&&(l[n]=o);const s={},i=l.temperature?"temperature":l["options.temperature"]?"options.temperature":null;i&&(s[i]=l[i]);for(const[n,o]of Object.entries(l))n!==i&&(s[n]=o);return s}),j=c(()=>{if(!r.value)return{};if(!J.getProvider(r.value.provider))return{};const e=J.getParametersForModel(r.value.provider,r.value.modelId),a={};for(const[t,l]of Object.entries(e))"temperature"===t||"max_tokens"===t||"max_completion_tokens"===t||l.basic||"number"!==l.type||(a[t]={...l,label:t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())});return a});function M(e){if(!e.capabilities)return 0;const a=l.design.tokenEstimate?.avgTokens||150,t=S.max_tokens||S.max_completion_tokens||256;return((e.capabilities.inputCostPerToken||0)*a+(e.capabilities.outputCostPerToken||0)*t)*E.value}function D(){if(!r.value)return 0;const e=l.design.tokenEstimate?.avgTokens||150,a=S.max_tokens||S.max_completion_tokens||256;return(r.value.capabilities?.inputCostPerToken||0)*e+(r.value.capabilities?.outputCostPerToken||0)*a}function F(){if(!r.value||!P.value)return;const e=Object.entries(S).reduce((e,[a,t])=>(null!=t&&""!==t&&(e[a]=t),e),{});s("add-configuration",{name:P.value,provider:r.value.provider,modelId:r.value.modelId,parameters:e})}return(a,t)=>{const l=m("a-input"),s=m("a-button"),d=m("a-collapse-panel"),u=m("a-collapse"),c=m("a-form-item"),L=m("a-input-number"),N=m("a-select-option"),A=m("a-select"),U=m("a-col"),O=m("a-row"),R=m("a-form"),q=m("a-modal");return v(),p(q,{open:!0,title:null,width:"95vw",style:{top:"2.5vh",maxWidth:"1400px"},bodyStyle:{height:"90vh",padding:"0",display:"flex",flexDirection:"column"},footer:null,onCancel:t[4]||(t[4]=e=>a.$emit("close"))},{default:f(()=>[t[11]||(t[11]=g("div",{class:"modal-header"},[g("h2",null,"Select and Configure Model")],-1)),g("div",H,[g("div",G,[g("div",Q,[t[5]||(t[5]=g("h3",null,"Available Models",-1)),k(l,{value:n.value,"onUpdate:value":t[0]||(t[0]=e=>n.value=e),placeholder:"Search models...",size:"large",allowClear:""},{prefix:f(()=>[k(b(e))]),_:1},8,["value"])]),g("div",X,[k(u,{activeKey:o.value,"onUpdate:activeKey":t[2]||(t[2]=e=>o.value=e),ghost:""},{default:f(()=>[(v(!0),y(C,null,_($.value,(e,a)=>(v(),p(d,{key:a},{header:f(()=>[g("div",Z,[g("span",ee,w(a),1),g("span",ae,"("+w(e.length)+" models)",1),g("div",{class:"provider-actions",onClick:t[1]||(t[1]=T(()=>{},["stop"]))},[k(s,{size:"small",onClick:e=>function(e){const a=$.value[e]||[],t=n.value?a.filter(e=>e.displayName.toLowerCase().includes(n.value.toLowerCase())||e.modelId.toLowerCase().includes(n.value.toLowerCase())):a;for(const l of t)i.toggleModel(l.id,!0)}(a)},{default:f(()=>t[6]||(t[6]=[I("Enable All")])),_:2,__:[6]},1032,["onClick"]),k(s,{size:"small",onClick:e=>function(e){const a=$.value[e]||[],t=n.value?a.filter(e=>e.displayName.toLowerCase().includes(n.value.toLowerCase())||e.modelId.toLowerCase().includes(n.value.toLowerCase())):a;for(const l of t)i.toggleModel(l.id,!1)}(a)},{default:f(()=>t[7]||(t[7]=[I("Disable All")])),_:2,__:[7]},1032,["onClick"])])])]),default:f(()=>[g("div",te,[(v(!0),y(C,null,_(e,e=>(v(),y("div",{key:`${e.provider}:${e.modelId}`,class:x(["model-row",{"model-selected":r.value?.id===e.id}]),onClick:a=>function(e){r.value=e,P.value=e.displayName,Object.keys(S).forEach(e=>delete S[e]);const a=(e,t="")=>{Object.entries(e).forEach(([e,l])=>{const s=t?`${t}.${e}`:e;"object"===l.type&&l.properties?a(l.properties,s):l.basic&&void 0!==l.default&&(S[s]=l.default)})},t=J.getParametersForModel(e.provider,e.modelId);a(t)}(e)},[g("div",se,[g("div",ie,w(e.displayName),1)]),g("div",ne,[g("div",oe,"$"+w(M(e).toFixed(2)),1)])],10,le))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])]),r.value?(v(),y("div",re,[g("div",de,[g("h3",null,"Configure: "+w(r.value.displayName),1),g("div",ue,[t[8]||(t[8]=I(" Total cost: ")),g("strong",null,"$"+w((D()*E.value).toFixed(2)),1),I(" ("+w(E.value)+" calls) ",1)])]),g("div",ce,[k(R,{layout:"vertical"},{default:f(()=>[k(c,{label:"Configuration Name",required:""},{default:f(()=>[k(l,{value:P.value,"onUpdate:value":t[3]||(t[3]=e=>P.value=e),placeholder:"e.g., GPT-4 Creative",size:"large"},null,8,["value"])]),_:1}),Object.keys(z.value).length>0?(v(),y("div",pe,[t[9]||(t[9]=g("h4",null,"Basic Parameters",-1)),k(O,{gutter:16},{default:f(()=>[(v(!0),y(C,null,_(z.value,(e,a)=>(v(),p(U,{span:12,key:a},{default:f(()=>[k(c,{label:a},{default:f(()=>["number"===e.type?(v(),p(L,{key:0,value:S[a],"onUpdate:value":e=>S[a]=e,min:e.min,max:e.max,step:e.step,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"integer"===e.type?(v(),p(L,{key:1,value:S[a],"onUpdate:value":e=>S[a]=e,min:e.min,max:e.max,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onUpdate:value","min","max","placeholder"])):"string"===e.type&&e.enum?(v(),p(A,{key:2,value:S[a],"onUpdate:value":e=>S[a]=e,placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[(v(!0),y(C,null,_(e.enum,e=>(v(),p(N,{key:e,value:e},{default:f(()=>[I(w(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(v(),p(l,{key:3,value:S[a],"onUpdate:value":e=>S[a]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),g("div",ve,w(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})])):h("",!0),k(u,{ghost:""},{default:f(()=>[k(d,{key:"advanced",header:"Advanced Parameters"},{default:f(()=>[k(O,{gutter:[16,16]},{default:f(()=>[(v(!0),y(C,null,_(j.value,(e,a)=>(v(),p(U,{span:12,key:a},{default:f(()=>[k(c,{label:e.label},{default:f(()=>[k(L,{value:S[a],"onUpdate:value":e=>S[a]=e,min:e.min,max:e.max,step:e.step,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onUpdate:value","min","max","step","placeholder"])]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),g("div",me,[k(s,{type:"primary",size:"large",onClick:F,disabled:!P.value||!r.value},{default:f(()=>t[10]||(t[10]=[I(" Add Configuration ")])),_:1,__:[10]},8,["disabled"])])])):h("",!0)])]),_:1,__:[11]})}}}),[["__scopeId","data-v-84109c16"]]),ge=r({__name:"ModelEditModal",props:{configuration:{},design:{}},emits:["close","save"],setup(e,{emit:a}){const t=e,l=a,s=u({...t.configuration,parameters:{...t.configuration.parameters}});function i(){l("save",s),l("close")}return(e,a)=>{const t=m("a-input"),l=m("a-form-item"),n=m("a-slider"),o=m("a-col"),r=m("a-input-number"),d=m("a-row"),u=m("a-form"),c=m("a-modal");return v(),p(c,{open:!0,title:"Edit Configuration",width:600,onOk:i,onCancel:a[3]||(a[3]=a=>e.$emit("close"))},{default:f(()=>[k(u,{layout:"vertical"},{default:f(()=>[k(l,{label:"Configuration Name"},{default:f(()=>[k(t,{value:s.name,"onUpdate:value":a[0]||(a[0]=e=>s.name=e),size:"large"},null,8,["value"])]),_:1}),k(d,{gutter:16},{default:f(()=>[k(o,{span:12},{default:f(()=>[k(l,{label:"Temperature"},{default:f(()=>[k(n,{value:s.parameters.temperature,"onUpdate:value":a[1]||(a[1]=e=>s.parameters.temperature=e),min:0,max:2,step:.1,marks:{0:"0",1:"1",2:"2"}},null,8,["value"])]),_:1})]),_:1}),k(o,{span:12},{default:f(()=>[k(l,{label:"Max Tokens"},{default:f(()=>[k(r,{value:s.parameters.max_tokens,"onUpdate:value":a[2]||(a[2]=e=>s.parameters.max_tokens=e),min:1,max:4096,size:"large",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ye={class:"streamlined-content"},he={class:"content-section"},ke={class:"section-body"},be={key:0,class:"design-selector"},_e={key:0,class:"no-designs-state"},Ce={class:"no-designs-content"},xe={key:1,class:"design-list"},we=["onClick"],Te={class:"design-header"},Ie={class:"design-title-section"},Pe={class:"design-name"},Se={key:0,class:"design-inline-description"},$e={class:"design-date"},Ee=["innerHTML"],ze={class:"design-stats"},je={class:"stat-item"},Me={class:"stat-value"},De={class:"stat-item"},Fe={class:"stat-value"},Le={class:"stat-item"},Ne={class:"stat-value"},Ae={key:1,class:"selected-design"},Ue={class:"design-display"},Oe={class:"design-header"},Re={class:"template-preview"},qe={key:0,class:"content-section"},Be={class:"section-body"},Ve={class:"variables-summary"},Ke={class:"variable-name"},Je={class:"variable-values"},Ye={class:"combinations-total"},We={key:1,class:"content-section"},He={class:"section-body"},Ge={class:"models-section"},Qe={class:"quick-add-models"},Xe={class:"quick-model-buttons"},Ze={class:"preset-name"},ea={class:"preset-cost"},aa={class:"selected-models-list"},ta={class:"model-info"},la={class:"model-name"},sa={class:"model-params"},ia={class:"model-cost"},na={class:"model-actions"},oa={class:"add-model-section"},ra={key:0,class:"add-model-hint"},da={key:2,class:"content-section summary-section"},ua={class:"trial-summary"},ca={class:"summary-stats"},pa={class:"stat"},va={class:"stat-value"},ma={class:"stat-detail"},fa={class:"stat"},ga={class:"stat-value"},ya={class:"stat"},ha={class:"stat-value"},ka={class:"trial-config-row"},ba={class:"trial-name-input"},_a={class:"repeat-config"},Ca={class:"modal-footer-buttons"},xa=a(r({__name:"TrialCreationStreamlined",props:{initialDesignId:{}},emits:["close","created","created-and-started","export-trial"],setup(a,{emit:n}){const o=a,r=n,u=B(),x=V(),T=N(),$=A(),E=d(""),z=d(null),j=d([]),M=d(""),D=d(1),F=d(!1),L=d(!1),U=d(null),O=d(0),R=new Map,q=c(()=>{const e=K(),a=e=>$.hasApiKey(e),t=(a,t)=>!!e.enabledModels.find(e=>e.provider===a&&e.modelId===t&&e.enabled),l=[],s=new Set,i=[...T.trials].sort((e,a)=>new Date(a.created).getTime()-new Date(e.created).getTime());for(const r of i){if(l.length>=5)break;for(const e of r.configurationSnapshots||[]){if(l.length>=5)break;const i=`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`;!s.has(i)&&a(e.provider)&&t(e.provider,e.modelId)&&(s.add(i),l.push({provider:e.provider,modelId:e.modelId,displayName:e.modelId,parameters:e.parameters,outputType:"text"}))}}const n=[{provider:"openai-chat",modelId:"gpt-4.1-nano",displayName:"gpt-4.1-nano",parameters:{temperature:0,max_completion_tokens:128},outputType:"text"},{provider:"openai-responses",modelId:"o4-mini",displayName:"o4-mini",parameters:{},outputType:"text"},{provider:"anthropic",modelId:"claude-3-haiku-20240307",displayName:"claude-3-haiku-20240307",parameters:{temperature:0,max_tokens:128},outputType:"text"},{provider:"anthropic",modelId:"claude-4-sonnet-20250514",displayName:"claude-4-sonnet-20250514",parameters:{temperature:0,max_tokens:128},outputType:"text"},{provider:"openrouter",modelId:"meta-llama/llama-3.1-8b-instruct",displayName:"meta-llama/llama-3.1-8b-instruct",parameters:{temperature:0,max_tokens:128},outputType:"text"},{provider:"openrouter",modelId:"mistralai/mistral-nemo",displayName:"mistralai/mistral-nemo",parameters:{temperature:0,max_tokens:128},outputType:"text"},{provider:"openrouter",modelId:"deepseek/deepseek-chat-v3-0324",displayName:"deepseek/deepseek-chat-v3-0324",parameters:{temperature:0,max_tokens:128},outputType:"text"}],o=new Set(l.map(e=>`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`));for(const r of n){const e=`${r.provider}:${r.modelId}:${JSON.stringify(r.parameters)}`;!o.has(e)&&a(r.provider)&&t(r.provider,r.modelId)&&l.push(r)}return l}),J=c(()=>{const e=u.designs;if(e.length,!E.value)return e;const a=E.value.toLowerCase();return e.filter(e=>e.name.toLowerCase().includes(a)||e.promptTemplate.toLowerCase().includes(a))}),Y=c(()=>{if(!z.value)return 0;let e=1;for(const a of Object.values(z.value.variableBindings))if("direct"===a.type)e*=a.values?.length||1;else if(a.listId){const t=x.lists.find(e=>e.id===a.listId);e*=t?.itemCount||1}return e}),W=c(()=>Y.value*j.value.length*D.value),H=c(()=>{let e=0;for(const a of j.value)e+=pe(a)*Y.value*D.value;return e}),G=c(()=>Math.ceil(2*W.value/60));function Q(e){z.value=e,M.value=xa()}function X(){z.value=null,j.value=[]}function Z(){s.info("Design creation would open here")}function ee(e){return Object.keys(e.variableBindings).length}function ae(e){return e.replace(/\n+/g," ").replace(/\s+/g," ").trim()}function te(e){const a=new Date,t=a.getTime()-e.getTime(),l=Math.floor(t/864e5);if(0===l)return"Today";if(1===l)return"Yesterday";if(l<7)return`${l} days ago`;if(l<30){const e=Math.floor(l/7);return`${e} week${e>1?"s":""} ago`}return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:e.getFullYear()!==a.getFullYear()?"numeric":void 0})}function le(e){if(!e.variableBindings)return"1";let a=1;for(const t of Object.values(e.variableBindings))if("direct"===t.type&&t.values)a*=t.values.length;else if("list"===t.type&&t.listId){const e=x.lists.find(e=>e.id===t.listId);a*=e?.itemCount||1}return a>1e3?`${(a/1e3).toFixed(1)}k`:a.toString()}function se(e){const a=function(e){if(!e.variableBindings)return[{}];const a=[];for(const[t,l]of Object.entries(e.variableBindings))if("direct"===l.type&&l.values)a.push({name:t,values:l.values});else if("list"===l.type&&l.listId){const e=x.lists.find(e=>e.id===l.listId);if(e){let l=[];l="simple"===e.category&&e.values?e.values.slice(0,3):"attributed"===e.category&&e.items?e.items.slice(0,3).map(e=>e.value):[`${t}_sample`],a.push({name:t,values:l})}}if(0===a.length)return[{}];return a.map(e=>e.values).reduce((e,a)=>e.flatMap(e=>a.map(a=>[...e,a])),[[]]).map(e=>{const t={};return a.forEach((a,l)=>{t[a.name]=e[l]}),t})}(e);if(a.length<=1)return ie(ae(e.promptTemplate));const t=a[O.value%a.length],l=["variable-highlight-blue","variable-highlight-green","variable-highlight-purple","variable-highlight-orange","variable-highlight-pink","variable-highlight-teal"];let s=e.promptTemplate;Object.keys(e.variableBindings||{}).forEach((e,a)=>{if(void 0!==t[e]){const i=new RegExp(`\\{\\{\\s*${e}\\s*\\}\\}`,"g"),n=`<span class="${l[a%l.length]}">${ie(String(t[e]))}</span>`;s=s.replace(i,n)}});let i=ie(s);return l.forEach(e=>{i=i.replace(new RegExp(`&lt;span class="${e}"&gt;`,"g"),`<span class="${e}">`).replace(/&lt;\/span&gt;/g,"</span>")}),ae(i)}function ie(e){const a=document.createElement("div");return a.textContent=e,a.innerHTML}function ne(e){if("direct"===e.type)return e.values||[];{const a=x.lists.find(a=>a.id===e.listId);return Array.from({length:a?.itemCount||0},(e,a)=>`Item ${a+1}`)}}function oe(e){return j.value.some(a=>a.provider===e.provider&&a.modelId===e.modelId&&JSON.stringify(a.parameters)===JSON.stringify(e.parameters))}function re(e){const a=K().enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a)return 0;const t=z.value?.tokenEstimate?.avgTokens||0,l=e.parameters.max_tokens||e.parameters.max_completion_tokens||0;if(0===t||0===l)return 0;return((a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*l)*Y.value*D.value}function de(e){const a=[];for(const[t,l]of Object.entries(e))null!=l&&a.push(`${t}=${l}`);return a.join(", ")||"Default settings"}function ue(e){j.value.push(e),L.value=!1}function ce(e){null!==U.value&&(j.value[U.value]=e,U.value=null)}function pe(e){const a=K().enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a)return 0;const t=z.value?.tokenEstimate?.avgTokens||0,l=e.parameters.max_tokens||e.parameters.max_completion_tokens||0;if(0===t||0===l)return 0;return(a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*l}function ve(e){return pe(e)*Y.value*D.value}function me(e){const a=Math.abs(e);if(0===a)return"";if(a<.01){const e=a.toFixed(10).match(/0\.0*([1-9])/);if(e){const t=e[0].length-1;return`$${a.toFixed(Math.max(2,t))}`}}return`$${a.toFixed(2)}`}function xa(){if(!z.value)return"New Trial";const e=(new Date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return`${z.value.name} - ${e}`}async function wa(){if(z.value&&0!==j.value.length){F.value="start";try{const e=await T.createTrial({name:M.value||xa(),designId:z.value.id,configurations:j.value,repeatConfig:D.value>1?{callsPerPrompt:D.value,strategy:"sequential"}:void 0});s.success("Trial created! Starting execution..."),r("created-and-started",e),r("close"),F.value=!1,setTimeout(async()=>{try{await T.executeTrial(e)}catch(a){console.error("Failed to start trial:",a),s.error("Failed to start trial execution")}},100)}catch(e){console.error("Failed to create trial:",e),s.error("Failed to create trial"),F.value=!1}}}async function Ta(){if(z.value&&0!==j.value.length){F.value="export";try{const e=await T.createTrial({name:M.value||xa(),designId:z.value.id,configurations:j.value,repeatConfig:D.value>1?{callsPerPrompt:D.value,strategy:"sequential"}:void 0}),a=await T.getTrial(e);if(a){const{PythonExportService:e}=await i(async()=>{const{PythonExportService:e}=await import("./APICallDetailModal-BGCLw6Ck.js").then(e=>e.p);return{PythonExportService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]),import.meta.url),t=e.validateTrialForExport(a);if(!t.valid)return void s.error(`Cannot export trial: ${t.errors.join(", ")}`);r("export-trial",a)}s.success("Trial created! Opening export options..."),r("created",e),r("close")}catch(e){console.error("Failed to create trial for export:",e),s.error("Failed to create trial for export")}finally{F.value=!1}}}async function Ia(){if(z.value&&0!==j.value.length){F.value="draft";try{const e=await T.createTrial({name:M.value||xa(),designId:z.value.id,configurations:j.value,repeatConfig:D.value>1?{callsPerPrompt:D.value,strategy:"sequential"}:void 0});s.success("Trial created as draft!"),r("created",e),r("close")}catch(e){console.error("Failed to create draft trial:",e),s.error("Failed to create draft trial")}finally{F.value=!1}}}let Pa=null;return P(async()=>{if(await Promise.all([u.initialize(),x.initialize(),T.initialize()]),o.initialDesignId){const e=u.designs.find(e=>e.id===o.initialDesignId);e&&Q(e)}Pa=setInterval(()=>{O.value++},1e3)}),S(()=>{Pa&&clearInterval(Pa),R.forEach(e=>clearInterval(e)),R.clear()}),(a,s)=>{const i=m("a-input"),n=m("a-button"),o=m("a-tag"),r=m("a-input-number"),d=m("a-modal");return v(),p(d,{open:!0,title:null,width:"90vw",style:{top:"5vh",maxWidth:"1200px"},bodyStyle:{padding:"0",height:"85vh",display:"flex",flexDirection:"column"},maskClosable:!1,onCancel:s[7]||(s[7]=e=>a.$emit("close"))},{footer:f(()=>[g("div",Ca,[k(n,{size:"large",onClick:Ia,loading:"draft"===F.value,disabled:!z.value||0===j.value.length},{default:f(()=>s[30]||(s[30]=[I(" Create as Draft ")])),_:1,__:[30]},8,["loading","disabled"]),k(n,{size:"large",onClick:Ta,loading:"export"===F.value,disabled:!z.value||0===j.value.length},{default:f(()=>s[31]||(s[31]=[I(" Export to Python ")])),_:1,__:[31]},8,["loading","disabled"]),k(n,{type:"primary",size:"large",onClick:wa,loading:"start"===F.value,disabled:!z.value||0===j.value.length},{default:f(()=>[k(b(l)),s[32]||(s[32]=I(" Create and Start "))]),_:1,__:[32]},8,["loading","disabled"])])]),default:f(()=>[s[33]||(s[33]=g("div",{class:"streamlined-header"},[g("h2",null,"Create New Trial")],-1)),g("div",ye,[g("section",he,[s[17]||(s[17]=g("h3",null,"What are you testing?",-1)),g("div",ke,[z.value?(v(),y("div",Ae,[g("div",Ue,[g("div",Oe,[g("h4",null,w(z.value.name),1),k(n,{type:"link",onClick:X},{default:f(()=>s[16]||(s[16]=[I("Change")])),_:1,__:[16]})]),g("pre",Re,w(z.value.promptTemplate),1)])])):(v(),y("div",be,[k(i,{value:E.value,"onUpdate:value":s[0]||(s[0]=e=>E.value=e),placeholder:"Search designs...",size:"large",class:"design-search",allowClear:""},{prefix:f(()=>[k(b(e))]),_:1},8,["value"]),0===J.value.length?(v(),y("div",_e,[g("div",Ce,[s[9]||(s[9]=g("p",null,"No designs found",-1)),k(n,{onClick:s[1]||(s[1]=()=>b(u).initialize())},{default:f(()=>s[8]||(s[8]=[I("Refresh Designs")])),_:1,__:[8]})])])):(v(),y("div",xe,[(v(!0),y(C,null,_(J.value,e=>{return v(),y("div",{key:e.id,class:"design-item",onClick:a=>Q(e)},[g("div",Te,[g("div",Ie,[g("h4",Pe,[I(w(e.name)+" ",1),e.description?(v(),y("span",Se,"- "+w(e.description),1)):h("",!0)])]),g("span",$e,w(te(e.updated)),1)]),g("p",{class:"design-description",innerHTML:se(e)},null,8,Ee),g("div",ze,[k(o,{size:"small",color:(a=e.outputType,{text:"blue",number:"green",boolean:"purple",json:"orange"}[a]||"default"),class:"output-type-tag"},{default:f(()=>[I(w(e.outputType||"text"),1)]),_:2},1032,["color"]),g("span",je,[g("span",Me,w(ee(e)),1),s[10]||(s[10]=g("span",{class:"stat-label"},"vars",-1))]),s[13]||(s[13]=g("span",{class:"stat-divider"},"â€¢",-1)),g("span",De,[g("span",Fe,w(le(e)),1),s[11]||(s[11]=g("span",{class:"stat-label"},"combos",-1))]),s[14]||(s[14]=g("span",{class:"stat-divider"},"â€¢",-1)),g("span",Le,[g("span",Ne,w(e.tokenEstimate?.avgTokens||"?"),1),s[12]||(s[12]=g("span",{class:"stat-label"},"tokens",-1))])])],8,we);var a}),128)),g("div",{class:"design-card design-card-create",onClick:Z},[k(b(t),{style:{"font-size":"24px"}}),s[15]||(s[15]=g("span",null,"Create New Design",-1))])]))]))])]),z.value?(v(),y("section",qe,[s[20]||(s[20]=g("h3",null,"How does it vary?",-1)),g("div",Be,[g("div",Ve,[(v(!0),y(C,null,_(z.value.variableBindings,(e,a)=>(v(),y("div",{key:a,class:"variable-row"},[g("span",Ke,w(a)+":",1),g("span",Je,w(ne(e).join(", ")),1)]))),128)),g("div",Ye,[s[18]||(s[18]=I(" = ")),g("strong",null,w(Y.value),1),s[19]||(s[19]=I(" unique combinations "))])])])])):h("",!0),z.value?(v(),y("section",We,[s[23]||(s[23]=g("h3",null,"Model Configurations to Compare",-1)),g("div",He,[g("div",Ge,[g("div",Qe,[s[21]||(s[21]=g("p",{class:"quick-add-label"},"Quick add recent/popular models:",-1)),g("div",Xe,[(v(!0),y(C,null,_(q.value,e=>(v(),p(n,{key:`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`,onClick:a=>function(e){oe(e)||j.value.push({name:e.displayName,provider:e.provider,modelId:e.modelId,parameters:e.parameters})}(e),size:"small",class:"quick-model-btn",disabled:oe(e)},{default:f(()=>[g("span",Ze,w(e.displayName),1),g("span",ea,w(me(re(e))),1)]),_:2},1032,["onClick","disabled"]))),128))])]),g("div",aa,[(v(!0),y(C,null,_(j.value,(e,a)=>(v(),y("div",{key:a,class:"model-item"},[g("div",ta,[g("span",la,w(e.name),1),g("span",sa,w(de(e.parameters)),1),g("span",ia,w(me(ve(e))),1)]),g("div",na,[k(n,{type:"text",size:"large",danger:"",onClick:e=>function(e){j.value.splice(e,1)}(a),class:"remove-button"},{default:f(()=>s[22]||(s[22]=[I("Ã—")])),_:2,__:[22]},1032,["onClick"])])]))),128))]),g("div",oa,[k(n,{type:"primary",size:"large",onClick:s[2]||(s[2]=e=>L.value=!0),class:"add-model-cta",ghost:j.value.length>0},{default:f(()=>[k(b(t)),I(" "+w(0===j.value.length?"Choose Models to Compare":"Add Another Model"),1)]),_:1},8,["ghost"]),0===j.value.length?(v(),y("p",ra," Select multiple models to compare their responses ")):h("",!0)])])])])):h("",!0),j.value.length>0?(v(),y("section",da,[g("div",ua,[g("div",ca,[g("div",pa,[s[24]||(s[24]=g("span",{class:"stat-label"},"Total experiments:",-1)),g("span",va,w(W.value),1),g("span",ma,"("+w(Y.value)+" prompts Ã— "+w(j.value.length)+" models"+w(D.value>1?` Ã— ${D.value} repeats`:"")+")",1)]),g("div",fa,[s[25]||(s[25]=g("span",{class:"stat-label"},"Estimated cost:",-1)),g("span",ga,"$"+w(H.value.toFixed(2)),1)]),g("div",ya,[s[26]||(s[26]=g("span",{class:"stat-label"},"Estimated time:",-1)),g("span",ha,"~"+w(G.value)+" minutes",1)])]),g("div",ka,[g("div",ba,[s[27]||(s[27]=g("label",null,"Trial Name:",-1)),k(i,{value:M.value,"onUpdate:value":s[3]||(s[3]=e=>M.value=e),placeholder:"Enter trial name (optional)",size:"large",style:{width:"300px"}},null,8,["value"])]),g("div",_a,[s[28]||(s[28]=g("label",null,"Repeat each prompt:",-1)),k(r,{value:D.value,"onUpdate:value":s[4]||(s[4]=e=>D.value=e),min:1,max:10,size:"large",style:{width:"80px"}},null,8,["value"]),s[29]||(s[29]=g("span",{class:"repeat-label"},"times",-1))])])])])):h("",!0)]),L.value&&z.value?(v(),p(fe,{key:0,design:z.value,"existing-configurations":j.value,onClose:s[5]||(s[5]=e=>L.value=!1),onAddConfiguration:ue},null,8,["design","existing-configurations"])):h("",!0),null!==U.value&&z.value?(v(),p(ge,{key:1,configuration:j.value[U.value],design:z.value,onClose:s[6]||(s[6]=e=>U.value=null),onSave:ce},null,8,["configuration","design"])):h("",!0)]),_:1,__:[33]})}}}),[["__scopeId","data-v-c7ddcd2a"]]),wa={class:"execution-monitor"},Ta={class:"monitor-header"},Ia={class:"header-left"},Pa={key:0,class:"progress-summary"},Sa={class:"progress-bar"},$a={class:"progress-text"},Ea={key:0,class:"network-errors"},za={key:0,class:"header-stats"},ja={class:"stat"},Ma={class:"stat pending"},Da={class:"stat running"},Fa={class:"stat completed"},La={class:"stat failed"},Na={key:0,class:"monitor-filters"},Aa={class:"monitor-content"},Ua={key:0,class:"empty-state"},Oa={key:1,class:"empty-state"},Ra={class:"placeholder-content"},qa={key:2,class:"results-table"},Ba={class:"table-body"},Va=["onClick"],Ka={class:"col-status"},Ja={class:"col-config"},Ya={class:"config-name"},Wa={class:"col-repeat"},Ha={key:0,class:"repeat-info"},Ga={key:1,class:"repeat-placeholder"},Qa={class:"col-variables"},Xa={class:"variables-list"},Za={class:"var-key"},et={class:"var-value"},at={key:0,class:"separator"},tt={class:"col-response"},lt={key:0,class:"response-placeholder"},st={key:1,class:"response-placeholder"},it={key:2,class:"response-error"},nt={key:3,class:"response-content"},ot={key:4,class:"response-placeholder"},rt={class:"col-time"},dt={key:0,class:"time-info"},ut={class:"duration"},ct={key:0,class:"latency"},pt={key:1,class:"time-placeholder"},vt={key:0,class:"load-more"},mt=a(r({__name:"ExecutionMonitor",props:{trialId:{}},setup(e){const a=e,t=d(null),l=d([]),s=d("all"),i=d(""),o=d(null),r=d(100);let u=null,k=null;const b=c(()=>{const e={total:0,pending:0,running:0,completed:0,failed:0};return l.value.forEach(a=>{e.total++,"completed"===a.status?e.completed++:"failed"===a.status?(e.failed++,e.completed++):e[a.status]++}),e}),T=c(()=>t.value&&0!==t.value.progress.total?t.value.progress.completed/t.value.progress.total*100:0),F=c(()=>{let e=l.value;if("all"!==s.value&&(e=e.filter(e=>e.status===s.value)),i.value.trim()){const a=i.value.toLowerCase();e=e.filter(e=>Object.values(e.variables).some(e=>e.toLowerCase().includes(a))||e.result?.content&&String(e.result.content).toLowerCase().includes(a)||e.result?.error&&e.result.error.toLowerCase().includes(a))}return e.sort((e,a)=>a.created.getTime()-e.created.getTime())}),L=c(()=>F.value.slice(0,r.value));function N(e,a){return e.length<=a?e:e.slice(0,a)+"..."}function A(){r.value+=50}function O(){u&&u.unsubscribe(),k&&k.unsubscribe(),u=Y(()=>n.trials.get(a.trialId)).subscribe({next:e=>{t.value=e||null},error:e=>{console.error("Trial subscription error:",e)}}),k=Y(()=>n.apiCalls.where("trialId").equals(a.trialId).toArray()).subscribe({next:e=>{l.value=e},error:e=>{console.error("API calls subscription error:",e)}})}return $(()=>a.trialId,e=>{e&&O()},{immediate:!0}),P(()=>{O()}),S(()=>{u&&u.unsubscribe(),k&&k.unsubscribe()}),(e,a)=>{const l=m("a-tag");return v(),y("div",wa,[g("div",Ta,[g("div",Ia,[g("h3",null,[I(w(t.value?.name||"Select a trial to monitor")+" ",1),t.value?.repeatConfig?.callsPerPrompt&&t.value.repeatConfig.callsPerPrompt>1?(v(),p(l,{key:0,size:"small",color:"purple",style:{"margin-left":"8px"}},{default:f(()=>[I(w(t.value.repeatConfig.callsPerPrompt)+"Ã— repeat ",1)]),_:1})):h("",!0)]),t.value?(v(),y("div",Pa,[g("div",Sa,[g("div",{class:"progress-fill",style:E({width:T.value+"%"})},null,4)]),g("span",$a,[I(w(t.value.progress.completed)+" / "+w(t.value.progress.total)+" completed ",1),t.value.progress.networkErrors>0?(v(),y("span",Ea,"("+w(t.value.progress.networkErrors)+" network errors)",1)):h("",!0)])])):h("",!0)]),t.value?(v(),y("div",za,[g("span",ja,w(b.value.total)+" total",1),g("span",Ma,w(b.value.pending)+" pending",1),g("span",Da,w(b.value.running)+" running",1),g("span",Fa,w(b.value.completed)+" completed",1),g("span",La,w(b.value.failed)+" failed",1)])):h("",!0)]),t.value?(v(),y("div",Na,[z(g("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),class:"filter-select"},a[3]||(a[3]=[M('<option value="all" data-v-3fd79d24>All Statuses</option><option value="pending" data-v-3fd79d24>Pending</option><option value="running" data-v-3fd79d24>Running</option><option value="completed" data-v-3fd79d24>Completed</option><option value="failed" data-v-3fd79d24>Failed</option>',5)]),512),[[j,s.value]]),z(g("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),type:"text",placeholder:"Search variables or response...",class:"search-input"},null,512),[[D,i.value]])])):h("",!0),g("div",Aa,[t.value?0===F.value.length?(v(),y("div",Oa,[g("div",Ra,[a[5]||(a[5]=g("h4",null,"No API Calls",-1)),g("p",null,w(0===b.value.total?"Start the trial to see API calls here.":"No API calls match the current filters."),1)])])):(v(),y("div",qa,[a[6]||(a[6]=M('<div class="table-header" data-v-3fd79d24><div class="col-status" data-v-3fd79d24>Status</div><div class="col-config" data-v-3fd79d24>Config</div><div class="col-repeat" data-v-3fd79d24>Repeat</div><div class="col-variables" data-v-3fd79d24>Variables</div><div class="col-response" data-v-3fd79d24>Response</div><div class="col-time" data-v-3fd79d24>Time</div></div>',1)),g("div",Ba,[(v(!0),y(C,null,_(L.value,e=>{return v(),y("div",{key:e.id,class:x(["table-row",[e.status]]),onClick:a=>function(e){o.value=e}(e)},[g("div",Ka,[g("span",{class:x(["status-badge",e.status])},w(e.status),3)]),g("div",Ja,[g("span",Ya,w((l=e.configurationIndex,t.value&&t.value.configurationSnapshots[l]&&t.value.configurationSnapshots[l].name||`Config ${l+1}`)),1)]),g("div",Wa,[void 0!==e.repeatIndex?(v(),y("span",Ha,w(e.repeatIndex+1)+"/"+w(t.value?.repeatConfig?.callsPerPrompt||1),1)):(v(),y("span",Ga,"â€”"))]),g("div",Qa,[g("div",Xa,[(v(!0),y(C,null,_(Object.entries(e.variables),([a,t],l)=>(v(),y("span",{key:a,class:"variable-pair"},[g("span",Za,w(a)+":",1),g("span",et,w(N(t,30)),1),l<Object.entries(e.variables).length-1?(v(),y("span",at,"â€¢")):h("",!0)]))),128))])]),g("div",tt,["pending"===e.status?(v(),y("div",lt," Waiting... ")):"running"===e.status?(v(),y("div",st," Processing... ")):"failed"===e.status?(v(),y("div",it,w(e.result?.error||"API call failed"),1)):e.result?.content?(v(),y("div",nt,w(N(String(e.result.content),100)),1)):(v(),y("div",ot," No content "))]),g("div",rt,[e.completed?(v(),y("div",dt,[g("div",ut,w((a=e.completed.getTime()-e.created.getTime(),a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`)),1),e.response?(v(),y("div",ct,w(e.response.latencyMs)+"ms",1)):h("",!0)])):(v(),y("div",pt,"â€”"))])],10,Va);var a,l}),128))]),F.value.length>r.value?(v(),y("div",vt,[g("button",{onClick:A,class:"load-more-btn"}," Load More ("+w(F.value.length-r.value)+" remaining) ",1)])):h("",!0)])):(v(),y("div",Ua,a[4]||(a[4]=[g("div",{class:"placeholder-content"},[g("h4",null,"No Trial Selected"),g("p",null,"Click on a trial card to monitor its execution progress and view results.")],-1)])))]),o.value?(v(),p(U,{key:1,"api-call":o.value,trial:t.value,onClose:a[2]||(a[2]=e=>o.value=null)},null,8,["api-call","trial"])):h("",!0)])}}}),[["__scopeId","data-v-3fd79d24"]]),ft={class:"trials-table-container full-width scientific-table-wrapper"},gt={key:0,class:"trial-name-cell"},yt={class:"trial-header"},ht={class:"trial-name"},kt={class:"trial-design"},bt={class:"text-secondary"},_t={key:1,class:"progress-cell"},Ct={class:"progress-text text-xs"},xt={key:0,class:"network-errors"},wt={key:4,class:"api-calls-cell"},Tt={class:"total-calls"},It={class:"calls-calculation text-secondary"},Pt={key:0},St={key:1,class:"text-secondary"},$t={class:"date-cell"},Et={class:"date-value"},zt={class:"time-value text-secondary"},jt={key:7,class:"trial-actions-4"},Mt=a(r({__name:"TrialsTable",props:{trials:{},isLoading:{type:Boolean,default:!1}},emits:["trial-selected","trial-started","trial-paused","trial-resumed","trial-cancelled","trial-exported","trial-duplicated","trial-deleted","trial-viewed","trial-export-data","trial-export-python","trial-edited","trial-retried","status-filter-changed"],setup(e,{emit:a}){const t=e,l=a,s=d("all"),i=[{key:"all",label:"All"},{key:"draft",label:"Draft"},{key:"pending",label:"Pending"},{key:"running",label:"Running"},{key:"paused",label:"Paused"},{key:"completed",label:"Completed"},{key:"failed",label:"Failed"},{key:"cancelled",label:"Cancelled"}],{createTrialColumns:n,getVisibleColumns:r}=W(),u=r(n()),P=c(()=>"all"===s.value?t.trials:t.trials.filter(e=>e.status===s.value));function S(e){s.value=e,l("status-filter-changed",e)}function $(e){return{onClick:a=>{const t=a.target;t.closest(".ant-btn")||t.closest(".ant-dropdown-trigger")||(e.name,e.id,l("trial-selected",e))}}}function E(e){return"all"===e?t.trials.length:t.trials.filter(a=>a.status===e).length}function z(e){return"failed"===e.status?"exception":"completed"===e.status?"success":e.progress.networkErrors>0?"exception":"normal"}function j(e){const a=[];return"running"===e.status&&a.push("status-running"),"failed"===e.status&&a.push("status-failed"),"completed"===e.status&&a.push("status-completed"),a.join(" ")}function M(e){const a=(new Date).getTime()-e.getTime(),t=Math.floor(a/864e5);return 0===t?"Today":1===t?"Yesterday":t<7?`${t} days ago`:t<30?`${Math.floor(t/7)} weeks ago`:e.toLocaleDateString()}function D(e){const a=Math.abs(e);if(0===a)return"";if(a<.01){const e=a.toFixed(10).match(/0\.0*([1-9])/);if(e){const t=e[0].length-1;return`$${a.toFixed(Math.max(2,t))}`}}return`$${a.toFixed(2)}`}function F(e){l("trial-viewed",e)}function L(e){l("trial-duplicated",e)}return(e,a)=>{const t=m("a-tab-pane"),n=m("a-tabs"),r=m("a-tag"),d=m("a-progress"),c=m("a-tooltip"),N=m("a-button"),A=m("a-menu-item"),U=m("a-menu"),O=m("a-dropdown"),R=m("a-table");return v(),y("div",ft,[k(n,{activeKey:s.value,"onUpdate:activeKey":a[0]||(a[0]=e=>s.value=e),size:"small",class:"status-tabs",onChange:S},{default:f(()=>[(v(),y(C,null,_(i,e=>k(t,{key:e.key,tab:`${e.label} (${E(e.key)})`},null,8,["tab"])),64))]),_:1},8,["activeKey"]),k(R,{columns:b(u),"data-source":P.value,pagination:!1,size:"small",scroll:{y:"calc(100vh - 200px)"},"row-key":"id","row-class-name":j,class:"scientific-table clickable-rows","custom-row":$},{bodyCell:f(({column:e,record:t})=>{return["name"===e.key?(v(),y("div",gt,[g("div",yt,[g("strong",ht,w(t.name),1),k(r,{color:(i=t.status,{draft:"default",pending:"processing",running:"processing",paused:"warning",completed:"success",failed:"error",cancelled:"default"}[i]||"default"),size:"small",class:"trial-status-tag"},{default:f(()=>[I(w(t.status.toUpperCase()),1)]),_:2},1032,["color"])]),g("div",kt,[g("small",bt," Design: "+w(t.designSnapshot?.originalName||"Unknown Design"),1)]),a[2]||(a[2]=g("div",{class:"click-hint"},[g("small",{class:"text-secondary"},"Click to view live progress")],-1))])):h("",!0),"progress"===e.key?(v(),y("div",_t,[k(d,{percent:(s=t,0===s.progress.total?0:Math.round(s.progress.completed/s.progress.total*100)),size:"small",status:z(t),"show-info":!1,class:"progress-bar"},null,8,["percent","status"]),g("div",Ct,[I(w(t.progress.completed)+" / "+w(t.progress.total)+" ",1),t.progress.networkErrors>0?(v(),y("span",xt," ("+w(t.progress.networkErrors)+" errors) ",1)):h("",!0)])])):h("",!0),"configurations"===e.key?(v(),y(C,{key:2},[k(c,{title:`${t.configurationSnapshots?.length||0} model configurations`},{default:f(()=>[k(r,{size:"small",color:"blue"},{default:f(()=>[I(w(t.configurationSnapshots?.length||0)+" configs ",1)]),_:2},1024)]),_:2},1032,["title"]),t.repeatConfig?.callsPerPrompt&&t.repeatConfig.callsPerPrompt>1?(v(),p(r,{key:0,size:"small",color:"purple",style:{"margin-left":"4px"}},{default:f(()=>[I(w(t.repeatConfig.callsPerPrompt)+"Ã— repeat ",1)]),_:2},1024)):h("",!0)],64)):h("",!0),"variables"===e.key?(v(),p(c,{key:3,title:`${t.totalCombinations} variable combinations`},{default:f(()=>[k(r,{size:"small",color:"green"},{default:f(()=>[I(w(t.totalCombinations)+" combos ",1)]),_:2},1024)]),_:2},1032,["title"])):h("",!0),"api_calls"===e.key?(v(),y("div",wt,[g("span",Tt,w(t.progress.total),1),g("small",It,[I(w(t.configurationSnapshots?.length||0)+" Ã— "+w(t.totalCombinations),1),t.repeatConfig?.callsPerPrompt&&t.repeatConfig.callsPerPrompt>1?(v(),y("span",Pt," Ã— "+w(t.repeatConfig.callsPerPrompt),1)):h("",!0)])])):h("",!0),"cost"===e.key?(v(),y("span",{key:5,class:x(["cost-cell",{negative:t.estimatedCost<0}])},[D(t.estimatedCost)?(v(),y(C,{key:0},[I(w(D(t.estimatedCost)),1)],64)):(v(),y("span",St,"-"))],2)):h("",!0),"created"===e.key?(v(),p(c,{key:6,title:t.created.toLocaleString()},{default:f(()=>{return[g("div",$t,[g("span",Et,w(M(t.created)),1),g("small",zt,w((e=t.created,e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),1)])];var e}),_:2},1032,["title"])):h("",!0),"actions"===e.key?(v(),y("div",jt,["draft"===t.status||"pending"===t.status?(v(),p(N,{key:0,size:"small",type:"primary",onClick:T(e=>function(e){l("trial-started",e)}(t),["stop"])},{default:f(()=>a[3]||(a[3]=[I(" Start ")])),_:2,__:[3]},1032,["onClick"])):"running"===t.status?(v(),p(N,{key:1,size:"small",type:"primary",onClick:T(e=>F(t),["stop"])},{default:f(()=>a[4]||(a[4]=[I(" View Live ")])),_:2,__:[4]},1032,["onClick"])):"completed"===t.status?(v(),p(N,{key:2,size:"small",type:"primary",onClick:T(e=>F(t),["stop"])},{default:f(()=>a[5]||(a[5]=[I(" Results ")])),_:2,__:[5]},1032,["onClick"])):"failed"===t.status?(v(),p(N,{key:3,size:"small",type:"primary",onClick:T(e=>F(t),["stop"])},{default:f(()=>a[6]||(a[6]=[I(" Details ")])),_:2,__:[6]},1032,["onClick"])):"paused"===t.status?(v(),p(N,{key:4,size:"small",type:"primary",onClick:T(e=>function(e){l("trial-resumed",e)}(t),["stop"])},{default:f(()=>a[7]||(a[7]=[I(" Resume ")])),_:2,__:[7]},1032,["onClick"])):h("",!0),"draft"===t.status?(v(),p(N,{key:5,size:"small",onClick:T(e=>function(e){l("trial-edited",e)}(t),["stop"])},{default:f(()=>a[8]||(a[8]=[I(" Edit ")])),_:2,__:[8]},1032,["onClick"])):"running"===t.status?(v(),p(N,{key:6,size:"small",class:"btn-warning",onClick:T(e=>function(e){l("trial-paused",e)}(t),["stop"])},{default:f(()=>a[9]||(a[9]=[I(" Pause ")])),_:2,__:[9]},1032,["onClick"])):"completed"===t.status?(v(),p(N,{key:7,size:"small",onClick:T(e=>L(t),["stop"])},{default:f(()=>a[10]||(a[10]=[I(" Duplicate ")])),_:2,__:[10]},1032,["onClick"])):"failed"===t.status?(v(),p(N,{key:8,size:"small",class:"btn-warning",onClick:T(e=>function(e){l("trial-retried",e)}(t),["stop"])},{default:f(()=>a[11]||(a[11]=[I(" Retry ")])),_:2,__:[11]},1032,["onClick"])):"paused"===t.status?(v(),p(N,{key:9,size:"small",onClick:T(e=>F(t),["stop"])},{default:f(()=>a[12]||(a[12]=[I(" Progress ")])),_:2,__:[12]},1032,["onClick"])):(v(),p(N,{key:10,size:"small",onClick:T(e=>L(t),["stop"])},{default:f(()=>a[13]||(a[13]=[I(" Duplicate ")])),_:2,__:[13]},1032,["onClick"])),k(O,{trigger:"click"},{overlay:f(()=>[k(U,null,{default:f(()=>[k(A,{onClick:e=>function(e){l("trial-export-data",e)}(t)},{default:f(()=>a[15]||(a[15]=[I(" Export Data ")])),_:2,__:[15]},1032,["onClick"]),k(A,{onClick:e=>function(e){l("trial-export-python",e)}(t)},{default:f(()=>a[16]||(a[16]=[I(" Export Python ")])),_:2,__:[16]},1032,["onClick"])]),_:2},1024)]),default:f(()=>[k(N,{size:"small",class:"btn-success",onClick:a[1]||(a[1]=T(()=>{},["stop"]))},{default:f(()=>[a[14]||(a[14]=I(" Export ")),k(b(o))]),_:1,__:[14]})]),_:2},1024),"running"===t.status?(v(),p(N,{key:11,size:"small",danger:"",onClick:T(e=>function(e){l("trial-cancelled",e)}(t),["stop"])},{default:f(()=>a[17]||(a[17]=[I(" Cancel ")])),_:2,__:[17]},1032,["onClick"])):(v(),p(N,{key:12,size:"small",danger:"",onClick:T(e=>function(e){l("trial-deleted",e)}(t),["stop"])},{default:f(()=>a[18]||(a[18]=[I(" Delete ")])),_:2,__:[18]},1032,["onClick"]))])):h("",!0)];var s,i}),_:1},8,["columns","data-source"])])}}}),[["__scopeId","data-v-6411c7ea"]]),Dt={class:"trials-view full-width"},Ft={class:"page-header"},Lt={class:"header-actions"},Nt={class:"main-content"},At={key:0,class:"loading-state"},Ut={key:1,class:"empty-state"},Ot={key:2,class:"trials-table-wrapper"},Rt={key:0,class:"monitoring-content"},qt={key:1,class:"monitoring-placeholder"},Bt=a(r({__name:"TrialsView",setup(e){const a=N(),t=A(),l=F(),s=d(!1),n=d(!0),o=d(null),r=d(null),u=d(!1),_=d(!1),C=d(null),x=d(null),w=d(),T=c(()=>a.isLoading),S=c(()=>[...a.trials]),$=c(()=>t.hasAnyApiKeys||t.isProviderEnabled("ollama-chat")||t.isProviderEnabled("ollama-generate"));function E(e){e.name,e.id,r.value=e,u.value=!0}function z(e){}function j(e){"running"===e.status||"pending"===e.status?E(e):o.value=e}function M(){n.value=!0,s.value=!0}function D(){n.value=!1,s.value=!0}async function U(e){try{await a.executeTrial(e.id),e.id,E(e)}catch(t){console.error("Failed to start trial:",t),alert("Failed to start trial: "+(t instanceof Error?t.message:"Unknown error"))}}async function B(e){try{await a.pauseTrial(e.id),e.id}catch(t){console.error("Failed to pause trial:",t),alert("Failed to pause trial")}}async function V(e){try{await a.executeTrial(e.id),e.id}catch(t){console.error("Failed to resume trial:",t),alert("Failed to resume trial")}}async function K(e){try{await a.cancelTrial(e.id),e.id}catch(t){console.error("Failed to cancel trial:",t),alert("Failed to cancel trial")}}async function J(e){await W(e)}async function Y(e){alert("Data export functionality coming soon")}async function W(e){try{const{PythonExportService:a}=await i(async()=>{const{PythonExportService:e}=await import("./APICallDetailModal-BGCLw6Ck.js").then(e=>e.p);return{PythonExportService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]),import.meta.url),t=a.validateTrialForExport(e);if(!t.valid)return void alert(`Cannot export trial:\n${t.errors.join("\n")}`);C.value=e,_.value=!0}catch(a){console.error("Python export failed:",a),alert(`Export failed: ${a instanceof Error?a.message:String(a)}`)}}function H(e){}function G(e){x.value=e,s.value=!0}async function Q(e){if(confirm(`Are you sure you want to delete "${e.name}"? This action cannot be undone.`))try{await a.deleteTrial(e.id)}catch(t){console.error("Failed to delete trial:",t),alert("Failed to delete trial")}}function X(e){}async function Z(e){await new Promise(e=>setTimeout(e,100));let a=S.value.find(a=>a.id===e),t=0;for(;!a&&t<5;)await new Promise(e=>setTimeout(e,200)),a=S.value.find(a=>a.id===e),t++;a?(r.value=a,u.value=!0):console.warn("Could not find trial for monitoring:",e)}function ee(e){e.id,C.value=e,_.value=!0}function ae(){}return P(async()=>{await a.initialize();const e=l.query.designId;e&&(w.value=e,s.value=!0)}),(e,a)=>{const t=m("a-button"),l=m("a-alert"),i=m("a-spin"),d=m("a-empty"),c=m("a-modal");return v(),y("div",Dt,[g("div",Ft,[a[8]||(a[8]=g("div",{class:"header-content"},[g("h1",null,"Trials"),g("p",{class:"description"}," Systematic testing of LLM models with complete reproducibility ")],-1)),g("div",Lt,[k(t,{type:"primary",size:"default",disabled:!$.value,onClick:M},{default:f(()=>a[6]||(a[6]=[I(" Create Trial (Simple) ")])),_:1,__:[6]},8,["disabled"]),k(t,{size:"default",disabled:!$.value,onClick:D,class:"classic-button"},{default:f(()=>a[7]||(a[7]=[I(" Create Trial (Advanced) ")])),_:1,__:[7]},8,["disabled"])])]),$.value?h("",!0):(v(),p(l,{key:0,type:"warning",message:"No LLM providers configured",description:"Add keys for external APIs (local Ollama does not need keys) or enable Ollama provider.","show-icon":"",class:"warning-banner",action:""},{action:f(()=>[k(b(L),{to:"/settings"},{default:f(()=>[k(t,{size:"small",type:"primary"},{default:f(()=>a[9]||(a[9]=[I(" Go to Settings ")])),_:1,__:[9]})]),_:1})]),_:1})),g("div",Nt,[T.value?(v(),y("div",At,[k(i,{size:"large"},{tip:f(()=>a[10]||(a[10]=[I("Loading trials...")])),_:1})])):0===S.value.length?(v(),y("div",Ut,[k(d,{description:$.value?"No trials yet":"Configure LLM providers to start creating trials"},{image:f(()=>a[11]||(a[11]=[g("div",{style:{color:"#bfbfbf","font-size":"48px"}},"ðŸ§ª",-1)])),default:f(()=>[$.value?(v(),p(t,{key:0,type:"primary",onClick:a[0]||(a[0]=e=>s.value=!0)},{default:f(()=>a[12]||(a[12]=[I(" Create Your First Trial ")])),_:1,__:[12]})):h("",!0)]),_:1},8,["description"])])):(v(),y("div",Ot,[k(Mt,{trials:S.value,"is-loading":T.value,onTrialSelected:E,onTrialStarted:U,onTrialPaused:B,onTrialResumed:V,onTrialCancelled:K,onTrialExported:J,onTrialDuplicated:G,onTrialDeleted:Q,onTrialViewed:j,onTrialExportData:Y,onTrialExportPython:W,onStatusFilterChanged:z},null,8,["trials","is-loading"])]))]),k(c,{open:u.value,"onUpdate:open":a[1]||(a[1]=e=>u.value=e),title:`Live Progress: ${r.value?.name||"Trial"}`,width:"95vw",footer:null,"body-style":{padding:0,height:"90vh",overflow:"auto"},"destroy-on-close":!0,centered:!0},{default:f(()=>[r.value?(v(),y("div",Rt,[k(mt,{"trial-id":r.value.id},null,8,["trial-id"])])):(v(),y("div",qt,[k(d,{description:"No trial selected for monitoring"})]))]),_:1},8,["open","title"]),s.value&&!n.value?(v(),p(O,{key:1,trialToDuplicate:x.value,initialDesignId:w.value,onClose:a[2]||(a[2]=e=>{s.value=!1,x.value=null,w.value=void 0}),onCreated:X},null,8,["trialToDuplicate","initialDesignId"])):h("",!0),s.value&&n.value?(v(),p(xa,{key:2,initialDesignId:w.value,onClose:a[3]||(a[3]=e=>{s.value=!1,w.value=void 0}),onCreated:X,onCreatedAndStarted:Z,onExportTrial:ee},null,8,["initialDesignId"])):h("",!0),o.value?(v(),p(R,{key:3,trial:o.value,onClose:a[4]||(a[4]=e=>o.value=null),onUpdated:ae},null,8,["trial"])):h("",!0),_.value&&C.value?(v(),p(q,{key:4,trial:C.value,onClose:a[5]||(a[5]=e=>{_.value=!1,C.value=null}),onExported:H},null,8,["trial"])):h("",!0)])}}}),[["__scopeId","data-v-609f02a5"]]);export{Bt as default};

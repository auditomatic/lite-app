import{a as p}from"./index-nY7SO6jw.js";async function r(t,o={}){var i,u;const m=`http://localhost:11434${t}`,s=window.location.protocol==="https:",n=o.timeout||3e4,l=new AbortController,c=setTimeout(()=>l.abort(),n);try{const a=await fetch(m,{...o,signal:l.signal,headers:{"Content-Type":"application/json",...o.headers}});return clearTimeout(c),a}catch(a){clearTimeout(c);const e=new Error;throw e.isHttps=s,a.name==="AbortError"?(e.type="timeout",e.message="Request to Ollama timed out",e.details=`The request took longer than ${n/1e3} seconds`):(i=a.message)!=null&&i.includes("Failed to fetch")||(u=a.message)!=null&&u.includes("NetworkError")?s?(e.type="cors",e.message="Cannot connect to Ollama from HTTPS site",e.details="Browser security prevents HTTPS sites from accessing local HTTP services. To use Ollama: 1) Download the desktop app, 2) Run Auditomatic locally, or 3) Configure Ollama with OLLAMA_ORIGINS=*"):(e.type="network",e.message="Cannot connect to Ollama",e.details="Make sure Ollama is running on your computer (http://localhost:11434)"):(e.type="unknown",e.message=a.message||"Unknown error connecting to Ollama",e.details=a.stack),p.warn("Ollama fetch error",{type:e.type,endpoint:t,isHttps:s,originalError:a.message}),e}}async function g(){try{return{available:(await r("/api/tags",{timeout:5e3})).ok}}catch(t){return{available:!1,error:t}}}async function f(){try{const o=await fetch("http://localhost:11434/api/tags",{method:"GET",headers:{Accept:"application/json"}});return{hasIssue:!1}}catch{return{hasIssue:!0,error:"Either Ollama is not running or CORS is not properly configured. Ensure Ollama is running and add OLLAMA_ORIGINS=* to your Ollama service configuration."}}}async function w(){const t=await r("/api/tags");if(!t.ok)throw new Error(`Failed to fetch models: ${t.status} ${t.statusText}`);return t.json()}async function y(t){const o=await r("/api/delete",{method:"DELETE",body:JSON.stringify({name:t})});if(!o.ok)throw new Error(`Failed to delete model: ${o.status} ${o.statusText}`)}export{g as checkOllamaConnection,y as deleteOllamaModel,f as detectOllamaIssue,w as fetchOllamaModels,r as ollamaFetch};

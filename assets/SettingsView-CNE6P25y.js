import{f as ie,aA as Me,aq as Pe,a6 as ne,r as K,c as de,p as L,w as ye,t as be,ai as ve,D as B,h as f,i as t,e as J,v as se,A as _,ae,B as E,G as ue,y as ce,x as W,z as F,F as pe,C as fe,aB as Te,aC as Re,j as c,R as me,a as M,k as le,u as ge,af as R,aD as Ee,aE as oe,o as De,ah as q,d as X,aF as Ie}from"./index-BjcyMJf8.js";const Ue={class:"secure-api-keys-section"},Fe={class:"section-header"},Ke={class:"security-overview"},Oe={class:"security-status"},_e={class:"status-text"},Le={class:"global-security-settings"},Ne={class:"default-mode-display"},Be={class:"current-default"},Ve={class:"mode-icon"},qe={class:"mode-text"},ze={class:"mode-description"},Ge={key:0,class:"setup-prompt"},je={class:"security-dashboard"},Je={class:"dashboard-cards"},We={class:"security-card encrypted"},Ye={class:"card-value"},He={class:"security-card session"},Ze={class:"card-value"},Qe={class:"security-card plaintext"},Xe={class:"card-value"},et={key:0,class:"unlock-prompt"},tt={key:0,class:"no-providers"},st={key:1,class:"providers-grid"},nt={class:"provider-header"},ot={class:"provider-status"},at={class:"provider-info"},it={class:"endpoints-count"},lt={key:0,class:"base-url"},rt={class:"security-mode-section"},ut={class:"api-key-section"},dt=["for"],ct={key:0,class:"secure-key-input"},mt={class:"input-group"},pt={key:0,class:"locked-message"},yt={key:1,class:"legacy-key-input"},ft={class:"input-group"},vt={class:"key-actions"},gt={class:"security-info"},bt={key:0,class:"security-note encrypted"},kt={key:0},St={key:1},wt={key:1,class:"security-note session"},ht={key:0},xt={key:1},Ct={key:2,class:"security-note plaintext"},$t={key:3,class:"security-note plaintext"},At=ie({__name:"SecureApiKeysSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=Me(),n=Pe(),r=ne({}),y=ne({}),$=ne({}),P=K(!1),p=K(!1),O=K(!1),v=K(!1),k=K(!1),h=K(""),l=K(null),S=K(null),D=K(null),I=de(()=>{var b;if(!P.value)return[];const i=L.getAllGroups(),o=[];for(const C of i){if(C==="deterministic")continue;const V=L.getProvidersInGroup(C);if(V.length===0)continue;const Q=V[0];if(!L.requiresApiKey(Q.id))continue;const te=w.providers.get(C),u=C.charAt(0).toUpperCase()+C.slice(1);o.push({id:C,name:u,hasApiKey:!!w.getApiKey(C)||m(C),enabled:(te==null?void 0:te.enabled)??!0,endpoints:V.map(G=>G.id),baseUrl:(te==null?void 0:te.baseUrl)||((b=Q.api)==null?void 0:b.baseUrl)||""})}return o}),x=de(()=>n.securityStatus.value),z=de(()=>{const i=localStorage.getItem("v3-settings");if(!i)return{};try{const o=JSON.parse(i);return n.secureStorage.detectPlaintextKeys(o)}catch{return{}}});function N(){return n.hasSetupApiKeySecurity()?!1:(v.value=!0,!0)}function T(i){return n.getEffectiveProviderMode(i)}function Y(i){switch(T(i)){case"encrypted":return"🔒 Encrypted";case"session":return"⚠️ Session";case"plaintext":return"📝 Plaintext";default:return"📝 Plaintext"}}function Z(i){const o=T(i);return m(i)||!!w.getApiKey(i)?o==="encrypted"&&!n.isUnlocked.value?"Locked":"Configured":"Not configured"}function m(i){return n.hasApiKey(i)}function A(i){return T(i)==="encrypted"?n.hasApiKey(i)&&!n.isUnlocked.value:!1}function U(i){const o=m(i),b=A(i);return b&&o?"Click to unlock and view encrypted key":b&&!o?"Click to unlock and enter API key":o?"Key configured (hidden)":"Enter API key"}function a(){const{lockedProviderCount:i,sessionProviderCount:o,plaintextProviderCount:b}=x.value,C=i+o+b;return C===0?"none":b===C?"low":i>0?"high":"medium"}function e(){switch(a()){case"high":return"🔒";case"medium":return"⚠️";case"low":return"📝";default:return"❓"}}function s(){const{lockedProviderCount:i,sessionProviderCount:o,plaintextProviderCount:b}=x.value;if(i+o+b===0)return"No API keys configured";const V=[];return i>0&&V.push(`${i} encrypted`),o>0&&V.push(`${o} session-only`),b>0&&V.push(`${b} plaintext`),V.join(", ")}function d(i){switch(i){case"encrypted":return"🔒";case"session":return"⚠️";case"plaintext":return"📝";default:return"📝"}}function g(i){switch(i){case"encrypted":return"Encrypted";case"session":return"Session Only";case"plaintext":return"Plaintext";default:return"Plaintext"}}function j(i){switch(i){case"encrypted":return"Keys protected with Auditomatic local store password";case"session":return"Keys stored in memory only";case"plaintext":return"Keys stored without encryption";default:return"Keys stored without encryption"}}function H(i){$[i]=!$[i]}function re(i){A(i)&&(k.value=!0)}async function ke(i,o){if(o==="encrypted"&&!n.hasMasterPassword.value){v.value=!0;return}O.value=!0;try{const b=await n.setProviderSecurityMode(i,o);if(!b.success){B.error(`Failed to change security mode: ${b.error}`);return}r[i]="",y[i]="",B.success(`Security mode changed to ${o}`),await ve()}catch(b){const C=b instanceof Error?b.message:"Unknown error";B.error(`Failed to change security mode: ${C}`)}finally{O.value=!1}}async function Se(i){const o=y[i];if(!o||N())return;const b=T(i);if(b==="encrypted"&&!n.isUnlocked.value){k.value=!0,S.value=i,D.value=o;return}p.value=!0;try{const C=await n.setApiKey(i,o,b);C.success?(B.success("API key saved successfully"),y[i]=""):B.error(`Failed to save API key: ${C.error}`)}catch(C){const V=C instanceof Error?C.message:"Unknown error";B.error(`Failed to save API key: ${V}`)}finally{p.value=!1}}async function we(i){const o=r[i];if(o){p.value=!0;try{w.setApiKey(i,o),B.success("API key saved successfully"),r[i]=""}finally{p.value=!1}}}async function he(i){try{await n.clearApiKey(i),w.setApiKey(i,""),r[i]="",y[i]="",B.success("API key cleared")}catch(o){const b=o instanceof Error?o.message:"Unknown error";B.error(`Failed to clear API key: ${b}`)}}function xe(){n.lock(),B.info("All encrypted keys have been locked")}async function Ce(i){var o,b,C;try{const V=await n.unlock(i.password,i.rememberSession);if(V.success){if(k.value=!1,(o=l.value)==null||o.handleUnlockSuccess(),B.success("API keys unlocked successfully"),S.value&&D.value){const Q=S.value,te=D.value;S.value=null,D.value=null,p.value=!0;try{const u=T(Q),G=await n.setApiKey(Q,te,u);G.success?(B.success("API key saved successfully"),y[Q]=""):B.error(`Failed to save API key: ${G.error}`)}finally{p.value=!1}}}else(b=l.value)==null||b.handleUnlockFailure(V.error||"Invalid password")}catch(V){const Q=V instanceof Error?V.message:"Unknown error";(C=l.value)==null||C.handleUnlockFailure(Q)}}function $e(){me.confirm({title:"Reset Auditomatic Local Store Password",content:"This will delete all encrypted API keys. You will need to re-enter them. Continue?",okText:"Yes, Reset",okType:"danger",onOk:async()=>{try{localStorage.removeItem("v3-security"),window.location.reload()}catch{B.error("Failed to reset password")}}})}async function Ae(i){try{if(M.info("handleSetupSuccess called with:",i),i.mode==="encrypted"&&i.password){const C=await n.setupMasterPassword(i.password);if(!C.success){B.error(`Failed to setup Auditomatic local store password: ${C.error}`);return}M.info("Auditomatic local store password setup complete")}const o=n.setupGlobalSecurity(i.mode,i.password);if(!o.success){B.error(`Failed to setup security: ${o.error}`);return}M.info("Global security setup complete");const b=localStorage.getItem("v3-security");M.info("Verification - localStorage v3-security:",b),v.value=!1,B.success(`Security setup complete! Default mode: ${i.mode}`),await ve()}catch(o){const b=o instanceof Error?o.message:"Unknown error";M.error("Setup failed:",o),B.error(`Setup failed: ${b}`)}}return ye(()=>I.value,i=>{i.forEach(o=>{o.id in r||(r[o.id]=""),o.id in y||(y[o.id]=""),o.id in $||($[o.id]=!1)})},{immediate:!0}),be(async()=>{await L.waitForReady(),P.value=!0;const i=z.value;Object.keys(i).length>0&&!n.hasMasterPassword.value&&ve(()=>{B.info({content:`${Object.keys(i).length} API keys found in insecure storage. Consider setting up encryption for better security.`,duration:10})})}),(i,o)=>{const b=ce("a-button"),C=ce("a-select-option"),V=ce("a-select"),Q=ce("a-input-password"),te=ce("a-tooltip");return c(),f("div",Ue,[t("div",Fe,[o[5]||(o[5]=t("h2",null,"API Keys",-1)),t("div",Ke,[t("div",Oe,[t("span",{class:ae(["security-indicator",a()])},E(e()),3),t("span",_e,E(s()),1)]),ue(n).isUnlocked.value?(c(),se(b,{key:0,size:"small",onClick:xe},{default:W(()=>o[4]||(o[4]=[F(" Lock All ")])),_:1,__:[4]})):_("",!0)])]),o[28]||(o[28]=t("p",{class:"section-description"}," Configure API keys with multiple security options. Choose the right protection level for each provider. ",-1)),t("div",Le,[o[8]||(o[8]=t("h3",null,"🔧 Default Security Mode",-1)),t("div",Ne,[t("div",Be,[t("span",Ve,E(d(ue(n).getDefaultSecurityMode())),1),t("span",qe,E(g(ue(n).getDefaultSecurityMode())),1),t("span",ze,E(j(ue(n).getDefaultSecurityMode())),1)]),J(b,{onClick:o[0]||(o[0]=u=>v.value=!0)},{default:W(()=>o[6]||(o[6]=[F("Change Default")])),_:1,__:[6]})]),o[9]||(o[9]=t("p",{class:"default-explanation"}," New API keys will use this security mode by default. You can override for individual providers below. ",-1)),ue(n).hasSetupApiKeySecurity()?_("",!0):(c(),f("p",Ge,o[7]||(o[7]=[t("strong",null,"First time?",-1),F(' Click "Change Default" to set up your security preferences. ')])))]),t("div",je,[t("div",Je,[t("div",We,[o[10]||(o[10]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"🔒"),t("h4",null,"Encrypted")],-1)),t("div",Ye,E(x.value.lockedProviderCount),1),o[11]||(o[11]=t("div",{class:"card-label"},"Protected keys",-1))]),t("div",He,[o[12]||(o[12]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"⚠️"),t("h4",null,"Session Only")],-1)),t("div",Ze,E(x.value.sessionProviderCount),1),o[13]||(o[13]=t("div",{class:"card-label"},"Memory only",-1))]),t("div",Qe,[o[14]||(o[14]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"📝"),t("h4",null,"Plaintext")],-1)),t("div",Xe,E(x.value.plaintextProviderCount),1),o[15]||(o[15]=t("div",{class:"card-label"},"Unsecured keys",-1))])]),!ue(n).isUnlocked.value&&x.value.lockedProviderCount>0?(c(),f("div",et,[J(b,{type:"primary",onClick:o[1]||(o[1]=u=>k.value=!0)},{default:W(()=>[F(" Unlock "+E(x.value.lockedProviderCount)+" Encrypted Key"+E(x.value.lockedProviderCount===1?"":"s"),1)]),_:1})])):_("",!0)]),I.value.length===0?(c(),f("div",tt,o[16]||(o[16]=[t("p",null,"No providers requiring API keys are currently configured.",-1)]))):(c(),f("div",st,[(c(!0),f(pe,null,fe(I.value,u=>(c(),f("div",{key:u.id,class:"provider-card"},[t("div",nt,[t("h3",null,E(u.name),1),t("div",ot,[t("span",{class:ae(["security-badge",T(u.id)])},E(Y(u.id)),3),t("span",{class:ae(["status",{"has-key":u.hasApiKey}])},E(Z(u.id)),3)])]),t("div",at,[t("p",it,E(u.endpoints.length)+" endpoint(s) available",1),u.baseUrl?(c(),f("p",lt,"Base URL: "+E(u.baseUrl),1)):_("",!0)]),t("div",rt,[o[20]||(o[20]=t("label",null,"Security Mode:",-1)),J(V,{value:T(u.id),onChange:G=>ke(u.id,G),class:"security-mode-select",disabled:O.value},{default:W(()=>[J(C,{value:"encrypted"},{default:W(()=>o[17]||(o[17]=[F(" 🔒 Encrypted (Auditomatic local store password required) ")])),_:1,__:[17]}),J(C,{value:"session"},{default:W(()=>o[18]||(o[18]=[F(" ⚠️ Session Only (Lost on browser close) ")])),_:1,__:[18]}),J(C,{value:"plaintext"},{default:W(()=>o[19]||(o[19]=[F(" 📝 Plaintext (Not recommended) ")])),_:1,__:[19]})]),_:2},1032,["value","onChange","disabled"])]),t("div",ut,[t("label",{for:`api-key-${u.id}`},"API Key:",8,dt),T(u.id)!=="plaintext"?(c(),f("div",ct,[t("div",mt,[J(Q,{id:`api-key-${u.id}`,value:y[u.id],"onUpdate:value":G=>y[u.id]=G,type:$[u.id]?"text":"password",placeholder:U(u.id),class:"api-key-input",disabled:!1,onFocus:G=>re(u.id)},null,8,["id","value","onUpdate:value","type","placeholder","onFocus"]),J(te,{title:A(u.id)?"Unlock to manage key":$[u.id]?"Hide":"Show"},{default:W(()=>[J(b,{onClick:G=>H(u.id),class:"toggle-visibility",disabled:A(u.id)},{default:W(()=>[F(E($[u.id]?"🙈":"👁️"),1)]),_:2},1032,["onClick","disabled"])]),_:2},1032,["title"])]),A(u.id)?(c(),f("div",pt," 🔒 Key is encrypted and locked - click field to unlock ")):_("",!0)])):(c(),f("div",yt,[t("div",ft,[J(Q,{id:`api-key-${u.id}`,value:r[u.id],"onUpdate:value":G=>r[u.id]=G,type:$[u.id]?"text":"password",placeholder:u.hasApiKey?"Key configured (hidden)":"Enter API key",class:"api-key-input"},null,8,["id","value","onUpdate:value","type","placeholder"]),J(b,{onClick:G=>H(u.id),class:"toggle-visibility"},{default:W(()=>[F(E($[u.id]?"🙈":"👁️"),1)]),_:2},1032,["onClick"])])])),t("div",vt,[T(u.id)!=="plaintext"?(c(),se(b,{key:0,onClick:G=>Se(u.id),disabled:!y[u.id]||p.value,loading:p.value,type:"primary"},{default:W(()=>o[21]||(o[21]=[F(" Save ")])),_:2,__:[21]},1032,["onClick","disabled","loading"])):(c(),se(b,{key:1,onClick:G=>we(u.id),disabled:!r[u.id]||p.value,loading:p.value,type:"primary"},{default:W(()=>o[22]||(o[22]=[F(" Save ")])),_:2,__:[22]},1032,["onClick","disabled","loading"])),u.hasApiKey||m(u.id)?(c(),se(b,{key:2,onClick:G=>he(u.id),disabled:p.value,class:"clear-button"},{default:W(()=>o[23]||(o[23]=[F(" Clear ")])),_:2,__:[23]},1032,["onClick","disabled"])):_("",!0)]),t("div",gt,[T(u.id)==="encrypted"?(c(),f("div",bt,[o[24]||(o[24]=F(" 🛡️ ")),u.hasApiKey||m(u.id)?(c(),f("span",kt,"Key encrypted with your Auditomatic local store password")):(c(),f("span",St,"Key will be encrypted with your Auditomatic local store password"))])):T(u.id)==="session"?(c(),f("div",wt,[o[25]||(o[25]=F(" 🕐 ")),u.hasApiKey||m(u.id)?(c(),f("span",ht,"Key stored in memory only - lost on browser refresh")):(c(),f("span",xt,"Key will be stored in memory only - lost on browser refresh"))])):T(u.id)==="plaintext"&&(u.hasApiKey||m(u.id))?(c(),f("div",Ct,o[26]||(o[26]=[F(" ⚠️ "),t("span",null,"Key stored in plaintext - vulnerable to attacks",-1)]))):T(u.id)==="plaintext"?(c(),f("div",$t,o[27]||(o[27]=[F(" 📝 "),t("span",null,"Key will be stored in plaintext (not recommended)",-1)]))):_("",!0)])])]))),128))])),J(Te,{open:v.value,"migration-keys":z.value,onClose:o[2]||(o[2]=u=>v.value=!1),onSuccess:Ae},null,8,["open","migration-keys"]),J(Re,{open:k.value,"locked-provider-count":x.value.lockedProviderCount,"password-hint":h.value,ref_key:"unlockModalRef",ref:l,onUnlock:Ce,onReset:$e,onClose:o[3]||(o[3]=u=>k.value=!1)},null,8,["open","locked-provider-count","password-hint"])])}}}),Mt=le(At,[["__scopeId","data-v-5d9e8325"]]),Pt={class:"preferences-section"},Tt={class:"preferences-content"},Rt={class:"preference-item"},Et={class:"preference-item"},Dt={class:"checkbox-label"},It=ie({__name:"PreferencesSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=ge(),n=ee,r=ne({theme:"system",enableEnvironmentalCosts:!1});ye(()=>w.settings.core.preferences.value,P=>{r.theme=P.theme,r.enableEnvironmentalCosts=P.enableEnvironmentalCosts},{immediate:!0});async function y(){var p,O;const P=await w.settings.core.setTheme(r.theme);P.ok?(p=n.onStatusMessage)==null||p.call(n,"Theme updated","success"):(O=n.onStatusMessage)==null||O.call(n,`Failed to update theme: ${P.error.message}`,"error")}async function $(){var p,O;const P=await w.settings.core.setEnvironmentalCosts(r.enableEnvironmentalCosts);P.ok?(p=n.onStatusMessage)==null||p.call(n,"Environmental costs setting updated","success"):(O=n.onStatusMessage)==null||O.call(n,`Failed to update setting: ${P.error.message}`,"error")}return(P,p)=>(c(),f("div",Pt,[p[5]||(p[5]=t("h2",null,"Preferences",-1)),p[6]||(p[6]=t("p",{class:"tab-description"},"Configure application behavior and appearance.",-1)),t("div",Tt,[t("div",Rt,[p[3]||(p[3]=t("label",{for:"theme-select"},"Theme:",-1)),R(t("select",{id:"theme-select","onUpdate:modelValue":p[0]||(p[0]=O=>r.theme=O),onChange:y,class:"preference-select"},p[2]||(p[2]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)]),544),[[Ee,r.theme]])]),t("div",Et,[t("label",Dt,[R(t("input",{type:"checkbox","onUpdate:modelValue":p[1]||(p[1]=O=>r.enableEnvironmentalCosts=O),onChange:$,class:"preference-checkbox"},null,544),[[oe,r.enableEnvironmentalCosts]]),p[4]||(p[4]=F(" Show environmental cost estimates "))])])])]))}}),Ut=le(It,[["__scopeId","data-v-5569800c"]]),Ft={class:"performance-recorder"},Kt={class:"recorder-controls"},Ot=["disabled"],_t=["disabled"],Lt=["disabled"],Nt={class:"recorder-status"},Bt={key:0,class:"status recording"},Vt={key:1,class:"status ready"},qt={key:2,class:"status idle"},zt={key:0,class:"export-result"},Gt=ie({__name:"PerformanceRecorder",setup(ee){const w=K(!1),n=K(!1),r=K([]),y=K(""),$=K(0),P=K(0),p=de(()=>r.value.length>0);let O=null,v=null,k=null;function h(){w.value?S():l()}function l(){if(w.value=!0,$.value=Date.now(),P.value=0,r.value=[],O=window.setInterval(D,100),v=window.setInterval(()=>{P.value=Math.floor((Date.now()-$.value)/1e3)},1e3),"PerformanceObserver"in window)try{k=new PerformanceObserver(m=>{const A=m.getEntries(),U={};if(A.forEach(a=>{a.entryType==="paint"&&(U[a.name.replace("-","")]=a.startTime),a.entryType==="largest-contentful-paint"&&(U.largestContentfulPaint=a.startTime)}),r.value.length>0){const a=r.value[r.value.length-1];a.paint={...a.paint,...U}}}),k.observe({entryTypes:["paint","largest-contentful-paint"]})}catch{M.warn("Performance Observer not fully supported")}M.info("🔴 Performance recording started")}function S(){w.value=!1,O&&(clearInterval(O),O=null),v&&(clearInterval(v),v=null),k&&(k.disconnect(),k=null),M.info(`🟡 Performance recording stopped. Collected ${r.value.length} samples`)}function D(){try{const m={timestamp:Date.now(),timing:I(),network:x(),userAgent:navigator.userAgent,url:window.location.href,customMetrics:z()};if("memory"in performance){const A=performance.memory;m.memory={used:A.usedJSHeapSize,total:A.totalJSHeapSize,limit:A.jsHeapSizeLimit}}r.value.push(m)}catch(m){M.warn("Failed to collect performance sample:",m)}}function I(){const m=performance.getEntriesByType("navigation")[0];return m?{navigation:m.loadEventEnd-m.fetchStart,domContentLoaded:m.domContentLoadedEventEnd-m.fetchStart,loadComplete:m.loadEventEnd-m.fetchStart}:{navigation:performance.now(),domContentLoaded:0,loadComplete:0}}function x(){const m=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return m?{downlink:m.downlink,effectiveType:m.effectiveType,rtt:m.rtt}:{}}function z(){const m={};m.domNodes=document.querySelectorAll("*").length,m.scripts=document.querySelectorAll("script").length,m.stylesheets=document.querySelectorAll('link[rel="stylesheet"]').length,window.__VUE__&&(m.vueVersion=window.__VUE__.version),window.React&&(m.reactVersion=window.React.version);const A=Array.from(document.querySelectorAll("script[src]"));return m.scriptSources=A.length,m}function N(){const m=[];if(r.value.length===0)return m;const A=r.value,U=A[A.length-1];if(U.memory){const a=U.memory.used/1048576,e=U.memory.limit/(1024*1024),s=a/e*100;s>80?m.push({type:"memory",severity:"critical",description:`Memory usage is ${s.toFixed(1)}% of limit`,value:a,recommendation:"Clear caches, reduce data in memory, check for memory leaks"}):s>60&&m.push({type:"memory",severity:"high",description:`Memory usage is ${s.toFixed(1)}% of limit`,value:a,recommendation:"Monitor memory usage, consider data pagination"})}return U.timing.navigation>3e3&&m.push({type:"timing",severity:"high",description:"Slow page load time",value:U.timing.navigation,recommendation:"Optimize bundle size, lazy load components, check network"}),U.network.rtt&&U.network.rtt>200&&m.push({type:"network",severity:"medium",description:"High network latency",value:U.network.rtt,recommendation:"Check network connection, consider CDN, reduce API calls"}),m}function T(){var m,A;n.value=!0;try{const U=N(),a={recordingInfo:{startTime:new Date($.value).toISOString(),duration:P.value,sampleCount:r.value.length,url:window.location.href,userAgent:navigator.userAgent},performanceSummary:{avgMemoryUsage:r.value.filter(e=>e.memory).reduce((e,s)=>e+s.memory.used/(1024*1024),0)/r.value.filter(e=>e.memory).length,totalDOMNodes:(m=r.value[r.value.length-1])==null?void 0:m.customMetrics.domNodes,networkInfo:(A=r.value[r.value.length-1])==null?void 0:A.network},issues:U,topBottlenecks:U.sort((e,s)=>Y(s.severity)-Y(e.severity)).slice(0,5),detailedSamples:r.value.slice(-10),recommendations:[...new Set(U.map(e=>e.recommendation))]};y.value=JSON.stringify(a,null,2),M.info("📊 Performance data exported")}catch(U){M.error("Failed to export performance data:",U),y.value=`Export Error: ${U}`}finally{n.value=!1}}function Y(m){return{critical:4,high:3,medium:2,low:1}[m]||0}function Z(){r.value=[],y.value="",P.value=0,M.info("🗑️ Performance data cleared")}return De(()=>{w.value&&S()}),(m,A)=>(c(),f("div",Ft,[t("div",Kt,[t("button",{onClick:h,class:ae(["record-btn",{recording:w.value}]),disabled:n.value},E(w.value?"Stop Recording":"Start Recording"),11,Ot),t("button",{onClick:T,disabled:!p.value||n.value,class:"export-btn"},E(n.value?"Exporting...":"Export Logs"),9,_t),t("button",{onClick:Z,disabled:!p.value||w.value,class:"clear-btn"}," Clear ",8,Lt)]),t("div",Nt,[w.value?(c(),f("div",Bt," 🔴 Recording... ("+E(P.value)+"s) ",1)):p.value?(c(),f("div",Vt," ✅ "+E(r.value.length)+" samples recorded ",1)):(c(),f("div",qt," ⏸️ Ready to record "))]),y.value?(c(),f("div",zt,[A[1]||(A[1]=t("h3",null,"Performance Data Ready",-1)),R(t("textarea",{"onUpdate:modelValue":A[0]||(A[0]=U=>y.value=U),readonly:"",rows:"10",placeholder:"Exported performance data will appear here..."},null,512),[[q,y.value]]),A[2]||(A[2]=t("div",{class:"copy-instructions"}," Copy this data and paste it to Claude for analysis ",-1))])):_("",!0)]))}}),jt=le(Gt,[["__scopeId","data-v-48cb70ff"]]),Jt={class:"advanced-section"},Wt={key:0},Yt={key:1},Ht={class:"sub-tabs"},Zt=["onClick"],Qt={class:"sub-tab-content"},Xt={key:0,class:"provider-settings"},es={key:0,class:"no-providers"},ts={key:0},ss={key:1},ns={key:1,class:"provider-cards"},os={key:0,class:"provider-advanced-card"},as={class:"setting-group"},is=["onUpdate:modelValue","onChange"],ls={class:"setting-group"},rs=["onUpdate:modelValue","onChange"],us={class:"setting-group"},ds=["onUpdate:modelValue","onChange"],cs={class:"setting-group"},ms=["onUpdate:modelValue","onChange"],ps={key:1,class:"execution-settings"},ys={class:"settings-grid"},fs={class:"setting-group"},vs={class:"setting-group"},gs={class:"setting-group"},bs={class:"setting-group"},ks={class:"setting-group"},Ss={class:"setting-group"},ws={class:"setting-group"},hs={key:2,class:"discovery-settings"},xs={class:"settings-grid"},Cs={class:"setting-group"},$s={class:"setting-group"},As={class:"setting-group"},Ms={class:"setting-group"},Ps={key:3,class:"coordination-settings"},Ts={class:"settings-grid"},Rs={class:"setting-group"},Es={class:"setting-group"},Ds={class:"setting-group"},Is={class:"setting-group"},Us={key:4,class:"performance-settings"},Fs={class:"settings-grid"},Ks={class:"setting-group"},Os={class:"setting-group"},_s={class:"setting-group"},Ls={class:"setting-group"},Ns={key:5,class:"system-settings"},Bs=ie({__name:"AdvancedSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=ge(),n=ee,r=[{id:"providers",label:"Provider Settings"},{id:"execution",label:"Execution"},{id:"discovery",label:"Discovery"},{id:"coordination",label:"Multi-Tab"},{id:"performance",label:"Performance"},{id:"system",label:"System"}],y=K("providers"),$=K(!1),P=de(()=>{const a=p.value;return a.length>0&&a.every(e=>v[e.id]&&typeof v[e.id].concurrency=="number")}),p=de(()=>{try{const a=L.getAllGroups();M.info("Available group IDs from registry:",a);const e=a.map(s=>{const d=L.getProvidersInGroup(s),g=d.some(j=>L.requiresApiKey(j.id));return{id:s,name:s.charAt(0).toUpperCase()+s.slice(1),requiresApiKey:g,endpoints:d.map(j=>({id:j.id,name:j.name}))}});return M.info("Computed availableProviders:",e),e}catch(a){return M.error("Failed to get available provider groups:",a),[]}}),v=ne((()=>{try{const a=L.getAllGroups();M.info("Initializing provider settings for groups:",a);const e={};return a.forEach(s=>{e[s]={concurrency:2,requestTimeout:30,maxRetries:3,backoffMultiplier:2}}),M.info("Initial provider settings:",e),e}catch(a){return M.error("Failed to initialize provider settings:",a),{}}})());ye(p,async a=>{await L.waitForReady(),M.info("Initializing settings for",a.length,"provider groups"),a.forEach(e=>{if(!v[e.id]){const s=L.getProvidersInGroup(e.id),d=s[0],g=(d==null?void 0:d.execution)||{};M.info(`Initializing settings for provider group ${e.id}:`,{endpoints:s.map(j=>j.id),execution:g}),v[e.id]={concurrency:g.defaultConcurrency||2,requestTimeout:Math.floor((g.timeout||3e4)/1e3),maxRetries:g.maxRetries||3,backoffMultiplier:g.backoffMultiplier||2}}})},{immediate:!0});const k=ne({defaultConcurrency:1,defaultTimeout:120,defaultMaxRetries:3,defaultTemperature:.7,batchSize:1,maxConcurrentBatches:2,progressBufferMs:0}),h=ne({autoDiscoverOnStartup:!0,discoveryInterval:24,discoveryTimeout:60,skipFailedProviders:!1}),l=ne({leaderElectionTimeout:1e3,syncInterval:500,enableBroadcastChannel:!0,enableWebLocks:!0}),S=ne({virtualScrollThreshold:1e3,debounceDelay:300,enableRequestIdleCallback:!0,enableProgressiveRendering:!0});be(async()=>{try{await L.waitForReady();const a=await w.settings.system.getAllSettings(),e=L.getAllGroups();M.info("Loading existing settings from provider registry for",e.length,"provider groups"),e.forEach(s=>{const d=L.getProviderExecutionOverrides(s);if(M.info(`Loading registry overrides for group ${s}:`,d),d&&v[s])d.concurrency!==void 0&&(v[s].concurrency=d.concurrency),d.timeout!==void 0&&(v[s].requestTimeout=Math.floor(d.timeout/1e3)),d.maxRetries!==void 0&&(v[s].maxRetries=d.maxRetries),d.backoffMultiplier!==void 0&&(v[s].backoffMultiplier=d.backoffMultiplier);else if(v[s]){const j=L.getProvidersInGroup(s)[0],H=(j==null?void 0:j.execution)||{};M.info(`No overrides for group ${s}, using provider defaults:`,H),v[s].concurrency=H.defaultConcurrency||2,v[s].requestTimeout=Math.floor((H.timeout||3e4)/1e3),v[s].maxRetries=H.maxRetries||3,v[s].backoffMultiplier=H.backoffMultiplier||2}}),a.execution&&Object.assign(k,a.execution),a.discovery&&Object.assign(h,a.discovery),a.coordination&&Object.assign(l,a.coordination),a.performance&&Object.assign(S,a.performance),$.value=!0}catch(a){M.error("Failed to initialize advanced settings:",a),$.value=!0}});async function D(a,e,s){var d,g;try{switch(await L.waitForReady(),e){case"concurrency":L.setProviderConcurrency(a,s);break;case"requestTimeout":L.setProviderTimeout(a,s*1e3);break;case"maxRetries":L.setProviderMaxRetries(a,s);break;case"backoffMultiplier":L.setProviderBackoffMultiplier(a,s);break;default:throw new Error(`Unknown setting: ${e}`)}(d=n.onStatusMessage)==null||d.call(n,`Updated ${e} for ${a}`,"success")}catch(j){(g=n.onStatusMessage)==null||g.call(n,`Failed to update ${e}: ${j.message}`,"error");const H=L.getProvider(a),re=(H==null?void 0:H.execution)||{};switch(e){case"concurrency":v[a].concurrency=re.defaultConcurrency||2;break;case"requestTimeout":v[a].requestTimeout=Math.floor((re.timeout||3e4)/1e3);break;case"maxRetries":v[a].maxRetries=re.maxRetries||3;break;case"backoffMultiplier":v[a].backoffMultiplier=re.backoffMultiplier||2;break}}}async function I(a,e){var d,g;const s=await w.settings.system.setExecutionSetting(a,e);s.ok?(d=n.onStatusMessage)==null||d.call(n,`Updated ${a}`,"success"):(g=n.onStatusMessage)==null||g.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}async function x(a,e){var d,g;const s=await w.settings.system.setDiscoverySetting(a,e);s.ok?(d=n.onStatusMessage)==null||d.call(n,`Updated ${a}`,"success"):(g=n.onStatusMessage)==null||g.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}async function z(a,e){var d,g;const s=await w.settings.system.setCoordinationSetting(a,e);s.ok?(d=n.onStatusMessage)==null||d.call(n,`Updated ${a}`,"success"):(g=n.onStatusMessage)==null||g.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}async function N(a,e){var d,g;const s=await w.settings.system.setPerformanceSetting(a,e);s.ok?(d=n.onStatusMessage)==null||d.call(n,`Updated ${a}`,"success"):(g=n.onStatusMessage)==null||g.call(n,`Failed to update ${a}: ${s.error.message}`,"error")}function T(){me.confirm({title:"DELETE ALL DATA WARNING",content:`This will delete ALL data including:

• All trials and their results
• All API calls and responses
• All models and configurations
• All variable lists and datasets
• All settings and preferences

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Delete All Data",cancelText:"Cancel",okType:"danger",onOk(){me.confirm({title:"FINAL WARNING",content:`You are about to delete EVERYTHING.

Click "Proceed" to confirm database deletion.`,okText:"Proceed with Deletion",cancelText:"Cancel",okType:"danger",onOk(){Y()}})}})}async function Y(){var a,e;try{await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),(a=n.onStatusMessage)==null||a.call(n,"Database and storage cleared successfully","success"),setTimeout(()=>{window.location.reload()},1500)}catch(s){M.error("Failed to clear database:",s),(e=n.onStatusMessage)==null||e.call(n,`Failed to clear database: ${s}`,"error")}}function Z(){me.confirm({title:"FACTORY RESET WARNING",content:`This will completely reset the application to a fresh state.

This will clear:
• All database data (trials, models, settings, API calls)
• All localStorage data
• All sessionStorage data
• All cookies for this domain
• All cached data and preferences
• All API keys and security settings

The app will be restored to first-run state.

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Reset Everything",cancelText:"Cancel",okType:"danger",onOk(){me.confirm({title:"FINAL FACTORY RESET WARNING",content:`You will lose EVERYTHING.

All data, settings, API keys, and preferences will be permanently deleted.

Click "Proceed" to confirm factory reset.`,okText:"Proceed with Reset",cancelText:"Cancel",okType:"danger",onOk(){m()}})}})}async function m(){var a,e;try{if(await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),A(),await U(),"caches"in window){const s=await caches.keys();await Promise.all(s.map(d=>caches.delete(d)))}(a=n.onStatusMessage)==null||a.call(n,"Factory reset completed - all data cleared","success"),setTimeout(()=>{window.location.reload()},2e3)}catch(s){M.error("Failed to perform factory reset:",s),(e=n.onStatusMessage)==null||e.call(n,`Factory reset failed: ${s}`,"error")}}function A(){const a=document.cookie.split(";");for(let e of a){const s=e.indexOf("="),d=s>-1?e.substr(0,s).trim():e.trim();document.cookie=`${d}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${d}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;`;const g=window.location.hostname;document.cookie=`${d}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${g}`,document.cookie=`${d}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${g}`}}async function U(){if("indexedDB"in window&&indexedDB.databases)try{const a=await indexedDB.databases();await Promise.all(a.map(e=>{if(e.name)return new Promise((s,d)=>{const g=indexedDB.deleteDatabase(e.name);g.onsuccess=()=>s(),g.onerror=()=>d(g.error)})}))}catch(a){M.warn("Could not clear all IndexedDB databases:",a)}}return(a,e)=>(c(),f("div",Jt,[$.value?(c(),f("div",Yt,[e[97]||(e[97]=t("h2",null,"Advanced Settings",-1)),e[98]||(e[98]=t("p",{class:"tab-description"},"Configure advanced settings for providers, execution, and system performance.",-1)),t("div",Ht,[(c(),f(pe,null,fe(r,s=>t("button",{key:s.id,class:ae(["sub-tab",{active:y.value===s.id}]),onClick:d=>y.value=s.id},E(s.label),11,Zt)),64))]),t("div",Qt,[y.value==="providers"?(c(),f("div",Xt,[e[48]||(e[48]=t("h3",null,"Provider-Specific Settings",-1)),e[49]||(e[49]=t("p",{class:"section-description"},"Configure advanced settings for each provider",-1)),P.value?(c(),f("div",ns,[(c(!0),f(pe,null,fe(p.value,s=>(c(),f(pe,{key:s.id},[s&&v[s.id]?(c(),f("div",os,[t("h4",null,E(s.name)+" Group",1),e[47]||(e[47]=t("p",{class:"group-description"},"Settings apply to all endpoints in this provider group",-1)),t("div",as,[e[39]||(e[39]=t("label",null,"Concurrency Limit",-1)),R(t("input",{type:"number","onUpdate:modelValue":d=>v[s.id].concurrency=d,min:"1",max:"100",onChange:d=>{var g;return D(s.id,"concurrency",(g=v[s.id])==null?void 0:g.concurrency)}},null,40,is),[[q,v[s.id].concurrency,void 0,{number:!0}]]),e[40]||(e[40]=t("span",{class:"hint"},"Max parallel requests (1-100)",-1))]),t("div",ls,[e[41]||(e[41]=t("label",null,"Request Timeout (seconds)",-1)),R(t("input",{type:"number","onUpdate:modelValue":d=>v[s.id].requestTimeout=d,min:"10",max:"600",onChange:d=>{var g;return D(s.id,"requestTimeout",(g=v[s.id])==null?void 0:g.requestTimeout)}},null,40,rs),[[q,v[s.id].requestTimeout,void 0,{number:!0}]]),e[42]||(e[42]=t("span",{class:"hint"},"Time before request fails (10-600s)",-1))]),t("div",us,[e[43]||(e[43]=t("label",null,"Max Retries",-1)),R(t("input",{type:"number","onUpdate:modelValue":d=>v[s.id].maxRetries=d,min:"0",max:"10",onChange:d=>{var g;return D(s.id,"maxRetries",(g=v[s.id])==null?void 0:g.maxRetries)}},null,40,ds),[[q,v[s.id].maxRetries,void 0,{number:!0}]]),e[44]||(e[44]=t("span",{class:"hint"},"Retry attempts on failure (0-10)",-1))]),t("div",cs,[e[45]||(e[45]=t("label",null,"Backoff Multiplier",-1)),R(t("input",{type:"number","onUpdate:modelValue":d=>v[s.id].backoffMultiplier=d,min:"1",max:"5",step:"0.1",onChange:d=>{var g;return D(s.id,"backoffMultiplier",(g=v[s.id])==null?void 0:g.backoffMultiplier)}},null,40,ms),[[q,v[s.id].backoffMultiplier,void 0,{number:!0}]]),e[46]||(e[46]=t("span",{class:"hint"},"Exponential backoff factor (1-5)",-1))])])):_("",!0)],64))),128))])):(c(),f("div",es,[p.value.length===0?(c(),f("p",ts,"No providers are currently configured. Add API keys in the API Keys tab first.")):(c(),f("p",ss,"Loading provider settings..."))]))])):_("",!0),y.value==="execution"?(c(),f("div",ps,[e[64]||(e[64]=t("h3",null,"Execution Settings",-1)),e[65]||(e[65]=t("p",{class:"section-description"},"Configure how trials are executed",-1)),t("div",ys,[t("div",fs,[e[50]||(e[50]=t("label",null,"Default Trial Concurrency",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>k.defaultConcurrency=s),min:"1",max:"20",onChange:e[1]||(e[1]=s=>I("defaultConcurrency",k.defaultConcurrency))},null,544),[[q,k.defaultConcurrency,void 0,{number:!0}]]),e[51]||(e[51]=t("span",{class:"hint"},"Default parallel API calls per trial (1-20)",-1))]),t("div",vs,[e[52]||(e[52]=t("label",null,"Default Timeout (seconds)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>k.defaultTimeout=s),min:"10",max:"600",onChange:e[3]||(e[3]=s=>I("defaultTimeout",k.defaultTimeout))},null,544),[[q,k.defaultTimeout,void 0,{number:!0}]]),e[53]||(e[53]=t("span",{class:"hint"},"Default timeout for all calls (10-600s)",-1))]),t("div",gs,[e[54]||(e[54]=t("label",null,"Default Max Retries",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>k.defaultMaxRetries=s),min:"0",max:"5",onChange:e[5]||(e[5]=s=>I("defaultMaxRetries",k.defaultMaxRetries))},null,544),[[q,k.defaultMaxRetries,void 0,{number:!0}]]),e[55]||(e[55]=t("span",{class:"hint"},"Default retry attempts (0-5)",-1))]),t("div",bs,[e[56]||(e[56]=t("label",null,"Default Temperature",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>k.defaultTemperature=s),min:"0",max:"2",step:"0.1",onChange:e[7]||(e[7]=s=>I("defaultTemperature",k.defaultTemperature))},null,544),[[q,k.defaultTemperature,void 0,{number:!0}]]),e[57]||(e[57]=t("span",{class:"hint"},"Default model temperature (0-2)",-1))]),t("div",ks,[e[58]||(e[58]=t("label",null,"Batch Size",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>k.batchSize=s),min:"1",max:"1000",onChange:e[9]||(e[9]=s=>I("batchSize",k.batchSize))},null,544),[[q,k.batchSize,void 0,{number:!0}]]),e[59]||(e[59]=t("span",{class:"hint"},"API calls per batch (1-1000, lower = more responsive)",-1))]),t("div",Ss,[e[60]||(e[60]=t("label",null,"Max Concurrent Batches",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=s=>k.maxConcurrentBatches=s),min:"1",max:"20",onChange:e[11]||(e[11]=s=>I("maxConcurrentBatches",k.maxConcurrentBatches))},null,544),[[q,k.maxConcurrentBatches,void 0,{number:!0}]]),e[61]||(e[61]=t("span",{class:"hint"},"Batches processed simultaneously (1-20)",-1))]),t("div",ws,[e[62]||(e[62]=t("label",null,"Progress Buffer Delay (ms)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>k.progressBufferMs=s),min:"0",max:"10000",step:"100",onChange:e[13]||(e[13]=s=>I("progressBufferMs",k.progressBufferMs))},null,544),[[q,k.progressBufferMs,void 0,{number:!0}]]),e[63]||(e[63]=t("span",{class:"hint"},"Delay before updating progress (0-10000ms, 0 = immediate)",-1))])])])):_("",!0),y.value==="discovery"?(c(),f("div",hs,[e[72]||(e[72]=t("h3",null,"Model Discovery Settings",-1)),e[73]||(e[73]=t("p",{class:"section-description"},"Configure automatic model discovery",-1)),t("div",xs,[t("div",Cs,[t("label",null,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>h.autoDiscoverOnStartup=s),onChange:e[15]||(e[15]=s=>x("autoDiscoverOnStartup",h.autoDiscoverOnStartup))},null,544),[[oe,h.autoDiscoverOnStartup]]),e[66]||(e[66]=F(" Auto-discover models on startup "))])]),t("div",$s,[e[67]||(e[67]=t("label",null,"Discovery Interval (hours)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>h.discoveryInterval=s),min:"1",max:"168",onChange:e[17]||(e[17]=s=>x("discoveryInterval",h.discoveryInterval))},null,544),[[q,h.discoveryInterval,void 0,{number:!0}]]),e[68]||(e[68]=t("span",{class:"hint"},"Time between auto-discovery runs (1-168h)",-1))]),t("div",As,[e[69]||(e[69]=t("label",null,"Discovery Timeout (seconds)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=s=>h.discoveryTimeout=s),min:"10",max:"300",onChange:e[19]||(e[19]=s=>x("discoveryTimeout",h.discoveryTimeout))},null,544),[[q,h.discoveryTimeout,void 0,{number:!0}]]),e[70]||(e[70]=t("span",{class:"hint"},"Max time for discovery operations (10-300s)",-1))]),t("div",Ms,[t("label",null,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[20]||(e[20]=s=>h.skipFailedProviders=s),onChange:e[21]||(e[21]=s=>x("skipFailedProviders",h.skipFailedProviders))},null,544),[[oe,h.skipFailedProviders]]),e[71]||(e[71]=F(" Skip providers that previously failed "))])])])])):_("",!0),y.value==="coordination"?(c(),f("div",Ps,[e[80]||(e[80]=t("h3",null,"Multi-Tab Coordination",-1)),e[81]||(e[81]=t("p",{class:"section-description"},"Configure how multiple tabs work together",-1)),t("div",Ts,[t("div",Rs,[e[74]||(e[74]=t("label",null,"Leader Election Timeout (ms)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[22]||(e[22]=s=>l.leaderElectionTimeout=s),min:"100",max:"5000",onChange:e[23]||(e[23]=s=>z("leaderElectionTimeout",l.leaderElectionTimeout))},null,544),[[q,l.leaderElectionTimeout,void 0,{number:!0}]]),e[75]||(e[75]=t("span",{class:"hint"},"Time to elect new leader tab (100-5000ms)",-1))]),t("div",Es,[e[76]||(e[76]=t("label",null,"Sync Interval (ms)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[24]||(e[24]=s=>l.syncInterval=s),min:"100",max:"2000",onChange:e[25]||(e[25]=s=>z("syncInterval",l.syncInterval))},null,544),[[q,l.syncInterval,void 0,{number:!0}]]),e[77]||(e[77]=t("span",{class:"hint"},"Tab synchronization frequency (100-2000ms)",-1))]),t("div",Ds,[t("label",null,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[26]||(e[26]=s=>l.enableBroadcastChannel=s),onChange:e[27]||(e[27]=s=>z("enableBroadcastChannel",l.enableBroadcastChannel))},null,544),[[oe,l.enableBroadcastChannel]]),e[78]||(e[78]=F(" Enable BroadcastChannel communication "))])]),t("div",Is,[t("label",null,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[28]||(e[28]=s=>l.enableWebLocks=s),onChange:e[29]||(e[29]=s=>z("enableWebLocks",l.enableWebLocks))},null,544),[[oe,l.enableWebLocks]]),e[79]||(e[79]=F(" Enable Web Locks API "))])])])])):_("",!0),y.value==="performance"?(c(),f("div",Us,[e[88]||(e[88]=t("h3",null,"UI Performance",-1)),e[89]||(e[89]=t("p",{class:"section-description"},"Optimize UI performance for large datasets and debug performance issues",-1)),J(jt),t("div",Fs,[t("div",Ks,[e[82]||(e[82]=t("label",null,"Virtual Scrolling Threshold",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=s=>S.virtualScrollThreshold=s),min:"50",max:"10000",onChange:e[31]||(e[31]=s=>N("virtualScrollThreshold",S.virtualScrollThreshold))},null,544),[[q,S.virtualScrollThreshold,void 0,{number:!0}]]),e[83]||(e[83]=t("span",{class:"hint"},"Enable virtual scrolling above this row count (50-10000)",-1))]),t("div",Os,[e[84]||(e[84]=t("label",null,"Debounce Delay (ms)",-1)),R(t("input",{type:"number","onUpdate:modelValue":e[32]||(e[32]=s=>S.debounceDelay=s),min:"100",max:"1000",onChange:e[33]||(e[33]=s=>N("debounceDelay",S.debounceDelay))},null,544),[[q,S.debounceDelay,void 0,{number:!0}]]),e[85]||(e[85]=t("span",{class:"hint"},"Search/filter debounce delay (100-1000ms)",-1))]),t("div",_s,[t("label",null,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[34]||(e[34]=s=>S.enableRequestIdleCallback=s),onChange:e[35]||(e[35]=s=>N("enableRequestIdleCallback",S.enableRequestIdleCallback))},null,544),[[oe,S.enableRequestIdleCallback]]),e[86]||(e[86]=F(" Use requestIdleCallback for background tasks "))])]),t("div",Ls,[t("label",null,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[36]||(e[36]=s=>S.enableProgressiveRendering=s),onChange:e[37]||(e[37]=s=>N("enableProgressiveRendering",S.enableProgressiveRendering))},null,544),[[oe,S.enableProgressiveRendering]]),e[87]||(e[87]=F(" Enable progressive rendering for large results "))])])])])):_("",!0),y.value==="system"?(c(),f("div",Ns,[e[95]||(e[95]=t("h3",null,"System Management",-1)),e[96]||(e[96]=t("p",{class:"section-description"},"Manage database and storage",-1)),t("div",{class:"danger-zone"},[e[94]||(e[94]=t("h4",null,"⚠️ Danger Zone",-1)),t("div",{class:"danger-actions"},[t("div",{class:"action-card"},[e[90]||(e[90]=t("h5",null,"Clear All Data",-1)),e[91]||(e[91]=t("p",null,"Delete all trials, models, settings, and API calls from the database. This action cannot be undone.",-1)),t("button",{class:"danger-button",onClick:T}," Delete Database & Store ")]),t("div",{class:"action-card"},[e[92]||(e[92]=t("h5",null,"Factory Reset",-1)),e[93]||(e[93]=t("p",null,"Complete factory reset - clears database, localStorage, sessionStorage, cookies, and all browser data. Restores app to fresh installation state.",-1)),t("button",{class:"danger-button",onClick:Z}," Factory Reset Everything ")])])])])):_("",!0)])])):(c(),f("div",Wt,e[38]||(e[38]=[t("p",null,"Loading settings...",-1)])))]))}}),Vs=le(Bs,[["__scopeId","data-v-855ce96f"]]),qs={class:"import-export-section"},zs={class:"import-export-content"},Gs={class:"import-section all-data"},js={class:"file-input-wrapper"},Js={class:"import-section"},Ws={class:"file-input-wrapper"},Ys={class:"danger-section"},Hs=["disabled"],Zs=ie({__name:"ImportExportSection",props:{onStatusMessage:{type:Function}},setup(ee){const w=ge(),n=ee,r=K(),y=K(),$=K(!1);async function P(){var l,S;const h=await w.settings.core.exportSettings();if(h.ok){const D=new Blob([h.value],{type:"application/json"}),I=URL.createObjectURL(D),x=document.createElement("a");x.href=I,x.download=`auditomatic-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(I),(l=n.onStatusMessage)==null||l.call(n,"Settings exported successfully","success")}else(S=n.onStatusMessage)==null||S.call(n,`Failed to export settings: ${h.error.message}`,"error")}async function p(h){var S,D,I,x;const l=(S=h.target.files)==null?void 0:S[0];if(l)try{const z=await l.text(),N=await w.settings.core.importSettings(z);N.ok?((D=n.onStatusMessage)==null||D.call(n,"Settings imported successfully","success"),r.value&&(r.value.value="")):(I=n.onStatusMessage)==null||I.call(n,`Failed to import settings: ${N.error.message}`,"error")}catch{(x=n.onStatusMessage)==null||x.call(n,"Failed to read file","error")}}async function O(){var l,S;if(!confirm("Are you sure you want to reset all settings? This cannot be undone."))return;$.value=!0;const h=await w.settings.core.resetSettings();$.value=!1,h.ok?(l=n.onStatusMessage)==null||l.call(n,"All settings have been reset","success"):(S=n.onStatusMessage)==null||S.call(n,`Failed to reset settings: ${h.error.message}`,"error")}async function v(){var h,l,S;try{(h=n.onStatusMessage)==null||h.call(n,"Exporting all data...","success");const D={version:2,exported:new Date().toISOString(),app:"auditomatic-lite",tables:{}};for(const Y of X.tables){const Z=Y.name;D.tables[Z]=await Y.toArray()}const I=JSON.stringify(D,null,2),x=(I.length/(1024*1024)).toFixed(2),z=new Blob([I],{type:"application/json"}),N=URL.createObjectURL(z),T=document.createElement("a");T.href=N,T.download=`auditomatic-all-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(N),(l=n.onStatusMessage)==null||l.call(n,`All data exported successfully (${x} MB)`,"success")}catch(D){M.error("Failed to export all data:",D),(S=n.onStatusMessage)==null||S.call(n,`Failed to export data: ${D}`,"error")}}async function k(h){var D,I,x,z;const l=(D=h.target.files)==null?void 0:D[0];if(!l)return;if(!confirm(`WARNING: This will REPLACE ALL existing data with the imported data.

All current trials, models, settings, etc. will be deleted.

Are you absolutely sure?`)){y.value&&(y.value.value="");return}try{(I=n.onStatusMessage)==null||I.call(n,"Importing all data...","success");const N=await l.text(),T=JSON.parse(N);if(!T.version||!T.tables)throw new Error("Invalid data format");await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(Y=>Y.clear()));for(const[Y,Z]of Object.entries(T.tables)){const m=X[Y];m&&Array.isArray(Z)&&Z.length>0&&await m.bulkAdd(Z)}}),(x=n.onStatusMessage)==null||x.call(n,"All data imported successfully","success"),y.value&&(y.value.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(N){M.error("Failed to import all data:",N),(z=n.onStatusMessage)==null||z.call(n,`Failed to import data: ${N}`,"error"),y.value&&(y.value.value="")}}return(h,l)=>(c(),f("div",qs,[l[13]||(l[13]=t("h2",null,"Import & Export",-1)),l[14]||(l[14]=t("p",{class:"tab-description"},"Backup and restore your settings. API keys are masked during export for security.",-1)),t("div",zs,[t("div",{class:"export-section all-data"},[l[2]||(l[2]=t("h3",null,"📦 Export All Data",-1)),t("button",{onClick:v,class:"btn btn-primary btn-large"}," Export Everything to JSON "),l[3]||(l[3]=t("p",{class:"help-text"},"Downloads ALL data: trials, models, settings, variable lists, datasets, API calls, etc.",-1))]),t("div",Gs,[l[4]||(l[4]=t("h3",null,"📥 Import All Data",-1)),t("div",js,[t("input",{ref_key:"allDataFileInput",ref:y,type:"file",accept:".json",onChange:k,class:"file-input"},null,544),t("button",{onClick:l[0]||(l[0]=()=>y.value&&y.value.click()),class:"btn btn-primary btn-large"}," Import Everything from JSON ")]),l[5]||(l[5]=t("p",{class:"help-text"},"⚠️ WARNING: This will REPLACE all existing data with the imported data",-1))]),l[12]||(l[12]=t("hr",{class:"section-divider"},null,-1)),t("div",{class:"export-section"},[l[6]||(l[6]=t("h3",null,"Export Settings Only",-1)),t("button",{onClick:P,class:"btn btn-secondary"}," Export Settings to JSON "),l[7]||(l[7]=t("p",{class:"help-text"},"Downloads a JSON file with your settings (API keys will be masked)",-1))]),t("div",Js,[l[8]||(l[8]=t("h3",null,"Import Settings Only",-1)),t("div",Ws,[t("input",{ref_key:"fileInput",ref:r,type:"file",accept:".json",onChange:p,class:"file-input"},null,544),t("button",{onClick:l[1]||(l[1]=()=>r.value&&r.value.click()),class:"btn btn-secondary"}," Choose File ")]),l[9]||(l[9]=t("p",{class:"help-text"},"Import settings from a previously exported JSON file",-1))]),t("div",Ys,[l[10]||(l[10]=t("h3",null,"Reset Settings",-1)),t("button",{onClick:O,class:"btn btn-danger",disabled:$.value},E($.value?"Resetting...":"Reset All Settings"),9,Hs),l[11]||(l[11]=t("p",{class:"help-text"},"⚠️ This will clear all API keys and reset preferences to defaults",-1))])])]))}}),Qs=le(Zs,[["__scopeId","data-v-7b20deaa"]]),Xs=ie({__name:"StatusMessage",props:{text:{},type:{},duration:{default:5e3}},setup(ee){const w=ee,n=K(!1);let r=null;return ye(()=>w.text,y=>{y&&(n.value=!0,r&&clearTimeout(r),r=setTimeout(()=>{n.value=!1},w.duration))},{immediate:!0}),ye(n,y=>{!y&&r&&(clearTimeout(r),r=null)}),(y,$)=>(c(),se(Ie,{name:"slide"},{default:W(()=>[n.value?(c(),f("div",{key:0,class:ae(["status-message",y.type])},E(y.text),3)):_("",!0)]),_:1}))}}),en=le(Xs,[["__scopeId","data-v-da279e0d"]]),tn={class:"settings-view","data-testid":"page-settings"},sn={class:"tabs"},nn=["onClick"],on={class:"tab-content"},an=ie({__name:"SettingsView",setup(ee){const w=[{id:"api-keys",label:"API Keys"},{id:"preferences",label:"Preferences"},{id:"advanced",label:"Advanced"},{id:"import-export",label:"Import/Export"}],n=K("api-keys"),r=K(null);function y($,P){r.value={text:$,type:P},setTimeout(()=>{var p;((p=r.value)==null?void 0:p.text)===$&&(r.value=null)},5500)}return($,P)=>(c(),f("div",tn,[P[0]||(P[0]=t("h1",{class:"settings-title"},"Settings",-1)),t("div",sn,[(c(),f(pe,null,fe(w,p=>t("button",{key:p.id,class:ae(["tab",{active:n.value===p.id}]),onClick:O=>n.value=p.id},E(p.label),11,nn)),64))]),t("div",on,[n.value==="api-keys"?(c(),se(Mt,{key:0,"on-status-message":y})):_("",!0),n.value==="preferences"?(c(),se(Ut,{key:1,"on-status-message":y})):_("",!0),n.value==="advanced"?(c(),se(Vs,{key:2,"on-status-message":y})):_("",!0),n.value==="import-export"?(c(),se(Qs,{key:3,"on-status-message":y})):_("",!0)]),r.value?(c(),se(en,{key:0,text:r.value.text,type:r.value.type},null,8,["text","type"])):_("",!0)]))}}),rn=le(an,[["__scopeId","data-v-ea1dc301"]]);export{rn as default};

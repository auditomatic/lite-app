const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/trial-bundle.service-gSXZBaJe.js","assets/index-SihudOJq.js","assets/index-DNlH0UgC.css"])))=>i.map(i=>d[i]);
var Qt=Object.defineProperty;var Jt=(a,e,s)=>e in a?Qt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var me=(a,e,s)=>Jt(a,typeof e!="symbol"?e+"":e,s);import{e as R,I as Ne,f as ie,r as B,c as D,v as ge,o as ye,w as ce,h as p,af as ae,i as t,B as V,aP as $e,ak as he,j as o,k as re,aj as Te,aX as Yt,aY as Xt,aZ as Zt,x as X,a_ as es,a$ as ts,z as J,ah as kt,ag as Ce,y as P,F as Z,D as se,ay as rt,b0 as ss,b1 as as,b2 as ut,H as W,aJ as St,al as Je,ar as wt,C,b3 as ns,A as M,P as ls,ae as os,aM as dt,ax as is,aR as It,M as rs,N as at,K as us,Q as ds,S as ct,az as Rt,V as cs,E as ne,aL as ps,an as Et,a as y,u as nt,s as xe,d as Ye,b4 as Ee,b5 as Ve,b6 as Ke,Z as Vt,aW as At,b7 as fs,am as Ot,a7 as ms,aE as vs,$ as Lt,R as We,aB as Xe,J as gs,_ as Pt,L as hs}from"./index-SihudOJq.js";import{c as xt,F as ys,C as _s,b as Ft,u as bs,a as Ts,d as $s}from"./useCostEstimation-DhmMUD3f.js";import{F as Cs}from"./FilterOutlined-CvUPgT_I.js";import{I as Dt}from"./InboxOutlined-B0JUaRCm.js";import{S as ks}from"./StopOutlined-CtW96D1z.js";import{W as Re}from"./WarningOutlined-Qe7RojQq.js";import{u as Ss}from"./useHeatmapStylingV3-CSWPu6Sj.js";import{u as ws}from"./useV4Models-DMdNHk6U.js";import"./useV4LiveQuery-DZcN7iLj.js";var Is={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};function pt(a){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),i.forEach(function(c){Rs(a,c,s[c])})}return a}function Rs(a,e,s){return e in a?Object.defineProperty(a,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[e]=s,a}var lt=function(e,s){var i=pt({},e,s.attrs);return R(Ne,pt({},i,{icon:Is}),null)};lt.displayName="ColumnHeightOutlined";lt.inheritAttrs=!1;var Es={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};function ft(a){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),i.forEach(function(c){Vs(a,c,s[c])})}return a}function Vs(a,e,s){return e in a?Object.defineProperty(a,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[e]=s,a}var ze=function(e,s){var i=ft({},e,s.attrs);return R(Ne,ft({},i,{icon:Es}),null)};ze.displayName="ImportOutlined";ze.inheritAttrs=!1;var As={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function mt(a){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),i.forEach(function(c){Os(a,c,s[c])})}return a}function Os(a,e,s){return e in a?Object.defineProperty(a,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[e]=s,a}var ot=function(e,s){var i=mt({},e,s.attrs);return R(Ne,mt({},i,{icon:As}),null)};ot.displayName="PauseCircleOutlined";ot.inheritAttrs=!1;var Ls={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function vt(a){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),i.forEach(function(c){Ps(a,c,s[c])})}return a}function Ps(a,e,s){return e in a?Object.defineProperty(a,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[e]=s,a}var it=function(e,s){var i=vt({},e,s.attrs);return R(Ne,vt({},i,{icon:Ls}),null)};it.displayName="SyncOutlined";it.inheritAttrs=!1;const xs={class:"right-panel"},Fs=ie({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(a,{expose:e,emit:s}){const i=a,c=s,r=B(i.defaultWidth),v=B(!1),k=B(0),T=B(0),l=B(window.innerWidth),_=B(!1),E=D(()=>l.value<i.mobileBreakpoint),g=D(()=>E.value?{width:`${Math.min(l.value*.85,400)}px`}:{width:`${r.value}px`});function S(){const d=localStorage.getItem(i.storageKey);if(d){const O=parseInt(d,10);!isNaN(O)&&O>=i.minWidth&&O<=i.maxWidth&&(r.value=O)}}function h(d){localStorage.setItem(i.storageKey,d.toString()),c("resize",d)}function b(d){v.value=!0,k.value=d.clientX,T.value=r.value,document.addEventListener("mousemove",A),document.addEventListener("mouseup",U),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function A(d){if(!v.value)return;const O=d.clientX-k.value,H=Math.max(i.minWidth,Math.min(i.maxWidth,T.value+O));r.value=H}function U(){v.value&&(v.value=!1,h(r.value),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",U),document.body.style.userSelect="",document.body.style.cursor="")}function w(){r.value=i.defaultWidth,h(i.defaultWidth)}function u(){l.value=window.innerWidth,!E.value&&_.value&&(_.value=!1,c("mobile-overlay-change",!1))}function m(){E.value&&(_.value=!_.value,c("mobile-overlay-change",_.value))}function f(){_.value=!1,c("mobile-overlay-change",!1)}return e({toggleMobileOverlay:m,closeMobileOverlay:f}),ge(()=>{S(),window.addEventListener("resize",u)}),ye(()=>{window.removeEventListener("resize",u),U()}),ce(()=>i.defaultWidth,d=>{r.value===i.defaultWidth&&(r.value=d)}),(d,O)=>(o(),p("div",{class:ae(["resizable-panel-container",{"mobile-overlay":E.value}])},[t("div",{class:ae(["left-panel",{"overlay-visible":E.value&&_.value}]),style:he(g.value)},[$e(d.$slots,"left",{},void 0,!0)],6),E.value?V("",!0):(o(),p("div",{key:0,class:ae(["resize-handle",{dragging:v.value}]),onMousedown:b,onDblclick:w},O[0]||(O[0]=[t("div",{class:"handle-bar"},null,-1)]),34)),t("div",xs,[$e(d.$slots,"right",{},void 0,!0)]),E.value&&_.value?(o(),p("div",{key:1,class:"mobile-overlay-bg",onClick:f})):V("",!0)],2))}}),Ds=re(Fs,[["__scopeId","data-v-949e1df1"]]);function Ms(){var a=window.navigator.userAgent,e=a.indexOf("MSIE ");if(e>0)return parseInt(a.substring(e+5,a.indexOf(".",e)),10);var s=a.indexOf("Trident/");if(s>0){var i=a.indexOf("rv:");return parseInt(a.substring(i+3,a.indexOf(".",i)),10)}var c=a.indexOf("Edge/");return c>0?parseInt(a.substring(c+5,a.indexOf(".",c)),10):-1}let Fe;function Ze(){Ze.init||(Ze.init=!0,Fe=Ms()!==-1)}var He={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ze(),Te(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const a=document.createElement("object");this._resizeObject=a,a.setAttribute("aria-hidden","true"),a.setAttribute("tabindex",-1),a.onload=this.addResizeHandlers,a.type="text/html",Fe&&this.$el.appendChild(a),a.data="about:blank",Fe||this.$el.appendChild(a)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Fe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Us=Zt();Yt("data-v-b329ee4c");const Ns={class:"resize-observer",tabindex:"-1"};Xt();const Ws=Us((a,e,s,i,c,r)=>(o(),X("div",Ns)));He.render=Ws;He.__scopeId="data-v-b329ee4c";He.__file="src/components/ResizeObserver.vue";function De(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?De=function(e){return typeof e}:De=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(a)}function zs(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function Hs(a,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}function Bs(a,e,s){return e&&Hs(a.prototype,e),a}function gt(a){return js(a)||Gs(a)||qs(a)||Ks()}function js(a){if(Array.isArray(a))return et(a)}function Gs(a){if(typeof Symbol<"u"&&Symbol.iterator in Object(a))return Array.from(a)}function qs(a,e){if(a){if(typeof a=="string")return et(a,e);var s=Object.prototype.toString.call(a).slice(8,-1);if(s==="Object"&&a.constructor&&(s=a.constructor.name),s==="Map"||s==="Set")return Array.from(a);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return et(a,e)}}function et(a,e){(e==null||e>a.length)&&(e=a.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=a[s];return i}function Ks(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qs(a){var e;return typeof a=="function"?e={callback:a}:e=a,e}function Js(a,e){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,c,r,v=function(T){for(var l=arguments.length,_=new Array(l>1?l-1:0),E=1;E<l;E++)_[E-1]=arguments[E];if(r=_,!(i&&T===c)){var g=s.leading;typeof g=="function"&&(g=g(T,c)),(!i||T!==c)&&g&&a.apply(void 0,[T].concat(gt(r))),c=T,clearTimeout(i),i=setTimeout(function(){a.apply(void 0,[T].concat(gt(r))),i=0},e)}};return v._clear=function(){clearTimeout(i),i=null},v}function Mt(a,e){if(a===e)return!0;if(De(a)==="object"){for(var s in a)if(!Mt(a[s],e[s]))return!1;return!0}return!1}var Ys=function(){function a(e,s,i){zs(this,a),this.el=e,this.observer=null,this.frozen=!1,this.createObserver(s,i)}return Bs(a,[{key:"createObserver",value:function(s,i){var c=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Qs(s),this.callback=function(k,T){c.options.callback(k,T),k&&c.options.once&&(c.frozen=!0,c.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},v=r.leading;this.callback=Js(this.callback,this.options.throttle,{leading:function(T){return v==="both"||v==="visible"&&T||v==="hidden"&&!T}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(k){var T=k[0];if(k.length>1){var l=k.find(function(E){return E.isIntersecting});l&&(T=l)}if(c.callback){var _=T.isIntersecting&&T.intersectionRatio>=c.threshold;if(_===c.oldResult)return;c.oldResult=_,c.callback(_,T)}},this.options.intersection),Te(function(){c.observer&&c.observer.observe(c.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),a}();function Ut(a,e,s){var i=e.value;if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var c=new Ys(a,i,s);a._vue_visibilityState=c}}function Xs(a,e,s){var i=e.value,c=e.oldValue;if(!Mt(i,c)){var r=a._vue_visibilityState;if(!i){Nt(a);return}r?r.createObserver(i,s):Ut(a,{value:i},s)}}function Nt(a){var e=a._vue_visibilityState;e&&(e.destroyObserver(),delete a._vue_visibilityState)}var Zs={beforeMount:Ut,updated:Xs,unmounted:Nt},ea={itemsLimit:1e3},ta=/(auto|scroll)/;function Wt(a,e){return a.parentNode===null?e:Wt(a.parentNode,e.concat([a]))}var Qe=function(e,s){return getComputedStyle(e,null).getPropertyValue(s)},sa=function(e){return Qe(e,"overflow")+Qe(e,"overflow-y")+Qe(e,"overflow-x")},aa=function(e){return ta.test(sa(e))};function ht(a){if(a instanceof HTMLElement||a instanceof SVGElement){for(var e=Wt(a.parentNode,[]),s=0;s<e.length;s+=1)if(aa(e[s]))return e[s];return document.scrollingElement||document.documentElement}}function tt(a){"@babel/helpers - typeof";return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(a)}var na={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(e){return["vertical","horizontal"].includes(e)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function la(){return this.items.length&&tt(this.items[0])!=="object"}var st=!1;if(typeof window<"u"){st=!1;try{var oa=Object.defineProperty({},"passive",{get:function(){st=!0}});window.addEventListener("test",null,oa)}catch{}}let ia=0;var Be={name:"RecycleScroller",components:{ResizeObserver:He},directives:{ObserveVisibility:Zs},props:{...na,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const a={"-1":{accumulator:0}},e=this.items,s=this.sizeField,i=this.minItemSize;let c=1e4,r=0,v;for(let k=0,T=e.length;k<T;k++)v=e[k][s]||i,v<c&&(c=v),r+=v,a[k]={accumulator:r,size:v};return this.$_computedMinItemSize=c,a}return[]},simpleArray:la,itemIndexByKey(){const{keyField:a,items:e}=this,s={};for(let i=0,c=e.length;i<c;i++)s[e[i][a]]=i;return s}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const a=this.$_lastUpdateScrollPosition;typeof a=="number"&&this.$nextTick(()=>{this.scrollToPosition(a)})},beforeUnmount(){this.removeListeners()},methods:{addView(a,e,s,i,c){const r=es({id:ia++,index:e,used:!0,key:i,type:c}),v=ts({item:s,position:0,nr:r});return a.push(v),v},unuseView(a,e=!1){const s=this.$_unusedViews,i=a.nr.type;let c=s.get(i);c||(c=[],s.set(i,c)),c.push(a),e||(a.nr.used=!1,a.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(a){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const e=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:s}=this.updateVisibleItems(!1,!0);s||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});e(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&e()},this.updateInterval))}},handleVisibilityChange(a,e){this.ready&&(a||e.boundingClientRect.width!==0||e.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(a,e=!1){const s=this.itemSize,i=this.gridItems||1,c=this.itemSecondarySize||s,r=this.$_computedMinItemSize,v=this.typeField,k=this.simpleArray?null:this.keyField,T=this.items,l=T.length,_=this.sizes,E=this.$_views,g=this.$_unusedViews,S=this.pool,h=this.itemIndexByKey;let b,A,U,w,u;if(!l)b=A=w=u=U=0;else if(this.$_prerender)b=w=0,A=u=Math.min(this.prerender,T.length),U=null;else{const $=this.getScroll();if(e){let I=$.start-this.$_lastUpdateScrollPosition;if(I<0&&(I=-I),s===null&&I<r||I<s)return{continuous:!0}}this.$_lastUpdateScrollPosition=$.start;const n=this.buffer;$.start-=n,$.end+=n;let L=0;if(this.$refs.before&&(L=this.$refs.before.scrollHeight,$.start-=L),this.$refs.after){const I=this.$refs.after.scrollHeight;$.end+=I}if(s===null){let I,Q=0,te=l-1,G=~~(l/2),oe;do oe=G,I=_[G].accumulator,I<$.start?Q=G:G<l-1&&_[G+1].accumulator>$.start&&(te=G),G=~~((Q+te)/2);while(G!==oe);for(G<0&&(G=0),b=G,U=_[l-1].accumulator,A=G;A<l&&_[A].accumulator<$.end;A++);for(A===-1?A=T.length-1:(A++,A>l&&(A=l)),w=b;w<l&&L+_[w].accumulator<$.start;w++);for(u=w;u<l&&L+_[u].accumulator<$.end;u++);}else{b=~~($.start/s*i);const I=b%i;b-=I,A=Math.ceil($.end/s*i),w=Math.max(0,Math.floor(($.start-L)/s*i)),u=Math.floor(($.end-L)/s*i),b<0&&(b=0),A>l&&(A=l),w<0&&(w=0),u>l&&(u=l),U=Math.ceil(l/i)*s}}A-b>ea.itemsLimit&&this.itemsLimitError(),this.totalSize=U;let m;const f=b<=this.$_endIndex&&A>=this.$_startIndex;if(f)for(let $=0,n=S.length;$<n;$++)m=S[$],m.nr.used&&(a&&(m.nr.index=h[m.item[k]]),(m.nr.index==null||m.nr.index<b||m.nr.index>=A)&&this.unuseView(m));const d=f?null:new Map;let O,H,Y;for(let $=b;$<A;$++){O=T[$];const n=k?O[k]:O;if(n==null)throw new Error(`Key is ${n} on item (keyField is '${k}')`);if(m=E.get(n),!s&&!_[$].size){m&&this.unuseView(m);continue}H=O[v];let L=g.get(H),I=!1;if(!m)f?L&&L.length?m=L.pop():m=this.addView(S,$,O,n,H):(Y=d.get(H)||0,(!L||Y>=L.length)&&(m=this.addView(S,$,O,n,H),this.unuseView(m,!0),L=g.get(H)),m=L[Y],d.set(H,Y+1)),E.delete(m.nr.key),m.nr.used=!0,m.nr.index=$,m.nr.key=n,m.nr.type=H,E.set(n,m),I=!0;else if(!m.nr.used&&(m.nr.used=!0,I=!0,L)){const Q=L.indexOf(m);Q!==-1&&L.splice(Q,1)}m.item=O,I&&($===T.length-1&&this.$emit("scroll-end"),$===0&&this.$emit("scroll-start")),s===null?(m.position=_[$-1].accumulator,m.offset=0):(m.position=Math.floor($/i)*s,m.offset=$%i*c)}return this.$_startIndex=b,this.$_endIndex=A,this.emitUpdate&&this.$emit("update",b,A,w,u),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:f}},getListenerTarget(){let a=ht(this.$el);return window.document&&(a===window.document.documentElement||a===window.document.body)&&(a=window),a},getScroll(){const{$el:a,direction:e}=this,s=e==="vertical";let i;if(this.pageMode){const c=a.getBoundingClientRect(),r=s?c.height:c.width;let v=-(s?c.top:c.left),k=s?window.innerHeight:window.innerWidth;v<0&&(k+=v,v=0),v+k>r&&(k=r-v),i={start:v,end:v+k}}else s?i={start:a.scrollTop,end:a.scrollTop+a.clientHeight}:i={start:a.scrollLeft,end:a.scrollLeft+a.clientWidth};return i},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,st?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(a){let e;const s=this.gridItems||1;this.itemSize===null?e=a>0?this.sizes[a-1].accumulator:0:e=Math.floor(a/s)*this.itemSize,this.scrollToPosition(e)},scrollToPosition(a){const e=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let s,i,c;if(this.pageMode){const r=ht(this.$el),v=r.tagName==="HTML"?0:r[e.scroll],k=r.getBoundingClientRect(),l=this.$el.getBoundingClientRect()[e.start]-k[e.start];s=r,i=e.scroll,c=a+v+l}else s=this.$el,i=e.scroll,c=a;s[i]=c},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((a,e)=>a.nr.index-e.nr.index)}}};const ra={key:0,ref:"before",class:"vue-recycle-scroller__slot"},ua={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function da(a,e,s,i,c,r){const v=J("ResizeObserver"),k=kt("observe-visibility");return Ce((o(),p("div",{class:ae(["vue-recycle-scroller",{ready:c.ready,"page-mode":s.pageMode,[`direction-${a.direction}`]:!0}]),onScrollPassive:e[0]||(e[0]=(...T)=>r.handleScroll&&r.handleScroll(...T))},[a.$slots.before?(o(),p("div",ra,[$e(a.$slots,"before")],512)):V("v-if",!0),(o(),X(rt(s.listTag),{ref:"wrapper",style:he({[a.direction==="vertical"?"minHeight":"minWidth"]:c.totalSize+"px"}),class:ae(["vue-recycle-scroller__item-wrapper",s.listClass])},{default:P(()=>[(o(!0),p(Z,null,se(c.pool,T=>(o(),X(rt(s.itemTag),ss({key:T.nr.id,style:c.ready?{transform:`translate${a.direction==="vertical"?"Y":"X"}(${T.position}px) translate${a.direction==="vertical"?"X":"Y"}(${T.offset}px)`,width:s.gridItems?`${a.direction==="vertical"&&s.itemSecondarySize||s.itemSize}px`:void 0,height:s.gridItems?`${a.direction==="horizontal"&&s.itemSecondarySize||s.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[s.itemClass,{hover:!s.skipHover&&c.hoverKey===T.nr.key}]]},as(s.skipHover?{}:{mouseenter:()=>{c.hoverKey=T.nr.key},mouseleave:()=>{c.hoverKey=null}})),{default:P(()=>[$e(a.$slots,"default",{item:T.item,index:T.nr.index,active:T.nr.used})]),_:2},1040,["style","class"]))),128)),$e(a.$slots,"empty")]),_:3},8,["style","class"])),a.$slots.after?(o(),p("div",ua,[$e(a.$slots,"after")],512)):V("v-if",!0),R(v,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[k,r.handleVisibilityChange]])}Be.render=da;Be.__file="src/components/RecycleScroller.vue";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const yt=()=>{};function ca(a,e){function s(...i){return new Promise((c,r)=>{Promise.resolve(a(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})).then(c).catch(r)})}return s}function pa(a,e={}){let s,i,c=yt;const r=T=>{clearTimeout(T),c(),c=yt};let v;return T=>{const l=ut(a),_=ut(e.maxWait);return s&&r(s),l<=0||_!==void 0&&_<=0?(i&&(r(i),i=void 0),Promise.resolve(T())):new Promise((E,g)=>{c=e.rejectOnCancel?g:E,v=T,_&&!i&&(i=setTimeout(()=>{s&&r(s),i=void 0,E(v())},_)),s=setTimeout(()=>{i&&r(i),i=void 0,E(T())},l)})}}function zt(a,e=200,s={}){return ca(pa(e,s),a)}const fa={class:"trial-list-search"},ma=["value"],va=ie({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(a,{emit:e}){const s=e,i=B(),c=zt(l=>{s("update:modelValue",l)},300);function r(l){const _=l.target.value;c(_)}function v(){var l;s("update:modelValue",""),(l=i.value)==null||l.focus()}function k(){var l,_;(l=i.value)==null||l.focus(),(_=i.value)==null||_.select()}function T(l){l.type==="focus-trial-search"&&k()}return ge(()=>{window.addEventListener("focus-trial-search",T)}),ye(()=>{window.removeEventListener("focus-trial-search",T)}),(l,_)=>(o(),p("div",fa,[R(W(St),{class:"search-icon"}),t("input",{ref_key:"searchInput",ref:i,type:"text",class:"search-input",placeholder:"Filter trials...",value:l.modelValue,onInput:r,onKeydown:Je(v,["escape"])},null,40,ma),l.modelValue?(o(),X(W(wt),{key:0,class:"clear-icon",onClick:v})):V("",!0)]))}}),ga=re(va,[["__scopeId","data-v-3a032c2b"]]),ha={class:"item-content"},ya={class:"item-header"},_a=["title"],ba={key:0,class:"progress-bar"},Ta={class:"item-metadata"},$a={class:"meta-item"},Ca={class:"meta-item"},ka={key:0,class:"meta-separator"},Sa={key:1,class:"meta-item cost"},wa=ie({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(a){const e=a,{calculateTemplateTokens:s,calculatePromptTokens:i,estimateCost:c,sumEstimates:r,multiplyEstimate:v,formatCost:k}=xt(),T=D(()=>{if(e.trial.progress.total===0)return 0;const g=e.trial.progress.completed+e.trial.progress.failed;return Math.round(g/e.trial.progress.total*100)}),l=D(()=>{const{completed:g,failed:S,total:h}=e.trial.progress;return e.trial.status==="draft"?`${h} tasks`:`${g+S}/${h} tasks`}),_=D(()=>{const g=e.trial.started||e.trial.created;if(!g)return"";const h=new Date().getTime()-g.getTime(),b=Math.floor(h/1e3),A=Math.floor(b/60),U=Math.floor(A/60),w=Math.floor(U/24);return b<60?"now":A<60?`${A}m`:U<24?`${U}h`:`${w}d`}),E=D(()=>{var U,w;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let g=0;if(e.trial.type==="template"&&((U=e.trial.templateConfig)!=null&&U.template))g=s(e.trial.templateConfig.template,e.trial.templateConfig.variables||{});else if(e.trial.type==="spreadsheet"&&((w=e.trial.spreadsheetConfig)!=null&&w.promptPattern))g=i(e.trial.spreadsheetConfig.promptPattern);else if(e.trial.type==="playground")return null;if(g===0)return null;const S=e.trial.configurations.map(u=>{const m=u.modelSnapshot;return m?c(g,m,u.parameters):null}).filter(Boolean);if(S.length===0)return null;const h=r(S),b=e.trial.progress.total/e.trial.configurations.length,A=v(h,b);return k(A,"range")});return(g,S)=>(o(),p("div",{class:ae(["trial-list-item",{selected:g.selected,"has-progress":g.trial.status==="running"}]),onClick:S[0]||(S[0]=h=>g.$emit("click"))},[t("div",{class:ae(["status-indicator",`status-${g.trial.status}`])},null,2),t("div",ha,[t("div",ya,[t("span",{class:"trial-name",title:g.trial.name},C(g.trial.name),9,_a),t("span",{class:ae(["status-tag",`status-${g.trial.status}`])},C(g.trial.status.toUpperCase()),3)]),g.trial.status==="running"?(o(),p("div",ba,[t("div",{class:"progress-fill",style:he({width:`${T.value}%`})},null,4)])):V("",!0),t("div",Ta,[t("span",$a,C(l.value),1),S[1]||(S[1]=t("span",{class:"meta-separator"},"•",-1)),t("span",Ca,C(_.value),1),E.value?(o(),p("span",ka,"•")):V("",!0),E.value?(o(),p("span",Sa,C(E.value),1)):V("",!0)])])],2))}}),_t=re(wa,[["__scopeId","data-v-fd430f00"]]),Ia={class:"section-title"},Ra=ie({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(a){return(e,s)=>(o(),p("div",{class:ae(["trial-list-section",{"with-background":e.background}])},[t("span",Ia,C(e.title),1)],2))}}),bt=re(Ra,[["__scopeId","data-v-07a26c58"]]),Ea={class:"panel-header"},Va={class:"header-title"},Aa={key:0,class:"title-text"},Oa={class:"trial-count"},La={key:0,class:"header-actions"},Pa={class:"filter-count"},xa={class:"filter-count"},Fa={class:"filter-count"},Da={class:"filter-count"},Ma={class:"filter-count"},Ua={key:1,class:"status-tabs"},Na={class:"tab-count"},Wa={class:"tab-count"},za={class:"tab-count"},Ha={class:"trial-list-container"},Ba={key:1,class:"trial-list"},ja={key:2,class:"collapsed-list"},Ga=["onClick"],qa={class:"collapsed-count"},Ka={key:3,class:"empty-state"},Qa=ie({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","import-trial","update-search","update-filter","refresh"],setup(a,{emit:e}){const s=a,i=e,c=B(!1),r=B("all"),v=B(250),k=D(()=>v.value<50),T=D(()=>s.trials.filter(d=>d.status==="running"||d.status==="paused").length),l=D(()=>s.trials.filter(d=>d.status==="completed"||d.status==="failed").length),_=D(()=>{let d=s.trials;if(s.searchQuery){const $=s.searchQuery.toLowerCase();d=d.filter(n=>{var te,G;const L=n.name.toLowerCase().includes($),I=(G=(te=n.templateConfig)==null?void 0:te.template)==null?void 0:G.toLowerCase().includes($),Q=n.configurations.some(oe=>oe.modelId.toLowerCase().includes($)||oe.provider.toLowerCase().includes($));return L||I||Q})}s.filterStatus!=="all"&&(d=d.filter($=>$.status===s.filterStatus)),r.value==="active"?d=d.filter($=>$.status==="running"||$.status==="paused"):r.value==="done"&&(d=d.filter($=>$.status==="completed"||$.status==="failed"));const O=d.filter($=>$.status==="running"),H=d.filter($=>$.status!=="running"),Y=[];return O.length>0&&(Y.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),Y.push(...O.sort(($,n)=>{var L,I;return(((L=n.started)==null?void 0:L.getTime())||0)-(((I=$.started)==null?void 0:I.getTime())||0)}))),H.length>0&&(O.length>0&&Y.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),Y.push(...H.sort(($,n)=>{var L,I;return(((L=n.created)==null?void 0:L.getTime())||0)-(((I=$.created)==null?void 0:I.getTime())||0)}))),Y}),E=D(()=>_.value.map(d=>({...d,height:U(d)}))),g=D(()=>s.trials.filter(d=>r.value==="active"?d.status==="running"||d.status==="paused":r.value==="done"?d.status==="completed"||d.status==="failed":!0)),S=D(()=>s.searchQuery?"No trials found":s.filterStatus==="running"?"No trials are currently running":"No trials found"),h=D(()=>s.searchQuery?"No trials match your search":s.filterStatus!=="all"?`No ${s.filterStatus} trials`:"Create your first trial to get started"),b=D(()=>s.filterStatus==="all"&&!s.searchQuery);function A(d){return s.trials.filter(O=>O.status===d).length}function U(d){var Y;if(d.type==="section")return 32;const O=d.status==="running",H=(Y=d.configurations)==null?void 0:Y.some($=>$.repeatCount>1);return O||H?96:80}function w(d){const O=d.progress.completed+d.progress.failed;return d.status==="running"?`${Math.round(O/d.progress.total*100)}%`:O.toString()}async function u(){c.value=!0;try{await new Promise(d=>setTimeout(d,500)),i("refresh")}finally{c.value=!1}}function m({key:d}){i("update-filter",d)}function f(){const d=document.querySelector(".trial-list-panel");d&&(v.value=d.clientWidth)}return ge(()=>{f(),window.addEventListener("resize",f);const d=document.querySelector(".trial-list-panel");d&&new ResizeObserver(()=>f()).observe(d)}),ye(()=>{window.removeEventListener("resize",f)}),(d,O)=>{const H=J("a-button"),Y=J("a-menu-item"),$=J("a-menu-divider"),n=J("a-menu"),L=J("a-dropdown");return o(),p("div",{class:ae(["trial-list-panel",{collapsed:k.value}])},[t("div",Ea,[t("div",Va,[R(W(ns),{class:"title-icon"}),k.value?V("",!0):(o(),p("span",Aa,"Trials")),t("span",Oa,C(d.trials.length),1)]),k.value?V("",!0):(o(),p("div",La,[R(H,{type:"primary",size:"small",onClick:O[0]||(O[0]=I=>d.$emit("create-trial"))},{default:P(()=>[R(W(ls)),O[7]||(O[7]=M(" New Trial "))]),_:1,__:[7]}),R(H,{size:"small",onClick:O[1]||(O[1]=I=>d.$emit("import-trial"))},{default:P(()=>[R(W(ze)),O[8]||(O[8]=M(" Import "))]),_:1,__:[8]}),R(H,{size:"small",onClick:u,loading:c.value},{default:P(()=>[R(W(it),{spin:c.value},null,8,["spin"])]),_:1},8,["loading"]),R(L,null,{overlay:P(()=>[R(n,{onClick:m},{default:P(()=>[R(Y,{key:"all"},{default:P(()=>O[9]||(O[9]=[t("span",null,"All Trials",-1)])),_:1,__:[9]}),R($),R(Y,{key:"running"},{default:P(()=>[O[10]||(O[10]=t("span",null,"Running Only",-1)),t("span",Pa,C(A("running")),1)]),_:1,__:[10]}),R(Y,{key:"completed"},{default:P(()=>[O[11]||(O[11]=t("span",null,"Completed Only",-1)),t("span",xa,C(A("completed")),1)]),_:1,__:[11]}),R(Y,{key:"failed"},{default:P(()=>[O[12]||(O[12]=t("span",null,"Failed Only",-1)),t("span",Fa,C(A("failed")),1)]),_:1,__:[12]}),R(Y,{key:"paused"},{default:P(()=>[O[13]||(O[13]=t("span",null,"Paused Only",-1)),t("span",Da,C(A("paused")),1)]),_:1,__:[13]}),R(Y,{key:"draft"},{default:P(()=>[O[14]||(O[14]=t("span",null,"Draft Only",-1)),t("span",Ma,C(A("draft")),1)]),_:1,__:[14]})]),_:1})]),default:P(()=>[R(H,{size:"small"},{default:P(()=>[R(W(Cs))]),_:1})]),_:1})]))]),k.value?V("",!0):(o(),X(ga,{key:0,"model-value":d.searchQuery,"onUpdate:modelValue":O[2]||(O[2]=I=>d.$emit("update-search",I))},null,8,["model-value"])),k.value?V("",!0):(o(),p("div",Ua,[t("div",{class:ae(["status-tab",{active:r.value==="all"}]),onClick:O[3]||(O[3]=I=>r.value="all")},[O[15]||(O[15]=t("span",{class:"tab-icon"},"📊",-1)),O[16]||(O[16]=t("span",{class:"tab-label"},"ALL",-1)),t("span",Na,C(d.trials.length),1)],2),t("div",{class:ae(["status-tab",{active:r.value==="active"}]),onClick:O[4]||(O[4]=I=>r.value="active")},[O[17]||(O[17]=t("span",{class:"tab-icon"},"🟢",-1)),O[18]||(O[18]=t("span",{class:"tab-label"},"Active",-1)),t("span",Wa,C(T.value),1)],2),t("div",{class:ae(["status-tab",{active:r.value==="done"}]),onClick:O[5]||(O[5]=I=>r.value="done")},[O[19]||(O[19]=t("span",{class:"tab-icon"},"✅",-1)),O[20]||(O[20]=t("span",{class:"tab-label"},"Done",-1)),t("span",za,C(l.value),1)],2)])),t("div",Ha,[!k.value&&_.value.length>100?(o(),X(W(Be),{key:0,class:"trial-list virtual-list",items:E.value,"size-field":"height","key-field":"id",buffer:10},{default:P(({item:I})=>[I.type==="section"?(o(),X(bt,{key:0,title:I.title,background:I.background},null,8,["title","background"])):(o(),X(_t,{key:1,trial:I,selected:I.id===d.selectedTrialId,"data-trial-id":I.id,onClick:Q=>d.$emit("select-trial",I.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):k.value?(o(),p("div",ja,[(o(!0),p(Z,null,se(g.value,I=>(o(),p("div",{key:I.id,class:ae(["collapsed-item",{selected:I.id===d.selectedTrialId}]),onClick:Q=>d.$emit("select-trial",I.id)},[t("div",{class:ae(["status-dot",`status-${I.status}`])},null,2),t("span",qa,C(w(I)),1)],10,Ga))),128))])):(o(),p("div",Ba,[(o(!0),p(Z,null,se(_.value,(I,Q)=>(o(),p(Z,{key:I.id||`section-${Q}`},[I.type==="section"?(o(),X(bt,{key:0,title:I.title,background:I.background},null,8,["title","background"])):(o(),X(_t,{key:1,trial:I,selected:I.id===d.selectedTrialId,"data-trial-id":I.id,onClick:te=>d.$emit("select-trial",I.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),_.value.length===0&&!k.value?(o(),p("div",Ka,[R(W(Dt),{class:"empty-icon"}),t("h3",null,C(S.value),1),t("p",null,C(h.value),1),b.value?(o(),X(H,{key:0,type:"primary",size:"large",onClick:O[6]||(O[6]=I=>d.$emit("create-trial"))},{default:P(()=>O[21]||(O[21]=[M(" Create New Trial ")])),_:1,__:[21]})):V("",!0)])):V("",!0)])],2)}}}),Ja=re(Qa,[["__scopeId","data-v-ad2a17cf"]]),Ya={class:"trial-header"},Xa={class:"header-main"},Za={class:"header-title"},en={class:"trial-name"},tn={key:0,class:"progress-container"},sn={class:"progress-bar"},an={class:"progress-stats-inline"},nn={class:"progress-text"},ln={key:0,class:"progress-stat"},on={class:"stat-number"},rn={key:1,class:"progress-stat"},un={class:"stat-number"},dn={key:2,class:"progress-stat"},cn={class:"stat-number"},pn=ie({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(a){const e=a,s=D(()=>{let h=e.trial.name;return h=h.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),h=h.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),h.trim()}),i=D(()=>!0),c=D(()=>e.progress?e.progress.completed+e.progress.failed:0),r=D(()=>{if(!e.progress||e.progress.total===0)return 0;const h=e.progress.completed+e.progress.failed;return Math.round(h/e.progress.total*100)}),v=D(()=>{const h=e.trial.started||e.trial.created;if(!h)return"0m";let b;if(e.trial.status==="draft")return"0m";e.trial.completed?b=e.trial.completed:b=new Date;const A=b.getTime()-h.getTime(),U=Math.floor(A/(1e3*60*60)),w=Math.floor(A%(1e3*60*60)/(1e3*60));return U>0?`${U}h ${w}m`:`${w}m`}),k=D(()=>{var b;if(!((b=e.progress)!=null&&b.avgLatencyMs))return null;const h=e.progress.avgLatencyMs;return h<1e3?`${Math.round(h)}ms`:`${(h/1e3).toFixed(1)}s`}),{calculateTemplateTokens:T,estimateCost:l,sumEstimates:_,multiplyEstimate:E,formatCost:g}=xt();D(()=>{var m,f,d;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let h=0;if(e.trial.type==="template"&&((m=e.trial.templateConfig)!=null&&m.template))h=T(e.trial.templateConfig.template,e.trial.templateConfig.variables||{});else if(e.trial.type==="spreadsheet"&&((f=e.trial.spreadsheetConfig)!=null&&f.promptPattern))h=os().estimateTokens(e.trial.spreadsheetConfig.promptPattern);else if(e.trial.type==="playground")return null;if(h===0)return null;const b=((d=e.progress)==null?void 0:d.total)||e.trial.progress.total,A=Math.ceil(b/e.trial.configurations.length),U=e.trial.configurations.map(O=>{const H=O.modelSnapshot;return H?l(h,H,O.parameters):null}).filter(Boolean);if(U.length===0)return null;const w=_(U),u=E(w,A);if(e.progress&&e.progress.completed>0){const O=e.progress.completed/b,H=E(u,O);return g(H,"range")}return g(u,"range")});const S=D(()=>{var u;if(e.trial.status!=="running"||!e.progress||e.progress.completed===0)return null;const b=(Date.now()-(((u=e.trial.started)==null?void 0:u.getTime())||0))/e.progress.completed,A=e.progress.pending*b,U=Math.floor(A/(1e3*60)),w=Math.floor(A%(1e3*60)/1e3);if(U>60){const m=Math.floor(U/60),f=U%60;return`${m}h ${f}m`}return`${U}m ${w}s`});return(h,b)=>{var A;return o(),p("div",Ya,[t("div",Xa,[t("div",Za,[t("h2",en,C(s.value),1),t("span",{class:ae(["status-tag",`status-${h.trial.status}`])},C(h.trial.status.toUpperCase()),3)]),i.value?(o(),p("div",tn,[t("div",sn,[t("div",{class:"progress-fill",style:he({width:`${r.value}%`})},null,4)]),t("div",an,[t("span",nn,C(c.value)+"/"+C(((A=h.progress)==null?void 0:A.total)||0)+" ("+C(r.value)+"%) ",1),v.value?(o(),p("span",ln,[b[0]||(b[0]=t("span",{class:"stat-label"},"Duration:",-1)),b[1]||(b[1]=M()),t("span",on,C(v.value),1)])):V("",!0),k.value?(o(),p("span",rn,[b[2]||(b[2]=t("span",{class:"stat-label"},"Avg:",-1)),b[3]||(b[3]=M()),t("span",un,C(k.value),1)])):V("",!0),S.value?(o(),p("span",dn,[b[4]||(b[4]=t("span",{class:"stat-label"},"Remaining:",-1)),b[5]||(b[5]=M()),t("span",cn,"~"+C(S.value),1)])):V("",!0)])])):V("",!0)]),V("",!0)])}}}),fn=re(pn,[["__scopeId","data-v-f1c97bac"]]),mn={class:"trial-actions"},vn={class:"action-group execution-controls"},gn={class:"action-group data-actions"},hn={class:"action-group management-actions"},yn=ie({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(a,{emit:e}){const s=a,i=e,c=B(!1),r=B(!1),v=B(!1);D(()=>{var m;return((m=s.executionState)==null?void 0:m.currentTrialId)===s.trial.id});const k=D(()=>["draft","failed","cancelled"].includes(s.trial.status)),T=D(()=>s.trial.status==="running"),l=D(()=>s.trial.status==="paused"),_=D(()=>["running","paused"].includes(s.trial.status));function E(){i("start")}async function g(){c.value=!0,r.value=!1,i("pause"),setTimeout(()=>{c.value=!1},1e3)}async function S(){r.value=!0,c.value=!1,i("resume"),setTimeout(()=>{r.value=!1},3e3)}function h(){ct.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>i("cancel")})}async function b(){v.value=!0,i("refresh"),setTimeout(()=>{v.value=!1},500)}function A({key:m}){m==="data"?i("export-data"):m==="python"&&i("export-python")}function U(){i("duplicate")}function w(){i("edit")}function u(){const m=s.trial.progress.total;ct.confirm({title:"Delete trial?",content:`Delete trial and all ${m} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{i("delete")}})}return(m,f)=>{const d=J("a-button"),O=J("a-menu-item"),H=J("a-menu"),Y=J("a-dropdown");return o(),p("div",mn,[t("div",vn,[k.value?(o(),X(d,{key:0,type:"primary",size:"large",disabled:!m.isLeader,onClick:E},{default:P(()=>[R(W(dt)),f[0]||(f[0]=M(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):V("",!0),T.value?(o(),X(d,{key:1,size:"large",disabled:!m.isLeader,loading:c.value,onClick:g},{default:P(()=>[c.value?V("",!0):(o(),X(W(ot),{key:0})),M(" "+C(c.value?"Pausing...":"Pause"),1)]),_:1},8,["disabled","loading"])):V("",!0),l.value?(o(),X(d,{key:2,type:"primary",size:"large",disabled:!m.isLeader||r.value,loading:r.value,onClick:S},{default:P(()=>[r.value?V("",!0):(o(),X(W(dt),{key:0})),M(" "+C(r.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):V("",!0),_.value?(o(),X(d,{key:3,danger:"",size:"large",disabled:!m.isLeader,onClick:h},{default:P(()=>[R(W(ks)),f[1]||(f[1]=M(" Cancel "))]),_:1,__:[1]},8,["disabled"])):V("",!0)]),t("div",gn,[R(d,{size:"large",loading:v.value,onClick:b,title:"Refresh trial data from database"},{default:P(()=>[v.value?(o(),X(W(It),{key:1,spin:""})):(o(),X(W(is),{key:0})),M(" "+C(v.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),R(Y,null,{overlay:P(()=>[R(H,{onClick:A},{default:P(()=>[R(O,{key:"data"},{default:P(()=>[R(W(ys)),f[3]||(f[3]=M(" Export Data "))]),_:1,__:[3]}),R(O,{key:"python"},{default:P(()=>[R(W(_s)),f[4]||(f[4]=M(" Export Python Script "))]),_:1,__:[4]})]),_:1})]),default:P(()=>[R(d,{size:"large"},{default:P(()=>[f[2]||(f[2]=M(" Export ")),R(W(rs))]),_:1,__:[2]})]),_:1})]),t("div",hn,[R(d,{size:"large",disabled:!m.isLeader,onClick:U},{default:P(()=>[R(W(at)),f[5]||(f[5]=M(" Duplicate "))]),_:1,__:[5]},8,["disabled"]),m.trial.status==="draft"?(o(),X(d,{key:0,size:"large",disabled:!m.isLeader,onClick:w},{default:P(()=>[R(W(us)),f[6]||(f[6]=M(" Edit "))]),_:1,__:[6]},8,["disabled"])):V("",!0),R(d,{danger:"",size:"large",disabled:!m.isLeader,onClick:u},{default:P(()=>[R(W(ds)),f[7]||(f[7]=M(" Delete "))]),_:1,__:[7]},8,["disabled"])])])}}}),_n=re(yn,[["__scopeId","data-v-e642c431"]]),bn={class:"snapshot-debug"},Tn={class:"debug-header"},$n={class:"status-row"},Cn={key:0,class:"badge success"},kn={key:1,class:"badge warning"},Sn={key:0,class:"status-row"},wn={key:0,class:"variables-section"},In={class:"variable-header"},Rn={class:"var-name"},En={class:"var-type"},Vn={key:0,class:"snapshot-content"},An={class:"snapshot-meta"},On={key:0},Ln={class:"snapshot-items"},Pn={class:"items-preview"},xn={class:"item-index"},Fn={class:"item-value"},Dn={key:0,class:"item-attrs"},Mn={key:0,class:"more-indicator"},Un={key:1,class:"no-snapshot"},Nn={key:0},Wn={key:1,class:"legacy-warning"},zn={class:"debug-footer"},Hn=ie({__name:"SnapshotDebugModal",props:{visible:{type:Boolean},trial:{},migrating:{type:Boolean}},emits:["close","migrate"],setup(a){const e=a,s=D(()=>{var l;return((l=e.trial.templateConfig)==null?void 0:l.hasSnapshots)===!0}),i=D(()=>{var l;return((l=e.trial.templateConfig)==null?void 0:l.variables)||{}});function c(l){return"snapshot"in l&&l.snapshot!=null}function r(l){return l.snapshot}function v(l){return c(l)?`${r(l).source.type} (snapshot)`:l.type==="value"?"Direct values":l.type==="list"?"List reference":"Unknown"}function k(){var l;for(const _ of Object.values(i.value))if(c(_)){const E=r(_);if((l=E.source)!=null&&l.snapshotDate)return new Date(E.source.snapshotDate).toLocaleString()}return"Unknown"}function T(){const l={trialId:e.trial.id,trialName:e.trial.name,hasSnapshots:s.value,variables:i.value};navigator.clipboard.writeText(JSON.stringify(l,null,2)),ne.success("Debug info copied to clipboard")}return(l,_)=>{const E=J("a-tag"),g=J("a-alert"),S=J("a-button"),h=J("a-modal");return o(),X(h,{visible:l.visible,title:"Variable Snapshot Debug View",width:"80%",footer:null,onCancel:_[2]||(_[2]=b=>l.$emit("close"))},{default:P(()=>[t("div",bn,[t("div",Tn,[t("div",$n,[_[5]||(_[5]=t("span",{class:"label"},"Snapshot Status:",-1)),s.value?(o(),p("span",Cn,[R(W(Rt)),_[3]||(_[3]=M(" Snapshots Enabled "))])):(o(),p("span",kn,[R(W(Re)),_[4]||(_[4]=M(" Legacy Mode (No Snapshots) "))]))]),s.value?(o(),p("div",Sn,[_[6]||(_[6]=t("span",{class:"label"},"Snapshot Date:",-1)),t("span",null,C(k()),1)])):V("",!0)]),s.value?(o(),p("div",wn,[_[8]||(_[8]=t("h3",null,"Variable Snapshots",-1)),(o(!0),p(Z,null,se(i.value,(b,A)=>(o(),p("div",{key:A,class:"variable-card"},[t("div",In,[t("span",Rn,C(A),1),t("span",En,C(v(b)),1)]),c(b)?(o(),p("div",Vn,[t("div",An,[t("span",null,"Source: "+C(r(b).source.type),1),r(b).source.listName?(o(),p("span",On," List: "+C(r(b).source.listName),1)):V("",!0),t("span",null,"Items: "+C(r(b).items.length),1)]),t("div",Ln,[t("div",Pn,[(o(!0),p(Z,null,se(r(b).items.slice(0,5),(U,w)=>(o(),p("div",{key:w,class:"item-row"},[t("span",xn,C(w+1)+".",1),t("span",Fn,C(U.value),1),U.attributes&&Object.keys(U.attributes).length>0?(o(),p("span",Dn,[(o(!0),p(Z,null,se(U.attributes,(u,m)=>(o(),X(E,{key:m,size:"small"},{default:P(()=>[M(C(m)+": "+C(u),1)]),_:2},1024))),128))])):V("",!0)]))),128)),r(b).items.length>5?(o(),p("div",Mn," ... and "+C(r(b).items.length-5)+" more items ",1)):V("",!0)])])])):(o(),p("div",Un,[R(W(Re)),_[7]||(_[7]=M(" No snapshot - using live reference ")),b.listId?(o(),p("span",Nn,"List ID: "+C(b.listId),1)):V("",!0)]))]))),128))])):(o(),p("div",Wn,[R(g,{message:"Legacy Trial",description:"This trial was created before snapshots were implemented. Variable lists are loaded dynamically from the database, which means changes to lists will affect trial duplication.",type:"warning","show-icon":""}),R(S,{type:"primary",onClick:_[0]||(_[0]=b=>l.$emit("migrate")),loading:l.migrating,style:{"margin-top":"16px"}},{default:P(()=>[R(W(cs)),_[9]||(_[9]=M(" Migrate to Snapshots "))]),_:1,__:[9]},8,["loading"])])),t("div",zn,[R(S,{onClick:T},{default:P(()=>[R(W(at)),_[10]||(_[10]=M(" Copy Debug Info "))]),_:1,__:[10]}),R(S,{onClick:_[1]||(_[1]=b=>l.$emit("close"))},{default:P(()=>_[11]||(_[11]=[M("Close")])),_:1,__:[11]})])])]),_:1},8,["visible"])}}}),Bn=re(Hn,[["__scopeId","data-v-726379cc"]]),jn={class:"trial-detail-view"},Gn={key:0,class:"detail-content"},qn={class:"detail-section"},Kn={class:"detail-grid"},Qn={class:"detail-item"},Jn={key:0,class:"detail-item"},Yn={key:1,class:"detail-item"},Xn={class:"detail-item"},Zn={class:"detail-item"},el={class:"detail-section"},tl={class:"detail-grid"},sl={key:0,class:"detail-item full-width"},al={key:1,class:"detail-item full-width"},nl={class:"detail-item"},ll={class:"detail-item"},ol={style:{display:"flex","align-items":"center",gap:"8px"}},il={key:0,class:"snapshot-badge success"},rl={key:1,class:"snapshot-badge warning"},ul={class:"detail-item"},dl={key:2,class:"detail-item"},cl={key:0,class:"detail-section"},pl={class:"detail-grid"},fl={class:"detail-item"},ml={class:"detail-item"},vl={class:"detail-item"},gl={class:"detail-section"},hl={class:"model-configs"},yl={class:"config-header"},_l=["src","alt"],bl={class:"provider-name"},Tl={class:"config-details"},$l={class:"config-item"},Cl={class:"config-params"},kl={class:"param-list"},Sl={key:0,class:"config-item"},wl={class:"cost"},Il=ie({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(a){const e=a,s=B(!1),i=D(()=>{const w=e.trial.started||e.trial.created,m=(e.trial.completed||new Date).getTime()-w.getTime(),f=Math.floor(m/(1e3*60*60)),d=Math.floor(m%(1e3*60*60)/(1e3*60));return f>0?`${f}h ${d}m`:`${d}m`}),c=D(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[e.trial.status]||e.trial.status),r=D(()=>{var w;return e.trial.type==="template"&&((w=e.trial.templateConfig)!=null&&w.variables)?Object.keys(e.trial.templateConfig.variables).length:0}),v=D(()=>Math.round(e.trial.progress.total*750)),k=D(()=>e.trial.type==="template"&&e.trial.templateConfig?e.trial.templateConfig.hasSnapshots===!0:!1),T=D(()=>"text"),l=D(()=>1),_=D(()=>e.trial.progress.total/l.value);function E(w){return w?new Date(w).toLocaleString():"N/A"}function g(){var u,m;if((u=e.trial.templateConfig)!=null&&u.templateName)return e.trial.templateConfig.templateName;const w=((m=e.trial.templateConfig)==null?void 0:m.template)||"Unknown Template";return w.length>50?w.substring(0,50)+"...":w}function S(){var w;return((w=e.trial.spreadsheetConfig)==null?void 0:w.datasetId)||"Unknown Dataset"}function h(w){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[w]||w}function b(w){}async function A(){try{ne.info("Migration feature coming soon"),s.value=!1}catch(w){ne.error("Failed to migrate trial"),y.error("Migration error:",w)}}function U(w){var f;const u=w.modelSnapshot;return(f=u==null?void 0:u.capabilities)!=null&&f.inputCostPerToken?`$${((u.capabilities.inputCostPerToken+u.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(w,u)=>{const m=J("a-button");return o(),p("div",jn,[t("div",{class:"detail-header",onClick:u[0]||(u[0]=f=>w.$emit("toggle-collapse"))},[u[3]||(u[3]=t("h3",null,"Trial Details",-1)),R(W(ps),{class:ae(["collapse-icon",{rotated:w.isCollapsed}])},null,8,["class"])]),w.isCollapsed?V("",!0):(o(),p("div",Gn,[t("div",qn,[u[9]||(u[9]=t("h4",null,"Basic Information",-1)),t("div",Kn,[t("div",Qn,[u[4]||(u[4]=t("label",null,"Created:",-1)),t("span",null,C(E(w.trial.created)),1)]),w.trial.started?(o(),p("div",Jn,[u[5]||(u[5]=t("label",null,"Started:",-1)),t("span",null,C(E(w.trial.started)),1)])):V("",!0),w.trial.completed?(o(),p("div",Yn,[u[6]||(u[6]=t("label",null,"Completed:",-1)),t("span",null,C(E(w.trial.completed)),1)])):V("",!0),t("div",Xn,[u[7]||(u[7]=t("label",null,"Duration:",-1)),t("span",null,C(i.value),1)]),t("div",Zn,[u[8]||(u[8]=t("label",null,"Status:",-1)),t("span",null,C(w.trial.status)+" - "+C(c.value),1)])])]),t("div",el,[u[19]||(u[19]=t("h4",null,"Configuration",-1)),t("div",tl,[w.trial.type==="template"?(o(),p("div",sl,[u[10]||(u[10]=t("label",null,"Template:",-1)),t("span",null,C(g()),1)])):V("",!0),w.trial.type==="spreadsheet"?(o(),p("div",al,[u[11]||(u[11]=t("label",null,"Dataset:",-1)),t("span",null,C(S()),1)])):V("",!0),t("div",nl,[u[12]||(u[12]=t("label",null,"Variable Lists:",-1)),t("span",null,C(r.value)+" lists",1)]),t("div",ll,[u[16]||(u[16]=t("label",null,"Data Snapshot:",-1)),t("div",ol,[k.value?(o(),p("span",il,[R(W(Rt)),u[13]||(u[13]=M(" Captured "))])):(o(),p("span",rl,[R(W(Re)),u[14]||(u[14]=M(" Live Reference "))])),w.trial.type==="template"?(o(),X(m,{key:2,size:"small",type:"link",onClick:u[1]||(u[1]=f=>s.value=!0)},{default:P(()=>[R(W(Et)),u[15]||(u[15]=M(" Debug "))]),_:1,__:[15]})):V("",!0)])]),t("div",ul,[u[17]||(u[17]=t("label",null,"Token Estimate:",-1)),t("span",null,"~"+C(v.value)+" tokens",1)]),T.value?(o(),p("div",dl,[u[18]||(u[18]=t("label",null,"Output Type:",-1)),t("span",{class:ae(["output-type",`type-${T.value}`])},C(T.value),3)])):V("",!0)])]),l.value>1?(o(),p("div",cl,[u[23]||(u[23]=t("h4",null,"Repeat Configuration",-1)),t("div",pl,[t("div",fl,[u[20]||(u[20]=t("label",null,"Times per prompt:",-1)),t("span",null,C(l.value),1)]),t("div",ml,[u[21]||(u[21]=t("label",null,"Total combinations:",-1)),t("span",null,C(_.value),1)]),t("div",vl,[u[22]||(u[22]=t("label",null,"Total API calls:",-1)),t("span",null,C(w.trial.progress.total),1)])])])):V("",!0),t("div",gl,[u[27]||(u[27]=t("h4",null,"Model Configurations",-1)),t("div",hl,[(o(!0),p(Z,null,se(w.trial.configurations,(f,d)=>(o(),p("div",{key:d,class:"model-config-card"},[t("div",yl,[(f.provider,void 0)?(o(),p("img",{key:0,src:(f.provider,void 0),alt:f.provider,class:"provider-logo"},null,8,_l)):V("",!0),t("span",bl,C(h(f.provider)),1)]),t("div",Tl,[t("div",$l,[u[24]||(u[24]=t("label",null,"Model:",-1)),t("span",null,C(f.modelId),1)]),t("div",Cl,[u[25]||(u[25]=t("label",null,"Parameters:",-1)),t("div",kl,[(o(!0),p(Z,null,se(f.parameters,(O,H)=>(o(),p("span",{key:H,class:"param-tag"},C(H)+": "+C(O),1))),128))])]),U(f)?(o(),p("div",Sl,[u[26]||(u[26]=t("label",null,"Est. Cost:",-1)),t("span",wl,C(U(f)),1)])):V("",!0)])]))),128))])])])),s.value?(o(),X(Bn,{key:1,visible:s.value,trial:w.trial,onClose:u[2]||(u[2]=f=>s.value=!1),onMigrate:A},null,8,["visible","trial"])):V("",!0)])}}}),Rl=re(Il,[["__scopeId","data-v-a5e15d0c"]]),El={class:"filter-bar"},Vl={class:"search-container"},Al=ie({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns"],setup(a,{emit:e}){const s=a,i=e,c=D(()=>{const l=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return s.showRepeatColumn&&l.splice(2,0,{key:"repeat",label:"Repeat Index"}),l}),r=D(()=>{const l={total:s.apiCalls.length,completed:0,failed:0,running:0,pending:0};return s.apiCalls.forEach(_=>{_.status==="completed"?l.completed++:_.status==="failed"?l.failed++:_.status==="running"?l.running++:_.status==="pending"&&l.pending++}),l});function v(l){var _;return((_=l.modelSnapshot)==null?void 0:_.displayName)||`${l.provider} - ${l.modelId}`}const k=zt(l=>{const _=l.target.value;i("update:searchQuery",_)},300);function T(l){const _=[...s.visibleColumns],E=_.indexOf(l);if(E>-1)_.splice(E,1);else{const g=c.value.map(b=>b.key),S=g.indexOf(l);let h=0;for(let b=0;b<S;b++)_.includes(g[b])&&h++;_.splice(h,0,l)}i("update:visibleColumns",_)}return(l,_)=>{const E=J("a-select-option"),g=J("a-select"),S=J("a-input"),h=J("a-button"),b=J("a-checkbox"),A=J("a-menu-item"),U=J("a-menu"),w=J("a-dropdown");return o(),p("div",El,[R(g,{value:l.statusFilter,onChange:_[0]||(_[0]=u=>l.$emit("update:statusFilter",u)),placeholder:"Filter by status",style:{width:"150px"}},{default:P(()=>[R(E,{value:"all"},{default:P(()=>[M(" All ("+C(r.value.total)+") ",1)]),_:1}),R(E,{value:"completed"},{default:P(()=>[M(" Completed ("+C(r.value.completed)+") ",1)]),_:1}),R(E,{value:"failed"},{default:P(()=>[M(" Failed ("+C(r.value.failed)+") ",1)]),_:1}),R(E,{value:"running"},{default:P(()=>[M(" Running ("+C(r.value.running)+") ",1)]),_:1}),R(E,{value:"pending"},{default:P(()=>[M(" Pending ("+C(r.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),R(g,{value:l.configFilter,onChange:_[1]||(_[1]=u=>l.$emit("update:configFilter",u)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:P(()=>[R(E,{value:""},{default:P(()=>_[2]||(_[2]=[M("All Configurations")])),_:1,__:[2]}),(o(!0),p(Z,null,se(l.configurations,(u,m)=>(o(),X(E,{key:m,value:m.toString()},{default:P(()=>[M(C(v(u)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),t("div",Vl,[R(S,{value:l.searchQuery,onInput:W(k),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:P(()=>[R(W(St))]),_:1},8,["value","onInput"])]),R(w,null,{overlay:P(()=>[R(U,null,{default:P(()=>[(o(!0),p(Z,null,se(c.value,u=>(o(),X(A,{key:u.key},{default:P(()=>[R(b,{checked:l.visibleColumns.includes(u.key),disabled:u.key==="status",onChange:m=>T(u.key)},{default:P(()=>[M(C(u.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:P(()=>[R(h,null,{default:P(()=>[R(W(lt)),_[3]||(_[3]=M(" Columns "))]),_:1,__:[3]})]),_:1})])}}}),Ol=re(Al,[["__scopeId","data-v-1fdfdfd1"]]),Ll={class:"modal-content"},Pl={class:"section"},xl={class:"info-grid"},Fl={class:"info-item"},Dl={class:"monospace"},Ml={class:"info-item"},Ul={class:"info-item"},Nl={key:0,class:"info-item"},Wl={class:"info-item"},zl={key:1,class:"info-item"},Hl={key:2,class:"info-item"},Bl={key:3,class:"info-item"},jl={key:0,class:"info-row"},Gl={class:"monospace"},ql={key:0,class:"section"},Kl={class:"variables-list"},Ql={class:"variable-main"},Jl={class:"variable-label"},Yl={class:"variable-value"},Xl={key:0,class:"variable-attributes"},Zl={class:"attribute-label"},eo={class:"attribute-value"},to={class:"section"},so={class:"content-box prompt-display"},ao={key:1,class:"section"},no={key:0,class:"error-result"},lo={key:1,class:"success-result"},oo={class:"content-box response-content"},io={key:0,class:"parsed-content-section"},ro={class:"content-box parsed-content"},uo={key:1,class:"refusal-warning"},co={class:"extraction-config-section"},po={class:"config-grid"},fo={key:0,class:"config-item"},mo={class:"config-value"},vo={key:1,class:"config-item"},go={class:"config-value pattern"},ho={key:2,class:"config-item"},yo={class:"config-value"},_o={key:3,class:"config-item"},bo={class:"config-value"},To={key:4,class:"config-item no-extraction"},$o={key:2,class:"usage-info"},Co={class:"info-grid"},ko={class:"info-item"},So={class:"info-item"},wo={class:"info-item"},Io={key:0,class:"info-item"},Ro={class:"raw-data-section"},Eo={class:"raw-data"},Vo={key:0},Ao={key:1,class:"raw-data"},Oo={key:2},Lo={key:3,class:"raw-data"},Po={class:"modal-footer"},xo=ie({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(a,{emit:e}){const s=a,i=e,c=nt(),r=D(()=>{if(!s.apiCall.completed||!s.apiCall.created)return null;const f=new Date(s.apiCall.created).getTime();return new Date(s.apiCall.completed).getTime()-f}),v=D(()=>{const f=s.trial.configurations[s.apiCall.configurationIndex];return f?`${f.provider} / ${f.modelId}`:null}),k=D(()=>{var Y,$,n;if(!((Y=s.apiCall.result)!=null&&Y.usage))return null;const f=s.trial.configurations[s.apiCall.configurationIndex];if(!f)return null;const d=c.models.value.find(L=>L.provider===f.provider&&L.modelId===f.modelId);if(!(($=d==null?void 0:d.capabilities)!=null&&$.inputCostPerToken)&&!((n=d==null?void 0:d.capabilities)!=null&&n.outputCostPerToken))return null;const O=(s.apiCall.result.usage.prompt_tokens||0)*(d.capabilities.inputCostPerToken||0),H=(s.apiCall.result.usage.completion_tokens||0)*(d.capabilities.outputCostPerToken||0);return O+H}),T=D(()=>{if(!s.apiCall.request)return"No request data";const f=JSON.parse(JSON.stringify(s.apiCall.request));return f.headers&&Object.keys(f.headers).forEach(d=>{(d.toLowerCase().includes("authorization")||d.toLowerCase().includes("api-key")||d.toLowerCase().includes("x-api-key"))&&(f.headers[d]="[REDACTED]")}),f.body&&typeof f.body=="object"&&(f.body.api_key&&(f.body.api_key="[REDACTED]"),f.body.apiKey&&(f.body.apiKey="[REDACTED]")),JSON.stringify(f,null,2)}),l=D(()=>s.trial.type!=="template"||!s.trial.templateConfig?{}:{outputType:s.trial.templateConfig.outputType,extractPattern:s.trial.templateConfig.extractPattern,refusalWords:s.trial.templateConfig.refusalWords,rejectRefusalWords:s.trial.templateConfig.rejectRefusalWords}),_=D(()=>{const f=l.value;return!!(f.outputType||f.extractPattern||f.refusalWords&&f.refusalWords.length>0)}),E=D(()=>s.apiCall.response?JSON.stringify({status:s.apiCall.response.status,headers:s.apiCall.response.headers,body:s.apiCall.response.body,latencyMs:s.apiCall.response.latencyMs},null,2):"No response data available"),g=D(()=>s.apiCall.result?JSON.stringify(s.apiCall.result,null,2):"No processed result available");function S(f){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[f]||"default"}function h(){var d;const f=s.trial.configurations[s.apiCall.configurationIndex];return((d=f==null?void 0:f.modelSnapshot)==null?void 0:d.displayName)||(f==null?void 0:f.modelId)||`Configuration ${s.apiCall.configurationIndex+1}`}function b(f){return(typeof f=="string"?new Date(f):f).toLocaleString()}function A(f){return f<1e3?`${f}ms`:f<6e4?`${(f/1e3).toFixed(1)}s`:`${Math.floor(f/6e4)}m ${(f%6e4/1e3).toFixed(0)}s`}function U(f){return f==null?"null":typeof f=="string"?f:typeof f=="number"||typeof f=="boolean"?String(f):JSON.stringify(f,null,2)}function w(f){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[f]||f}function u(){i("update:visible",!1)}async function m(){const f={id:s.apiCall.id,status:s.apiCall.status,configuration:h(),provider:v.value,variables:s.apiCall.variables,variableAttributes:s.apiCall.variableAttributes,prompt:s.apiCall.prompt,fullApiResponse:s.apiCall.response,processedResult:s.apiCall.result,extractionConfig:l.value,created:s.apiCall.created,completed:s.apiCall.completed,duration:r.value?`${r.value}ms`:null,cost:k.value?`$${k.value.toFixed(4)}`:null},d=JSON.stringify(f,null,2);try{await navigator.clipboard.writeText(d),ne.success("Details copied to clipboard!")}catch(O){y.error("Failed to copy to clipboard",O),ne.error("Failed to copy to clipboard")}}return(f,d)=>{const O=J("a-tag"),H=J("a-alert"),Y=J("a-collapse-panel"),$=J("a-collapse"),n=J("a-button"),L=J("a-modal");return o(),X(L,{open:f.visible,onCancel:d[0]||(d[0]=I=>i("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:P(()=>{var I;return[t("div",Ll,[t("div",Pl,[d[10]||(d[10]=t("h3",null,"Overview",-1)),t("div",xl,[t("div",Fl,[d[1]||(d[1]=t("label",null,"Call ID:",-1)),t("span",Dl,C(f.apiCall.id),1)]),t("div",Ml,[d[2]||(d[2]=t("label",null,"Status:",-1)),R(O,{color:S(f.apiCall.status)},{default:P(()=>[M(C(f.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),t("div",Ul,[d[3]||(d[3]=t("label",null,"Configuration:",-1)),t("span",null,C(h()),1)]),f.apiCall.repeatIndex!==void 0?(o(),p("div",Nl,[d[4]||(d[4]=t("label",null,"Repeat:",-1)),t("span",null,"#"+C(f.apiCall.repeatIndex+1),1)])):V("",!0),t("div",Wl,[d[5]||(d[5]=t("label",null,"Created:",-1)),t("span",null,C(b(f.apiCall.created)),1)]),f.apiCall.completed?(o(),p("div",zl,[d[6]||(d[6]=t("label",null,"Completed:",-1)),t("span",null,C(b(f.apiCall.completed)),1)])):V("",!0),r.value?(o(),p("div",Hl,[d[7]||(d[7]=t("label",null,"Duration:",-1)),t("span",null,C(A(r.value)),1)])):V("",!0),(I=f.apiCall.result)!=null&&I.latency?(o(),p("div",Bl,[d[8]||(d[8]=t("label",null,"API Latency:",-1)),t("span",null,C(f.apiCall.result.latency)+"ms",1)])):V("",!0)]),v.value?(o(),p("div",jl,[d[9]||(d[9]=t("label",null,"Provider/Model:",-1)),t("span",Gl,C(v.value),1)])):V("",!0)]),f.apiCall.variables&&Object.keys(f.apiCall.variables).length>0?(o(),p("div",ql,[d[11]||(d[11]=t("h3",null,"Variables",-1)),t("div",Kl,[(o(!0),p(Z,null,se(f.apiCall.variables,(Q,te)=>(o(),p("div",{key:te,class:"variable-group"},[t("div",Ql,[t("label",Jl,C(te)+":",1),t("span",Yl,C(Q),1)]),f.apiCall.variableAttributes&&f.apiCall.variableAttributes[te]?(o(),p("div",Xl,[(o(!0),p(Z,null,se(f.apiCall.variableAttributes[te],(G,oe)=>(o(),p("div",{key:oe,class:"attribute-item"},[t("label",Zl,C(oe)+":",1),t("span",eo,C(G),1)]))),128))])):V("",!0)]))),128))])])):V("",!0),t("div",to,[d[12]||(d[12]=t("h3",null,"Resolved Prompt",-1)),t("div",so,C(f.apiCall.prompt),1)]),f.apiCall.result?(o(),p("div",ao,[d[25]||(d[25]=t("h3",null,"Response",-1)),f.apiCall.status==="failed"&&f.apiCall.result.error?(o(),p("div",no,[R(H,{type:"error",message:f.apiCall.result.error,description:f.apiCall.result.errorType?`Error Type: ${w(f.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):f.apiCall.result.content?(o(),p("div",lo,[t("div",oo,C(f.apiCall.result.content),1),f.apiCall.result.parsedContent!==void 0?(o(),p("div",io,[d[13]||(d[13]=t("h4",null,"Extracted Value",-1)),t("div",ro,C(U(f.apiCall.result.parsedContent)),1)])):V("",!0),f.apiCall.result.refused?(o(),p("div",uo,[R(H,{type:"warning",message:"Response flagged as refusal",description:"This response matched configured refusal patterns","show-icon":""})])):V("",!0),t("div",co,[d[19]||(d[19]=t("h4",null,"Extraction Configuration",-1)),t("div",po,[l.value.outputType?(o(),p("div",fo,[d[14]||(d[14]=t("label",null,"Output Type:",-1)),t("span",mo,C(l.value.outputType),1)])):V("",!0),l.value.extractPattern?(o(),p("div",vo,[d[15]||(d[15]=t("label",null,"Extract Pattern:",-1)),t("span",go,C(l.value.extractPattern),1)])):V("",!0),l.value.refusalWords&&l.value.refusalWords.length>0?(o(),p("div",ho,[d[16]||(d[16]=t("label",null,"Refusal Words:",-1)),t("span",yo,C(l.value.refusalWords.join(", ")),1)])):V("",!0),l.value.rejectRefusalWords!==void 0?(o(),p("div",_o,[d[17]||(d[17]=t("label",null,"Reject on Refusal:",-1)),t("span",bo,C(l.value.rejectRefusalWords?"Yes":"No"),1)])):V("",!0),_.value?V("",!0):(o(),p("div",To,d[18]||(d[18]=[t("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),f.apiCall.result.usage?(o(),p("div",$o,[d[24]||(d[24]=t("h4",null,"Token Usage",-1)),t("div",Co,[t("div",ko,[d[20]||(d[20]=t("label",null,"Prompt Tokens:",-1)),t("span",null,C(f.apiCall.result.usage.prompt_tokens||0),1)]),t("div",So,[d[21]||(d[21]=t("label",null,"Completion Tokens:",-1)),t("span",null,C(f.apiCall.result.usage.completion_tokens||0),1)]),t("div",wo,[d[22]||(d[22]=t("label",null,"Total Tokens:",-1)),t("span",null,C(f.apiCall.result.usage.total_tokens||0),1)]),k.value?(o(),p("div",Io,[d[23]||(d[23]=t("label",null,"Cost:",-1)),t("span",null,"$"+C(k.value.toFixed(4)),1)])):V("",!0)])])):V("",!0)])):V("",!0)])):V("",!0),R($,{ghost:""},{default:P(()=>[R(Y,{key:"raw",header:"Raw Data"},{default:P(()=>[t("div",Ro,[d[26]||(d[26]=t("h4",null,"HTTP Request",-1)),t("pre",Eo,C(T.value),1),f.apiCall.response?(o(),p("h4",Vo,"Full API Response")):V("",!0),f.apiCall.response?(o(),p("pre",Ao,C(E.value),1)):V("",!0),f.apiCall.result?(o(),p("h4",Oo,"Processed Result")):V("",!0),f.apiCall.result?(o(),p("pre",Lo,C(g.value),1)):V("",!0)])]),_:1})]),_:1})]),t("div",Po,[R(n,{onClick:u,size:"large"},{default:P(()=>d[27]||(d[27]=[M(" Close ")])),_:1,__:[27]}),R(n,{type:"primary",onClick:m,size:"large"},{default:P(()=>[R(W(at)),d[28]||(d[28]=M(" Copy Details "))]),_:1,__:[28]})])]}),_:1},8,["open"])}}}),Fo=re(xo,[["__scopeId","data-v-bd0d6ad2"]]);class Do{constructor(){me(this,"apiCalls",xe([]));me(this,"currentTrialId",xe(null));me(this,"executionProgress",xe(null));me(this,"isStreaming",xe(!1));me(this,"progress",D(()=>{var _,E;const e=performance.now(),s=this.apiCalls.value;if(s.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let i=0,c=0,r=0,v=0,k=0;y.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Computing progress from ${s.length} calls in store`);for(const g of s)switch(g.status){case"completed":i++;break;case"failed":c++,(E=(_=g.result)==null?void 0:_.error)!=null&&E.includes("network");break;case"cancelled":r++;break;case"pending":v++;break;case"running":k++;break}const T=performance.now(),l={trialId:this.currentTrialId.value||"",total:s.length,completed:i,failed:c,cancelled:r,pending:v,running:k,lastUpdated:new Date};return y.info(`V4_STORE_PROGRESS: Computed in ${(T-e).toFixed(1)}ms - ${i}/${s.length} completed, ${k} running, ${v} pending`),y.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Final result - completed: ${i}, failed: ${c}, running: ${k}, pending: ${v}, total: ${s.length}`),l}));me(this,"pivotData",D(()=>{const e=performance.now(),s=this.apiCalls.value,i={rows:[],columns:[],cells:new Map};if(s.length===0)return i;const c=new Set,r=new Set;for(const k of s){if(k.status!=="completed")continue;const T=`Config ${k.configurationIndex}`;c.add(T);const l=Object.keys(k.variables||{}),_=l.length>0?String(k.variables[l[0]]):"default";r.add(_),i.cells.has(T)||i.cells.set(T,new Map);const E=i.cells.get(T);E.has(_)||E.set(_,[]),E.get(_).push(k)}i.rows=Array.from(c).sort(),i.columns=Array.from(r).sort();const v=performance.now();return y.info(`V4_TRIAL_SWITCH: Store pivotData computed for ${s.length} calls in ${(v-e).toFixed(1)}ms`),i}));me(this,"stats",D(()=>{var E;const e=performance.now(),s=this.apiCalls.value,i=s.length;if(i===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let c=0,r=0,v=0,k=0,T=0,l=0;for(const g of s)switch(g.status){case"completed":c++,(E=g.response)!=null&&E.latencyMs&&(T+=g.response.latencyMs,l++);break;case"failed":r++;break;case"pending":v++;break;case"running":k++;break}const _=performance.now();return y.info(`V4_TRIAL_SWITCH: Store stats computed for ${s.length} calls in ${(_-e).toFixed(1)}ms`),{total:i,completed:c,failed:r,pending:v,running:k,avgLatency:l>0?T/l:0,errorRate:i>0?r/i*100:0}}))}updateApiCalls(e){for(const s of e)switch(s.status){}this.apiCalls.value=Object.freeze(e)}updateProgress(e){y.info("STORE_V4: Updating progress:",e.type),this.executionProgress.value=e}setStreaming(e){y.info(`STORE_V4: Set streaming: ${e}`),this.isStreaming.value=e}setCurrentTrial(e){y.info(`STORE_V4: Set current trial: ${e}`),this.currentTrialId.value=e,e||this.clear()}clear(){y.info("STORE_V4: Clearing store data"),this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(e){y.info(`STORE_V4: Refreshing data from database for trial ${e}`);try{const s=await Ye.apiCalls.where("trialId").equals(e).toArray();y.info(`STORE_V4: Loaded ${s.length} calls from database`),s.sort((i,c)=>{const r=T=>{switch(T){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},v=r(i.status),k=r(c.status);return v!==k?v-k:i.order-c.order}),this.updateApiCalls(s),this.setCurrentTrial(e),y.info("STORE_V4: Refresh complete - store updated with fresh data")}catch(s){throw y.error("STORE_V4: Failed to refresh from database:",s),s}}}let Me=null;function je(){return Me||(Me=new Do,y.info("STORE_V4: Created singleton store instance")),Me}typeof window<"u"&&(window.__trialDataStoreV4=()=>Me);const Mo={class:"trial-results-table"},Uo={class:"table-container"},No={class:"results-table"},Wo={key:0,class:"col-status"},zo={key:1,class:"col-configuration"},Ho={key:2,class:"col-repeat"},Bo={key:3,class:"col-variables"},jo={key:4,class:"col-response"},Go={key:5,class:"col-parsed"},qo={key:6,class:"col-length"},Ko={key:7,class:"col-latency"},Qo={class:"results-table"},Jo=["onClick"],Yo={key:0,class:"col-status"},Xo={class:"status-cell"},Zo={class:"status-time"},ei={key:1,class:"col-configuration"},ti={key:2,class:"col-repeat"},si={key:3,class:"col-variables"},ai={class:"variable-tags"},ni={key:0,class:"var-item"},li={key:1,class:"var-item"},oi={key:2},ii={key:3},ri={key:4,class:"col-response"},ui={class:"response-content"},di={key:5,class:"col-parsed"},ci={key:6,class:"col-length"},pi={key:7,class:"col-latency"},fi={key:1,class:"results-table"},mi={key:0,class:"col-status"},vi={key:1,class:"col-configuration"},gi={key:2,class:"col-repeat"},hi={key:3,class:"col-variables"},yi={key:4,class:"col-response"},_i={key:5,class:"col-parsed"},bi={key:6,class:"col-length"},Ti={key:7,class:"col-latency"},$i=["onClick"],Ci={key:0,class:"col-status"},ki={class:"status-cell"},Si={class:"status-time"},wi={key:1,class:"col-configuration"},Ii={key:2,class:"col-repeat"},Ri={key:3,class:"col-variables"},Ei={class:"variable-tags"},Vi={key:0,class:"var-item"},Ai={key:1,class:"var-item"},Oi={key:2},Li={key:3},Pi={key:4,class:"col-response"},xi={class:"response-content"},Fi={key:5,class:"col-parsed"},Di={key:6,class:"col-length"},Mi={key:7,class:"col-latency"},Ui={key:0},Ni=["colspan"],Wi={key:0},zi={key:1},Tt="trial-results-visible-columns",Hi=ie({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(a){const e=a,s=B("all"),i=B([]),c=B(""),r=B(["status","configuration","variables","response","parsedResponse","length","latency"]),v=B(null),k=je(),T=D(()=>{var $;return(($=k.apiCalls)==null?void 0:$.value)||[]}),l=D(()=>e.apiCalls||T.value);ce(l,($,n)=>{const L=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${(n==null?void 0:n.length)||0} to ${$.length} calls`),setTimeout(()=>{const I=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(I-L).toFixed(1)}ms`)},0)});const _=$=>{if(!c.value)return $;const n=c.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),L=new RegExp(`(${n})`,"gi");return $.replace(L,"<mark>$1</mark>")},E=D(()=>{const $=performance.now();let n=[...l.value];if(s.value!=="all"&&(n=n.filter(I=>I.status===s.value)),i.value.length>0&&(n=n.filter(I=>i.value.includes(String(I.configurationIndex)))),c.value){const I=c.value.toLowerCase();n=n.filter(Q=>{var te,G,oe,x,fe;return!!((te=Q.prompt)!=null&&te.toLowerCase().includes(I)||(oe=(G=Q.result)==null?void 0:G.content)!=null&&oe.toLowerCase().includes(I)||(fe=(x=Q.result)==null?void 0:x.error)!=null&&fe.toLowerCase().includes(I))})}const L=performance.now();return y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${n.length} calls in ${(L-$).toFixed(1)}ms`),n});ce(E,($,n)=>{const L=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${(n==null?void 0:n.length)||0} to ${$.length} items`),setTimeout(()=>{const I=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(I-L).toFixed(1)}ms`)},0)});const g=D(()=>l.value),S=D(()=>l.value.length),h=D(()=>e.trial.configurations.some($=>$.repeatCount>1)),b=D(()=>60);function A($){}function U($){var L;const n=e.trial.configurations[$];return n?((L=n.modelSnapshot)==null?void 0:L.displayName)||`${n.modelId}`:`Config ${$+1}`}function w($){var n,L,I,Q,te;return $.status==="pending"?"Waiting...":$.status==="running"?"Processing...":$.status==="failed"?((n=$.result)==null?void 0:n.errorType)==="refusal_detected"||((L=$.result)==null?void 0:L.error)==="REFUSED"?((I=$.result)==null?void 0:I.content)||"REFUSED":((Q=$.result)==null?void 0:Q.error)||"Error occurred":((te=$.result)==null?void 0:te.content)||""}function u($){if(!$.result)return"";if($.result.parsedContent!==void 0){const n=$.result.parsedContent;return n===null?"null":typeof n=="string"?n:typeof n=="number"||typeof n=="boolean"?String(n):JSON.stringify(n)}return""}function m($){var I;const n=((I=$.result)==null?void 0:I.content)||"";if(!n)return"";const L=n.length;return L>1e3?`${(L/1e3).toFixed(1)}k chars`:`${L} chars`}function f($){return $?$<1e3?`${$}ms`:`${($/1e3).toFixed(1)}s`:""}function d($){let n;switch($.status){case"completed":case"failed":n=$.completed;break;case"running":n=$.started;break;case"pending":case"cancelled":n=$.created;break}if(!n)return"";const L=new Date(n),I=L.getHours().toString().padStart(2,"0"),Q=L.getMinutes().toString().padStart(2,"0"),te=L.getSeconds().toString().padStart(2,"0");return`  ${I}:${Q}:${te}`}function O($){return $?$<1e3?"latency-fast":$<5e3?"latency-medium":"latency-slow":""}function H($){return _($)}function Y($){v.value=$}return ce(r,$=>{localStorage.setItem(Tt,JSON.stringify($))},{deep:!0}),ge(()=>{const $=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${l.value.length} calls`);const n=localStorage.getItem(Tt);if(n)try{r.value=JSON.parse(n)}catch{}Te(()=>{const L=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(L-$).toFixed(1)}ms`),setTimeout(()=>{const I=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(I-$).toFixed(1)}ms`)},100)}),setTimeout(()=>{const L=performance.now();y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(L-$).toFixed(1)}ms`)},0)}),Ee(()=>{y.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${l.value.length} calls`)}),Ve(()=>{y.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),ye(()=>{y.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),($,n)=>{const L=kt("dompurify-html");return o(),p("div",Mo,[R(Ol,{"status-filter":s.value,"onUpdate:statusFilter":n[0]||(n[0]=I=>s.value=I),"config-filter":i.value,"onUpdate:configFilter":n[1]||(n[1]=I=>i.value=I),"search-query":c.value,"onUpdate:searchQuery":n[2]||(n[2]=I=>c.value=I),"visible-columns":r.value,"onUpdate:visibleColumns":n[3]||(n[3]=I=>r.value=I),configurations:$.trial.configurations,"api-calls":g.value,"show-repeat-column":h.value},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),t("div",Uo,[S.value>100?(o(),X(W(Be),{key:0,class:"results-scroller",items:E.value,"item-size":b.value,"key-field":"id",buffer:10,onVisibleRange:A},{before:P(()=>[t("table",No,[t("thead",null,[t("tr",null,[r.value.includes("status")?(o(),p("th",Wo,"Status")):V("",!0),r.value.includes("configuration")?(o(),p("th",zo,"Configuration")):V("",!0),r.value.includes("repeat")&&h.value?(o(),p("th",Ho,"Repeat")):V("",!0),r.value.includes("variables")?(o(),p("th",Bo,"Variables")):V("",!0),r.value.includes("response")?(o(),p("th",jo,"Response")):V("",!0),r.value.includes("parsedResponse")?(o(),p("th",Go,"Parsed Response")):V("",!0),r.value.includes("length")?(o(),p("th",qo,"Length")):V("",!0),r.value.includes("latency")?(o(),p("th",Ko,"Latency")):V("",!0)])])])]),default:P(({item:I})=>{var Q,te;return[t("table",Qo,[t("tbody",null,[t("tr",{class:ae(["result-row",`status-${I.status}`]),onClick:G=>Y(I)},[r.value.includes("status")?(o(),p("td",Yo,[t("div",Xo,[t("span",{class:ae(["status-tag",`status-${I.status}`])},C(I.status.toUpperCase()),3),t("span",Zo,C(d(I)),1)])])):V("",!0),r.value.includes("configuration")?(o(),p("td",ei,C(U(I.configurationIndex)),1)):V("",!0),r.value.includes("repeat")&&h.value?(o(),p("td",ti," #"+C((I.repeatIndex||0)+1),1)):V("",!0),r.value.includes("variables")?(o(),p("td",si,[t("div",ai,[(o(!0),p(Z,null,se(Object.entries(I.variables),([G,oe],x)=>(o(),p(Z,{key:G},[n[6]||(n[6]=t("span",{class:"var-bullet"},"• ",-1)),Object.keys(I.variables).length<=2?(o(),p("span",ni,C(G)+": "+C(oe),1)):(o(),p("span",li,C(oe),1)),Object.keys(I.variables).length===2&&x===0?(o(),p("span",oi,n[5]||(n[5]=[t("br",null,null,-1)]))):x<Object.keys(I.variables).length-1?(o(),p("span",ii,C("  "))):V("",!0)],64))),128))])])):V("",!0),r.value.includes("response")?(o(),p("td",ri,[Ce(t("div",ui,null,512),[[L,H(w(I)),"apiResponse"]])])):V("",!0),r.value.includes("parsedResponse")?(o(),p("td",di,C(u(I)),1)):V("",!0),r.value.includes("length")?(o(),p("td",ci,C(m(I)),1)):V("",!0),r.value.includes("latency")?(o(),p("td",pi,[t("span",{class:ae(O((Q=I.response)==null?void 0:Q.latencyMs))},C(f((te=I.response)==null?void 0:te.latencyMs)),3)])):V("",!0)],10,Jo)])])]}),_:1},8,["items","item-size"])):(o(),p("table",fi,[t("thead",null,[t("tr",null,[r.value.includes("status")?(o(),p("th",mi,"Status")):V("",!0),r.value.includes("configuration")?(o(),p("th",vi,"Configuration")):V("",!0),r.value.includes("repeat")&&h.value?(o(),p("th",gi,"Repeat")):V("",!0),r.value.includes("variables")?(o(),p("th",hi,"Variables")):V("",!0),r.value.includes("response")?(o(),p("th",yi,"Response")):V("",!0),r.value.includes("parsedResponse")?(o(),p("th",_i,"Parsed Response")):V("",!0),r.value.includes("length")?(o(),p("th",bi,"Length")):V("",!0),r.value.includes("latency")?(o(),p("th",Ti,"Latency")):V("",!0)])]),t("tbody",null,[(o(!0),p(Z,null,se(E.value,I=>{var Q,te;return o(),p("tr",{key:I.id,class:ae(["result-row",`status-${I.status}`]),onClick:G=>Y(I)},[r.value.includes("status")?(o(),p("td",Ci,[t("div",ki,[t("span",{class:ae(["status-tag",`status-${I.status}`])},C(I.status.toUpperCase()),3),t("span",Si,C(d(I)),1)])])):V("",!0),r.value.includes("configuration")?(o(),p("td",wi,C(U(I.configurationIndex)),1)):V("",!0),r.value.includes("repeat")&&h.value?(o(),p("td",Ii," #"+C((I.repeatIndex||0)+1),1)):V("",!0),r.value.includes("variables")?(o(),p("td",Ri,[t("div",Ei,[(o(!0),p(Z,null,se(I.variables,(G,oe,x)=>(o(),p(Z,{key:oe},[n[8]||(n[8]=t("span",{class:"var-bullet"},"• ",-1)),Object.keys(I.variables).length<=2?(o(),p("span",Vi,C(oe)+": "+C(G),1)):(o(),p("span",Ai,C(G),1)),Object.keys(I.variables).length===2&&x===0?(o(),p("span",Oi,n[7]||(n[7]=[t("br",null,null,-1)]))):x<Object.keys(I.variables).length-1?(o(),p("span",Li,C("  "))):V("",!0)],64))),128))])])):V("",!0),r.value.includes("response")?(o(),p("td",Pi,[Ce(t("div",xi,null,512),[[L,H(w(I)),"apiResponse"]])])):V("",!0),r.value.includes("parsedResponse")?(o(),p("td",Fi,C(u(I)),1)):V("",!0),r.value.includes("length")?(o(),p("td",Di,C(m(I)),1)):V("",!0),r.value.includes("latency")?(o(),p("td",Mi,[t("span",{class:ae(O((Q=I.response)==null?void 0:Q.latencyMs))},C(f((te=I.response)==null?void 0:te.latencyMs)),3)])):V("",!0)],10,$i)}),128)),E.value.length===0?(o(),p("tr",Ui,[t("td",{colspan:r.value.length,class:"empty-state"},[T.value.length===0?(o(),p("div",Wi," No API calls yet. Start the trial to begin execution. ")):(o(),p("div",zi," No results match your filters. "))],8,Ni)])):V("",!0)])]))]),v.value?(o(),X(Fo,{key:0,visible:!!v.value,"api-call":v.value,trial:$.trial,"onUpdate:visible":n[4]||(n[4]=I=>v.value=null)},null,8,["visible","api-call","trial"])):V("",!0)])}}}),Bi=re(Hi,[["__scopeId","data-v-95899931"]]),ji={class:"trial-analysis-view"},Gi=ie({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(a){const e=a;return ge(()=>{const s=performance.now();y.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${e.trial.id}`),Te(()=>{const i=performance.now();y.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(i-s).toFixed(1)}ms`)}),setTimeout(()=>{const i=performance.now();y.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(i-s).toFixed(1)}ms`)},0)}),Ee(()=>{y.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Ve(()=>{y.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${e.trial.id}`)}),ye(()=>{y.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(s,i)=>(o(),p("div",ji,[R(Bi,{trial:s.trial,progress:s.progress,"is-executing":s.isExecuting,"api-calls":s.apiCalls,"is-streaming":s.isStreaming,"is-loading":s.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),qi=re(Gi,[["__scopeId","data-v-602f5d5a"]]);function Ki(a,e){const s=new Set,i=new Set,c=new Set;a.forEach(_=>{_.variables&&Object.keys(_.variables).forEach(E=>s.add(E)),_.variableAttributes&&Object.values(_.variableAttributes).forEach(E=>{E&&Object.keys(E).forEach(g=>i.add(g))})});const r=Array.from(s).sort(),v=Array.from(i).sort(),k=Array.from(c).sort(),T=[],l=["success","refused","parsed_response",...T,...k];return{categorical:[...r,...v,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...T].sort(),extracted:l}}function Ie(a,e,s){var i,c,r,v,k,T,l,_,E,g,S,h,b,A,U,w,u,m,f,d,O;switch(e){case"model":return s&&a.configurationIndex<s.configurations.length&&s.configurations[a.configurationIndex].modelId||"Unknown";case"status":return a.status;case"response_time":return((i=a.response)==null?void 0:i.latencyMs)||0;case"total_tokens":if((r=(c=a.response)==null?void 0:c.body)!=null&&r.usage){const H=a.response.body.usage;return H.total_tokens||H.prompt_tokens+H.completion_tokens||0}return 0;case"prompt_tokens":return((T=(k=(v=a.response)==null?void 0:v.body)==null?void 0:k.usage)==null?void 0:T.prompt_tokens)||((E=(_=(l=a.response)==null?void 0:l.body)==null?void 0:_.usage)==null?void 0:E.input_tokens)||0;case"completion_tokens":return((h=(S=(g=a.response)==null?void 0:g.body)==null?void 0:S.usage)==null?void 0:h.completion_tokens)||((U=(A=(b=a.response)==null?void 0:b.body)==null?void 0:A.usage)==null?void 0:U.output_tokens)||0;case"error_type":return((w=a.result)==null?void 0:w.errorType)||(((u=a.result)==null?void 0:u.success)===!1?"api_error":"success");case"success":return(m=a.result)!=null&&m.success?1:0;case"refused":return(f=a.result)!=null&&f.refused?1:0;case"parsed_response":if(((d=a.result)==null?void 0:d.parsedContent)!==void 0){const H=a.result.parsedContent;return typeof H=="object"?JSON.stringify(H):H}return null}if(((O=a.variables)==null?void 0:O[e])!==void 0)return a.variables[e];if(a.variableAttributes)for(const H of Object.keys(a.variableAttributes)){const Y=a.variableAttributes[H];if(Y&&Y[e]!==void 0)return Y[e]}return null}const Ae={count:{label:"Count",calculate:a=>a.length,format:a=>a.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:a=>{const e=a.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return e.length>0?e.reduce((s,i)=>s+i,0):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},mean:{label:"Mean",calculate:a=>{const e=a.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return e.length>0?e.reduce((s,i)=>s+i,0)/e.length:null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},median:{label:"Median",calculate:a=>{const e=a.map(c=>typeof c=="number"?c:null).filter(c=>c!==null);if(e.length===0)return null;const s=[...e].sort((c,r)=>c-r),i=Math.floor(s.length/2);return s.length%2===0?(s[i-1]+s[i])/2:s[i]},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},mode:{label:"Mode",calculate:a=>{if(a.length===0)return null;const e=new Map;a.forEach(c=>e.set(c,(e.get(c)||0)+1));let s=0,i=null;return e.forEach((c,r)=>{c>s&&(s=c,i=r)}),{value:i,count:s,total:a.length}},format:a=>a?`${a.value} (${a.count}/${a.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:a=>{const e=a.map(c=>typeof c=="number"?c:null).filter(c=>c!==null);if(e.length<=1)return null;const s=e.reduce((c,r)=>c+r,0)/e.length;return e.reduce((c,r)=>c+Math.pow(r-s,2),0)/(e.length-1)},format:a=>(a==null?void 0:a.toFixed(3))||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:a=>{const e=Ae.variance.calculate(a);return e!==null?Math.sqrt(e):null},format:a=>(a==null?void 0:a.toFixed(3))||"-",needsNumeric:!0},min:{label:"Min",calculate:a=>{const e=a.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return e.length>0?Math.min(...e):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},max:{label:"Max",calculate:a=>{const e=a.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return e.length>0?Math.max(...e):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(a,e)=>{const s=e.filter(i=>{var c;return(c=i.result)==null?void 0:c.success}).length;return e.length>0?s/e.length:0},format:a=>`${Math.round(a*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(a,e)=>{const s=e.filter(i=>{var c;return(c=i.result)==null?void 0:c.refused}).length;return e.length>0?s/e.length:0},format:a=>`${Math.round(a*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(a,e)=>{const s=e.filter(i=>{var c;return(c=i.response)==null?void 0:c.latencyMs}).map(i=>i.response.latencyMs);return s.length>0?s.reduce((i,c)=>i+c,0)/s.length:null},format:a=>a?`${Math.round(a)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function $t(a,e,s){const i=new Map,c=new Set,r=new Set;a.forEach(h=>{const b=String(Ie(h,e.rowField,s)||"Unknown"),A=String(Ie(h,e.columnField,s)||"Unknown");c.add(b),r.add(A),i.has(b)||i.set(b,new Map),i.get(b).has(A)||i.get(b).set(A,[]),i.get(b).get(A).push(h)});const v=h=>h.every(A=>!isNaN(Number(A))&&A.trim()!=="")?h.sort((A,U)=>Number(A)-Number(U)):h.sort(),k=(h,b)=>(s&&(s.type,s.type),v(h)),T=e.rowSort==="original"?k(Array.from(c),e.rowField):v(Array.from(c)),l=e.columnSort==="original"?k(Array.from(r),e.columnField):v(Array.from(r)),_=Ae[e.aggregation];function E(h){const b=h.map(u=>Ie(u,e.valueField,s));if(!_||typeof _.calculate!="function")return y.error("Invalid aggregation function:",e.aggregation,_),{value:null,count:h.length,apiCalls:h,rawValues:b,error:"Invalid aggregation function"};const A={nonNumeric:0,nullUndefined:0};return _.needsNumeric&&(A.nonNumeric=b.filter(u=>typeof u!="number").length),A.nullUndefined=b.filter(u=>u==null).length,{value:_.usesApiCalls?_.calculate(b,h):_.calculate(b),count:h.length,apiCalls:h,rawValues:b,excludedCounts:A}}const g=T.map(h=>{const b=[],A=[];return l.forEach(U=>{var u;const w=((u=i.get(h))==null?void 0:u.get(U))||[];b.push(w.length>0?E(w):null),A.push(...w)}),{label:h,cells:b,total:E(A)}}),S=l.map(h=>{const b=[];return T.forEach(A=>{var w;const U=((w=i.get(A))==null?void 0:w.get(h))||[];b.push(...U)}),E(b)});return{rows:g,columns:l,totals:S,grandTotal:E(a)}}function _e(a,e){return!a||a.value===null?"-":Ae[e].format(a.value)}function Qi(a){if(!a||Object.keys(a).length===0)return"";const e=[];return a.temperature!==void 0&&e.push(`T:${a.temperature}`),a.max_tokens!==void 0?e.push(`${a.max_tokens}t`):a.maxTokens!==void 0?e.push(`${a.maxTokens}t`):a.num_predict!==void 0&&e.push(`${a.num_predict}t`),a.top_p!==void 0&&e.push(`p:${a.top_p}`),a.top_k!==void 0&&e.push(`k:${a.top_k}`),e.length>0?`(${e.join(", ")})`:""}function Ji(a,e,s,i=B({}),c={}){const{debounceMs:r=100}=c,v=B({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),k=B({categorical:[],numeric:[],extracted:[]}),T=B(!1),l=B(0),_=D(()=>{const h=i.value;return Object.values(h).some(A=>A!=="")?a.value.filter(A=>{var U;if(h.model&&h.model!==""){if(!s.value||A.configurationIndex>=s.value.configurations.length)return!1;const w=s.value.configurations[A.configurationIndex],u=w.modelId||"Unknown",m=Qi(w.parameters);if((m?`${u} ${m}`:u)!==h.model)return!1}if(h.status&&h.status!==""&&A.status!==h.status)return!1;for(const[w,u]of Object.entries(h))if(u&&u!==""&&w!=="model"&&w!=="status"&&((U=A.variables)==null?void 0:U[w])!==u)return!1;return!0}):a.value}),E=Ke(()=>{if(_.value.length===0){v.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}T.value=!0;const h=performance.now();try{v.value=$t(_.value,e.value,s.value);const b=performance.now()-h;l.value=b,y.debug("Pivot data computed (config change)",{apiCallCount:_.value.length,computeTimeMs:b,rowCount:v.value.rows.length,columnCount:v.value.columns.length})}catch(b){y.error("Error computing pivot data",b)}finally{T.value=!1}},r),g=Ke(()=>{if(_.value.length===0){v.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}T.value=!0;const h=performance.now();try{v.value=$t(_.value,e.value,s.value);const b=performance.now()-h;l.value=b,y.debug("Pivot data computed (stream update)",{apiCallCount:_.value.length,computeTimeMs:b,rowCount:v.value.rows.length,columnCount:v.value.columns.length})}catch(b){y.error("Error computing pivot data",b)}finally{T.value=!1}},200),S=Ke(()=>{k.value=Ki(a.value,s.value)},200);return ce([e],()=>{y.info("PIVOT_DEBUG: Config changed, recomputing pivot"),E()},{deep:!0}),ce(_,(h,b)=>{const A=(b==null?void 0:b.length)||0,U=h.length;y.info(`PIVOT_DEBUG: filteredApiCalls changed from ${A} to ${U}`),(A!==U||U>0)&&g()},{immediate:!0}),ce([a,s],()=>{y.info(`PIVOT_DEBUG: apiCalls (${a.value.length}) or trial changed, updating fields`),S()},{immediate:!0}),S(),{pivotData:D(()=>v.value),availableFields:D(()=>k.value),isComputing:D(()=>T.value),lastComputeTime:D(()=>l.value),formatCellValue:_e,extractFieldValue:Ie,aggregationFunctions:Ae}}const Yi={class:"pivot-config-v3"},Xi={class:"config-row"},Zi={class:"config-group"},er=["value","aria-label"],tr={label:"Categorical"},sr=["value"],ar={class:"config-group sort-group"},nr=["value","aria-label"],lr={class:"config-group"},or=["value","aria-label"],ir={label:"Categorical"},rr=["value"],ur={class:"config-group sort-group"},dr=["value","aria-label"],cr={class:"config-group"},pr=["value","aria-label"],fr={label:"Extracted Values"},mr=["value"],vr={label:"Numeric Fields"},gr=["value"],hr={class:"config-group"},yr=["value","aria-label"],_r=ie({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(a,{emit:e}){const s=e;function i(r,v){s("update-config",r,v)}function c(r){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[r]||r.replace(/_/g," ").replace(/\b\w/g,k=>k.toUpperCase())}return(r,v)=>(o(),p("div",Yi,[t("div",Xi,[t("div",Zi,[v[6]||(v[6]=t("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),t("select",{id:"pivot-row-field",value:r.config.rowField,"aria-label":"Group rows by "+c(r.config.rowField),onChange:v[0]||(v[0]=k=>i("rowField",k.target.value))},[t("optgroup",tr,[(o(!0),p(Z,null,se(r.availableFields.categorical,k=>(o(),p("option",{key:k,value:k},C(c(k)),9,sr))),128))])],40,er)]),t("div",ar,[v[8]||(v[8]=t("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),t("select",{id:"pivot-row-sort",value:r.config.rowSort||"original","aria-label":"Sort rows by "+(r.config.rowSort||"original")+" order",onChange:v[1]||(v[1]=k=>i("rowSort",k.target.value))},v[7]||(v[7]=[t("option",{value:"original"},"Original",-1),t("option",{value:"alpha"},"Alphabetical",-1)]),40,nr)]),t("div",lr,[v[9]||(v[9]=t("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),t("select",{id:"pivot-column-field",value:r.config.columnField,"aria-label":"Group columns by "+c(r.config.columnField),onChange:v[2]||(v[2]=k=>i("columnField",k.target.value))},[t("optgroup",ir,[(o(!0),p(Z,null,se(r.availableFields.categorical,k=>(o(),p("option",{key:k,value:k},C(c(k)),9,rr))),128))])],40,or)]),t("div",ur,[v[11]||(v[11]=t("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),t("select",{id:"pivot-column-sort",value:r.config.columnSort||"original","aria-label":"Sort columns by "+(r.config.columnSort||"original")+" order",onChange:v[3]||(v[3]=k=>i("columnSort",k.target.value))},v[10]||(v[10]=[t("option",{value:"original"},"Original",-1),t("option",{value:"alpha"},"Alphabetical",-1)]),40,dr)]),t("div",cr,[v[12]||(v[12]=t("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),t("select",{id:"pivot-value-field",value:r.config.valueField,"aria-label":"Aggregate "+r.config.valueField+" values",onChange:v[4]||(v[4]=k=>i("valueField",k.target.value))},[t("optgroup",fr,[(o(!0),p(Z,null,se(r.availableFields.extracted,k=>(o(),p("option",{key:k,value:k},C(k),9,mr))),128))]),t("optgroup",vr,[(o(!0),p(Z,null,se(r.availableFields.numeric,k=>(o(),p("option",{key:k,value:k},C(c(k)),9,gr))),128))])],40,pr)]),t("div",hr,[v[14]||(v[14]=t("label",{for:"pivot-aggregation"},"Aggregation:",-1)),t("select",{id:"pivot-aggregation",value:r.config.aggregation,"aria-label":"Aggregation method: "+r.config.aggregation,onChange:v[5]||(v[5]=k=>i("aggregation",k.target.value))},v[13]||(v[13]=[Vt('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,yr)])])]))}}),br=re(_r,[["__scopeId","data-v-0d3a0d50"]]),Tr={class:"heatmap-controls-v3"},$r={class:"color-scale-selector"},Cr=["value","aria-label"],kr={class:"gradient-mode-selector"},Sr={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},wr=["aria-pressed"],Ir=["aria-pressed"],Rr=["aria-pressed"],Er=["title","aria-label"],Vr=ie({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(a,{emit:e}){const s=e;function i(r){const v=r.target.value;s("update-color-scale",v)}function c(r){s("update-gradient-mode",r)}return(r,v)=>(o(),p("div",Tr,[t("div",$r,[v[5]||(v[5]=t("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),t("select",{id:"heatmap-color-scale",value:r.selectedColorScale,"aria-label":"Color scale: "+r.selectedColorScale,onChange:i},v[4]||(v[4]=[Vt('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,Cr)]),t("div",kr,[v[6]||(v[6]=t("label",null,"Gradient Mode:",-1)),t("div",Sr,[t("button",{type:"button",class:ae(["toggle-btn",{active:r.gradientMode==="global"}]),"aria-pressed":r.gradientMode==="global",onClick:v[0]||(v[0]=k=>c("global"))}," Global ",10,wr),t("button",{type:"button",class:ae(["toggle-btn",{active:r.gradientMode==="column"}]),"aria-pressed":r.gradientMode==="column",onClick:v[1]||(v[1]=k=>c("column"))}," Per Column ",10,Ir),t("button",{type:"button",class:ae(["toggle-btn",{active:r.gradientMode==="row"}]),"aria-pressed":r.gradientMode==="row",onClick:v[2]||(v[2]=k=>c("row"))}," Per Row ",10,Rr)])]),t("button",{type:"button",class:"fullscreen-btn",title:r.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":r.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:v[3]||(v[3]=k=>r.$emit("toggle-fullscreen"))},C(r.isFullscreen?"⊟":"⊞"),9,Er)]))}}),Ar=re(Vr,[["__scopeId","data-v-dcb6369b"]]),Or={class:"pivot-filters-v3"},Lr={class:"filters-row"},Pr={key:0,class:"filter-group"},xr=["value"],Fr=["value"],Dr=["for"],Mr=["id","value","aria-label","onChange"],Ur={value:""},Nr=["value"],Wr={key:1,class:"filter-group"},zr=["value"],Hr=["value"],Br=ie({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(a,{emit:e}){const s=a,i=e,c=B({});let r=0;const v=()=>{if(s.apiCalls.length===0){c.value={};return}const g={};s.apiCalls.forEach(h=>{if(s.trial&&h.configurationIndex<s.trial.configurations.length){const b=s.trial.configurations[h.configurationIndex],A=b.modelId||"Unknown",U=l(b.parameters),w=U?`${A} ${U}`:A;g.model||(g.model=new Set),g.model.add(w)}h.status&&(g.status||(g.status=new Set),g.status.add(h.status)),h.variables&&Object.entries(h.variables).forEach(([b,A])=>{A&&String(A).trim()&&(g[b]||(g[b]=new Set),g[b].add(String(A)))})});const S={};Object.entries(g).forEach(([h,b])=>{S[h]=Array.from(b).sort()}),c.value=S};ce(()=>s.apiCalls.length,g=>{(g===0||r===0||g-r>=5)&&(v(),r=g)},{immediate:!0});const k=D(()=>{const{model:g,status:S,...h}=c.value;return h}),T=D(()=>Object.values(s.activeFilters).some(g=>g!==""));function l(g){if(!g||Object.keys(g).length===0)return"";const S=[];return g.temperature!==void 0&&S.push(`T:${g.temperature}`),g.max_tokens!==void 0?S.push(`${g.max_tokens}t`):g.maxTokens!==void 0?S.push(`${g.maxTokens}t`):g.num_predict!==void 0&&S.push(`${g.num_predict}t`),g.top_p!==void 0&&S.push(`p:${g.top_p}`),g.top_k!==void 0&&S.push(`k:${g.top_k}`),S.length>0?`(${S.join(", ")})`:""}function _(g){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[g]||g.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())}function E(g,S){const h={...s.activeFilters};S===""?delete h[g]:h[g]=S,i("update-filters",h)}return(g,S)=>(o(),p("div",Or,[t("div",Lr,[c.value.model&&c.value.model.length>1?(o(),p("div",Pr,[S[4]||(S[4]=t("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),t("select",{id:"filter-model",value:g.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:S[0]||(S[0]=h=>E("model",h.target.value))},[S[3]||(S[3]=t("option",{value:""},"All Models",-1)),(o(!0),p(Z,null,se(c.value.model,h=>(o(),p("option",{key:h,value:h},C(h),9,Fr))),128))],40,xr)])):V("",!0),(o(!0),p(Z,null,se(k.value,(h,b)=>(o(),p("div",{key:b,class:"filter-group"},[t("label",{for:`filter-${b}`,class:"filter-label"},C(_(String(b)))+": ",9,Dr),t("select",{id:`filter-${b}`,value:g.activeFilters[b]||"",class:"filter-select","aria-label":`Filter by ${_(String(b))}`,onChange:A=>E(String(b),A.target.value)},[t("option",Ur,"All "+C(_(String(b))),1),(o(!0),p(Z,null,se(h,A=>(o(),p("option",{key:A,value:A},C(A),9,Nr))),128))],40,Mr)]))),128)),c.value.status&&c.value.status.length>1?(o(),p("div",Wr,[S[6]||(S[6]=t("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),t("select",{id:"filter-status",value:g.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:S[1]||(S[1]=h=>E("status",h.target.value))},[S[5]||(S[5]=t("option",{value:""},"All Statuses",-1)),(o(!0),p(Z,null,se(c.value.status,h=>(o(),p("option",{key:h,value:h},C(h),9,Hr))),128))],40,zr)])):V("",!0),T.value?(o(),p("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:S[2]||(S[2]=h=>g.$emit("clear-filters"))}," Clear Filters ")):V("",!0)])]))}}),jr=re(Br,[["__scopeId","data-v-d5848163"]]),Gr={class:"collapse-icon"},qr={class:"options-content"},Kr={class:"controls-row"},Qr={key:0,class:"performance-info"},Jr={class:"table-view"},Yr={key:0,class:"empty-state","data-testid":"empty-data-message"},Xr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Zr={key:2,class:"loading-state","data-testid":"computing-state"},eu={key:3,class:"pivot-table-container"},tu={class:"pivot-table-grid responsive-table",role:"table"},su={role:"row"},au={class:"corner-cell",role:"columnheader"},nu={key:0,class:"total-header",role:"columnheader"},lu={class:"row-header",role:"rowheader"},ou=["data-testid","title","aria-label","role","onClick","onKeydown"],iu={key:0,class:"cell-content"},ru=["title"],uu={class:"cell-value"},du={class:"error-message"},cu={key:1},pu=ie({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(a,{emit:e}){var oe,x,fe,Oe,ke,Le;const s=a,i=e,c=B(!1),r=B("viridis"),v=B("global"),k=B(!1),T=B({rowField:((oe=s.config)==null?void 0:oe.rowField)||"",columnField:((x=s.config)==null?void 0:x.columnField)||"",valueField:((fe=s.config)==null?void 0:fe.valueField)||"",aggregation:((Oe=s.config)==null?void 0:Oe.aggregation)||"mean",rowSort:((ke=s.config)==null?void 0:ke.rowSort)||"original",columnSort:((Le=s.config)==null?void 0:Le.columnSort)||"original"});ce(()=>s.config,z=>{z&&Object.assign(T.value,z)},{deep:!0});const l=B({}),_=je(),E=D(()=>_.apiCalls?_.apiCalls.value||[]:s.apiCalls||[]),g=E,S=D(()=>s.trial),{pivotData:h,availableFields:b,isComputing:A,lastComputeTime:U}=Ji(g,T,S,l,{debounceMs:750});ce(h,(z,j)=>{var pe,Se;const q=performance.now(),K=((pe=z==null?void 0:z.rows)==null?void 0:pe.length)||0,ue=((Se=z==null?void 0:z.columns)==null?void 0:Se.length)||0;y.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${K}x${ue} matrix`),setTimeout(()=>{const Ge=performance.now();y.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(Ge-q).toFixed(1)}ms`)},0)}),ce(A,z=>{z?y.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${E.value.length} API calls`):y.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${U.value.toFixed(1)}ms`)}),ce(E,(z,j)=>{const q=performance.now();y.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${(j==null?void 0:j.length)||0} to ${z.length} calls`),setTimeout(()=>{const K=performance.now();y.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(K-q).toFixed(1)}ms`)},0)});const w=D(()=>h.value.rows.slice(0,s.maxTableRows)),u=D(()=>Object.values(l.value).some(j=>j!=="")?E.value.filter(j=>{var q;if(l.value.model&&l.value.model!==""){if(!s.trial||j.configurationIndex>=s.trial.configurations.length)return!1;const K=s.trial.configurations[j.configurationIndex],ue=K.modelId||"Unknown",pe=O(K.parameters);if((pe?`${ue} ${pe}`:ue)!==l.value.model)return!1}if(l.value.status&&l.value.status!==""&&j.status!==l.value.status)return!1;for(const[K,ue]of Object.entries(l.value))if(ue&&ue!==""&&K!=="model"&&K!=="status"&&((q=j.variables)==null?void 0:q[K])!==ue)return!1;return!0}).length:E.value.length),{getCellStyle:m,getSummaryStyle:f,styleKey:d}=Ss(h,r,v);function O(z){if(!z||Object.keys(z).length===0)return"";const j=[];return z.temperature!==void 0&&j.push(`T:${z.temperature}`),z.max_tokens!==void 0?j.push(`${z.max_tokens}t`):z.maxTokens!==void 0?j.push(`${z.maxTokens}t`):z.num_predict!==void 0&&j.push(`${z.num_predict}t`),z.top_p!==void 0&&j.push(`p:${z.top_p}`),z.top_k!==void 0&&j.push(`k:${z.top_k}`),j.length>0?`(${j.join(", ")})`:""}function H(z){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[z]||z.replace(/_/g," ").replace(/\b\w/g,q=>q.toUpperCase())}function Y(z,j,q){if(!q)return`${z} × ${j}: No data`;const K=_e(q,T.value.aggregation);let ue=`${z} × ${j}: ${K} (${q.count} calls)`;if(q.excludedCounts){const pe=[];q.excludedCounts.nonNumeric>0&&pe.push(`${q.excludedCounts.nonNumeric} non-numeric responses excluded`),q.excludedCounts.nullUndefined>0&&pe.push(`${q.excludedCounts.nullUndefined} null/empty responses`),pe.length>0&&(ue+=` | ${pe.join(", ")}`)}return q.error&&(ue+=` - ERROR: ${q.error}`),ue}function $(z,j,q){if(!q)return`${z} by ${j}: No data`;const K=_e(q,T.value.aggregation);return q.error?`${z} by ${j}: ${K} with data integrity error: ${q.error}`:`${z} by ${j}: ${K} from ${q.count} API calls`}function n(z,j){(z==="rowField"||z==="columnField"||z==="valueField"||z==="aggregation"||z==="rowSort"||z==="columnSort")&&(T.value[z]=j),i("config-change",{...T.value})}function L(z){l.value={...z}}function I(){l.value={}}function Q(z,j,q){q&&i("cell-click",{row:z,column:j,cell:q})}function te(){k.value=!k.value}function G(){c.value=!c.value,c.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return ge(()=>{var j;const z=performance.now();y.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${((j=s.trial)==null?void 0:j.id)||"unknown"} with ${E.value.length} calls`),Te(()=>{const q=performance.now();y.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(q-z).toFixed(1)}ms`)}),setTimeout(()=>{const q=performance.now();y.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(q-z).toFixed(1)}ms`)},0)}),Ee(()=>{var z;y.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${((z=s.trial)==null?void 0:z.id)||"unknown"} with ${E.value.length} calls`)}),Ve(()=>{var z;y.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${((z=s.trial)==null?void 0:z.id)||"unknown"}`)}),ye(()=>{var z;y.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${((z=s.trial)==null?void 0:z.id)||"unknown"}`),c.value&&(document.body.style.overflow="")}),ce([b,E],([z])=>{if(E.value.length>0&&(!T.value.rowField||T.value.rowField==="")&&z.categorical.length>0){if(T.value.rowField=z.categorical.find(j=>j!=="model"&&j!=="status"&&j!=="error_type")||z.categorical[0]||"model",T.value.columnField=T.value.columnField||"model",T.value.valueField=T.value.valueField||"parsed_response",!T.value.aggregation||T.value.aggregation===""){const j=E.value.slice(0,3).map(K=>Ie(K,T.value.valueField,s.trial)).filter(K=>K!=null),q=j.length>0&&j.every(K=>typeof K=="number");T.value.aggregation=q?"mean":"mode"}i("config-change",{...T.value})}},{immediate:!0}),(z,j)=>(o(),p("div",{class:ae(["pivot-table-v3",{fullscreen:c.value}])},[t("div",{class:ae(["pivot-options-container",{collapsed:k.value}])},[t("div",{class:"options-header",onClick:te},[j[3]||(j[3]=t("span",{class:"options-title"},"Pivot Table Options",-1)),t("span",Gr,C(k.value?"▶":"▼"),1)]),Ce(t("div",qr,[fs([W(b),T.value],()=>(o(),p("div",null,[R(br,{config:T.value,"available-fields":W(b),onUpdateConfig:n},null,8,["config","available-fields"])])),j,0),t("div",Kr,[E.value.length>0?(o(),X(jr,{key:0,"api-calls":E.value,trial:z.trial,"active-filters":l.value,onUpdateFilters:L,onClearFilters:I},null,8,["api-calls","trial","active-filters"])):V("",!0),R(Ar,{"selected-color-scale":r.value,"gradient-mode":v.value,"is-fullscreen":c.value,onUpdateColorScale:j[1]||(j[1]=q=>r.value=q),onUpdateGradientMode:j[2]||(j[2]=q=>v.value=q),onToggleFullscreen:G},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[At,!k.value]])],2),z.showPerformanceInfo?(o(),p("div",Qr,[t("span",null,"Computing: "+C(W(A)?"Yes":"No"),1),t("span",null,"Last Compute: "+C(W(U).toFixed(1))+"ms",1),t("span",null,"API Calls: "+C(E.value.length),1),t("span",null,"Filtered: "+C(u.value),1)])):V("",!0),t("div",Jr,[E.value.length===0?(o(),p("div",Yr,j[4]||(j[4]=[t("p",null,"No data available for pivot table analysis.",-1)]))):T.value.aggregation in W(Ae)?W(A)?(o(),p("div",Zr,j[6]||(j[6]=[t("p",null,"Computing pivot table...",-1)]))):(o(),p("div",eu,[t("table",tu,[t("thead",null,[t("tr",su,[t("th",au,C(H(T.value.rowField)||"Items")+" / "+C(H(T.value.columnField)||"Aggregated"),1),(o(!0),p(Z,null,se(W(h).columns,q=>(o(),p("th",{key:q,class:"column-header",role:"columnheader"},C(q),1))),128)),T.value.columnField&&z.showTotals?(o(),p("th",nu," Total ")):V("",!0)])]),t("tbody",null,[(o(!0),p(Z,null,se(w.value,q=>(o(),p("tr",{key:`${q.label}-${W(d)}`,class:"data-row",role:"row"},[t("td",lu,C(q.label),1),(o(!0),p(Z,null,se(q.cells,(K,ue)=>(o(),p("td",{key:`${ue}-${W(d)}`,class:ae(["data-cell",{"error-cell":K==null?void 0:K.error}]),"data-testid":K!=null&&K.error?"pivot-cell-error":"pivot-cell",style:he(W(m)(K,q.label,ue)),title:Y(q.label,W(h).columns[ue],K),"aria-label":$(q.label,W(h).columns[ue],K),role:K!=null&&K.error?"alert":"cell",tabindex:"0",onClick:pe=>Q(q.label,W(h).columns[ue],K),onKeydown:[Je(pe=>Q(q.label,W(h).columns[ue],K),["enter"]),Je(Ot(pe=>Q(q.label,W(h).columns[ue],K),["prevent"]),["space"])]},[K!=null&&K.error?(o(),p("div",iu,[t("span",{class:"error-indicator",title:K.error},"⚠️",8,ru),t("span",uu,C(K?W(_e)(K,T.value.aggregation):"-"),1),t("div",du,C(K.error),1)])):(o(),p("span",cu,C(K?W(_e)(K,T.value.aggregation):"-"),1))],46,ou))),128)),T.value.columnField&&z.showTotals?(o(),p("td",{key:0,class:"total-cell",style:he(W(f)(q.total)),role:"cell"},C(W(_e)(q.total,T.value.aggregation)),5)):V("",!0)]))),128)),T.value.rowField&&z.showTotals?(o(),p("tr",{key:`totals-${W(d)}`,class:"total-row",role:"row"},[j[7]||(j[7]=t("td",{class:"row-header",role:"rowheader"},"Total",-1)),(o(!0),p(Z,null,se(W(h).totals,(q,K)=>(o(),p("td",{key:`total-${K}-${W(d)}`,class:"total-cell",style:he(W(f)(q)),role:"cell"},C(W(_e)(q,T.value.aggregation)),5))),128)),T.value.columnField?(o(),p("td",{key:0,class:"grand-total-cell",style:he(W(f)(W(h).grandTotal)),role:"cell"},C(W(_e)(W(h).grandTotal,T.value.aggregation)),5)):V("",!0)])):V("",!0)])])])):(o(),p("div",Xr,[t("p",null,"Invalid aggregation function: "+C(T.value.aggregation),1),j[5]||(j[5]=t("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),fu=re(pu,[["__scopeId","data-v-2d987e50"]]),mu={class:"modal-content"},vu={class:"modal-header"},gu={class:"modal-title"},hu={class:"summary-row"},yu={key:0},_u={key:0,class:"filter-row"},bu=["onUpdate:modelValue","aria-label"],Tu={value:""},$u=["value"],Cu={class:"table-container"},ku={class:"api-calls-table"},Su=["title"],wu=["title"],Iu=ie({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(a){const e=a,s=ms({}),i=D(()=>{const u=new Set;return e.apiCalls.forEach(m=>{m.variables&&Object.keys(m.variables).forEach(f=>u.add(f)),m.attributedVariables&&Object.entries(m.attributedVariables).forEach(([f,d])=>{d&&typeof d=="object"&&Object.keys(d).forEach(O=>{u.add(`${f}.${O}`)})})}),Array.from(u).sort()}),c=D(()=>i.value.map(u=>({title:u,dataIndex:`var_${u}`,key:`var_${u}`,width:150}))),r=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],v=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],k=D(()=>[...r,...c.value,...v]),T=D(()=>`${e.row} × ${e.column} - ${e.apiCalls.length} API Calls`),l=D(()=>e.apiCalls.map(u=>{var f,d;const m={id:u.id,status:u.status,model:u.model||"-",response:((f=u.result)==null?void 0:f.content)||((d=u.result)==null?void 0:d.error)||"-",extracted:u.extracted||"-",duration:u.duration?`${u.duration}ms`:"-",cost:u.cost||0};return i.value.forEach(O=>{var H,Y,$;if(O.includes(".")){const[n,L]=O.split("."),I=(Y=(H=u.attributedVariables)==null?void 0:H[n])==null?void 0:Y[L];m[`var_${O}`]=I!==void 0?String(I):"-"}else m[`var_${O}`]=(($=u.variables)==null?void 0:$[O])||"-"}),m})),_=D(()=>Object.values(s).some(u=>u!==void 0&&u!=="")),E=D(()=>_.value?l.value.filter(u=>Object.entries(s).every(([m,f])=>f?u[m]===f:!0)):l.value),g=D(()=>{const u=e.apiCalls.filter(m=>m.status==="completed").length;return Math.round(u/e.apiCalls.length*100)}),S=D(()=>{const u=e.apiCalls.filter(m=>m.duration).map(m=>m.duration);return u.length===0?0:Math.round(u.reduce((m,f)=>m+f,0)/u.length)}),h=D(()=>e.apiCalls.filter(m=>m.cost).map(m=>m.cost).reduce((m,f)=>m+f,0));function b(u){switch(u){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function A(u,m){return u?u.length<=m?u:u.slice(0,m)+"...":""}function U(u){const m=new Set;return l.value.forEach(f=>{const d=f[u];d&&d!=="-"&&m.add(d)}),Array.from(m).sort()}function w(){Object.keys(s).forEach(u=>{delete s[u]})}return(u,m)=>(o(),p("div",{class:ae(["pivot-cell-detail-modal-v3",{visible:u.visible}]),onClick:m[1]||(m[1]=Ot(f=>u.$emit("close"),["self"]))},[t("div",mu,[t("div",vu,[t("h3",gu,C(T.value),1),t("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:m[0]||(m[0]=f=>u.$emit("close"))}," × ")]),t("div",hu,[t("span",null,[m[2]||(m[2]=t("b",null,"Total:",-1)),M(" "+C(u.apiCalls.length),1)]),t("span",null,[m[3]||(m[3]=t("b",null,"Success Rate:",-1)),M(" "+C(g.value)+"%",1)]),t("span",null,[m[4]||(m[4]=t("b",null,"Avg Duration:",-1)),M(" "+C(S.value)+"ms",1)]),h.value>0?(o(),p("span",yu,[m[5]||(m[5]=t("b",null,"Total Cost:",-1)),M(" $"+C(h.value),1)])):V("",!0)]),c.value.length>0?(o(),p("div",_u,[(o(!0),p(Z,null,se(c.value,f=>(o(),p("div",{key:f.key,class:"variable-filter"},[Ce(t("select",{"onUpdate:modelValue":d=>s[f.key]=d,"aria-label":`Filter ${f.title}`,class:"filter-select"},[t("option",Tu,"All "+C(f.title),1),(o(!0),p(Z,null,se(U(f.key),d=>(o(),p("option",{key:d,value:d},C(d),9,$u))),128))],8,bu),[[vs,s[f.key]]])]))),128)),_.value?(o(),p("button",{key:0,type:"button",class:"clear-filters-btn",onClick:w}," Clear Filters ")):V("",!0)])):V("",!0),t("div",Cu,[t("table",ku,[t("thead",null,[t("tr",null,[(o(!0),p(Z,null,se(k.value,f=>(o(),p("th",{key:f.key,class:"table-header",style:he({width:f.width?`${f.width}px`:"auto"})},C(f.title),5))),128))])]),t("tbody",null,[(o(!0),p(Z,null,se(E.value,f=>(o(),p("tr",{key:f.id,class:"table-row"},[(o(!0),p(Z,null,se(k.value,d=>(o(),p("td",{key:d.key,class:ae(["table-cell",{"status-cell":d.key==="status"}])},[d.key==="status"?(o(),p("span",{key:0,class:ae(["status-tag",b(f.status)])},C(f.status),3)):d.key==="response"?(o(),p("span",{key:1,class:"response-cell",title:f.response},C(A(f.response,100)),9,Su)):d.key==="cost"?(o(),p(Z,{key:2},[M(C(f.cost===0?"-":`$${f.cost.toFixed(4)}`),1)],64)):d.key.startsWith("var_")?(o(),p("span",{key:3,class:"variable-cell",title:f[d.key]},C(f[d.key]||"-"),9,wu)):(o(),p(Z,{key:4},[M(C(f[d.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),Ru=re(Iu,[["__scopeId","data-v-2738b696"]]),Eu={class:"trial-tab-content"},Vu={class:"tab-pane-content"},Au={class:"tab-pane-content"},Ou={key:0,class:"no-data-message"},Lu={class:"tab-pane-content"},Ct="trial-details-active-tab",Pu=ie({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(a){const e=a,s=Lt(),i=We(),c=je(),r=D(()=>{var w;return((w=c.apiCalls)==null?void 0:w.value)||[]}),v=D(()=>{var w;return((w=c.isStreaming)==null?void 0:w.value)||!1});ce(r,(w,u)=>{const m=performance.now();y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${(u==null?void 0:u.length)||0} to ${w.length} calls`),setTimeout(()=>{const f=performance.now();y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(f-m).toFixed(1)}ms`)},0)});const k=D(()=>!1),l=B((()=>{const w=s.query.tab;return w==="status"?"details":w&&["details","tasks","pivot"].includes(w)?w:"tasks"})()),_=B(!1),E=B(!1),g=B({row:"",column:"",apiCalls:[],value:null}),S=D(()=>{var w,u;return((w=e.executionState)==null?void 0:w.status)==="executing"&&((u=e.executionState)==null?void 0:u.currentTrialId)===e.trial.id}),h=D(()=>e.trial.progress.completed>0);function b(){localStorage.setItem(Ct,l.value);const w={...s.query};w.tab=l.value,s.query.tab!==l.value&&(i.replace({query:w}),y.info(`TAB_ROUTING: Updated URL tab parameter to '${l.value}'`))}function A(){const w=localStorage.getItem(Ct);w==="status"?l.value="details":w&&["details","tasks","pivot"].includes(w)&&(l.value=w)}function U(w){!w.cell||!w.cell.apiCalls.length||(g.value={row:w.row,column:w.column,apiCalls:w.cell.apiCalls,value:w.cell.value},E.value=!0)}return ce(l,()=>{b()}),ce(()=>s.query.tab,w=>{if(w&&typeof w=="string"){let u=w==="status"?"details":w;["details","tasks","pivot"].includes(u)&&l.value!==u&&(l.value=u,y.info(`TAB_ROUTING: Synced tab to URL parameter '${u}'`))}}),ge(()=>{const w=performance.now();if(y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${e.trial.id}`),!s.query.tab){const u={...s.query};u.tab=l.value,i.replace({query:u}),y.info(`TAB_ROUTING: Set initial URL tab parameter to '${l.value}'`)}A(),setTimeout(()=>{const u=performance.now();y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(u-w).toFixed(1)}ms`)},0)}),Ee(()=>{y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Ve(()=>{y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${e.trial.id}`)}),ye(()=>{y.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(w,u)=>{const m=J("a-tab-pane"),f=J("a-tabs");return o(),p("div",Eu,[R(f,{activeKey:l.value,"onUpdate:activeKey":u[1]||(u[1]=d=>l.value=d),type:"card",class:"trial-tabs"},{default:P(()=>[R(m,{key:"tasks",tab:"Task View"},{default:P(()=>[t("div",Vu,[(o(),X(Xe,null,[R(qi,{trial:w.trial,progress:w.progress,"is-executing":S.value,"api-calls":r.value,"is-streaming":v.value,"is-loading":k.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),R(m,{key:"pivot",tab:"Pivot Table"},{default:P(()=>[t("div",Au,[(o(),X(Xe,null,[h.value&&r.value.length>0?(o(),X(fu,{key:0,"api-calls":r.value,trial:w.trial,"show-performance-info":!1,onCellClick:U},null,8,["api-calls","trial"])):V("",!0)],1024)),h.value&&r.value.length>0?V("",!0):(o(),p("div",Ou,u[3]||(u[3]=[t("p",null,"No completed API calls available for pivot analysis.",-1),t("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),R(m,{key:"details",tab:"Details"},{default:P(()=>[t("div",Lu,[R(Rl,{trial:w.trial,"is-collapsed":_.value,onToggleCollapse:u[0]||(u[0]=d=>_.value=!_.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),E.value?(o(),X(Ru,{key:0,visible:E.value,row:g.value.row,column:g.value.column,"api-calls":g.value.apiCalls,trial:w.trial,value:g.value.value,onClose:u[2]||(u[2]=d=>E.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):V("",!0)])}}}),xu=re(Pu,[["__scopeId","data-v-d2c24429"]]),Fu={class:"export-content"},Du={class:"section"},Mu={key:0,class:"section"},Uu={class:"bundle-info"},Nu={key:0},Wu={key:1,class:"section"},zu={class:"field-actions"},Hu={class:"field-groups"},Bu={class:"field-group"},ju={class:"field-list"},Gu={class:"field-group"},qu={class:"field-list"},Ku={class:"field-group"},Qu={class:"field-list"},Ju={class:"field-group"},Yu={class:"field-list"},Xu={class:"field-group"},Zu={class:"field-list"},ed={key:0,class:"field-group"},td={class:"field-list"},sd={key:1,class:"field-group"},ad={class:"field-list"},nd={class:"section"},ld={class:"preview-info"},od={class:"info-item"},id={class:"value"},rd={class:"info-item"},ud={class:"value"},dd={class:"info-item"},cd={class:"value"},pd={class:"export-actions"},fd=ie({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(a,{emit:e}){const s=a,i=e,c=nt(),r=B("csv"),v=B(["order","status","configuration","prompt","response","latency"]),k=B(!1),T=B("draft"),l=B({}),_=B([]),E=B([]),g=B([]),S=["order","status","configuration","prompt","response","latency"],h=B([]),b=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],A=D(()=>{var L,I;const $=((L=s.trial.progress)==null?void 0:L.completed)||0,n=((I=s.trial.progress)==null?void 0:I.failed)||0;return $+n}),U=D(()=>{const n=v.value.length*50*A.value;return n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`});function w(){y.info("EXPORT_DEBUG: ExportModal initializeFieldSelection with allFields",h.value.length),h.value.forEach(L=>{l.value[L]=!1}),S.forEach(L=>{l.value[L]=!0});const $=E.value.map(L=>L.id),n=g.value.map(L=>L.id);$.forEach(L=>{l.value[L]=!0}),n.forEach(L=>{l.value[L]=!0}),y.info("EXPORT_DEBUG: ExportModal default selection includes",{standardDefaults:S.length,parameterDefaults:$.length,variableDefaults:n.length,totalDefaults:S.length+$.length+n.length}),u()}function u(){v.value=h.value.filter($=>l.value[$])}function m($,n){l.value[$]=n,u()}function f(){h.value.forEach($=>{l.value[$]=!0}),u()}function d(){h.value.forEach(L=>{l.value[L]=!1}),S.forEach(L=>{l.value[L]=!0});const $=E.value.map(L=>L.id),n=g.value.map(L=>L.id);$.forEach(L=>{l.value[L]=!0}),n.forEach(L=>{l.value[L]=!0}),u()}function O(){h.value.forEach($=>{l.value[$]=!1}),u()}function H(){i("update:visible",!1)}async function Y(){if(r.value==="bundle"){k.value=!0;try{const{trialBundleExportService:$}=await Pt(async()=>{const{trialBundleExportService:I}=await import("./trial-bundle.service-gSXZBaJe.js");return{trialBundleExportService:I}},__vite__mapDeps([0,1,2])),n=T.value==="completed",L=await $.exportTrialBundle(s.trial.id,{includeResults:n,includeApiCalls:n,format:"json"});L.ok?(ne.success(`Trial bundle exported: ${L.value.filename}`),i("update:visible",!1)):ne.error(`Bundle export failed: ${L.error.message}`)}catch($){ne.error(`Bundle export failed: ${$ instanceof Error?$.message:"Unknown error"}`)}finally{k.value=!1}return}if(v.value.length===0){ne.warning("Please select at least one field to export");return}k.value=!0;try{const $={format:r.value,fields:v.value,includeHeaders:!0,addBOM:r.value==="excel"||r.value==="csv"},n=await c.dataExport.exportTrialData(s.trial.id,$);n.ok?(ne.success("Export completed successfully"),i("update:visible",!1)):ne.error(`Export failed: ${n.error.message}`)}catch($){ne.error("Export failed: "+$.message)}finally{k.value=!1}}return ge(async()=>{y.info("EXPORT_DEBUG: ExportModal discovering available fields for trial",s.trial.id);const $=await c.dataExport.getAvailableFields(s.trial.id);if($.ok){_.value=$.value.standardFields,E.value=$.value.parameterFields,g.value=$.value.variableFields||[];const n=$.value.standardFields.map(Q=>Q.id).filter(Q=>Q!=="parameters"&&Q!=="variables"),L=$.value.parameterFields.map(Q=>Q.id),I=($.value.variableFields||[]).map(Q=>Q.id);h.value=[...n,...L,...I],y.info("EXPORT_DEBUG: ExportModal discovered fields",{standardFields:$.value.standardFields.length,parameterFields:$.value.parameterFields.length,variableFields:($.value.variableFields||[]).length,totalFields:h.value.length,parameterFieldNames:$.value.parameterFields.map(Q=>Q.id),variableFieldNames:($.value.variableFields||[]).map(Q=>Q.id),allFieldNames:h.value})}else y.info("EXPORT_DEBUG: ExportModal field discovery failed",$.error),h.value=[...b];w()}),($,n)=>{const L=J("a-radio-button"),I=J("a-radio-group"),Q=J("a-radio"),te=J("a-button"),G=J("a-checkbox"),oe=J("a-modal");return o(),X(oe,{visible:$.visible,"onUpdate:visible":n[46]||(n[46]=x=>$.$emit("update:visible",x)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:P(()=>[t("div",Fu,[t("div",Du,[n[53]||(n[53]=t("h4",null,"Export Format",-1)),R(I,{value:r.value,"onUpdate:value":n[0]||(n[0]=x=>r.value=x),class:"format-options"},{default:P(()=>[R(L,{value:"csv"},{default:P(()=>n[47]||(n[47]=[M("CSV")])),_:1,__:[47]}),R(L,{value:"tsv"},{default:P(()=>n[48]||(n[48]=[M("TSV")])),_:1,__:[48]}),R(L,{value:"excel"},{default:P(()=>n[49]||(n[49]=[M("Excel")])),_:1,__:[49]}),R(L,{value:"json"},{default:P(()=>n[50]||(n[50]=[M("JSON")])),_:1,__:[50]}),R(L,{value:"jsonl"},{default:P(()=>n[51]||(n[51]=[M("JSONL")])),_:1,__:[51]}),R(L,{value:"bundle"},{default:P(()=>n[52]||(n[52]=[M("Bundle 📦")])),_:1,__:[52]})]),_:1},8,["value"])]),r.value==="bundle"?(o(),p("div",Mu,[n[62]||(n[62]=t("h4",null,"Bundle Export Options",-1)),t("div",Uu,[R(I,{value:T.value,"onUpdate:value":n[1]||(n[1]=x=>T.value=x),style:{"margin-bottom":"16px"}},{default:P(()=>[R(Q,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:P(()=>n[54]||(n[54]=[t("strong",null,"Export as Draft",-1),t("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Configuration only - recipient can run fresh experiment ",-1)])),_:1,__:[54]}),R(Q,{value:"completed",style:{display:"block"}},{default:P(()=>n[55]||(n[55]=[t("strong",null,"Export with Results",-1),t("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Include all execution results for review/analysis ",-1)])),_:1,__:[55]})]),_:1},8,["value"]),n[61]||(n[61]=t("p",null,"The bundle will include:",-1)),t("ul",null,[n[56]||(n[56]=t("li",null,"✅ Complete trial configuration",-1)),n[57]||(n[57]=t("li",null,"✅ Template with metadata",-1)),n[58]||(n[58]=t("li",null,"✅ All variable lists",-1)),n[59]||(n[59]=t("li",null,"✅ Model configurations",-1)),T.value==="completed"?(o(),p("li",Nu,"✅ Execution results and API calls")):V("",!0),n[60]||(n[60]=t("li",null,"✅ Variable index tracking for lineage",-1))]),t("p",null,[t("strong",null,C(T.value==="draft"?"Ready to run fresh experiment":"Complete historical record"),1)])])])):(o(),p("div",Wu,[n[95]||(n[95]=t("h4",null,"Fields to Export",-1)),t("div",zu,[R(te,{size:"small",onClick:f},{default:P(()=>n[63]||(n[63]=[M("Select All")])),_:1,__:[63]}),R(te,{size:"small",onClick:d},{default:P(()=>n[64]||(n[64]=[M("Select Defaults")])),_:1,__:[64]}),R(te,{size:"small",onClick:O},{default:P(()=>n[65]||(n[65]=[M("Clear All")])),_:1,__:[65]})]),t("div",Hu,[t("div",Bu,[n[71]||(n[71]=t("h5",null,"Basic Information",-1)),t("div",ju,[R(G,{checked:l.value.id,"onUpdate:checked":n[2]||(n[2]=x=>l.value.id=x),onChange:n[3]||(n[3]=x=>m("id",x.target.checked))},{default:P(()=>n[66]||(n[66]=[M("Call ID")])),_:1,__:[66]},8,["checked"]),R(G,{checked:l.value.order,"onUpdate:checked":n[4]||(n[4]=x=>l.value.order=x),onChange:n[5]||(n[5]=x=>m("order",x.target.checked))},{default:P(()=>n[67]||(n[67]=[M("Order")])),_:1,__:[67]},8,["checked"]),R(G,{checked:l.value.status,"onUpdate:checked":n[6]||(n[6]=x=>l.value.status=x),onChange:n[7]||(n[7]=x=>m("status",x.target.checked))},{default:P(()=>n[68]||(n[68]=[M("Status")])),_:1,__:[68]},8,["checked"]),R(G,{checked:l.value.created,"onUpdate:checked":n[8]||(n[8]=x=>l.value.created=x),onChange:n[9]||(n[9]=x=>m("created",x.target.checked))},{default:P(()=>n[69]||(n[69]=[M("Created Time")])),_:1,__:[69]},8,["checked"]),R(G,{checked:l.value.completed,"onUpdate:checked":n[10]||(n[10]=x=>l.value.completed=x),onChange:n[11]||(n[11]=x=>m("completed",x.target.checked))},{default:P(()=>n[70]||(n[70]=[M("Completed Time")])),_:1,__:[70]},8,["checked"])])]),t("div",Gu,[n[76]||(n[76]=t("h5",null,"Configuration",-1)),t("div",qu,[R(G,{checked:l.value.configuration,"onUpdate:checked":n[12]||(n[12]=x=>l.value.configuration=x),onChange:n[13]||(n[13]=x=>m("configuration",x.target.checked))},{default:P(()=>n[72]||(n[72]=[M("Configuration Name")])),_:1,__:[72]},8,["checked"]),R(G,{checked:l.value.provider,"onUpdate:checked":n[14]||(n[14]=x=>l.value.provider=x),onChange:n[15]||(n[15]=x=>m("provider",x.target.checked))},{default:P(()=>n[73]||(n[73]=[M("Provider")])),_:1,__:[73]},8,["checked"]),R(G,{checked:l.value.modelId,"onUpdate:checked":n[16]||(n[16]=x=>l.value.modelId=x),onChange:n[17]||(n[17]=x=>m("modelId",x.target.checked))},{default:P(()=>n[74]||(n[74]=[M("Model ID")])),_:1,__:[74]},8,["checked"]),R(G,{checked:l.value.parameters,"onUpdate:checked":n[18]||(n[18]=x=>l.value.parameters=x),onChange:n[19]||(n[19]=x=>m("parameters",x.target.checked))},{default:P(()=>n[75]||(n[75]=[M("Parameters")])),_:1,__:[75]},8,["checked"])])]),t("div",Ku,[n[81]||(n[81]=t("h5",null,"Content",-1)),t("div",Qu,[R(G,{checked:l.value.prompt,"onUpdate:checked":n[20]||(n[20]=x=>l.value.prompt=x),onChange:n[21]||(n[21]=x=>m("prompt",x.target.checked))},{default:P(()=>n[77]||(n[77]=[M("Prompt")])),_:1,__:[77]},8,["checked"]),R(G,{checked:l.value.variables,"onUpdate:checked":n[22]||(n[22]=x=>l.value.variables=x),onChange:n[23]||(n[23]=x=>m("variables",x.target.checked))},{default:P(()=>n[78]||(n[78]=[M("Variables")])),_:1,__:[78]},8,["checked"]),R(G,{checked:l.value.response,"onUpdate:checked":n[24]||(n[24]=x=>l.value.response=x),onChange:n[25]||(n[25]=x=>m("response",x.target.checked))},{default:P(()=>n[79]||(n[79]=[M("Response")])),_:1,__:[79]},8,["checked"]),R(G,{checked:l.value.parsedResponse,"onUpdate:checked":n[26]||(n[26]=x=>l.value.parsedResponse=x),onChange:n[27]||(n[27]=x=>m("parsedResponse",x.target.checked))},{default:P(()=>n[80]||(n[80]=[M("Parsed Response")])),_:1,__:[80]},8,["checked"])])]),t("div",Ju,[n[87]||(n[87]=t("h5",null,"Performance",-1)),t("div",Yu,[R(G,{checked:l.value.latency,"onUpdate:checked":n[28]||(n[28]=x=>l.value.latency=x),onChange:n[29]||(n[29]=x=>m("latency",x.target.checked))},{default:P(()=>n[82]||(n[82]=[M("Latency (ms)")])),_:1,__:[82]},8,["checked"]),R(G,{checked:l.value.promptTokens,"onUpdate:checked":n[30]||(n[30]=x=>l.value.promptTokens=x),onChange:n[31]||(n[31]=x=>m("promptTokens",x.target.checked))},{default:P(()=>n[83]||(n[83]=[M("Prompt Tokens")])),_:1,__:[83]},8,["checked"]),R(G,{checked:l.value.completionTokens,"onUpdate:checked":n[32]||(n[32]=x=>l.value.completionTokens=x),onChange:n[33]||(n[33]=x=>m("completionTokens",x.target.checked))},{default:P(()=>n[84]||(n[84]=[M("Completion Tokens")])),_:1,__:[84]},8,["checked"]),R(G,{checked:l.value.totalTokens,"onUpdate:checked":n[34]||(n[34]=x=>l.value.totalTokens=x),onChange:n[35]||(n[35]=x=>m("totalTokens",x.target.checked))},{default:P(()=>n[85]||(n[85]=[M("Total Tokens")])),_:1,__:[85]},8,["checked"]),R(G,{checked:l.value.cost,"onUpdate:checked":n[36]||(n[36]=x=>l.value.cost=x),onChange:n[37]||(n[37]=x=>m("cost",x.target.checked))},{default:P(()=>n[86]||(n[86]=[M("Cost (USD)")])),_:1,__:[86]},8,["checked"])])]),t("div",Xu,[n[92]||(n[92]=t("h5",null,"Technical Details",-1)),t("div",Zu,[R(G,{checked:l.value.request,"onUpdate:checked":n[38]||(n[38]=x=>l.value.request=x),onChange:n[39]||(n[39]=x=>m("request",x.target.checked))},{default:P(()=>n[88]||(n[88]=[M("Full Request")])),_:1,__:[88]},8,["checked"]),R(G,{checked:l.value.response_raw,"onUpdate:checked":n[40]||(n[40]=x=>l.value.response_raw=x),onChange:n[41]||(n[41]=x=>m("response_raw",x.target.checked))},{default:P(()=>n[89]||(n[89]=[M("Raw Response")])),_:1,__:[89]},8,["checked"]),R(G,{checked:l.value.error,"onUpdate:checked":n[42]||(n[42]=x=>l.value.error=x),onChange:n[43]||(n[43]=x=>m("error",x.target.checked))},{default:P(()=>n[90]||(n[90]=[M("Error Details")])),_:1,__:[90]},8,["checked"]),R(G,{checked:l.value.repeatIndex,"onUpdate:checked":n[44]||(n[44]=x=>l.value.repeatIndex=x),onChange:n[45]||(n[45]=x=>m("repeatIndex",x.target.checked))},{default:P(()=>n[91]||(n[91]=[M("Repeat Index")])),_:1,__:[91]},8,["checked"])])]),E.value.length>0?(o(),p("div",ed,[n[93]||(n[93]=t("h5",null,"Parameters (Individual Columns)",-1)),t("div",td,[(o(!0),p(Z,null,se(E.value,x=>(o(),X(G,{key:x.id,checked:l.value[x.id],"onUpdate:checked":fe=>l.value[x.id]=fe,onChange:fe=>m(x.id,fe.target.checked)},{default:P(()=>[M(C(x.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):V("",!0),g.value.length>0?(o(),p("div",sd,[n[94]||(n[94]=t("h5",null,"Attributes (Individual Columns)",-1)),t("div",ad,[(o(!0),p(Z,null,se(g.value,x=>(o(),X(G,{key:x.id,checked:l.value[x.id],"onUpdate:checked":fe=>l.value[x.id]=fe,onChange:fe=>m(x.id,fe.target.checked)},{default:P(()=>[M(C(x.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):V("",!0)])])),t("div",nd,[n[99]||(n[99]=t("h4",null,"Export Preview",-1)),t("div",ld,[t("div",od,[n[96]||(n[96]=t("span",{class:"label"},"Records:",-1)),t("span",id,C(A.value),1)]),t("div",rd,[n[97]||(n[97]=t("span",{class:"label"},"Fields:",-1)),t("span",ud,C(v.value.length),1)]),t("div",dd,[n[98]||(n[98]=t("span",{class:"label"},"Estimated Size:",-1)),t("span",cd,C(U.value),1)])])]),t("div",pd,[R(te,{onClick:H},{default:P(()=>n[100]||(n[100]=[M("Cancel")])),_:1,__:[100]}),R(te,{type:"primary",onClick:Y,loading:k.value,disabled:v.value.length===0},{default:P(()=>[R(W(gs)),n[101]||(n[101]=M(" Export "))]),_:1,__:[101]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),md=re(fd,[["__scopeId","data-v-34965650"]]);class vd{constructor(){me(this,"subscription",null);me(this,"progressSubscription",null);me(this,"store",je());me(this,"v4Control",Ft());me(this,"isActive",!1);me(this,"currentTrialId",null)}async startStreaming(e){const s=performance.now();y.info(`V4_TRIAL_SWITCH: Stream manager starting for trial ${e}`),this.cleanupSubscriptions();const i=performance.now();y.info(`V4_TRIAL_SWITCH: Stream cleanup completed in ${(i-s).toFixed(1)}ms`),this.isActive=!0,y.info(`V4_TRIAL_SWITCH: Set isActive = true to pause reactive queries at ${(i-s).toFixed(1)}ms`),this.currentTrialId=e,this.store.setCurrentTrial(e),this.store.setStreaming(!0);const c=performance.now();y.info(`V4_TRIAL_SWITCH: Store updated in ${(c-i).toFixed(1)}ms`);const r=performance.now();y.info("V4_TRIAL_SWITCH: ALWAYS loading complete historical data first"),await this.loadHistoricalData(e);const v=performance.now();y.info(`V4_TRIAL_SWITCH: Historical data loading completed in ${(v-r).toFixed(1)}ms - store now has complete dataset`);const k=performance.now();y.info("V4_TRIAL_SWITCH: Checking for active streams to overlay updates");const T=this.v4Control.getActiveStreams(e),l=performance.now();if(y.info(`V4_TRIAL_SWITCH: Stream check completed in ${(l-k).toFixed(1)}ms, result: ${T?"FOUND":"NONE"}`),!T){y.info(`V4_TRIAL_SWITCH: No active streams for trial ${e}, using complete historical data only`);const _=await Ye.trials.get(e);if(_&&_.status==="running"){y.info(`V4_TRIAL_SWITCH: Running trial ${e}, setting up retry for potential streaming`);let E=0;const g=5,S=setInterval(()=>{E++,y.info(`V4_TRIAL_SWITCH: Retry ${E}/${g} checking for active streams`);const h=this.v4Control.getActiveStreams(e);h?(y.info(`V4_TRIAL_SWITCH: Found active streams after ${E} retries - starting live updates`),clearInterval(S),this.connectToTrialStream(e,h)):E>=g&&(y.info(`V4_TRIAL_SWITCH: No streams after ${g} retries - staying with historical data only`),clearInterval(S))},500)}else y.info(`V4_TRIAL_SWITCH: Non-running trial ${(_==null?void 0:_.status)||"NOT_FOUND"} - complete with historical data only`);return}this.connectToTrialStream(e,T)}connectToTrialStream(e,s){var c,r;y.info(`V4_STREAM_CONNECT: Connecting to streams for trial ${e} with historical foundation`),y.info(`V4_STREAM_CONNECT: Entry point - starting stream connection for trial ${e}`),this.isActive=!0;const i=s.callsSubject||s.sharedCalls$;y.info(`V4_STREAM_CONNECT: Subscribing to calls stream for updates, type: ${(c=i==null?void 0:i.constructor)==null?void 0:c.name}`),y.info(`V4_STREAM_CONNECT: Calls stream available: ${!!i}, type: ${(r=i==null?void 0:i.constructor)==null?void 0:r.name}`),this.subscription=i.subscribe({next:v=>{if(v&&v.length>0){y.info(`V4_STREAM_CONNECT: Merging ${v.length} streaming updates`);const k=[...this.store.apiCalls.value];v.forEach(T=>{const l=k.findIndex(_=>_.id===T.id);l>=0?k[l]=T:k.push(T)}),k.sort((T,l)=>{const _=S=>{switch(S){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},E=_(T.status),g=_(l.status);if(E!==g)return E-g;if(T.status==="completed"&&l.status==="completed"){const S=T.completed?new Date(T.completed).getTime():0;return(l.completed?new Date(l.completed).getTime():0)-S}if(T.status==="running"&&l.status==="running"){const S=T.started?new Date(T.started).getTime():0;return(l.started?new Date(l.started).getTime():0)-S}return T.order-l.order}),this.store.updateApiCalls(k)}},error:v=>{y.error("V4_STREAM_CONNECT: Stream error:",v),y.info("V4_STREAM_CONNECT: Calls stream ERROR:",v),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{y.info(`V4_TRIAL_DEBUG_STREAMS_MGR: Stream completed for trial ${e}`),y.info(`V4_TRIAL_DEBUG_STREAMS: Calls stream COMPLETED for trial ${e}`),this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(e)}}),s.sharedProgress$&&(y.info("V4_STREAM_CONNECT: Subscribing to progress stream"),y.info(`V4_STREAM_CONNECT: Progress stream available: ${!!s.sharedProgress$}`),this.progressSubscription=s.sharedProgress$.subscribe({next:v=>{y.info("V4_STREAM_CONNECT: Received progress update:",v.type),y.info(`V4_STREAM_CONNECT: Progress update - ${v.type}`),y.info(`🚨 COMPLETION_DEBUG: Stream manager received progress event: ${v.type} at ${new Date().toISOString()}`),v.type==="completed"&&(y.info(`V4_TRIAL_DEBUG_STREAMS: Trial ${e} COMPLETED via progress stream`),y.info("🚨 COMPLETION_DEBUG: ✅ TRIAL COMPLETED EVENT RECEIVED BY STREAM MANAGER!"),y.info(`V4_TRIAL_COMPLETION: Loading final data from database for completed trial ${e}`),this.loadHistoricalData(e).then(()=>{y.info("V4_TRIAL_COMPLETION: Final data loaded - UI should now show accurate completion counts"),y.info("🚨 COMPLETION_DEBUG: ✅ UI SHOULD BE UPDATED NOW!")}).catch(k=>{y.error("V4_TRIAL_COMPLETION: Failed to load final data:",k)})),this.store.updateProgress(v)},error:v=>{y.error("V4_STREAM_CONNECT: Progress stream error:",v),y.info("V4_STREAM_CONNECT: Progress stream ERROR:",v)}})),y.info("V4_STREAM_CONNECT: Successfully connected to streams with historical foundation"),y.info(`V4_STREAM_CONNECT: Stream subscriptions complete for trial ${e}`)}cleanupSubscriptions(){y.info("STREAM_MGR_V4: Cleaning up existing subscriptions"),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){y.info("STREAM_MGR_V4: Stopping streaming"),y.info(`V4_TRIAL_DEBUG_STREAMS: stopStreaming() called for trial ${this.currentTrialId}`),y.info(`V4_TRIAL_DEBUG_STREAMS: Current isActive: ${this.isActive}`),this.cleanupSubscriptions(),this.isActive=!1,y.info("V4_TRIAL_DEBUG_STREAMS: Stopped streaming, isActive set to false")}async loadHistoricalData(e){const s=performance.now();y.info(`V4_TRIAL_SWITCH: loadHistoricalData() ENTRY for trial ${e}`);try{const i=performance.now();y.info(`V4_TRIAL_SWITCH: Checking database availability at ${(i-s).toFixed(1)}ms`);const c=performance.now();y.info(`V4_TRIAL_SWITCH: Preparing database query at ${(c-s).toFixed(1)}ms`);const r=performance.now();y.info(`V4_TRIAL_SWITCH: Starting IndexedDB query at ${(r-s).toFixed(1)}ms`);const v=await Ye.apiCalls.where("trialId").equals(e).toArray(),k=performance.now();y.info(`V4_TRIAL_SWITCH: IndexedDB query COMPLETED - loaded ${v.length} calls in ${(k-r).toFixed(1)}ms`),y.info(`V4_TRIAL_SWITCH: Total time to query completion: ${(k-s).toFixed(1)}ms`);const T=performance.now();v.sort((S,h)=>{const b=w=>{switch(w){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},A=b(S.status),U=b(h.status);if(A!==U)return A-U;if(S.status==="completed"&&h.status==="completed"){const w=S.completed?new Date(S.completed).getTime():0;return(h.completed?new Date(h.completed).getTime():0)-w}if(S.status==="running"&&h.status==="running"){const w=S.started?new Date(S.started).getTime():0;return(h.started?new Date(h.started).getTime():0)-w}return S.order-h.order});const l=performance.now();y.info(`V4_TRIAL_SWITCH: Sorting ${v.length} calls took ${(l-T).toFixed(1)}ms`);const _=performance.now();this.store.updateApiCalls(v),this.store.setStreaming(!1);const E=performance.now();y.info(`V4_TRIAL_SWITCH: Store update took ${(E-_).toFixed(1)}ms`),y.info(`V4_TRIAL_SWITCH: loadHistoricalData keeping isActive = ${this.isActive} to maintain reactive query pause`);const g=performance.now();y.info(`V4_TRIAL_SWITCH: loadHistoricalData TOTAL: ${(g-s).toFixed(1)}ms`)}catch(i){y.error("STREAM_MGR_V4: Failed to load historical data:",i),this.store.clear()}}destroy(){y.info("STREAM_MGR_V4: Destroying stream manager"),this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let Ue=null;function Ht(){return Ue||(Ue=new vd,y.info("STREAM_MGR_V4: Created singleton manager instance")),Ue}typeof window<"u"&&(window.__trialStreamManagerV4=()=>Ue);const gd={class:"trial-details-panel"},hd={key:0,class:"loading-state"},yd={key:1,class:"error-state"},_d={class:"error-actions"},bd=ie({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(a){const e=a,s=We(),i=B(!1),c=B(null),r=B(!1),v=Ht(),k=D(()=>{var g,S,h;return((g=e.executionState)==null?void 0:g.status)==="executing"&&((S=e.executionState)==null?void 0:S.currentTrialId)===((h=e.trial)==null?void 0:h.id)});function T(){c.value=null}function l(){s.push("/trials")}function _(){r.value=!0}async function E(){if(e.trial){y.info(`REFRESH: Manually refreshing trial ${e.trial.id} data from database`);try{v.isActive&&v.currentTrialId===e.trial.id&&(y.info("REFRESH: Temporarily stopping active stream to reload data"),v.stopStreaming()),await v.loadHistoricalData(e.trial.id),y.info(`REFRESH: Successfully refreshed trial ${e.trial.id} data`),(e.trial.status==="running"||e.trial.status==="paused")&&(y.info("REFRESH: Restarting streaming for active trial"),await v.startStreaming(e.trial.id))}catch(g){y.error("REFRESH: Failed to refresh trial data:",g)}}}return ce(()=>e.trial,(g,S)=>{g&&g.id!==(S==null?void 0:S.id)&&(c.value=null,y.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${S==null?void 0:S.id} to ${g.id}`))}),ge(()=>{var S;const g=(S=e.trial)==null?void 0:S.id;y.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${g}`)}),Ee(()=>{var S;const g=(S=e.trial)==null?void 0:S.id;y.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${g}`)}),Ve(()=>{var S;const g=(S=e.trial)==null?void 0:S.id;y.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${g}`)}),ye(()=>{var S;const g=(S=e.trial)==null?void 0:S.id;y.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${g}`)}),(g,S)=>{const h=J("a-button");return o(),p("div",gd,[i.value?(o(),p("div",hd,[R(W(It),{class:"loading-spinner",spin:""}),S[9]||(S[9]=t("span",null,"Loading trial details...",-1))])):c.value?(o(),p("div",yd,[R(W(Re),{class:"error-icon"}),S[12]||(S[12]=t("h3",null,"Failed to load trial",-1)),t("p",null,C(c.value),1),t("div",_d,[R(h,{onClick:T},{default:P(()=>S[10]||(S[10]=[M("Retry")])),_:1,__:[10]}),R(h,{type:"link",onClick:l},{default:P(()=>S[11]||(S[11]=[M("Go Back")])),_:1,__:[11]})])])):g.trial?(o(),p(Z,{key:2},[R(fn,{trial:g.trial,progress:g.progress,"is-executing":k.value},null,8,["trial","progress","is-executing"]),R(_n,{trial:g.trial,"is-leader":g.isLeader,"execution-state":g.executionState,onStart:S[0]||(S[0]=b=>g.$emit("start-trial")),onPause:S[1]||(S[1]=b=>g.$emit("pause-trial")),onResume:S[2]||(S[2]=b=>g.$emit("resume-trial")),onCancel:S[3]||(S[3]=b=>g.$emit("cancel-trial")),onDuplicate:S[4]||(S[4]=b=>g.$emit("duplicate-trial",g.trial.id)),onEdit:S[5]||(S[5]=b=>g.$emit("edit-trial",g.trial.id)),onDelete:S[6]||(S[6]=b=>g.$emit("delete-trial",g.trial.id)),onExportData:_,onExportPython:S[7]||(S[7]=b=>g.$emit("export-python",g.trial.id)),onRefresh:E},null,8,["trial","is-leader","execution-state"]),g.trial&&r.value?(o(),X(md,{key:0,visible:r.value,trial:g.trial,"onUpdate:visible":S[8]||(S[8]=b=>r.value=!1)},null,8,["visible","trial"])):V("",!0),R(xu,{trial:g.trial,progress:g.progress,"is-leader":g.isLeader,"execution-state":g.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):V("",!0)])}}}),Td=re(bd,[["__scopeId","data-v-081db72e"]]),$d={class:"import-content"},Cd={class:"upload-section"},kd={class:"ant-upload-drag-icon"},Sd={key:0,class:"preview-section"},wd={class:"bundle-details"},Id={class:"detail-row"},Rd={class:"value"},Ed={class:"detail-row"},Vd={class:"value"},Ad={class:"detail-row"},Od={class:"value"},Ld={class:"detail-row"},Pd={class:"value"},xd={key:0,style:{color:"green","margin-left":"8px"}},Fd={key:1,style:{color:"orange","margin-left":"8px"}},Dd={key:0,class:"detail-row"},Md={class:"value"},Ud={class:"detail-row"},Nd={class:"value"},Wd={class:"import-options"},zd={key:0,style:{"margin-bottom":"12px"}},Hd={key:1,style:{"margin-bottom":"12px",padding:"8px",background:"#f0f0f0","border-radius":"4px"}},Bd={key:0,class:"warnings"},jd={class:"modal-actions"},Gd=ie({__name:"ImportTrialDialog",props:{visible:{type:Boolean}},emits:["update:visible","trial-imported"],setup(a,{emit:e}){const s=a,i=e,c=We(),r=B([]),v=B(null),k=B(!1),T=B([]),l=B({mode:"draft",namePrefix:"Imported: "}),_=D({get:()=>s.visible,set:u=>i("update:visible",u)}),E=D(()=>{var u,m;return((m=(u=v.value)==null?void 0:u.execution)==null?void 0:m.apiCalls)&&v.value.execution.apiCalls.length>0});function g(u){return!1}async function S(u){var f;const m=u.file.originFileObj||u.file;if(m)try{const d=await h(m),O=JSON.parse(d);T.value=b(O),v.value=O,(f=O.execution)!=null&&f.apiCalls&&O.execution.apiCalls.length>0,l.value.mode="draft"}catch{ne.error("Failed to read bundle file: Invalid JSON format"),v.value=null}}function h(u){return new Promise((m,f)=>{const d=new FileReader;d.onload=O=>{var H;return m((H=O.target)==null?void 0:H.result)},d.onerror=f,d.readAsText(u)})}function b(u){var f,d;const m=[];return u.version||m.push("Bundle version is missing"),(f=u.configuration)!=null&&f.trial||m.push("Trial configuration is missing"),(!((d=u.configuration)!=null&&d.variableLists)||u.configuration.variableLists.length===0)&&m.push("No variable lists found in bundle"),u.version!=="1.0"&&m.push(`Bundle version ${u.version} may not be fully compatible`),m}function A(u){return new Date(u).toLocaleString()}function U(){r.value=[],v.value=null,T.value=[],_.value=!1}async function w(){if(!v.value){ne.error("No bundle to import");return}k.value=!0;try{const{trialBundleImportService:u}=await Pt(async()=>{const{trialBundleImportService:d}=await import("./trial-bundle.service-gSXZBaJe.js");return{trialBundleImportService:d}},__vite__mapDeps([0,1,2])),m=E.value&&l.value.mode==="completed",f=await u.importTrialBundle(JSON.stringify(v.value),{importResults:m,importAsCompleted:m,namePrefix:l.value.namePrefix||void 0});f.ok?(ne.success("Trial imported successfully!"),c.push(`/trials?trialId=${f.value.trialId}`),i("trial-imported",f.value.trialId),U()):ne.error(`Import failed: ${f.error.message}`)}catch(u){ne.error(`Import failed: ${u instanceof Error?u.message:"Unknown error"}`)}finally{k.value=!1}}return(u,m)=>{const f=J("a-upload-dragger"),d=J("a-radio"),O=J("a-radio-group"),H=J("a-input"),Y=J("a-alert"),$=J("a-button"),n=J("a-modal");return o(),X(n,{visible:_.value,"onUpdate:visible":m[3]||(m[3]=L=>_.value=L),title:"Import Trial Bundle",width:600,footer:null,"destroy-on-close":!0,class:"import-trial-modal"},{default:P(()=>{var L;return[t("div",$d,[t("div",Cd,[R(f,{fileList:r.value,"onUpdate:fileList":m[0]||(m[0]=I=>r.value=I),"before-upload":g,"max-count":1,accept:".json",onChange:S},{default:P(()=>[t("p",kd,[R(W(Dt))]),m[4]||(m[4]=t("p",{class:"ant-upload-text"},"Click or drag trial bundle file here",-1)),m[5]||(m[5]=t("p",{class:"ant-upload-hint"}," Supports .json files exported from trials ",-1))]),_:1,__:[4,5]},8,["fileList"])]),v.value?(o(),p("div",Sd,[m[17]||(m[17]=t("h3",null,"Bundle Contents",-1)),t("div",wd,[t("div",Id,[m[6]||(m[6]=t("span",{class:"label"},"Trial Name:",-1)),t("span",Rd,C(v.value.metadata.trialName),1)]),t("div",Ed,[m[7]||(m[7]=t("span",{class:"label"},"Export Date:",-1)),t("span",Vd,C(A(v.value.metadata.exportDate)),1)]),t("div",Ad,[m[8]||(m[8]=t("span",{class:"label"},"Status:",-1)),t("span",Od,C(v.value.metadata.trialStatus),1)]),t("div",Ld,[m[9]||(m[9]=t("span",{class:"label"},"API Calls:",-1)),t("span",Pd,[M(C(v.value.metadata.apiCallCount)+" ",1),E.value?(o(),p("span",xd," (with results) ")):(o(),p("span",Fd," (configuration only) "))])]),v.value.configuration.template?(o(),p("div",Dd,[m[10]||(m[10]=t("span",{class:"label"},"Template:",-1)),t("span",Md,C(v.value.configuration.template.name),1)])):V("",!0),t("div",Ud,[m[11]||(m[11]=t("span",{class:"label"},"Variable Lists:",-1)),t("span",Nd,C(((L=v.value.configuration.variableLists)==null?void 0:L.length)||0),1)])]),t("div",Wd,[m[16]||(m[16]=t("h4",null,"Import Options",-1)),E.value?(o(),p("div",zd,[R(O,{value:l.value.mode,"onUpdate:value":m[1]||(m[1]=I=>l.value.mode=I),style:{display:"block"}},{default:P(()=>[R(d,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:P(()=>m[12]||(m[12]=[t("strong",null,"Import as Draft",-1),t("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Create fresh trial ready to run new experiment ",-1)])),_:1,__:[12]}),R(d,{value:"completed",style:{display:"block"}},{default:P(()=>m[13]||(m[13]=[t("strong",null,"Import as Completed",-1),t("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Preserve historical results for review/analysis ",-1)])),_:1,__:[13]})]),_:1},8,["value"])])):(o(),p("div",Hd,m[14]||(m[14]=[t("strong",null,"Draft Trial",-1),t("div",{style:{color:"var(--color-text-secondary)","font-size":"12px"}}," This bundle contains configuration only - will import as draft ready to run ",-1)]))),R(H,{value:l.value.namePrefix,"onUpdate:value":m[2]||(m[2]=I=>l.value.namePrefix=I),placeholder:"Name prefix (optional)",style:{"margin-top":"8px"}},{prefix:P(()=>m[15]||(m[15]=[M("Name:")])),_:1},8,["value"])]),T.value.length>0?(o(),p("div",Bd,[R(Y,{message:"Import Warnings",type:"warning","show-icon":""},{description:P(()=>[t("ul",null,[(o(!0),p(Z,null,se(T.value,I=>(o(),p("li",{key:I},C(I),1))),128))])]),_:1})])):V("",!0)])):V("",!0),t("div",jd,[R($,{onClick:U},{default:P(()=>m[18]||(m[18]=[M("Cancel")])),_:1,__:[18]}),R($,{type:"primary",onClick:w,loading:k.value,disabled:!v.value},{default:P(()=>[R(W(ze)),m[19]||(m[19]=M(" Import Trial "))]),_:1,__:[19]},8,["loading","disabled"])])])]}),_:1},8,["visible"])}}}),qd=re(Gd,[["__scopeId","data-v-1d9366d6"]]),Kd={class:"trials-view-v3"},Qd={key:0,class:"provider-warning-banner"},Jd={class:"banner-content"},Yd={key:1,class:"observer-mode-banner"},Xd={class:"banner-content"},Zd={key:1,class:"loading-left-pane"},ec={key:0,class:"no-selection"},tc={key:0,class:"observer-note"},sc=ie({__name:"TrialsViewV3",setup(a){const e=Ft(),{trials:s}=bs(),{enabledModels:i}=ws(),{duplicateTrial:c,deleteTrial:r}=Ts(),v=Ht(),k=nt(),T=Lt(),l=We(),_=B(),E=B(!0),g=B(null),S=B(""),h=B("all"),b=B(-1),A=B(!1),U=B(!1),w=B(!1),u=D(()=>i.value.length>0),m=D(()=>!u.value&&!w.value),f=e.isLeader,d=e.execution,{trial:O}=$s(g),H=D(()=>{var N;const F=(N=O.value)==null?void 0:N.progress;return F?{trialId:g.value||"",...F,lastUpdated:new Date}:null}),Y=D(()=>{let F=s.value;if(S.value){const N=S.value.toLowerCase();F=F.filter(ee=>{var be,Pe;const de=ee.name.toLowerCase().includes(N),ve=(Pe=(be=ee.templateConfig)==null?void 0:be.template)==null?void 0:Pe.toLowerCase().includes(N),le=ee.configurations.some(we=>we.modelId.toLowerCase().includes(N)||we.provider.toLowerCase().includes(N));return de||ve||le})}return h.value!=="all"&&(F=F.filter(N=>N.status===h.value)),F});async function $(){var N;const F=T.query;if(F.duplicate){const ee=F.duplicate,de=await c(ee);de.ok?await l.push({path:"/trials/create",query:{duplicate:de.value,edit:F.edit==="true"?"true":void 0}}):ne.error(`Failed to duplicate trial: ${((N=de.error)==null?void 0:N.message)||"Unknown error"}`),await l.replace({query:{}});return}if(F.designId||F.promptSource){await l.push({path:"/trials/create",query:F});return}if(T.query.trialId){const ee=T.query.trialId;L(ee)}}function n(){if(g.value)return;if(s.value.length===0){y.info("V4_TRIALS: No trials available for auto-selection");return}const F=s.value.find(N=>N.status==="running");if(F){L(F.id);return}L(s.value[0].id)}async function L(F){const N=performance.now();y.info(`V4_TRIAL_SWITCH: Starting trial selection: ${F}`),g.value=F;const ee=performance.now();if(y.info(`V4_TRIAL_SWITCH: UI updated in ${(ee-N).toFixed(1)}ms`),s.value.length>0){const le=Y.value.findIndex(be=>be.id===F);le>=0&&(b.value=le)}const de=performance.now();if(y.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${F} at ${(de-N).toFixed(1)}ms`),v.startStreaming(F).catch(le=>{y.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${F}`,le)}),T.query.trialId!==F){const le={...T.query};le.trialId=F,le.tab||(le.tab="status"),l.push({path:"/trials",query:le}),y.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${le.tab}' at ${(performance.now()-N).toFixed(1)}ms`)}_.value&&_.value.closeMobileOverlay();const ve=performance.now();y.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(ve-N).toFixed(1)}ms`)}function I(F){S.value=F,b.value=-1}function Q(F){h.value=F,b.value=-1}async function te(){ne.info("Refreshing trial list...")}function G(F){const N=Y.value;if(N.length!==0){if((F.metaKey||F.ctrlKey)&&F.key==="k"){F.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(F.key==="j"||F.key==="ArrowDown")&&(F.preventDefault(),b.value=Math.min(b.value+1,N.length-1),b.value>=0&&(L(N[b.value].id),oe(N[b.value].id))),(F.key==="k"||F.key==="ArrowUp")&&(F.preventDefault(),b.value=Math.max(b.value-1,0),L(N[b.value].id),oe(N[b.value].id)),F.key==="Enter"&&g.value,F.key==="Escape"&&(S.value="",g.value=null,b.value=-1)}}function oe(F){Te(()=>{const N=document.querySelector(`[data-trial-id="${F}"]`);N&&N.scrollIntoView({behavior:"smooth",block:"nearest"})})}function x(F){y.debug("Trial list panel resized",{width:F})}function fe(F){y.debug("Mobile overlay changed",{visible:F})}function Oe(){w.value=!0}async function ke(){await l.push("/trials/create")}function Le(){U.value=!0}function z(F){te(),L(F)}async function j(){var F,N,ee,de;if(g.value){if(A.value){y.info("Start trial already in progress, ignoring duplicate request");return}A.value=!0,y.info("V4_EXECUTION:",(F=e.execution)==null?void 0:F.value),y.info("V4_STATUS:",(ee=(N=e.execution)==null?void 0:N.value)==null?void 0:ee.status);try{y.info("V4: Starting trial with streaming",g.value);const ve=await e.startTrialWithStreaming(g.value);if(!ve.ok){ne.error(((de=ve.error)==null?void 0:de.message)||"Unknown error");return}y.info("V4_STREAMING: Restarting stream manager after trial start"),await v.startStreaming(g.value),y.info("V4: Trial started with streaming, stream manager connected");const le={...T.query};le.tab="tasks",l.replace({query:le})}finally{A.value=!1}}}async function q(){var N;y.info(`V4_TRIAL_DEBUG_PAUSE: UI pauseTrial() called for trial: ${g.value}`),y.info(`V4_TRIAL_DEBUG_PAUSE: Current execution state: ${e.execution.value.status}`),y.info(`V4_TRIAL_DEBUG_PAUSE: Is leader: ${e.isLeader.value}`);const F=await e.pauseExecution();y.info("V4_TRIAL_DEBUG_PAUSE: UI pauseTrial result:",F),F.ok?y.info(`V4_TRIAL_DEBUG_PAUSE: Pause successful, execution state: ${e.execution.value.status}`):(y.info("V4_TRIAL_DEBUG_PAUSE: Pause failed from UI:",F.error.message),ne.error(((N=F.error)==null?void 0:N.message)||"Unknown error"))}async function K(){var ee,de,ve;if(!g.value)return;y.info(`V4_TRIAL_DEBUG_RESUME: UI resumeTrial() called for trial: ${g.value}`),y.info(`V4_TRIAL_DEBUG_RESUME: Current execution state: ${e.execution.value.status}`),y.info(`V4_TRIAL_DEBUG_RESUME: Is leader: ${e.isLeader.value}`);const F=((ee=e.execution.value)==null?void 0:ee.status)||"idle";y.info(`V4_TRIAL_DEBUG_RESUME: Current execution status: ${F}`);const N=(de=e.execution.value)==null?void 0:de.currentTrialId;if(F==="paused"&&N===g.value){y.info(`V4_TRIAL_DEBUG_RESUME: Execution is paused for THIS trial (${g.value}), using resumeExecution()`);const le=await e.resumeExecution(g.value);y.info("V4_TRIAL_DEBUG_RESUME: resumeExecution result:",le),le.ok?(y.info("V4_TRIAL_DEBUG_RESUME: Resume successful - existing pipeline will continue automatically via pause$ = false"),y.info("V4_TRIAL_DEBUG_RESUME: Resume complete - existing V3 pipeline should continue processing pending calls")):(y.info("V4_TRIAL_DEBUG_RESUME: Resume failed:",le.error.message),ne.error(le.error.message))}else{y.info("V4_TRIAL_DEBUG_RESUME: No paused execution found, using startTrialWithStreaming (fresh start)");const le=await e.startTrialWithStreaming(g.value);y.info("V4_TRIAL_DEBUG_RESUME: startTrialWithStreaming result for fresh start:",le),le.ok?(y.info("V4_TRIAL_DEBUG_RESUME: Fresh start successful, starting stream manager"),await v.startStreaming(g.value),y.info("V4_TRIAL_DEBUG_RESUME: Stream manager started for fresh execution")):(y.info("V4_TRIAL_DEBUG_RESUME: Fresh start failed:",le.error.message),ne.error(((ve=le.error)==null?void 0:ve.message)||"Unknown error"))}}async function ue(){var N;const F=await e.cancelExecution();F.ok||ne.error(((N=F.error)==null?void 0:N.message)||"Unknown error")}async function pe(F){var ee;const N=await c(F);N.ok?(ne.success("Trial duplicated"),N.value&&L(N.value)):ne.error(((ee=N.error)==null?void 0:ee.message)||"Unknown error")}async function Se(F){await l.push({path:"/trials/create",query:{duplicate:F,edit:"true"}})}async function Ge(F){var ee;const N=await r(F);N.ok?(ne.success("Trial deleted"),g.value===F&&(g.value=null)):ne.error(((ee=N.error)==null?void 0:ee.message)||"Unknown error")}async function Bt(F,N){var de;const ee=await k.dataExport.exportTrialData(F,{format:N,fields:void 0,includeHeaders:!0,addBOM:N==="excel"});ee.ok?ne.success(`Exported ${ee.value.recordCount} API calls to ${ee.value.filename}`):ne.error(((de=ee.error)==null?void 0:de.message)||"Unknown error")}async function jt(F){var ee;const N=await k.pythonGeneration.generatePythonScript(F,{template:"basic",includeAnalysis:!0,includeComments:!0});N.ok?ne.success("Python script exported"):ne.error(((ee=N.error)==null?void 0:ee.message)||"Unknown error")}return ce(()=>T.query.trialId,F=>{F&&F!==g.value&&L(F)}),ce(E,(F,N)=>{const ee=performance.now();y.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${N} to ${F} at ${ee}`),F||y.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),ce(s,(F,N)=>{const ee=performance.now();y.info(`V4_TRIAL_SWITCH: trials array changed from ${(N==null?void 0:N.length)||0} to ${F.length} trials at ${ee}`)},{immediate:!0}),ge(async()=>{const F=performance.now();y.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${F}`);const N=performance.now();y.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(N-F).toFixed(1)}ms`);try{await e.initialize();const qe=performance.now();y.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(qe-N).toFixed(1)}ms`)}catch(qe){const Kt=performance.now();y.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(Kt-N).toFixed(1)}ms:`,qe)}const ee=performance.now();window.addEventListener("keydown",G),y.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(ee-F).toFixed(1)}ms`);const de=performance.now();y.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(de-F).toFixed(1)}ms`),await Te();const ve=performance.now();y.info(`V4_TRIAL_SWITCH: nextTick completed in ${(ve-de).toFixed(1)}ms`);const le=performance.now();E.value=!1,y.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(le-F).toFixed(1)}ms`);const be=performance.now();y.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(be-F).toFixed(1)}ms`),await $();const Pe=performance.now();y.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Pe-be).toFixed(1)}ms`);const we=performance.now();y.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(we-F).toFixed(1)}ms`),n();const Gt=performance.now();y.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Gt-we).toFixed(1)}ms`);const qt=performance.now();y.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(qt-F).toFixed(1)}ms`)}),ye(()=>{y.info("V4_SINGLETON_DEBUG: TrialsViewV3 onUnmounted() - NOT calling v4ExecutionControl.cleanup() to preserve singleton"),window.removeEventListener("keydown",G),v.destroy(),y.info("V4_SINGLETON_DEBUG: V4 execution system preserved, initialized flag should remain true")}),(F,N)=>{const ee=J("router-link"),de=J("a-button");return o(),p("div",Kd,[m.value?(o(),p("div",Qd,[t("div",Jd,[R(W(Re),{class:"warning-icon"}),N[2]||(N[2]=t("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),R(ee,{to:"/settings",class:"settings-link"},{default:P(()=>N[1]||(N[1]=[M("Go to Settings")])),_:1,__:[1]}),R(W(wt),{class:"close-icon",onClick:Oe})]),N[3]||(N[3]=t("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):V("",!0),W(f)?V("",!0):(o(),p("div",Yd,[t("div",Xd,[R(W(Et),{class:"observer-icon"}),N[4]||(N[4]=t("span",null,[t("strong",null,"Observer Mode: Multiple Tabs Detected")],-1)),N[5]||(N[5]=t("div",{class:"leader-hint"}," You can only open one Auditomatic tab at a time. Close other tabs, or refresh if this is your only tab. Your templates and trials are safely saved. ",-1))])])),R(Ds,{ref_key:"splitPanel",ref:_,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:x,onMobileOverlayChange:fe},{left:P(()=>[E.value?(o(),p("div",Zd," Loading trials... ")):(o(),X(Ja,{key:0,trials:W(s),"selected-trial-id":g.value,"search-query":S.value,"filter-status":h.value,onSelectTrial:L,onCreateTrial:ke,onImportTrial:Le,onUpdateSearch:I,onUpdateFilter:Q,onRefresh:te},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:P(()=>[(o(),X(Xe,{max:5},[g.value?(o(),X(Td,{key:g.value,trial:W(O),"is-leader":W(f),"execution-state":W(d),progress:H.value,onStartTrial:j,onPauseTrial:q,onResumeTrial:K,onCancelTrial:ue,onDuplicateTrial:pe,onEditTrial:Se,onDeleteTrial:Ge,onExportData:Bt,onExportPython:jt},null,8,["trial","is-leader","execution-state","progress"])):V("",!0)],1024)),!g.value||!W(O)?Ce((o(),p("div",ec,[R(W(hs),{class:"empty-icon"}),N[7]||(N[7]=t("h3",null,"Select a trial to view details",-1)),N[8]||(N[8]=t("p",null,"Choose from the list or create a new one",-1)),R(de,{type:"primary",size:"large",disabled:!W(f),onClick:ke},{default:P(()=>N[6]||(N[6]=[M(" Create New Trial ")])),_:1,__:[6]},8,["disabled"]),W(f)?V("",!0):(o(),p("div",tc," Close other tabs to enable trial creation "))],512)),[[At,!E.value]]):V("",!0)]),_:1},512),R(qd,{visible:U.value,"onUpdate:visible":N[0]||(N[0]=ve=>U.value=ve),onTrialImported:z},null,8,["visible"])])}}}),fc=re(sc,[["__scopeId","data-v-55db8473"]]);export{fc as default};

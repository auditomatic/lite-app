import{f as ee,r as L,c as A,w as O,h as m,j as c,i as a,A as B,B as x,z as _,e as i,y as f,x as n,F as H,C as J,k as te,Y as ae,v as Z,Z as oe,t as re,D as j,Q as ue,G as se,$ as de}from"./index-8if2tzRy.js";import{a as le}from"./useV4VariableLists-B_Iv1biy.js";import{u as ce}from"./useV4VariableListCommands-BFD7gFwa.js";import{S as ve}from"./SaveOutlined-D9A0tWZJ.js";import"./useV4LiveQuery-BpGHTaC2.js";const pe={class:"simple-list-editor"},me={class:"editor-content"},fe={class:"bulk-entry-section"},_e={class:"section-header"},ge={class:"entry-stats"},he={key:0,class:"duplicates-warning"},be={class:"textarea-container"},ye={class:"textarea-actions"},we={key:0,class:"preview-section"},Ce={class:"section-header"},ke={class:"preview-grid"},xe={key:0,class:"preview-more"},Ve=ee({__name:"SimpleListEditorV3",props:{values:{},category:{}},emits:["update:values"],setup(G,{emit:F}){const g=G,U=F,V=L(""),u=L(),d=A(()=>V.value.trim()?V.value.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):[]),b=A(()=>{const v=new Set;return d.value.filter(h=>v.has(h)?!1:(v.add(h),!0))}),y=A(()=>d.value.length-b.value.length),D=A(()=>b.value.slice(0,20));function T(){U("update:values",b.value)}function W(){V.value="",U("update:values",[])}function l(){var v;(v=u.value)==null||v.click()}function p(v){var z;const h=(z=v.target.files)==null?void 0:z[0];if(!h)return;const K=new FileReader;K.onload=R=>{var S;const E=(S=R.target)==null?void 0:S.result;E&&(V.value=E,T())},K.readAsText(h)}function $(){return g.category==="refusal"?`Enter refusal values, one per line:

I cannot help with that
I'm not able to assist with this request  
That's not something I can do
I don't feel comfortable with that

Tip: You can paste from spreadsheets or import from files`:`Enter values, one per line:

red
blue
green
yellow

Tip: You can paste from spreadsheets or import from files`}function I(){switch(g.category){case"simple":return"Simple List";case"refusal":return"Refusal List";default:return"List"}}return O(()=>g.values,v=>{v.length>0&&!V.value&&(V.value=v.join(`
`))},{immediate:!0}),(v,h)=>{const K=f("a-textarea"),z=f("a-button"),R=f("a-tag");return c(),m("div",pe,[a("div",me,[a("div",fe,[a("div",_e,[a("h4",null,x(v.category==="refusal"?"Refusal Values":"Values"),1),a("div",ge,[_(x(b.value.length)+" "+x(b.value.length===1?"value":"values")+" ",1),y.value>0?(c(),m("span",he," ("+x(y.value)+" duplicates) ",1)):B("",!0)])]),a("div",be,[i(K,{value:V.value,"onUpdate:value":h[0]||(h[0]=E=>V.value=E),placeholder:$(),rows:15,size:"large",class:"values-textarea",onChange:T},null,8,["value","placeholder"]),a("div",ye,[i(z,{onClick:W,type:"text",danger:"",size:"small"},{default:n(()=>h[1]||(h[1]=[_(" Clear All ")])),_:1,__:[1]}),i(z,{onClick:l,type:"text",size:"small"},{default:n(()=>h[2]||(h[2]=[_(" Import from File ")])),_:1,__:[2]})])])]),b.value.length>0?(c(),m("div",we,[a("div",Ce,[h[3]||(h[3]=a("h4",null,"Preview",-1)),i(R,{color:v.category==="refusal"?"red":"blue"},{default:n(()=>[_(x(I()),1)]),_:1},8,["color"])]),a("div",ke,[(c(!0),m(H,null,J(D.value,(E,S)=>(c(),m("div",{key:S,class:"preview-item"},x(E),1))),128)),b.value.length>20?(c(),m("div",xe," ... and "+x(b.value.length-20)+" more ",1)):B("",!0)])])):B("",!0),a("input",{ref_key:"fileInput",ref:u,type:"file",accept:".txt,.csv",style:{display:"none"},onChange:p},null,544)])])}}}),$e=te(Ve,[["__scopeId","data-v-1861ba6b"]]),Ie={class:"attributed-list-editor"},Ee={class:"editor-content"},Ae={key:0,class:"progressive-disclosure-section"},Le={class:"disclosure-options"},ze={key:1,class:"example-notice"},Se={class:"notice-content"},Ue={class:"attribute-keys-section"},Ke={class:"section-header"},Ne={class:"attribute-keys-grid"},Be={class:"items-section"},Fe={class:"section-header"},De={class:"items-actions"},Re={class:"items-table-container"},Te={key:2,class:"stats-section"},Me={class:"stats-grid"},qe={class:"stat-label"},We={class:"stat-values"},Ye=ee({__name:"AttributedListEditorV3",props:{items:{},attributeKeys:{},showExample:{type:Boolean}},emits:["update:items","update:attribute-keys"],setup(G,{emit:F}){const g=G,U=F,{attributedLists:V}=le(),u=L(g.attributeKeys.length>0?[...g.attributeKeys]:["attribute_1","attribute_2"]),d=L([]),b=L(!1),y=L(!1);let D=1;function T(){const t=V.value.find(e=>e.name==="Intersectional Names 24");t!=null&&t.items&&(t!=null&&t.attributeKeys)&&(u.value=[...t.attributeKeys],d.value=t.items.map(e=>({...e,id:D++})),p())}const W=A(()=>{const t=[{title:"Value",key:"value",dataIndex:"value",width:200,fixed:"left"}];return u.value.forEach(e=>{e.trim()&&t.push({title:e,key:`attr_${e}`,dataIndex:`attr_${e}`,width:150,fixed:void 0})}),t.push({title:"Actions",key:"actions",dataIndex:"actions",width:80,fixed:"left"}),t});function l(){const t={};return u.value.forEach(e=>{e.trim()&&(t[e]="")}),{id:D++,value:"",attributes:t}}function p(){const t=d.value.filter(s=>s.value.trim()).map(s=>({value:s.value.trim(),attributes:{...s.attributes}})),e=u.value.filter(s=>s.trim());U("update:items",t),U("update:attribute-keys",e)}function $(){b.value=!0,y.value=!0,T()}function I(){b.value=!0,y.value=!1,u.value=["attribute_1","attribute_2"],d.value=[l()],p()}function v(){u.value.length<10&&(u.value.push(`attribute${u.value.length+1}`),d.value.forEach(t=>{t.attributes[`attribute${u.value.length}`]=""}),p())}function h(t){if(u.value.length>1){const e=u.value[t];u.value.splice(t,1),d.value.forEach(s=>{delete s.attributes[e]}),p()}}function K(){d.value.forEach(t=>{const e={};u.value.forEach(s=>{s.trim()&&(e[s]=t.attributes[s]||"")}),t.attributes=e}),p()}function z(){d.value.push(l()),p()}function R(t){d.value.length>1&&(d.value.splice(t,1),p())}function E(){d.value=[l()],p()}function S(){p()}function Q(t){const e=new Set;return d.value.forEach(s=>{var N;const C=(N=s.attributes[t])==null?void 0:N.trim();C&&e.add(C)}),Array.from(e)}function X(t,e){return d.value.filter(s=>{var C;return((C=s.attributes[t])==null?void 0:C.trim())===e}).length}function o(t){const e=["blue","green","orange","purple","red","cyan","magenta","yellow"];let s=0;for(let C=0;C<t.length;C++)s=t.charCodeAt(C)+((s<<5)-s);return e[Math.abs(s)%e.length]}function r(){g.items.length>0?d.value=g.items.map(t=>({...t,id:D++})):d.value=[]}return O(()=>g.items,()=>{r(),g.items.length>0&&(b.value=!0,y.value=!1)},{immediate:!0}),O(()=>g.attributeKeys,t=>{t.length>0&&(u.value=[...t])},{immediate:!0}),O(()=>g.showExample,t=>{t&&g.items.length===0&&(b.value=!1,y.value=!1)},{immediate:!0}),(t,e)=>{const s=f("a-button"),C=f("a-input"),N=f("a-table"),Y=f("a-tag");return c(),m("div",Ie,[a("div",Ee,[t.showExample&&!b.value&&d.value.length===0?(c(),m("div",Ae,[e[4]||(e[4]=a("div",{class:"disclosure-header"},[a("div",{class:"disclosure-icon"},"üöÄ"),a("div",{class:"disclosure-content"},[a("h3",null,"Create Your First Intersectional List"),a("p",null,"Intersectional lists will fill the variable placeholder in the prompt with a single text (e.g. name, city) that is tagged with one or more attributes (e.g. name ‚Üí gender and ethnicity, city ‚Üí region, size). Choose your starting point:")])],-1)),a("div",Le,[a("div",{class:"option-card example-option",onClick:$},[e[1]||(e[1]=ae('<div class="option-header" data-v-af07779a><span class="option-icon" data-v-af07779a>üéØ</span><h4 data-v-af07779a>Start with Example</h4><span class="option-badge recommended" data-v-af07779a>Recommended</span></div><p data-v-af07779a>Pre-loaded with 24 diverse names including race and gender attributes for bias testing. Perfect for beginners.</p><div class="option-preview" data-v-af07779a><div class="preview-items" data-v-af07779a><span class="preview-item" data-v-af07779a>Arjun Agarwal (Indian, Man)</span><span class="preview-item" data-v-af07779a>Latonya Booker (Black, Woman)</span><span class="preview-item" data-v-af07779a>MS [LAST NAME] (Control, Woman)</span><span class="preview-item" data-v-af07779a>A. Chen (Chinese, Control)</span><span class="preview-more" data-v-af07779a>+ 20 more names</span></div></div>',3)),i(s,{type:"primary",size:"large",block:""},{default:n(()=>e[0]||(e[0]=[_(" Use Example & Modify ")])),_:1,__:[0]})]),a("div",{class:"option-card fresh-option",onClick:I},[e[3]||(e[3]=ae('<div class="option-header" data-v-af07779a><span class="option-icon" data-v-af07779a>üìù</span><h4 data-v-af07779a>Start from Scratch</h4><span class="option-badge" data-v-af07779a>Advanced</span></div><p data-v-af07779a>Create your own intersectional list from scratch. Define your own attributes and add items manually.</p><div class="option-preview" data-v-af07779a><div class="preview-attributes" data-v-af07779a><span class="preview-attr" data-v-af07779a>attribute_1</span><span class="preview-attr" data-v-af07779a>attribute_2</span><span class="preview-more" data-v-af07779a>+ add more attributes</span></div></div>',3)),i(s,{size:"large",block:""},{default:n(()=>e[2]||(e[2]=[_(" Start Fresh ")])),_:1,__:[2]})])])])):B("",!0),y.value?(c(),m("div",ze,[a("div",Se,[e[6]||(e[6]=a("span",{class:"notice-icon"},"üéØ",-1)),e[7]||(e[7]=a("div",{class:"notice-text"},[a("strong",null,"Working with Intersectional Names 24 Example"),a("p",null,"You can modify these names and attributes, or add new ones. This is a great starting point for intersectional bias testing.")],-1)),i(s,{onClick:I,type:"text",size:"small"},{default:n(()=>e[5]||(e[5]=[_(" Clear & Start Fresh ")])),_:1,__:[5]})])])):B("",!0),a("div",Ue,[a("div",Ke,[e[9]||(e[9]=a("h4",null,"Attribute Keys",-1)),i(s,{size:"small",onClick:v,disabled:u.value.length>=10},{default:n(()=>e[8]||(e[8]=[_(" Add Key ")])),_:1,__:[8]},8,["disabled"])]),a("div",Ne,[(c(!0),m(H,null,J(u.value,(k,w)=>(c(),m("div",{key:w,class:"attribute-key-item"},[i(C,{value:u.value[w],"onUpdate:value":M=>u.value[w]=M,placeholder:"e.g., race_signal, gender_signal",size:"large",onChange:K},null,8,["value","onUpdate:value"]),i(s,{type:"text",danger:"",onClick:M=>h(w),disabled:u.value.length<=1,class:"remove-key-btn"},{default:n(()=>e[10]||(e[10]=[_(" ‚úï ")])),_:2,__:[10]},1032,["onClick","disabled"])]))),128))]),e[11]||(e[11]=a("div",{class:"attributes-help"},[a("p",null,'Define the signal attributes each item will have (e.g., "race_signal", "gender_signal", "age_group").')],-1))]),a("div",Be,[a("div",Fe,[a("h4",null,"Items ("+x(d.value.length)+")",1),a("div",De,[i(s,{size:"small",onClick:z},{default:n(()=>e[12]||(e[12]=[_(" Add Item ")])),_:1,__:[12]}),i(s,{size:"small",onClick:E,danger:"",type:"text"},{default:n(()=>e[13]||(e[13]=[_(" Clear All ")])),_:1,__:[13]})])]),a("div",Re,[i(N,{dataSource:d.value,columns:W.value,pagination:!1,scroll:{x:Math.max(600,u.value.length*150+300),y:500},size:"small","row-key":"id",class:"items-table"},{bodyCell:n(({column:k,record:w,index:M})=>[k.key==="value"?(c(),Z(C,{key:0,value:w.value,"onUpdate:value":q=>w.value=q,placeholder:"Enter value",size:"small",onChange:S},null,8,["value","onUpdate:value"])):k.key.startsWith("attr_")?(c(),Z(C,{key:1,value:w.attributes[k.key.replace("attr_","")],"onUpdate:value":q=>w.attributes[k.key.replace("attr_","")]=q,placeholder:"Enter attribute",size:"small",onChange:S},null,8,["value","onUpdate:value"])):k.key==="actions"?(c(),Z(s,{key:2,type:"text",danger:"",size:"small",onClick:q=>R(M),disabled:d.value.length<=1},{default:n(()=>e[14]||(e[14]=[_(" Delete ")])),_:2,__:[14]},1032,["onClick","disabled"])):B("",!0)]),_:1},8,["dataSource","columns","scroll"])])]),d.value.length>0?(c(),m("div",Te,[e[15]||(e[15]=a("div",{class:"section-header"},[a("h4",null,"Attribute Statistics")],-1)),a("div",Me,[(c(!0),m(H,null,J(u.value.filter(k=>k.trim()),k=>(c(),m("div",{key:k,class:"stat-item"},[a("div",qe,x(k),1),a("div",We,[(c(!0),m(H,null,J(Q(k),w=>(c(),Z(Y,{key:w,size:"small",color:o(w)},{default:n(()=>[_(x(w)+" ("+x(X(k,w))+") ",1)]),_:2},1032,["color"]))),128))])]))),128))])])):B("",!0)])])}}}),Pe=te(Ye,[["__scopeId","data-v-af07779a"]]),je={class:"variable-list-editor-page"},Oe={class:"header-content"},Ge={class:"page-title"},Qe={class:"editor-container"},Ze={key:0,class:"loading-container"},He={key:1,class:"editor-form"},Je={class:"form-section"},Xe={class:"form-row"},et={class:"form-section"},tt={class:"section-header"},at={key:0},st={key:1},lt={class:"footer-content"},it={class:"footer-actions"},nt=ee({__name:"VariableListEditorViewV3",setup(G){const F=oe(),g=ue(),{variableLists:U,loading:V}=le(),{createVariableList:u,updateVariableList:d,isExecuting:b}=ce(),y=A(()=>F.params.id),D=A(()=>F.query.category||"simple"),T=A(()=>V.value||b.value),W=A(()=>b.value),l=L({name:"",description:"",category:"simple"}),p=L([]),$=L([]),I=L(["attribute_1","attribute_2"]);function v(){if(!y.value){l.value.category=D.value;return}const o=U.value.find(r=>r.id===y.value);if(!o){V.value||(j.error("Variable list not found"),g.push("/variables"));return}l.value.name=o.name,l.value.description=o.description||"",l.value.category=o.category,o.category==="simple"||o.category==="refusal"?p.value=[...o.values||[]]:o.category==="attributed"&&($.value=[...o.items||[]],I.value=[...o.attributeKeys||["attribute_1","attribute_2"]])}function h(){p.value=[],$.value=[],I.value=["attribute_1","attribute_2"]}function K(o){p.value=o}function z(o){$.value=o}function R(o){I.value=o}const E=A(()=>l.value.name.trim()?l.value.category==="simple"||l.value.category==="refusal"?p.value.length>0&&p.value.some(o=>o.trim()):l.value.category==="attributed"?$.value.length>0&&I.value.length>0&&$.value.some(o=>o.value.trim()):!1:!1);async function S(){var o,r;if(E.value)if(y.value){const t={name:l.value.name.trim(),description:((o=l.value.description)==null?void 0:o.trim())||void 0};l.value.category==="simple"||l.value.category==="refusal"?t.values=p.value.filter(s=>s.trim()):l.value.category==="attributed"&&(t.items=$.value.filter(s=>s.value.trim()),t.attributeKeys=I.value.filter(s=>s.trim()));const e=await d(y.value,t);e.ok?(j.success("Variable list updated successfully"),g.push("/variables")):j.error(`Failed to update variable list: ${e.error.message}`)}else{const t={name:l.value.name.trim(),description:((r=l.value.description)==null?void 0:r.trim())||void 0,category:l.value.category};l.value.category==="simple"||l.value.category==="refusal"?t.values=p.value.filter(s=>s.trim()):l.value.category==="attributed"&&(t.items=$.value.filter(s=>s.value.trim()),t.attributeKeys=I.value.filter(s=>s.trim()));const e=await u(t);e.ok?(j.success("Variable list created successfully"),g.push("/variables")):j.error(`Failed to create variable list: ${e.error.message}`)}}function Q(){g.push("/variables")}function X(o){switch(o){case"simple":return"Simple List";case"attributed":return"Intersectional List";case"refusal":return"Refusal List";default:return"List"}}return re(()=>{v()}),O([()=>F.params.id,U],()=>{v()},{immediate:!0}),(o,r)=>{const t=f("a-button"),e=f("a-layout-header"),s=f("a-spin"),C=f("a-input"),N=f("a-form-item"),Y=f("a-select-option"),k=f("a-select"),w=f("a-textarea"),M=f("a-form"),q=f("a-layout-content"),ie=f("a-layout-footer"),ne=f("a-layout");return c(),m("div",je,[i(ne,null,{default:n(()=>[i(e,{class:"editor-header"},{default:n(()=>[a("div",Oe,[i(t,{type:"text",onClick:Q,class:"back-button"},{icon:n(()=>[i(se(de))]),default:n(()=>[r[3]||(r[3]=_(" Back to Variable Lists "))]),_:1,__:[3]}),a("h1",Ge,x(y.value?"Edit Variable List":"Create Variable List"),1)])]),_:1}),i(q,{class:"editor-content"},{default:n(()=>[a("div",Qe,[T.value?(c(),m("div",Ze,[i(s,{size:"large",tip:"Loading variable list..."})])):(c(),m("div",He,[i(M,{model:l.value,layout:"vertical"},{default:n(()=>[a("div",Je,[r[7]||(r[7]=a("div",{class:"section-header"},[a("h3",null,"Basic Information")],-1)),a("div",Xe,[i(N,{label:"Name",rules:[{required:!0,message:"Name is required"}],class:"form-item"},{default:n(()=>[i(C,{value:l.value.name,"onUpdate:value":r[0]||(r[0]=P=>l.value.name=P),placeholder:"Enter variable list name",size:"large"},null,8,["value"])]),_:1}),i(N,{label:"Category",class:"form-item"},{default:n(()=>[i(k,{value:l.value.category,"onUpdate:value":r[1]||(r[1]=P=>l.value.category=P),size:"large",disabled:!!y.value,onChange:h},{default:n(()=>[i(Y,{value:"simple"},{default:n(()=>r[4]||(r[4]=[_("Simple List")])),_:1,__:[4]}),i(Y,{value:"attributed"},{default:n(()=>r[5]||(r[5]=[_("Attributed List")])),_:1,__:[5]}),i(Y,{value:"refusal"},{default:n(()=>r[6]||(r[6]=[_("Refusal List")])),_:1,__:[6]})]),_:1},8,["value","disabled"])]),_:1})]),i(N,{label:"Description",class:"form-item full-width"},{default:n(()=>[i(w,{value:l.value.description,"onUpdate:value":r[2]||(r[2]=P=>l.value.description=P),placeholder:"Optional description",rows:2,size:"large"},null,8,["value"])]),_:1})]),a("div",et,[a("div",tt,[a("h3",null,x(X(l.value.category))+" Content",1)]),l.value.category==="simple"||l.value.category==="refusal"?(c(),m("div",at,[i($e,{values:p.value,category:l.value.category,"onUpdate:values":K},null,8,["values","category"])])):l.value.category==="attributed"?(c(),m("div",st,[i(Pe,{items:$.value,"attribute-keys":I.value,"show-example":!y.value&&$.value.length===0,"onUpdate:items":z,"onUpdate:attributeKeys":R},null,8,["items","attribute-keys","show-example"])])):B("",!0)])]),_:1},8,["model"])]))])]),_:1}),i(ie,{class:"editor-footer"},{default:n(()=>[a("div",lt,[r[9]||(r[9]=a("div",{class:"footer-stats"},null,-1)),a("div",it,[i(t,{size:"large",onClick:Q},{default:n(()=>r[8]||(r[8]=[_(" Cancel ")])),_:1,__:[8]}),i(t,{size:"large",type:"primary",onClick:S,loading:W.value,disabled:!E.value},{icon:n(()=>[i(se(ve))]),default:n(()=>[_(" "+x(y.value?"Save Changes":"Create List"),1)]),_:1},8,["loading","disabled"])])])]),_:1})]),_:1})])}}}),vt=te(nt,[["__scopeId","data-v-2ba5fd4a"]]);export{vt as default};

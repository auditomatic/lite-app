import{d as Z,c as E,R as m,Y as n,S as d,k as P,a0 as ue,F as L,_ as C,G as V,V as b,f as Q,$ as M,Z as k,W as Y,B as ge,u as J,r as ae,w as te,o as ie,X as _e}from"./vue-vendor-Cg89ltm_.js";import{u as ke}from"./useV4Models-B0PqA3bN.js";import{u as re}from"./useV4ProviderParameters-nYX3W6cO.js";import{h as ee,m as he,a as q,n as Ce}from"./index-BbRRImK4.js";import{u as $e}from"./useCostEstimation-B7tYYdXm.js";import{_ as ye,a9 as de,aa as ce,m as oe,ao as Me,C as be,t as Te,I as xe,ab as Pe,ac as Oe,z as we,ap as Fe,u as De,v as Ie,T as Se,s as Ve,G as Ue,M as qe,r as Ee,ai as Ae,S as ze}from"./ui-vendor-COTxn_WH.js";const Re={class:"model-search-filters"},Ne={class:"panel-header"},Be={class:"search-container"},Ge=Z({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(j,{emit:t}){const o=j,w=t,y=E({get:()=>o.modelValue,set:F=>w("update:modelValue",F)});return(F,x)=>{const U=ye;return n(),m("div",Re,[d("div",Ne,[x[2]||(x[2]=d("h3",null,"Available Models",-1)),d("div",Be,[x[1]||(x[1]=d("span",{class:"search-label"},"Search:",-1)),P(U,{value:y.value,"onUpdate:value":x[0]||(x[0]=g=>y.value=g),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),Ke=ee(Ge,[["__scopeId","data-v-56bdd915"]]),Le=["title"],je={key:0,class:"cost-group"},We={class:"cost-item"},Je={class:"cost-value"},Qe={class:"cost-value"},Ye={key:1,class:"cost-group"},He={class:"enviro-group"},Xe={key:0,class:"enviro-item"},Ze={key:1,class:"cost-tab"},et={key:2,class:"enviro-item"},tt={key:3,class:"cost-tab"},ot={key:4,class:"enviro-item"},nt={key:0,class:"cost-group"},st={class:"cost-item"},lt={class:"cost-value"},at={class:"cost-value"},ut={class:"enviro-group"},it={key:0,class:"enviro-item"},rt={key:1,class:"cost-tab"},dt={key:2,class:"enviro-item"},ct={key:3,class:"cost-tab"},pt={key:4,class:"enviro-item"},mt={key:0,class:"cost-item financial"},ft={key:0,class:"cost-value"},vt={key:1,class:"cost-value"},gt={key:1,class:"cost-item environmental"},_t={key:0,class:"enviro-item"},kt={class:"enviro-value"},ht={key:1,class:"enviro-item"},Ct={class:"enviro-value"},$t={key:2,class:"enviro-item"},yt={class:"enviro-value"},Mt={key:3,class:"cost-unit"},bt=Z({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(j){const t=j,o=he(),w=E(()=>!0),y=E(()=>o.preferences.showCO2),F=E(()=>o.preferences.showWater),x=E(()=>o.preferences.showElectricity);function U(){if(!t.model.capabilities)return"â€”";const e=t.model.capabilities.inputCostPerToken||0,l=t.model.capabilities.outputCostPerToken||0;if(t.mode==="per-thousand"){const _=(e+l)*1e3;return g(_)}else if(t.mode==="total")if(t.inputTokens!=null&&t.outputTokens!=null){const _=e*t.inputTokens+l*t.outputTokens;return g(_)}else return"??";return"â€”"}function g(e){if(e===0)return"0.00";if(e<.01){let l=2,_=e;for(;_<.1;)_*=10,l++;return e.toFixed(l)}return e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):Math.round(e).toLocaleString()}function $(e){if(e===0)return"0.00";if(e<.01){let l=2,_=e;for(;_<.1;)_*=10,l++;return e.toFixed(l)}return e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):Math.round(e).toLocaleString()}function D(){if(!t.model.capabilities)return"0";const e=(t.model.capabilities.inputCostPerToken||0)*1e3;return $(e)}function A(){if(!t.model.capabilities)return"0";const e=(t.model.capabilities.outputCostPerToken||0)*1e3;return $(e)}function W(){if(!t.model.capabilities||t.inputTokens==null||t.minOutputTokens==null)return"??";const e=t.model.capabilities.inputCostPerToken||0,l=t.model.capabilities.outputCostPerToken||0,_=e*t.inputTokens+l*t.minOutputTokens;return $(_)}function G(){if(!t.model.capabilities||t.inputTokens==null||t.maxOutputTokens==null)return"??";const e=t.model.capabilities.inputCostPerToken||0,l=t.model.capabilities.outputCostPerToken||0,_=e*t.inputTokens+l*t.maxOutputTokens;return $(_)}function B(e){return"??"}function N(e){return"??"}const I=E(()=>{const e=[];e.push("=== ModelCostDisplayV3 Debug ==="),e.push(`Mode: ${t.mode}`),e.push(`Model: ${t.model.provider}:${t.model.modelId}`),e.push(`Layout: ${t.layout}, Size: ${t.size}`),e.push(""),e.push("=== Token Input Data ==="),t.inputTokens&&e.push(`Input Tokens: ${t.inputTokens}`),t.outputTokens&&e.push(`Output Tokens: ${t.outputTokens}`),t.minOutputTokens&&e.push(`Min Output Tokens: ${t.minOutputTokens}`),t.maxOutputTokens&&e.push(`Max Output Tokens: ${t.maxOutputTokens}`),e.push(""),e.push("=== Model Pricing Rates ===");const l=t.model.capabilities?.inputCostPerToken||0,_=t.model.capabilities?.outputCostPerToken||0;if(e.push(`Input Rate: $${l} per token ($${(l*1e3).toFixed(4)}/1K)`),e.push(`Output Rate: $${_} per token ($${(_*1e3).toFixed(4)}/1K)`),e.push(""),e.push(`=== Calculations (Mode: ${t.mode}) ===`),t.mode==="per-thousand"){const T=(l+_)*1e3;e.push(`Combined rate per 1K: ($${l} + $${_}) Ã— 1000 = $${T.toFixed(6)}`),e.push(`Display: ${U()}`)}else if(t.mode==="total"&&t.inputTokens!=null&&t.outputTokens!=null){const T=l*t.inputTokens,R=_*t.outputTokens,K=T+R;e.push(`Input cost: $${l} Ã— ${t.inputTokens} = $${T.toFixed(6)}`),e.push(`Output cost: $${_} Ã— ${t.outputTokens} = $${R.toFixed(6)}`),e.push(`Total cost: $${T.toFixed(6)} + $${R.toFixed(6)} = $${K.toFixed(6)}`),e.push(`Display: ${U()}`)}else if(t.mode==="range"&&t.inputTokens!=null&&t.minOutputTokens!=null&&t.maxOutputTokens!=null){const T=l*t.inputTokens,R=_*t.minOutputTokens,K=_*t.maxOutputTokens,H=T+R,s=T+K;e.push(`Input cost: $${l} Ã— ${t.inputTokens} = $${T.toFixed(6)}`),e.push(`Min output cost: $${_} Ã— ${t.minOutputTokens} = $${R.toFixed(6)}`),e.push(`Max output cost: $${_} Ã— ${t.maxOutputTokens} = $${K.toFixed(6)}`),e.push(`Min total: $${T.toFixed(6)} + $${R.toFixed(6)} = $${H.toFixed(6)}`),e.push(`Max total: $${T.toFixed(6)} + $${K.toFixed(6)} = $${s.toFixed(6)}`),e.push(`Display: ${W()} - ${G()}`)}else if(t.mode==="input-output"){const T=l*1e3,R=_*1e3;e.push(`Input per 1K: $${l} Ã— 1000 = $${T.toFixed(6)}`),e.push(`Output per 1K: $${_} Ã— 1000 = $${R.toFixed(6)}`),e.push(`Display: $${D()}/1K input + $${A()}/1K output`)}else e.push("No calculations available for this mode/input combination");return e.join(`
`)});function z(){const e=I.value;q.info("ðŸ” ModelCostDisplayV3 Debug Info:",{mode:t.mode,model:`${t.model.provider}:${t.model.modelId}`,inputTokens:t.inputTokens,outputTokens:t.outputTokens,minOutputTokens:t.minOutputTokens,maxOutputTokens:t.maxOutputTokens,layout:t.layout,size:t.size,inputRate:t.model.capabilities?.inputCostPerToken,outputRate:t.model.capabilities?.outputCostPerToken,calculations:e.split(`
`).filter(l=>l.includes("=")).join(" | ")})}return(e,l)=>(n(),m("div",{class:ue(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]]),title:I.value,onMouseenter:z},[e.mode==="range"?(n(),m(L,{key:0},[w.value&&e.maxOutputTokens?(n(),m("span",je,[d("span",We,[l[0]||(l[0]=d("span",{class:"debug-mode"},"range:",-1)),d("span",Je,"$"+b(W()),1),l[1]||(l[1]=V(" - ")),d("span",Qe,"$"+b(G()),1)])])):w.value?(n(),m("span",Ye,l[2]||(l[2]=[d("span",{class:"cost-item"},[d("span",{class:"debug-mode"},"range:"),d("span",{class:"cost-value"},"Cost: ??")],-1)]))):C("",!0),l[3]||(l[3]=d("span",{class:"cost-tab"},null,-1)),d("span",He,[y.value?(n(),m("span",Xe,"COâ‚‚ "+b(N()),1)):C("",!0),y.value&&F.value?(n(),m("span",Ze)):C("",!0),F.value?(n(),m("span",et,"ðŸ’§"+b(N()),1)):C("",!0),(y.value||F.value)&&x.value?(n(),m("span",tt)):C("",!0),x.value?(n(),m("span",ot,"âš¡"+b(N()),1)):C("",!0)])],64)):e.mode==="input-output"?(n(),m(L,{key:1},[w.value?(n(),m("span",nt,[d("span",st,[l[4]||(l[4]=d("span",{class:"debug-mode"},"input-output:",-1)),d("span",lt,"$"+b(D()),1),l[5]||(l[5]=V("/1K input + ")),d("span",at,"$"+b(A()),1),l[6]||(l[6]=V("/1K output "))])])):C("",!0),l[7]||(l[7]=d("span",{class:"cost-tab"},null,-1)),d("span",ut,[y.value?(n(),m("span",it,"COâ‚‚ "+b(B()),1)):C("",!0),y.value&&F.value?(n(),m("span",rt)):C("",!0),F.value?(n(),m("span",dt,"ðŸ’§"+b(B()),1)):C("",!0),(y.value||F.value)&&x.value?(n(),m("span",ct)):C("",!0),x.value?(n(),m("span",pt,"âš¡"+b(B()),1)):C("",!0)])],64)):(n(),m(L,{key:2},[w.value?(n(),m("div",mt,[e.mode==="per-thousand"?(n(),m("span",ft,[l[8]||(l[8]=d("span",{class:"debug-mode"},"per-thousand:",-1)),V(" "+b(U())+" ",1),l[9]||(l[9]=d("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):e.mode==="total"?(n(),m("span",vt,[l[10]||(l[10]=d("span",{class:"debug-mode"},"total:",-1)),V(" "+b(U()),1)])):C("",!0)])):C("",!0),y.value||F.value||x.value?(n(),m("div",gt,[y.value?(n(),m("span",_t,[l[11]||(l[11]=d("span",{class:"enviro-icon"},"COâ‚‚",-1)),d("span",kt,b(B()),1)])):C("",!0),F.value?(n(),m("span",ht,[l[12]||(l[12]=d("span",{class:"enviro-icon"},"ðŸ’§",-1)),d("span",Ct,b(B()),1)])):C("",!0),x.value?(n(),m("span",$t,[l[13]||(l[13]=d("span",{class:"enviro-icon"},"âš¡",-1)),d("span",yt,b(B()),1)])):C("",!0),e.mode==="per-thousand"?(n(),m("span",Mt,"/ 1,000")):C("",!0)])):C("",!0)],64))],42,Le))}}),pe=ee(bt,[["__scopeId","data-v-9626c100"]]),Tt={class:"provider-header"},xt={class:"provider-name"},Pt={class:"provider-model-count"},Ot={key:0,class:"api-key-warning"},wt={class:"provider-models"},Ft=["onClick"],Dt={class:"model-name"},It={key:0,class:"model-specs"},St=Z({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(j){const t=Q(void 0);function o(y){return y}function w(y){t.value===y?t.value=void 0:t.value=y}return(y,F)=>{const x=oe,U=ce,g=de;return n(),M(g,{activeKey:t.value,"onUpdate:activeKey":F[0]||(F[0]=$=>t.value=$),bordered:!1,accordion:""},{default:k(()=>[(n(!0),m(L,null,Y(y.groupedModels,($,D)=>(n(),M(U,{key:D,class:"provider-panel","data-provider":D},{header:k(()=>[d("div",Tt,[d("span",xt,b(D),1),d("span",Pt,b($.length)+" models",1),y.requiresApiKey(D)&&!y.hasApiKey(y.getProviderGroup(D))?(n(),m("div",Ot,[P(J(Me)),F[1]||(F[1]=d("span",null,"API Key Missing",-1))])):C("",!0)])]),extra:k(()=>[P(x,{size:"small",type:"text",onClick:ge(A=>w(D),["stop"])},{default:k(()=>[V(b(t.value===D?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:k(()=>[d("div",wt,[(n(!0),m(L,null,Y($,A=>(n(),m("div",{key:A.id,class:ue(["model-row",{selected:y.selectedModelId===A.id}]),onClick:W=>y.$emit("select-model",A)},[d("div",Dt,b(A.displayName),1),y.hasConfigPanel?C("",!0):(n(),m("div",It,[P(pe,{model:A,mode:y.mode==="trial"?"range":"input-output","input-tokens":y.getInputTokensForModel(A),"min-output-tokens":10,"max-output-tokens":y.getOutputTokensForModel(A),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,Ft))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),Vt=ee(St,[["__scopeId","data-v-7ff59b1f"]]),Ut={class:"config-panel"},qt={class:"config-header"},Et={class:"config-header-title"},At={key:0,class:"total-cost"},zt={key:0,class:"cost-info"},Rt={class:"config-content"},Nt={class:"param-description"},Bt={class:"param-description"},Gt={key:0,class:"config-footer"},Kt={key:0,class:"duplicate-error"},Lt=Z({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},tokenData:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(j,{emit:t}){const o=j,w=t,{getBasicParameters:y,getAdvancedParameters:F,getParametersForModel:x}=re(),U=Q(""),g=ae({}),$=ae({}),D=Q(""),A=E(()=>o.selectedModel?y(o.selectedModel.provider,o.selectedModel.modelId):{}),W=E(()=>o.selectedModel?F(o.selectedModel.provider,o.selectedModel.modelId):{}),G=E(()=>{if(o.tokenData)return o.tokenData.totalTokens;const s=o.costEstimate?.inputTokens?.avgTokens??o.getInputTokensForModel?.(o.selectedModel);return s==null?null:s*(o.totalCalls??1)}),B=E(()=>{const s=o.getOutputTokensForModel?.(o.selectedModel);return o.costEstimate?.outputTokens&&o.tokenData?o.costEstimate.outputTokens*o.tokenData.combinationCount:s??null}),N=E(()=>{if(o.tokenData)return 10*o.tokenData.combinationCount;const s=o.totalCalls;return s==null?null:10*s}),I=E(()=>o.getOutputTokensForModel?.(o.selectedModel)??null);function z(s){if(!s)return;s.provider,s.modelId,o.mode,o.mode==="trial"&&(U.value=s.displayName),Object.keys(g).forEach(c=>delete g[c]),Object.keys($).forEach(c=>delete $[c]);const a=x(s.provider,s.modelId);if(o.initialParameters&&Object.keys(o.initialParameters).length>0){o.initialParameters,Object.assign(g,o.initialParameters);for(const[c,p]of Object.entries(o.initialParameters)){const u=a[c];p===u?.default?$[c]={mode:"default"}:$[c]={mode:"custom",value:p}}}else{for(const[c,p]of Object.entries(a))p.required?p.default!==void 0?($[c]={mode:"default"},g[c]=p.default,p.default):($[c]={mode:"custom",value:null},g[c]=null):p.default!==void 0?($[c]={mode:"default"},g[c]=p.default,p.default):($[c]={mode:"unset"},g[c]=null);({...g},{...$})}}te(()=>o.selectedModel,s=>{z(s),D.value=""},{immediate:!0}),te(g,()=>{D.value=""},{deep:!0}),ie(()=>{o.selectedModel&&z(o.selectedModel)});function e(s,a){const c=$[s],p=g[s];return c?.mode,a.default,!a.required&&(p==null||p==="")||c?.mode==="unset"?"Not set (parameter will be omitted)":a.default!==void 0?c?.mode==="default"?`Using default: ${a.default}`:`Default: ${a.default} (enter to override)`:a.required?"Required - enter value":"Enter value (optional)"}function l(s){const a=$[s],c=o.selectedModel?x(o.selectedModel.provider,o.selectedModel.modelId)[s]:void 0;if(c?.required&&a?.mode==="unset"||c?.required&&a?.mode==="custom"&&!a.value)return"error";if(a?.mode==="default")return"warning"}function _(s){return s.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function T(s,a,c){c.required,a==null||a===""?c?.required?c.default!==void 0&&(g[s]=c.default,$[s]={mode:"default"},c.default):(g[s]=null,$[s]={mode:"unset"}):(g[s]=a,a===c?.default?$[s]={mode:"default"}:$[s]={mode:"custom",value:a}),w("parameters-changed",{...g})}function R(){const s=[],a=o.selectedModel?x(o.selectedModel.provider,o.selectedModel.modelId):{};for(const[c,p]of Object.entries($)){const u=a[c];u?.required&&(p.mode==="unset"?s.push(`${_(c)} is required`):p.mode==="custom"&&(p.value===null||p.value===void 0||p.value==="")&&s.push(`${_(c)} needs a value`)),p.mode==="custom"&&p.value!==void 0&&p.value!==null&&(u?.min!==void 0&&p.value<u.min&&s.push(`${_(c)} must be >= ${u.min}`),u?.max!==void 0&&p.value>u.max&&s.push(`${_(c)} must be <= ${u.max}`))}return{valid:s.length===0,errors:s}}function K(){if(!o.selectedModel||o.mode==="trial"&&!U.value)return null;const s={},a=x(o.selectedModel.provider,o.selectedModel.modelId),c=(p,u,r)=>{const f=u.split(".");let S=p;for(let O=0;O<f.length-1;O++)S[f[O]]||(S[f[O]]={}),S=S[f[O]];S[f[f.length-1]]=r};for(const[p,u]of Object.entries($)){const r=a[p];let f;switch(u.mode){case"default":f=r?.default;break;case"custom":f=u.value;break;case"unset":continue}f!=null&&f!==""?c(s,p,f):f===!1?c(s,p,!1):r?.required&&q.error(`Required parameter ${p} has no valid value`)}return{name:o.mode==="trial"?U.value:o.selectedModel.displayName,provider:o.selectedModel.provider,modelId:o.selectedModel.modelId,parameters:s}}function H(){D.value="";const s=R();if(!s.valid){D.value=`Invalid configuration: ${s.errors.join(", ")}`;return}const a=K();if(a){if(o.existingConfigurations&&o.existingConfigurations.some(p=>p.provider===a.provider&&p.modelId===a.modelId&&JSON.stringify(p.parameters)===JSON.stringify(a.parameters))){D.value=`${a.provider}:${a.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}w("add-configuration",a)}}return(s,a)=>{const c=oe,p=xe,u=Te,r=Se,f=we,S=Fe,O=Ie,X=De,ne=Oe,se=Pe,le=ce,me=de,fe=Ve,ve=Ue;return n(),m("div",Ut,[d("div",qt,[d("div",Et,[d("h3",null,b(s.mode==="trial"?"Configure":"Model Parameters")+": "+b(s.selectedModel.displayName),1),s.showCloseButton?(n(),M(c,{key:0,type:"text",onClick:a[0]||(a[0]=i=>s.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:k(()=>[P(J(be))]),_:1})):C("",!0)]),s.mode==="trial"?(n(),m("div",At,[P(pe,{model:s.selectedModel,mode:"range","input-tokens":G.value,"output-tokens":B.value,"min-output-tokens":N.value,"max-output-tokens":I.value,layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens","min-output-tokens","max-output-tokens"]),s.totalCalls>1?(n(),m("span",zt,"("+b(s.totalCalls)+" calls total)",1)):C("",!0)])):C("",!0)]),d("div",Rt,[P(fe,{layout:"vertical"},{default:k(()=>[s.mode==="trial"?(n(),M(u,{key:0,label:"Configuration Name",required:""},{default:k(()=>[P(p,{value:U.value,"onUpdate:value":a[1]||(a[1]=i=>U.value=i),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):C("",!0),P(me,{"default-active-key":["basic"],ghost:""},{default:k(()=>[P(le,{key:"basic",header:"Basic Parameters"},{default:k(()=>[P(se,{gutter:16},{default:k(()=>[(n(!0),m(L,null,Y(A.value,(i,v)=>(n(),M(ne,{key:v,span:s.mode==="playground"?24:12},{default:k(()=>[P(u,null,{label:k(()=>[d("span",null,b(_(v)),1),i.required?(n(),M(r,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:k(()=>a[2]||(a[2]=[V("Required")])),_:1,__:[2]})):$[v]?.mode==="default"?(n(),M(r,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:k(()=>a[3]||(a[3]=[V("Default")])),_:1,__:[3]})):$[v]?.mode==="unset"?(n(),M(r,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:k(()=>a[4]||(a[4]=[V("Not Set")])),_:1,__:[4]})):C("",!0)]),default:k(()=>[i.type==="number"?(n(),M(f,{key:0,value:g[v],"onUpdate:value":h=>g[v]=h,min:i.min,max:i.max,step:.1,placeholder:e(v,i),"allow-clear":!i.required,status:l(v),style:{width:"100%"},size:"large",onChange:h=>T(v,h,i)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):i.type==="integer"?(n(),M(f,{key:1,value:g[v],"onUpdate:value":h=>g[v]=h,min:i.min,max:i.max,placeholder:e(v,i),"allow-clear":!i.required,status:l(v),style:{width:"100%"},size:"large",onChange:h=>T(v,h,i)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):i.type==="boolean"?(n(),M(S,{key:2,checked:g[v],"onUpdate:checked":h=>g[v]=h,"checked-children":"true","un-checked-children":"false",onChange:T},null,8,["checked","onUpdate:checked"])):i.type==="string"&&i.enum?(n(),M(X,{key:3,value:g[v],"onUpdate:value":h=>g[v]=h,placeholder:i.default?`Default: ${i.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!i.required,status:l(v),onChange:T},{default:k(()=>[i.default?(n(),M(O,{key:0,value:i.default},{default:k(()=>[V(b(i.default)+" (default) ",1)]),_:2},1032,["value"])):C("",!0),i.required?C("",!0):(n(),M(O,{key:1,value:void 0},{default:k(()=>a[5]||(a[5]=[d("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(n(!0),m(L,null,Y(i.enum.filter(h=>h!==i.default),h=>(n(),M(O,{key:h,value:h},{default:k(()=>[V(b(h),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(n(),M(p,{key:4,value:g[v],"onUpdate:value":h=>g[v]=h,placeholder:e(v,i),"allow-clear":!i.required,status:l(v),size:"large",onChange:T},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),d("div",Nt,b(i.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(W.value).length>0?(n(),M(le,{key:"advanced",header:"Advanced Parameters"},{default:k(()=>[P(se,{gutter:16},{default:k(()=>[(n(!0),m(L,null,Y(W.value,(i,v)=>(n(),M(ne,{key:v,span:s.mode==="playground"?24:12},{default:k(()=>[P(u,null,{label:k(()=>[d("span",null,b(_(v)),1),i.required?(n(),M(r,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:k(()=>a[6]||(a[6]=[V("Required")])),_:1,__:[6]})):$[v]?.mode==="default"?(n(),M(r,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:k(()=>a[7]||(a[7]=[V("Default")])),_:1,__:[7]})):$[v]?.mode==="unset"?(n(),M(r,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:k(()=>a[8]||(a[8]=[V("Not Set")])),_:1,__:[8]})):C("",!0)]),default:k(()=>[i.type==="number"||i.type==="integer"?(n(),M(f,{key:0,value:g[v],"onUpdate:value":h=>g[v]=h,min:i.min,max:i.max,step:i.type==="number"?.1:1,placeholder:e(v,i),"allow-clear":!i.required,status:l(v),style:{width:"100%"},size:"large",onChange:h=>T(v,h,i)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):i.type==="boolean"?(n(),M(S,{key:1,checked:g[v],"onUpdate:checked":h=>g[v]=h,"checked-children":"true","un-checked-children":"false",onChange:T},null,8,["checked","onUpdate:checked"])):i.type==="string"&&i.enum?(n(),M(X,{key:2,value:g[v],"onUpdate:value":h=>g[v]=h,placeholder:i.default?`Default: ${i.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!i.required,status:l(v),onChange:T},{default:k(()=>[i.default?(n(),M(O,{key:0,value:i.default},{default:k(()=>[V(b(i.default)+" (default) ",1)]),_:2},1032,["value"])):C("",!0),i.required?C("",!0):(n(),M(O,{key:1,value:void 0},{default:k(()=>a[9]||(a[9]=[d("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(n(!0),m(L,null,Y(i.enum.filter(h=>h!==i.default),h=>(n(),M(O,{key:h,value:h},{default:k(()=>[V(b(h),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(n(),M(p,{key:3,value:g[v],"onUpdate:value":h=>g[v]=h,placeholder:e(v,i),"allow-clear":!i.required,status:l(v),size:"large",onChange:T},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),d("div",Bt,b(i.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1})]),s.mode==="trial"?(n(),m("div",Gt,[D.value?(n(),m("div",Kt,[P(ve,{message:D.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):C("",!0),P(c,{type:"primary",size:"large",onClick:H,disabled:!U.value||!s.selectedModel},{default:k(()=>a[10]||(a[10]=[V(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):C("",!0)])}}}),jt=ee(Lt,[["__scopeId","data-v-000fce1e"]]),Wt={class:"modal-content-wrapper"},Jt={key:0,class:"loading-container"},Qt={key:1,class:"no-models-container"},Yt={class:"no-models-content"},Ht={key:2,class:"modal-content"},Xt={class:"models-panel"},Zt={class:"models-list"},eo=Z({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(j,{emit:t}){const o=j,w=t,y=_e(),{enabledModels:F,loading:x}=ke(),{requiresApiKey:U,getProviderGroup:g,getUIDefaults:$}=re(),{hasApiKey:D}=Ce(),{estimateCost:A,estimateTotalCost:W}=$e(),G=E(()=>F.value||[]),B=E(()=>{const u=G.value.length>0;return x.value&&!u}),N=Q(""),I=Q(null),z=Q(null),e=Q({}),l=E(()=>{if(!G.value)return{};let u=G.value;if(N.value){const f=N.value.toLowerCase();u=u.filter(S=>S.displayName.toLowerCase().includes(f)||S.modelId.toLowerCase().includes(f))}const r={};for(const f of u)r[f.provider]||(r[f.provider]=[]),r[f.provider].push(f);for(const f in r)r[f].sort((S,O)=>S.displayName.localeCompare(O.displayName));return r}),_=E(()=>{if(o.mode!=="trial")return 1;if(o.trialContext)return o.trialContext.totalCombinations;if(o.design){let u=1;for(const r of Object.values(o.design.variableBindings))r.type==="direct"&&(u*=r.values?.length||1);return u}return 1});te([I,e],async()=>{if(!I.value||o.mode!=="trial"){z.value=null;return}if(!o.trialContext&&!o.design){z.value=null;return}try{const u=Object.keys(e.value).length>0?e.value:$(I.value.provider,I.value.modelId);if(o.mode==="trial"&&o.trialContext?.tokenData){const r=W(o.trialContext.tokenData.totalTokens,o.trialContext.tokenData.combinationCount,I.value,u);r.meta.hasValidCost&&r.cost.total.expected>0?z.value={inputTokens:{avgTokens:o.trialContext.tokenData.perCallAverage},outputTokens:r.tokens.output.expected,totalCost:r.cost.total.expected,inputCost:r.cost.input,outputCost:r.cost.output.expected,costRange:{min:r.cost.total.min,max:r.cost.total.max,expected:r.cost.total.expected}}:z.value=null}else{const r=c(I.value);if(r===null){z.value=null;return}const f=A(r,I.value,u);f.meta.hasValidCost&&f.cost.total.expected>0?z.value={inputTokens:{avgTokens:r},outputTokens:f.tokens.output.expected,totalCost:f.cost.total.expected,inputCost:f.cost.input,outputCost:f.cost.output.expected,costRange:{min:f.cost.total.min,max:f.cost.total.max,expected:f.cost.total.expected}}:z.value=null}}catch(u){q.error("Failed to calculate cost estimate:",u),z.value=null}},{deep:!0});function T(){w("update:visible",!1),y.push("/models")}function R(u){if(I.value=u,o.mode==="trial"&&(e.value={}),o.mode==="playground"){w("select-model",u),w("update:visible",!1);return}}function K(u){q.debug("GenericModelSelectorModalV3: Parameters changed",u),e.value={...u}}function H(u){q.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:u,mode:o.mode}),o.mode==="single"?(w("confirm",{model:I.value,configuration:u}),w("update:visible",!1)):w("add-configuration",u)}function s(u){w("select-model",u),w("update:visible",!1)}function a(){I.value=null}function c(u){return o.mode==="trial"?o.trialContext&&o.trialContext.tokenData?o.trialContext.tokenData.totalTokens:o.design?.tokenEstimate?.avgTokens?o.design.tokenEstimate.avgTokens*_.value:null:1e3}function p(u){if(o.mode==="trial"){const r=Object.keys(e.value).length>0?e.value:$(u.provider,u.modelId),f=["max_tokens","max_completion_tokens","max_output_tokens","num_predict","maxTokens"];let S=null;for(const O of f)if(r[O]!==void 0&&r[O]!==null&&r[O]>0){S=r[O];break}return S===null?null:o.trialContext?.tokenData?S*o.trialContext.tokenData.combinationCount:S*_.value}return 1e3}return te(()=>o.visible,u=>{u&&(I.value=null,N.value="",e.value={},q.debug("GenericModelSelectorModalV3 opened - reset selection"))}),ie(()=>{q.debug("GenericModelSelectorModalV3 mounted",{mode:o.mode,visible:o.visible})}),(u,r)=>{const f=Ee,S=oe,O=qe;return n(),M(O,{open:u.visible,onCancel:r[1]||(r[1]=X=>u.$emit("update:visible",!1)),title:u.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:k(()=>[d("div",Wt,[B.value?(n(),m("div",Jt,[P(f,{size:"large",tip:"Loading models..."})])):G.value.length===0?(n(),m("div",Qt,[d("div",Yt,[P(J(Ae),{class:"no-models-icon"}),r[3]||(r[3]=d("h3",null,"No Models Available",-1)),r[4]||(r[4]=d("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),P(S,{type:"primary",size:"large",onClick:T},{default:k(()=>[P(J(ze)),r[2]||(r[2]=V(" Go to Models View "))]),_:1,__:[2]})])])):(n(),m("div",Ht,[d("div",Xt,[P(Ke,{modelValue:N.value,"onUpdate:modelValue":r[0]||(r[0]=X=>N.value=X)},null,8,["modelValue"]),d("div",Zt,[P(Vt,{"grouped-models":l.value,"selected-model-id":I.value?.id,mode:u.mode,"get-input-tokens-for-model":c,"get-output-tokens-for-model":p,"has-config-panel":!!I.value,"requires-api-key":J(U),"get-provider-group":J(g),"has-api-key":J(D),onSelectModel:R},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),I.value&&u.mode==="trial"?(n(),M(jt,{key:0,"selected-model":I.value,mode:u.mode,"total-calls":_.value,"cost-estimate":z.value,"token-data":u.trialContext?.tokenData,"get-input-tokens-for-model":c,"get-output-tokens-for-model":p,"existing-configurations":u.existingConfigurations,onClose:a,onAddConfiguration:H,onConfirmSelection:s,onParametersChanged:K},null,8,["selected-model","mode","total-calls","cost-estimate","token-data","existing-configurations"])):C("",!0)]))])]),_:1},8,["open","title"])}}}),uo=ee(eo,[["__scopeId","data-v-11663c6f"]]);export{uo as G,pe as M};

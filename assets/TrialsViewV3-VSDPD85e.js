const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/trial-bundle.service-CmcMU-bT.js","assets/index-BO0gdMSB.js","assets/vue-vendor-BZxY9vkr.js","assets/ui-vendor-DgwC-sRC.js","assets/utils-vendor-X1Ah6TN4.js","assets/data-vendor-CllpzWXw.js","assets/index-DLndv8Bi.css","assets/python-bundle-management-RKL4Ucly.js"])))=>i.map(i=>d[i]);
var Nt=Object.defineProperty;var Wt=(n,t,s)=>t in n?Nt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var ve=(n,t,s)=>Wt(n,typeof t!="symbol"?t+"":t,s);import{e as re,a as _,u as tt,d as Ke,_ as st}from"./index-BO0gdMSB.js";import{d as ue,f as B,c as P,o as ge,b as ye,w as ce,V as d,a5 as le,W as e,a2 as A,ad as ke,a7 as _e,_ as o,n as Ce,ae as zt,af as Ht,ag as Bt,$ as X,ah as Gt,ai as jt,a1 as J,v as mt,q as Se,k as E,a0 as x,F as Z,Y as ne,a9 as nt,aj as qt,ak as Kt,u as W,a8 as Qe,X as C,G as O,s as De,P as Ve,Q as Ae,a3 as vt,A as gt,al as Qt,B as ht,r as Jt,ab as Yt,a4 as _t,Z as Ne,aa as Je}from"./vue-vendor-BZxY9vkr.js";import{Q as yt,x as bt,a4 as Xt,P as Zt,a5 as Tt,a6 as es,K as ts,I as $t,Y as lt,a7 as ss,r as as,R as ns,$ as Ct,o as ls,V as os,X as is,C as at,n as rs,q as us,M as ot,H as kt,a0 as Ee,D as ds,k as ae,W as cs,u as St,a8 as ps,a9 as je,m as fs,E as ms}from"./ui-vendor-DgwC-sRC.js";import{b as wt}from"./utils-vendor-X1Ah6TN4.js";import{u as It}from"./useCostEstimation-CYOK9iBK.js";import{u as vs}from"./useHeatmapStylingV3-D-bcEOcj.js";import{b as Rt,u as gs,a as hs,c as _s}from"./useV4TrialCommands-Bgkk0bqU.js";import{u as ys}from"./useV4Models-DNXAce0_.js";import"./data-vendor-CllpzWXw.js";import"./useV4LiveQuery-CfOiSnL_.js";const bs={class:"right-panel"},Ts=ue({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(n,{expose:t,emit:s}){const c=n,v=s,r=B(c.defaultWidth),m=B(!1),k=B(0),$=B(0),l=B(window.innerWidth),b=B(!1),I=P(()=>l.value<c.mobileBreakpoint),g=P(()=>I.value?{width:`${Math.min(l.value*.85,400)}px`}:{width:`${r.value}px`});function S(){const u=localStorage.getItem(c.storageKey);if(u){const D=parseInt(u,10);!isNaN(D)&&D>=c.minWidth&&D<=c.maxWidth&&(r.value=D)}}function h(u){localStorage.setItem(c.storageKey,u.toString()),v("resize",u)}function y(u){m.value=!0,k.value=u.clientX,$.value=r.value,document.addEventListener("mousemove",V),document.addEventListener("mouseup",U),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function V(u){if(!m.value)return;const D=u.clientX-k.value,H=Math.max(c.minWidth,Math.min(c.maxWidth,$.value+D));r.value=H}function U(){m.value&&(m.value=!1,h(r.value),document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",U),document.body.style.userSelect="",document.body.style.cursor="")}function w(){r.value=c.defaultWidth,h(c.defaultWidth)}function i(){l.value=window.innerWidth,!I.value&&b.value&&(b.value=!1,v("mobile-overlay-change",!1))}function f(){I.value&&(b.value=!b.value,v("mobile-overlay-change",b.value))}function p(){b.value=!1,v("mobile-overlay-change",!1)}return t({toggleMobileOverlay:f,closeMobileOverlay:p}),ge(()=>{S(),window.addEventListener("resize",i)}),ye(()=>{window.removeEventListener("resize",i),U()}),ce(()=>c.defaultWidth,u=>{r.value===c.defaultWidth&&(r.value=u)}),(u,D)=>(o(),d("div",{class:le(["resizable-panel-container",{"mobile-overlay":I.value}])},[e("div",{class:le(["left-panel",{"overlay-visible":I.value&&b.value}]),style:_e(g.value)},[ke(u.$slots,"left",{},void 0,!0)],6),I.value?A("",!0):(o(),d("div",{key:0,class:le(["resize-handle",{dragging:m.value}]),onMousedown:y,onDblclick:w},D[0]||(D[0]=[e("div",{class:"handle-bar"},null,-1)]),34)),e("div",bs,[ke(u.$slots,"right",{},void 0,!0)]),I.value&&b.value?(o(),d("div",{key:1,class:"mobile-overlay-bg",onClick:p})):A("",!0)],2))}}),$s=re(Ts,[["__scopeId","data-v-949e1df1"]]);function Cs(){var n=window.navigator.userAgent,t=n.indexOf("MSIE ");if(t>0)return parseInt(n.substring(t+5,n.indexOf(".",t)),10);var s=n.indexOf("Trident/");if(s>0){var c=n.indexOf("rv:");return parseInt(n.substring(c+3,n.indexOf(".",c)),10)}var v=n.indexOf("Edge/");return v>0?parseInt(n.substring(v+5,n.indexOf(".",v)),10):-1}let Me;function Ye(){Ye.init||(Ye.init=!0,Me=Cs()!==-1)}var We={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ye(),Ce(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const n=document.createElement("object");this._resizeObject=n,n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex",-1),n.onload=this.addResizeHandlers,n.type="text/html",Me&&this.$el.appendChild(n),n.data="about:blank",Me||this.$el.appendChild(n)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Me&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const ks=Bt();zt("data-v-b329ee4c");const Ss={class:"resize-observer",tabindex:"-1"};Ht();const ws=ks((n,t,s,c,v,r)=>(o(),X("div",Ss)));We.render=ws;We.__scopeId="data-v-b329ee4c";We.__file="src/components/ResizeObserver.vue";function Pe(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pe=function(t){return typeof t}:Pe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(n)}function Is(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Rs(n,t){for(var s=0;s<t.length;s++){var c=t[s];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(n,c.key,c)}}function Es(n,t,s){return t&&Rs(n.prototype,t),n}function it(n){return Vs(n)||As(n)||Ls(n)||xs()}function Vs(n){if(Array.isArray(n))return Xe(n)}function As(n){if(typeof Symbol<"u"&&Symbol.iterator in Object(n))return Array.from(n)}function Ls(n,t){if(n){if(typeof n=="string")return Xe(n,t);var s=Object.prototype.toString.call(n).slice(8,-1);if(s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set")return Array.from(n);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Xe(n,t)}}function Xe(n,t){(t==null||t>n.length)&&(t=n.length);for(var s=0,c=new Array(t);s<t;s++)c[s]=n[s];return c}function xs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fs(n){var t;return typeof n=="function"?t={callback:n}:t=n,t}function Ds(n,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c,v,r,m=function($){for(var l=arguments.length,b=new Array(l>1?l-1:0),I=1;I<l;I++)b[I-1]=arguments[I];if(r=b,!(c&&$===v)){var g=s.leading;typeof g=="function"&&(g=g($,v)),(!c||$!==v)&&g&&n.apply(void 0,[$].concat(it(r))),v=$,clearTimeout(c),c=setTimeout(function(){n.apply(void 0,[$].concat(it(r))),c=0},t)}};return m._clear=function(){clearTimeout(c),c=null},m}function Et(n,t){if(n===t)return!0;if(Pe(n)==="object"){for(var s in n)if(!Et(n[s],t[s]))return!1;return!0}return!1}var Ms=function(){function n(t,s,c){Is(this,n),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(s,c)}return Es(n,[{key:"createObserver",value:function(s,c){var v=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Fs(s),this.callback=function(k,$){v.options.callback(k,$),k&&v.options.once&&(v.frozen=!0,v.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},m=r.leading;this.callback=Ds(this.callback,this.options.throttle,{leading:function($){return m==="both"||m==="visible"&&$||m==="hidden"&&!$}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(k){var $=k[0];if(k.length>1){var l=k.find(function(I){return I.isIntersecting});l&&($=l)}if(v.callback){var b=$.isIntersecting&&$.intersectionRatio>=v.threshold;if(b===v.oldResult)return;v.oldResult=b,v.callback(b,$)}},this.options.intersection),Ce(function(){v.observer&&v.observer.observe(v.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),n}();function Vt(n,t,s){var c=t.value;if(c)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var v=new Ms(n,c,s);n._vue_visibilityState=v}}function Ps(n,t,s){var c=t.value,v=t.oldValue;if(!Et(c,v)){var r=n._vue_visibilityState;if(!c){At(n);return}r?r.createObserver(c,s):Vt(n,{value:c},s)}}function At(n){var t=n._vue_visibilityState;t&&(t.destroyObserver(),delete n._vue_visibilityState)}var Os={beforeMount:Vt,updated:Ps,unmounted:At},Us={itemsLimit:1e3},Ns=/(auto|scroll)/;function Lt(n,t){return n.parentNode===null?t:Lt(n.parentNode,t.concat([n]))}var qe=function(t,s){return getComputedStyle(t,null).getPropertyValue(s)},Ws=function(t){return qe(t,"overflow")+qe(t,"overflow-y")+qe(t,"overflow-x")},zs=function(t){return Ns.test(Ws(t))};function rt(n){if(n instanceof HTMLElement||n instanceof SVGElement){for(var t=Lt(n.parentNode,[]),s=0;s<t.length;s+=1)if(zs(t[s]))return t[s];return document.scrollingElement||document.documentElement}}function Ze(n){"@babel/helpers - typeof";return Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(n)}var Hs={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Bs(){return this.items.length&&Ze(this.items[0])!=="object"}var et=!1;if(typeof window<"u"){et=!1;try{var Gs=Object.defineProperty({},"passive",{get:function(){et=!0}});window.addEventListener("test",null,Gs)}catch{}}let js=0;var ze={name:"RecycleScroller",components:{ResizeObserver:We},directives:{ObserveVisibility:Os},props:{...Hs,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const n={"-1":{accumulator:0}},t=this.items,s=this.sizeField,c=this.minItemSize;let v=1e4,r=0,m;for(let k=0,$=t.length;k<$;k++)m=t[k][s]||c,m<v&&(v=m),r+=m,n[k]={accumulator:r,size:m};return this.$_computedMinItemSize=v,n}return[]},simpleArray:Bs,itemIndexByKey(){const{keyField:n,items:t}=this,s={};for(let c=0,v=t.length;c<v;c++)s[t[c][n]]=c;return s}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const n=this.$_lastUpdateScrollPosition;typeof n=="number"&&this.$nextTick(()=>{this.scrollToPosition(n)})},beforeUnmount(){this.removeListeners()},methods:{addView(n,t,s,c,v){const r=Gt({id:js++,index:t,used:!0,key:c,type:v}),m=jt({item:s,position:0,nr:r});return n.push(m),m},unuseView(n,t=!1){const s=this.$_unusedViews,c=n.nr.type;let v=s.get(c);v||(v=[],s.set(c,v)),v.push(n),t||(n.nr.used=!1,n.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(n){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:s}=this.updateVisibleItems(!1,!0);s||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(n,t){this.ready&&(n||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(n,t=!1){const s=this.itemSize,c=this.gridItems||1,v=this.itemSecondarySize||s,r=this.$_computedMinItemSize,m=this.typeField,k=this.simpleArray?null:this.keyField,$=this.items,l=$.length,b=this.sizes,I=this.$_views,g=this.$_unusedViews,S=this.pool,h=this.itemIndexByKey;let y,V,U,w,i;if(!l)y=V=w=i=U=0;else if(this.$_prerender)y=w=0,V=i=Math.min(this.prerender,$.length),U=null;else{const T=this.getScroll();if(t){let R=T.start-this.$_lastUpdateScrollPosition;if(R<0&&(R=-R),s===null&&R<r||R<s)return{continuous:!0}}this.$_lastUpdateScrollPosition=T.start;const a=this.buffer;T.start-=a,T.end+=a;let L=0;if(this.$refs.before&&(L=this.$refs.before.scrollHeight,T.start-=L),this.$refs.after){const R=this.$refs.after.scrollHeight;T.end+=R}if(s===null){let R,Q=0,te=l-1,j=~~(l/2),oe;do oe=j,R=b[j].accumulator,R<T.start?Q=j:j<l-1&&b[j+1].accumulator>T.start&&(te=j),j=~~((Q+te)/2);while(j!==oe);for(j<0&&(j=0),y=j,U=b[l-1].accumulator,V=j;V<l&&b[V].accumulator<T.end;V++);for(V===-1?V=$.length-1:(V++,V>l&&(V=l)),w=y;w<l&&L+b[w].accumulator<T.start;w++);for(i=w;i<l&&L+b[i].accumulator<T.end;i++);}else{y=~~(T.start/s*c);const R=y%c;y-=R,V=Math.ceil(T.end/s*c),w=Math.max(0,Math.floor((T.start-L)/s*c)),i=Math.floor((T.end-L)/s*c),y<0&&(y=0),V>l&&(V=l),w<0&&(w=0),i>l&&(i=l),U=Math.ceil(l/c)*s}}V-y>Us.itemsLimit&&this.itemsLimitError(),this.totalSize=U;let f;const p=y<=this.$_endIndex&&V>=this.$_startIndex;if(p)for(let T=0,a=S.length;T<a;T++)f=S[T],f.nr.used&&(n&&(f.nr.index=h[f.item[k]]),(f.nr.index==null||f.nr.index<y||f.nr.index>=V)&&this.unuseView(f));const u=p?null:new Map;let D,H,Y;for(let T=y;T<V;T++){D=$[T];const a=k?D[k]:D;if(a==null)throw new Error(`Key is ${a} on item (keyField is '${k}')`);if(f=I.get(a),!s&&!b[T].size){f&&this.unuseView(f);continue}H=D[m];let L=g.get(H),R=!1;if(!f)p?L&&L.length?f=L.pop():f=this.addView(S,T,D,a,H):(Y=u.get(H)||0,(!L||Y>=L.length)&&(f=this.addView(S,T,D,a,H),this.unuseView(f,!0),L=g.get(H)),f=L[Y],u.set(H,Y+1)),I.delete(f.nr.key),f.nr.used=!0,f.nr.index=T,f.nr.key=a,f.nr.type=H,I.set(a,f),R=!0;else if(!f.nr.used&&(f.nr.used=!0,R=!0,L)){const Q=L.indexOf(f);Q!==-1&&L.splice(Q,1)}f.item=D,R&&(T===$.length-1&&this.$emit("scroll-end"),T===0&&this.$emit("scroll-start")),s===null?(f.position=b[T-1].accumulator,f.offset=0):(f.position=Math.floor(T/c)*s,f.offset=T%c*v)}return this.$_startIndex=y,this.$_endIndex=V,this.emitUpdate&&this.$emit("update",y,V,w,i),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:p}},getListenerTarget(){let n=rt(this.$el);return window.document&&(n===window.document.documentElement||n===window.document.body)&&(n=window),n},getScroll(){const{$el:n,direction:t}=this,s=t==="vertical";let c;if(this.pageMode){const v=n.getBoundingClientRect(),r=s?v.height:v.width;let m=-(s?v.top:v.left),k=s?window.innerHeight:window.innerWidth;m<0&&(k+=m,m=0),m+k>r&&(k=r-m),c={start:m,end:m+k}}else s?c={start:n.scrollTop,end:n.scrollTop+n.clientHeight}:c={start:n.scrollLeft,end:n.scrollLeft+n.clientWidth};return c},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,et?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(n){let t;const s=this.gridItems||1;this.itemSize===null?t=n>0?this.sizes[n-1].accumulator:0:t=Math.floor(n/s)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(n){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let s,c,v;if(this.pageMode){const r=rt(this.$el),m=r.tagName==="HTML"?0:r[t.scroll],k=r.getBoundingClientRect(),l=this.$el.getBoundingClientRect()[t.start]-k[t.start];s=r,c=t.scroll,v=n+m+l}else s=this.$el,c=t.scroll,v=n;s[c]=v},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((n,t)=>n.nr.index-t.nr.index)}}};const qs={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Ks={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Qs(n,t,s,c,v,r){const m=J("ResizeObserver"),k=mt("observe-visibility");return Se((o(),d("div",{class:le(["vue-recycle-scroller",{ready:v.ready,"page-mode":s.pageMode,[`direction-${n.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...$)=>r.handleScroll&&r.handleScroll(...$))},[n.$slots.before?(o(),d("div",qs,[ke(n.$slots,"before")],512)):A("v-if",!0),(o(),X(nt(s.listTag),{ref:"wrapper",style:_e({[n.direction==="vertical"?"minHeight":"minWidth"]:v.totalSize+"px"}),class:le(["vue-recycle-scroller__item-wrapper",s.listClass])},{default:x(()=>[(o(!0),d(Z,null,ne(v.pool,$=>(o(),X(nt(s.itemTag),qt({key:$.nr.id,style:v.ready?{transform:`translate${n.direction==="vertical"?"Y":"X"}(${$.position}px) translate${n.direction==="vertical"?"X":"Y"}(${$.offset}px)`,width:s.gridItems?`${n.direction==="vertical"&&s.itemSecondarySize||s.itemSize}px`:void 0,height:s.gridItems?`${n.direction==="horizontal"&&s.itemSecondarySize||s.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[s.itemClass,{hover:!s.skipHover&&v.hoverKey===$.nr.key}]]},Kt(s.skipHover?{}:{mouseenter:()=>{v.hoverKey=$.nr.key},mouseleave:()=>{v.hoverKey=null}})),{default:x(()=>[ke(n.$slots,"default",{item:$.item,index:$.nr.index,active:$.nr.used})]),_:2},1040,["style","class"]))),128)),ke(n.$slots,"empty")]),_:3},8,["style","class"])),n.$slots.after?(o(),d("div",Ks,[ke(n.$slots,"after")],512)):A("v-if",!0),E(m,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[k,r.handleVisibilityChange]])}ze.render=Qs;ze.__file="src/components/RecycleScroller.vue";const Js={class:"trial-list-search"},Ys=["value"],Xs=ue({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:t}){const s=t,c=B(),v=wt(l=>{s("update:modelValue",l)},300);function r(l){const b=l.target.value;v(b)}function m(){var l;s("update:modelValue",""),(l=c.value)==null||l.focus()}function k(){var l,b;(l=c.value)==null||l.focus(),(b=c.value)==null||b.select()}function $(l){l.type==="focus-trial-search"&&k()}return ge(()=>{window.addEventListener("focus-trial-search",$)}),ye(()=>{window.removeEventListener("focus-trial-search",$)}),(l,b)=>(o(),d("div",Js,[E(W(yt),{class:"search-icon"}),e("input",{ref_key:"searchInput",ref:c,type:"text",class:"search-input",placeholder:"Filter trials...",value:l.modelValue,onInput:r,onKeydown:Qe(m,["escape"])},null,40,Ys),l.modelValue?(o(),X(W(bt),{key:0,class:"clear-icon",onClick:m})):A("",!0)]))}}),Zs=re(Xs,[["__scopeId","data-v-3a032c2b"]]),ea={class:"item-content"},ta={class:"item-header"},sa=["title"],aa={key:0,class:"progress-bar"},na={class:"item-metadata"},la={class:"meta-item"},oa={class:"meta-item"},ia={key:0,class:"meta-separator"},ra={key:1,class:"meta-item cost"},ua=ue({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(n){const t=n,{calculateTemplateTokens:s,calculatePromptTokens:c,estimateTotalCost:v,sumEstimates:r,formatCost:m}=It(),k=P(()=>{if(t.trial.progress.total===0)return 0;const I=t.trial.progress.completed+t.trial.progress.failed;return Math.round(I/t.trial.progress.total*100)}),$=P(()=>{const{completed:I,failed:g,total:S}=t.trial.progress;return t.trial.status==="draft"?`${S} tasks`:`${I+g}/${S} tasks`}),l=P(()=>{const I=t.trial.started||t.trial.created;if(!I)return"";const S=new Date().getTime()-I.getTime(),h=Math.floor(S/1e3),y=Math.floor(h/60),V=Math.floor(y/60),U=Math.floor(V/24);return h<60?"now":y<60?`${y}m`:V<24?`${V}h`:`${U}d`}),b=P(()=>{var h,y;if(!t.trial.configurations||t.trial.configurations.length===0)return null;let I=null;if(t.trial.type==="template"&&((h=t.trial.templateConfig)!=null&&h.template))I=s(t.trial.templateConfig.template,t.trial.templateConfig.variables||{});else if(t.trial.type==="spreadsheet"&&((y=t.trial.spreadsheetConfig)!=null&&y.promptPattern)){const V=c(t.trial.spreadsheetConfig.promptPattern),U=t.trial.progress.total/t.trial.configurations.length;I={totalTokens:V*U,combinationCount:U,perCallAverage:V}}else if(t.trial.type==="playground")return null;if(!I||I.totalTokens===0)return null;const g=t.trial.configurations.map(V=>{const U=V.modelSnapshot;return U?v(I.totalTokens,I.combinationCount,U,V.parameters):null}).filter(Boolean);if(g.length===0)return null;const S=r(g);return`$${m(S,"compact")} total`});return(I,g)=>(o(),d("div",{class:le(["trial-list-item",{selected:I.selected,"has-progress":I.trial.status==="running"}]),onClick:g[0]||(g[0]=S=>I.$emit("click"))},[e("div",{class:le(["status-indicator",`status-${I.trial.status}`])},null,2),e("div",ea,[e("div",ta,[e("span",{class:"trial-name",title:I.trial.name},C(I.trial.name),9,sa),e("span",{class:le(["status-tag",`status-${I.trial.status}`])},C(I.trial.status.toUpperCase()),3)]),I.trial.status==="running"?(o(),d("div",aa,[e("div",{class:"progress-fill",style:_e({width:`${k.value}%`})},null,4)])):A("",!0),e("div",na,[e("span",la,C($.value),1),g[1]||(g[1]=e("span",{class:"meta-separator"},"•",-1)),e("span",oa,C(l.value),1),b.value?(o(),d("span",ia,"•")):A("",!0),b.value?(o(),d("span",ra,C(b.value),1)):A("",!0)])])],2))}}),ut=re(ua,[["__scopeId","data-v-67909aef"]]),da={class:"section-title"},ca=ue({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(n){return(t,s)=>(o(),d("div",{class:le(["trial-list-section",{"with-background":t.background}])},[e("span",da,C(t.title),1)],2))}}),dt=re(ca,[["__scopeId","data-v-07a26c58"]]),pa={class:"panel-header"},fa={class:"header-title"},ma={key:0,class:"title-text"},va={class:"trial-count"},ga={key:0,class:"header-actions"},ha={class:"filter-count"},_a={class:"filter-count"},ya={class:"filter-count"},ba={class:"filter-count"},Ta={class:"filter-count"},$a={key:1,class:"status-tabs"},Ca={class:"tab-count"},ka={class:"tab-count"},Sa={class:"tab-count"},wa={class:"trial-list-container"},Ia={key:1,class:"trial-list"},Ra={key:2,class:"collapsed-list"},Ea=["onClick"],Va={class:"collapsed-count"},Aa={key:3,class:"empty-state"},La=ue({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","import-trial","update-search","update-filter","refresh"],setup(n,{emit:t}){const s=n,c=t,v=B(!1),r=B("all"),m=B(250),k=P(()=>m.value<50),$=P(()=>s.trials.filter(u=>u.status==="running"||u.status==="paused").length),l=P(()=>s.trials.filter(u=>u.status==="completed"||u.status==="failed").length),b=P(()=>{let u=s.trials;if(s.searchQuery){const T=s.searchQuery.toLowerCase();u=u.filter(a=>{var te,j;const L=a.name.toLowerCase().includes(T),R=(j=(te=a.templateConfig)==null?void 0:te.template)==null?void 0:j.toLowerCase().includes(T),Q=a.configurations.some(oe=>oe.modelId.toLowerCase().includes(T)||oe.provider.toLowerCase().includes(T));return L||R||Q})}s.filterStatus!=="all"&&(u=u.filter(T=>T.status===s.filterStatus)),r.value==="active"?u=u.filter(T=>T.status==="running"||T.status==="paused"):r.value==="done"&&(u=u.filter(T=>T.status==="completed"||T.status==="failed"));const D=u.filter(T=>T.status==="running"),H=u.filter(T=>T.status!=="running"),Y=[];return D.length>0&&(Y.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),Y.push(...D.sort((T,a)=>{var L,R;return(((L=a.started)==null?void 0:L.getTime())||0)-(((R=T.started)==null?void 0:R.getTime())||0)}))),H.length>0&&(D.length>0&&Y.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),Y.push(...H.sort((T,a)=>{var L,R;return(((L=a.created)==null?void 0:L.getTime())||0)-(((R=T.created)==null?void 0:R.getTime())||0)}))),Y}),I=P(()=>b.value.map(u=>({...u,height:U(u)}))),g=P(()=>s.trials.filter(u=>r.value==="active"?u.status==="running"||u.status==="paused":r.value==="done"?u.status==="completed"||u.status==="failed":!0)),S=P(()=>s.searchQuery?"No trials found":s.filterStatus==="running"?"No trials are currently running":"No trials found"),h=P(()=>s.searchQuery?"No trials match your search":s.filterStatus!=="all"?`No ${s.filterStatus} trials`:"Create your first trial to get started"),y=P(()=>s.filterStatus==="all"&&!s.searchQuery);function V(u){return s.trials.filter(D=>D.status===u).length}function U(u){var Y;if(u.type==="section")return 32;const D=u.status==="running",H=(Y=u.configurations)==null?void 0:Y.some(T=>T.repeatCount>1);return D||H?96:80}function w(u){const D=u.progress.completed+u.progress.failed;return u.status==="running"?`${Math.round(D/u.progress.total*100)}%`:D.toString()}async function i(){v.value=!0;try{await new Promise(u=>setTimeout(u,500)),c("refresh")}finally{v.value=!1}}function f({key:u}){c("update-filter",u)}function p(){const u=document.querySelector(".trial-list-panel");u&&(m.value=u.clientWidth)}return ge(()=>{p(),window.addEventListener("resize",p);const u=document.querySelector(".trial-list-panel");u&&new ResizeObserver(()=>p()).observe(u)}),ye(()=>{window.removeEventListener("resize",p)}),(u,D)=>{const H=J("a-button"),Y=J("a-menu-item"),T=J("a-menu-divider"),a=J("a-menu"),L=J("a-dropdown");return o(),d("div",{class:le(["trial-list-panel",{collapsed:k.value}])},[e("div",pa,[e("div",fa,[E(W(Xt),{class:"title-icon"}),k.value?A("",!0):(o(),d("span",ma,"Trials")),e("span",va,C(u.trials.length),1)]),k.value?A("",!0):(o(),d("div",ga,[E(H,{type:"primary",size:"small",onClick:D[0]||(D[0]=R=>u.$emit("create-trial"))},{default:x(()=>[E(W(Zt)),D[7]||(D[7]=O(" New Trial "))]),_:1,__:[7]}),E(H,{size:"small",onClick:D[1]||(D[1]=R=>u.$emit("import-trial"))},{default:x(()=>[E(W(Tt)),D[8]||(D[8]=O(" Import "))]),_:1,__:[8]}),E(H,{size:"small",onClick:i,loading:v.value},{default:x(()=>[E(W(es),{spin:v.value},null,8,["spin"])]),_:1},8,["loading"]),E(L,null,{overlay:x(()=>[E(a,{onClick:f},{default:x(()=>[E(Y,{key:"all"},{default:x(()=>D[9]||(D[9]=[e("span",null,"All Trials",-1)])),_:1,__:[9]}),E(T),E(Y,{key:"running"},{default:x(()=>[D[10]||(D[10]=e("span",null,"Running Only",-1)),e("span",ha,C(V("running")),1)]),_:1,__:[10]}),E(Y,{key:"completed"},{default:x(()=>[D[11]||(D[11]=e("span",null,"Completed Only",-1)),e("span",_a,C(V("completed")),1)]),_:1,__:[11]}),E(Y,{key:"failed"},{default:x(()=>[D[12]||(D[12]=e("span",null,"Failed Only",-1)),e("span",ya,C(V("failed")),1)]),_:1,__:[12]}),E(Y,{key:"paused"},{default:x(()=>[D[13]||(D[13]=e("span",null,"Paused Only",-1)),e("span",ba,C(V("paused")),1)]),_:1,__:[13]}),E(Y,{key:"draft"},{default:x(()=>[D[14]||(D[14]=e("span",null,"Draft Only",-1)),e("span",Ta,C(V("draft")),1)]),_:1,__:[14]})]),_:1})]),default:x(()=>[E(H,{size:"small"},{default:x(()=>[E(W(ts))]),_:1})]),_:1})]))]),k.value?A("",!0):(o(),X(Zs,{key:0,"model-value":u.searchQuery,"onUpdate:modelValue":D[2]||(D[2]=R=>u.$emit("update-search",R))},null,8,["model-value"])),k.value?A("",!0):(o(),d("div",$a,[e("div",{class:le(["status-tab",{active:r.value==="all"}]),onClick:D[3]||(D[3]=R=>r.value="all")},[D[15]||(D[15]=e("span",{class:"tab-icon"},"📊",-1)),D[16]||(D[16]=e("span",{class:"tab-label"},"ALL",-1)),e("span",Ca,C(u.trials.length),1)],2),e("div",{class:le(["status-tab",{active:r.value==="active"}]),onClick:D[4]||(D[4]=R=>r.value="active")},[D[17]||(D[17]=e("span",{class:"tab-icon"},"🟢",-1)),D[18]||(D[18]=e("span",{class:"tab-label"},"Active",-1)),e("span",ka,C($.value),1)],2),e("div",{class:le(["status-tab",{active:r.value==="done"}]),onClick:D[5]||(D[5]=R=>r.value="done")},[D[19]||(D[19]=e("span",{class:"tab-icon"},"✅",-1)),D[20]||(D[20]=e("span",{class:"tab-label"},"Done",-1)),e("span",Sa,C(l.value),1)],2)])),e("div",wa,[!k.value&&b.value.length>100?(o(),X(W(ze),{key:0,class:"trial-list virtual-list",items:I.value,"size-field":"height","key-field":"id",buffer:10},{default:x(({item:R})=>[R.type==="section"?(o(),X(dt,{key:0,title:R.title,background:R.background},null,8,["title","background"])):(o(),X(ut,{key:1,trial:R,selected:R.id===u.selectedTrialId,"data-trial-id":R.id,onClick:Q=>u.$emit("select-trial",R.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):k.value?(o(),d("div",Ra,[(o(!0),d(Z,null,ne(g.value,R=>(o(),d("div",{key:R.id,class:le(["collapsed-item",{selected:R.id===u.selectedTrialId}]),onClick:Q=>u.$emit("select-trial",R.id)},[e("div",{class:le(["status-dot",`status-${R.status}`])},null,2),e("span",Va,C(w(R)),1)],10,Ea))),128))])):(o(),d("div",Ia,[(o(!0),d(Z,null,ne(b.value,(R,Q)=>(o(),d(Z,{key:R.id||`section-${Q}`},[R.type==="section"?(o(),X(dt,{key:0,title:R.title,background:R.background},null,8,["title","background"])):(o(),X(ut,{key:1,trial:R,selected:R.id===u.selectedTrialId,"data-trial-id":R.id,onClick:te=>u.$emit("select-trial",R.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),b.value.length===0&&!k.value?(o(),d("div",Aa,[E(W($t),{class:"empty-icon"}),e("h3",null,C(S.value),1),e("p",null,C(h.value),1),y.value?(o(),X(H,{key:0,type:"primary",size:"large",onClick:D[6]||(D[6]=R=>u.$emit("create-trial"))},{default:x(()=>D[21]||(D[21]=[O(" Create New Trial ")])),_:1,__:[21]})):A("",!0)])):A("",!0)])],2)}}}),xa=re(La,[["__scopeId","data-v-ad2a17cf"]]),Fa={class:"trial-header"},Da={class:"header-main"},Ma={class:"header-title"},Pa={class:"trial-name"},Oa={key:0,class:"progress-container"},Ua={class:"progress-bar"},Na={class:"progress-stats-inline"},Wa={class:"progress-text"},za={key:0,class:"progress-stat"},Ha={class:"stat-number"},Ba={key:1,class:"progress-stat"},Ga={class:"stat-number"},ja={key:2,class:"progress-stat"},qa={class:"stat-number"},Ka=ue({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(n){const t=n,s=P(()=>{let h=t.trial.name;return h=h.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),h=h.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),h.trim()}),c=P(()=>!0),v=P(()=>t.progress?t.progress.completed+t.progress.failed:0),r=P(()=>{if(!t.progress||t.progress.total===0)return 0;const h=t.progress.completed+t.progress.failed;return Math.round(h/t.progress.total*100)}),m=P(()=>{const h=t.trial.started||t.trial.created;if(!h)return"0m";let y;if(t.trial.status==="draft")return"0m";t.trial.completed?y=t.trial.completed:y=new Date;const V=y.getTime()-h.getTime(),U=Math.floor(V/(1e3*60*60)),w=Math.floor(V%(1e3*60*60)/(1e3*60));return U>0?`${U}h ${w}m`:`${w}m`}),k=P(()=>{var y;if(!((y=t.progress)!=null&&y.avgLatencyMs))return null;const h=t.progress.avgLatencyMs;return h<1e3?`${Math.round(h)}ms`:`${(h/1e3).toFixed(1)}s`}),{calculateTemplateTokens:$,calculatePromptTokens:l,estimateTotalCost:b,sumEstimates:I,formatCost:g}=It();P(()=>{var U,w,i;if(!t.trial.configurations||t.trial.configurations.length===0)return null;let h=null;if(t.trial.type==="template"&&((U=t.trial.templateConfig)!=null&&U.template))h=$(t.trial.templateConfig.template,t.trial.templateConfig.variables||{});else if(t.trial.type==="spreadsheet"&&((w=t.trial.spreadsheetConfig)!=null&&w.promptPattern)){const f=l(t.trial.spreadsheetConfig.promptPattern),u=(((i=t.progress)==null?void 0:i.total)||t.trial.progress.total)/t.trial.configurations.length;h={totalTokens:f*u,combinationCount:u,perCallAverage:f}}else if(t.trial.type==="playground")return null;if(!h||h.totalTokens===0)return null;const y=t.trial.configurations.map(f=>{const p=f.modelSnapshot;return p?b(h.totalTokens,h.combinationCount,p,f.parameters):null}).filter(Boolean);if(y.length===0)return null;const V=I(y);return`${g(V,"compact")} total`});const S=P(()=>{var i;if(t.trial.status!=="running"||!t.progress||t.progress.completed===0)return null;const y=(Date.now()-(((i=t.trial.started)==null?void 0:i.getTime())||0))/t.progress.completed,V=t.progress.pending*y,U=Math.floor(V/(1e3*60)),w=Math.floor(V%(1e3*60)/1e3);if(U>60){const f=Math.floor(U/60),p=U%60;return`${f}h ${p}m`}return`${U}m ${w}s`});return(h,y)=>{var V;return o(),d("div",Fa,[e("div",Da,[e("div",Ma,[e("h2",Pa,C(s.value),1),e("span",{class:le(["status-tag",`status-${h.trial.status}`])},C(h.trial.status.toUpperCase()),3)]),c.value?(o(),d("div",Oa,[e("div",Ua,[e("div",{class:"progress-fill",style:_e({width:`${r.value}%`})},null,4)]),e("div",Na,[e("span",Wa,C(v.value)+"/"+C(((V=h.progress)==null?void 0:V.total)||0)+" ("+C(r.value)+"%) ",1),m.value?(o(),d("span",za,[y[0]||(y[0]=e("span",{class:"stat-label"},"Duration:",-1)),y[1]||(y[1]=O()),e("span",Ha,C(m.value),1)])):A("",!0),k.value?(o(),d("span",Ba,[y[2]||(y[2]=e("span",{class:"stat-label"},"Avg:",-1)),y[3]||(y[3]=O()),e("span",Ga,C(k.value),1)])):A("",!0),S.value?(o(),d("span",ja,[y[4]||(y[4]=e("span",{class:"stat-label"},"Remaining:",-1)),y[5]||(y[5]=O()),e("span",qa,"~"+C(S.value),1)])):A("",!0)])])):A("",!0)]),A("",!0)])}}}),Qa=re(Ka,[["__scopeId","data-v-65916275"]]),Ja={class:"trial-actions"},Ya={class:"action-group execution-controls"},Xa={class:"action-group data-actions"},Za={class:"action-group management-actions"},en=ue({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(n,{emit:t}){const s=n,c=t,v=B(!1),r=B(!1),m=B(!1);P(()=>{var f;return((f=s.executionState)==null?void 0:f.currentTrialId)===s.trial.id});const k=P(()=>["draft","failed","cancelled"].includes(s.trial.status)),$=P(()=>s.trial.status==="running"),l=P(()=>s.trial.status==="paused"),b=P(()=>["running","paused"].includes(s.trial.status));function I(){c("start")}async function g(){v.value=!0,r.value=!1,c("pause"),setTimeout(()=>{v.value=!1},1e3)}async function S(){r.value=!0,v.value=!1,c("resume"),setTimeout(()=>{r.value=!1},3e3)}function h(){ot.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>c("cancel")})}async function y(){m.value=!0,c("refresh"),setTimeout(()=>{m.value=!1},500)}function V({key:f}){f==="data"?c("export-data"):f==="python"&&c("export-python")}function U(){c("duplicate")}function w(){c("edit")}function i(){const f=s.trial.progress.total;ot.confirm({title:"Delete trial?",content:`Delete trial and all ${f} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{c("delete")}})}return(f,p)=>{const u=J("a-button"),D=J("a-menu-item"),H=J("a-menu"),Y=J("a-dropdown");return o(),d("div",Ja,[e("div",Ya,[k.value?(o(),X(u,{key:0,type:"primary",size:"large",disabled:!f.isLeader,onClick:I},{default:x(()=>[E(W(lt)),p[0]||(p[0]=O(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):A("",!0),$.value?(o(),X(u,{key:1,size:"large",disabled:!f.isLeader,loading:v.value,onClick:g},{default:x(()=>[v.value?A("",!0):(o(),X(W(ss),{key:0})),O(" "+C(v.value?"Pausing...":"Pause"),1)]),_:1},8,["disabled","loading"])):A("",!0),l.value?(o(),X(u,{key:2,type:"primary",size:"large",disabled:!f.isLeader||r.value,loading:r.value,onClick:S},{default:x(()=>[r.value?A("",!0):(o(),X(W(lt),{key:0})),O(" "+C(r.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):A("",!0),b.value?(o(),X(u,{key:3,danger:"",size:"large",disabled:!f.isLeader,onClick:h},{default:x(()=>[E(W(as)),p[1]||(p[1]=O(" Cancel "))]),_:1,__:[1]},8,["disabled"])):A("",!0)]),e("div",Xa,[E(u,{size:"large",loading:m.value,onClick:y,title:"Refresh trial data from database"},{default:x(()=>[m.value?(o(),X(W(Ct),{key:1,spin:""})):(o(),X(W(ns),{key:0})),O(" "+C(m.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),E(Y,null,{overlay:x(()=>[E(H,{onClick:V},{default:x(()=>[E(D,{key:"data"},{default:x(()=>[E(W(os)),p[3]||(p[3]=O(" Export Data "))]),_:1,__:[3]}),E(D,{key:"python"},{default:x(()=>[E(W(is)),p[4]||(p[4]=O(" Export Python Script "))]),_:1,__:[4]})]),_:1})]),default:x(()=>[E(u,{size:"large"},{default:x(()=>[p[2]||(p[2]=O(" Export ")),E(W(ls))]),_:1,__:[2]})]),_:1})]),e("div",Za,[E(u,{size:"large",disabled:!f.isLeader,onClick:U},{default:x(()=>[E(W(at)),p[5]||(p[5]=O(" Duplicate "))]),_:1,__:[5]},8,["disabled"]),f.trial.status==="draft"?(o(),X(u,{key:0,size:"large",disabled:!f.isLeader,onClick:w},{default:x(()=>[E(W(rs)),p[6]||(p[6]=O(" Edit "))]),_:1,__:[6]},8,["disabled"])):A("",!0),E(u,{danger:"",size:"large",disabled:!f.isLeader,onClick:i},{default:x(()=>[E(W(us)),p[7]||(p[7]=O(" Delete "))]),_:1,__:[7]},8,["disabled"])])])}}}),tn=re(en,[["__scopeId","data-v-e642c431"]]),sn={class:"snapshot-debug"},an={class:"debug-header"},nn={class:"status-row"},ln={key:0,class:"badge success"},on={key:1,class:"badge warning"},rn={key:0,class:"status-row"},un={key:0,class:"variables-section"},dn={class:"variable-header"},cn={class:"var-name"},pn={class:"var-type"},fn={key:0,class:"snapshot-content"},mn={class:"snapshot-meta"},vn={key:0},gn={class:"snapshot-items"},hn={class:"items-preview"},_n={class:"item-index"},yn={class:"item-value"},bn={key:0,class:"item-attrs"},Tn={key:0,class:"more-indicator"},$n={key:1,class:"no-snapshot"},Cn={key:0},kn={key:1,class:"legacy-warning"},Sn={class:"debug-footer"},wn=ue({__name:"SnapshotDebugModal",props:{visible:{type:Boolean},trial:{},migrating:{type:Boolean}},emits:["close","migrate"],setup(n){const t=n,s=P(()=>{var l;return((l=t.trial.templateConfig)==null?void 0:l.hasSnapshots)===!0}),c=P(()=>{var l;return((l=t.trial.templateConfig)==null?void 0:l.variables)||{}});function v(l){return"snapshot"in l&&l.snapshot!=null}function r(l){return l.snapshot}function m(l){return v(l)?`${r(l).source.type} (snapshot)`:l.type==="value"?"Direct values":l.type==="list"?"List reference":"Unknown"}function k(){var l;for(const b of Object.values(c.value))if(v(b)){const I=r(b);if((l=I.source)!=null&&l.snapshotDate)return new Date(I.source.snapshotDate).toLocaleString()}return"Unknown"}function $(){const l={trialId:t.trial.id,trialName:t.trial.name,hasSnapshots:s.value,variables:c.value};navigator.clipboard.writeText(JSON.stringify(l,null,2)),ae.success("Debug info copied to clipboard")}return(l,b)=>{const I=J("a-tag"),g=J("a-alert"),S=J("a-button"),h=J("a-modal");return o(),X(h,{visible:l.visible,title:"Variable Snapshot Debug View",width:"80%",footer:null,onCancel:b[2]||(b[2]=y=>l.$emit("close"))},{default:x(()=>[e("div",sn,[e("div",an,[e("div",nn,[b[5]||(b[5]=e("span",{class:"label"},"Snapshot Status:",-1)),s.value?(o(),d("span",ln,[E(W(kt)),b[3]||(b[3]=O(" Snapshots Enabled "))])):(o(),d("span",on,[E(W(Ee)),b[4]||(b[4]=O(" Legacy Mode (No Snapshots) "))]))]),s.value?(o(),d("div",rn,[b[6]||(b[6]=e("span",{class:"label"},"Snapshot Date:",-1)),e("span",null,C(k()),1)])):A("",!0)]),s.value?(o(),d("div",un,[b[8]||(b[8]=e("h3",null,"Variable Snapshots",-1)),(o(!0),d(Z,null,ne(c.value,(y,V)=>(o(),d("div",{key:V,class:"variable-card"},[e("div",dn,[e("span",cn,C(V),1),e("span",pn,C(m(y)),1)]),v(y)?(o(),d("div",fn,[e("div",mn,[e("span",null,"Source: "+C(r(y).source.type),1),r(y).source.listName?(o(),d("span",vn," List: "+C(r(y).source.listName),1)):A("",!0),e("span",null,"Items: "+C(r(y).items.length),1)]),e("div",gn,[e("div",hn,[(o(!0),d(Z,null,ne(r(y).items.slice(0,5),(U,w)=>(o(),d("div",{key:w,class:"item-row"},[e("span",_n,C(w+1)+".",1),e("span",yn,C(U.value),1),U.attributes&&Object.keys(U.attributes).length>0?(o(),d("span",bn,[(o(!0),d(Z,null,ne(U.attributes,(i,f)=>(o(),X(I,{key:f,size:"small"},{default:x(()=>[O(C(f)+": "+C(i),1)]),_:2},1024))),128))])):A("",!0)]))),128)),r(y).items.length>5?(o(),d("div",Tn," ... and "+C(r(y).items.length-5)+" more items ",1)):A("",!0)])])])):(o(),d("div",$n,[E(W(Ee)),b[7]||(b[7]=O(" No snapshot - using live reference ")),y.listId?(o(),d("span",Cn,"List ID: "+C(y.listId),1)):A("",!0)]))]))),128))])):(o(),d("div",kn,[E(g,{message:"Legacy Trial",description:"This trial was created before snapshots were implemented. Variable lists are loaded dynamically from the database, which means changes to lists will affect trial duplication.",type:"warning","show-icon":""}),E(S,{type:"primary",onClick:b[0]||(b[0]=y=>l.$emit("migrate")),loading:l.migrating,style:{"margin-top":"16px"}},{default:x(()=>[E(W(ds)),b[9]||(b[9]=O(" Migrate to Snapshots "))]),_:1,__:[9]},8,["loading"])])),e("div",Sn,[E(S,{onClick:$},{default:x(()=>[E(W(at)),b[10]||(b[10]=O(" Copy Debug Info "))]),_:1,__:[10]}),E(S,{onClick:b[1]||(b[1]=y=>l.$emit("close"))},{default:x(()=>b[11]||(b[11]=[O("Close")])),_:1,__:[11]})])])]),_:1},8,["visible"])}}}),In=re(wn,[["__scopeId","data-v-726379cc"]]),Rn={class:"trial-detail-view"},En={key:0,class:"detail-content"},Vn={class:"detail-section"},An={class:"detail-grid"},Ln={class:"detail-item"},xn={key:0,class:"detail-item"},Fn={key:1,class:"detail-item"},Dn={class:"detail-item"},Mn={class:"detail-item"},Pn={class:"detail-section"},On={class:"detail-grid"},Un={key:0,class:"detail-item full-width"},Nn={key:1,class:"detail-item full-width"},Wn={class:"detail-item"},zn={class:"detail-item"},Hn={style:{display:"flex","align-items":"center",gap:"8px"}},Bn={key:0,class:"snapshot-badge success"},Gn={key:1,class:"snapshot-badge warning"},jn={class:"detail-item"},qn={key:2,class:"detail-item"},Kn={key:0,class:"detail-section"},Qn={class:"detail-grid"},Jn={class:"detail-item"},Yn={class:"detail-item"},Xn={class:"detail-item"},Zn={class:"detail-section"},el={class:"model-configs"},tl={class:"config-header"},sl=["src","alt"],al={class:"provider-name"},nl={class:"config-details"},ll={class:"config-item"},ol={class:"config-params"},il={class:"param-list"},rl={key:0,class:"config-item"},ul={class:"cost"},dl=ue({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(n){const t=n,s=B(!1),c=P(()=>{const w=t.trial.started||t.trial.created,f=(t.trial.completed||new Date).getTime()-w.getTime(),p=Math.floor(f/(1e3*60*60)),u=Math.floor(f%(1e3*60*60)/(1e3*60));return p>0?`${p}h ${u}m`:`${u}m`}),v=P(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[t.trial.status]||t.trial.status),r=P(()=>{var w;return t.trial.type==="template"&&((w=t.trial.templateConfig)!=null&&w.variables)?Object.keys(t.trial.templateConfig.variables).length:0}),m=P(()=>Math.round(t.trial.progress.total*750)),k=P(()=>t.trial.type==="template"&&t.trial.templateConfig?t.trial.templateConfig.hasSnapshots===!0:!1),$=P(()=>"text"),l=P(()=>1),b=P(()=>t.trial.progress.total/l.value);function I(w){return w?new Date(w).toLocaleString():"N/A"}function g(){var i,f;if((i=t.trial.templateConfig)!=null&&i.templateName)return t.trial.templateConfig.templateName;const w=((f=t.trial.templateConfig)==null?void 0:f.template)||"Unknown Template";return w.length>50?w.substring(0,50)+"...":w}function S(){var w;return((w=t.trial.spreadsheetConfig)==null?void 0:w.datasetId)||"Unknown Dataset"}function h(w){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[w]||w}function y(w){}async function V(){try{ae.info("Migration feature coming soon"),s.value=!1}catch(w){ae.error("Failed to migrate trial"),_.error("Migration error:",w)}}function U(w){var p;const i=w.modelSnapshot;return(p=i==null?void 0:i.capabilities)!=null&&p.inputCostPerToken?`$${((i.capabilities.inputCostPerToken+i.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(w,i)=>{const f=J("a-button");return o(),d("div",Rn,[e("div",{class:"detail-header",onClick:i[0]||(i[0]=p=>w.$emit("toggle-collapse"))},[i[3]||(i[3]=e("h3",null,"Trial Details",-1)),E(W(cs),{class:le(["collapse-icon",{rotated:w.isCollapsed}])},null,8,["class"])]),w.isCollapsed?A("",!0):(o(),d("div",En,[e("div",Vn,[i[9]||(i[9]=e("h4",null,"Basic Information",-1)),e("div",An,[e("div",Ln,[i[4]||(i[4]=e("label",null,"Created:",-1)),e("span",null,C(I(w.trial.created)),1)]),w.trial.started?(o(),d("div",xn,[i[5]||(i[5]=e("label",null,"Started:",-1)),e("span",null,C(I(w.trial.started)),1)])):A("",!0),w.trial.completed?(o(),d("div",Fn,[i[6]||(i[6]=e("label",null,"Completed:",-1)),e("span",null,C(I(w.trial.completed)),1)])):A("",!0),e("div",Dn,[i[7]||(i[7]=e("label",null,"Duration:",-1)),e("span",null,C(c.value),1)]),e("div",Mn,[i[8]||(i[8]=e("label",null,"Status:",-1)),e("span",null,C(w.trial.status)+" - "+C(v.value),1)])])]),e("div",Pn,[i[19]||(i[19]=e("h4",null,"Configuration",-1)),e("div",On,[w.trial.type==="template"?(o(),d("div",Un,[i[10]||(i[10]=e("label",null,"Template:",-1)),e("span",null,C(g()),1)])):A("",!0),w.trial.type==="spreadsheet"?(o(),d("div",Nn,[i[11]||(i[11]=e("label",null,"Dataset:",-1)),e("span",null,C(S()),1)])):A("",!0),e("div",Wn,[i[12]||(i[12]=e("label",null,"Variable Lists:",-1)),e("span",null,C(r.value)+" lists",1)]),e("div",zn,[i[16]||(i[16]=e("label",null,"Data Snapshot:",-1)),e("div",Hn,[k.value?(o(),d("span",Bn,[E(W(kt)),i[13]||(i[13]=O(" Captured "))])):(o(),d("span",Gn,[E(W(Ee)),i[14]||(i[14]=O(" Live Reference "))])),w.trial.type==="template"?(o(),X(f,{key:2,size:"small",type:"link",onClick:i[1]||(i[1]=p=>s.value=!0)},{default:x(()=>[E(W(St)),i[15]||(i[15]=O(" Debug "))]),_:1,__:[15]})):A("",!0)])]),e("div",jn,[i[17]||(i[17]=e("label",null,"Token Estimate:",-1)),e("span",null,"~"+C(m.value)+" tokens",1)]),$.value?(o(),d("div",qn,[i[18]||(i[18]=e("label",null,"Output Type:",-1)),e("span",{class:le(["output-type",`type-${$.value}`])},C($.value),3)])):A("",!0)])]),l.value>1?(o(),d("div",Kn,[i[23]||(i[23]=e("h4",null,"Repeat Configuration",-1)),e("div",Qn,[e("div",Jn,[i[20]||(i[20]=e("label",null,"Times per prompt:",-1)),e("span",null,C(l.value),1)]),e("div",Yn,[i[21]||(i[21]=e("label",null,"Total combinations:",-1)),e("span",null,C(b.value),1)]),e("div",Xn,[i[22]||(i[22]=e("label",null,"Total API calls:",-1)),e("span",null,C(w.trial.progress.total),1)])])])):A("",!0),e("div",Zn,[i[27]||(i[27]=e("h4",null,"Model Configurations",-1)),e("div",el,[(o(!0),d(Z,null,ne(w.trial.configurations,(p,u)=>(o(),d("div",{key:u,class:"model-config-card"},[e("div",tl,[(p.provider,void 0)?(o(),d("img",{key:0,src:(p.provider,void 0),alt:p.provider,class:"provider-logo"},null,8,sl)):A("",!0),e("span",al,C(h(p.provider)),1)]),e("div",nl,[e("div",ll,[i[24]||(i[24]=e("label",null,"Model:",-1)),e("span",null,C(p.modelId),1)]),e("div",ol,[i[25]||(i[25]=e("label",null,"Parameters:",-1)),e("div",il,[(o(!0),d(Z,null,ne(p.parameters,(D,H)=>(o(),d("span",{key:H,class:"param-tag"},C(H)+": "+C(D),1))),128))])]),U(p)?(o(),d("div",rl,[i[26]||(i[26]=e("label",null,"Est. Cost:",-1)),e("span",ul,C(U(p)),1)])):A("",!0)])]))),128))])])])),s.value?(o(),X(In,{key:1,visible:s.value,trial:w.trial,onClose:i[2]||(i[2]=p=>s.value=!1),onMigrate:V},null,8,["visible","trial"])):A("",!0)])}}}),cl=re(dl,[["__scopeId","data-v-a5e15d0c"]]),pl={class:"filter-bar"},fl={class:"search-container"},ml=ue({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns"],setup(n,{emit:t}){const s=n,c=t,v=P(()=>{const l=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return s.showRepeatColumn&&l.splice(2,0,{key:"repeat",label:"Repeat Index"}),l}),r=P(()=>{const l={total:s.apiCalls.length,completed:0,failed:0,running:0,pending:0};return s.apiCalls.forEach(b=>{b.status==="completed"?l.completed++:b.status==="failed"?l.failed++:b.status==="running"?l.running++:b.status==="pending"&&l.pending++}),l});function m(l){var b;return((b=l.modelSnapshot)==null?void 0:b.displayName)||`${l.provider} - ${l.modelId}`}const k=wt(l=>{const b=l.target.value;c("update:searchQuery",b)},300);function $(l){const b=[...s.visibleColumns],I=b.indexOf(l);if(I>-1)b.splice(I,1);else{const g=v.value.map(y=>y.key),S=g.indexOf(l);let h=0;for(let y=0;y<S;y++)b.includes(g[y])&&h++;b.splice(h,0,l)}c("update:visibleColumns",b)}return(l,b)=>{const I=J("a-select-option"),g=J("a-select"),S=J("a-input"),h=J("a-button"),y=J("a-checkbox"),V=J("a-menu-item"),U=J("a-menu"),w=J("a-dropdown");return o(),d("div",pl,[E(g,{value:l.statusFilter,onChange:b[0]||(b[0]=i=>l.$emit("update:statusFilter",i)),placeholder:"Filter by status",style:{width:"150px"}},{default:x(()=>[E(I,{value:"all"},{default:x(()=>[O(" All ("+C(r.value.total)+") ",1)]),_:1}),E(I,{value:"completed"},{default:x(()=>[O(" Completed ("+C(r.value.completed)+") ",1)]),_:1}),E(I,{value:"failed"},{default:x(()=>[O(" Failed ("+C(r.value.failed)+") ",1)]),_:1}),E(I,{value:"running"},{default:x(()=>[O(" Running ("+C(r.value.running)+") ",1)]),_:1}),E(I,{value:"pending"},{default:x(()=>[O(" Pending ("+C(r.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),E(g,{value:l.configFilter,onChange:b[1]||(b[1]=i=>l.$emit("update:configFilter",i)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:x(()=>[E(I,{value:""},{default:x(()=>b[2]||(b[2]=[O("All Configurations")])),_:1,__:[2]}),(o(!0),d(Z,null,ne(l.configurations,(i,f)=>(o(),X(I,{key:f,value:f.toString()},{default:x(()=>[O(C(m(i)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),e("div",fl,[E(S,{value:l.searchQuery,onInput:W(k),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:x(()=>[E(W(yt))]),_:1},8,["value","onInput"])]),E(w,null,{overlay:x(()=>[E(U,null,{default:x(()=>[(o(!0),d(Z,null,ne(v.value,i=>(o(),X(V,{key:i.key},{default:x(()=>[E(y,{checked:l.visibleColumns.includes(i.key),disabled:i.key==="status",onChange:f=>$(i.key)},{default:x(()=>[O(C(i.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:x(()=>[E(h,null,{default:x(()=>[E(W(ps)),b[3]||(b[3]=O(" Columns "))]),_:1,__:[3]})]),_:1})])}}}),vl=re(ml,[["__scopeId","data-v-1fdfdfd1"]]),gl={class:"modal-content"},hl={class:"section"},_l={class:"info-grid"},yl={class:"info-item"},bl={class:"monospace"},Tl={class:"info-item"},$l={class:"info-item"},Cl={key:0,class:"info-item"},kl={class:"info-item"},Sl={key:1,class:"info-item"},wl={key:2,class:"info-item"},Il={key:3,class:"info-item"},Rl={key:0,class:"info-row"},El={class:"monospace"},Vl={key:0,class:"section"},Al={class:"variables-list"},Ll={class:"variable-main"},xl={class:"variable-label"},Fl={class:"variable-value"},Dl={key:0,class:"variable-attributes"},Ml={class:"attribute-label"},Pl={class:"attribute-value"},Ol={class:"section"},Ul={class:"content-box prompt-display"},Nl={key:1,class:"section"},Wl={key:0,class:"error-result"},zl={key:1,class:"success-result"},Hl={class:"content-box response-content"},Bl={key:0,class:"parsed-content-section"},Gl={class:"content-box parsed-content"},jl={key:1,class:"refusal-warning"},ql={class:"extraction-config-section"},Kl={class:"config-grid"},Ql={key:0,class:"config-item"},Jl={class:"config-value"},Yl={key:1,class:"config-item"},Xl={class:"config-value pattern"},Zl={key:2,class:"config-item"},eo={class:"config-value"},to={key:3,class:"config-item"},so={class:"config-value"},ao={key:4,class:"config-item no-extraction"},no={key:2,class:"usage-info"},lo={class:"info-grid"},oo={class:"info-item"},io={class:"info-item"},ro={class:"info-item"},uo={key:0,class:"info-item"},co={class:"raw-data-section"},po={class:"raw-data"},fo={key:0},mo={key:1,class:"raw-data"},vo={key:2},go={key:3,class:"raw-data"},ho={class:"modal-footer"},_o=ue({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(n,{emit:t}){const s=n,c=t,v=tt(),r=P(()=>{if(!s.apiCall.completed||!s.apiCall.created)return null;const p=new Date(s.apiCall.created).getTime();return new Date(s.apiCall.completed).getTime()-p}),m=P(()=>{const p=s.trial.configurations[s.apiCall.configurationIndex];return p?`${p.provider} / ${p.modelId}`:null}),k=P(()=>{var Y,T,a;if(!((Y=s.apiCall.result)!=null&&Y.usage))return null;const p=s.trial.configurations[s.apiCall.configurationIndex];if(!p)return null;const u=v.models.value.find(L=>L.provider===p.provider&&L.modelId===p.modelId);if(!((T=u==null?void 0:u.capabilities)!=null&&T.inputCostPerToken)&&!((a=u==null?void 0:u.capabilities)!=null&&a.outputCostPerToken))return null;const D=(s.apiCall.result.usage.prompt_tokens||0)*(u.capabilities.inputCostPerToken||0),H=(s.apiCall.result.usage.completion_tokens||0)*(u.capabilities.outputCostPerToken||0);return D+H}),$=P(()=>{if(!s.apiCall.request)return"No request data";const p=JSON.parse(JSON.stringify(s.apiCall.request));return p.headers&&Object.keys(p.headers).forEach(u=>{(u.toLowerCase().includes("authorization")||u.toLowerCase().includes("api-key")||u.toLowerCase().includes("x-api-key"))&&(p.headers[u]="[REDACTED]")}),p.body&&typeof p.body=="object"&&(p.body.api_key&&(p.body.api_key="[REDACTED]"),p.body.apiKey&&(p.body.apiKey="[REDACTED]")),JSON.stringify(p,null,2)}),l=P(()=>s.trial.type!=="template"||!s.trial.templateConfig?{}:{outputType:s.trial.templateConfig.outputType,extractPattern:s.trial.templateConfig.extractPattern,refusalWords:s.trial.templateConfig.refusalWords,rejectRefusalWords:s.trial.templateConfig.rejectRefusalWords}),b=P(()=>{const p=l.value;return!!(p.outputType||p.extractPattern||p.refusalWords&&p.refusalWords.length>0)}),I=P(()=>s.apiCall.response?JSON.stringify({status:s.apiCall.response.status,headers:s.apiCall.response.headers,body:s.apiCall.response.body,latencyMs:s.apiCall.response.latencyMs},null,2):"No response data available"),g=P(()=>s.apiCall.result?JSON.stringify(s.apiCall.result,null,2):"No processed result available");function S(p){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[p]||"default"}function h(){var u;const p=s.trial.configurations[s.apiCall.configurationIndex];return((u=p==null?void 0:p.modelSnapshot)==null?void 0:u.displayName)||(p==null?void 0:p.modelId)||`Configuration ${s.apiCall.configurationIndex+1}`}function y(p){return(typeof p=="string"?new Date(p):p).toLocaleString()}function V(p){return p<1e3?`${p}ms`:p<6e4?`${(p/1e3).toFixed(1)}s`:`${Math.floor(p/6e4)}m ${(p%6e4/1e3).toFixed(0)}s`}function U(p){return p==null?"null":typeof p=="string"?p:typeof p=="number"||typeof p=="boolean"?String(p):JSON.stringify(p,null,2)}function w(p){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[p]||p}function i(){c("update:visible",!1)}async function f(){const p={id:s.apiCall.id,status:s.apiCall.status,configuration:h(),provider:m.value,variables:s.apiCall.variables,variableAttributes:s.apiCall.variableAttributes,prompt:s.apiCall.prompt,fullApiResponse:s.apiCall.response,processedResult:s.apiCall.result,extractionConfig:l.value,created:s.apiCall.created,completed:s.apiCall.completed,duration:r.value?`${r.value}ms`:null,cost:k.value?`$${k.value.toFixed(4)}`:null},u=JSON.stringify(p,null,2);try{await navigator.clipboard.writeText(u),ae.success("Details copied to clipboard!")}catch(D){_.error("Failed to copy to clipboard",D),ae.error("Failed to copy to clipboard")}}return(p,u)=>{const D=J("a-tag"),H=J("a-alert"),Y=J("a-collapse-panel"),T=J("a-collapse"),a=J("a-button"),L=J("a-modal");return o(),X(L,{open:p.visible,onCancel:u[0]||(u[0]=R=>c("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:x(()=>{var R;return[e("div",gl,[e("div",hl,[u[10]||(u[10]=e("h3",null,"Overview",-1)),e("div",_l,[e("div",yl,[u[1]||(u[1]=e("label",null,"Call ID:",-1)),e("span",bl,C(p.apiCall.id),1)]),e("div",Tl,[u[2]||(u[2]=e("label",null,"Status:",-1)),E(D,{color:S(p.apiCall.status)},{default:x(()=>[O(C(p.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),e("div",$l,[u[3]||(u[3]=e("label",null,"Configuration:",-1)),e("span",null,C(h()),1)]),p.apiCall.repeatIndex!==void 0?(o(),d("div",Cl,[u[4]||(u[4]=e("label",null,"Repeat:",-1)),e("span",null,"#"+C(p.apiCall.repeatIndex+1),1)])):A("",!0),e("div",kl,[u[5]||(u[5]=e("label",null,"Created:",-1)),e("span",null,C(y(p.apiCall.created)),1)]),p.apiCall.completed?(o(),d("div",Sl,[u[6]||(u[6]=e("label",null,"Completed:",-1)),e("span",null,C(y(p.apiCall.completed)),1)])):A("",!0),r.value?(o(),d("div",wl,[u[7]||(u[7]=e("label",null,"Duration:",-1)),e("span",null,C(V(r.value)),1)])):A("",!0),(R=p.apiCall.result)!=null&&R.latency?(o(),d("div",Il,[u[8]||(u[8]=e("label",null,"API Latency:",-1)),e("span",null,C(p.apiCall.result.latency)+"ms",1)])):A("",!0)]),m.value?(o(),d("div",Rl,[u[9]||(u[9]=e("label",null,"Provider/Model:",-1)),e("span",El,C(m.value),1)])):A("",!0)]),p.apiCall.variables&&Object.keys(p.apiCall.variables).length>0?(o(),d("div",Vl,[u[11]||(u[11]=e("h3",null,"Variables",-1)),e("div",Al,[(o(!0),d(Z,null,ne(p.apiCall.variables,(Q,te)=>(o(),d("div",{key:te,class:"variable-group"},[e("div",Ll,[e("label",xl,C(te)+":",1),e("span",Fl,C(Q),1)]),p.apiCall.variableAttributes&&p.apiCall.variableAttributes[te]?(o(),d("div",Dl,[(o(!0),d(Z,null,ne(p.apiCall.variableAttributes[te],(j,oe)=>(o(),d("div",{key:oe,class:"attribute-item"},[e("label",Ml,C(oe)+":",1),e("span",Pl,C(j),1)]))),128))])):A("",!0)]))),128))])])):A("",!0),e("div",Ol,[u[12]||(u[12]=e("h3",null,"Resolved Prompt",-1)),e("div",Ul,C(p.apiCall.prompt),1)]),p.apiCall.result?(o(),d("div",Nl,[u[25]||(u[25]=e("h3",null,"Response",-1)),p.apiCall.status==="failed"&&p.apiCall.result.error?(o(),d("div",Wl,[E(H,{type:"error",message:p.apiCall.result.error,description:p.apiCall.result.errorType?`Error Type: ${w(p.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):p.apiCall.result.content?(o(),d("div",zl,[e("div",Hl,C(p.apiCall.result.content),1),p.apiCall.result.parsedContent!==void 0?(o(),d("div",Bl,[u[13]||(u[13]=e("h4",null,"Extracted Value",-1)),e("div",Gl,C(U(p.apiCall.result.parsedContent)),1)])):A("",!0),p.apiCall.result.refused?(o(),d("div",jl,[E(H,{type:"warning",message:"Response flagged as refusal",description:"This response matched configured refusal patterns","show-icon":""})])):A("",!0),e("div",ql,[u[19]||(u[19]=e("h4",null,"Extraction Configuration",-1)),e("div",Kl,[l.value.outputType?(o(),d("div",Ql,[u[14]||(u[14]=e("label",null,"Output Type:",-1)),e("span",Jl,C(l.value.outputType),1)])):A("",!0),l.value.extractPattern?(o(),d("div",Yl,[u[15]||(u[15]=e("label",null,"Extract Pattern:",-1)),e("span",Xl,C(l.value.extractPattern),1)])):A("",!0),l.value.refusalWords&&l.value.refusalWords.length>0?(o(),d("div",Zl,[u[16]||(u[16]=e("label",null,"Refusal Words:",-1)),e("span",eo,C(l.value.refusalWords.join(", ")),1)])):A("",!0),l.value.rejectRefusalWords!==void 0?(o(),d("div",to,[u[17]||(u[17]=e("label",null,"Reject on Refusal:",-1)),e("span",so,C(l.value.rejectRefusalWords?"Yes":"No"),1)])):A("",!0),b.value?A("",!0):(o(),d("div",ao,u[18]||(u[18]=[e("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),p.apiCall.result.usage?(o(),d("div",no,[u[24]||(u[24]=e("h4",null,"Token Usage",-1)),e("div",lo,[e("div",oo,[u[20]||(u[20]=e("label",null,"Prompt Tokens:",-1)),e("span",null,C(p.apiCall.result.usage.prompt_tokens||0),1)]),e("div",io,[u[21]||(u[21]=e("label",null,"Completion Tokens:",-1)),e("span",null,C(p.apiCall.result.usage.completion_tokens||0),1)]),e("div",ro,[u[22]||(u[22]=e("label",null,"Total Tokens:",-1)),e("span",null,C(p.apiCall.result.usage.total_tokens||0),1)]),k.value?(o(),d("div",uo,[u[23]||(u[23]=e("label",null,"Cost:",-1)),e("span",null,"$"+C(k.value.toFixed(4)),1)])):A("",!0)])])):A("",!0)])):A("",!0)])):A("",!0),E(T,{ghost:""},{default:x(()=>[E(Y,{key:"raw",header:"Raw Data"},{default:x(()=>[e("div",co,[u[26]||(u[26]=e("h4",null,"HTTP Request",-1)),e("pre",po,C($.value),1),p.apiCall.response?(o(),d("h4",fo,"Full API Response")):A("",!0),p.apiCall.response?(o(),d("pre",mo,C(I.value),1)):A("",!0),p.apiCall.result?(o(),d("h4",vo,"Processed Result")):A("",!0),p.apiCall.result?(o(),d("pre",go,C(g.value),1)):A("",!0)])]),_:1})]),_:1})]),e("div",ho,[E(a,{onClick:i,size:"large"},{default:x(()=>u[27]||(u[27]=[O(" Close ")])),_:1,__:[27]}),E(a,{type:"primary",onClick:f,size:"large"},{default:x(()=>[E(W(at)),u[28]||(u[28]=O(" Copy Details "))]),_:1,__:[28]})])]}),_:1},8,["open"])}}}),yo=re(_o,[["__scopeId","data-v-bd0d6ad2"]]);class bo{constructor(){ve(this,"apiCalls",De([]));ve(this,"currentTrialId",De(null));ve(this,"executionProgress",De(null));ve(this,"isStreaming",De(!1));ve(this,"progress",P(()=>{var b,I;const t=performance.now(),s=this.apiCalls.value;if(s.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let c=0,v=0,r=0,m=0,k=0;_.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Computing progress from ${s.length} calls in store`);for(const g of s)switch(g.status){case"completed":c++;break;case"failed":v++,(I=(b=g.result)==null?void 0:b.error)!=null&&I.includes("network");break;case"cancelled":r++;break;case"pending":m++;break;case"running":k++;break}const $=performance.now(),l={trialId:this.currentTrialId.value||"",total:s.length,completed:c,failed:v,cancelled:r,pending:m,running:k,lastUpdated:new Date};return _.info(`V4_STORE_PROGRESS: Computed in ${($-t).toFixed(1)}ms - ${c}/${s.length} completed, ${k} running, ${m} pending`),_.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Final result - completed: ${c}, failed: ${v}, running: ${k}, pending: ${m}, total: ${s.length}`),l}));ve(this,"pivotData",P(()=>{const t=performance.now(),s=this.apiCalls.value,c={rows:[],columns:[],cells:new Map};if(s.length===0)return c;const v=new Set,r=new Set;for(const k of s){if(k.status!=="completed")continue;const $=`Config ${k.configurationIndex}`;v.add($);const l=Object.keys(k.variables||{}),b=l.length>0?String(k.variables[l[0]]):"default";r.add(b),c.cells.has($)||c.cells.set($,new Map);const I=c.cells.get($);I.has(b)||I.set(b,[]),I.get(b).push(k)}c.rows=Array.from(v).sort(),c.columns=Array.from(r).sort();const m=performance.now();return _.info(`V4_TRIAL_SWITCH: Store pivotData computed for ${s.length} calls in ${(m-t).toFixed(1)}ms`),c}));ve(this,"stats",P(()=>{var I;const t=performance.now(),s=this.apiCalls.value,c=s.length;if(c===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let v=0,r=0,m=0,k=0,$=0,l=0;for(const g of s)switch(g.status){case"completed":v++,(I=g.response)!=null&&I.latencyMs&&($+=g.response.latencyMs,l++);break;case"failed":r++;break;case"pending":m++;break;case"running":k++;break}const b=performance.now();return _.info(`V4_TRIAL_SWITCH: Store stats computed for ${s.length} calls in ${(b-t).toFixed(1)}ms`),{total:c,completed:v,failed:r,pending:m,running:k,avgLatency:l>0?$/l:0,errorRate:c>0?r/c*100:0}}))}updateApiCalls(t){for(const s of t)switch(s.status){}this.apiCalls.value=Object.freeze(t)}updateProgress(t){_.info("STORE_V4: Updating progress:",t.type),this.executionProgress.value=t}setStreaming(t){_.info(`STORE_V4: Set streaming: ${t}`),this.isStreaming.value=t}setCurrentTrial(t){_.info(`STORE_V4: Set current trial: ${t}`),this.currentTrialId.value=t,t||this.clear()}clear(){_.info("STORE_V4: Clearing store data"),this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(t){_.info(`STORE_V4: Refreshing data from database for trial ${t}`);try{const s=await Ke.apiCalls.where("trialId").equals(t).toArray();_.info(`STORE_V4: Loaded ${s.length} calls from database`),s.sort((c,v)=>{const r=$=>{switch($){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},m=r(c.status),k=r(v.status);return m!==k?m-k:c.order-v.order}),this.updateApiCalls(s),this.setCurrentTrial(t),_.info("STORE_V4: Refresh complete - store updated with fresh data")}catch(s){throw _.error("STORE_V4: Failed to refresh from database:",s),s}}}let Oe=null;function He(){return Oe||(Oe=new bo,_.info("STORE_V4: Created singleton store instance")),Oe}typeof window<"u"&&(window.__trialDataStoreV4=()=>Oe);const To={class:"trial-results-table"},$o={class:"table-container"},Co={class:"results-table"},ko={key:0,class:"col-status"},So={key:1,class:"col-configuration"},wo={key:2,class:"col-repeat"},Io={key:3,class:"col-variables"},Ro={key:4,class:"col-response"},Eo={key:5,class:"col-parsed"},Vo={key:6,class:"col-length"},Ao={key:7,class:"col-latency"},Lo={class:"results-table"},xo=["onClick"],Fo={key:0,class:"col-status"},Do={class:"status-cell"},Mo={class:"status-time"},Po={key:1,class:"col-configuration"},Oo={key:2,class:"col-repeat"},Uo={key:3,class:"col-variables"},No={class:"variable-tags"},Wo={key:0,class:"var-item"},zo={key:1,class:"var-item"},Ho={key:2},Bo={key:3},Go={key:4,class:"col-response"},jo={class:"response-content"},qo={key:5,class:"col-parsed"},Ko={key:6,class:"col-length"},Qo={key:7,class:"col-latency"},Jo={key:1,class:"results-table"},Yo={key:0,class:"col-status"},Xo={key:1,class:"col-configuration"},Zo={key:2,class:"col-repeat"},ei={key:3,class:"col-variables"},ti={key:4,class:"col-response"},si={key:5,class:"col-parsed"},ai={key:6,class:"col-length"},ni={key:7,class:"col-latency"},li=["onClick"],oi={key:0,class:"col-status"},ii={class:"status-cell"},ri={class:"status-time"},ui={key:1,class:"col-configuration"},di={key:2,class:"col-repeat"},ci={key:3,class:"col-variables"},pi={class:"variable-tags"},fi={key:0,class:"var-item"},mi={key:1,class:"var-item"},vi={key:2},gi={key:3},hi={key:4,class:"col-response"},_i={class:"response-content"},yi={key:5,class:"col-parsed"},bi={key:6,class:"col-length"},Ti={key:7,class:"col-latency"},$i={key:0},Ci=["colspan"],ki={key:0},Si={key:1},ct="trial-results-visible-columns",wi=ue({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(n){const t=n,s=B("all"),c=B([]),v=B(""),r=B(["status","configuration","variables","response","parsedResponse","length","latency"]),m=B(null),k=He(),$=P(()=>{var T;return((T=k.apiCalls)==null?void 0:T.value)||[]}),l=P(()=>t.apiCalls||$.value);ce(l,(T,a)=>{const L=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${(a==null?void 0:a.length)||0} to ${T.length} calls`),setTimeout(()=>{const R=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(R-L).toFixed(1)}ms`)},0)});const b=T=>{if(!v.value)return T;const a=v.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),L=new RegExp(`(${a})`,"gi");return T.replace(L,"<mark>$1</mark>")},I=P(()=>{const T=performance.now();let a=[...l.value];if(s.value!=="all"&&(a=a.filter(R=>R.status===s.value)),c.value.length>0&&(a=a.filter(R=>c.value.includes(String(R.configurationIndex)))),v.value){const R=v.value.toLowerCase();a=a.filter(Q=>{var te,j,oe,F,me;return!!((te=Q.prompt)!=null&&te.toLowerCase().includes(R)||(oe=(j=Q.result)==null?void 0:j.content)!=null&&oe.toLowerCase().includes(R)||(me=(F=Q.result)==null?void 0:F.error)!=null&&me.toLowerCase().includes(R))})}const L=performance.now();return _.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${a.length} calls in ${(L-T).toFixed(1)}ms`),a});ce(I,(T,a)=>{const L=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${(a==null?void 0:a.length)||0} to ${T.length} items`),setTimeout(()=>{const R=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(R-L).toFixed(1)}ms`)},0)});const g=P(()=>l.value),S=P(()=>l.value.length),h=P(()=>t.trial.configurations.some(T=>T.repeatCount>1)),y=P(()=>60);function V(T){}function U(T){var L;const a=t.trial.configurations[T];return a?((L=a.modelSnapshot)==null?void 0:L.displayName)||`${a.modelId}`:`Config ${T+1}`}function w(T){var a,L,R,Q,te;return T.status==="pending"?"Waiting...":T.status==="running"?"Processing...":T.status==="failed"?((a=T.result)==null?void 0:a.errorType)==="refusal_detected"||((L=T.result)==null?void 0:L.error)==="REFUSED"?((R=T.result)==null?void 0:R.content)||"REFUSED":((Q=T.result)==null?void 0:Q.error)||"Error occurred":((te=T.result)==null?void 0:te.content)||""}function i(T){if(!T.result)return"";if(T.result.parsedContent!==void 0){const a=T.result.parsedContent;return a===null?"null":typeof a=="string"?a:typeof a=="number"||typeof a=="boolean"?String(a):JSON.stringify(a)}return""}function f(T){var R;const a=((R=T.result)==null?void 0:R.content)||"";if(!a)return"";const L=a.length;return L>1e3?`${(L/1e3).toFixed(1)}k chars`:`${L} chars`}function p(T){return T?T<1e3?`${T}ms`:`${(T/1e3).toFixed(1)}s`:""}function u(T){let a;switch(T.status){case"completed":case"failed":a=T.completed;break;case"running":a=T.started;break;case"pending":case"cancelled":a=T.created;break}if(!a)return"";const L=new Date(a),R=L.getHours().toString().padStart(2,"0"),Q=L.getMinutes().toString().padStart(2,"0"),te=L.getSeconds().toString().padStart(2,"0");return`  ${R}:${Q}:${te}`}function D(T){return T?T<1e3?"latency-fast":T<5e3?"latency-medium":"latency-slow":""}function H(T){return b(T)}function Y(T){m.value=T}return ce(r,T=>{localStorage.setItem(ct,JSON.stringify(T))},{deep:!0}),ge(()=>{const T=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${l.value.length} calls`);const a=localStorage.getItem(ct);if(a)try{r.value=JSON.parse(a)}catch{}Ce(()=>{const L=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(L-T).toFixed(1)}ms`),setTimeout(()=>{const R=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(R-T).toFixed(1)}ms`)},100)}),setTimeout(()=>{const L=performance.now();_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(L-T).toFixed(1)}ms`)},0)}),Ve(()=>{_.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${l.value.length} calls`)}),Ae(()=>{_.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),ye(()=>{_.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(T,a)=>{const L=mt("dompurify-html");return o(),d("div",To,[E(vl,{"status-filter":s.value,"onUpdate:statusFilter":a[0]||(a[0]=R=>s.value=R),"config-filter":c.value,"onUpdate:configFilter":a[1]||(a[1]=R=>c.value=R),"search-query":v.value,"onUpdate:searchQuery":a[2]||(a[2]=R=>v.value=R),"visible-columns":r.value,"onUpdate:visibleColumns":a[3]||(a[3]=R=>r.value=R),configurations:T.trial.configurations,"api-calls":g.value,"show-repeat-column":h.value},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),e("div",$o,[S.value>100?(o(),X(W(ze),{key:0,class:"results-scroller",items:I.value,"item-size":y.value,"key-field":"id",buffer:10,onVisibleRange:V},{before:x(()=>[e("table",Co,[e("thead",null,[e("tr",null,[r.value.includes("status")?(o(),d("th",ko,"Status")):A("",!0),r.value.includes("configuration")?(o(),d("th",So,"Configuration")):A("",!0),r.value.includes("repeat")&&h.value?(o(),d("th",wo,"Repeat")):A("",!0),r.value.includes("variables")?(o(),d("th",Io,"Variables")):A("",!0),r.value.includes("response")?(o(),d("th",Ro,"Response")):A("",!0),r.value.includes("parsedResponse")?(o(),d("th",Eo,"Parsed Response")):A("",!0),r.value.includes("length")?(o(),d("th",Vo,"Length")):A("",!0),r.value.includes("latency")?(o(),d("th",Ao,"Latency")):A("",!0)])])])]),default:x(({item:R})=>{var Q,te;return[e("table",Lo,[e("tbody",null,[e("tr",{class:le(["result-row",`status-${R.status}`]),onClick:j=>Y(R)},[r.value.includes("status")?(o(),d("td",Fo,[e("div",Do,[e("span",{class:le(["status-tag",`status-${R.status}`])},C(R.status.toUpperCase()),3),e("span",Mo,C(u(R)),1)])])):A("",!0),r.value.includes("configuration")?(o(),d("td",Po,C(U(R.configurationIndex)),1)):A("",!0),r.value.includes("repeat")&&h.value?(o(),d("td",Oo," #"+C((R.repeatIndex||0)+1),1)):A("",!0),r.value.includes("variables")?(o(),d("td",Uo,[e("div",No,[(o(!0),d(Z,null,ne(Object.entries(R.variables),([j,oe],F)=>(o(),d(Z,{key:j},[a[6]||(a[6]=e("span",{class:"var-bullet"},"• ",-1)),Object.keys(R.variables).length<=2?(o(),d("span",Wo,C(j)+": "+C(oe),1)):(o(),d("span",zo,C(oe),1)),Object.keys(R.variables).length===2&&F===0?(o(),d("span",Ho,a[5]||(a[5]=[e("br",null,null,-1)]))):F<Object.keys(R.variables).length-1?(o(),d("span",Bo,C("  "))):A("",!0)],64))),128))])])):A("",!0),r.value.includes("response")?(o(),d("td",Go,[Se(e("div",jo,null,512),[[L,H(w(R)),"apiResponse"]])])):A("",!0),r.value.includes("parsedResponse")?(o(),d("td",qo,C(i(R)),1)):A("",!0),r.value.includes("length")?(o(),d("td",Ko,C(f(R)),1)):A("",!0),r.value.includes("latency")?(o(),d("td",Qo,[e("span",{class:le(D((Q=R.response)==null?void 0:Q.latencyMs))},C(p((te=R.response)==null?void 0:te.latencyMs)),3)])):A("",!0)],10,xo)])])]}),_:1},8,["items","item-size"])):(o(),d("table",Jo,[e("thead",null,[e("tr",null,[r.value.includes("status")?(o(),d("th",Yo,"Status")):A("",!0),r.value.includes("configuration")?(o(),d("th",Xo,"Configuration")):A("",!0),r.value.includes("repeat")&&h.value?(o(),d("th",Zo,"Repeat")):A("",!0),r.value.includes("variables")?(o(),d("th",ei,"Variables")):A("",!0),r.value.includes("response")?(o(),d("th",ti,"Response")):A("",!0),r.value.includes("parsedResponse")?(o(),d("th",si,"Parsed Response")):A("",!0),r.value.includes("length")?(o(),d("th",ai,"Length")):A("",!0),r.value.includes("latency")?(o(),d("th",ni,"Latency")):A("",!0)])]),e("tbody",null,[(o(!0),d(Z,null,ne(I.value,R=>{var Q,te;return o(),d("tr",{key:R.id,class:le(["result-row",`status-${R.status}`]),onClick:j=>Y(R)},[r.value.includes("status")?(o(),d("td",oi,[e("div",ii,[e("span",{class:le(["status-tag",`status-${R.status}`])},C(R.status.toUpperCase()),3),e("span",ri,C(u(R)),1)])])):A("",!0),r.value.includes("configuration")?(o(),d("td",ui,C(U(R.configurationIndex)),1)):A("",!0),r.value.includes("repeat")&&h.value?(o(),d("td",di," #"+C((R.repeatIndex||0)+1),1)):A("",!0),r.value.includes("variables")?(o(),d("td",ci,[e("div",pi,[(o(!0),d(Z,null,ne(R.variables,(j,oe,F)=>(o(),d(Z,{key:oe},[a[8]||(a[8]=e("span",{class:"var-bullet"},"• ",-1)),Object.keys(R.variables).length<=2?(o(),d("span",fi,C(oe)+": "+C(j),1)):(o(),d("span",mi,C(j),1)),Object.keys(R.variables).length===2&&F===0?(o(),d("span",vi,a[7]||(a[7]=[e("br",null,null,-1)]))):F<Object.keys(R.variables).length-1?(o(),d("span",gi,C("  "))):A("",!0)],64))),128))])])):A("",!0),r.value.includes("response")?(o(),d("td",hi,[Se(e("div",_i,null,512),[[L,H(w(R)),"apiResponse"]])])):A("",!0),r.value.includes("parsedResponse")?(o(),d("td",yi,C(i(R)),1)):A("",!0),r.value.includes("length")?(o(),d("td",bi,C(f(R)),1)):A("",!0),r.value.includes("latency")?(o(),d("td",Ti,[e("span",{class:le(D((Q=R.response)==null?void 0:Q.latencyMs))},C(p((te=R.response)==null?void 0:te.latencyMs)),3)])):A("",!0)],10,li)}),128)),I.value.length===0?(o(),d("tr",$i,[e("td",{colspan:r.value.length,class:"empty-state"},[$.value.length===0?(o(),d("div",ki," No API calls yet. Start the trial to begin execution. ")):(o(),d("div",Si," No results match your filters. "))],8,Ci)])):A("",!0)])]))]),m.value?(o(),X(yo,{key:0,visible:!!m.value,"api-call":m.value,trial:T.trial,"onUpdate:visible":a[4]||(a[4]=R=>m.value=null)},null,8,["visible","api-call","trial"])):A("",!0)])}}}),Ii=re(wi,[["__scopeId","data-v-95899931"]]),Ri={class:"trial-analysis-view"},Ei=ue({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(n){const t=n;return ge(()=>{const s=performance.now();_.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${t.trial.id}`),Ce(()=>{const c=performance.now();_.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(c-s).toFixed(1)}ms`)}),setTimeout(()=>{const c=performance.now();_.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(c-s).toFixed(1)}ms`)},0)}),Ve(()=>{_.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${t.trial.id}`)}),Ae(()=>{_.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${t.trial.id}`)}),ye(()=>{_.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${t.trial.id}`)}),(s,c)=>(o(),d("div",Ri,[E(Ii,{trial:s.trial,progress:s.progress,"is-executing":s.isExecuting,"api-calls":s.apiCalls,"is-streaming":s.isStreaming,"is-loading":s.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),Vi=re(Ei,[["__scopeId","data-v-602f5d5a"]]);function Ai(n,t){const s=new Set,c=new Set,v=new Set;n.forEach(b=>{b.variables&&Object.keys(b.variables).forEach(I=>s.add(I)),b.variableAttributes&&Object.values(b.variableAttributes).forEach(I=>{I&&Object.keys(I).forEach(g=>c.add(g))})});const r=Array.from(s).sort(),m=Array.from(c).sort(),k=Array.from(v).sort(),$=[],l=["success","refused","parsed_response",...$,...k];return{categorical:[...r,...m,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...$].sort(),extracted:l}}function Re(n,t,s){var c,v,r,m,k,$,l,b,I,g,S,h,y,V,U,w,i,f,p,u,D;switch(t){case"model":return s&&n.configurationIndex<s.configurations.length&&s.configurations[n.configurationIndex].modelId||"Unknown";case"status":return n.status;case"response_time":return((c=n.response)==null?void 0:c.latencyMs)||0;case"total_tokens":if((r=(v=n.response)==null?void 0:v.body)!=null&&r.usage){const H=n.response.body.usage;return H.total_tokens||H.prompt_tokens+H.completion_tokens||0}return 0;case"prompt_tokens":return(($=(k=(m=n.response)==null?void 0:m.body)==null?void 0:k.usage)==null?void 0:$.prompt_tokens)||((I=(b=(l=n.response)==null?void 0:l.body)==null?void 0:b.usage)==null?void 0:I.input_tokens)||0;case"completion_tokens":return((h=(S=(g=n.response)==null?void 0:g.body)==null?void 0:S.usage)==null?void 0:h.completion_tokens)||((U=(V=(y=n.response)==null?void 0:y.body)==null?void 0:V.usage)==null?void 0:U.output_tokens)||0;case"error_type":return((w=n.result)==null?void 0:w.errorType)||(((i=n.result)==null?void 0:i.success)===!1?"api_error":"success");case"success":return(f=n.result)!=null&&f.success?1:0;case"refused":return(p=n.result)!=null&&p.refused?1:0;case"parsed_response":if(((u=n.result)==null?void 0:u.parsedContent)!==void 0){const H=n.result.parsedContent;return typeof H=="object"?JSON.stringify(H):H}return null}if(((D=n.variables)==null?void 0:D[t])!==void 0)return n.variables[t];if(n.variableAttributes)for(const H of Object.keys(n.variableAttributes)){const Y=n.variableAttributes[H];if(Y&&Y[t]!==void 0)return Y[t]}return null}const Le={count:{label:"Count",calculate:n=>n.length,format:n=>n.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:n=>{const t=n.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?t.reduce((s,c)=>s+c,0):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},mean:{label:"Mean",calculate:n=>{const t=n.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?t.reduce((s,c)=>s+c,0)/t.length:null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},median:{label:"Median",calculate:n=>{const t=n.map(v=>typeof v=="number"?v:null).filter(v=>v!==null);if(t.length===0)return null;const s=[...t].sort((v,r)=>v-r),c=Math.floor(s.length/2);return s.length%2===0?(s[c-1]+s[c])/2:s[c]},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},mode:{label:"Mode",calculate:n=>{if(n.length===0)return null;const t=new Map;n.forEach(v=>t.set(v,(t.get(v)||0)+1));let s=0,c=null;return t.forEach((v,r)=>{v>s&&(s=v,c=r)}),{value:c,count:s,total:n.length}},format:n=>n?`${n.value} (${n.count}/${n.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:n=>{const t=n.map(v=>typeof v=="number"?v:null).filter(v=>v!==null);if(t.length<=1)return null;const s=t.reduce((v,r)=>v+r,0)/t.length;return t.reduce((v,r)=>v+Math.pow(r-s,2),0)/(t.length-1)},format:n=>(n==null?void 0:n.toFixed(3))||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:n=>{const t=Le.variance.calculate(n);return t!==null?Math.sqrt(t):null},format:n=>(n==null?void 0:n.toFixed(3))||"-",needsNumeric:!0},min:{label:"Min",calculate:n=>{const t=n.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?Math.min(...t):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},max:{label:"Max",calculate:n=>{const t=n.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?Math.max(...t):null},format:n=>(n==null?void 0:n.toFixed(2))||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(n,t)=>{const s=t.filter(c=>{var v;return(v=c.result)==null?void 0:v.success}).length;return t.length>0?s/t.length:0},format:n=>`${Math.round(n*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(n,t)=>{const s=t.filter(c=>{var v;return(v=c.result)==null?void 0:v.refused}).length;return t.length>0?s/t.length:0},format:n=>`${Math.round(n*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(n,t)=>{const s=t.filter(c=>{var v;return(v=c.response)==null?void 0:v.latencyMs}).map(c=>c.response.latencyMs);return s.length>0?s.reduce((c,v)=>c+v,0)/s.length:null},format:n=>n?`${Math.round(n)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function pt(n,t,s){const c=new Map,v=new Set,r=new Set;n.forEach(h=>{const y=String(Re(h,t.rowField,s)||"Unknown"),V=String(Re(h,t.columnField,s)||"Unknown");v.add(y),r.add(V),c.has(y)||c.set(y,new Map),c.get(y).has(V)||c.get(y).set(V,[]),c.get(y).get(V).push(h)});const m=h=>h.every(V=>!isNaN(Number(V))&&V.trim()!=="")?h.sort((V,U)=>Number(V)-Number(U)):h.sort(),k=(h,y)=>(s&&(s.type,s.type),m(h)),$=t.rowSort==="original"?k(Array.from(v),t.rowField):m(Array.from(v)),l=t.columnSort==="original"?k(Array.from(r),t.columnField):m(Array.from(r)),b=Le[t.aggregation];function I(h){const y=h.map(i=>Re(i,t.valueField,s));if(!b||typeof b.calculate!="function")return _.error("Invalid aggregation function:",t.aggregation,b),{value:null,count:h.length,apiCalls:h,rawValues:y,error:"Invalid aggregation function"};const V={nonNumeric:0,nullUndefined:0};return b.needsNumeric&&(V.nonNumeric=y.filter(i=>typeof i!="number").length),V.nullUndefined=y.filter(i=>i==null).length,{value:b.usesApiCalls?b.calculate(y,h):b.calculate(y),count:h.length,apiCalls:h,rawValues:y,excludedCounts:V}}const g=$.map(h=>{const y=[],V=[];return l.forEach(U=>{var i;const w=((i=c.get(h))==null?void 0:i.get(U))||[];y.push(w.length>0?I(w):null),V.push(...w)}),{label:h,cells:y,total:I(V)}}),S=l.map(h=>{const y=[];return $.forEach(V=>{var w;const U=((w=c.get(V))==null?void 0:w.get(h))||[];y.push(...U)}),I(y)});return{rows:g,columns:l,totals:S,grandTotal:I(n)}}function be(n,t){return!n||n.value===null?"-":Le[t].format(n.value)}function Li(n){if(!n||Object.keys(n).length===0)return"";const t=[];return n.temperature!==void 0&&t.push(`T:${n.temperature}`),n.max_tokens!==void 0?t.push(`${n.max_tokens}t`):n.maxTokens!==void 0?t.push(`${n.maxTokens}t`):n.num_predict!==void 0&&t.push(`${n.num_predict}t`),n.top_p!==void 0&&t.push(`p:${n.top_p}`),n.top_k!==void 0&&t.push(`k:${n.top_k}`),t.length>0?`(${t.join(", ")})`:""}function xi(n,t,s,c=B({}),v={}){const{debounceMs:r=100}=v,m=B({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),k=B({categorical:[],numeric:[],extracted:[]}),$=B(!1),l=B(0),b=P(()=>{const h=c.value;return Object.values(h).some(V=>V!=="")?n.value.filter(V=>{var U;if(h.model&&h.model!==""){if(!s.value||V.configurationIndex>=s.value.configurations.length)return!1;const w=s.value.configurations[V.configurationIndex],i=w.modelId||"Unknown",f=Li(w.parameters);if((f?`${i} ${f}`:i)!==h.model)return!1}if(h.status&&h.status!==""&&V.status!==h.status)return!1;for(const[w,i]of Object.entries(h))if(i&&i!==""&&w!=="model"&&w!=="status"&&((U=V.variables)==null?void 0:U[w])!==i)return!1;return!0}):n.value}),I=je(()=>{if(b.value.length===0){m.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}$.value=!0;const h=performance.now();try{m.value=pt(b.value,t.value,s.value);const y=performance.now()-h;l.value=y,_.debug("Pivot data computed (config change)",{apiCallCount:b.value.length,computeTimeMs:y,rowCount:m.value.rows.length,columnCount:m.value.columns.length})}catch(y){_.error("Error computing pivot data",y)}finally{$.value=!1}},r),g=je(()=>{if(b.value.length===0){m.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}$.value=!0;const h=performance.now();try{m.value=pt(b.value,t.value,s.value);const y=performance.now()-h;l.value=y,_.debug("Pivot data computed (stream update)",{apiCallCount:b.value.length,computeTimeMs:y,rowCount:m.value.rows.length,columnCount:m.value.columns.length})}catch(y){_.error("Error computing pivot data",y)}finally{$.value=!1}},200),S=je(()=>{k.value=Ai(n.value,s.value)},200);return ce([t],()=>{_.info("PIVOT_DEBUG: Config changed, recomputing pivot"),I()},{deep:!0}),ce(b,(h,y)=>{const V=(y==null?void 0:y.length)||0,U=h.length;_.info(`PIVOT_DEBUG: filteredApiCalls changed from ${V} to ${U}`),(V!==U||U>0)&&g()},{immediate:!0}),ce([n,s],()=>{_.info(`PIVOT_DEBUG: apiCalls (${n.value.length}) or trial changed, updating fields`),S()},{immediate:!0}),S(),{pivotData:P(()=>m.value),availableFields:P(()=>k.value),isComputing:P(()=>$.value),lastComputeTime:P(()=>l.value),formatCellValue:be,extractFieldValue:Re,aggregationFunctions:Le}}const Fi={class:"pivot-config-v3"},Di={class:"config-row"},Mi={class:"config-group"},Pi=["value","aria-label"],Oi={label:"Categorical"},Ui=["value"],Ni={class:"config-group sort-group"},Wi=["value","aria-label"],zi={class:"config-group"},Hi=["value","aria-label"],Bi={label:"Categorical"},Gi=["value"],ji={class:"config-group sort-group"},qi=["value","aria-label"],Ki={class:"config-group"},Qi=["value","aria-label"],Ji={label:"Extracted Values"},Yi=["value"],Xi={label:"Numeric Fields"},Zi=["value"],er={class:"config-group"},tr=["value","aria-label"],sr=ue({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(n,{emit:t}){const s=t;function c(r,m){s("update-config",r,m)}function v(r){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[r]||r.replace(/_/g," ").replace(/\b\w/g,k=>k.toUpperCase())}return(r,m)=>(o(),d("div",Fi,[e("div",Di,[e("div",Mi,[m[6]||(m[6]=e("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),e("select",{id:"pivot-row-field",value:r.config.rowField,"aria-label":"Group rows by "+v(r.config.rowField),onChange:m[0]||(m[0]=k=>c("rowField",k.target.value))},[e("optgroup",Oi,[(o(!0),d(Z,null,ne(r.availableFields.categorical,k=>(o(),d("option",{key:k,value:k},C(v(k)),9,Ui))),128))])],40,Pi)]),e("div",Ni,[m[8]||(m[8]=e("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),e("select",{id:"pivot-row-sort",value:r.config.rowSort||"original","aria-label":"Sort rows by "+(r.config.rowSort||"original")+" order",onChange:m[1]||(m[1]=k=>c("rowSort",k.target.value))},m[7]||(m[7]=[e("option",{value:"original"},"Original",-1),e("option",{value:"alpha"},"Alphabetical",-1)]),40,Wi)]),e("div",zi,[m[9]||(m[9]=e("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),e("select",{id:"pivot-column-field",value:r.config.columnField,"aria-label":"Group columns by "+v(r.config.columnField),onChange:m[2]||(m[2]=k=>c("columnField",k.target.value))},[e("optgroup",Bi,[(o(!0),d(Z,null,ne(r.availableFields.categorical,k=>(o(),d("option",{key:k,value:k},C(v(k)),9,Gi))),128))])],40,Hi)]),e("div",ji,[m[11]||(m[11]=e("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),e("select",{id:"pivot-column-sort",value:r.config.columnSort||"original","aria-label":"Sort columns by "+(r.config.columnSort||"original")+" order",onChange:m[3]||(m[3]=k=>c("columnSort",k.target.value))},m[10]||(m[10]=[e("option",{value:"original"},"Original",-1),e("option",{value:"alpha"},"Alphabetical",-1)]),40,qi)]),e("div",Ki,[m[12]||(m[12]=e("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),e("select",{id:"pivot-value-field",value:r.config.valueField,"aria-label":"Aggregate "+r.config.valueField+" values",onChange:m[4]||(m[4]=k=>c("valueField",k.target.value))},[e("optgroup",Ji,[(o(!0),d(Z,null,ne(r.availableFields.extracted,k=>(o(),d("option",{key:k,value:k},C(k),9,Yi))),128))]),e("optgroup",Xi,[(o(!0),d(Z,null,ne(r.availableFields.numeric,k=>(o(),d("option",{key:k,value:k},C(v(k)),9,Zi))),128))])],40,Qi)]),e("div",er,[m[14]||(m[14]=e("label",{for:"pivot-aggregation"},"Aggregation:",-1)),e("select",{id:"pivot-aggregation",value:r.config.aggregation,"aria-label":"Aggregation method: "+r.config.aggregation,onChange:m[5]||(m[5]=k=>c("aggregation",k.target.value))},m[13]||(m[13]=[vt('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,tr)])])]))}}),ar=re(sr,[["__scopeId","data-v-0d3a0d50"]]),nr={class:"heatmap-controls-v3"},lr={class:"color-scale-selector"},or=["value","aria-label"],ir={class:"gradient-mode-selector"},rr={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},ur=["aria-pressed"],dr=["aria-pressed"],cr=["aria-pressed"],pr=["title","aria-label"],fr=ue({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(n,{emit:t}){const s=t;function c(r){const m=r.target.value;s("update-color-scale",m)}function v(r){s("update-gradient-mode",r)}return(r,m)=>(o(),d("div",nr,[e("div",lr,[m[5]||(m[5]=e("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),e("select",{id:"heatmap-color-scale",value:r.selectedColorScale,"aria-label":"Color scale: "+r.selectedColorScale,onChange:c},m[4]||(m[4]=[vt('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,or)]),e("div",ir,[m[6]||(m[6]=e("label",null,"Gradient Mode:",-1)),e("div",rr,[e("button",{type:"button",class:le(["toggle-btn",{active:r.gradientMode==="global"}]),"aria-pressed":r.gradientMode==="global",onClick:m[0]||(m[0]=k=>v("global"))}," Global ",10,ur),e("button",{type:"button",class:le(["toggle-btn",{active:r.gradientMode==="column"}]),"aria-pressed":r.gradientMode==="column",onClick:m[1]||(m[1]=k=>v("column"))}," Per Column ",10,dr),e("button",{type:"button",class:le(["toggle-btn",{active:r.gradientMode==="row"}]),"aria-pressed":r.gradientMode==="row",onClick:m[2]||(m[2]=k=>v("row"))}," Per Row ",10,cr)])]),e("button",{type:"button",class:"fullscreen-btn",title:r.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":r.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:m[3]||(m[3]=k=>r.$emit("toggle-fullscreen"))},C(r.isFullscreen?"⊟":"⊞"),9,pr)]))}}),mr=re(fr,[["__scopeId","data-v-dcb6369b"]]),vr={class:"pivot-filters-v3"},gr={class:"filters-row"},hr={key:0,class:"filter-group"},_r=["value"],yr=["value"],br=["for"],Tr=["id","value","aria-label","onChange"],$r={value:""},Cr=["value"],kr={key:1,class:"filter-group"},Sr=["value"],wr=["value"],Ir=ue({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(n,{emit:t}){const s=n,c=t,v=B({});let r=0;const m=()=>{if(s.apiCalls.length===0){v.value={};return}const g={};s.apiCalls.forEach(h=>{if(s.trial&&h.configurationIndex<s.trial.configurations.length){const y=s.trial.configurations[h.configurationIndex],V=y.modelId||"Unknown",U=l(y.parameters),w=U?`${V} ${U}`:V;g.model||(g.model=new Set),g.model.add(w)}h.status&&(g.status||(g.status=new Set),g.status.add(h.status)),h.variables&&Object.entries(h.variables).forEach(([y,V])=>{V&&String(V).trim()&&(g[y]||(g[y]=new Set),g[y].add(String(V)))})});const S={};Object.entries(g).forEach(([h,y])=>{S[h]=Array.from(y).sort()}),v.value=S};ce(()=>s.apiCalls.length,g=>{(g===0||r===0||g-r>=5)&&(m(),r=g)},{immediate:!0});const k=P(()=>{const{model:g,status:S,...h}=v.value;return h}),$=P(()=>Object.values(s.activeFilters).some(g=>g!==""));function l(g){if(!g||Object.keys(g).length===0)return"";const S=[];return g.temperature!==void 0&&S.push(`T:${g.temperature}`),g.max_tokens!==void 0?S.push(`${g.max_tokens}t`):g.maxTokens!==void 0?S.push(`${g.maxTokens}t`):g.num_predict!==void 0&&S.push(`${g.num_predict}t`),g.top_p!==void 0&&S.push(`p:${g.top_p}`),g.top_k!==void 0&&S.push(`k:${g.top_k}`),S.length>0?`(${S.join(", ")})`:""}function b(g){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[g]||g.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())}function I(g,S){const h={...s.activeFilters};S===""?delete h[g]:h[g]=S,c("update-filters",h)}return(g,S)=>(o(),d("div",vr,[e("div",gr,[v.value.model&&v.value.model.length>1?(o(),d("div",hr,[S[4]||(S[4]=e("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),e("select",{id:"filter-model",value:g.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:S[0]||(S[0]=h=>I("model",h.target.value))},[S[3]||(S[3]=e("option",{value:""},"All Models",-1)),(o(!0),d(Z,null,ne(v.value.model,h=>(o(),d("option",{key:h,value:h},C(h),9,yr))),128))],40,_r)])):A("",!0),(o(!0),d(Z,null,ne(k.value,(h,y)=>(o(),d("div",{key:y,class:"filter-group"},[e("label",{for:`filter-${y}`,class:"filter-label"},C(b(String(y)))+": ",9,br),e("select",{id:`filter-${y}`,value:g.activeFilters[y]||"",class:"filter-select","aria-label":`Filter by ${b(String(y))}`,onChange:V=>I(String(y),V.target.value)},[e("option",$r,"All "+C(b(String(y))),1),(o(!0),d(Z,null,ne(h,V=>(o(),d("option",{key:V,value:V},C(V),9,Cr))),128))],40,Tr)]))),128)),v.value.status&&v.value.status.length>1?(o(),d("div",kr,[S[6]||(S[6]=e("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),e("select",{id:"filter-status",value:g.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:S[1]||(S[1]=h=>I("status",h.target.value))},[S[5]||(S[5]=e("option",{value:""},"All Statuses",-1)),(o(!0),d(Z,null,ne(v.value.status,h=>(o(),d("option",{key:h,value:h},C(h),9,wr))),128))],40,Sr)])):A("",!0),$.value?(o(),d("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:S[2]||(S[2]=h=>g.$emit("clear-filters"))}," Clear Filters ")):A("",!0)])]))}}),Rr=re(Ir,[["__scopeId","data-v-d5848163"]]),Er={class:"collapse-icon"},Vr={class:"options-content"},Ar={class:"controls-row"},Lr={key:0,class:"performance-info"},xr={class:"table-view"},Fr={key:0,class:"empty-state","data-testid":"empty-data-message"},Dr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Mr={key:2,class:"loading-state","data-testid":"computing-state"},Pr={key:3,class:"pivot-table-container"},Or={class:"pivot-table-grid responsive-table",role:"table"},Ur={role:"row"},Nr={class:"corner-cell",role:"columnheader"},Wr={key:0,class:"total-header",role:"columnheader"},zr={class:"row-header",role:"rowheader"},Hr=["data-testid","title","aria-label","role","onClick","onKeydown"],Br={key:0,class:"cell-content"},Gr=["title"],jr={class:"cell-value"},qr={class:"error-message"},Kr={key:1},Qr=ue({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(n,{emit:t}){var oe,F,me,xe,we,Fe;const s=n,c=t,v=B(!1),r=B("viridis"),m=B("global"),k=B(!1),$=B({rowField:((oe=s.config)==null?void 0:oe.rowField)||"",columnField:((F=s.config)==null?void 0:F.columnField)||"",valueField:((me=s.config)==null?void 0:me.valueField)||"",aggregation:((xe=s.config)==null?void 0:xe.aggregation)||"mean",rowSort:((we=s.config)==null?void 0:we.rowSort)||"original",columnSort:((Fe=s.config)==null?void 0:Fe.columnSort)||"original"});ce(()=>s.config,z=>{z&&Object.assign($.value,z)},{deep:!0});const l=B({}),b=He(),I=P(()=>b.apiCalls?b.apiCalls.value||[]:s.apiCalls||[]),g=I,S=P(()=>s.trial),{pivotData:h,availableFields:y,isComputing:V,lastComputeTime:U}=xi(g,$,S,l,{debounceMs:750});ce(h,(z,G)=>{var pe,Ie;const q=performance.now(),K=((pe=z==null?void 0:z.rows)==null?void 0:pe.length)||0,de=((Ie=z==null?void 0:z.columns)==null?void 0:Ie.length)||0;_.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${K}x${de} matrix`),setTimeout(()=>{const Be=performance.now();_.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(Be-q).toFixed(1)}ms`)},0)}),ce(V,z=>{z?_.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${I.value.length} API calls`):_.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${U.value.toFixed(1)}ms`)}),ce(I,(z,G)=>{const q=performance.now();_.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${(G==null?void 0:G.length)||0} to ${z.length} calls`),setTimeout(()=>{const K=performance.now();_.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(K-q).toFixed(1)}ms`)},0)});const w=P(()=>h.value.rows.slice(0,s.maxTableRows)),i=P(()=>Object.values(l.value).some(G=>G!=="")?I.value.filter(G=>{var q;if(l.value.model&&l.value.model!==""){if(!s.trial||G.configurationIndex>=s.trial.configurations.length)return!1;const K=s.trial.configurations[G.configurationIndex],de=K.modelId||"Unknown",pe=D(K.parameters);if((pe?`${de} ${pe}`:de)!==l.value.model)return!1}if(l.value.status&&l.value.status!==""&&G.status!==l.value.status)return!1;for(const[K,de]of Object.entries(l.value))if(de&&de!==""&&K!=="model"&&K!=="status"&&((q=G.variables)==null?void 0:q[K])!==de)return!1;return!0}).length:I.value.length),{getCellStyle:f,getSummaryStyle:p,styleKey:u}=vs(h,r,m);function D(z){if(!z||Object.keys(z).length===0)return"";const G=[];return z.temperature!==void 0&&G.push(`T:${z.temperature}`),z.max_tokens!==void 0?G.push(`${z.max_tokens}t`):z.maxTokens!==void 0?G.push(`${z.maxTokens}t`):z.num_predict!==void 0&&G.push(`${z.num_predict}t`),z.top_p!==void 0&&G.push(`p:${z.top_p}`),z.top_k!==void 0&&G.push(`k:${z.top_k}`),G.length>0?`(${G.join(", ")})`:""}function H(z){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[z]||z.replace(/_/g," ").replace(/\b\w/g,q=>q.toUpperCase())}function Y(z,G,q){if(!q)return`${z} × ${G}: No data`;const K=be(q,$.value.aggregation);let de=`${z} × ${G}: ${K} (${q.count} calls)`;if(q.excludedCounts){const pe=[];q.excludedCounts.nonNumeric>0&&pe.push(`${q.excludedCounts.nonNumeric} non-numeric responses excluded`),q.excludedCounts.nullUndefined>0&&pe.push(`${q.excludedCounts.nullUndefined} null/empty responses`),pe.length>0&&(de+=` | ${pe.join(", ")}`)}return q.error&&(de+=` - ERROR: ${q.error}`),de}function T(z,G,q){if(!q)return`${z} by ${G}: No data`;const K=be(q,$.value.aggregation);return q.error?`${z} by ${G}: ${K} with data integrity error: ${q.error}`:`${z} by ${G}: ${K} from ${q.count} API calls`}function a(z,G){(z==="rowField"||z==="columnField"||z==="valueField"||z==="aggregation"||z==="rowSort"||z==="columnSort")&&($.value[z]=G),c("config-change",{...$.value})}function L(z){l.value={...z}}function R(){l.value={}}function Q(z,G,q){q&&c("cell-click",{row:z,column:G,cell:q})}function te(){k.value=!k.value}function j(){v.value=!v.value,v.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return ge(()=>{var G;const z=performance.now();_.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${((G=s.trial)==null?void 0:G.id)||"unknown"} with ${I.value.length} calls`),Ce(()=>{const q=performance.now();_.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(q-z).toFixed(1)}ms`)}),setTimeout(()=>{const q=performance.now();_.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(q-z).toFixed(1)}ms`)},0)}),Ve(()=>{var z;_.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${((z=s.trial)==null?void 0:z.id)||"unknown"} with ${I.value.length} calls`)}),Ae(()=>{var z;_.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${((z=s.trial)==null?void 0:z.id)||"unknown"}`)}),ye(()=>{var z;_.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${((z=s.trial)==null?void 0:z.id)||"unknown"}`),v.value&&(document.body.style.overflow="")}),ce([y,I],([z])=>{if(I.value.length>0&&(!$.value.rowField||$.value.rowField==="")&&z.categorical.length>0){if($.value.rowField=z.categorical.find(G=>G!=="model"&&G!=="status"&&G!=="error_type")||z.categorical[0]||"model",$.value.columnField=$.value.columnField||"model",$.value.valueField=$.value.valueField||"parsed_response",!$.value.aggregation||$.value.aggregation===""){const G=I.value.slice(0,3).map(K=>Re(K,$.value.valueField,s.trial)).filter(K=>K!=null),q=G.length>0&&G.every(K=>typeof K=="number");$.value.aggregation=q?"mean":"mode"}c("config-change",{...$.value})}},{immediate:!0}),(z,G)=>(o(),d("div",{class:le(["pivot-table-v3",{fullscreen:v.value}])},[e("div",{class:le(["pivot-options-container",{collapsed:k.value}])},[e("div",{class:"options-header",onClick:te},[G[3]||(G[3]=e("span",{class:"options-title"},"Pivot Table Options",-1)),e("span",Er,C(k.value?"▶":"▼"),1)]),Se(e("div",Vr,[Qt([W(y),$.value],()=>(o(),d("div",null,[E(ar,{config:$.value,"available-fields":W(y),onUpdateConfig:a},null,8,["config","available-fields"])])),G,0),e("div",Ar,[I.value.length>0?(o(),X(Rr,{key:0,"api-calls":I.value,trial:z.trial,"active-filters":l.value,onUpdateFilters:L,onClearFilters:R},null,8,["api-calls","trial","active-filters"])):A("",!0),E(mr,{"selected-color-scale":r.value,"gradient-mode":m.value,"is-fullscreen":v.value,onUpdateColorScale:G[1]||(G[1]=q=>r.value=q),onUpdateGradientMode:G[2]||(G[2]=q=>m.value=q),onToggleFullscreen:j},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[gt,!k.value]])],2),z.showPerformanceInfo?(o(),d("div",Lr,[e("span",null,"Computing: "+C(W(V)?"Yes":"No"),1),e("span",null,"Last Compute: "+C(W(U).toFixed(1))+"ms",1),e("span",null,"API Calls: "+C(I.value.length),1),e("span",null,"Filtered: "+C(i.value),1)])):A("",!0),e("div",xr,[I.value.length===0?(o(),d("div",Fr,G[4]||(G[4]=[e("p",null,"No data available for pivot table analysis.",-1)]))):$.value.aggregation in W(Le)?W(V)?(o(),d("div",Mr,G[6]||(G[6]=[e("p",null,"Computing pivot table...",-1)]))):(o(),d("div",Pr,[e("table",Or,[e("thead",null,[e("tr",Ur,[e("th",Nr,C(H($.value.rowField)||"Items")+" / "+C(H($.value.columnField)||"Aggregated"),1),(o(!0),d(Z,null,ne(W(h).columns,q=>(o(),d("th",{key:q,class:"column-header",role:"columnheader"},C(q),1))),128)),$.value.columnField&&z.showTotals?(o(),d("th",Wr," Total ")):A("",!0)])]),e("tbody",null,[(o(!0),d(Z,null,ne(w.value,q=>(o(),d("tr",{key:`${q.label}-${W(u)}`,class:"data-row",role:"row"},[e("td",zr,C(q.label),1),(o(!0),d(Z,null,ne(q.cells,(K,de)=>(o(),d("td",{key:`${de}-${W(u)}`,class:le(["data-cell",{"error-cell":K==null?void 0:K.error}]),"data-testid":K!=null&&K.error?"pivot-cell-error":"pivot-cell",style:_e(W(f)(K,q.label,de)),title:Y(q.label,W(h).columns[de],K),"aria-label":T(q.label,W(h).columns[de],K),role:K!=null&&K.error?"alert":"cell",tabindex:"0",onClick:pe=>Q(q.label,W(h).columns[de],K),onKeydown:[Qe(pe=>Q(q.label,W(h).columns[de],K),["enter"]),Qe(ht(pe=>Q(q.label,W(h).columns[de],K),["prevent"]),["space"])]},[K!=null&&K.error?(o(),d("div",Br,[e("span",{class:"error-indicator",title:K.error},"⚠️",8,Gr),e("span",jr,C(K?W(be)(K,$.value.aggregation):"-"),1),e("div",qr,C(K.error),1)])):(o(),d("span",Kr,C(K?W(be)(K,$.value.aggregation):"-"),1))],46,Hr))),128)),$.value.columnField&&z.showTotals?(o(),d("td",{key:0,class:"total-cell",style:_e(W(p)(q.total)),role:"cell"},C(W(be)(q.total,$.value.aggregation)),5)):A("",!0)]))),128)),$.value.rowField&&z.showTotals?(o(),d("tr",{key:`totals-${W(u)}`,class:"total-row",role:"row"},[G[7]||(G[7]=e("td",{class:"row-header",role:"rowheader"},"Total",-1)),(o(!0),d(Z,null,ne(W(h).totals,(q,K)=>(o(),d("td",{key:`total-${K}-${W(u)}`,class:"total-cell",style:_e(W(p)(q)),role:"cell"},C(W(be)(q,$.value.aggregation)),5))),128)),$.value.columnField?(o(),d("td",{key:0,class:"grand-total-cell",style:_e(W(p)(W(h).grandTotal)),role:"cell"},C(W(be)(W(h).grandTotal,$.value.aggregation)),5)):A("",!0)])):A("",!0)])])])):(o(),d("div",Dr,[e("p",null,"Invalid aggregation function: "+C($.value.aggregation),1),G[5]||(G[5]=e("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),Jr=re(Qr,[["__scopeId","data-v-2d987e50"]]),Yr={class:"modal-content"},Xr={class:"modal-header"},Zr={class:"modal-title"},eu={class:"summary-row"},tu={key:0},su={key:0,class:"filter-row"},au=["onUpdate:modelValue","aria-label"],nu={value:""},lu=["value"],ou={class:"table-container"},iu={class:"api-calls-table"},ru=["title"],uu=["title"],du=ue({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(n){const t=n,s=Jt({}),c=P(()=>{const i=new Set;return t.apiCalls.forEach(f=>{f.variables&&Object.keys(f.variables).forEach(p=>i.add(p)),f.attributedVariables&&Object.entries(f.attributedVariables).forEach(([p,u])=>{u&&typeof u=="object"&&Object.keys(u).forEach(D=>{i.add(`${p}.${D}`)})})}),Array.from(i).sort()}),v=P(()=>c.value.map(i=>({title:i,dataIndex:`var_${i}`,key:`var_${i}`,width:150}))),r=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],m=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],k=P(()=>[...r,...v.value,...m]),$=P(()=>`${t.row} × ${t.column} - ${t.apiCalls.length} API Calls`),l=P(()=>t.apiCalls.map(i=>{var p,u;const f={id:i.id,status:i.status,model:i.model||"-",response:((p=i.result)==null?void 0:p.content)||((u=i.result)==null?void 0:u.error)||"-",extracted:i.extracted||"-",duration:i.duration?`${i.duration}ms`:"-",cost:i.cost||0};return c.value.forEach(D=>{var H,Y,T;if(D.includes(".")){const[a,L]=D.split("."),R=(Y=(H=i.attributedVariables)==null?void 0:H[a])==null?void 0:Y[L];f[`var_${D}`]=R!==void 0?String(R):"-"}else f[`var_${D}`]=((T=i.variables)==null?void 0:T[D])||"-"}),f})),b=P(()=>Object.values(s).some(i=>i!==void 0&&i!=="")),I=P(()=>b.value?l.value.filter(i=>Object.entries(s).every(([f,p])=>p?i[f]===p:!0)):l.value),g=P(()=>{const i=t.apiCalls.filter(f=>f.status==="completed").length;return Math.round(i/t.apiCalls.length*100)}),S=P(()=>{const i=t.apiCalls.filter(f=>f.duration).map(f=>f.duration);return i.length===0?0:Math.round(i.reduce((f,p)=>f+p,0)/i.length)}),h=P(()=>t.apiCalls.filter(f=>f.cost).map(f=>f.cost).reduce((f,p)=>f+p,0));function y(i){switch(i){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function V(i,f){return i?i.length<=f?i:i.slice(0,f)+"...":""}function U(i){const f=new Set;return l.value.forEach(p=>{const u=p[i];u&&u!=="-"&&f.add(u)}),Array.from(f).sort()}function w(){Object.keys(s).forEach(i=>{delete s[i]})}return(i,f)=>(o(),d("div",{class:le(["pivot-cell-detail-modal-v3",{visible:i.visible}]),onClick:f[1]||(f[1]=ht(p=>i.$emit("close"),["self"]))},[e("div",Yr,[e("div",Xr,[e("h3",Zr,C($.value),1),e("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:f[0]||(f[0]=p=>i.$emit("close"))}," × ")]),e("div",eu,[e("span",null,[f[2]||(f[2]=e("b",null,"Total:",-1)),O(" "+C(i.apiCalls.length),1)]),e("span",null,[f[3]||(f[3]=e("b",null,"Success Rate:",-1)),O(" "+C(g.value)+"%",1)]),e("span",null,[f[4]||(f[4]=e("b",null,"Avg Duration:",-1)),O(" "+C(S.value)+"ms",1)]),h.value>0?(o(),d("span",tu,[f[5]||(f[5]=e("b",null,"Total Cost:",-1)),O(" $"+C(h.value),1)])):A("",!0)]),v.value.length>0?(o(),d("div",su,[(o(!0),d(Z,null,ne(v.value,p=>(o(),d("div",{key:p.key,class:"variable-filter"},[Se(e("select",{"onUpdate:modelValue":u=>s[p.key]=u,"aria-label":`Filter ${p.title}`,class:"filter-select"},[e("option",nu,"All "+C(p.title),1),(o(!0),d(Z,null,ne(U(p.key),u=>(o(),d("option",{key:u,value:u},C(u),9,lu))),128))],8,au),[[Yt,s[p.key]]])]))),128)),b.value?(o(),d("button",{key:0,type:"button",class:"clear-filters-btn",onClick:w}," Clear Filters ")):A("",!0)])):A("",!0),e("div",ou,[e("table",iu,[e("thead",null,[e("tr",null,[(o(!0),d(Z,null,ne(k.value,p=>(o(),d("th",{key:p.key,class:"table-header",style:_e({width:p.width?`${p.width}px`:"auto"})},C(p.title),5))),128))])]),e("tbody",null,[(o(!0),d(Z,null,ne(I.value,p=>(o(),d("tr",{key:p.id,class:"table-row"},[(o(!0),d(Z,null,ne(k.value,u=>(o(),d("td",{key:u.key,class:le(["table-cell",{"status-cell":u.key==="status"}])},[u.key==="status"?(o(),d("span",{key:0,class:le(["status-tag",y(p.status)])},C(p.status),3)):u.key==="response"?(o(),d("span",{key:1,class:"response-cell",title:p.response},C(V(p.response,100)),9,ru)):u.key==="cost"?(o(),d(Z,{key:2},[O(C(p.cost===0?"-":`$${p.cost.toFixed(4)}`),1)],64)):u.key.startsWith("var_")?(o(),d("span",{key:3,class:"variable-cell",title:p[u.key]},C(p[u.key]||"-"),9,uu)):(o(),d(Z,{key:4},[O(C(p[u.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),cu=re(du,[["__scopeId","data-v-2738b696"]]),pu={class:"trial-tab-content"},fu={class:"tab-pane-content"},mu={class:"tab-pane-content"},vu={key:0,class:"no-data-message"},gu={class:"tab-pane-content"},ft="trial-details-active-tab",hu=ue({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(n){const t=n,s=_t(),c=Ne(),v=He(),r=P(()=>{var w;return((w=v.apiCalls)==null?void 0:w.value)||[]}),m=P(()=>{var w;return((w=v.isStreaming)==null?void 0:w.value)||!1});ce(r,(w,i)=>{const f=performance.now();_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${(i==null?void 0:i.length)||0} to ${w.length} calls`),setTimeout(()=>{const p=performance.now();_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(p-f).toFixed(1)}ms`)},0)});const k=P(()=>!1),l=B((()=>{const w=s.query.tab;return w==="status"?"details":w&&["details","tasks","pivot"].includes(w)?w:"tasks"})()),b=B(!1),I=B(!1),g=B({row:"",column:"",apiCalls:[],value:null}),S=P(()=>{var w,i;return((w=t.executionState)==null?void 0:w.status)==="executing"&&((i=t.executionState)==null?void 0:i.currentTrialId)===t.trial.id}),h=P(()=>t.trial.progress.completed>0);function y(){localStorage.setItem(ft,l.value);const w={...s.query};w.tab=l.value,s.query.tab!==l.value&&(c.replace({query:w}),_.info(`TAB_ROUTING: Updated URL tab parameter to '${l.value}'`))}function V(){const w=localStorage.getItem(ft);w==="status"?l.value="details":w&&["details","tasks","pivot"].includes(w)&&(l.value=w)}function U(w){!w.cell||!w.cell.apiCalls.length||(g.value={row:w.row,column:w.column,apiCalls:w.cell.apiCalls,value:w.cell.value},I.value=!0)}return ce(l,()=>{y()}),ce(()=>s.query.tab,w=>{if(w&&typeof w=="string"){let i=w==="status"?"details":w;["details","tasks","pivot"].includes(i)&&l.value!==i&&(l.value=i,_.info(`TAB_ROUTING: Synced tab to URL parameter '${i}'`))}}),ge(()=>{const w=performance.now();if(_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${t.trial.id}`),!s.query.tab){const i={...s.query};i.tab=l.value,c.replace({query:i}),_.info(`TAB_ROUTING: Set initial URL tab parameter to '${l.value}'`)}V(),setTimeout(()=>{const i=performance.now();_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(i-w).toFixed(1)}ms`)},0)}),Ve(()=>{_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${t.trial.id}`)}),Ae(()=>{_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${t.trial.id}`)}),ye(()=>{_.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${t.trial.id}`)}),(w,i)=>{const f=J("a-tab-pane"),p=J("a-tabs");return o(),d("div",pu,[E(p,{activeKey:l.value,"onUpdate:activeKey":i[1]||(i[1]=u=>l.value=u),type:"card",class:"trial-tabs"},{default:x(()=>[E(f,{key:"tasks",tab:"Task View"},{default:x(()=>[e("div",fu,[(o(),X(Je,null,[E(Vi,{trial:w.trial,progress:w.progress,"is-executing":S.value,"api-calls":r.value,"is-streaming":m.value,"is-loading":k.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),E(f,{key:"pivot",tab:"Pivot Table"},{default:x(()=>[e("div",mu,[(o(),X(Je,null,[h.value&&r.value.length>0?(o(),X(Jr,{key:0,"api-calls":r.value,trial:w.trial,"show-performance-info":!1,onCellClick:U},null,8,["api-calls","trial"])):A("",!0)],1024)),h.value&&r.value.length>0?A("",!0):(o(),d("div",vu,i[3]||(i[3]=[e("p",null,"No completed API calls available for pivot analysis.",-1),e("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),E(f,{key:"details",tab:"Details"},{default:x(()=>[e("div",gu,[E(cl,{trial:w.trial,"is-collapsed":b.value,onToggleCollapse:i[0]||(i[0]=u=>b.value=!b.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),I.value?(o(),X(cu,{key:0,visible:I.value,row:g.value.row,column:g.value.column,"api-calls":g.value.apiCalls,trial:w.trial,value:g.value.value,onClose:i[2]||(i[2]=u=>I.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):A("",!0)])}}}),_u=re(hu,[["__scopeId","data-v-d2c24429"]]),yu={class:"export-content"},bu={class:"section"},Tu={key:0,class:"section"},$u={class:"bundle-info"},Cu={key:0},ku={key:1,class:"section"},Su={class:"field-actions"},wu={class:"field-groups"},Iu={class:"field-group"},Ru={class:"field-list"},Eu={class:"field-group"},Vu={class:"field-list"},Au={class:"field-group"},Lu={class:"field-list"},xu={class:"field-group"},Fu={class:"field-list"},Du={class:"field-group"},Mu={class:"field-list"},Pu={key:0,class:"field-group"},Ou={class:"field-list"},Uu={key:1,class:"field-group"},Nu={class:"field-list"},Wu={class:"section"},zu={class:"preview-info"},Hu={class:"info-item"},Bu={class:"value"},Gu={class:"info-item"},ju={class:"value"},qu={class:"info-item"},Ku={class:"value"},Qu={class:"export-actions"},Ju=ue({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(n,{emit:t}){const s=n,c=t,v=tt(),r=B("csv"),m=B(["order","status","configuration","prompt","response","latency"]),k=B(!1),$=B("draft"),l=B({}),b=B([]),I=B([]),g=B([]),S=["order","status","configuration","prompt","response","latency"],h=B([]),y=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],V=P(()=>{var L,R;const T=((L=s.trial.progress)==null?void 0:L.completed)||0,a=((R=s.trial.progress)==null?void 0:R.failed)||0;return T+a}),U=P(()=>{const a=m.value.length*50*V.value;return a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`});function w(){_.info("EXPORT_DEBUG: ExportModal initializeFieldSelection with allFields",h.value.length),h.value.forEach(L=>{l.value[L]=!1}),S.forEach(L=>{l.value[L]=!0});const T=I.value.map(L=>L.id),a=g.value.map(L=>L.id);T.forEach(L=>{l.value[L]=!0}),a.forEach(L=>{l.value[L]=!0}),_.info("EXPORT_DEBUG: ExportModal default selection includes",{standardDefaults:S.length,parameterDefaults:T.length,variableDefaults:a.length,totalDefaults:S.length+T.length+a.length}),i()}function i(){m.value=h.value.filter(T=>l.value[T])}function f(T,a){l.value[T]=a,i()}function p(){h.value.forEach(T=>{l.value[T]=!0}),i()}function u(){h.value.forEach(L=>{l.value[L]=!1}),S.forEach(L=>{l.value[L]=!0});const T=I.value.map(L=>L.id),a=g.value.map(L=>L.id);T.forEach(L=>{l.value[L]=!0}),a.forEach(L=>{l.value[L]=!0}),i()}function D(){h.value.forEach(T=>{l.value[T]=!1}),i()}function H(){c("update:visible",!1)}async function Y(){if(r.value==="bundle"){k.value=!0;try{const{trialBundleExportService:T}=await st(async()=>{const{trialBundleExportService:R}=await import("./trial-bundle.service-CmcMU-bT.js");return{trialBundleExportService:R}},__vite__mapDeps([0,1,2,3,4,5,6])),a=$.value==="completed",L=await T.exportTrialBundle(s.trial.id,{includeResults:a,includeApiCalls:a,format:"json"});L.ok?(ae.success(`Trial bundle exported: ${L.value.filename}`),c("update:visible",!1)):ae.error(`Bundle export failed: ${L.error.message}`)}catch(T){ae.error(`Bundle export failed: ${T instanceof Error?T.message:"Unknown error"}`)}finally{k.value=!1}return}if(m.value.length===0){ae.warning("Please select at least one field to export");return}k.value=!0;try{const T={format:r.value,fields:m.value,includeHeaders:!0,addBOM:r.value==="excel"||r.value==="csv"},a=await v.dataExport.exportTrialData(s.trial.id,T);a.ok?(ae.success("Export completed successfully"),c("update:visible",!1)):ae.error(`Export failed: ${a.error.message}`)}catch(T){ae.error("Export failed: "+T.message)}finally{k.value=!1}}return ge(async()=>{_.info("EXPORT_DEBUG: ExportModal discovering available fields for trial",s.trial.id);const T=await v.dataExport.getAvailableFields(s.trial.id);if(T.ok){b.value=T.value.standardFields,I.value=T.value.parameterFields,g.value=T.value.variableFields||[];const a=T.value.standardFields.map(Q=>Q.id).filter(Q=>Q!=="parameters"&&Q!=="variables"),L=T.value.parameterFields.map(Q=>Q.id),R=(T.value.variableFields||[]).map(Q=>Q.id);h.value=[...a,...L,...R],_.info("EXPORT_DEBUG: ExportModal discovered fields",{standardFields:T.value.standardFields.length,parameterFields:T.value.parameterFields.length,variableFields:(T.value.variableFields||[]).length,totalFields:h.value.length,parameterFieldNames:T.value.parameterFields.map(Q=>Q.id),variableFieldNames:(T.value.variableFields||[]).map(Q=>Q.id),allFieldNames:h.value})}else _.info("EXPORT_DEBUG: ExportModal field discovery failed",T.error),h.value=[...y];w()}),(T,a)=>{const L=J("a-radio-button"),R=J("a-radio-group"),Q=J("a-radio"),te=J("a-button"),j=J("a-checkbox"),oe=J("a-modal");return o(),X(oe,{visible:T.visible,"onUpdate:visible":a[46]||(a[46]=F=>T.$emit("update:visible",F)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:x(()=>[e("div",yu,[e("div",bu,[a[53]||(a[53]=e("h4",null,"Export Format",-1)),E(R,{value:r.value,"onUpdate:value":a[0]||(a[0]=F=>r.value=F),class:"format-options"},{default:x(()=>[E(L,{value:"csv"},{default:x(()=>a[47]||(a[47]=[O("CSV")])),_:1,__:[47]}),E(L,{value:"tsv"},{default:x(()=>a[48]||(a[48]=[O("TSV")])),_:1,__:[48]}),E(L,{value:"excel"},{default:x(()=>a[49]||(a[49]=[O("Excel")])),_:1,__:[49]}),E(L,{value:"json"},{default:x(()=>a[50]||(a[50]=[O("JSON")])),_:1,__:[50]}),E(L,{value:"jsonl"},{default:x(()=>a[51]||(a[51]=[O("JSONL")])),_:1,__:[51]}),E(L,{value:"bundle"},{default:x(()=>a[52]||(a[52]=[O("Bundle 📦")])),_:1,__:[52]})]),_:1},8,["value"])]),r.value==="bundle"?(o(),d("div",Tu,[a[62]||(a[62]=e("h4",null,"Bundle Export Options",-1)),e("div",$u,[E(R,{value:$.value,"onUpdate:value":a[1]||(a[1]=F=>$.value=F),style:{"margin-bottom":"16px"}},{default:x(()=>[E(Q,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:x(()=>a[54]||(a[54]=[e("strong",null,"Export as Draft",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Configuration only - recipient can run fresh experiment ",-1)])),_:1,__:[54]}),E(Q,{value:"completed",style:{display:"block"}},{default:x(()=>a[55]||(a[55]=[e("strong",null,"Export with Results",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Include all execution results for review/analysis ",-1)])),_:1,__:[55]})]),_:1},8,["value"]),a[61]||(a[61]=e("p",null,"The bundle will include:",-1)),e("ul",null,[a[56]||(a[56]=e("li",null,"✅ Complete trial configuration",-1)),a[57]||(a[57]=e("li",null,"✅ Template with metadata",-1)),a[58]||(a[58]=e("li",null,"✅ All variable lists",-1)),a[59]||(a[59]=e("li",null,"✅ Model configurations",-1)),$.value==="completed"?(o(),d("li",Cu,"✅ Execution results and API calls")):A("",!0),a[60]||(a[60]=e("li",null,"✅ Variable index tracking for lineage",-1))]),e("p",null,[e("strong",null,C($.value==="draft"?"Ready to run fresh experiment":"Complete historical record"),1)])])])):(o(),d("div",ku,[a[95]||(a[95]=e("h4",null,"Fields to Export",-1)),e("div",Su,[E(te,{size:"small",onClick:p},{default:x(()=>a[63]||(a[63]=[O("Select All")])),_:1,__:[63]}),E(te,{size:"small",onClick:u},{default:x(()=>a[64]||(a[64]=[O("Select Defaults")])),_:1,__:[64]}),E(te,{size:"small",onClick:D},{default:x(()=>a[65]||(a[65]=[O("Clear All")])),_:1,__:[65]})]),e("div",wu,[e("div",Iu,[a[71]||(a[71]=e("h5",null,"Basic Information",-1)),e("div",Ru,[E(j,{checked:l.value.id,"onUpdate:checked":a[2]||(a[2]=F=>l.value.id=F),onChange:a[3]||(a[3]=F=>f("id",F.target.checked))},{default:x(()=>a[66]||(a[66]=[O("Call ID")])),_:1,__:[66]},8,["checked"]),E(j,{checked:l.value.order,"onUpdate:checked":a[4]||(a[4]=F=>l.value.order=F),onChange:a[5]||(a[5]=F=>f("order",F.target.checked))},{default:x(()=>a[67]||(a[67]=[O("Order")])),_:1,__:[67]},8,["checked"]),E(j,{checked:l.value.status,"onUpdate:checked":a[6]||(a[6]=F=>l.value.status=F),onChange:a[7]||(a[7]=F=>f("status",F.target.checked))},{default:x(()=>a[68]||(a[68]=[O("Status")])),_:1,__:[68]},8,["checked"]),E(j,{checked:l.value.created,"onUpdate:checked":a[8]||(a[8]=F=>l.value.created=F),onChange:a[9]||(a[9]=F=>f("created",F.target.checked))},{default:x(()=>a[69]||(a[69]=[O("Created Time")])),_:1,__:[69]},8,["checked"]),E(j,{checked:l.value.completed,"onUpdate:checked":a[10]||(a[10]=F=>l.value.completed=F),onChange:a[11]||(a[11]=F=>f("completed",F.target.checked))},{default:x(()=>a[70]||(a[70]=[O("Completed Time")])),_:1,__:[70]},8,["checked"])])]),e("div",Eu,[a[76]||(a[76]=e("h5",null,"Configuration",-1)),e("div",Vu,[E(j,{checked:l.value.configuration,"onUpdate:checked":a[12]||(a[12]=F=>l.value.configuration=F),onChange:a[13]||(a[13]=F=>f("configuration",F.target.checked))},{default:x(()=>a[72]||(a[72]=[O("Configuration Name")])),_:1,__:[72]},8,["checked"]),E(j,{checked:l.value.provider,"onUpdate:checked":a[14]||(a[14]=F=>l.value.provider=F),onChange:a[15]||(a[15]=F=>f("provider",F.target.checked))},{default:x(()=>a[73]||(a[73]=[O("Provider")])),_:1,__:[73]},8,["checked"]),E(j,{checked:l.value.modelId,"onUpdate:checked":a[16]||(a[16]=F=>l.value.modelId=F),onChange:a[17]||(a[17]=F=>f("modelId",F.target.checked))},{default:x(()=>a[74]||(a[74]=[O("Model ID")])),_:1,__:[74]},8,["checked"]),E(j,{checked:l.value.parameters,"onUpdate:checked":a[18]||(a[18]=F=>l.value.parameters=F),onChange:a[19]||(a[19]=F=>f("parameters",F.target.checked))},{default:x(()=>a[75]||(a[75]=[O("Parameters")])),_:1,__:[75]},8,["checked"])])]),e("div",Au,[a[81]||(a[81]=e("h5",null,"Content",-1)),e("div",Lu,[E(j,{checked:l.value.prompt,"onUpdate:checked":a[20]||(a[20]=F=>l.value.prompt=F),onChange:a[21]||(a[21]=F=>f("prompt",F.target.checked))},{default:x(()=>a[77]||(a[77]=[O("Prompt")])),_:1,__:[77]},8,["checked"]),E(j,{checked:l.value.variables,"onUpdate:checked":a[22]||(a[22]=F=>l.value.variables=F),onChange:a[23]||(a[23]=F=>f("variables",F.target.checked))},{default:x(()=>a[78]||(a[78]=[O("Variables")])),_:1,__:[78]},8,["checked"]),E(j,{checked:l.value.response,"onUpdate:checked":a[24]||(a[24]=F=>l.value.response=F),onChange:a[25]||(a[25]=F=>f("response",F.target.checked))},{default:x(()=>a[79]||(a[79]=[O("Response")])),_:1,__:[79]},8,["checked"]),E(j,{checked:l.value.parsedResponse,"onUpdate:checked":a[26]||(a[26]=F=>l.value.parsedResponse=F),onChange:a[27]||(a[27]=F=>f("parsedResponse",F.target.checked))},{default:x(()=>a[80]||(a[80]=[O("Parsed Response")])),_:1,__:[80]},8,["checked"])])]),e("div",xu,[a[87]||(a[87]=e("h5",null,"Performance",-1)),e("div",Fu,[E(j,{checked:l.value.latency,"onUpdate:checked":a[28]||(a[28]=F=>l.value.latency=F),onChange:a[29]||(a[29]=F=>f("latency",F.target.checked))},{default:x(()=>a[82]||(a[82]=[O("Latency (ms)")])),_:1,__:[82]},8,["checked"]),E(j,{checked:l.value.promptTokens,"onUpdate:checked":a[30]||(a[30]=F=>l.value.promptTokens=F),onChange:a[31]||(a[31]=F=>f("promptTokens",F.target.checked))},{default:x(()=>a[83]||(a[83]=[O("Prompt Tokens")])),_:1,__:[83]},8,["checked"]),E(j,{checked:l.value.completionTokens,"onUpdate:checked":a[32]||(a[32]=F=>l.value.completionTokens=F),onChange:a[33]||(a[33]=F=>f("completionTokens",F.target.checked))},{default:x(()=>a[84]||(a[84]=[O("Completion Tokens")])),_:1,__:[84]},8,["checked"]),E(j,{checked:l.value.totalTokens,"onUpdate:checked":a[34]||(a[34]=F=>l.value.totalTokens=F),onChange:a[35]||(a[35]=F=>f("totalTokens",F.target.checked))},{default:x(()=>a[85]||(a[85]=[O("Total Tokens")])),_:1,__:[85]},8,["checked"]),E(j,{checked:l.value.cost,"onUpdate:checked":a[36]||(a[36]=F=>l.value.cost=F),onChange:a[37]||(a[37]=F=>f("cost",F.target.checked))},{default:x(()=>a[86]||(a[86]=[O("Cost (USD)")])),_:1,__:[86]},8,["checked"])])]),e("div",Du,[a[92]||(a[92]=e("h5",null,"Technical Details",-1)),e("div",Mu,[E(j,{checked:l.value.request,"onUpdate:checked":a[38]||(a[38]=F=>l.value.request=F),onChange:a[39]||(a[39]=F=>f("request",F.target.checked))},{default:x(()=>a[88]||(a[88]=[O("Full Request")])),_:1,__:[88]},8,["checked"]),E(j,{checked:l.value.response_raw,"onUpdate:checked":a[40]||(a[40]=F=>l.value.response_raw=F),onChange:a[41]||(a[41]=F=>f("response_raw",F.target.checked))},{default:x(()=>a[89]||(a[89]=[O("Raw Response")])),_:1,__:[89]},8,["checked"]),E(j,{checked:l.value.error,"onUpdate:checked":a[42]||(a[42]=F=>l.value.error=F),onChange:a[43]||(a[43]=F=>f("error",F.target.checked))},{default:x(()=>a[90]||(a[90]=[O("Error Details")])),_:1,__:[90]},8,["checked"]),E(j,{checked:l.value.repeatIndex,"onUpdate:checked":a[44]||(a[44]=F=>l.value.repeatIndex=F),onChange:a[45]||(a[45]=F=>f("repeatIndex",F.target.checked))},{default:x(()=>a[91]||(a[91]=[O("Repeat Index")])),_:1,__:[91]},8,["checked"])])]),I.value.length>0?(o(),d("div",Pu,[a[93]||(a[93]=e("h5",null,"Parameters (Individual Columns)",-1)),e("div",Ou,[(o(!0),d(Z,null,ne(I.value,F=>(o(),X(j,{key:F.id,checked:l.value[F.id],"onUpdate:checked":me=>l.value[F.id]=me,onChange:me=>f(F.id,me.target.checked)},{default:x(()=>[O(C(F.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):A("",!0),g.value.length>0?(o(),d("div",Uu,[a[94]||(a[94]=e("h5",null,"Attributes (Individual Columns)",-1)),e("div",Nu,[(o(!0),d(Z,null,ne(g.value,F=>(o(),X(j,{key:F.id,checked:l.value[F.id],"onUpdate:checked":me=>l.value[F.id]=me,onChange:me=>f(F.id,me.target.checked)},{default:x(()=>[O(C(F.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):A("",!0)])])),e("div",Wu,[a[99]||(a[99]=e("h4",null,"Export Preview",-1)),e("div",zu,[e("div",Hu,[a[96]||(a[96]=e("span",{class:"label"},"Records:",-1)),e("span",Bu,C(V.value),1)]),e("div",Gu,[a[97]||(a[97]=e("span",{class:"label"},"Fields:",-1)),e("span",ju,C(m.value.length),1)]),e("div",qu,[a[98]||(a[98]=e("span",{class:"label"},"Estimated Size:",-1)),e("span",Ku,C(U.value),1)])])]),e("div",Qu,[E(te,{onClick:H},{default:x(()=>a[100]||(a[100]=[O("Cancel")])),_:1,__:[100]}),E(te,{type:"primary",onClick:Y,loading:k.value,disabled:m.value.length===0},{default:x(()=>[E(W(fs)),a[101]||(a[101]=O(" Export "))]),_:1,__:[101]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),Yu=re(Ju,[["__scopeId","data-v-34965650"]]);class Xu{constructor(){ve(this,"subscription",null);ve(this,"progressSubscription",null);ve(this,"store",He());ve(this,"v4Control",Rt());ve(this,"isActive",!1);ve(this,"currentTrialId",null)}async startStreaming(t){const s=performance.now();_.info(`V4_TRIAL_SWITCH: Stream manager starting for trial ${t}`),this.cleanupSubscriptions();const c=performance.now();_.info(`V4_TRIAL_SWITCH: Stream cleanup completed in ${(c-s).toFixed(1)}ms`),this.isActive=!0,_.info(`V4_TRIAL_SWITCH: Set isActive = true to pause reactive queries at ${(c-s).toFixed(1)}ms`),this.currentTrialId=t,this.store.setCurrentTrial(t),this.store.setStreaming(!0);const v=performance.now();_.info(`V4_TRIAL_SWITCH: Store updated in ${(v-c).toFixed(1)}ms`);const r=performance.now();_.info("V4_TRIAL_SWITCH: ALWAYS loading complete historical data first"),await this.loadHistoricalData(t);const m=performance.now();_.info(`V4_TRIAL_SWITCH: Historical data loading completed in ${(m-r).toFixed(1)}ms - store now has complete dataset`);const k=performance.now();_.info("V4_TRIAL_SWITCH: Checking for active streams to overlay updates");const $=this.v4Control.getActiveStreams(t),l=performance.now();if(_.info(`V4_TRIAL_SWITCH: Stream check completed in ${(l-k).toFixed(1)}ms, result: ${$?"FOUND":"NONE"}`),!$){_.info(`V4_TRIAL_SWITCH: No active streams for trial ${t}, using complete historical data only`);const b=await Ke.trials.get(t);if(b&&b.status==="running"){_.info(`V4_TRIAL_SWITCH: Running trial ${t}, setting up retry for potential streaming`);let I=0;const g=5,S=setInterval(()=>{I++,_.info(`V4_TRIAL_SWITCH: Retry ${I}/${g} checking for active streams`);const h=this.v4Control.getActiveStreams(t);h?(_.info(`V4_TRIAL_SWITCH: Found active streams after ${I} retries - starting live updates`),clearInterval(S),this.connectToTrialStream(t,h)):I>=g&&(_.info(`V4_TRIAL_SWITCH: No streams after ${g} retries - staying with historical data only`),clearInterval(S))},500)}else _.info(`V4_TRIAL_SWITCH: Non-running trial ${(b==null?void 0:b.status)||"NOT_FOUND"} - complete with historical data only`);return}this.connectToTrialStream(t,$)}connectToTrialStream(t,s){var v,r;_.info(`V4_STREAM_CONNECT: Connecting to streams for trial ${t} with historical foundation`),_.info(`V4_STREAM_CONNECT: Entry point - starting stream connection for trial ${t}`),this.isActive=!0;const c=s.callsSubject||s.sharedCalls$;_.info(`V4_STREAM_CONNECT: Subscribing to calls stream for updates, type: ${(v=c==null?void 0:c.constructor)==null?void 0:v.name}`),_.info(`V4_STREAM_CONNECT: Calls stream available: ${!!c}, type: ${(r=c==null?void 0:c.constructor)==null?void 0:r.name}`),this.subscription=c.subscribe({next:m=>{if(m&&m.length>0){_.info(`V4_STREAM_CONNECT: Merging ${m.length} streaming updates`);const k=[...this.store.apiCalls.value];m.forEach($=>{const l=k.findIndex(b=>b.id===$.id);l>=0?k[l]=$:k.push($)}),k.sort(($,l)=>{const b=S=>{switch(S){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},I=b($.status),g=b(l.status);if(I!==g)return I-g;if($.status==="completed"&&l.status==="completed"){const S=$.completed?new Date($.completed).getTime():0;return(l.completed?new Date(l.completed).getTime():0)-S}if($.status==="running"&&l.status==="running"){const S=$.started?new Date($.started).getTime():0;return(l.started?new Date(l.started).getTime():0)-S}return $.order-l.order}),this.store.updateApiCalls(k)}},error:m=>{_.error("V4_STREAM_CONNECT: Stream error:",m),_.info("V4_STREAM_CONNECT: Calls stream ERROR:",m),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{_.info(`V4_TRIAL_DEBUG_STREAMS_MGR: Stream completed for trial ${t}`),_.info(`V4_TRIAL_DEBUG_STREAMS: Calls stream COMPLETED for trial ${t}`),this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(t)}}),s.sharedProgress$&&(_.info("V4_STREAM_CONNECT: Subscribing to progress stream"),_.info(`V4_STREAM_CONNECT: Progress stream available: ${!!s.sharedProgress$}`),this.progressSubscription=s.sharedProgress$.subscribe({next:m=>{_.info("V4_STREAM_CONNECT: Received progress update:",m.type),_.info(`V4_STREAM_CONNECT: Progress update - ${m.type}`),_.info(`🚨 COMPLETION_DEBUG: Stream manager received progress event: ${m.type} at ${new Date().toISOString()}`),m.type==="completed"&&(_.info(`V4_TRIAL_DEBUG_STREAMS: Trial ${t} COMPLETED via progress stream`),_.info("🚨 COMPLETION_DEBUG: ✅ TRIAL COMPLETED EVENT RECEIVED BY STREAM MANAGER!"),_.info(`V4_TRIAL_COMPLETION: Loading final data from database for completed trial ${t}`),this.loadHistoricalData(t).then(()=>{_.info("V4_TRIAL_COMPLETION: Final data loaded - UI should now show accurate completion counts"),_.info("🚨 COMPLETION_DEBUG: ✅ UI SHOULD BE UPDATED NOW!")}).catch(k=>{_.error("V4_TRIAL_COMPLETION: Failed to load final data:",k)})),this.store.updateProgress(m)},error:m=>{_.error("V4_STREAM_CONNECT: Progress stream error:",m),_.info("V4_STREAM_CONNECT: Progress stream ERROR:",m)}})),_.info("V4_STREAM_CONNECT: Successfully connected to streams with historical foundation"),_.info(`V4_STREAM_CONNECT: Stream subscriptions complete for trial ${t}`)}cleanupSubscriptions(){_.info("STREAM_MGR_V4: Cleaning up existing subscriptions"),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){_.info("STREAM_MGR_V4: Stopping streaming"),_.info(`V4_TRIAL_DEBUG_STREAMS: stopStreaming() called for trial ${this.currentTrialId}`),_.info(`V4_TRIAL_DEBUG_STREAMS: Current isActive: ${this.isActive}`),this.cleanupSubscriptions(),this.isActive=!1,_.info("V4_TRIAL_DEBUG_STREAMS: Stopped streaming, isActive set to false")}async loadHistoricalData(t){const s=performance.now();_.info(`V4_TRIAL_SWITCH: loadHistoricalData() ENTRY for trial ${t}`);try{const c=performance.now();_.info(`V4_TRIAL_SWITCH: Checking database availability at ${(c-s).toFixed(1)}ms`);const v=performance.now();_.info(`V4_TRIAL_SWITCH: Preparing database query at ${(v-s).toFixed(1)}ms`);const r=performance.now();_.info(`V4_TRIAL_SWITCH: Starting IndexedDB query at ${(r-s).toFixed(1)}ms`);const m=await Ke.apiCalls.where("trialId").equals(t).toArray(),k=performance.now();_.info(`V4_TRIAL_SWITCH: IndexedDB query COMPLETED - loaded ${m.length} calls in ${(k-r).toFixed(1)}ms`),_.info(`V4_TRIAL_SWITCH: Total time to query completion: ${(k-s).toFixed(1)}ms`);const $=performance.now();m.sort((S,h)=>{const y=w=>{switch(w){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},V=y(S.status),U=y(h.status);if(V!==U)return V-U;if(S.status==="completed"&&h.status==="completed"){const w=S.completed?new Date(S.completed).getTime():0;return(h.completed?new Date(h.completed).getTime():0)-w}if(S.status==="running"&&h.status==="running"){const w=S.started?new Date(S.started).getTime():0;return(h.started?new Date(h.started).getTime():0)-w}return S.order-h.order});const l=performance.now();_.info(`V4_TRIAL_SWITCH: Sorting ${m.length} calls took ${(l-$).toFixed(1)}ms`);const b=performance.now();this.store.updateApiCalls(m),this.store.setStreaming(!1);const I=performance.now();_.info(`V4_TRIAL_SWITCH: Store update took ${(I-b).toFixed(1)}ms`),_.info(`V4_TRIAL_SWITCH: loadHistoricalData keeping isActive = ${this.isActive} to maintain reactive query pause`);const g=performance.now();_.info(`V4_TRIAL_SWITCH: loadHistoricalData TOTAL: ${(g-s).toFixed(1)}ms`)}catch(c){_.error("STREAM_MGR_V4: Failed to load historical data:",c),this.store.clear()}}destroy(){_.info("STREAM_MGR_V4: Destroying stream manager"),this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let Ue=null;function xt(){return Ue||(Ue=new Xu,_.info("STREAM_MGR_V4: Created singleton manager instance")),Ue}typeof window<"u"&&(window.__trialStreamManagerV4=()=>Ue);const Zu={class:"trial-details-panel"},ed={key:0,class:"loading-state"},td={key:1,class:"error-state"},sd={class:"error-actions"},ad=ue({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(n){const t=n,s=Ne(),c=B(!1),v=B(null),r=B(!1),m=xt(),k=P(()=>{var g,S,h;return((g=t.executionState)==null?void 0:g.status)==="executing"&&((S=t.executionState)==null?void 0:S.currentTrialId)===((h=t.trial)==null?void 0:h.id)});function $(){v.value=null}function l(){s.push("/trials")}function b(){r.value=!0}async function I(){if(t.trial){_.info(`REFRESH: Manually refreshing trial ${t.trial.id} data from database`);try{m.isActive&&m.currentTrialId===t.trial.id&&(_.info("REFRESH: Temporarily stopping active stream to reload data"),m.stopStreaming()),await m.loadHistoricalData(t.trial.id),_.info(`REFRESH: Successfully refreshed trial ${t.trial.id} data`),(t.trial.status==="running"||t.trial.status==="paused")&&(_.info("REFRESH: Restarting streaming for active trial"),await m.startStreaming(t.trial.id))}catch(g){_.error("REFRESH: Failed to refresh trial data:",g)}}}return ce(()=>t.trial,(g,S)=>{g&&g.id!==(S==null?void 0:S.id)&&(v.value=null,_.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${S==null?void 0:S.id} to ${g.id}`))}),ge(()=>{var S;const g=(S=t.trial)==null?void 0:S.id;_.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${g}`)}),Ve(()=>{var S;const g=(S=t.trial)==null?void 0:S.id;_.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${g}`)}),Ae(()=>{var S;const g=(S=t.trial)==null?void 0:S.id;_.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${g}`)}),ye(()=>{var S;const g=(S=t.trial)==null?void 0:S.id;_.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${g}`)}),(g,S)=>{const h=J("a-button");return o(),d("div",Zu,[c.value?(o(),d("div",ed,[E(W(Ct),{class:"loading-spinner",spin:""}),S[9]||(S[9]=e("span",null,"Loading trial details...",-1))])):v.value?(o(),d("div",td,[E(W(Ee),{class:"error-icon"}),S[12]||(S[12]=e("h3",null,"Failed to load trial",-1)),e("p",null,C(v.value),1),e("div",sd,[E(h,{onClick:$},{default:x(()=>S[10]||(S[10]=[O("Retry")])),_:1,__:[10]}),E(h,{type:"link",onClick:l},{default:x(()=>S[11]||(S[11]=[O("Go Back")])),_:1,__:[11]})])])):g.trial?(o(),d(Z,{key:2},[E(Qa,{trial:g.trial,progress:g.progress,"is-executing":k.value},null,8,["trial","progress","is-executing"]),E(tn,{trial:g.trial,"is-leader":g.isLeader,"execution-state":g.executionState,onStart:S[0]||(S[0]=y=>g.$emit("start-trial")),onPause:S[1]||(S[1]=y=>g.$emit("pause-trial")),onResume:S[2]||(S[2]=y=>g.$emit("resume-trial")),onCancel:S[3]||(S[3]=y=>g.$emit("cancel-trial")),onDuplicate:S[4]||(S[4]=y=>g.$emit("duplicate-trial",g.trial.id)),onEdit:S[5]||(S[5]=y=>g.$emit("edit-trial",g.trial.id)),onDelete:S[6]||(S[6]=y=>g.$emit("delete-trial",g.trial.id)),onExportData:b,onExportPython:S[7]||(S[7]=y=>g.$emit("export-python",g.trial.id)),onRefresh:I},null,8,["trial","is-leader","execution-state"]),g.trial&&r.value?(o(),X(Yu,{key:0,visible:r.value,trial:g.trial,"onUpdate:visible":S[8]||(S[8]=y=>r.value=!1)},null,8,["visible","trial"])):A("",!0),E(_u,{trial:g.trial,progress:g.progress,"is-leader":g.isLeader,"execution-state":g.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):A("",!0)])}}}),nd=re(ad,[["__scopeId","data-v-081db72e"]]),ld={class:"import-content"},od={class:"upload-section"},id={class:"ant-upload-drag-icon"},rd={key:0,class:"preview-section"},ud={class:"bundle-details"},dd={class:"detail-row"},cd={class:"value"},pd={class:"detail-row"},fd={class:"value"},md={class:"detail-row"},vd={class:"value"},gd={class:"detail-row"},hd={class:"value"},_d={key:0,style:{color:"green","margin-left":"8px"}},yd={key:1,style:{color:"orange","margin-left":"8px"}},bd={key:0,class:"detail-row"},Td={class:"value"},$d={class:"detail-row"},Cd={class:"value"},kd={class:"import-options"},Sd={key:0,style:{"margin-bottom":"12px"}},wd={key:1,style:{"margin-bottom":"12px",padding:"8px",background:"#f0f0f0","border-radius":"4px"}},Id={key:0,class:"warnings"},Rd={class:"modal-actions"},Ed=ue({__name:"ImportTrialDialog",props:{visible:{type:Boolean}},emits:["update:visible","trial-imported"],setup(n,{emit:t}){const s=n,c=t,v=Ne(),r=B([]),m=B(null),k=B(!1),$=B([]),l=B({mode:"draft",namePrefix:"Imported: "}),b=P({get:()=>s.visible,set:i=>c("update:visible",i)}),I=P(()=>{var i,f;return((f=(i=m.value)==null?void 0:i.execution)==null?void 0:f.apiCalls)&&m.value.execution.apiCalls.length>0});function g(i){return!1}async function S(i){var p;const f=i.file.originFileObj||i.file;if(f)try{const u=await h(f),D=JSON.parse(u);$.value=y(D),m.value=D,(p=D.execution)!=null&&p.apiCalls&&D.execution.apiCalls.length>0,l.value.mode="draft"}catch{ae.error("Failed to read bundle file: Invalid JSON format"),m.value=null}}function h(i){return new Promise((f,p)=>{const u=new FileReader;u.onload=D=>{var H;return f((H=D.target)==null?void 0:H.result)},u.onerror=p,u.readAsText(i)})}function y(i){var p,u;const f=[];return i.version||f.push("Bundle version is missing"),(p=i.configuration)!=null&&p.trial||f.push("Trial configuration is missing"),(!((u=i.configuration)!=null&&u.variableLists)||i.configuration.variableLists.length===0)&&f.push("No variable lists found in bundle"),i.version!=="1.0"&&f.push(`Bundle version ${i.version} may not be fully compatible`),f}function V(i){return new Date(i).toLocaleString()}function U(){r.value=[],m.value=null,$.value=[],b.value=!1}async function w(){if(!m.value){ae.error("No bundle to import");return}k.value=!0;try{const{trialBundleImportService:i}=await st(async()=>{const{trialBundleImportService:u}=await import("./trial-bundle.service-CmcMU-bT.js");return{trialBundleImportService:u}},__vite__mapDeps([0,1,2,3,4,5,6])),f=I.value&&l.value.mode==="completed",p=await i.importTrialBundle(JSON.stringify(m.value),{importResults:f,importAsCompleted:f,namePrefix:l.value.namePrefix||void 0});p.ok?(ae.success("Trial imported successfully!"),v.push(`/trials?trialId=${p.value.trialId}`),c("trial-imported",p.value.trialId),U()):ae.error(`Import failed: ${p.error.message}`)}catch(i){ae.error(`Import failed: ${i instanceof Error?i.message:"Unknown error"}`)}finally{k.value=!1}}return(i,f)=>{const p=J("a-upload-dragger"),u=J("a-radio"),D=J("a-radio-group"),H=J("a-input"),Y=J("a-alert"),T=J("a-button"),a=J("a-modal");return o(),X(a,{visible:b.value,"onUpdate:visible":f[3]||(f[3]=L=>b.value=L),title:"Import Trial Bundle",width:600,footer:null,"destroy-on-close":!0,class:"import-trial-modal"},{default:x(()=>{var L;return[e("div",ld,[e("div",od,[E(p,{fileList:r.value,"onUpdate:fileList":f[0]||(f[0]=R=>r.value=R),"before-upload":g,"max-count":1,accept:".json",onChange:S},{default:x(()=>[e("p",id,[E(W($t))]),f[4]||(f[4]=e("p",{class:"ant-upload-text"},"Click or drag trial bundle file here",-1)),f[5]||(f[5]=e("p",{class:"ant-upload-hint"}," Supports .json files exported from trials ",-1))]),_:1,__:[4,5]},8,["fileList"])]),m.value?(o(),d("div",rd,[f[17]||(f[17]=e("h3",null,"Bundle Contents",-1)),e("div",ud,[e("div",dd,[f[6]||(f[6]=e("span",{class:"label"},"Trial Name:",-1)),e("span",cd,C(m.value.metadata.trialName),1)]),e("div",pd,[f[7]||(f[7]=e("span",{class:"label"},"Export Date:",-1)),e("span",fd,C(V(m.value.metadata.exportDate)),1)]),e("div",md,[f[8]||(f[8]=e("span",{class:"label"},"Status:",-1)),e("span",vd,C(m.value.metadata.trialStatus),1)]),e("div",gd,[f[9]||(f[9]=e("span",{class:"label"},"API Calls:",-1)),e("span",hd,[O(C(m.value.metadata.apiCallCount)+" ",1),I.value?(o(),d("span",_d," (with results) ")):(o(),d("span",yd," (configuration only) "))])]),m.value.configuration.template?(o(),d("div",bd,[f[10]||(f[10]=e("span",{class:"label"},"Template:",-1)),e("span",Td,C(m.value.configuration.template.name),1)])):A("",!0),e("div",$d,[f[11]||(f[11]=e("span",{class:"label"},"Variable Lists:",-1)),e("span",Cd,C(((L=m.value.configuration.variableLists)==null?void 0:L.length)||0),1)])]),e("div",kd,[f[16]||(f[16]=e("h4",null,"Import Options",-1)),I.value?(o(),d("div",Sd,[E(D,{value:l.value.mode,"onUpdate:value":f[1]||(f[1]=R=>l.value.mode=R),style:{display:"block"}},{default:x(()=>[E(u,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:x(()=>f[12]||(f[12]=[e("strong",null,"Import as Draft",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Create fresh trial ready to run new experiment ",-1)])),_:1,__:[12]}),E(u,{value:"completed",style:{display:"block"}},{default:x(()=>f[13]||(f[13]=[e("strong",null,"Import as Completed",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Preserve historical results for review/analysis ",-1)])),_:1,__:[13]})]),_:1},8,["value"])])):(o(),d("div",wd,f[14]||(f[14]=[e("strong",null,"Draft Trial",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px"}}," This bundle contains configuration only - will import as draft ready to run ",-1)]))),E(H,{value:l.value.namePrefix,"onUpdate:value":f[2]||(f[2]=R=>l.value.namePrefix=R),placeholder:"Name prefix (optional)",style:{"margin-top":"8px"}},{prefix:x(()=>f[15]||(f[15]=[O("Name:")])),_:1},8,["value"])]),$.value.length>0?(o(),d("div",Id,[E(Y,{message:"Import Warnings",type:"warning","show-icon":""},{description:x(()=>[e("ul",null,[(o(!0),d(Z,null,ne($.value,R=>(o(),d("li",{key:R},C(R),1))),128))])]),_:1})])):A("",!0)])):A("",!0),e("div",Rd,[E(T,{onClick:U},{default:x(()=>f[18]||(f[18]=[O("Cancel")])),_:1,__:[18]}),E(T,{type:"primary",onClick:w,loading:k.value,disabled:!m.value},{default:x(()=>[E(W(Tt)),f[19]||(f[19]=O(" Import Trial "))]),_:1,__:[19]},8,["loading","disabled"])])])]}),_:1},8,["visible"])}}}),Vd=re(Ed,[["__scopeId","data-v-1d9366d6"]]),Ad={class:"trials-view-v3"},Ld={key:0,class:"provider-warning-banner"},xd={class:"banner-content"},Fd={key:1,class:"observer-mode-banner"},Dd={class:"banner-content"},Md={key:1,class:"loading-left-pane"},Pd={key:0,class:"no-selection"},Od={key:0,class:"observer-note"},Ud=ue({__name:"TrialsViewV3",setup(n){const t=Rt(),{trials:s}=gs(),{enabledModels:c}=ys(),{duplicateTrial:v,deleteTrial:r}=hs(),m=xt(),k=tt(),$=_t(),l=Ne(),b=B(),I=B(!0),g=B(null),S=B(""),h=B("all"),y=B(-1),V=B(!1),U=B(!1),w=B(!1),i=P(()=>c.value.length>0),f=P(()=>!i.value&&!w.value),p=t.isLeader,u=t.execution,{trial:D}=_s(g),H=P(()=>{var N;const M=(N=D.value)==null?void 0:N.progress;return M?{trialId:g.value||"",...M,lastUpdated:new Date}:null}),Y=P(()=>{let M=s.value;if(S.value){const N=S.value.toLowerCase();M=M.filter(ee=>{var he,Te;const ie=ee.name.toLowerCase().includes(N),fe=(Te=(he=ee.templateConfig)==null?void 0:he.template)==null?void 0:Te.toLowerCase().includes(N),se=ee.configurations.some($e=>$e.modelId.toLowerCase().includes(N)||$e.provider.toLowerCase().includes(N));return ie||fe||se})}return h.value!=="all"&&(M=M.filter(N=>N.status===h.value)),M});async function T(){var N;const M=$.query;if(M.duplicate){const ee=M.duplicate,ie=await v(ee);ie.ok?await l.push({path:"/trials/create",query:{duplicate:ie.value,edit:M.edit==="true"?"true":void 0}}):ae.error(`Failed to duplicate trial: ${((N=ie.error)==null?void 0:N.message)||"Unknown error"}`),await l.replace({query:{}});return}if(M.designId||M.promptSource){await l.push({path:"/trials/create",query:M});return}if($.query.trialId){const ee=$.query.trialId;L(ee)}}function a(){if(g.value)return;if(s.value.length===0){_.info("V4_TRIALS: No trials available for auto-selection");return}const M=s.value.find(N=>N.status==="running");if(M){L(M.id);return}L(s.value[0].id)}async function L(M){const N=performance.now();_.info(`V4_TRIAL_SWITCH: Starting trial selection: ${M}`),g.value=M;const ee=performance.now();if(_.info(`V4_TRIAL_SWITCH: UI updated in ${(ee-N).toFixed(1)}ms`),s.value.length>0){const se=Y.value.findIndex(he=>he.id===M);se>=0&&(y.value=se)}const ie=performance.now();if(_.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${M} at ${(ie-N).toFixed(1)}ms`),m.startStreaming(M).catch(se=>{_.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${M}`,se)}),$.query.trialId!==M){const se={...$.query};se.trialId=M,se.tab||(se.tab="status"),l.push({path:"/trials",query:se}),_.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${se.tab}' at ${(performance.now()-N).toFixed(1)}ms`)}b.value&&b.value.closeMobileOverlay();const fe=performance.now();_.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(fe-N).toFixed(1)}ms`)}function R(M){S.value=M,y.value=-1}function Q(M){h.value=M,y.value=-1}async function te(){ae.info("Refreshing trial list...")}function j(M){const N=Y.value;if(N.length!==0){if((M.metaKey||M.ctrlKey)&&M.key==="k"){M.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(M.key==="j"||M.key==="ArrowDown")&&(M.preventDefault(),y.value=Math.min(y.value+1,N.length-1),y.value>=0&&(L(N[y.value].id),oe(N[y.value].id))),(M.key==="k"||M.key==="ArrowUp")&&(M.preventDefault(),y.value=Math.max(y.value-1,0),L(N[y.value].id),oe(N[y.value].id)),M.key==="Enter"&&g.value,M.key==="Escape"&&(S.value="",g.value=null,y.value=-1)}}function oe(M){Ce(()=>{const N=document.querySelector(`[data-trial-id="${M}"]`);N&&N.scrollIntoView({behavior:"smooth",block:"nearest"})})}function F(M){_.debug("Trial list panel resized",{width:M})}function me(M){_.debug("Mobile overlay changed",{visible:M})}function xe(){w.value=!0}async function we(){await l.push("/trials/create")}function Fe(){U.value=!0}function z(M){te(),L(M)}async function G(){var M,N,ee,ie;if(g.value){if(V.value){_.info("Start trial already in progress, ignoring duplicate request");return}V.value=!0,_.info("V4_EXECUTION:",(M=t.execution)==null?void 0:M.value),_.info("V4_STATUS:",(ee=(N=t.execution)==null?void 0:N.value)==null?void 0:ee.status);try{_.info("V4: Starting trial with streaming",g.value);const fe=await t.startTrialWithStreaming(g.value);if(!fe.ok){ae.error(((ie=fe.error)==null?void 0:ie.message)||"Unknown error");return}_.info("V4_STREAMING: Restarting stream manager after trial start"),await m.startStreaming(g.value),_.info("V4: Trial started with streaming, stream manager connected");const se={...$.query};se.tab="tasks",l.replace({query:se})}finally{V.value=!1}}}async function q(){var N;_.info(`V4_TRIAL_DEBUG_PAUSE: UI pauseTrial() called for trial: ${g.value}`),_.info(`V4_TRIAL_DEBUG_PAUSE: Current execution state: ${t.execution.value.status}`),_.info(`V4_TRIAL_DEBUG_PAUSE: Is leader: ${t.isLeader.value}`);const M=await t.pauseExecution();_.info("V4_TRIAL_DEBUG_PAUSE: UI pauseTrial result:",M),M.ok?_.info(`V4_TRIAL_DEBUG_PAUSE: Pause successful, execution state: ${t.execution.value.status}`):(_.info("V4_TRIAL_DEBUG_PAUSE: Pause failed from UI:",M.error.message),ae.error(((N=M.error)==null?void 0:N.message)||"Unknown error"))}async function K(){var ee,ie,fe;if(!g.value)return;_.info(`V4_TRIAL_DEBUG_RESUME: UI resumeTrial() called for trial: ${g.value}`),_.info(`V4_TRIAL_DEBUG_RESUME: Current execution state: ${t.execution.value.status}`),_.info(`V4_TRIAL_DEBUG_RESUME: Is leader: ${t.isLeader.value}`);const M=((ee=t.execution.value)==null?void 0:ee.status)||"idle";_.info(`V4_TRIAL_DEBUG_RESUME: Current execution status: ${M}`);const N=(ie=t.execution.value)==null?void 0:ie.currentTrialId;if(M==="paused"&&N===g.value){_.info(`V4_TRIAL_DEBUG_RESUME: Execution is paused for THIS trial (${g.value}), using resumeExecution()`);const se=await t.resumeExecution(g.value);_.info("V4_TRIAL_DEBUG_RESUME: resumeExecution result:",se),se.ok?(_.info("V4_TRIAL_DEBUG_RESUME: Resume successful - existing pipeline will continue automatically via pause$ = false"),_.info("V4_TRIAL_DEBUG_RESUME: Resume complete - existing V3 pipeline should continue processing pending calls")):(_.info("V4_TRIAL_DEBUG_RESUME: Resume failed:",se.error.message),ae.error(se.error.message))}else{_.info("V4_TRIAL_DEBUG_RESUME: No paused execution found, using startTrialWithStreaming (fresh start)");const se=await t.startTrialWithStreaming(g.value);_.info("V4_TRIAL_DEBUG_RESUME: startTrialWithStreaming result for fresh start:",se),se.ok?(_.info("V4_TRIAL_DEBUG_RESUME: Fresh start successful, starting stream manager"),await m.startStreaming(g.value),_.info("V4_TRIAL_DEBUG_RESUME: Stream manager started for fresh execution")):(_.info("V4_TRIAL_DEBUG_RESUME: Fresh start failed:",se.error.message),ae.error(((fe=se.error)==null?void 0:fe.message)||"Unknown error"))}}async function de(){var N;const M=await t.cancelExecution();M.ok||ae.error(((N=M.error)==null?void 0:N.message)||"Unknown error")}async function pe(M){var ee;const N=await v(M);N.ok?(ae.success("Trial duplicated"),N.value&&L(N.value)):ae.error(((ee=N.error)==null?void 0:ee.message)||"Unknown error")}async function Ie(M){await l.push({path:"/trials/create",query:{duplicate:M,edit:"true"}})}async function Be(M){var ee;const N=await r(M);N.ok?(ae.success("Trial deleted"),g.value===M&&(g.value=null)):ae.error(((ee=N.error)==null?void 0:ee.message)||"Unknown error")}async function Ft(M,N){var ie;const ee=await k.dataExport.exportTrialData(M,{format:N,fields:void 0,includeHeaders:!0,addBOM:N==="excel"});ee.ok?ae.success(`Exported ${ee.value.recordCount} API calls to ${ee.value.filename}`):ae.error(((ie=ee.error)==null?void 0:ie.message)||"Unknown error")}function Dt(M){Mt(M,"minimal")}async function Mt(M,N="classic"){var ee,ie,fe;if(N==="bundle"){const{usePythonBundleManagement:se}=await st(async()=>{const{usePythonBundleManagement:$e}=await import("./python-bundle-management-RKL4Ucly.js");return{usePythonBundleManagement:$e}},__vite__mapDeps([7,1,2,3,4,5,6,0])),{exportPythonBundle:he}=se(),Te=await he(M,{includeApiKeys:!0,showProgress:!0});Te.ok||ae.error(((ee=Te.error)==null?void 0:ee.message)||"Bundle export failed")}else if(N==="minimal"){const se=await k.pythonGeneration.generatePythonScript(M,{template:"minimal",includeComments:!0});se.ok?ae.success("Minimal Python script exported"):ae.error(((ie=se.error)==null?void 0:ie.message)||"Minimal export failed")}else{const se=await k.pythonGeneration.generatePythonScript(M,{template:"minimal",includeComments:!0});se.ok?ae.success("Python script exported"):ae.error(((fe=se.error)==null?void 0:fe.message)||"Classic export failed")}}return ce(()=>$.query.trialId,M=>{M&&M!==g.value&&L(M)}),ce(I,(M,N)=>{const ee=performance.now();_.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${N} to ${M} at ${ee}`),M||_.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),ce(s,(M,N)=>{const ee=performance.now();_.info(`V4_TRIAL_SWITCH: trials array changed from ${(N==null?void 0:N.length)||0} to ${M.length} trials at ${ee}`)},{immediate:!0}),ge(async()=>{const M=performance.now();_.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${M}`);const N=performance.now();_.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(N-M).toFixed(1)}ms`);try{await t.initialize();const Ge=performance.now();_.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(Ge-N).toFixed(1)}ms`)}catch(Ge){const Ut=performance.now();_.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(Ut-N).toFixed(1)}ms:`,Ge)}const ee=performance.now();window.addEventListener("keydown",j),_.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(ee-M).toFixed(1)}ms`);const ie=performance.now();_.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(ie-M).toFixed(1)}ms`),await Ce();const fe=performance.now();_.info(`V4_TRIAL_SWITCH: nextTick completed in ${(fe-ie).toFixed(1)}ms`);const se=performance.now();I.value=!1,_.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(se-M).toFixed(1)}ms`);const he=performance.now();_.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(he-M).toFixed(1)}ms`),await T();const Te=performance.now();_.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Te-he).toFixed(1)}ms`);const $e=performance.now();_.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${($e-M).toFixed(1)}ms`),a();const Pt=performance.now();_.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Pt-$e).toFixed(1)}ms`);const Ot=performance.now();_.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(Ot-M).toFixed(1)}ms`)}),ye(()=>{_.info("V4_SINGLETON_DEBUG: TrialsViewV3 onUnmounted() - NOT calling v4ExecutionControl.cleanup() to preserve singleton"),window.removeEventListener("keydown",j),m.destroy(),_.info("V4_SINGLETON_DEBUG: V4 execution system preserved, initialized flag should remain true")}),(M,N)=>{const ee=J("router-link"),ie=J("a-button");return o(),d("div",Ad,[f.value?(o(),d("div",Ld,[e("div",xd,[E(W(Ee),{class:"warning-icon"}),N[2]||(N[2]=e("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),E(ee,{to:"/settings",class:"settings-link"},{default:x(()=>N[1]||(N[1]=[O("Go to Settings")])),_:1,__:[1]}),E(W(bt),{class:"close-icon",onClick:xe})]),N[3]||(N[3]=e("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):A("",!0),W(p)?A("",!0):(o(),d("div",Fd,[e("div",Dd,[E(W(St),{class:"observer-icon"}),N[4]||(N[4]=e("span",null,[e("strong",null,"Observer Mode: Multiple Tabs Detected")],-1)),N[5]||(N[5]=e("div",{class:"leader-hint"}," You can only open one Auditomatic tab at a time. Close other tabs, or refresh if this is your only tab. Your templates and trials are safely saved. ",-1))])])),E($s,{ref_key:"splitPanel",ref:b,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:F,onMobileOverlayChange:me},{left:x(()=>[I.value?(o(),d("div",Md," Loading trials... ")):(o(),X(xa,{key:0,trials:W(s),"selected-trial-id":g.value,"search-query":S.value,"filter-status":h.value,onSelectTrial:L,onCreateTrial:we,onImportTrial:Fe,onUpdateSearch:R,onUpdateFilter:Q,onRefresh:te},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:x(()=>[(o(),X(Je,{max:5},[g.value?(o(),X(nd,{key:g.value,trial:W(D),"is-leader":W(p),"execution-state":W(u),progress:H.value,onStartTrial:G,onPauseTrial:q,onResumeTrial:K,onCancelTrial:de,onDuplicateTrial:pe,onEditTrial:Ie,onDeleteTrial:Be,onExportData:Ft,onExportPython:Dt},null,8,["trial","is-leader","execution-state","progress"])):A("",!0)],1024)),!g.value||!W(D)?Se((o(),d("div",Pd,[E(W(ms),{class:"empty-icon"}),N[7]||(N[7]=e("h3",null,"Select a trial to view details",-1)),N[8]||(N[8]=e("p",null,"Choose from the list or create a new one",-1)),E(ie,{type:"primary",size:"large",disabled:!W(p),onClick:we},{default:x(()=>N[6]||(N[6]=[O(" Create New Trial ")])),_:1,__:[6]},8,["disabled"]),W(p)?A("",!0):(o(),d("div",Od," Close other tabs to enable trial creation "))],512)),[[gt,!I.value]]):A("",!0)]),_:1},512),E(Vd,{visible:U.value,"onUpdate:visible":N[0]||(N[0]=fe=>U.value=fe),onTrialImported:z},null,8,["visible"])])}}}),Yd=re(Ud,[["__scopeId","data-v-f189422f"]]);export{Yd as default};

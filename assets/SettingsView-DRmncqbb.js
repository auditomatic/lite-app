import{d as le,r as te,f as U,c as ue,w as ce,o as xe,y as ae,R as g,S as t,k as Q,$ as Y,_ as D,a0 as pe,V as A,u as ve,Z as J,F as de,W as ge,Y as c,a4 as we,G as N,n as M,a7 as Ue,a8 as ie,b as Ee,a2 as L,m as Ie}from"./vue-vendor-DPw1dQYc.js";import{m as Se,n as De,c as K,M as Fe,U as Oe,h as re,u as he,a as I,d as H}from"./index-CMsjb5lT.js";import{u as Ke}from"./useV4Models-BqbvPWaF.js";import{k as _,m as Le,a5 as Be,aF as Ne,a6 as Ve,M as fe}from"./ui-vendor-Cd_RpDPr.js";import"./utils-vendor-CmlljHD3.js";import"./data-vendor-BDABXsBx.js";import"./useV4LiveQuery-CU4Hu5jZ.js";const _e={class:"secure-api-keys-section"},ze={class:"section-header"},qe={class:"security-overview"},Ge={class:"security-status"},We={class:"status-text"},je={class:"security-info-bar"},Je={key:0,class:"first-time-setup"},Ye={key:1,class:"security-summary"},He={class:"default-mode"},Ze={class:"mode"},Qe={class:"key-counts"},Xe={key:0,class:"count-item encrypted"},et={key:1,class:"count-item session"},tt={key:2,class:"count-item plaintext"},st={key:3,class:"count-item none"},nt={key:0,class:"no-providers"},ot={key:1,class:"providers-table"},at={class:"provider-row"},it={class:"provider-name"},lt={class:"provider-status"},rt={class:"security-mode-cell"},ut={class:"api-key-cell"},dt={class:"api-key-input-group"},ct={class:"actions-cell"},pt={class:"provider-details-row"},mt={colspan:"5",class:"provider-details"},yt={class:"detail-info"},vt={key:0},ft={key:1},gt={key:2,class:"custom-url-indicator"},bt=le({__name:"SecureApiKeysSection",props:{onStatusMessage:{type:Function}},setup(Z){const h=Se(),i=De(),{modelsByProvider:l}=Ke(),d=te({}),C=te({}),S=te({}),$=U(!1),m=U(!1),F=U(!1),z=U(!1),r=U(!1),a=U(""),w=U(null),b=U(null),x=U(null),E=U(0),V=ue(()=>{if(E.value,!$.value)return[];const u=K.getAllGroups(),n=[];for(const y of u){if(y==="deterministic")continue;const R=K.getProvidersInGroup(y);if(R.length===0)continue;const G=R[0];if(!K.requiresApiKey(G.id))continue;const oe=h.providers.get(y),v=y.charAt(0).toUpperCase()+y.slice(1),j=R.reduce((ye,be)=>{const ke=l.value[be.id]||[];return ye+ke.length},0),Te=R.reduce((ye,be)=>{const ke=l.value[be.id]||[];return ye+ke.filter(Re=>Re.enabled).length},0);n.push({id:y,name:v,hasApiKey:!!h.getApiKey(y)||p(y),enabled:oe?.enabled??!0,endpoints:R.map(ye=>ye.id),baseUrl:oe?.baseUrl,totalModels:j,enabledModels:Te})}return n}),k=ue(()=>i.securityStatus.value),X=ue(()=>{const u=localStorage.getItem("v3-settings");if(!u)return{};try{const n=JSON.parse(u);return i.secureStorage.detectPlaintextKeys(n)}catch{return{}}});function ee(){return i.hasSetupApiKeySecurity()?!1:(z.value=!0,!0)}function W(u){return i.getEffectiveProviderMode(u)}function p(u){return i.hasApiKey(u)}function T(u){return W(u)==="encrypted"?i.hasApiKey(u)&&!i.isUnlocked.value:!1}function P(u){const n=p(u),y=T(u);return y&&n?"Click to unlock and view encrypted key":y&&!n?"Click to unlock and enter API key":n?"Key configured (hidden)":"Enter API key"}function O(){const{lockedProviderCount:u,sessionProviderCount:n,plaintextProviderCount:y}=k.value,R=u+n+y;return R===0?"none":y===R?"low":u>0?"high":"medium"}function me(){switch(O()){case"high":return"ðŸ”’";case"medium":return"âš ï¸";case"low":return"ðŸ“";default:return"â“"}}function se(){const{lockedProviderCount:u,sessionProviderCount:n,plaintextProviderCount:y}=k.value;if(u+n+y===0)return"No API keys configured";const G=[];return u>0&&G.push(`${u} encrypted`),n>0&&G.push(`${n} session-only`),y>0&&G.push(`${y} plaintext`),G.join(", ")}function o(u){switch(u){case"encrypted":return"ðŸ”’";case"session":return"âš ï¸";case"plaintext":return"ðŸ“";default:return"ðŸ“"}}function e(u){switch(u){case"encrypted":return"Encrypted";case"session":return"Session Only";case"plaintext":return"Unencrypted";default:return"Unencrypted"}}function s(u){S[u]=!S[u]}function f(u){T(u)&&(r.value=!0)}async function B(u,n){if(n==="encrypted"&&!i.hasMasterPassword.value){z.value=!0;return}F.value=!0;try{const y=await i.setProviderSecurityMode(u,n);if(!y.success){_.error(`Failed to change security mode: ${y.error}`);return}d[u]="",C[u]="",_.success(`Security mode changed to ${n}`),E.value++,await ae()}catch(y){const R=y instanceof Error?y.message:"Unknown error";_.error(`Failed to change security mode: ${R}`)}finally{F.value=!1}}async function q(u){const n=C[u];if(!n||ee())return;const y=W(u);if(y==="encrypted"&&!i.isUnlocked.value){r.value=!0,b.value=u,x.value=n;return}m.value=!0;try{const R=await i.setApiKey(u,n,y);R.success?(_.success("API key saved successfully"),C[u]="",E.value++,await ae()):_.error(`Failed to save API key: ${R.error}`)}catch(R){const G=R instanceof Error?R.message:"Unknown error";_.error(`Failed to save API key: ${G}`)}finally{m.value=!1}}async function ne(u){const n=d[u];if(n){m.value=!0;try{h.setApiKey(u,n),i.updateKeyCounts(),_.success("API key saved successfully"),d[u]="",E.value++,await ae()}finally{m.value=!1}}}async function Ce(u){try{await i.clearApiKey(u),h.setApiKey(u,""),i.updateKeyCounts(),d[u]="",C[u]="",_.success("API key cleared"),E.value++,await ae()}catch(n){const y=n instanceof Error?n.message:"Unknown error";_.error(`Failed to clear API key: ${y}`)}}function $e(){i.lock(),_.info("All encrypted keys have been locked")}async function Ae(u){try{const n=await i.unlock(u.password,u.rememberSession);if(n.success){if(r.value=!1,w.value?.handleUnlockSuccess(),_.success("API keys unlocked successfully"),b.value&&x.value){const y=b.value,R=x.value;b.value=null,x.value=null,m.value=!0;try{const G=W(y),oe=await i.setApiKey(y,R,G);oe.success?(_.success("API key saved successfully"),C[y]="",E.value++,await ae()):_.error(`Failed to save API key: ${oe.error}`)}finally{m.value=!1}}}else w.value?.handleUnlockFailure(n.error||"Invalid password")}catch(n){const y=n instanceof Error?n.message:"Unknown error";w.value?.handleUnlockFailure(y)}}function Pe(){fe.confirm({title:"Reset Auditomatic Local Store Password",content:"This will delete all encrypted API keys. You will need to re-enter them. Continue?",okText:"Yes, Reset",okType:"danger",onOk:async()=>{try{localStorage.removeItem("v3-security"),window.location.reload()}catch{_.error("Failed to reset password")}}})}async function Me(u){if(z.value=!1,E.value++,await ae(),b.value&&x.value){const n=b.value,y=x.value;b.value=null,x.value=null,m.value=!0;try{const R=W(n),G=await i.setApiKey(n,y,R);G.success?(_.success("API key saved successfully"),C[n]=""):_.error(`Failed to save API key: ${G.error}`)}finally{m.value=!1}}await ae()}return ce(()=>V.value,u=>{u.forEach(n=>{n.id in d||(d[n.id]=""),n.id in C||(C[n.id]=""),n.id in S||(S[n.id]=!1)})},{immediate:!0}),xe(async()=>{await K.waitForReady(),$.value=!0;const u=i.addEventListener(y=>{(y.type==="api_key_added"||y.type==="api_key_removed")&&E.value++}),n=X.value;return Object.keys(n).length>0&&!i.hasMasterPassword.value&&ae(()=>{_.info({content:`${Object.keys(n).length} API keys found in insecure storage. Consider setting up encryption for better security.`,duration:10})}),()=>{u()}}),(u,n)=>{const y=Le,R=Ve,G=Be,oe=Ne;return c(),g("div",_e,[t("div",ze,[n[6]||(n[6]=t("h2",null,"API Keys",-1)),t("div",qe,[t("div",Ge,[t("span",{class:pe(["security-indicator",O()])},A(me()),3),t("span",We,A(se()),1)]),ve(i).isUnlocked.value?(c(),Y(y,{key:0,size:"small",onClick:$e},{default:J(()=>n[5]||(n[5]=[N(" Lock All ")])),_:1,__:[5]})):D("",!0)])]),t("div",je,[ve(i).hasSetupApiKeySecurity()?(c(),g("div",Ye,[t("div",He,[n[10]||(n[10]=t("span",{class:"label"},"New keys will be stored as:",-1)),t("span",Ze,A(o(ve(i).getDefaultSecurityMode()))+" "+A(e(ve(i).getDefaultSecurityMode())),1),Q(y,{size:"small",onClick:n[1]||(n[1]=v=>z.value=!0)},{default:J(()=>n[9]||(n[9]=[N("Change")])),_:1,__:[9]})]),n[12]||(n[12]=t("div",{class:"divider"},"|",-1)),t("div",Qe,[n[11]||(n[11]=t("span",{class:"label"},"Currently stored:",-1)),k.value.lockedProviderCount>0?(c(),g("span",Xe," ðŸ”’ "+A(k.value.lockedProviderCount)+" encrypted "+A(k.value.lockedProviderCount===1?"key":"keys"),1)):D("",!0),k.value.sessionProviderCount>0?(c(),g("span",et," âš ï¸ "+A(k.value.sessionProviderCount)+" session-only "+A(k.value.sessionProviderCount===1?"key":"keys"),1)):D("",!0),k.value.plaintextProviderCount>0?(c(),g("span",tt," ðŸ“ "+A(k.value.plaintextProviderCount)+" unencrypted "+A(k.value.plaintextProviderCount===1?"key":"keys"),1)):D("",!0),k.value.lockedProviderCount+k.value.sessionProviderCount+k.value.plaintextProviderCount===0?(c(),g("span",st," No API keys stored yet ")):D("",!0)]),!ve(i).isUnlocked.value&&k.value.lockedProviderCount>0?(c(),Y(y,{key:0,type:"primary",size:"small",onClick:n[2]||(n[2]=v=>r.value=!0)},{default:J(()=>[N(" Unlock "+A(k.value.lockedProviderCount)+" key"+A(k.value.lockedProviderCount===1?"":"s"),1)]),_:1})):D("",!0)])):(c(),g("div",Je,[n[8]||(n[8]=t("span",null,"ðŸ”§ First time? Set up your default security mode:",-1)),Q(y,{type:"primary",size:"small",onClick:n[0]||(n[0]=v=>z.value=!0)},{default:J(()=>n[7]||(n[7]=[N("Setup Security")])),_:1,__:[7]})]))]),V.value.length===0?(c(),g("div",nt,n[13]||(n[13]=[t("p",null,"No providers requiring API keys are currently configured.",-1)]))):(c(),g("table",ot,[n[20]||(n[20]=t("thead",null,[t("tr",null,[t("th",null,"Provider"),t("th",null,"Status"),t("th",null,"Security"),t("th",null,"API Key"),t("th",null,"Actions")])],-1)),t("tbody",null,[(c(!0),g(de,null,ge(V.value,v=>(c(),g(de,{key:v.id},[t("tr",at,[t("td",it,[t("strong",null,A(v.name),1)]),t("td",lt,[t("span",{class:pe(["status-badge",{configured:v.hasApiKey}])},A(v.hasApiKey?"âœ“ Configured":"âš ï¸ Not set"),3)]),t("td",rt,[Q(G,{value:W(v.id),onChange:j=>B(v.id,j),class:"security-mode-select-compact",disabled:F.value,size:"small"},{default:J(()=>[Q(R,{value:"encrypted"},{default:J(()=>n[14]||(n[14]=[N(" ðŸ”’ Encrypted ")])),_:1,__:[14]}),Q(R,{value:"session"},{default:J(()=>n[15]||(n[15]=[N(" âš ï¸ Session ")])),_:1,__:[15]}),Q(R,{value:"plaintext"},{default:J(()=>n[16]||(n[16]=[N(" ðŸ“ Unencrypted ")])),_:1,__:[16]})]),_:2},1032,["value","onChange","disabled"])]),t("td",ut,[t("div",dt,[W(v.id)!=="plaintext"?(c(),Y(oe,{key:0,value:C[v.id],"onUpdate:value":j=>C[v.id]=j,type:S[v.id]?"text":"password",placeholder:P(v.id),class:"api-key-input-compact",size:"small",onFocus:j=>f(v.id),onKeyup:we(j=>q(v.id),["enter"])},null,8,["value","onUpdate:value","type","placeholder","onFocus","onKeyup"])):(c(),Y(oe,{key:1,value:d[v.id],"onUpdate:value":j=>d[v.id]=j,type:S[v.id]?"text":"password",placeholder:v.hasApiKey?"Key configured":"Enter API key",class:"api-key-input-compact",size:"small",onKeyup:we(j=>ne(v.id),["enter"])},null,8,["value","onUpdate:value","type","placeholder","onKeyup"])),Q(y,{onClick:j=>s(v.id),size:"small",disabled:T(v.id)},{default:J(()=>[N(A(S[v.id]?"ðŸ™ˆ":"ðŸ‘ï¸"),1)]),_:2},1032,["onClick","disabled"])])]),t("td",ct,[W(v.id)!=="plaintext"?(c(),Y(y,{key:0,onClick:j=>q(v.id),disabled:!C[v.id]||m.value,loading:m.value,type:"primary",size:"small"},{default:J(()=>n[17]||(n[17]=[N(" Save ")])),_:2,__:[17]},1032,["onClick","disabled","loading"])):(c(),Y(y,{key:1,onClick:j=>ne(v.id),disabled:!d[v.id]||m.value,loading:m.value,type:"primary",size:"small"},{default:J(()=>n[18]||(n[18]=[N(" Save ")])),_:2,__:[18]},1032,["onClick","disabled","loading"])),v.hasApiKey||p(v.id)?(c(),Y(y,{key:2,onClick:j=>Ce(v.id),disabled:m.value,size:"small"},{default:J(()=>n[19]||(n[19]=[N(" Clear ")])),_:2,__:[19]},1032,["onClick","disabled"])):D("",!0)])]),t("tr",pt,[t("td",mt,[t("span",yt,[N(A(v.endpoints.length)+" endpoint"+A(v.endpoints.length===1?"":"s")+" Â· ",1),v.hasApiKey?(c(),g("span",vt,A(v.enabledModels)+"/"+A(v.totalModels)+" models enabled ",1)):(c(),g("span",ft,A(v.totalModels)+" models available ",1)),v.baseUrl?(c(),g("span",gt," Â· Custom URL configured")):D("",!0)])])])],64))),128))])])),Q(Fe,{open:z.value,"migration-keys":X.value,onClose:n[3]||(n[3]=v=>z.value=!1),onSuccess:Me},null,8,["open","migration-keys"]),Q(Oe,{open:r.value,"locked-provider-count":k.value.lockedProviderCount,"password-hint":a.value,ref_key:"unlockModalRef",ref:w,onUnlock:Ae,onReset:Pe,onClose:n[4]||(n[4]=v=>r.value=!1)},null,8,["open","locked-provider-count","password-hint"])])}}}),kt=re(bt,[["__scopeId","data-v-d232a39b"]]),St={class:"preferences-section"},ht={class:"preferences-content"},wt={class:"preference-item"},xt={class:"preference-item environmental-costs"},Ct={class:"environmental-options"},$t={class:"checkbox-item mandatory"},At={class:"checkbox-label disabled"},Pt=["checked"],Mt={class:"checkbox-item"},Tt={class:"checkbox-label"},Rt={class:"checkbox-item"},Ut={class:"checkbox-label"},Et=le({__name:"PreferencesSection",props:{onStatusMessage:{type:Function}},setup(Z){const h=he(),i=Se(),l=Z,d=te({theme:"system",showCO2:!0,showWater:!0,showElectricity:!0});ce(()=>h.settings.core.preferences.value,$=>{d.theme=$.theme},{immediate:!0}),ce(()=>i.preferences,$=>{d.showCO2=$.showCO2,d.showWater=$.showWater,d.showElectricity=$.showElectricity},{immediate:!0,deep:!0});async function C(){const $=await h.settings.core.setTheme(d.theme);$.ok?l.onStatusMessage?.("Theme updated","success"):l.onStatusMessage?.(`Failed to update theme: ${$.error.message}`,"error")}async function S(){try{i.setEnvironmentalDisplaySettings({showCO2:d.showCO2,showWater:d.showWater,showElectricity:d.showElectricity}),l.onStatusMessage?.("Environmental display settings updated","success")}catch($){l.onStatusMessage?.(`Failed to update settings: ${$}`,"error")}}return($,m)=>(c(),g("div",St,[m[11]||(m[11]=t("h2",null,"Preferences",-1)),m[12]||(m[12]=t("p",{class:"tab-description"},"Configure application behavior and appearance.",-1)),t("div",ht,[t("div",wt,[m[4]||(m[4]=t("label",{for:"theme-select"},"Theme:",-1)),M(t("select",{id:"theme-select","onUpdate:modelValue":m[0]||(m[0]=F=>d.theme=F),onChange:C,class:"preference-select"},m[3]||(m[3]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)]),544),[[Ue,d.theme]])]),t("div",xt,[m[10]||(m[10]=t("label",null,"Environmental Cost Display:",-1)),t("div",Ct,[t("div",$t,[t("label",At,[t("input",{type:"checkbox",checked:d.showCO2,disabled:"",class:"preference-checkbox"},null,8,Pt),m[5]||(m[5]=t("span",null,"COâ‚‚ Emissions",-1)),m[6]||(m[6]=t("span",{class:"mandatory-badge"},"Always shown",-1))]),m[7]||(m[7]=t("span",{class:"help-text"},"COâ‚‚ tracking cannot be disabled to maintain awareness of climate impact.",-1))]),t("div",Mt,[t("label",Tt,[M(t("input",{type:"checkbox","onUpdate:modelValue":m[1]||(m[1]=F=>d.showWater=F),onChange:S,class:"preference-checkbox"},null,544),[[ie,d.showWater]]),m[8]||(m[8]=t("span",null,"ðŸ’§ Water Usage",-1))])]),t("div",Rt,[t("label",Ut,[M(t("input",{type:"checkbox","onUpdate:modelValue":m[2]||(m[2]=F=>d.showElectricity=F),onChange:S,class:"preference-checkbox"},null,544),[[ie,d.showElectricity]]),m[9]||(m[9]=t("span",null,"âš¡ Electricity Consumption",-1))])])])])])]))}}),It=re(Et,[["__scopeId","data-v-0dac0274"]]),Dt={class:"performance-recorder"},Ft={class:"recorder-controls"},Ot=["disabled"],Kt=["disabled"],Lt=["disabled"],Bt={class:"recorder-status"},Nt={key:0,class:"status recording"},Vt={key:1,class:"status ready"},_t={key:2,class:"status idle"},zt={key:0,class:"export-result"},qt=le({__name:"PerformanceRecorder",setup(Z){const h=U(!1),i=U(!1),l=U([]),d=U(""),C=U(0),S=U(0),$=ue(()=>l.value.length>0);let m=null,F=null,z=null;function r(){h.value?w():a()}function a(){if(h.value=!0,C.value=Date.now(),S.value=0,l.value=[],m=window.setInterval(b,100),F=window.setInterval(()=>{S.value=Math.floor((Date.now()-C.value)/1e3)},1e3),"PerformanceObserver"in window)try{z=new PerformanceObserver(p=>{const T=p.getEntries(),P={};if(T.forEach(O=>{O.entryType==="paint"&&(P[O.name.replace("-","")]=O.startTime),O.entryType==="largest-contentful-paint"&&(P.largestContentfulPaint=O.startTime)}),l.value.length>0){const O=l.value[l.value.length-1];O.paint={...O.paint,...P}}}),z.observe({entryTypes:["paint","largest-contentful-paint"]})}catch{I.warn("Performance Observer not fully supported")}}function w(){h.value=!1,m&&(clearInterval(m),m=null),F&&(clearInterval(F),F=null),z&&(z.disconnect(),z=null),`${l.value.length}`}function b(){try{const p={timestamp:Date.now(),timing:x(),network:E(),userAgent:navigator.userAgent,url:window.location.href,customMetrics:V()};if("memory"in performance){const T=performance.memory;p.memory={used:T.usedJSHeapSize,total:T.totalJSHeapSize,limit:T.jsHeapSizeLimit}}l.value.push(p)}catch(p){I.warn("Failed to collect performance sample:",p)}}function x(){const p=performance.getEntriesByType("navigation")[0];return p?{navigation:p.loadEventEnd-p.fetchStart,domContentLoaded:p.domContentLoadedEventEnd-p.fetchStart,loadComplete:p.loadEventEnd-p.fetchStart}:{navigation:performance.now(),domContentLoaded:0,loadComplete:0}}function E(){const p=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return p?{downlink:p.downlink,effectiveType:p.effectiveType,rtt:p.rtt}:{}}function V(){const p={};p.domNodes=document.querySelectorAll("*").length,p.scripts=document.querySelectorAll("script").length,p.stylesheets=document.querySelectorAll('link[rel="stylesheet"]').length,window.__VUE__&&(p.vueVersion=window.__VUE__.version),window.React&&(p.reactVersion=window.React.version);const T=Array.from(document.querySelectorAll("script[src]"));return p.scriptSources=T.length,p}function k(){const p=[];if(l.value.length===0)return p;const T=l.value,P=T[T.length-1];if(P.memory){const O=P.memory.used/1048576,me=P.memory.limit/(1024*1024),se=O/me*100;se>80?p.push({type:"memory",severity:"critical",description:`Memory usage is ${se.toFixed(1)}% of limit`,value:O,recommendation:"Clear caches, reduce data in memory, check for memory leaks"}):se>60&&p.push({type:"memory",severity:"high",description:`Memory usage is ${se.toFixed(1)}% of limit`,value:O,recommendation:"Monitor memory usage, consider data pagination"})}return P.timing.navigation>3e3&&p.push({type:"timing",severity:"high",description:"Slow page load time",value:P.timing.navigation,recommendation:"Optimize bundle size, lazy load components, check network"}),P.network.rtt&&P.network.rtt>200&&p.push({type:"network",severity:"medium",description:"High network latency",value:P.network.rtt,recommendation:"Check network connection, consider CDN, reduce API calls"}),p}function X(){i.value=!0;try{const p=k(),T={recordingInfo:{startTime:new Date(C.value).toISOString(),duration:S.value,sampleCount:l.value.length,url:window.location.href,userAgent:navigator.userAgent},performanceSummary:{avgMemoryUsage:l.value.filter(P=>P.memory).reduce((P,O)=>P+O.memory.used/(1024*1024),0)/l.value.filter(P=>P.memory).length,totalDOMNodes:l.value[l.value.length-1]?.customMetrics.domNodes,networkInfo:l.value[l.value.length-1]?.network},issues:p,topBottlenecks:p.sort((P,O)=>ee(O.severity)-ee(P.severity)).slice(0,5),detailedSamples:l.value.slice(-10),recommendations:[...new Set(p.map(P=>P.recommendation))]};d.value=JSON.stringify(T,null,2)}catch(p){I.error("Failed to export performance data:",p),d.value=`Export Error: ${p}`}finally{i.value=!1}}function ee(p){return{critical:4,high:3,medium:2,low:1}[p]||0}function W(){l.value=[],d.value="",S.value=0}return Ee(()=>{h.value&&w()}),(p,T)=>(c(),g("div",Dt,[t("div",Ft,[t("button",{onClick:r,class:pe(["record-btn",{recording:h.value}]),disabled:i.value},A(h.value?"Stop Recording":"Start Recording"),11,Ot),t("button",{onClick:X,disabled:!$.value||i.value,class:"export-btn"},A(i.value?"Exporting...":"Export Logs"),9,Kt),t("button",{onClick:W,disabled:!$.value||h.value,class:"clear-btn"}," Clear ",8,Lt)]),t("div",Bt,[h.value?(c(),g("div",Nt," ðŸ”´ Recording... ("+A(S.value)+"s) ",1)):$.value?(c(),g("div",Vt," âœ… "+A(l.value.length)+" samples recorded ",1)):(c(),g("div",_t," â¸ï¸ Ready to record "))]),d.value?(c(),g("div",zt,[T[1]||(T[1]=t("h3",null,"Performance Data Ready",-1)),M(t("textarea",{"onUpdate:modelValue":T[0]||(T[0]=P=>d.value=P),readonly:"",rows:"10",placeholder:"Exported performance data will appear here..."},null,512),[[L,d.value]]),T[2]||(T[2]=t("div",{class:"copy-instructions"}," Copy this data and paste it to Claude for analysis ",-1))])):D("",!0)]))}}),Gt=re(qt,[["__scopeId","data-v-48cb70ff"]]),Wt={class:"advanced-section"},jt={key:0},Jt={key:1},Yt={class:"sub-tabs"},Ht=["onClick"],Zt={class:"sub-tab-content"},Qt={key:0,class:"provider-settings"},Xt={key:0,class:"no-providers"},es={key:0},ts={key:1},ss={key:1,class:"provider-cards"},ns={key:0,class:"provider-advanced-card"},os={class:"setting-group"},as=["onUpdate:modelValue","onChange"],is={class:"setting-group"},ls=["onUpdate:modelValue","onChange"],rs={class:"setting-group"},us=["onUpdate:modelValue","onChange"],ds={class:"setting-group"},cs=["onUpdate:modelValue","onChange"],ps={class:"setting-group"},ms=["onUpdate:modelValue","onChange"],ys={key:1,class:"execution-settings"},vs={class:"settings-grid"},fs={class:"setting-group"},gs={class:"setting-group"},bs={class:"setting-group"},ks={class:"setting-group"},Ss={class:"setting-group"},hs={class:"setting-group"},ws={class:"setting-group"},xs={key:2,class:"discovery-settings"},Cs={class:"settings-grid"},$s={class:"setting-group"},As={class:"setting-group"},Ps={class:"setting-group"},Ms={class:"setting-group"},Ts={key:3,class:"coordination-settings"},Rs={class:"settings-grid"},Us={class:"setting-group"},Es={class:"setting-group"},Is={class:"setting-group"},Ds={class:"setting-group"},Fs={key:4,class:"performance-settings"},Os={class:"settings-grid"},Ks={class:"setting-group"},Ls={class:"setting-group"},Bs={class:"setting-group"},Ns={class:"setting-group"},Vs={key:5,class:"system-settings"},_s=le({__name:"AdvancedSection",props:{onStatusMessage:{type:Function}},setup(Z){const h=he(),i=Se(),l=Z;function d(o,e){l.onStatusMessage&&l.onStatusMessage(o,e)}const C=[{id:"providers",label:"Provider Settings"},{id:"execution",label:"Execution"},{id:"discovery",label:"Discovery"},{id:"coordination",label:"Multi-Tab"},{id:"performance",label:"Performance"},{id:"system",label:"System"}],S=U("providers"),$=U(!1),m=ue(()=>{const o=F.value;return o.length>0&&o.every(e=>r[e.id]&&typeof r[e.id].concurrency=="number")}),F=ue(()=>{try{const o=K.getAllGroups(),e=o.map(s=>{const f=K.getProvidersInGroup(s),B=f.some(q=>K.requiresApiKey(q.id));return{id:s,name:s.charAt(0).toUpperCase()+s.slice(1),requiresApiKey:B,endpoints:f.map(q=>({id:q.id,name:q.name}))}});return e}catch(o){return I.error("Failed to get available provider groups:",o),[]}}),r=te((()=>{try{const o=K.getAllGroups(),e={};return o.forEach(s=>{e[s]={concurrency:2,requestTimeout:30,maxRetries:3,backoffMultiplier:2}}),e}catch(o){return I.error("Failed to initialize provider settings:",o),{}}})());ce(F,async o=>{await K.waitForReady(),o.length,o.forEach(e=>{if(!r[e.id]){const s=K.getProvidersInGroup(e.id),B=s[0]?.execution||{};`${e.id}`,s.map(q=>q.id),r[e.id]={baseUrl:i.getProviderBaseUrl(e.id)||"",concurrency:B.defaultConcurrency||2,requestTimeout:Math.floor((B.timeout||3e4)/1e3),maxRetries:B.maxRetries||3,backoffMultiplier:B.backoffMultiplier||2}}})},{immediate:!0});const a=te({defaultConcurrency:1,defaultTimeout:120,defaultMaxRetries:3,defaultTemperature:.7,batchSize:1,maxConcurrentBatches:2,progressBufferMs:0}),w=te({autoDiscoverOnStartup:!0,discoveryInterval:24,discoveryTimeout:60,skipFailedProviders:!1}),b=te({leaderElectionTimeout:1e3,syncInterval:500,enableBroadcastChannel:!0,enableWebLocks:!0}),x=te({virtualScrollThreshold:1e3,debounceDelay:300,enableRequestIdleCallback:!0,enableProgressiveRendering:!0});xe(async()=>{try{await K.waitForReady();const o=await h.settings.system.getAllSettings(),e=K.getAllGroups();e.length,e.forEach(s=>{const f=K.getProviderExecutionOverrides(s);if(`${s}`,f&&r[s])f.concurrency!==void 0&&(r[s].concurrency=f.concurrency),f.timeout!==void 0&&(r[s].requestTimeout=Math.floor(f.timeout/1e3)),f.maxRetries!==void 0&&(r[s].maxRetries=f.maxRetries),f.backoffMultiplier!==void 0&&(r[s].backoffMultiplier=f.backoffMultiplier);else if(r[s]){const ne=K.getProvidersInGroup(s)[0]?.execution||{};`${s}`,r[s].concurrency=ne.defaultConcurrency||2,r[s].requestTimeout=Math.floor((ne.timeout||3e4)/1e3),r[s].maxRetries=ne.maxRetries||3,r[s].backoffMultiplier=ne.backoffMultiplier||2}}),o.execution&&Object.assign(a,o.execution),o.discovery&&Object.assign(w,o.discovery),o.coordination&&Object.assign(b,o.coordination),o.performance&&Object.assign(x,o.performance),$.value=!0}catch(o){I.error("Failed to initialize advanced settings:",o),$.value=!0}});async function E(o,e){try{const s=e?.trim();if(s)try{new URL(s),i.setProviderBaseUrl(o,s),d("Custom API endpoint saved","success")}catch{d("Invalid URL format. Please enter a valid URL starting with http:// or https://","error"),r[o].baseUrl=i.getProviderBaseUrl(o)||""}else i.setProviderBaseUrl(o,""),d("Custom API endpoint cleared","success")}catch{d("Failed to update custom endpoint","error")}}async function V(o,e,s){try{switch(await K.waitForReady(),e){case"concurrency":K.setProviderConcurrency(o,s);break;case"requestTimeout":K.setProviderTimeout(o,s*1e3);break;case"maxRetries":K.setProviderMaxRetries(o,s);break;case"backoffMultiplier":K.setProviderBackoffMultiplier(o,s);break;default:throw new Error(`Unknown setting: ${e}`)}l.onStatusMessage?.(`Updated ${e} for ${o}`,"success")}catch(f){l.onStatusMessage?.(`Failed to update ${e}: ${f.message}`,"error");const q=K.getProvider(o)?.execution||{};switch(e){case"concurrency":r[o].concurrency=q.defaultConcurrency||2;break;case"requestTimeout":r[o].requestTimeout=Math.floor((q.timeout||3e4)/1e3);break;case"maxRetries":r[o].maxRetries=q.maxRetries||3;break;case"backoffMultiplier":r[o].backoffMultiplier=q.backoffMultiplier||2;break}}}async function k(o,e){const s=await h.settings.system.setExecutionSetting(o,e);s.ok?l.onStatusMessage?.(`Updated ${o}`,"success"):l.onStatusMessage?.(`Failed to update ${o}: ${s.error.message}`,"error")}async function X(o,e){const s=await h.settings.system.setDiscoverySetting(o,e);s.ok?l.onStatusMessage?.(`Updated ${o}`,"success"):l.onStatusMessage?.(`Failed to update ${o}: ${s.error.message}`,"error")}async function ee(o,e){const s=await h.settings.system.setCoordinationSetting(o,e);s.ok?l.onStatusMessage?.(`Updated ${o}`,"success"):l.onStatusMessage?.(`Failed to update ${o}: ${s.error.message}`,"error")}async function W(o,e){const s=await h.settings.system.setPerformanceSetting(o,e);s.ok?l.onStatusMessage?.(`Updated ${o}`,"success"):l.onStatusMessage?.(`Failed to update ${o}: ${s.error.message}`,"error")}function p(){fe.confirm({title:"DELETE ALL DATA WARNING",content:`This will delete ALL data including:

â€¢ All trials and their results
â€¢ All API calls and responses
â€¢ All models and configurations
â€¢ All variable lists and datasets
â€¢ All settings and preferences

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Delete All Data",cancelText:"Cancel",okType:"danger",onOk(){fe.confirm({title:"FINAL WARNING",content:`You are about to delete EVERYTHING.

Click "Proceed" to confirm database deletion.`,okText:"Proceed with Deletion",cancelText:"Cancel",okType:"danger",onOk(){T()}})}})}async function T(){try{await H.transaction("rw",H.tables,async()=>{await Promise.all(H.tables.map(o=>o.clear()))}),localStorage.clear(),sessionStorage.clear(),l.onStatusMessage?.("Database and storage cleared successfully","success"),setTimeout(()=>{window.location.reload()},1500)}catch(o){I.error("Failed to clear database:",o),l.onStatusMessage?.(`Failed to clear database: ${o}`,"error")}}function P(){fe.confirm({title:"FACTORY RESET WARNING",content:`This will completely reset the application to a fresh state.

This will clear:
â€¢ All database data (trials, models, settings, API calls)
â€¢ All localStorage data
â€¢ All sessionStorage data
â€¢ All cookies for this domain
â€¢ All cached data and preferences
â€¢ All API keys and security settings

The app will be restored to first-run state.

This action CANNOT be undone.

Are you absolutely sure?`,okText:"Yes, Reset Everything",cancelText:"Cancel",okType:"danger",onOk(){fe.confirm({title:"FINAL FACTORY RESET WARNING",content:`You will lose EVERYTHING.

All data, settings, API keys, and preferences will be permanently deleted.

Click "Proceed" to confirm factory reset.`,okText:"Proceed with Reset",cancelText:"Cancel",okType:"danger",onOk(){O()}})}})}async function O(){try{if(await H.transaction("rw",H.tables,async()=>{await Promise.all(H.tables.map(o=>o.clear()))}),localStorage.clear(),sessionStorage.clear(),me(),await se(),"caches"in window){const o=await caches.keys();await Promise.all(o.map(e=>caches.delete(e)))}l.onStatusMessage?.("Factory reset completed - all data cleared","success"),setTimeout(()=>{window.location.reload()},2e3)}catch(o){I.error("Failed to perform factory reset:",o),l.onStatusMessage?.(`Factory reset failed: ${o}`,"error")}}function me(){const o=document.cookie.split(";");for(let e of o){const s=e.indexOf("="),f=s>-1?e.substr(0,s).trim():e.trim();document.cookie=`${f}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${f}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;`;const B=window.location.hostname;document.cookie=`${f}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${B}`,document.cookie=`${f}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${B}`}}async function se(){if("indexedDB"in window&&indexedDB.databases)try{const o=await indexedDB.databases();await Promise.all(o.map(e=>{if(e.name)return new Promise((s,f)=>{const B=indexedDB.deleteDatabase(e.name);B.onsuccess=()=>s(),B.onerror=()=>f(B.error)})}))}catch(o){I.warn("Could not clear all IndexedDB databases:",o)}}return(o,e)=>(c(),g("div",Wt,[$.value?(c(),g("div",Jt,[e[99]||(e[99]=t("h2",null,"Advanced Settings",-1)),e[100]||(e[100]=t("p",{class:"tab-description"},"Configure advanced settings for providers, execution, and system performance.",-1)),t("div",Yt,[(c(),g(de,null,ge(C,s=>t("button",{key:s.id,class:pe(["sub-tab",{active:S.value===s.id}]),onClick:f=>S.value=s.id},A(s.label),11,Ht)),64))]),t("div",Zt,[S.value==="providers"?(c(),g("div",Qt,[e[50]||(e[50]=t("h3",null,"Provider-Specific Settings",-1)),e[51]||(e[51]=t("p",{class:"section-description"},"Configure advanced settings for each provider",-1)),m.value?(c(),g("div",ss,[(c(!0),g(de,null,ge(F.value,s=>(c(),g(de,{key:s.id},[s&&r[s.id]?(c(),g("div",ns,[t("h4",null,A(s.name)+" Group",1),e[49]||(e[49]=t("p",{class:"group-description"},"Settings apply to all endpoints in this provider group",-1)),t("div",os,[e[39]||(e[39]=t("label",null,"Custom API Endpoint",-1)),M(t("input",{type:"text","onUpdate:modelValue":f=>r[s.id].baseUrl=f,placeholder:"Use default API endpoint",onChange:f=>E(s.id,r[s.id]?.baseUrl)},null,40,as),[[L,r[s.id].baseUrl]]),e[40]||(e[40]=t("span",{class:"hint"},"Override default API endpoint URL (optional)",-1))]),t("div",is,[e[41]||(e[41]=t("label",null,"Concurrency Limit",-1)),M(t("input",{type:"number","onUpdate:modelValue":f=>r[s.id].concurrency=f,min:"1",max:"100",onChange:f=>V(s.id,"concurrency",r[s.id]?.concurrency)},null,40,ls),[[L,r[s.id].concurrency,void 0,{number:!0}]]),e[42]||(e[42]=t("span",{class:"hint"},"Max parallel requests (1-100)",-1))]),t("div",rs,[e[43]||(e[43]=t("label",null,"Request Timeout (seconds)",-1)),M(t("input",{type:"number","onUpdate:modelValue":f=>r[s.id].requestTimeout=f,min:"10",max:"600",onChange:f=>V(s.id,"requestTimeout",r[s.id]?.requestTimeout)},null,40,us),[[L,r[s.id].requestTimeout,void 0,{number:!0}]]),e[44]||(e[44]=t("span",{class:"hint"},"Time before request fails (10-600s)",-1))]),t("div",ds,[e[45]||(e[45]=t("label",null,"Max Retries",-1)),M(t("input",{type:"number","onUpdate:modelValue":f=>r[s.id].maxRetries=f,min:"0",max:"10",onChange:f=>V(s.id,"maxRetries",r[s.id]?.maxRetries)},null,40,cs),[[L,r[s.id].maxRetries,void 0,{number:!0}]]),e[46]||(e[46]=t("span",{class:"hint"},"Retry attempts on failure (0-10)",-1))]),t("div",ps,[e[47]||(e[47]=t("label",null,"Backoff Multiplier",-1)),M(t("input",{type:"number","onUpdate:modelValue":f=>r[s.id].backoffMultiplier=f,min:"1",max:"5",step:"0.1",onChange:f=>V(s.id,"backoffMultiplier",r[s.id]?.backoffMultiplier)},null,40,ms),[[L,r[s.id].backoffMultiplier,void 0,{number:!0}]]),e[48]||(e[48]=t("span",{class:"hint"},"Exponential backoff factor (1-5)",-1))])])):D("",!0)],64))),128))])):(c(),g("div",Xt,[F.value.length===0?(c(),g("p",es,"No providers are currently configured. Add API keys in the API Keys tab first.")):(c(),g("p",ts,"Loading provider settings..."))]))])):D("",!0),S.value==="execution"?(c(),g("div",ys,[e[66]||(e[66]=t("h3",null,"Execution Settings",-1)),e[67]||(e[67]=t("p",{class:"section-description"},"Configure how trials are executed",-1)),t("div",vs,[t("div",fs,[e[52]||(e[52]=t("label",null,"Default Trial Concurrency",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>a.defaultConcurrency=s),min:"1",max:"20",onChange:e[1]||(e[1]=s=>k("defaultConcurrency",a.defaultConcurrency))},null,544),[[L,a.defaultConcurrency,void 0,{number:!0}]]),e[53]||(e[53]=t("span",{class:"hint"},"Default parallel API calls per trial (1-20)",-1))]),t("div",gs,[e[54]||(e[54]=t("label",null,"Default Timeout (seconds)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>a.defaultTimeout=s),min:"10",max:"600",onChange:e[3]||(e[3]=s=>k("defaultTimeout",a.defaultTimeout))},null,544),[[L,a.defaultTimeout,void 0,{number:!0}]]),e[55]||(e[55]=t("span",{class:"hint"},"Default timeout for all calls (10-600s)",-1))]),t("div",bs,[e[56]||(e[56]=t("label",null,"Default Max Retries",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>a.defaultMaxRetries=s),min:"0",max:"5",onChange:e[5]||(e[5]=s=>k("defaultMaxRetries",a.defaultMaxRetries))},null,544),[[L,a.defaultMaxRetries,void 0,{number:!0}]]),e[57]||(e[57]=t("span",{class:"hint"},"Default retry attempts (0-5)",-1))]),t("div",ks,[e[58]||(e[58]=t("label",null,"Default Temperature",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>a.defaultTemperature=s),min:"0",max:"2",step:"0.1",onChange:e[7]||(e[7]=s=>k("defaultTemperature",a.defaultTemperature))},null,544),[[L,a.defaultTemperature,void 0,{number:!0}]]),e[59]||(e[59]=t("span",{class:"hint"},"Default model temperature (0-2)",-1))]),t("div",Ss,[e[60]||(e[60]=t("label",null,"Batch Size",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>a.batchSize=s),min:"1",max:"1000",onChange:e[9]||(e[9]=s=>k("batchSize",a.batchSize))},null,544),[[L,a.batchSize,void 0,{number:!0}]]),e[61]||(e[61]=t("span",{class:"hint"},"API calls per batch (1-1000, lower = more responsive)",-1))]),t("div",hs,[e[62]||(e[62]=t("label",null,"Max Concurrent Batches",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=s=>a.maxConcurrentBatches=s),min:"1",max:"20",onChange:e[11]||(e[11]=s=>k("maxConcurrentBatches",a.maxConcurrentBatches))},null,544),[[L,a.maxConcurrentBatches,void 0,{number:!0}]]),e[63]||(e[63]=t("span",{class:"hint"},"Batches processed simultaneously (1-20)",-1))]),t("div",ws,[e[64]||(e[64]=t("label",null,"Progress Buffer Delay (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>a.progressBufferMs=s),min:"0",max:"10000",step:"100",onChange:e[13]||(e[13]=s=>k("progressBufferMs",a.progressBufferMs))},null,544),[[L,a.progressBufferMs,void 0,{number:!0}]]),e[65]||(e[65]=t("span",{class:"hint"},"Delay before updating progress (0-10000ms, 0 = immediate)",-1))])])])):D("",!0),S.value==="discovery"?(c(),g("div",xs,[e[74]||(e[74]=t("h3",null,"Model Discovery Settings",-1)),e[75]||(e[75]=t("p",{class:"section-description"},"Configure automatic model discovery",-1)),t("div",Cs,[t("div",$s,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>w.autoDiscoverOnStartup=s),onChange:e[15]||(e[15]=s=>X("autoDiscoverOnStartup",w.autoDiscoverOnStartup))},null,544),[[ie,w.autoDiscoverOnStartup]]),e[68]||(e[68]=N(" Auto-discover models on startup "))])]),t("div",As,[e[69]||(e[69]=t("label",null,"Discovery Interval (hours)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>w.discoveryInterval=s),min:"1",max:"168",onChange:e[17]||(e[17]=s=>X("discoveryInterval",w.discoveryInterval))},null,544),[[L,w.discoveryInterval,void 0,{number:!0}]]),e[70]||(e[70]=t("span",{class:"hint"},"Time between auto-discovery runs (1-168h)",-1))]),t("div",Ps,[e[71]||(e[71]=t("label",null,"Discovery Timeout (seconds)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=s=>w.discoveryTimeout=s),min:"10",max:"300",onChange:e[19]||(e[19]=s=>X("discoveryTimeout",w.discoveryTimeout))},null,544),[[L,w.discoveryTimeout,void 0,{number:!0}]]),e[72]||(e[72]=t("span",{class:"hint"},"Max time for discovery operations (10-300s)",-1))]),t("div",Ms,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[20]||(e[20]=s=>w.skipFailedProviders=s),onChange:e[21]||(e[21]=s=>X("skipFailedProviders",w.skipFailedProviders))},null,544),[[ie,w.skipFailedProviders]]),e[73]||(e[73]=N(" Skip providers that previously failed "))])])])])):D("",!0),S.value==="coordination"?(c(),g("div",Ts,[e[82]||(e[82]=t("h3",null,"Multi-Tab Coordination",-1)),e[83]||(e[83]=t("p",{class:"section-description"},"Configure how multiple tabs work together",-1)),t("div",Rs,[t("div",Us,[e[76]||(e[76]=t("label",null,"Leader Election Timeout (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[22]||(e[22]=s=>b.leaderElectionTimeout=s),min:"100",max:"5000",onChange:e[23]||(e[23]=s=>ee("leaderElectionTimeout",b.leaderElectionTimeout))},null,544),[[L,b.leaderElectionTimeout,void 0,{number:!0}]]),e[77]||(e[77]=t("span",{class:"hint"},"Time to elect new leader tab (100-5000ms)",-1))]),t("div",Es,[e[78]||(e[78]=t("label",null,"Sync Interval (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[24]||(e[24]=s=>b.syncInterval=s),min:"100",max:"2000",onChange:e[25]||(e[25]=s=>ee("syncInterval",b.syncInterval))},null,544),[[L,b.syncInterval,void 0,{number:!0}]]),e[79]||(e[79]=t("span",{class:"hint"},"Tab synchronization frequency (100-2000ms)",-1))]),t("div",Is,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[26]||(e[26]=s=>b.enableBroadcastChannel=s),onChange:e[27]||(e[27]=s=>ee("enableBroadcastChannel",b.enableBroadcastChannel))},null,544),[[ie,b.enableBroadcastChannel]]),e[80]||(e[80]=N(" Enable BroadcastChannel communication "))])]),t("div",Ds,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[28]||(e[28]=s=>b.enableWebLocks=s),onChange:e[29]||(e[29]=s=>ee("enableWebLocks",b.enableWebLocks))},null,544),[[ie,b.enableWebLocks]]),e[81]||(e[81]=N(" Enable Web Locks API "))])])])])):D("",!0),S.value==="performance"?(c(),g("div",Fs,[e[90]||(e[90]=t("h3",null,"UI Performance",-1)),e[91]||(e[91]=t("p",{class:"section-description"},"Optimize UI performance for large datasets and debug performance issues",-1)),Q(Gt),t("div",Os,[t("div",Ks,[e[84]||(e[84]=t("label",null,"Virtual Scrolling Threshold",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=s=>x.virtualScrollThreshold=s),min:"50",max:"10000",onChange:e[31]||(e[31]=s=>W("virtualScrollThreshold",x.virtualScrollThreshold))},null,544),[[L,x.virtualScrollThreshold,void 0,{number:!0}]]),e[85]||(e[85]=t("span",{class:"hint"},"Enable virtual scrolling above this row count (50-10000)",-1))]),t("div",Ls,[e[86]||(e[86]=t("label",null,"Debounce Delay (ms)",-1)),M(t("input",{type:"number","onUpdate:modelValue":e[32]||(e[32]=s=>x.debounceDelay=s),min:"100",max:"1000",onChange:e[33]||(e[33]=s=>W("debounceDelay",x.debounceDelay))},null,544),[[L,x.debounceDelay,void 0,{number:!0}]]),e[87]||(e[87]=t("span",{class:"hint"},"Search/filter debounce delay (100-1000ms)",-1))]),t("div",Bs,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[34]||(e[34]=s=>x.enableRequestIdleCallback=s),onChange:e[35]||(e[35]=s=>W("enableRequestIdleCallback",x.enableRequestIdleCallback))},null,544),[[ie,x.enableRequestIdleCallback]]),e[88]||(e[88]=N(" Use requestIdleCallback for background tasks "))])]),t("div",Ns,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[36]||(e[36]=s=>x.enableProgressiveRendering=s),onChange:e[37]||(e[37]=s=>W("enableProgressiveRendering",x.enableProgressiveRendering))},null,544),[[ie,x.enableProgressiveRendering]]),e[89]||(e[89]=N(" Enable progressive rendering for large results "))])])])])):D("",!0),S.value==="system"?(c(),g("div",Vs,[e[97]||(e[97]=t("h3",null,"System Management",-1)),e[98]||(e[98]=t("p",{class:"section-description"},"Manage database and storage",-1)),t("div",{class:"danger-zone"},[e[96]||(e[96]=t("h4",null,"âš ï¸ Danger Zone",-1)),t("div",{class:"danger-actions"},[t("div",{class:"action-card"},[e[92]||(e[92]=t("h5",null,"Clear All Data",-1)),e[93]||(e[93]=t("p",null,"Delete all trials, models, settings, and API calls from the database. This action cannot be undone.",-1)),t("button",{class:"danger-button",onClick:p}," Delete Database & Store ")]),t("div",{class:"action-card"},[e[94]||(e[94]=t("h5",null,"Factory Reset",-1)),e[95]||(e[95]=t("p",null,"Complete factory reset - clears database, localStorage, sessionStorage, cookies, and all browser data. Restores app to fresh installation state.",-1)),t("button",{class:"danger-button",onClick:P}," Factory Reset Everything ")])])])])):D("",!0)])])):(c(),g("div",jt,e[38]||(e[38]=[t("p",null,"Loading settings...",-1)])))]))}}),zs=re(_s,[["__scopeId","data-v-d8ef7286"]]),qs={class:"import-export-section"},Gs={class:"import-export-content"},Ws={class:"import-section all-data"},js={class:"file-input-wrapper"},Js={class:"import-section"},Ys={class:"file-input-wrapper"},Hs={class:"danger-section"},Zs=["disabled"],Qs=le({__name:"ImportExportSection",props:{onStatusMessage:{type:Function}},setup(Z){const h=he(),i=Z,l=U(),d=U(),C=U(!1);async function S(){const r=await h.settings.core.exportSettings();if(r.ok){const a=new Blob([r.value],{type:"application/json"}),w=URL.createObjectURL(a),b=document.createElement("a");b.href=w,b.download=`auditomatic-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(w),i.onStatusMessage?.("Settings exported successfully","success")}else i.onStatusMessage?.(`Failed to export settings: ${r.error.message}`,"error")}async function $(r){const a=r.target.files?.[0];if(a)try{const w=await a.text(),b=await h.settings.core.importSettings(w);b.ok?(i.onStatusMessage?.("Settings imported successfully","success"),l.value&&(l.value.value="")):i.onStatusMessage?.(`Failed to import settings: ${b.error.message}`,"error")}catch{i.onStatusMessage?.("Failed to read file","error")}}async function m(){if(!confirm("Are you sure you want to reset all settings? This cannot be undone."))return;C.value=!0;const r=await h.settings.core.resetSettings();C.value=!1,r.ok?i.onStatusMessage?.("All settings have been reset","success"):i.onStatusMessage?.(`Failed to reset settings: ${r.error.message}`,"error")}async function F(){try{i.onStatusMessage?.("Exporting all data...","success");const r={version:2,exported:new Date().toISOString(),app:"auditomatic-lite",tables:{}};for(const V of H.tables){const k=V.name;r.tables[k]=await V.toArray()}const a=JSON.stringify(r,null,2),w=(a.length/(1024*1024)).toFixed(2),b=new Blob([a],{type:"application/json"}),x=URL.createObjectURL(b),E=document.createElement("a");E.href=x,E.download=`auditomatic-all-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(x),i.onStatusMessage?.(`All data exported successfully (${w} MB)`,"success")}catch(r){I.error("Failed to export all data:",r),i.onStatusMessage?.(`Failed to export data: ${r}`,"error")}}async function z(r){const a=r.target.files?.[0];if(!a)return;if(!confirm(`WARNING: This will REPLACE ALL existing data with the imported data.

All current trials, models, settings, etc. will be deleted.

Are you absolutely sure?`)){d.value&&(d.value.value="");return}try{i.onStatusMessage?.("Importing all data...","success");const b=await a.text(),x=JSON.parse(b);if(!x.version||!x.tables)throw new Error("Invalid data format");await H.transaction("rw",H.tables,async()=>{await Promise.all(H.tables.map(E=>E.clear()));for(const[E,V]of Object.entries(x.tables)){const k=H[E];k&&Array.isArray(V)&&V.length>0&&await k.bulkAdd(V)}}),i.onStatusMessage?.("All data imported successfully","success"),d.value&&(d.value.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(b){I.error("Failed to import all data:",b),i.onStatusMessage?.(`Failed to import data: ${b}`,"error"),d.value&&(d.value.value="")}}return(r,a)=>(c(),g("div",qs,[a[13]||(a[13]=t("h2",null,"Import & Export",-1)),a[14]||(a[14]=t("p",{class:"tab-description"},"Backup and restore your settings. API keys are masked during export for security.",-1)),t("div",Gs,[t("div",{class:"export-section all-data"},[a[2]||(a[2]=t("h3",null,"ðŸ“¦ Export All Data",-1)),t("button",{onClick:F,class:"btn btn-primary btn-large"}," Export Everything to JSON "),a[3]||(a[3]=t("p",{class:"help-text"},"Downloads ALL data: trials, models, settings, variable lists, datasets, API calls, etc.",-1))]),t("div",Ws,[a[4]||(a[4]=t("h3",null,"ðŸ“¥ Import All Data",-1)),t("div",js,[t("input",{ref_key:"allDataFileInput",ref:d,type:"file",accept:".json",onChange:z,class:"file-input"},null,544),t("button",{onClick:a[0]||(a[0]=()=>d.value&&d.value.click()),class:"btn btn-primary btn-large"}," Import Everything from JSON ")]),a[5]||(a[5]=t("p",{class:"help-text"},"âš ï¸ WARNING: This will REPLACE all existing data with the imported data",-1))]),a[12]||(a[12]=t("hr",{class:"section-divider"},null,-1)),t("div",{class:"export-section"},[a[6]||(a[6]=t("h3",null,"Export Settings Only",-1)),t("button",{onClick:S,class:"btn btn-secondary"}," Export Settings to JSON "),a[7]||(a[7]=t("p",{class:"help-text"},"Downloads a JSON file with your settings (API keys will be masked)",-1))]),t("div",Js,[a[8]||(a[8]=t("h3",null,"Import Settings Only",-1)),t("div",Ys,[t("input",{ref_key:"fileInput",ref:l,type:"file",accept:".json",onChange:$,class:"file-input"},null,544),t("button",{onClick:a[1]||(a[1]=()=>l.value&&l.value.click()),class:"btn btn-secondary"}," Choose File ")]),a[9]||(a[9]=t("p",{class:"help-text"},"Import settings from a previously exported JSON file",-1))]),t("div",Hs,[a[10]||(a[10]=t("h3",null,"Reset Settings",-1)),t("button",{onClick:m,class:"btn btn-danger",disabled:C.value},A(C.value?"Resetting...":"Reset All Settings"),9,Zs),a[11]||(a[11]=t("p",{class:"help-text"},"âš ï¸ This will clear all API keys and reset preferences to defaults",-1))])])]))}}),Xs=re(Qs,[["__scopeId","data-v-7b20deaa"]]),en=le({__name:"StatusMessage",props:{text:{},type:{},duration:{default:5e3}},setup(Z){const h=Z,i=U(!1);let l=null;return ce(()=>h.text,d=>{d&&(i.value=!0,l&&clearTimeout(l),l=setTimeout(()=>{i.value=!1},h.duration))},{immediate:!0}),ce(i,d=>{!d&&l&&(clearTimeout(l),l=null)}),(d,C)=>(c(),Y(Ie,{name:"slide"},{default:J(()=>[i.value?(c(),g("div",{key:0,class:pe(["status-message",d.type])},A(d.text),3)):D("",!0)]),_:1}))}}),tn=re(en,[["__scopeId","data-v-da279e0d"]]),sn={class:"settings-view","data-testid":"page-settings"},nn={class:"tabs"},on=["onClick"],an={class:"tab-content"},ln=le({__name:"SettingsView",setup(Z){const h=[{id:"api-keys",label:"API Keys"},{id:"preferences",label:"Preferences"},{id:"advanced",label:"Advanced"},{id:"import-export",label:"Import/Export"}],i=U("api-keys"),l=U(null);function d(C,S){l.value={text:C,type:S},setTimeout(()=>{l.value?.text===C&&(l.value=null)},5500)}return(C,S)=>(c(),g("div",sn,[S[0]||(S[0]=t("h1",{class:"settings-title"},"Settings",-1)),t("div",nn,[(c(),g(de,null,ge(h,$=>t("button",{key:$.id,class:pe(["tab",{active:i.value===$.id}]),onClick:m=>i.value=$.id},A($.label),11,on)),64))]),t("div",an,[i.value==="api-keys"?(c(),Y(kt,{key:0,"on-status-message":d})):D("",!0),i.value==="preferences"?(c(),Y(It,{key:1,"on-status-message":d})):D("",!0),i.value==="advanced"?(c(),Y(zs,{key:2,"on-status-message":d})):D("",!0),i.value==="import-export"?(c(),Y(Xs,{key:3,"on-status-message":d})):D("",!0)]),l.value?(c(),Y(tn,{key:0,text:l.value.text,type:l.value.type},null,8,["text","type"])):D("",!0)]))}}),vn=re(ln,[["__scopeId","data-v-ea1dc301"]]);export{vn as default};

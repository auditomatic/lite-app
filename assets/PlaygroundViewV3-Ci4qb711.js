import{j as L,u as F,a as U,f as de,g as X,c as Z,C as ue}from"./index-CGnIGpg5.js";import{u as pe}from"./useV4Models-DnrxToiB.js";import{M as ce,G as me}from"./GenericModelSelectorModalV3-ou7_pQdZ.js";import{q as ve,n as Y,an as ge,O as _e,J as ee,ak as te,aR as fe,aJ as be,al as se,aj as he,ap as ye,a5 as $e,a6 as ke,H as Ce,a4 as Se,G as Pe,x as xe}from"./ui-vendor-IRGmExUJ.js";import{d as N,R as u,S as e,G as M,_ as x,k as C,Z as P,Y as s,u as J,V as p,c as j,F as D,W as A,f as T,w as W,a0 as oe,n as q,q as Ie,a2 as Te,y as ne,a7 as Ve,a3 as H,$ as I,A as we,r as Me,o as Re}from"./vue-vendor-DPw1dQYc.js";import{u as le}from"./useV4Templates-CA7edHcF.js";import{c as G,i as K,g as Ee}from"./useHeatmapStylingV3-CCIdVOn4.js";import{u as Oe}from"./useV4ProviderParameters-fbVITf5v.js";import"./utils-vendor-B76-F3_P.js";import"./useV4LiveQuery-Do0jdBW3.js";import"./useCostEstimation-ZltCLeBX.js";import"./useV4CrossTab-CLRmTo15.js";const Le={class:"page-header"},Ne={class:"header-actions"},De={key:0,class:"cost-estimate"},je={class:"cost-tooltip"},ze=N({__name:"PlaygroundHeaderV3",props:{selectedModel:{},estimatedTokens:{},outputTokenLimit:{},disabled:{type:Boolean},loading:{type:Boolean}},emits:["execute"],setup(R){return(r,n)=>{const i=ve,h=Y;return s(),u("div",Le,[n[4]||(n[4]=e("div",{class:"header-content"},[e("h1",null,[M("LLM Playground "),e("span",{class:"description"},"Test one-off prompts and responses")])],-1)),e("div",Ne,[r.selectedModel?(s(),u("div",De,[C(i,{placement:"bottom"},{title:P(()=>[e("div",je,[n[1]||(n[1]=e("div",null,"Cost estimate based on:",-1)),e("div",null,"â€¢ Input: "+p(r.estimatedTokens)+" tokens",1),e("div",null,"â€¢ Output: 10 - "+p(r.outputTokenLimit)+" tokens",1),n[2]||(n[2]=e("div",null,"â€¢ Min assumes 10 token response",-1)),n[3]||(n[3]=e("div",null,"â€¢ Max assumes full response limit",-1))])]),default:P(()=>[C(J(ge),{class:"info-icon"})]),_:1}),C(ce,{model:r.selectedModel,mode:"range","input-tokens":r.estimatedTokens,"min-output-tokens":10,"max-output-tokens":r.outputTokenLimit,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):x("",!0),C(h,{type:"primary",onClick:n[0]||(n[0]=m=>r.$emit("execute")),disabled:r.disabled,loading:r.loading},{default:P(()=>[M(p(r.loading?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])])}}}),Be=L(ze,[["__scopeId","data-v-26164535"]]),Ae={key:0,class:"model-info"},Ue={class:"info-header"},Fe={class:"model-name"},Je={class:"provider-badge"},qe={key:0,class:"info-details"},He={class:"detail-item"},Ge={class:"value"},We={class:"detail-item"},Ye={class:"value"},Qe={class:"dollar-amount"},Xe={class:"detail-item"},Ze={class:"value"},Ke={class:"dollar-amount"},et={class:"detail-item"},tt={class:"value"},st={class:"detail-item"},ot={class:"value"},nt={class:"detail-item"},lt={class:"value"},at=N({__name:"ModelInfoCardV3",props:{model:{}},setup(R){const r=R,n=F(),i=j(()=>n.settings.core.preferences.value);function h(d){return d<.01?d.toFixed(4):d<1?d.toFixed(3):d.toFixed(2)}function m(){if(!r.model?.capabilities?.inputCostPerToken)return"N/A";const d=r.model.capabilities.inputCostPerToken*1e3;return`$${h(d)}`}function y(){if(!r.model?.capabilities?.outputCostPerToken)return"N/A";const d=r.model.capabilities.outputCostPerToken*1e3;return`$${h(d)}`}function o(d){return d?d>=1e6?(d/1e6).toFixed(1)+"M":d>=1e3?(d/1e3).toFixed(0)+"k":d.toString():"N/A"}function S(d){return!r.model||!i.value?.enableEnvironmentalCosts,"??"}return(d,$)=>d.model?(s(),u("div",Ae,[e("div",Ue,[e("span",Fe,p(d.model.displayName),1),e("span",Je,p(d.model.provider),1)]),d.model.capabilities?(s(),u("div",qe,[e("div",He,[$[0]||($[0]=e("span",{class:"label"},"Context:",-1)),e("span",Ge,p(o(d.model.capabilities.contextWindow))+" tokens",1)]),e("div",We,[$[2]||($[2]=e("span",{class:"label"},"Input:",-1)),e("span",Ye,[e("span",Qe,p(m()),1),$[1]||($[1]=M("/1k "))])]),e("div",Xe,[$[4]||($[4]=e("span",{class:"label"},"Output:",-1)),e("span",Ze,[e("span",Ke,p(y()),1),$[3]||($[3]=M("/1k "))])]),e("div",et,[$[5]||($[5]=e("span",{class:"label"},"COâ‚‚: ðŸ­",-1)),e("span",tt,p(S()),1)]),e("div",st,[$[6]||($[6]=e("span",{class:"label"},"Water: ðŸ’§",-1)),e("span",ot,p(S()),1)]),e("div",nt,[$[7]||($[7]=e("span",{class:"label"},"Energy: âš¡",-1)),e("span",lt,p(S()),1)])])):x("",!0)])):x("",!0)}}),rt=L(at,[["__scopeId","data-v-7120cb46"]]),it={class:"left-panel"},dt={class:"panel-section"},ut={class:"panel-section"},pt={class:"action-buttons"},ct={key:0,class:"panel-section"},mt={class:"template-buttons"},vt=N({__name:"PlaygroundLeftPanelV3",props:{selectedModel:{},promptText:{}},emits:["open-model-selector","load-from-design","clear-prompt","load-template"],setup(R){const{templates:r}=le(),n=F(),i=j(()=>{const m=r.value||[],y=n.spreadsheet.prompts.prompts.value||[];return m.length>0||y.length>0}),h=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}];return(m,y)=>{const o=Y;return s(),u("div",it,[e("div",dt,[y[4]||(y[4]=e("h3",null,"Select Model",-1)),C(o,{type:"primary",size:"large",style:{width:"100%"},onClick:y[0]||(y[0]=S=>m.$emit("open-model-selector"))},{default:P(()=>y[3]||(y[3]=[M(" Select Model ")])),_:1,__:[3]}),C(rt,{model:m.selectedModel},null,8,["model"])]),e("div",ut,[y[7]||(y[7]=e("h3",null,"Actions",-1)),e("div",pt,[C(o,{type:"default",onClick:y[1]||(y[1]=S=>m.$emit("load-from-design")),disabled:!i.value,block:""},{default:P(()=>y[5]||(y[5]=[M(" Load from Design ")])),_:1,__:[5]},8,["disabled"]),C(o,{type:"default",onClick:y[2]||(y[2]=S=>m.$emit("clear-prompt")),disabled:!m.promptText,block:""},{default:P(()=>y[6]||(y[6]=[M(" Clear Prompt ")])),_:1,__:[6]},8,["disabled"])])]),m.selectedModel?(s(),u("div",ct,[y[8]||(y[8]=e("h3",null,"Quick Templates",-1)),e("div",mt,[(s(),u(D,null,A(h,S=>C(o,{key:S.name,size:"small",onClick:d=>m.$emit("load-template",S.prompt)},{default:P(()=>[M(p(S.name),1)]),_:2},1032,["onClick"])),64))])])):x("",!0)])}}}),gt=L(vt,[["__scopeId","data-v-83a61b9c"]]),_t={class:"template-editor"},ft=["placeholder","rows","data-testid","aria-label"],bt=N({__name:"TemplateEditorV3",props:{modelValue:{},label:{},placeholder:{default:"Enter your prompt template..."},required:{type:Boolean},rows:{default:4},variables:{default:()=>[]},variableColors:{default:()=>({})}},emits:["update:modelValue"],setup(R,{expose:r,emit:n}){const i=R,h=n,m=T(),y=T(),o=T(!1),S=j({get:()=>i.modelValue,set:l=>h("update:modelValue",l)}),d=j(()=>{let l=$(S.value);return l=l.replace(/\{\{(\w+)\}\}/g,(g,k)=>{const c=/^\w+$/.test(k),_=i.variableColors[k];return c&&_?`<span class="variable-highlight" style="background-color: ${_.bg}; box-shadow: 0 0 0 1px ${_.bg};">${$(g)}</span>`:c?`<span class="variable-highlight">${$(g)}</span>`:`<span class="variable-error">${$(g)}</span>`}),l=l.replace(/\n/g,"<br>"),l=l.replace(/  /g," &nbsp;"),l.endsWith("<br>")||(l+="<br>"),l});function $(l){const g=document.createElement("div");return g.textContent=l,g.innerHTML}function t(){!m.value||!y.value||(y.value.scrollTop=m.value.scrollTop,y.value.scrollLeft=m.value.scrollLeft)}return W(S,async()=>{await ne(),t()}),r({focus:()=>m.value?.focus()}),(l,g)=>{const k=Ie("dompurify-html");return s(),u("div",_t,[e("div",{class:oe(["editor-container",{focused:o.value}])},[q(e("div",{ref_key:"highlightRef",ref:y,class:"editor-highlight","aria-hidden":"true"},null,512),[[k,d.value,"template"]]),q(e("textarea",{ref_key:"textareaRef",ref:m,"onUpdate:modelValue":g[0]||(g[0]=c=>S.value=c),class:"editor-textarea",placeholder:l.placeholder,rows:l.rows,"data-testid":l.$attrs["data-testid"]||"textarea-template-editor","aria-label":l.$attrs["aria-label"]||"Template editor textarea",onFocus:g[1]||(g[1]=c=>o.value=!0),onBlur:g[2]||(g[2]=c=>o.value=!1),onScroll:t},null,40,ft),[[Te,S.value]])],2)])}}}),ht=L(bt,[["__scopeId","data-v-1880e5bc"]]),yt={class:"prompt-section"},$t={class:"section-header"},kt={class:"character-count"},Ct=N({__name:"PromptEditorSectionV3",props:{promptText:{}},emits:["update:prompt-text"],setup(R){return(r,n)=>(s(),u("div",yt,[e("div",$t,[n[1]||(n[1]=e("h3",null,"Prompt",-1)),e("span",kt,p(r.promptText.length)+" characters",1)]),C(ht,{"model-value":r.promptText,"onUpdate:modelValue":n[0]||(n[0]=i=>r.$emit("update:prompt-text",i)),rows:6,placeholder:"Enter your prompt here... No variables or placeholders in the playground, just one prompt at a time.","data-testid":"playground-prompt-editor"},null,8,["model-value"])]))}}),St=L(Ct,[["__scopeId","data-v-dffa2db6"]]),Pt={key:0,class:"logprobs-container"},xt={class:"logprobs-header"},It=["value"],Tt={class:"logprobs-content"},Vt=["onMouseenter"],wt={class:"tooltip-header"},Mt={class:"tooltip-content"},Rt={class:"tooltip-row"},Et={class:"tooltip-value"},Ot={class:"tooltip-row"},Lt={class:"tooltip-value"},Nt={key:0,class:"tooltip-alternatives"},Dt={class:"alt-token"},jt={class:"alt-prob"},zt={class:"logprobs-legend"},Bt={class:"legend-bar"},At=N({__name:"LogprobsDisplay",props:{logprobs:{}},setup(R){const r=T("viridis"),n=T(!1),i=T(null),h=T({}),m=T(null);function y(g){const k=Math.exp(g);return Math.sqrt(k)}function o(g){const k=G[r.value];if(!k)return r.value,{};const c=y(g.logprob),_=K(c,k.colors),V=Ee(_);return{backgroundColor:`${_} !important`,color:`${V} !important`}}function S(g){const k=G[r.value];return k?K(g,k.colors):"transparent"}function d(g){return g===`
`?"\\n":g==="	"?"\\t":g===" "?"Â·":g.trim()===""?`[${g.length} spaces]`:g}function $(g,k){i.value=g,n.value=!0,l(k)}function t(){n.value=!1,i.value=null}function l(g){if(!n.value)return;const k=10,c=g.clientX+k,_=m.value,V=_?_.offsetHeight:100,z=g.clientY-V+k;h.value={position:"fixed",left:`${c}px`,top:`${z}px`,zIndex:"1000"}}return(g,k)=>g.logprobs.hasLogprobs?(s(),u("div",Pt,[e("div",xt,[k[2]||(k[2]=e("h4",null,"Token Probabilities",-1)),q(e("select",{"onUpdate:modelValue":k[0]||(k[0]=c=>r.value=c),class:"color-scale-selector"},[(s(!0),u(D,null,A(J(G),(c,_)=>(s(),u("option",{key:_,value:_},p(c.name),9,It))),128))],512),[[Ve,r.value]])]),e("div",Tt,[(s(!0),u(D,null,A(g.logprobs.content,(c,_)=>(s(),u("span",{key:_,style:H(o(c)),class:"logprob-token",onMouseenter:V=>$(c,V),onMouseleave:t,onMousemove:k[1]||(k[1]=V=>l(V))},p(d(c.token)),45,Vt))),128))]),n.value?(s(),u("div",{key:0,ref_key:"tooltipRef",ref:m,class:"logprob-tooltip",style:H(h.value)},[e("div",wt,[e("strong",null,'"'+p(i.value?.token)+'"',1)]),e("div",Mt,[e("div",Rt,[k[3]||(k[3]=e("span",{class:"tooltip-label"},"Logprob:",-1)),e("span",Et,p(i.value?.logprob?.toFixed(4)),1)]),e("div",Ot,[k[4]||(k[4]=e("span",{class:"tooltip-label"},"Probability:",-1)),e("span",Lt,p((Math.exp(i.value?.logprob||0)*100).toFixed(2))+"%",1)]),i.value?.top_logprobs&&i.value.top_logprobs.length>0?(s(),u("div",Nt,[k[5]||(k[5]=e("div",{class:"tooltip-section-header"},"Top alternatives:",-1)),(s(!0),u(D,null,A(i.value.top_logprobs,c=>(s(),u("div",{key:c.token,class:"tooltip-alt"},[e("span",Dt,'"'+p(d(c.token))+'"',1),e("span",jt,p((Math.exp(c.logprob)*100).toFixed(2))+"%",1)]))),128))])):x("",!0)])],4)):x("",!0),e("div",zt,[e("div",Bt,[(s(),u(D,null,A(10,(c,_)=>e("div",{key:_,style:H({backgroundColor:S(_/9)}),class:"legend-segment"},null,4)),64))]),k[6]||(k[6]=e("div",{class:"legend-labels"},[e("span",null,"Low probability"),e("span",null,"High probability")],-1))])])):x("",!0)}}),Ut=L(At,[["__scopeId","data-v-36cdf50b"]]),Ft={class:"response-display"},Jt={key:0,class:"loading-state"},qt={key:1,class:"error-state"},Ht={class:"error-details"},Gt={key:2,class:"response-content"},Wt={class:"response-text"},Yt={class:"text-content"},Qt={class:"expand-icon"},Xt={class:"metadata-content"},Zt={class:"metadata-grid"},Kt={class:"metadata-item"},es={class:"value"},ts={key:0,class:"metadata-item"},ss={class:"value"},os={key:1,class:"metadata-item"},ns={class:"value"},ls={class:"cost-amount"},as={class:"cost-amount"},rs={class:"cost-amount"},is={class:"metadata-item"},ds={class:"value env-costs"},us={class:"env-item"},ps={class:"env-item"},cs={class:"env-item"},ms={class:"raw-response"},vs={class:"debug-sections"},gs={class:"debug-section"},_s={class:"debug-response"},fs={class:"debug-section"},bs={class:"debug-response"},hs={class:"debug-section"},ys={class:"debug-response"},$s={key:3,class:"empty-state"},ks=N({__name:"ResponseDisplayV3",props:{response:{},isLoading:{type:Boolean},error:{}},setup(R){const r=F(),n=j(()=>r.settings.core.preferences.value),i=T(!1);function h(t){return t<1e-4?t.toFixed(6):t<.01?t.toFixed(4):t.toFixed(3)}function m(t){if(!t)return"No raw response data";try{return JSON.stringify(t,null,2)}catch{return String(t)}}function y(t){if(!t)return"No error details available";try{if(t.debugInfo){const l=t.debugInfo;return`API Request Details:
URL: ${l.url}
Status: ${l.status}

Request Body:
${JSON.stringify(l.requestBody,null,2)}

Response Body:
${JSON.stringify(l.responseBody,null,2)}

Error Details:
${JSON.stringify(l.errorDetails,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`}return t.stack?`Stack Trace:
${t.stack}

Full Error Object:
${JSON.stringify(t,null,2)}`:t.details?`Error Details:
${JSON.stringify(t.details,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`:JSON.stringify(t,null,2)}catch{return String(t)}}function o(t){return n.value?.enableEnvironmentalCosts,"??"}function S(t){if(!t)return"No request data available";try{return JSON.stringify({url:t.url,method:t.method,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function d(t){if(!t)return"No response data available";try{return JSON.stringify({status:t.status,statusText:t.statusText,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function $(t){if(!t)return"No parsing data available";try{return JSON.stringify({providerId:t.providerId,modelId:t.modelId,parameters:t.parameters,parsedResponse:t.parsedResponse,contentExtracted:t.contentExtracted,contentLength:t.contentLength},null,2)}catch{return String(t)}}return(t,l)=>{const g=_e,k=ee,c=se,_=te;return s(),u("div",Ft,[t.isLoading?(s(),u("div",Jt,[C(g,{size:"large"},{tip:P(()=>l[1]||(l[1]=[M("Generating response...")])),_:1})])):t.error?(s(),u("div",qt,[C(k,{type:"error",message:t.error.message||"API Error",description:t.error.details,"show-icon":""},null,8,["message","description"]),t.error?(s(),I(_,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:P(()=>[C(c,{key:"details",header:"Full API Request/Response"},{default:P(()=>[e("pre",Ht,p(y(t.error.response||t.error)),1)]),_:1})]),_:1})):x("",!0)])):t.response?(s(),u("div",Gt,[e("div",Wt,[e("pre",Yt,p(t.response.content),1)]),t.response.logprobs?(s(),I(Ut,{key:0,logprobs:t.response.logprobs},null,8,["logprobs"])):x("",!0),e("div",{class:oe(["response-metadata",{expanded:i.value}])},[e("h3",{class:"metadata-header",onClick:l[0]||(l[0]=V=>i.value=!i.value)},[e("span",Qt,[i.value?(s(),I(J(be),{key:1})):(s(),I(J(fe),{key:0}))]),l[2]||(l[2]=M(" Response Details "))]),q(e("div",Xt,[e("div",Zt,[e("div",Kt,[l[3]||(l[3]=e("span",{class:"label"},"Latency:",-1)),e("span",es,p(t.response.latency)+"ms",1)]),t.response.tokens?(s(),u("div",ts,[l[4]||(l[4]=e("span",{class:"label"},"Token Usage:",-1)),e("span",ss,p(t.response.tokens.prompt_tokens||"?")+" input + "+p(t.response.tokens.completion_tokens||"?")+" output = "+p(t.response.tokens.total_tokens||"?")+" total tokens ",1)])):x("",!0),t.response.cost?(s(),u("div",os,[l[8]||(l[8]=e("span",{class:"label"},"Cost Estimate:",-1)),e("span",ns,[e("span",ls,"$"+p(h(t.response.cost.input)),1),l[5]||(l[5]=M(" input + ")),e("span",as,"$"+p(h(t.response.cost.output)),1),l[6]||(l[6]=M(" output = ")),e("span",rs,"$"+p(h(t.response.cost.total)),1),l[7]||(l[7]=M(" total "))])])):x("",!0),e("div",is,[l[9]||(l[9]=e("span",{class:"label"},"Environmental:",-1)),e("span",ds,[e("span",us,"COâ‚‚ ðŸ­: "+p(o())+"Â Â ",1),e("span",ps,"Water ðŸ’§: "+p(o())+"Â Â ",1),e("span",cs,"Energy âš¡: "+p(o()),1)])])]),C(_,{ghost:"",style:{"margin-top":"16px"}},{default:P(()=>[C(c,{key:"raw",header:"Raw API Response"},{default:P(()=>[e("pre",ms,p(m(t.response.raw)),1)]),_:1})]),_:1}),t.response.debug?(s(),I(_,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:P(()=>[C(c,{key:"debug",header:"ðŸ” Complete API Request/Response Debug"},{default:P(()=>[e("div",vs,[e("div",gs,[l[10]||(l[10]=e("h4",null,"ðŸ“¤ API Request",-1)),e("pre",_s,p(S(t.response.debug.request)),1)]),e("div",fs,[l[11]||(l[11]=e("h4",null,"ðŸ“¥ API Response",-1)),e("pre",bs,p(d(t.response.debug.response)),1)]),e("div",hs,[l[12]||(l[12]=e("h4",null,"âš™ï¸ Response Parser Details",-1)),e("pre",ys,p($(t.response.debug.parsing)),1)])])]),_:1})]),_:1})):x("",!0)],512),[[we,i.value]])],2)])):(s(),u("div",$s,l[13]||(l[13]=[e("div",{class:"empty-content"},[e("div",{class:"empty-icon"},"ðŸ’¬"),e("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),Cs=L(ks,[["__scopeId","data-v-70d773b1"]]),Ss={key:0,class:"response-section"},Ps={class:"section-header"},xs={key:0,class:"response-meta"},Is={class:"response-container"},Ts=N({__name:"ResponseSectionV3",props:{hasExecuted:{type:Boolean},response:{},error:{},isLoading:{type:Boolean}},setup(R){return(r,n)=>r.hasExecuted?(s(),u("div",Ss,[e("div",Ps,[n[0]||(n[0]=e("h3",null,"Response",-1)),r.response&&!r.error?(s(),u("div",xs,[e("span",null,p(r.response.latency)+"ms",1),e("span",null,p(r.response.tokens?.total_tokens||"?")+" tokens",1)])):x("",!0)]),e("div",Is,[C(Cs,{response:r.response,"is-loading":r.isLoading,error:r.error},null,8,["response","is-loading","error"])])])):x("",!0)}}),Vs=L(Ts,[["__scopeId","data-v-cf6c2814"]]),ws={class:"center-panel"},Ms=N({__name:"PlaygroundCenterPanelV3",props:{promptText:{},hasExecuted:{type:Boolean},response:{},error:{},isExecuting:{type:Boolean}},emits:["update:prompt-text"],setup(R){return(r,n)=>(s(),u("div",ws,[C(St,{"prompt-text":r.promptText,"onUpdate:promptText":n[0]||(n[0]=i=>r.$emit("update:prompt-text",i))},null,8,["prompt-text"]),C(Vs,{"has-executed":r.hasExecuted,response:r.response,error:r.error,"is-loading":r.isExecuting},null,8,["has-executed","response","error","is-loading"])]))}}),Rs=L(Ms,[["__scopeId","data-v-e48f18da"]]),Es={class:"parameter-panel"},Os={key:0,class:"params-section"},Ls={key:0,class:"reasoning-warning"},Ns={key:0,class:"json-error"},Ds={key:7,class:"param-description"},js={key:0,class:"json-error"},zs={key:6,class:"param-description"},Bs={class:"panel-actions"},As=N({__name:"ModelParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(R,{emit:r}){const n=R,i=r,{getBasicParameters:h,getAdvancedParameters:m,getUIDefaults:y}=Oe(),o=Me({}),S=j(()=>n.model?h(n.model.provider,n.model.modelId):{}),d=j(()=>n.model?m(n.model.provider,n.model.modelId):{}),$=j(()=>n.model?(n.model.provider==="openai-chat"||n.model.provider==="openai-responses")&&(n.model.modelId.match(/^o[0-9]/)||n.model.modelId.match(/^gpt-5/)):!1);function t(c,_){o[c]=_,i("update:modelValue",{...o}),i("change",{...o})}function l(c,_){try{if(!_.trim()){t(c,null),delete o[c+"_json_error"];return}const V=JSON.parse(_);t(c,V),delete o[c+"_json_error"]}catch{o[c+"_json_error"]="Invalid JSON format"}}function g(c){return c.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())}function k(){if(!n.model)return;Object.keys(o).forEach(E=>delete o[E]);const c=y(n.model.provider,n.model.modelId);Object.assign(o,c);const _=h(n.model.provider,n.model.modelId),V=m(n.model.provider,n.model.modelId),z={..._,...V};for(const[E,O]of Object.entries(z))O.fixed&&O.default!==void 0&&(o[E]=O.default,O.default);for(const[E,O]of Object.entries(z))O.type==="object"&&o[E]&&(o[E+"_json"]=JSON.stringify(o[E],null,2));i("update:modelValue",{...o}),i("change",{...o})}return W(()=>n.model,c=>{c&&k()},{immediate:!0}),W(()=>n.modelValue,c=>{Object.assign(o,c)},{immediate:!0,deep:!0}),(c,_)=>{const V=ee,z=he,E=ye,O=ke,v=$e,w=Ce,B=Se,Q=Pe,ae=se,re=te,ie=Y;return s(),u("div",Es,[Object.keys(S.value).length>0?(s(),u("div",Os,[_[1]||(_[1]=e("h4",null,"Basic Parameters",-1)),$.value?(s(),u("div",Ls,[C(V,{message:"Reasoning models (O* and GPT-5*) do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):x("",!0),(s(!0),u(D,null,A(S.value,(a,f)=>(s(),I(Q,{key:f,label:g(f)},{default:P(()=>[a.type==="number"?(s(),I(z,{key:0,value:o[f],onChange:b=>t(f,b),min:a.min,max:a.max,step:a.step||.1,placeholder:String(a.default),disabled:a.fixed,size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder","disabled"])):a.type==="integer"?(s(),I(z,{key:1,value:o[f],onChange:b=>t(f,b),min:a.min,max:a.max,placeholder:String(a.default),disabled:a.fixed,size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder","disabled"])):a.type==="boolean"?(s(),I(E,{key:2,checked:o[f],onChange:b=>t(f,b),"checked-children":"true","un-checked-children":"false",disabled:a.fixed},null,8,["checked","onChange","disabled"])):a.type==="string"&&a.enum?(s(),I(v,{key:3,value:o[f],onChange:b=>t(f,b),placeholder:a.default?String(a.default):"<not set>",disabled:a.fixed,size:"large",style:{width:"100%"},allowClear:""},{default:P(()=>[C(O,{value:void 0},{default:P(()=>_[0]||(_[0]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[0]}),(s(!0),u(D,null,A(a.enum,b=>(s(),I(O,{key:b,value:b},{default:P(()=>[M(p(b),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder","disabled"])):a.type==="array"?(s(),I(v,{key:4,value:o[f],"onUpdate:value":b=>o[f]=b,mode:"tags",placeholder:a.default?String(a.default):"Enter values",disabled:a.fixed,size:"large",style:{width:"100%"},onChange:b=>t(f,b)},null,8,["value","onUpdate:value","placeholder","disabled","onChange"])):a.type==="object"?(s(),u(D,{key:5},[C(w,{value:o[f+"_json"],"onUpdate:value":b=>o[f+"_json"]=b,placeholder:JSON.stringify(a.default||{},null,2),disabled:a.fixed,rows:3,status:o[f+"_json_error"]?"error":"",onInput:b=>l(f,b.target.value)},null,8,["value","onUpdate:value","placeholder","disabled","status","onInput"]),o[f+"_json_error"]?(s(),u("div",Ns,p(o[f+"_json_error"]),1)):x("",!0)],64)):a.type==="string"?(s(),I(B,{key:6,value:o[f],onChange:b=>t(f,b.target.value),placeholder:String(a.default),disabled:a.fixed,size:"large"},null,8,["value","onChange","placeholder","disabled"])):x("",!0),a.description?(s(),u("div",Ds,p(a.description),1)):x("",!0)]),_:2},1032,["label"]))),128))])):x("",!0),Object.keys(d.value).length>0?(s(),I(re,{key:1,ghost:""},{default:P(()=>[C(ae,{key:"advanced",header:"Advanced Parameters"},{default:P(()=>[(s(!0),u(D,null,A(d.value,(a,f)=>(s(),I(Q,{key:f,label:g(f)},{default:P(()=>[a.type==="number"||a.type==="integer"?(s(),I(z,{key:0,value:o[f],onChange:b=>t(f,b),min:a.min,max:a.max,step:a.type==="number"?a.step||.1:1,placeholder:String(a.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):a.type==="boolean"?(s(),I(E,{key:1,checked:o[f],onChange:b=>t(f,b),"checked-children":"true","un-checked-children":"false",disabled:a.fixed},null,8,["checked","onChange","disabled"])):a.type==="string"&&a.enum?(s(),I(v,{key:2,value:o[f],onChange:b=>t(f,b),placeholder:a.default?String(a.default):"<not set>",disabled:a.fixed,size:"large",style:{width:"100%"},allowClear:""},{default:P(()=>[C(O,{value:void 0},{default:P(()=>_[2]||(_[2]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[2]}),(s(!0),u(D,null,A(a.enum,b=>(s(),I(O,{key:b,value:b},{default:P(()=>[M(p(b),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder","disabled"])):a.type==="array"?(s(),I(v,{key:3,value:o[f],"onUpdate:value":b=>o[f]=b,mode:"tags",placeholder:a.default?String(a.default):"Enter values",disabled:a.fixed,size:"large",style:{width:"100%"},onChange:b=>t(f,b)},null,8,["value","onUpdate:value","placeholder","disabled","onChange"])):a.type==="object"?(s(),u(D,{key:4},[C(w,{value:o[f+"_json"],"onUpdate:value":b=>o[f+"_json"]=b,placeholder:JSON.stringify(a.default||{},null,2),disabled:a.fixed,rows:3,status:o[f+"_json_error"]?"error":"",onInput:b=>l(f,b.target.value)},null,8,["value","onUpdate:value","placeholder","disabled","status","onInput"]),o[f+"_json_error"]?(s(),u("div",js,p(o[f+"_json_error"]),1)):x("",!0)],64)):a.type==="string"?(s(),I(B,{key:5,value:o[f],onChange:b=>t(f,b.target.value),placeholder:String(a.default),disabled:a.fixed,size:"large"},null,8,["value","onChange","placeholder","disabled"])):x("",!0),a.description?(s(),u("div",zs,p(a.description),1)):x("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):x("",!0),e("div",Bs,[C(ie,{onClick:k,size:"small"},{default:P(()=>_[3]||(_[3]=[M(" Reset to Defaults ")])),_:1,__:[3]})])])}}}),Us=L(As,[["__scopeId","data-v-bbc76c6d"]]),Fs={class:"right-panel"},Js={class:"panel-header"},qs={key:0},Hs={key:1},Gs={key:0,class:"panel-content"},Ws={key:1,class:"no-model-message"},Ys=N({__name:"PlaygroundRightPanelV3",props:{model:{},parameters:{}},emits:["update:parameters","parameters-change"],setup(R,{emit:r}){const n=r;function i(h){n("update:parameters",h),n("parameters-change",h)}return(h,m)=>(s(),u("div",Fs,[e("div",Js,[h.model?(s(),u("h3",qs,p(h.model.displayName),1)):(s(),u("h3",Hs,"Select a Model"))]),h.model?(s(),u("div",Gs,[C(Us,{model:h.model,modelValue:h.parameters,"onUpdate:modelValue":i,onChange:i},null,8,["model","modelValue"])])):(s(),u("div",Ws,m[0]||(m[0]=[e("p",null,"Choose a model from the left panel to configure parameters.",-1)])))]))}}),Qs=L(Ys,[["__scopeId","data-v-a054623d"]]),Xs={class:"design-list"},Zs=["onClick"],Ks={class:"design-name"},eo={class:"design-description"},to={class:"design-preview"},so={class:"design-type"},oo=N({__name:"DesignSelectorModalV3",props:{open:{type:Boolean}},emits:["close","select"],setup(R,{emit:r}){const n=r,{templates:i}=le(),h=F(),m=j(()=>{const o=i.value||[],S=h.spreadsheet.prompts.prompts.value||[];return[...o.map(d=>({id:d.id,name:d.name,description:d.description,text:d.template,type:"template"})),...S.map(d=>({id:d.id,name:d.name,description:d.description,text:d.promptPattern,type:"spreadsheet"}))]});function y(o){n("select",o),n("close")}return(o,S)=>{const d=xe;return s(),I(d,{open:o.open,title:"Load from Design",width:"800px",footer:null,onCancel:S[0]||(S[0]=$=>o.$emit("close"))},{default:P(()=>[e("div",Xs,[(s(!0),u(D,null,A(m.value,$=>(s(),u("div",{key:$.id,class:"design-item",onClick:t=>y($)},[e("div",Ks,p($.name),1),e("div",eo,p($.description||"No description"),1),e("div",to,p($.text.substring(0,100))+"...",1),e("div",so,p($.type),1)],8,Zs))),128))])]),_:1},8,["open"])}}}),no=L(oo,[["__scopeId","data-v-13319aee"]]),lo={class:"playground-view","data-testid":"page-playground"},ao={class:"playground-content"},ro=N({__name:"PlaygroundViewV3",setup(R){const{enabledModels:r}=pe(),n=F(),i=T(null),h=T(""),m=T({}),y=T(!1),o=T(!1),S=T(!1),d=T(!1),$=T(null),t=T(null),l=j(()=>i.value&&h.value.trim().length>0&&!d.value),g=j(()=>h.value?de().estimateTokens(h.value):0),k=j(()=>i.value?X().getOutputTokenLimit(i.value.provider,i.value.modelId,m.value):0);function c(v){m.value={...v},m.value}function _(v){h.value=v.text}function V(v){h.value=v}function z(){h.value=""}function E(v){i.value=v,o.value=!1;const w=X();m.value=w.applyDefaults(v.provider,v.modelId,{}),Z.supportsLogprobs(v.provider,v.modelId)&&(`${v.provider}${v.modelId}`,ne(()=>{m.value.logprobs=!0,m.value.top_logprobs=5,m.value}))}async function O(){if(!(!l.value||!i.value)){S.value=!0,d.value=!0,$.value=null,t.value=null;try{const v=await n.executeSingleCall(h.value,0,{provider:i.value.provider,modelId:i.value.modelId,...m.value});v.ok?($.value={content:v.value.content||"",latency:ue(v.value.latency),tokens:v.value.usage,cost:v.value.cost,logprobs:v.value.logprobs,features:v.value.features,raw:v.value.raw,debug:v.value.debug,model:i.value},v.value.logprobs):t.value={message:v.error?.message||"Failed to execute prompt",details:v.error?.details||v.error?.stack||v.error,response:v.error,debugInfo:v.error?.debugInfo}}catch(v){t.value={message:v.message||"An unexpected error occurred",details:v.stack||v.toString(),response:v}}finally{d.value=!1}}}return Re(async()=>{setTimeout(()=>{!i.value&&r.value&&r.value.length>0&&(i.value=r.value[0],Z.supportsLogprobs(i.value.provider,i.value.modelId)&&(`${i.value.provider}${i.value.modelId}`,setTimeout(()=>{m.value.logprobs=!0,m.value.top_logprobs=5,m.value},200)))},100)}),(v,w)=>(s(),u("div",lo,[C(Be,{"selected-model":i.value,"estimated-tokens":g.value,"output-token-limit":k.value,disabled:!l.value,loading:d.value,onExecute:O},null,8,["selected-model","estimated-tokens","output-token-limit","disabled","loading"]),e("div",ao,[C(gt,{"selected-model":i.value,"prompt-text":h.value,onOpenModelSelector:w[0]||(w[0]=B=>o.value=!0),onLoadFromDesign:w[1]||(w[1]=B=>y.value=!0),onClearPrompt:z,onLoadTemplate:V},null,8,["selected-model","prompt-text"]),C(Rs,{"prompt-text":h.value,"has-executed":S.value,response:$.value,error:t.value,"is-executing":d.value,"onUpdate:promptText":w[2]||(w[2]=B=>h.value=B)},null,8,["prompt-text","has-executed","response","error","is-executing"]),C(Qs,{model:i.value,parameters:m.value,"onUpdate:parameters":w[3]||(w[3]=B=>m.value=B),onParametersChange:c},null,8,["model","parameters"])]),C(no,{open:y.value,onClose:w[4]||(w[4]=B=>y.value=!1),onSelect:_},null,8,["open"]),C(me,{visible:o.value,mode:"playground",title:"Select Model","onUpdate:visible":w[5]||(w[5]=B=>o.value=B),onSelectModel:E},null,8,["visible"])]))}}),$o=L(ro,[["__scopeId","data-v-df7dc143"]]);export{$o as default};

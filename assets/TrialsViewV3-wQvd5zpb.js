const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/trial-bundle.service-BYIC7Z5S.js","assets/index-DRpbUgPt.js","assets/vue-vendor-DPw1dQYc.js","assets/ui-vendor-Cd_RpDPr.js","assets/utils-vendor-CmlljHD3.js","assets/data-vendor-BDABXsBx.js","assets/index-cTUJCLSS.css","assets/python-bundle-management-Bg7X5D00.js"])))=>i.map(i=>d[i]);
var Zt=Object.defineProperty;var es=(l,t,s)=>t in l?Zt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s;var re=(l,t,s)=>es(l,typeof t!="symbol"?t+"":t,s);import{h as ae,a as E,u as Qe,d as We,b as at,_ as Je}from"./index-DRpbUgPt.js";import{d as le,f as j,c as M,o as ce,b as ge,w as oe,R as i,a0 as se,S as e,_ as P,a9 as Te,a3 as me,Y as o,y as ye,aa as ts,ab as ss,ac as as,$ as Y,ad as ls,ae as os,af as vt,q as mt,n as $e,k as C,Z as F,F as Z,W as te,a5 as lt,ag as ns,ah as is,u as H,a4 as He,V as _,G as L,s as Ce,M as we,ai as Se,U as gt,A as ht,aj as rs,B as _t,r as us,a7 as ds,a1 as yt,X as xe,a6 as Be}from"./vue-vendor-DPw1dQYc.js";import{aH as bt,C as Tt,aS as cs,m as pe,G as ps,aT as $t,aU as fs,J as Ye,az as vs,N as Xe,O as Ze,V as ms,a1 as Ct,P as ot,aV as gs,aa as hs,av as _s,aM as kt,K as ys,aI as bs,Y as Ts,Q as et,I as $s,u as Cs,M as be,ax as wt,aN as ke,T as tt,q as De,D as ks,k as X,aJ as ws,am as St,a5 as Ss,a6 as Is,a4 as It,aW as Rs,w as Rt,E as Pt,ak as Ps,al as Es,a7 as Vs,o as As,ap as Fs,s as xs,a2 as Ds,a3 as Ls,aX as Ne,y as Os,v as Ms,au as Et,aw as Us,aY as Vt,z as Ns,a0 as zs}from"./ui-vendor-Cd_RpDPr.js";import{b as At}from"./utils-vendor-CmlljHD3.js";import{u as Ft}from"./useCostEstimation-hLwBrRCc.js";import{P as Ws}from"./ParserSelector-CnbS-52V.js";import{u as Hs}from"./parser.store-CVGw7eva.js";import{v as nt,b as xt,u as Bs,a as js,c as qs}from"./useV4TrialCommands-HUBTIO5M.js";import{u as Gs}from"./useHeatmapStylingV3-CCIdVOn4.js";import{u as Ks}from"./useV4Models-Dj3KEEJy.js";import"./data-vendor-BDABXsBx.js";import"./useV4LiveQuery-CU4Hu5jZ.js";const Qs={class:"right-panel"},Js=le({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(l,{expose:t,emit:s}){const p=l,f=s,d=j(p.defaultWidth),m=j(!1),k=j(0),S=j(0),r=j(window.innerWidth),w=j(!1),y=M(()=>r.value<p.mobileBreakpoint),v=M(()=>y.value?{width:`${Math.min(r.value*.85,400)}px`}:{width:`${d.value}px`});function I(){const n=localStorage.getItem(p.storageKey);if(n){const g=parseInt(n,10);!isNaN(g)&&g>=p.minWidth&&g<=p.maxWidth&&(d.value=g)}}function T(n){localStorage.setItem(p.storageKey,n.toString()),f("resize",n)}function $(n){m.value=!0,k.value=n.clientX,S.value=d.value,document.addEventListener("mousemove",D),document.addEventListener("mouseup",z),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function D(n){if(!m.value)return;const g=n.clientX-k.value,K=Math.max(p.minWidth,Math.min(p.maxWidth,S.value+g));d.value=K}function z(){m.value&&(m.value=!1,T(d.value),document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",z),document.body.style.userSelect="",document.body.style.cursor="")}function A(){d.value=p.defaultWidth,T(p.defaultWidth)}function u(){r.value=window.innerWidth,!y.value&&w.value&&(w.value=!1,f("mobile-overlay-change",!1))}function c(){y.value&&(w.value=!w.value,f("mobile-overlay-change",w.value))}function R(){w.value=!1,f("mobile-overlay-change",!1)}return t({toggleMobileOverlay:c,closeMobileOverlay:R}),ce(()=>{I(),window.addEventListener("resize",u)}),ge(()=>{window.removeEventListener("resize",u),z()}),oe(()=>p.defaultWidth,n=>{d.value===p.defaultWidth&&(d.value=n)}),(n,g)=>(o(),i("div",{class:se(["resizable-panel-container",{"mobile-overlay":y.value}])},[e("div",{class:se(["left-panel",{"overlay-visible":y.value&&w.value}]),style:me(v.value)},[Te(n.$slots,"left",{},void 0,!0)],6),y.value?P("",!0):(o(),i("div",{key:0,class:se(["resize-handle",{dragging:m.value}]),onMousedown:$,onDblclick:A},g[0]||(g[0]=[e("div",{class:"handle-bar"},null,-1)]),34)),e("div",Qs,[Te(n.$slots,"right",{},void 0,!0)]),y.value&&w.value?(o(),i("div",{key:1,class:"mobile-overlay-bg",onClick:R})):P("",!0)],2))}}),Ys=ae(Js,[["__scopeId","data-v-949e1df1"]]);function Xs(){var l=window.navigator.userAgent,t=l.indexOf("MSIE ");if(t>0)return parseInt(l.substring(t+5,l.indexOf(".",t)),10);var s=l.indexOf("Trident/");if(s>0){var p=l.indexOf("rv:");return parseInt(l.substring(p+3,l.indexOf(".",p)),10)}var f=l.indexOf("Edge/");return f>0?parseInt(l.substring(f+5,l.indexOf(".",f)),10):-1}let Pe;function je(){je.init||(je.init=!0,Pe=Xs()!==-1)}var Le={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){je(),ye(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const l=document.createElement("object");this._resizeObject=l,l.setAttribute("aria-hidden","true"),l.setAttribute("tabindex",-1),l.onload=this.addResizeHandlers,l.type="text/html",Pe&&this.$el.appendChild(l),l.data="about:blank",Pe||this.$el.appendChild(l)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Pe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Zs=as();ts("data-v-b329ee4c");const ea={class:"resize-observer",tabindex:"-1"};ss();const ta=Zs((l,t,s,p,f,d)=>(o(),Y("div",ea)));Le.render=ta;Le.__scopeId="data-v-b329ee4c";Le.__file="src/components/ResizeObserver.vue";function Ee(l){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ee=function(t){return typeof t}:Ee=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(l)}function sa(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function aa(l,t){for(var s=0;s<t.length;s++){var p=t[s];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(l,p.key,p)}}function la(l,t,s){return t&&aa(l.prototype,t),l}function it(l){return oa(l)||na(l)||ia(l)||ra()}function oa(l){if(Array.isArray(l))return qe(l)}function na(l){if(typeof Symbol<"u"&&Symbol.iterator in Object(l))return Array.from(l)}function ia(l,t){if(l){if(typeof l=="string")return qe(l,t);var s=Object.prototype.toString.call(l).slice(8,-1);if(s==="Object"&&l.constructor&&(s=l.constructor.name),s==="Map"||s==="Set")return Array.from(l);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return qe(l,t)}}function qe(l,t){(t==null||t>l.length)&&(t=l.length);for(var s=0,p=new Array(t);s<t;s++)p[s]=l[s];return p}function ra(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ua(l){var t;return typeof l=="function"?t={callback:l}:t=l,t}function da(l,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},p,f,d,m=function(S){for(var r=arguments.length,w=new Array(r>1?r-1:0),y=1;y<r;y++)w[y-1]=arguments[y];if(d=w,!(p&&S===f)){var v=s.leading;typeof v=="function"&&(v=v(S,f)),(!p||S!==f)&&v&&l.apply(void 0,[S].concat(it(d))),f=S,clearTimeout(p),p=setTimeout(function(){l.apply(void 0,[S].concat(it(d))),p=0},t)}};return m._clear=function(){clearTimeout(p),p=null},m}function Dt(l,t){if(l===t)return!0;if(Ee(l)==="object"){for(var s in l)if(!Dt(l[s],t[s]))return!1;return!0}return!1}var ca=(function(){function l(t,s,p){sa(this,l),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(s,p)}return la(l,[{key:"createObserver",value:function(s,p){var f=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=ua(s),this.callback=function(k,S){f.options.callback(k,S),k&&f.options.once&&(f.frozen=!0,f.destroyObserver())},this.callback&&this.options.throttle){var d=this.options.throttleOptions||{},m=d.leading;this.callback=da(this.callback,this.options.throttle,{leading:function(S){return m==="both"||m==="visible"&&S||m==="hidden"&&!S}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(k){var S=k[0];if(k.length>1){var r=k.find(function(y){return y.isIntersecting});r&&(S=r)}if(f.callback){var w=S.isIntersecting&&S.intersectionRatio>=f.threshold;if(w===f.oldResult)return;f.oldResult=w,f.callback(w,S)}},this.options.intersection),ye(function(){f.observer&&f.observer.observe(f.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),l})();function Lt(l,t,s){var p=t.value;if(p)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var f=new ca(l,p,s);l._vue_visibilityState=f}}function pa(l,t,s){var p=t.value,f=t.oldValue;if(!Dt(p,f)){var d=l._vue_visibilityState;if(!p){Ot(l);return}d?d.createObserver(p,s):Lt(l,{value:p},s)}}function Ot(l){var t=l._vue_visibilityState;t&&(t.destroyObserver(),delete l._vue_visibilityState)}var fa={beforeMount:Lt,updated:pa,unmounted:Ot},va={itemsLimit:1e3},ma=/(auto|scroll)/;function Mt(l,t){return l.parentNode===null?t:Mt(l.parentNode,t.concat([l]))}var ze=function(t,s){return getComputedStyle(t,null).getPropertyValue(s)},ga=function(t){return ze(t,"overflow")+ze(t,"overflow-y")+ze(t,"overflow-x")},ha=function(t){return ma.test(ga(t))};function rt(l){if(l instanceof HTMLElement||l instanceof SVGElement){for(var t=Mt(l.parentNode,[]),s=0;s<t.length;s+=1)if(ha(t[s]))return t[s];return document.scrollingElement||document.documentElement}}function Ge(l){"@babel/helpers - typeof";return Ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(l)}var _a={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function ya(){return this.items.length&&Ge(this.items[0])!=="object"}var Ke=!1;if(typeof window<"u"){Ke=!1;try{var ba=Object.defineProperty({},"passive",{get:function(){Ke=!0}});window.addEventListener("test",null,ba)}catch{}}let Ta=0;var Oe={name:"RecycleScroller",components:{ResizeObserver:Le},directives:{ObserveVisibility:fa},props:{..._a,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const l={"-1":{accumulator:0}},t=this.items,s=this.sizeField,p=this.minItemSize;let f=1e4,d=0,m;for(let k=0,S=t.length;k<S;k++)m=t[k][s]||p,m<f&&(f=m),d+=m,l[k]={accumulator:d,size:m};return this.$_computedMinItemSize=f,l}return[]},simpleArray:ya,itemIndexByKey(){const{keyField:l,items:t}=this,s={};for(let p=0,f=t.length;p<f;p++)s[t[p][l]]=p;return s}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const l=this.$_lastUpdateScrollPosition;typeof l=="number"&&this.$nextTick(()=>{this.scrollToPosition(l)})},beforeUnmount(){this.removeListeners()},methods:{addView(l,t,s,p,f){const d=ls({id:Ta++,index:t,used:!0,key:p,type:f}),m=os({item:s,position:0,nr:d});return l.push(m),m},unuseView(l,t=!1){const s=this.$_unusedViews,p=l.nr.type;let f=s.get(p);f||(f=[],s.set(p,f)),f.push(l),t||(l.nr.used=!1,l.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(l){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:s}=this.updateVisibleItems(!1,!0);s||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(l,t){this.ready&&(l||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(l,t=!1){const s=this.itemSize,p=this.gridItems||1,f=this.itemSecondarySize||s,d=this.$_computedMinItemSize,m=this.typeField,k=this.simpleArray?null:this.keyField,S=this.items,r=S.length,w=this.sizes,y=this.$_views,v=this.$_unusedViews,I=this.pool,T=this.itemIndexByKey;let $,D,z,A,u;if(!r)$=D=A=u=z=0;else if(this.$_prerender)$=A=0,D=u=Math.min(this.prerender,S.length),z=null;else{const x=this.getScroll();if(t){let V=x.start-this.$_lastUpdateScrollPosition;if(V<0&&(V=-V),s===null&&V<d||V<s)return{continuous:!0}}this.$_lastUpdateScrollPosition=x.start;const a=this.buffer;x.start-=a,x.end+=a;let h=0;if(this.$refs.before&&(h=this.$refs.before.scrollHeight,x.start-=h),this.$refs.after){const V=this.$refs.after.scrollHeight;x.end+=V}if(s===null){let V,W=0,U=r-1,G=~~(r/2),N;do N=G,V=w[G].accumulator,V<x.start?W=G:G<r-1&&w[G+1].accumulator>x.start&&(U=G),G=~~((W+U)/2);while(G!==N);for(G<0&&(G=0),$=G,z=w[r-1].accumulator,D=G;D<r&&w[D].accumulator<x.end;D++);for(D===-1?D=S.length-1:(D++,D>r&&(D=r)),A=$;A<r&&h+w[A].accumulator<x.start;A++);for(u=A;u<r&&h+w[u].accumulator<x.end;u++);}else{$=~~(x.start/s*p);const V=$%p;$-=V,D=Math.ceil(x.end/s*p),A=Math.max(0,Math.floor((x.start-h)/s*p)),u=Math.floor((x.end-h)/s*p),$<0&&($=0),D>r&&(D=r),A<0&&(A=0),u>r&&(u=r),z=Math.ceil(r/p)*s}}D-$>va.itemsLimit&&this.itemsLimitError(),this.totalSize=z;let c;const R=$<=this.$_endIndex&&D>=this.$_startIndex;if(R)for(let x=0,a=I.length;x<a;x++)c=I[x],c.nr.used&&(l&&(c.nr.index=T[c.item[k]]),(c.nr.index==null||c.nr.index<$||c.nr.index>=D)&&this.unuseView(c));const n=R?null:new Map;let g,K,Q;for(let x=$;x<D;x++){g=S[x];const a=k?g[k]:g;if(a==null)throw new Error(`Key is ${a} on item (keyField is '${k}')`);if(c=y.get(a),!s&&!w[x].size){c&&this.unuseView(c);continue}K=g[m];let h=v.get(K),V=!1;if(!c)R?h&&h.length?c=h.pop():c=this.addView(I,x,g,a,K):(Q=n.get(K)||0,(!h||Q>=h.length)&&(c=this.addView(I,x,g,a,K),this.unuseView(c,!0),h=v.get(K)),c=h[Q],n.set(K,Q+1)),y.delete(c.nr.key),c.nr.used=!0,c.nr.index=x,c.nr.key=a,c.nr.type=K,y.set(a,c),V=!0;else if(!c.nr.used&&(c.nr.used=!0,V=!0,h)){const W=h.indexOf(c);W!==-1&&h.splice(W,1)}c.item=g,V&&(x===S.length-1&&this.$emit("scroll-end"),x===0&&this.$emit("scroll-start")),s===null?(c.position=w[x-1].accumulator,c.offset=0):(c.position=Math.floor(x/p)*s,c.offset=x%p*f)}return this.$_startIndex=$,this.$_endIndex=D,this.emitUpdate&&this.$emit("update",$,D,A,u),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:R}},getListenerTarget(){let l=rt(this.$el);return window.document&&(l===window.document.documentElement||l===window.document.body)&&(l=window),l},getScroll(){const{$el:l,direction:t}=this,s=t==="vertical";let p;if(this.pageMode){const f=l.getBoundingClientRect(),d=s?f.height:f.width;let m=-(s?f.top:f.left),k=s?window.innerHeight:window.innerWidth;m<0&&(k+=m,m=0),m+k>d&&(k=d-m),p={start:m,end:m+k}}else s?p={start:l.scrollTop,end:l.scrollTop+l.clientHeight}:p={start:l.scrollLeft,end:l.scrollLeft+l.clientWidth};return p},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Ke?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(l){let t;const s=this.gridItems||1;this.itemSize===null?t=l>0?this.sizes[l-1].accumulator:0:t=Math.floor(l/s)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(l){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let s,p,f;if(this.pageMode){const d=rt(this.$el),m=d.tagName==="HTML"?0:d[t.scroll],k=d.getBoundingClientRect(),r=this.$el.getBoundingClientRect()[t.start]-k[t.start];s=d,p=t.scroll,f=l+m+r}else s=this.$el,p=t.scroll,f=l;s[p]=f},itemsLimitError(){throw setTimeout(()=>{this.$el}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((l,t)=>l.nr.index-t.nr.index)}}};const $a={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Ca={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function ka(l,t,s,p,f,d){const m=vt("ResizeObserver"),k=mt("observe-visibility");return $e((o(),i("div",{class:se(["vue-recycle-scroller",{ready:f.ready,"page-mode":s.pageMode,[`direction-${l.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...S)=>d.handleScroll&&d.handleScroll(...S))},[l.$slots.before?(o(),i("div",$a,[Te(l.$slots,"before")],512)):P("v-if",!0),(o(),Y(lt(s.listTag),{ref:"wrapper",style:me({[l.direction==="vertical"?"minHeight":"minWidth"]:f.totalSize+"px"}),class:se(["vue-recycle-scroller__item-wrapper",s.listClass])},{default:F(()=>[(o(!0),i(Z,null,te(f.pool,S=>(o(),Y(lt(s.itemTag),ns({key:S.nr.id,style:f.ready?{transform:`translate${l.direction==="vertical"?"Y":"X"}(${S.position}px) translate${l.direction==="vertical"?"X":"Y"}(${S.offset}px)`,width:s.gridItems?`${l.direction==="vertical"&&s.itemSecondarySize||s.itemSize}px`:void 0,height:s.gridItems?`${l.direction==="horizontal"&&s.itemSecondarySize||s.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[s.itemClass,{hover:!s.skipHover&&f.hoverKey===S.nr.key}]]},is(s.skipHover?{}:{mouseenter:()=>{f.hoverKey=S.nr.key},mouseleave:()=>{f.hoverKey=null}})),{default:F(()=>[Te(l.$slots,"default",{item:S.item,index:S.nr.index,active:S.nr.used})]),_:2},1040,["style","class"]))),128)),Te(l.$slots,"empty")]),_:3},8,["style","class"])),l.$slots.after?(o(),i("div",Ca,[Te(l.$slots,"after")],512)):P("v-if",!0),C(m,{onNotify:d.handleResize},null,8,["onNotify"])],34)),[[k,d.handleVisibilityChange]])}Oe.render=ka;Oe.__file="src/components/RecycleScroller.vue";const wa={class:"trial-list-search"},Sa=["value"],Ia=le({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(l,{emit:t}){const s=t,p=j(),f=At(r=>{s("update:modelValue",r)},300);function d(r){const w=r.target.value;f(w)}function m(){s("update:modelValue",""),p.value?.focus()}function k(){p.value?.focus(),p.value?.select()}function S(r){r.type==="focus-trial-search"&&k()}return ce(()=>{window.addEventListener("focus-trial-search",S)}),ge(()=>{window.removeEventListener("focus-trial-search",S)}),(r,w)=>(o(),i("div",wa,[C(H(bt),{class:"search-icon"}),e("input",{ref_key:"searchInput",ref:p,type:"text",class:"search-input",placeholder:"Filter trials...",value:r.modelValue,onInput:d,onKeydown:He(m,["escape"])},null,40,Sa),r.modelValue?(o(),Y(H(Tt),{key:0,class:"clear-icon",onClick:m})):P("",!0)]))}}),Ra=ae(Ia,[["__scopeId","data-v-3a032c2b"]]),Pa={class:"item-content"},Ea={class:"item-header"},Va=["title"],Aa={key:0,class:"progress-bar"},Fa={class:"item-metadata"},xa={class:"meta-item"},Da={class:"meta-item"},La={key:0,class:"meta-separator"},Oa={key:1,class:"meta-item cost"},Ma=le({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(l){const t=l,{calculateTemplateTokens:s,calculatePromptTokens:p,estimateTotalCost:f,sumEstimates:d,formatCost:m}=Ft(),k=M(()=>{if(t.trial.progress.total===0)return 0;const y=t.trial.progress.completed+t.trial.progress.failed;return Math.round(y/t.trial.progress.total*100)}),S=M(()=>{const{completed:y,failed:v,total:I}=t.trial.progress;return t.trial.status==="draft"?`${I} tasks`:`${y+v}/${I} tasks`}),r=M(()=>{const y=t.trial.started||t.trial.created;if(!y)return"";const I=new Date().getTime()-y.getTime(),T=Math.floor(I/1e3),$=Math.floor(T/60),D=Math.floor($/60),z=Math.floor(D/24);return T<60?"now":$<60?`${$}m`:D<24?`${D}h`:`${z}d`}),w=M(()=>{if(!t.trial.configurations||t.trial.configurations.length===0)return null;let y=null;if(t.trial.type==="template"&&t.trial.templateConfig?.template)y=s(t.trial.templateConfig.template,t.trial.templateConfig.variables||{});else if(t.trial.type==="spreadsheet"&&t.trial.spreadsheetConfig?.promptPattern){const T=p(t.trial.spreadsheetConfig.promptPattern),$=t.trial.progress.total/t.trial.configurations.length;y={totalTokens:T*$,combinationCount:$,perCallAverage:T}}else if(t.trial.type==="playground")return null;if(!y||y.totalTokens===0)return null;const v=t.trial.configurations.map(T=>{const $=T.modelSnapshot;return $?f(y.totalTokens,y.combinationCount,$,T.parameters):null}).filter(Boolean);if(v.length===0)return null;const I=d(v);return`$${m(I,"compact")} total`});return(y,v)=>(o(),i("div",{class:se(["trial-list-item",{selected:y.selected,"has-progress":y.trial.status==="running"}]),onClick:v[0]||(v[0]=I=>y.$emit("click"))},[e("div",{class:se(["status-indicator",`status-${y.trial.status}`])},null,2),e("div",Pa,[e("div",Ea,[e("span",{class:"trial-name",title:y.trial.name},_(y.trial.name),9,Va),e("span",{class:se(["status-tag",`status-${y.trial.status}`])},_(y.trial.status.toUpperCase()),3)]),y.trial.status==="running"?(o(),i("div",Aa,[e("div",{class:"progress-fill",style:me({width:`${k.value}%`})},null,4)])):P("",!0),e("div",Fa,[e("span",xa,_(S.value),1),v[1]||(v[1]=e("span",{class:"meta-separator"},"â€¢",-1)),e("span",Da,_(r.value),1),w.value?(o(),i("span",La,"â€¢")):P("",!0),w.value?(o(),i("span",Oa,_(w.value),1)):P("",!0)])])],2))}}),ut=ae(Ma,[["__scopeId","data-v-67909aef"]]),Ua={class:"section-title"},Na=le({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(l){return(t,s)=>(o(),i("div",{class:se(["trial-list-section",{"with-background":t.background}])},[e("span",Ua,_(t.title),1)],2))}}),dt=ae(Na,[["__scopeId","data-v-07a26c58"]]),za={class:"panel-header"},Wa={class:"header-title"},Ha={key:0,class:"title-text"},Ba={class:"trial-count"},ja={key:0,class:"header-actions"},qa={class:"filter-count"},Ga={class:"filter-count"},Ka={class:"filter-count"},Qa={class:"filter-count"},Ja={class:"filter-count"},Ya={key:1,class:"status-tabs"},Xa={class:"tab-count"},Za={class:"tab-count"},el={class:"tab-count"},tl={class:"trial-list-container"},sl={key:1,class:"trial-list"},al={key:2,class:"collapsed-list"},ll=["onClick"],ol={class:"collapsed-count"},nl={key:3,class:"empty-state"},il=le({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","import-trial","update-search","update-filter","refresh"],setup(l,{emit:t}){const s=l,p=t,f=j(!1),d=j("all"),m=j(250),k=M(()=>m.value<50),S=M(()=>s.trials.filter(n=>n.status==="running"||n.status==="paused").length),r=M(()=>s.trials.filter(n=>n.status==="completed"||n.status==="failed").length),w=M(()=>{let n=s.trials;if(s.searchQuery){const x=s.searchQuery.toLowerCase();n=n.filter(a=>{const h=a.name.toLowerCase().includes(x),V=a.templateConfig?.template?.toLowerCase().includes(x),W=a.configurations.some(U=>U.modelId.toLowerCase().includes(x)||U.provider.toLowerCase().includes(x));return h||V||W})}s.filterStatus!=="all"&&(n=n.filter(x=>x.status===s.filterStatus)),d.value==="active"?n=n.filter(x=>x.status==="running"||x.status==="paused"):d.value==="done"&&(n=n.filter(x=>x.status==="completed"||x.status==="failed"));const g=n.filter(x=>x.status==="running"),K=n.filter(x=>x.status!=="running"),Q=[];return g.length>0&&(Q.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),Q.push(...g.sort((x,a)=>(a.started?.getTime()||0)-(x.started?.getTime()||0)))),K.length>0&&(g.length>0&&Q.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),Q.push(...K.sort((x,a)=>(a.created?.getTime()||0)-(x.created?.getTime()||0)))),Q}),y=M(()=>w.value.map(n=>({...n,height:z(n)}))),v=M(()=>s.trials.filter(n=>d.value==="active"?n.status==="running"||n.status==="paused":d.value==="done"?n.status==="completed"||n.status==="failed":!0)),I=M(()=>s.searchQuery?"No trials found":s.filterStatus==="running"?"No trials are currently running":"No trials found"),T=M(()=>s.searchQuery?"No trials match your search":s.filterStatus!=="all"?`No ${s.filterStatus} trials`:"Create your first trial to get started"),$=M(()=>s.filterStatus==="all"&&!s.searchQuery);function D(n){return s.trials.filter(g=>g.status===n).length}function z(n){if(n.type==="section")return 32;const g=n.status==="running",K=n.configurations?.some(Q=>Q.repeatCount>1);return g||K?96:80}function A(n){const g=n.progress.completed+n.progress.failed;return n.status==="running"?`${Math.round(g/n.progress.total*100)}%`:g.toString()}async function u(){f.value=!0;try{await new Promise(n=>setTimeout(n,500)),p("refresh")}finally{f.value=!1}}function c({key:n}){p("update-filter",n)}function R(){const n=document.querySelector(".trial-list-panel");n&&(m.value=n.clientWidth)}return ce(()=>{R(),window.addEventListener("resize",R);const n=document.querySelector(".trial-list-panel");n&&new ResizeObserver(()=>R()).observe(n)}),ge(()=>{window.removeEventListener("resize",R)}),(n,g)=>{const K=pe,Q=Ze,x=ms,a=Xe,h=Ye;return o(),i("div",{class:se(["trial-list-panel",{collapsed:k.value}])},[e("div",za,[e("div",Wa,[C(H(cs),{class:"title-icon"}),k.value?P("",!0):(o(),i("span",Ha,"Trials")),e("span",Ba,_(n.trials.length),1)]),k.value?P("",!0):(o(),i("div",ja,[C(K,{type:"primary",size:"small",onClick:g[0]||(g[0]=V=>n.$emit("create-trial"))},{default:F(()=>[C(H(ps)),g[7]||(g[7]=L(" New Trial "))]),_:1,__:[7]}),C(K,{size:"small",onClick:g[1]||(g[1]=V=>n.$emit("import-trial"))},{default:F(()=>[C(H($t)),g[8]||(g[8]=L(" Import "))]),_:1,__:[8]}),C(K,{size:"small",onClick:u,loading:f.value},{default:F(()=>[C(H(fs),{spin:f.value},null,8,["spin"])]),_:1},8,["loading"]),C(h,null,{overlay:F(()=>[C(a,{onClick:c},{default:F(()=>[C(Q,{key:"all"},{default:F(()=>g[9]||(g[9]=[e("span",null,"All Trials",-1)])),_:1,__:[9]}),C(x),C(Q,{key:"running"},{default:F(()=>[g[10]||(g[10]=e("span",null,"Running Only",-1)),e("span",qa,_(D("running")),1)]),_:1,__:[10]}),C(Q,{key:"completed"},{default:F(()=>[g[11]||(g[11]=e("span",null,"Completed Only",-1)),e("span",Ga,_(D("completed")),1)]),_:1,__:[11]}),C(Q,{key:"failed"},{default:F(()=>[g[12]||(g[12]=e("span",null,"Failed Only",-1)),e("span",Ka,_(D("failed")),1)]),_:1,__:[12]}),C(Q,{key:"paused"},{default:F(()=>[g[13]||(g[13]=e("span",null,"Paused Only",-1)),e("span",Qa,_(D("paused")),1)]),_:1,__:[13]}),C(Q,{key:"draft"},{default:F(()=>[g[14]||(g[14]=e("span",null,"Draft Only",-1)),e("span",Ja,_(D("draft")),1)]),_:1,__:[14]})]),_:1})]),default:F(()=>[C(K,{size:"small"},{default:F(()=>[C(H(vs))]),_:1})]),_:1})]))]),k.value?P("",!0):(o(),Y(Ra,{key:0,"model-value":n.searchQuery,"onUpdate:modelValue":g[2]||(g[2]=V=>n.$emit("update-search",V))},null,8,["model-value"])),k.value?P("",!0):(o(),i("div",Ya,[e("div",{class:se(["status-tab",{active:d.value==="all"}]),onClick:g[3]||(g[3]=V=>d.value="all")},[g[15]||(g[15]=e("span",{class:"tab-icon"},"ðŸ“Š",-1)),g[16]||(g[16]=e("span",{class:"tab-label"},"ALL",-1)),e("span",Xa,_(n.trials.length),1)],2),e("div",{class:se(["status-tab",{active:d.value==="active"}]),onClick:g[4]||(g[4]=V=>d.value="active")},[g[17]||(g[17]=e("span",{class:"tab-icon"},"ðŸŸ¢",-1)),g[18]||(g[18]=e("span",{class:"tab-label"},"Active",-1)),e("span",Za,_(S.value),1)],2),e("div",{class:se(["status-tab",{active:d.value==="done"}]),onClick:g[5]||(g[5]=V=>d.value="done")},[g[19]||(g[19]=e("span",{class:"tab-icon"},"âœ…",-1)),g[20]||(g[20]=e("span",{class:"tab-label"},"Done",-1)),e("span",el,_(r.value),1)],2)])),e("div",tl,[!k.value&&w.value.length>100?(o(),Y(H(Oe),{key:0,class:"trial-list virtual-list",items:y.value,"size-field":"height","key-field":"id",buffer:10},{default:F(({item:V})=>[V.type==="section"?(o(),Y(dt,{key:0,title:V.title,background:V.background},null,8,["title","background"])):(o(),Y(ut,{key:1,trial:V,selected:V.id===n.selectedTrialId,"data-trial-id":V.id,onClick:W=>n.$emit("select-trial",V.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):k.value?(o(),i("div",al,[(o(!0),i(Z,null,te(v.value,V=>(o(),i("div",{key:V.id,class:se(["collapsed-item",{selected:V.id===n.selectedTrialId}]),onClick:W=>n.$emit("select-trial",V.id)},[e("div",{class:se(["status-dot",`status-${V.status}`])},null,2),e("span",ol,_(A(V)),1)],10,ll))),128))])):(o(),i("div",sl,[(o(!0),i(Z,null,te(w.value,(V,W)=>(o(),i(Z,{key:V.id||`section-${W}`},[V.type==="section"?(o(),Y(dt,{key:0,title:V.title,background:V.background},null,8,["title","background"])):(o(),Y(ut,{key:1,trial:V,selected:V.id===n.selectedTrialId,"data-trial-id":V.id,onClick:U=>n.$emit("select-trial",V.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),w.value.length===0&&!k.value?(o(),i("div",nl,[C(H(Ct),{class:"empty-icon"}),e("h3",null,_(I.value),1),e("p",null,_(T.value),1),$.value?(o(),Y(K,{key:0,type:"primary",size:"large",onClick:g[6]||(g[6]=V=>n.$emit("create-trial"))},{default:F(()=>g[21]||(g[21]=[L(" Create New Trial ")])),_:1,__:[21]})):P("",!0)])):P("",!0)])],2)}}}),rl=ae(il,[["__scopeId","data-v-ad2a17cf"]]),ul={class:"trial-header"},dl={class:"header-main"},cl={class:"header-title"},pl={class:"trial-name"},fl={key:0,class:"progress-container"},vl={class:"progress-bar"},ml={class:"progress-stats-inline"},gl={class:"progress-text"},hl={key:0,class:"progress-stat"},_l={class:"stat-number"},yl={key:1,class:"progress-stat"},bl={class:"stat-number"},Tl={key:2,class:"progress-stat"},$l={class:"stat-number"},Cl=le({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(l){const t=l,s=M(()=>{let T=t.trial.name;return T=T.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),T=T.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),T.trim()}),p=M(()=>!0),f=M(()=>t.progress?t.progress.completed+t.progress.failed:0),d=M(()=>{if(!t.progress||t.progress.total===0)return 0;const T=t.progress.completed+t.progress.failed;return Math.round(T/t.progress.total*100)}),m=M(()=>{const T=t.trial.started||t.trial.created;if(!T)return"0m";let $;if(t.trial.status==="draft")return"0m";t.trial.completed?$=t.trial.completed:$=new Date;const D=$.getTime()-T.getTime(),z=Math.floor(D/(1e3*60*60)),A=Math.floor(D%(1e3*60*60)/(1e3*60));return z>0?`${z}h ${A}m`:`${A}m`}),k=M(()=>{if(!t.progress?.avgLatencyMs)return null;const T=t.progress.avgLatencyMs;return T<1e3?`${Math.round(T)}ms`:`${(T/1e3).toFixed(1)}s`}),{calculateTemplateTokens:S,calculatePromptTokens:r,estimateTotalCost:w,sumEstimates:y,formatCost:v}=Ft();M(()=>{if(!t.trial.configurations||t.trial.configurations.length===0)return null;let T=null;if(t.trial.type==="template"&&t.trial.templateConfig?.template)T=S(t.trial.templateConfig.template,t.trial.templateConfig.variables||{});else if(t.trial.type==="spreadsheet"&&t.trial.spreadsheetConfig?.promptPattern){const z=r(t.trial.spreadsheetConfig.promptPattern),u=(t.progress?.total||t.trial.progress.total)/t.trial.configurations.length;T={totalTokens:z*u,combinationCount:u,perCallAverage:z}}else if(t.trial.type==="playground")return null;if(!T||T.totalTokens===0)return null;const $=t.trial.configurations.map(z=>{const A=z.modelSnapshot;return A?w(T.totalTokens,T.combinationCount,A,z.parameters):null}).filter(Boolean);if($.length===0)return null;const D=y($);return`${v(D,"compact")} total`});const I=M(()=>{if(t.trial.status!=="running"||!t.progress||t.progress.completed===0)return null;const $=(Date.now()-(t.trial.started?.getTime()||0))/t.progress.completed,D=t.progress.pending*$,z=Math.floor(D/(1e3*60)),A=Math.floor(D%(1e3*60)/1e3);if(z>60){const u=Math.floor(z/60),c=z%60;return`${u}h ${c}m`}return`${z}m ${A}s`});return(T,$)=>(o(),i("div",ul,[e("div",dl,[e("div",cl,[e("h2",pl,_(s.value),1),e("span",{class:se(["status-tag",`status-${T.trial.status}`])},_(T.trial.status.toUpperCase()),3)]),p.value?(o(),i("div",fl,[e("div",vl,[e("div",{class:"progress-fill",style:me({width:`${d.value}%`})},null,4)]),e("div",ml,[e("span",gl,_(f.value)+"/"+_(T.progress?.total||0)+" ("+_(d.value)+"%) ",1),m.value?(o(),i("span",hl,[$[0]||($[0]=e("span",{class:"stat-label"},"Duration:",-1)),$[1]||($[1]=L()),e("span",_l,_(m.value),1)])):P("",!0),k.value?(o(),i("span",yl,[$[2]||($[2]=e("span",{class:"stat-label"},"Avg:",-1)),$[3]||($[3]=L()),e("span",bl,_(k.value),1)])):P("",!0),I.value?(o(),i("span",Tl,[$[4]||($[4]=e("span",{class:"stat-label"},"Remaining:",-1)),$[5]||($[5]=L()),e("span",$l,"~"+_(I.value),1)])):P("",!0)])])):P("",!0)]),P("",!0)]))}}),kl=ae(Cl,[["__scopeId","data-v-65916275"]]),wl={class:"trial-actions"},Sl={class:"action-group execution-controls"},Il={class:"action-group data-actions"},Rl={class:"action-group management-actions"},Pl=le({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(l,{emit:t}){const s=l,p=t,f=j(!1),d=j(!1),m=j(!1);M(()=>s.executionState?.currentTrialId===s.trial.id);const k=M(()=>["draft","failed","cancelled"].includes(s.trial.status)),S=M(()=>s.trial.status==="running"),r=M(()=>s.trial.status==="paused"),w=M(()=>["running","paused"].includes(s.trial.status));function y(){p("start")}async function v(){f.value=!0,d.value=!1,p("pause"),setTimeout(()=>{f.value=!1},1e3)}async function I(){d.value=!0,f.value=!1,p("resume"),setTimeout(()=>{d.value=!1},3e3)}function T(){be.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>p("cancel")})}async function $(){m.value=!0,p("refresh"),setTimeout(()=>{m.value=!1},500)}function D({key:c}){c==="data"?p("export-data"):c==="python"&&p("export-python")}function z(){p("duplicate")}function A(){p("edit")}function u(){const c=s.trial.progress.total;be.confirm({title:"Delete trial?",content:`Delete trial and all ${c} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{p("delete")}})}return(c,R)=>{const n=pe,g=Ze,K=Xe,Q=Ye;return o(),i("div",wl,[e("div",Sl,[k.value?(o(),Y(n,{key:0,type:"primary",size:"large",disabled:!c.isLeader,onClick:y},{default:F(()=>[C(H(ot)),R[0]||(R[0]=L(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):P("",!0),S.value?(o(),Y(n,{key:1,size:"large",disabled:!c.isLeader,loading:f.value,onClick:v},{default:F(()=>[f.value?P("",!0):(o(),Y(H(gs),{key:0})),L(" "+_(f.value?"Pausing...":"Pause"),1)]),_:1},8,["disabled","loading"])):P("",!0),r.value?(o(),Y(n,{key:2,type:"primary",size:"large",disabled:!c.isLeader||d.value,loading:d.value,onClick:I},{default:F(()=>[d.value?P("",!0):(o(),Y(H(ot),{key:0})),L(" "+_(d.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):P("",!0),w.value?(o(),Y(n,{key:3,danger:"",size:"large",disabled:!c.isLeader,onClick:T},{default:F(()=>[C(H(hs)),R[1]||(R[1]=L(" Cancel "))]),_:1,__:[1]},8,["disabled"])):P("",!0)]),e("div",Il,[C(n,{size:"large",loading:m.value,onClick:$,title:"Refresh trial data from database"},{default:F(()=>[m.value?(o(),Y(H(kt),{key:1,spin:""})):(o(),Y(H(_s),{key:0})),L(" "+_(m.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),C(Q,null,{overlay:F(()=>[C(K,{onClick:D},{default:F(()=>[C(g,{key:"data"},{default:F(()=>[C(H(bs)),R[3]||(R[3]=L(" Export Data "))]),_:1,__:[3]}),C(g,{key:"python"},{default:F(()=>[C(H(Ts)),R[4]||(R[4]=L(" Export Python Script "))]),_:1,__:[4]})]),_:1})]),default:F(()=>[C(n,{size:"large"},{default:F(()=>[R[2]||(R[2]=L(" Export ")),C(H(ys))]),_:1,__:[2]})]),_:1})]),e("div",Rl,[C(n,{size:"large",disabled:!c.isLeader,onClick:z},{default:F(()=>[C(H(et)),R[5]||(R[5]=L(" Duplicate "))]),_:1,__:[5]},8,["disabled"]),c.trial.status==="draft"?(o(),Y(n,{key:0,size:"large",disabled:!c.isLeader,onClick:A},{default:F(()=>[C(H($s)),R[6]||(R[6]=L(" Edit "))]),_:1,__:[6]},8,["disabled"])):P("",!0),C(n,{danger:"",size:"large",disabled:!c.isLeader,onClick:u},{default:F(()=>[C(H(Cs)),R[7]||(R[7]=L(" Delete "))]),_:1,__:[7]},8,["disabled"])])])}}}),El=ae(Pl,[["__scopeId","data-v-e642c431"]]),Vl={class:"snapshot-debug"},Al={class:"debug-header"},Fl={class:"status-row"},xl={key:0,class:"badge success"},Dl={key:1,class:"badge warning"},Ll={key:0,class:"status-row"},Ol={key:0,class:"variables-section"},Ml={class:"variable-header"},Ul={class:"var-name"},Nl={class:"var-type"},zl={key:0,class:"snapshot-content"},Wl={class:"snapshot-meta"},Hl={key:0},Bl={class:"snapshot-items"},jl={class:"items-preview"},ql={class:"item-index"},Gl={class:"item-value"},Kl={key:0,class:"item-attrs"},Ql={key:0,class:"more-indicator"},Jl={key:1,class:"no-snapshot"},Yl={key:0},Xl={key:1,class:"legacy-warning"},Zl={class:"debug-footer"},eo=le({__name:"SnapshotDebugModal",props:{visible:{type:Boolean},trial:{},migrating:{type:Boolean}},emits:["close","migrate"],setup(l){const t=l,s=M(()=>t.trial.templateConfig?.hasSnapshots===!0),p=M(()=>t.trial.templateConfig?.variables||{});function f(r){return"snapshot"in r&&r.snapshot!=null}function d(r){return r.snapshot}function m(r){return f(r)?`${d(r).source.type} (snapshot)`:r.type==="value"?"Direct values":r.type==="list"?"List reference":"Unknown"}function k(){for(const r of Object.values(p.value))if(f(r)){const w=d(r);if(w.source?.snapshotDate)return new Date(w.source.snapshotDate).toLocaleString()}return"Unknown"}function S(){const r={trialId:t.trial.id,trialName:t.trial.name,hasSnapshots:s.value,variables:p.value};navigator.clipboard.writeText(JSON.stringify(r,null,2)),X.success("Debug info copied to clipboard")}return(r,w)=>{const y=tt,v=De,I=pe,T=be;return o(),Y(T,{visible:r.visible,title:"Variable Snapshot Debug View",width:"80%",footer:null,onCancel:w[2]||(w[2]=$=>r.$emit("close"))},{default:F(()=>[e("div",Vl,[e("div",Al,[e("div",Fl,[w[5]||(w[5]=e("span",{class:"label"},"Snapshot Status:",-1)),s.value?(o(),i("span",xl,[C(H(wt)),w[3]||(w[3]=L(" Snapshots Enabled "))])):(o(),i("span",Dl,[C(H(ke)),w[4]||(w[4]=L(" Legacy Mode (No Snapshots) "))]))]),s.value?(o(),i("div",Ll,[w[6]||(w[6]=e("span",{class:"label"},"Snapshot Date:",-1)),e("span",null,_(k()),1)])):P("",!0)]),s.value?(o(),i("div",Ol,[w[8]||(w[8]=e("h3",null,"Variable Snapshots",-1)),(o(!0),i(Z,null,te(p.value,($,D)=>(o(),i("div",{key:D,class:"variable-card"},[e("div",Ml,[e("span",Ul,_(D),1),e("span",Nl,_(m($)),1)]),f($)?(o(),i("div",zl,[e("div",Wl,[e("span",null,"Source: "+_(d($).source.type),1),d($).source.listName?(o(),i("span",Hl," List: "+_(d($).source.listName),1)):P("",!0),e("span",null,"Items: "+_(d($).items.length),1)]),e("div",Bl,[e("div",jl,[(o(!0),i(Z,null,te(d($).items.slice(0,5),(z,A)=>(o(),i("div",{key:A,class:"item-row"},[e("span",ql,_(A+1)+".",1),e("span",Gl,_(z.value),1),z.attributes&&Object.keys(z.attributes).length>0?(o(),i("span",Kl,[(o(!0),i(Z,null,te(z.attributes,(u,c)=>(o(),Y(y,{key:c,size:"small"},{default:F(()=>[L(_(c)+": "+_(u),1)]),_:2},1024))),128))])):P("",!0)]))),128)),d($).items.length>5?(o(),i("div",Ql," ... and "+_(d($).items.length-5)+" more items ",1)):P("",!0)])])])):(o(),i("div",Jl,[C(H(ke)),w[7]||(w[7]=L(" No snapshot - using live reference ")),$.listId?(o(),i("span",Yl,"List ID: "+_($.listId),1)):P("",!0)]))]))),128))])):(o(),i("div",Xl,[C(v,{message:"Legacy Trial",description:"This trial was created before snapshots were implemented. Variable lists are loaded dynamically from the database, which means changes to lists will affect trial duplication.",type:"warning","show-icon":""}),C(I,{type:"primary",onClick:w[0]||(w[0]=$=>r.$emit("migrate")),loading:r.migrating,style:{"margin-top":"16px"}},{default:F(()=>[C(H(ks)),w[9]||(w[9]=L(" Migrate to Snapshots "))]),_:1,__:[9]},8,["loading"])])),e("div",Zl,[C(I,{onClick:S},{default:F(()=>[C(H(et)),w[10]||(w[10]=L(" Copy Debug Info "))]),_:1,__:[10]}),C(I,{onClick:w[1]||(w[1]=$=>r.$emit("close"))},{default:F(()=>w[11]||(w[11]=[L("Close")])),_:1,__:[11]})])])]),_:1},8,["visible"])}}}),to=ae(eo,[["__scopeId","data-v-726379cc"]]),so={class:"trial-detail-view"},ao={key:0,class:"detail-content"},lo={class:"detail-section"},oo={class:"detail-grid"},no={class:"detail-item"},io={key:0,class:"detail-item"},ro={key:1,class:"detail-item"},uo={class:"detail-item"},co={class:"detail-item"},po={class:"detail-section"},fo={class:"detail-grid"},vo={key:0,class:"detail-item full-width"},mo={key:1,class:"detail-item full-width"},go={class:"detail-item"},ho={class:"detail-item"},_o={style:{display:"flex","align-items":"center",gap:"8px"}},yo={key:0,class:"snapshot-badge success"},bo={key:1,class:"snapshot-badge warning"},To={class:"detail-item"},$o={key:2,class:"detail-item"},Co={key:0,class:"detail-section"},ko={class:"detail-grid"},wo={class:"detail-item"},So={class:"detail-item"},Io={class:"detail-item"},Ro={class:"detail-section"},Po={class:"model-configs"},Eo={class:"config-header"},Vo=["src","alt"],Ao={class:"provider-name"},Fo={class:"config-details"},xo={class:"config-item"},Do={class:"config-params"},Lo={class:"param-list"},Oo={key:0,class:"config-item"},Mo={class:"cost"},Uo=le({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(l){const t=l,s=j(!1),p=M(()=>{const A=t.trial.started||t.trial.created,c=(t.trial.completed||new Date).getTime()-A.getTime(),R=Math.floor(c/(1e3*60*60)),n=Math.floor(c%(1e3*60*60)/(1e3*60));return R>0?`${R}h ${n}m`:`${n}m`}),f=M(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[t.trial.status]||t.trial.status),d=M(()=>t.trial.type==="template"&&t.trial.templateConfig?.variables?Object.keys(t.trial.templateConfig.variables).length:0),m=M(()=>Math.round(t.trial.progress.total*750)),k=M(()=>t.trial.type==="template"&&t.trial.templateConfig?t.trial.templateConfig.hasSnapshots===!0:!1),S=M(()=>"text"),r=M(()=>1),w=M(()=>t.trial.progress.total/r.value);function y(A){return A?new Date(A).toLocaleString():"N/A"}function v(){if(t.trial.templateConfig?.templateName)return t.trial.templateConfig.templateName;const A=t.trial.templateConfig?.template||"Unknown Template";return A.length>50?A.substring(0,50)+"...":A}function I(){return t.trial.spreadsheetConfig?.datasetId||"Unknown Dataset"}function T(A){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[A]||A}function $(A){}async function D(){try{X.info("Migration feature coming soon"),s.value=!1}catch(A){X.error("Failed to migrate trial"),E.error("Migration error:",A)}}function z(A){const u=A.modelSnapshot;return u?.capabilities?.inputCostPerToken?`$${((u.capabilities.inputCostPerToken+u.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(A,u)=>{const c=pe;return o(),i("div",so,[e("div",{class:"detail-header",onClick:u[0]||(u[0]=R=>A.$emit("toggle-collapse"))},[u[3]||(u[3]=e("h3",null,"Trial Details",-1)),C(H(ws),{class:se(["collapse-icon",{rotated:A.isCollapsed}])},null,8,["class"])]),A.isCollapsed?P("",!0):(o(),i("div",ao,[e("div",lo,[u[9]||(u[9]=e("h4",null,"Basic Information",-1)),e("div",oo,[e("div",no,[u[4]||(u[4]=e("label",null,"Created:",-1)),e("span",null,_(y(A.trial.created)),1)]),A.trial.started?(o(),i("div",io,[u[5]||(u[5]=e("label",null,"Started:",-1)),e("span",null,_(y(A.trial.started)),1)])):P("",!0),A.trial.completed?(o(),i("div",ro,[u[6]||(u[6]=e("label",null,"Completed:",-1)),e("span",null,_(y(A.trial.completed)),1)])):P("",!0),e("div",uo,[u[7]||(u[7]=e("label",null,"Duration:",-1)),e("span",null,_(p.value),1)]),e("div",co,[u[8]||(u[8]=e("label",null,"Status:",-1)),e("span",null,_(A.trial.status)+" - "+_(f.value),1)])])]),e("div",po,[u[19]||(u[19]=e("h4",null,"Configuration",-1)),e("div",fo,[A.trial.type==="template"?(o(),i("div",vo,[u[10]||(u[10]=e("label",null,"Template:",-1)),e("span",null,_(v()),1)])):P("",!0),A.trial.type==="spreadsheet"?(o(),i("div",mo,[u[11]||(u[11]=e("label",null,"Dataset:",-1)),e("span",null,_(I()),1)])):P("",!0),e("div",go,[u[12]||(u[12]=e("label",null,"Variable Lists:",-1)),e("span",null,_(d.value)+" lists",1)]),e("div",ho,[u[16]||(u[16]=e("label",null,"Data Snapshot:",-1)),e("div",_o,[k.value?(o(),i("span",yo,[C(H(wt)),u[13]||(u[13]=L(" Captured "))])):(o(),i("span",bo,[C(H(ke)),u[14]||(u[14]=L(" Live Reference "))])),A.trial.type==="template"?(o(),Y(c,{key:2,size:"small",type:"link",onClick:u[1]||(u[1]=R=>s.value=!0)},{default:F(()=>[C(H(St)),u[15]||(u[15]=L(" Debug "))]),_:1,__:[15]})):P("",!0)])]),e("div",To,[u[17]||(u[17]=e("label",null,"Token Estimate:",-1)),e("span",null,"~"+_(m.value)+" tokens",1)]),S.value?(o(),i("div",$o,[u[18]||(u[18]=e("label",null,"Output Type:",-1)),e("span",{class:se(["output-type",`type-${S.value}`])},_(S.value),3)])):P("",!0)])]),r.value>1?(o(),i("div",Co,[u[23]||(u[23]=e("h4",null,"Repeat Configuration",-1)),e("div",ko,[e("div",wo,[u[20]||(u[20]=e("label",null,"Times per prompt:",-1)),e("span",null,_(r.value),1)]),e("div",So,[u[21]||(u[21]=e("label",null,"Total combinations:",-1)),e("span",null,_(w.value),1)]),e("div",Io,[u[22]||(u[22]=e("label",null,"Total API calls:",-1)),e("span",null,_(A.trial.progress.total),1)])])])):P("",!0),e("div",Ro,[u[27]||(u[27]=e("h4",null,"Model Configurations",-1)),e("div",Po,[(o(!0),i(Z,null,te(A.trial.configurations,(R,n)=>(o(),i("div",{key:n,class:"model-config-card"},[e("div",Eo,[(R.provider,void 0)?(o(),i("img",{key:0,src:(R.provider,void 0),alt:R.provider,class:"provider-logo"},null,8,Vo)):P("",!0),e("span",Ao,_(T(R.provider)),1)]),e("div",Fo,[e("div",xo,[u[24]||(u[24]=e("label",null,"Model:",-1)),e("span",null,_(R.modelId),1)]),e("div",Do,[u[25]||(u[25]=e("label",null,"Parameters:",-1)),e("div",Lo,[(o(!0),i(Z,null,te(R.parameters,(g,K)=>(o(),i("span",{key:K,class:"param-tag"},_(K)+": "+_(g),1))),128))])]),z(R)?(o(),i("div",Oo,[u[26]||(u[26]=e("label",null,"Est. Cost:",-1)),e("span",Mo,_(z(R)),1)])):P("",!0)])]))),128))])])])),s.value?(o(),Y(to,{key:1,visible:s.value,trial:A.trial,onClose:u[2]||(u[2]=R=>s.value=!1),onMigrate:D},null,8,["visible","trial"])):P("",!0)])}}}),No=ae(Uo,[["__scopeId","data-v-a5e15d0c"]]),zo={class:"filter-bar"},Wo={class:"search-container"},Ho=le({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns","openPostProcessing"],setup(l,{emit:t}){const s=l,p=t,f=M(()=>{const r=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"postProcessedResponse",label:"Post-Processed"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return s.showRepeatColumn&&r.splice(2,0,{key:"repeat",label:"Repeat Index"}),r}),d=M(()=>{const r={total:s.apiCalls.length,completed:0,failed:0,running:0,pending:0};return s.apiCalls.forEach(w=>{w.status==="completed"?r.completed++:w.status==="failed"?r.failed++:w.status==="running"?r.running++:w.status==="pending"&&r.pending++}),r});function m(r){return r.modelSnapshot?.displayName||`${r.provider} - ${r.modelId}`}const k=At(r=>{const w=r.target.value;p("update:searchQuery",w)},300);function S(r){const w=[...s.visibleColumns],y=w.indexOf(r);if(y>-1)w.splice(y,1);else{const v=f.value.map($=>$.key),I=v.indexOf(r);let T=0;for(let $=0;$<I;$++)w.includes(v[$])&&T++;w.splice(T,0,r)}p("update:visibleColumns",w)}return(r,w)=>{const y=Is,v=Ss,I=It,T=pe,$=Rt,D=Ze,z=Xe,A=Ye;return o(),i("div",zo,[C(v,{value:r.statusFilter,onChange:w[0]||(w[0]=u=>r.$emit("update:statusFilter",u)),placeholder:"Filter by status",style:{width:"150px"}},{default:F(()=>[C(y,{value:"all"},{default:F(()=>[L(" All ("+_(d.value.total)+") ",1)]),_:1}),C(y,{value:"completed"},{default:F(()=>[L(" Completed ("+_(d.value.completed)+") ",1)]),_:1}),C(y,{value:"failed"},{default:F(()=>[L(" Failed ("+_(d.value.failed)+") ",1)]),_:1}),C(y,{value:"running"},{default:F(()=>[L(" Running ("+_(d.value.running)+") ",1)]),_:1}),C(y,{value:"pending"},{default:F(()=>[L(" Pending ("+_(d.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),C(v,{value:r.configFilter,onChange:w[1]||(w[1]=u=>r.$emit("update:configFilter",u)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:F(()=>[C(y,{value:""},{default:F(()=>w[3]||(w[3]=[L("All Configurations")])),_:1,__:[3]}),(o(!0),i(Z,null,te(r.configurations,(u,c)=>(o(),Y(y,{key:c,value:c.toString()},{default:F(()=>[L(_(m(u)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),e("div",Wo,[C(I,{value:r.searchQuery,onInput:H(k),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:F(()=>[C(H(bt))]),_:1},8,["value","onInput"])]),C(A,null,{overlay:F(()=>[C(z,null,{default:F(()=>[(o(!0),i(Z,null,te(f.value,u=>(o(),Y(D,{key:u.key},{default:F(()=>[C($,{checked:r.visibleColumns.includes(u.key),disabled:u.key==="status",onChange:c=>S(u.key)},{default:F(()=>[L(_(u.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:F(()=>[C(T,null,{default:F(()=>[C(H(Rs)),w[4]||(w[4]=L(" Columns "))]),_:1,__:[4]})]),_:1}),C(T,{type:"primary",onClick:w[2]||(w[2]=u=>r.$emit("openPostProcessing"))},{default:F(()=>[C(H(Pt)),w[5]||(w[5]=L(" Post-Process "))]),_:1,__:[5]})])}}}),Bo=ae(Ho,[["__scopeId","data-v-e6112af3"]]),jo={class:"modal-content"},qo={class:"section"},Go={class:"info-grid"},Ko={class:"info-item"},Qo={class:"monospace"},Jo={class:"info-item"},Yo={class:"info-item"},Xo={key:0,class:"info-item"},Zo={class:"info-item"},en={key:1,class:"info-item"},tn={key:2,class:"info-item"},sn={key:3,class:"info-item"},an={key:0,class:"info-row"},ln={class:"monospace"},on={key:0,class:"section"},nn={class:"variables-list"},rn={class:"variable-main"},un={class:"variable-label"},dn={class:"variable-value"},cn={key:0,class:"variable-attributes"},pn={class:"attribute-label"},fn={class:"attribute-value"},vn={class:"section"},mn={class:"content-box prompt-display"},gn={key:1,class:"section"},hn={key:0,class:"error-result"},_n={key:1,class:"success-result"},yn={class:"content-box response-content"},bn={key:0,class:"parsed-content-section"},Tn={class:"content-box parsed-content"},$n={key:1,class:"post-processed-section"},Cn={class:"content-box post-processed-content"},kn={key:2,class:"refusal-warning"},wn={key:3,class:"refusal-warning"},Sn={class:"extraction-config-section"},In={class:"config-grid"},Rn={key:0,class:"config-item"},Pn={class:"config-value"},En={key:1,class:"config-item"},Vn={class:"config-value pattern"},An={key:2,class:"config-item"},Fn={class:"config-value"},xn={key:3,class:"config-item"},Dn={class:"config-value"},Ln={key:4,class:"config-item no-extraction"},On={key:4,class:"post-processing-config-section"},Mn={class:"config-grid"},Un={class:"config-item post-processing-item"},Nn={class:"config-value"},zn={key:0,class:"config-item post-processing-item"},Wn={class:"config-value"},Hn={key:1,class:"config-item post-processing-item"},Bn={class:"config-value pattern"},jn={key:2,class:"config-item post-processing-item"},qn={class:"config-value"},Gn={key:3,class:"config-item post-processing-item"},Kn={class:"config-value"},Qn={key:4,class:"config-item post-processing-item"},Jn={class:"config-value"},Yn={key:5,class:"usage-info"},Xn={class:"info-grid"},Zn={class:"info-item"},ei={class:"info-item"},ti={class:"info-item"},si={key:0,class:"info-item"},ai={class:"raw-data-section"},li={class:"raw-data"},oi={key:0},ni={key:1,class:"raw-data"},ii={key:2},ri={key:3,class:"raw-data"},ui={class:"modal-footer"},di=le({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(l,{emit:t}){const s=l,p=t,f=Qe(),d=M(()=>{if(!s.apiCall.completed||!s.apiCall.created)return null;const n=new Date(s.apiCall.created).getTime();return new Date(s.apiCall.completed).getTime()-n}),m=M(()=>{const n=s.trial.configurations[s.apiCall.configurationIndex];return n?`${n.provider} / ${n.modelId}`:null}),k=M(()=>{if(!s.apiCall.result?.usage)return null;const n=s.trial.configurations[s.apiCall.configurationIndex];if(!n)return null;const g=f.models.value.find(x=>x.provider===n.provider&&x.modelId===n.modelId);if(!g?.capabilities?.inputCostPerToken&&!g?.capabilities?.outputCostPerToken)return null;const K=(s.apiCall.result.usage.prompt_tokens||0)*(g.capabilities.inputCostPerToken||0),Q=(s.apiCall.result.usage.completion_tokens||0)*(g.capabilities.outputCostPerToken||0);return K+Q}),S=M(()=>{if(!s.apiCall.request)return"No request data";const n=JSON.parse(JSON.stringify(s.apiCall.request));return n.headers&&Object.keys(n.headers).forEach(g=>{(g.toLowerCase().includes("authorization")||g.toLowerCase().includes("api-key")||g.toLowerCase().includes("x-api-key"))&&(n.headers[g]="[REDACTED]")}),n.body&&typeof n.body=="object"&&(n.body.api_key&&(n.body.api_key="[REDACTED]"),n.body.apiKey&&(n.body.apiKey="[REDACTED]")),JSON.stringify(n,null,2)}),r=M(()=>s.trial.type!=="template"||!s.trial.templateConfig?{}:{outputType:s.trial.templateConfig.outputType,extractPattern:s.trial.templateConfig.extractPattern,refusalWords:s.trial.templateConfig.refusalWords,rejectRefusalWords:s.trial.templateConfig.rejectRefusalWords}),w=M(()=>{const n=r.value;return!!(n.outputType||n.extractPattern||n.refusalWords&&n.refusalWords.length>0)}),y=M(()=>s.trial.postProcessingConfig||null),v=M(()=>s.apiCall.response?JSON.stringify({status:s.apiCall.response.status,headers:s.apiCall.response.headers,body:s.apiCall.response.body,latencyMs:s.apiCall.response.latencyMs},null,2):"No response data available"),I=M(()=>s.apiCall.result?JSON.stringify(s.apiCall.result,null,2):"No processed result available");function T(n){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[n]||"default"}function $(){const n=s.trial.configurations[s.apiCall.configurationIndex];return n?.modelSnapshot?.displayName||n?.modelId||`Configuration ${s.apiCall.configurationIndex+1}`}function D(n){return(typeof n=="string"?new Date(n):n).toLocaleString()}function z(n){return n<1e3?`${n}ms`:n<6e4?`${(n/1e3).toFixed(1)}s`:`${Math.floor(n/6e4)}m ${(n%6e4/1e3).toFixed(0)}s`}function A(n){return n==null?"null":typeof n=="string"?n:typeof n=="number"||typeof n=="boolean"?String(n):JSON.stringify(n,null,2)}function u(n){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[n]||n}function c(){p("update:visible",!1)}async function R(){const n={id:s.apiCall.id,status:s.apiCall.status,configuration:$(),provider:m.value,variables:s.apiCall.variables,variableAttributes:s.apiCall.variableAttributes,prompt:s.apiCall.prompt,fullApiResponse:s.apiCall.response,processedResult:s.apiCall.result,extractionConfig:r.value,postProcessingConfig:y.value,created:s.apiCall.created,completed:s.apiCall.completed,duration:d.value?`${d.value}ms`:null,cost:k.value?`$${k.value.toFixed(4)}`:null},g=JSON.stringify(n,null,2);try{await navigator.clipboard.writeText(g),X.success("Details copied to clipboard!")}catch(K){E.error("Failed to copy to clipboard",K),X.error("Failed to copy to clipboard")}}return(n,g)=>{const K=tt,Q=De,x=Es,a=Ps,h=pe,V=be;return o(),Y(V,{open:n.visible,onCancel:g[0]||(g[0]=W=>p("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:F(()=>[e("div",jo,[e("div",qo,[g[10]||(g[10]=e("h3",null,"Overview",-1)),e("div",Go,[e("div",Ko,[g[1]||(g[1]=e("label",null,"Call ID:",-1)),e("span",Qo,_(n.apiCall.id),1)]),e("div",Jo,[g[2]||(g[2]=e("label",null,"Status:",-1)),C(K,{color:T(n.apiCall.status)},{default:F(()=>[L(_(n.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),e("div",Yo,[g[3]||(g[3]=e("label",null,"Configuration:",-1)),e("span",null,_($()),1)]),n.apiCall.repeatIndex!==void 0?(o(),i("div",Xo,[g[4]||(g[4]=e("label",null,"Repeat:",-1)),e("span",null,"#"+_(n.apiCall.repeatIndex+1),1)])):P("",!0),e("div",Zo,[g[5]||(g[5]=e("label",null,"Created:",-1)),e("span",null,_(D(n.apiCall.created)),1)]),n.apiCall.completed?(o(),i("div",en,[g[6]||(g[6]=e("label",null,"Completed:",-1)),e("span",null,_(D(n.apiCall.completed)),1)])):P("",!0),d.value?(o(),i("div",tn,[g[7]||(g[7]=e("label",null,"Duration:",-1)),e("span",null,_(z(d.value)),1)])):P("",!0),n.apiCall.result?.latency?(o(),i("div",sn,[g[8]||(g[8]=e("label",null,"API Latency:",-1)),e("span",null,_(n.apiCall.result.latency)+"ms",1)])):P("",!0)]),m.value?(o(),i("div",an,[g[9]||(g[9]=e("label",null,"Provider/Model:",-1)),e("span",ln,_(m.value),1)])):P("",!0)]),n.apiCall.variables&&Object.keys(n.apiCall.variables).length>0?(o(),i("div",on,[g[11]||(g[11]=e("h3",null,"Variables",-1)),e("div",nn,[(o(!0),i(Z,null,te(n.apiCall.variables,(W,U)=>(o(),i("div",{key:U,class:"variable-group"},[e("div",rn,[e("label",un,_(U)+":",1),e("span",dn,_(W),1)]),n.apiCall.variableAttributes&&n.apiCall.variableAttributes[U]?(o(),i("div",cn,[(o(!0),i(Z,null,te(n.apiCall.variableAttributes[U],(G,N)=>(o(),i("div",{key:N,class:"attribute-item"},[e("label",pn,_(N)+":",1),e("span",fn,_(G),1)]))),128))])):P("",!0)]))),128))])])):P("",!0),e("div",vn,[g[12]||(g[12]=e("h3",null,"Resolved Prompt",-1)),e("div",mn,_(n.apiCall.prompt),1)]),n.apiCall.result?(o(),i("div",gn,[g[34]||(g[34]=e("h3",null,"Response",-1)),n.apiCall.status==="failed"&&n.apiCall.result.error?(o(),i("div",hn,[C(Q,{type:"error",message:n.apiCall.result.error,description:n.apiCall.result.errorType?`Error Type: ${u(n.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):n.apiCall.result.content?(o(),i("div",_n,[e("div",yn,_(n.apiCall.result.content),1),n.apiCall.result.parsedContent!==void 0?(o(),i("div",bn,[g[13]||(g[13]=e("h4",null,"Extracted Value (Original)",-1)),e("div",Tn,_(A(n.apiCall.result.parsedContent)),1)])):P("",!0),n.apiCall.result.postParsedContent!==void 0?(o(),i("div",$n,[g[14]||(g[14]=e("h4",null,"Post-Processed Value",-1)),e("div",Cn,_(A(n.apiCall.result.postParsedContent)),1)])):P("",!0),n.apiCall.result.refused?(o(),i("div",kn,[C(Q,{type:"warning",message:"Response flagged as refusal (Original Extraction)",description:"This response matched configured refusal patterns","show-icon":""})])):P("",!0),n.apiCall.result.postRefused?(o(),i("div",wn,[C(Q,{type:"warning",message:"Response flagged as refusal (Post-Processing)",description:"This response matched post-processing refusal patterns","show-icon":""})])):P("",!0),e("div",Sn,[g[20]||(g[20]=e("h4",null,"Original Extraction Configuration",-1)),e("div",In,[r.value.outputType?(o(),i("div",Rn,[g[15]||(g[15]=e("label",null,"Output Type:",-1)),e("span",Pn,_(r.value.outputType),1)])):P("",!0),r.value.extractPattern?(o(),i("div",En,[g[16]||(g[16]=e("label",null,"Extract Pattern:",-1)),e("span",Vn,_(r.value.extractPattern),1)])):P("",!0),r.value.refusalWords&&r.value.refusalWords.length>0?(o(),i("div",An,[g[17]||(g[17]=e("label",null,"Refusal Words:",-1)),e("span",Fn,_(r.value.refusalWords.join(", ")),1)])):P("",!0),r.value.rejectRefusalWords!==void 0?(o(),i("div",xn,[g[18]||(g[18]=e("label",null,"Reject on Refusal:",-1)),e("span",Dn,_(r.value.rejectRefusalWords?"Yes":"No"),1)])):P("",!0),w.value?P("",!0):(o(),i("div",Ln,g[19]||(g[19]=[e("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),y.value&&y.value.enabled?(o(),i("div",On,[g[28]||(g[28]=e("h4",null,"Post-Processing Configuration",-1)),e("div",Mn,[e("div",Un,[g[22]||(g[22]=e("label",null,"Status:",-1)),e("span",Nn,[C(K,{color:"processing"},{default:F(()=>g[21]||(g[21]=[L("Enabled")])),_:1,__:[21]})])]),y.value.outputType?(o(),i("div",zn,[g[23]||(g[23]=e("label",null,"Output Type:",-1)),e("span",Wn,_(y.value.outputType),1)])):P("",!0),y.value.extractPattern?(o(),i("div",Hn,[g[24]||(g[24]=e("label",null,"Extract Pattern:",-1)),e("span",Bn,_(y.value.extractPattern),1)])):P("",!0),y.value.refusalWords&&y.value.refusalWords.length>0?(o(),i("div",jn,[g[25]||(g[25]=e("label",null,"Refusal Words:",-1)),e("span",qn,_(y.value.refusalWords.join(", ")),1)])):P("",!0),y.value.rejectRefusalWords!==void 0?(o(),i("div",Gn,[g[26]||(g[26]=e("label",null,"Reject on Refusal:",-1)),e("span",Kn,_(y.value.rejectRefusalWords?"Yes":"No"),1)])):P("",!0),y.value.updatedAt?(o(),i("div",Qn,[g[27]||(g[27]=e("label",null,"Last Updated:",-1)),e("span",Jn,_(D(y.value.updatedAt)),1)])):P("",!0)])])):P("",!0),n.apiCall.result.usage?(o(),i("div",Yn,[g[33]||(g[33]=e("h4",null,"Token Usage",-1)),e("div",Xn,[e("div",Zn,[g[29]||(g[29]=e("label",null,"Prompt Tokens:",-1)),e("span",null,_(n.apiCall.result.usage.prompt_tokens||0),1)]),e("div",ei,[g[30]||(g[30]=e("label",null,"Completion Tokens:",-1)),e("span",null,_(n.apiCall.result.usage.completion_tokens||0),1)]),e("div",ti,[g[31]||(g[31]=e("label",null,"Total Tokens:",-1)),e("span",null,_(n.apiCall.result.usage.total_tokens||0),1)]),k.value?(o(),i("div",si,[g[32]||(g[32]=e("label",null,"Cost:",-1)),e("span",null,"$"+_(k.value.toFixed(4)),1)])):P("",!0)])])):P("",!0)])):P("",!0)])):P("",!0),C(a,{ghost:""},{default:F(()=>[C(x,{key:"raw",header:"Raw Data"},{default:F(()=>[e("div",ai,[g[35]||(g[35]=e("h4",null,"HTTP Request",-1)),e("pre",li,_(S.value),1),n.apiCall.response?(o(),i("h4",oi,"Full API Response")):P("",!0),n.apiCall.response?(o(),i("pre",ni,_(v.value),1)):P("",!0),n.apiCall.result?(o(),i("h4",ii,"Processed Result")):P("",!0),n.apiCall.result?(o(),i("pre",ri,_(I.value),1)):P("",!0)])]),_:1})]),_:1})]),e("div",ui,[C(h,{onClick:c,size:"large"},{default:F(()=>g[36]||(g[36]=[L(" Close ")])),_:1,__:[36]}),C(h,{type:"primary",onClick:R,size:"large"},{default:F(()=>[C(H(et)),g[37]||(g[37]=L(" Copy Details "))]),_:1,__:[37]})])]),_:1},8,["open"])}}}),ci=ae(di,[["__scopeId","data-v-61b8259f"]]);class pi{constructor(){re(this,"apiCalls",Ce([]));re(this,"currentTrialId",Ce(null));re(this,"executionProgress",Ce(null));re(this,"isStreaming",Ce(!1));re(this,"activeTab",Ce("tasks"));re(this,"_progressCache",null);re(this,"_progressDirty",!0);re(this,"_progressLastCount",0)}get progress(){return M(()=>this.calculateProgress())}calculateProgress(){const t=this.apiCalls.value;if(!this._progressDirty&&this._progressLastCount===t.length&&this._progressCache)return this._progressCache;const s=performance.now();if(t.length===0)return this._progressCache={trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,lastUpdated:new Date},this._progressDirty=!1,this._progressLastCount=0,this._progressCache;let p=0,f=0,d=0,m=0,k=0;`${t.length}`,this._progressDirty;for(const r of t)switch(r.status){case"completed":p++;break;case"failed":f++;break;case"cancelled":d++;break;case"pending":m++;break;case"running":k++;break}const S=performance.now();return this._progressCache={trialId:this.currentTrialId.value||"",total:t.length,completed:p,failed:f,cancelled:d,pending:m,running:k,lastUpdated:new Date},this._progressDirty=!1,this._progressLastCount=t.length,`${(S-s).toFixed(1)}${p}${t.length}${k}${m}`,this._progressCache}updateApiCalls(t){const s=this.apiCalls.value.length,p=t.length;this._progressDirty=!0,this.apiCalls.value=Object.freeze(t),(Math.abs(p-s)>10||p<100)&&`${t.length}${s}`}updateProgress(t){t.type,this.executionProgress.value=t}setStreaming(t){this.isStreaming.value=t}setCurrentTrial(t){this.currentTrialId.value=t,t||this.clear()}setActiveTab(t){this.activeTab.value!==t&&(`${this.activeTab.value}${t}`,this.activeTab.value=t)}clear(){this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(t){try{const s=await We.apiCalls.where("trialId").equals(t).toArray();`${s.length}`,s.sort((p,f)=>{const d=S=>{switch(S){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},m=d(p.status),k=d(f.status);return m!==k?m-k:p.order-f.order}),this.updateApiCalls(s),this.setCurrentTrial(t)}catch(s){throw E.error("STORE_V4: Failed to refresh from database:",s),s}}}let Ve=null;function Ie(){return Ve||(Ve=new pi),Ve}typeof window<"u"&&(window.__trialDataStoreV4=()=>Ve);const fi={class:"post-processing-modal"},vi={key:2,class:"current-extraction"},mi={class:"parser-info"},gi={class:"parser-name"},hi={key:0,class:"test-results"},_i={key:1,class:"statistics"},yi={class:"stat-item"},bi={class:"stat-value"},Ti={class:"stat-item"},$i={class:"stat-value"},Ci={class:"stat-item"},ki={class:"stat-value"},wi={class:"stat-item"},Si={class:"stat-value"},Ii={class:"modal-actions"},Ri=le({__name:"PostProcessingModalV2",props:{visible:{type:Boolean},trial:{}},emits:["close"],setup(l,{emit:t}){const s=l,p=t,f=Ie(),d=Hs(),m=j(s.visible),k=j(!1),S=j(!1),r=j(!1),w=j(null),y=j({enabled:!1,postParserId:null}),v=j([]),I=j(null),T=[{title:"Variables",dataIndex:"variables",key:"variables",width:200,customRender:({text:a})=>Object.entries(a).map(([h,V])=>`${h}: ${V}`).join(", ")},{title:"Original",dataIndex:"original",key:"original",slots:{customRender:"original"}},{title:"Post-Processed",dataIndex:"postProcessed",key:"postProcessed",slots:{customRender:"postProcessed"}},{title:"Changed",dataIndex:"changed",key:"changed",width:100,slots:{customRender:"changed"}}],$=M(()=>s.trial.parserId?d.parsers.find(a=>a.id===s.trial.parserId):null);function D(a){switch(a){case"regex":return"blue";case"javascript":return"orange";case"python":return"green";default:return"default"}}function z(a){return a===void 0?"(no match)":a===null?"null":typeof a=="string"&&a.length>50?a.substring(0,50)+"...":String(a)}function A(a){a||(v.value=[],I.value=null)}function u(){S.value=!0}function c(a){w.value=a,r.value=!0}async function R(a,h){if(!a||!h){v.value=[],I.value=null;return}await n(h),await g(h)}async function n(a){const h=f.apiCalls.value.filter(W=>W.result?.content).slice(0,10),V=[];for(const W of h){const U=await at.executeParser(W.result.content,a);V.push({id:W.id,variables:W.variables,original:W.result.parsedContent,postProcessed:U.success?U.value:null,changed:U.success&&U.value!==W.result.parsedContent})}v.value=V}async function g(a){if(!f.apiCalls.value.length){I.value=null;return}const h=f.apiCalls.value,V=h.length,W=h.filter(N=>N.result?.content).length;let U=0,G=0;for(const N of h){if(!N.result?.content)continue;const b=await at.executeParser(N.result.content,a);b.success&&b.value!==void 0&&(U++,b.value!==N.result.parsedContent&&G++)}I.value={total:V,withContent:W,matches:U,changed:G}}async function K(){k.value=!0;try{const a=await nt.updatePostParserId(s.trial.id,null,!1);if(a.ok)y.value.enabled=!1,y.value.postParserId=null,X.success("Post-processing disabled"),await f.refreshFromDatabase(s.trial.id);else throw a.error}catch(a){E.error("Failed to reset post-processing:",a),X.error("Failed to reset post-processing")}finally{k.value=!1}}async function Q(){if(!y.value.enabled){X.warning("Please enable post-processing");return}if(!y.value.postParserId){X.warning("Please select a parser");return}k.value=!0;try{const a=f.apiCalls.value.some(W=>W.status==="completed"&&W.result?.content),h=a&&await new Promise(W=>{W(a?confirm("Apply post-processing to existing completed calls?"):!1)}),V=await nt.updatePostParserId(s.trial.id,y.value.postParserId,h);if(V.ok)X.success(h?"Post-processing applied to all calls":"Post-processing will apply to future calls"),await f.refreshFromDatabase(s.trial.id),x();else throw V.error}catch(a){E.error("Failed to apply post-processing:",a),X.error("Failed to apply post-processing")}finally{k.value=!1}}function x(){p("close")}return ce(async()=>{if(await d.initialize(),s.trial.postParserId){y.value.enabled=!0,y.value.postParserId=s.trial.postParserId;const a=d.parsers.find(h=>h.id===s.trial.postParserId);a&&(await n(a),await g(a))}else s.trial.postProcessingConfig?.enabled&&(y.value.enabled=!0,X.info("Legacy post-processing config detected. Please select a parser to continue."))}),oe(()=>s.visible,a=>{m.value=a}),oe(m,a=>{a||p("close")}),(a,h)=>{const V=De,W=tt,U=Fs,G=As,N=xs,b=Ls,q=Ds,J=pe,ne=Vs,ue=be;return o(),Y(ue,{visible:m.value,"onUpdate:visible":h[2]||(h[2]=de=>m.value=de),title:"Post-Process Extraction",width:"80%",footer:null,onCancel:x},{default:F(()=>[e("div",fi,[a.trial.status==="running"?(o(),Y(V,{key:0,message:"Trial is currently running",description:"Post-processing will apply to all completed calls and future results as they arrive.",type:"info","show-icon":"",style:{"margin-bottom":"20px"}})):a.trial.status==="draft"?(o(),Y(V,{key:1,message:"Trial not started",description:"Configure post-processing now. It will apply when the trial runs.",type:"warning","show-icon":"",style:{"margin-bottom":"20px"}})):P("",!0),$.value?(o(),i("div",vi,[h[3]||(h[3]=e("h4",null,"Current Primary Parser",-1)),e("div",mi,[e("span",gi,_($.value.name),1),C(W,{color:D($.value.type)},{default:F(()=>[L(_($.value.type),1)]),_:1},8,["color"]),C(W,null,{default:F(()=>[L(_($.value.outputType),1)]),_:1})])])):P("",!0),C(ne,{model:y.value,layout:"vertical",onFinish:Q},{default:F(()=>[C(G,{label:"Enable Post-Processing"},{default:F(()=>[C(U,{checked:y.value.enabled,"onUpdate:checked":h[0]||(h[0]=de=>y.value.enabled=de),onChange:A},{checkedChildren:F(()=>h[4]||(h[4]=[L("ON")])),unCheckedChildren:F(()=>h[5]||(h[5]=[L("OFF")])),_:1},8,["checked"])]),_:1}),C(G,{label:"Post-Processing Parser",disabled:!y.value.enabled},{default:F(()=>[C(Ws,{modelValue:y.value.postParserId,"onUpdate:modelValue":h[1]||(h[1]=de=>y.value.postParserId=de),disabled:!y.value.enabled,"allow-create":!0,"show-preview":!0,placeholder:"Select or create a parser for post-processing",onCreate:u,onTest:c,onChange:R},null,8,["modelValue","disabled"])]),_:1},8,["disabled"]),v.value.length>0&&y.value.enabled?(o(),i("div",hi,[h[6]||(h[6]=e("h4",null,"Preview Results (First 10 calls)",-1)),C(N,{columns:T,"data-source":v.value,pagination:!1,size:"small",scroll:{x:800}},{original:F(({text:de})=>[e("code",null,_(z(de)),1)]),postProcessed:F(({text:de,record:Me})=>[e("code",{class:se({"value-changed":Me.changed})},_(z(de)),3)]),changed:F(({text:de})=>[C(W,{color:de?"green":"default"},{default:F(()=>[L(_(de?"Changed":"Same"),1)]),_:2},1032,["color"])]),_:1},8,["data-source"])])):P("",!0),I.value&&y.value.enabled?(o(),i("div",_i,[C(q,{gutter:16},{default:F(()=>[C(b,{span:6},{default:F(()=>[e("div",yi,[h[7]||(h[7]=e("div",{class:"stat-label"},"Total Calls",-1)),e("div",bi,_(I.value.total),1)])]),_:1}),C(b,{span:6},{default:F(()=>[e("div",Ti,[h[8]||(h[8]=e("div",{class:"stat-label"},"With Content",-1)),e("div",$i,_(I.value.withContent),1)])]),_:1}),C(b,{span:6},{default:F(()=>[e("div",Ci,[h[9]||(h[9]=e("div",{class:"stat-label"},"Matches",-1)),e("div",ki,_(I.value.matches),1)])]),_:1}),C(b,{span:6},{default:F(()=>[e("div",wi,[h[10]||(h[10]=e("div",{class:"stat-label"},"Changed",-1)),e("div",Si,_(I.value.changed),1)])]),_:1})]),_:1})])):P("",!0),e("div",Ii,[C(J,{onClick:K,disabled:!y.value.enabled},{default:F(()=>h[11]||(h[11]=[L(" Reset ")])),_:1,__:[11]},8,["disabled"]),C(J,{onClick:x},{default:F(()=>h[12]||(h[12]=[L(" Cancel ")])),_:1,__:[12]}),C(J,{type:"primary","html-type":"submit",loading:k.value,disabled:!y.value.enabled||!y.value.postParserId},{default:F(()=>h[13]||(h[13]=[L(" Apply Post-Processing ")])),_:1,__:[13]},8,["loading","disabled"])])]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),Pi=ae(Ri,[["__scopeId","data-v-2ab953e4"]]),Ei={class:"trial-results-table"},Vi={class:"table-container"},Ai={class:"results-table"},Fi={key:0,class:"col-status"},xi={key:1,class:"col-configuration"},Di={key:2,class:"col-repeat"},Li={key:3,class:"col-variables"},Oi={key:4,class:"col-response"},Mi={key:5,class:"col-parsed"},Ui={key:6,class:"col-post-processed"},Ni={key:0,class:"post-process-indicator"},zi={key:7,class:"col-length"},Wi={key:8,class:"col-latency"},Hi={class:"results-table"},Bi=["onClick"],ji={key:0,class:"col-status"},qi={class:"status-cell"},Gi={class:"status-time"},Ki={key:1,class:"col-configuration"},Qi={key:2,class:"col-repeat"},Ji={key:3,class:"col-variables"},Yi={class:"variable-tags"},Xi={key:0,class:"var-item"},Zi={key:1,class:"var-item"},er={key:2},tr={key:3},sr={key:4,class:"col-response"},ar={class:"response-content"},lr={key:5,class:"col-parsed"},or={key:6,class:"col-post-processed"},nr={key:7,class:"col-length"},ir={key:8,class:"col-latency"},rr={key:1,class:"results-table"},ur={key:0,class:"col-status"},dr={key:1,class:"col-configuration"},cr={key:2,class:"col-repeat"},pr={key:3,class:"col-variables"},fr={key:4,class:"col-response"},vr={key:5,class:"col-parsed"},mr={key:6,class:"col-post-processed"},gr={key:0,class:"post-process-indicator"},hr={key:7,class:"col-length"},_r={key:8,class:"col-latency"},yr=["onClick"],br={key:0,class:"col-status"},Tr={class:"status-cell"},$r={class:"status-time"},Cr={key:1,class:"col-configuration"},kr={key:2,class:"col-repeat"},wr={key:3,class:"col-variables"},Sr={class:"variable-tags"},Ir={key:0,class:"var-item"},Rr={key:1,class:"var-item"},Pr={key:2},Er={key:3},Vr={key:4,class:"col-response"},Ar={class:"response-content"},Fr={key:5,class:"col-parsed"},xr={key:6,class:"col-post-processed"},Dr={key:7,class:"col-length"},Lr={key:8,class:"col-latency"},Or={key:0},Mr=["colspan"],Ur={key:0},Nr={key:1},ct="trial-results-visible-columns",zr=le({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(l){const t=l,s=j("all"),p=j([]),f=j(""),d=j(["status","configuration","variables","response","parsedResponse","postProcessedResponse","length","latency"]),m=j(null),k=j(!1),S=Ie(),r=M(()=>S.apiCalls?.value||[]),w=M(()=>t.apiCalls||r.value);oe(w,(h,V)=>{const W=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${V?.length||0} to ${h.length} calls`),setTimeout(()=>{const U=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(U-W).toFixed(1)}ms`)},0)});const y=h=>{if(!f.value)return h;const V=f.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),W=new RegExp(`(${V})`,"gi");return h.replace(W,"<mark>$1</mark>")},v=M(()=>{const h=performance.now();if(!(s.value!=="all"||p.value.length>0||f.value))return performance.now()-h>5&&E.info(`V4_OPTIMIZE: No filtering needed, returning ${w.value.length} calls directly`),w.value;let W=w.value.filter(G=>{if(s.value!=="all"&&G.status!==s.value||p.value.length>0&&!p.value.includes(String(G.configurationIndex)))return!1;if(f.value){const N=f.value.toLowerCase();if(!(G.prompt?.toLowerCase().includes(N)||G.result?.content?.toLowerCase().includes(N)||G.result?.error?.toLowerCase().includes(N)))return!1}return!0});const U=performance.now();return U-h>10&&E.info(`V4_OPTIMIZE: Filtered ${w.value.length} â†’ ${W.length} calls in ${(U-h).toFixed(1)}ms`),W});oe(v,(h,V)=>{const W=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${V?.length||0} to ${h.length} items`),setTimeout(()=>{const U=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(U-W).toFixed(1)}ms`)},0)});const I=M(()=>w.value),T=M(()=>w.value.length),$=M(()=>t.trial.configurations.some(h=>h.repeatCount>1)),D=M(()=>60);function z(h){}function A(h){const V=t.trial.configurations[h];return V?V.modelSnapshot?.displayName||`${V.modelId}`:`Config ${h+1}`}function u(h){return h.status==="pending"?"Waiting...":h.status==="running"?"Processing...":h.status==="failed"?h.result?.errorType==="refusal_detected"||h.result?.error==="REFUSED"?h.result?.content||"REFUSED":h.result?.error||"Error occurred":h.result?.content||""}function c(h){if(!h.result)return"";if(h.result.parsedContent!==void 0){const V=h.result.parsedContent;return V===null?"null":typeof V=="string"?V:typeof V=="number"||typeof V=="boolean"?String(V):JSON.stringify(V)}return""}function R(h){if(!h.result||h.result.postParsedContent===void 0)return"";const V=h.result.postParsedContent;return V===null?"null":V==="REFUSED"||h.result.postRefused?"REFUSED":typeof V=="string"?V:typeof V=="number"||typeof V=="boolean"?String(V):JSON.stringify(V)}function n(h){const V=h.result?.content||"";if(!V)return"";const W=V.length;return W>1e3?`${(W/1e3).toFixed(1)}k chars`:`${W} chars`}function g(h){return h?h<1e3?`${h}ms`:`${(h/1e3).toFixed(1)}s`:""}function K(h){let V;switch(h.status){case"completed":case"failed":V=h.completed;break;case"running":V=h.started;break;case"pending":case"cancelled":V=h.created;break}if(!V)return"";const W=new Date(V),U=W.getHours().toString().padStart(2,"0"),G=W.getMinutes().toString().padStart(2,"0"),N=W.getSeconds().toString().padStart(2,"0");return`Â Â ${U}:${G}:${N}`}function Q(h){return h?h<1e3?"latency-fast":h<5e3?"latency-medium":"latency-slow":""}function x(h){return y(h)}function a(h){m.value=h}return oe(d,h=>{localStorage.setItem(ct,JSON.stringify(h))},{deep:!0}),ce(()=>{const h=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${w.value.length} calls`);const V=localStorage.getItem(ct);if(V)try{d.value=JSON.parse(V)}catch{}ye(()=>{const W=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(W-h).toFixed(1)}ms`),setTimeout(()=>{const U=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(U-h).toFixed(1)}ms`)},100)}),setTimeout(()=>{const W=performance.now();E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(W-h).toFixed(1)}ms`)},0)}),we(()=>{E.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${w.value.length} calls`)}),Se(()=>{E.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),ge(()=>{E.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(h,V)=>{const W=mt("dompurify-html");return o(),i("div",Ei,[C(Bo,{"status-filter":s.value,"onUpdate:statusFilter":V[0]||(V[0]=U=>s.value=U),"config-filter":p.value,"onUpdate:configFilter":V[1]||(V[1]=U=>p.value=U),"search-query":f.value,"onUpdate:searchQuery":V[2]||(V[2]=U=>f.value=U),"visible-columns":d.value,"onUpdate:visibleColumns":V[3]||(V[3]=U=>d.value=U),configurations:h.trial.configurations,"api-calls":I.value,"show-repeat-column":$.value,onOpenPostProcessing:V[4]||(V[4]=U=>k.value=!0)},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),e("div",Vi,[T.value>100?(o(),Y(H(Oe),{key:0,class:"results-scroller",items:Array.from(v.value),"item-size":D.value,"key-field":"id",buffer:10,onVisibleRange:z},{before:F(()=>[e("table",Ai,[e("thead",null,[e("tr",null,[d.value.includes("status")?(o(),i("th",Fi,"Status")):P("",!0),d.value.includes("configuration")?(o(),i("th",xi,"Configuration")):P("",!0),d.value.includes("repeat")&&$.value?(o(),i("th",Di,"Repeat")):P("",!0),d.value.includes("variables")?(o(),i("th",Li,"Variables")):P("",!0),d.value.includes("response")?(o(),i("th",Oi,"Response")):P("",!0),d.value.includes("parsedResponse")?(o(),i("th",Mi,"Parsed Response")):P("",!0),d.value.includes("postProcessedResponse")?(o(),i("th",Ui,[V[7]||(V[7]=L(" Post-Processed ")),h.trial.postProcessingConfig?.enabled?(o(),i("span",Ni,"âœ¨")):P("",!0)])):P("",!0),d.value.includes("length")?(o(),i("th",zi,"Length")):P("",!0),d.value.includes("latency")?(o(),i("th",Wi,"Latency")):P("",!0)])])])]),default:F(({item:U})=>[e("table",Hi,[e("tbody",null,[e("tr",{class:se(["result-row",`status-${U.status}`]),onClick:G=>a(U)},[d.value.includes("status")?(o(),i("td",ji,[e("div",qi,[e("span",{class:se(["status-tag",`status-${U.status}`])},_(U.status.toUpperCase()),3),e("span",Gi,_(K(U)),1)])])):P("",!0),d.value.includes("configuration")?(o(),i("td",Ki,_(A(U.configurationIndex)),1)):P("",!0),d.value.includes("repeat")&&$.value?(o(),i("td",Qi," #"+_((U.repeatIndex||0)+1),1)):P("",!0),d.value.includes("variables")?(o(),i("td",Ji,[e("div",Yi,[(o(!0),i(Z,null,te(Object.entries(U.variables),([G,N],b)=>(o(),i(Z,{key:G},[V[9]||(V[9]=e("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(U.variables).length<=2?(o(),i("span",Xi,_(G)+": "+_(N),1)):(o(),i("span",Zi,_(N),1)),Object.keys(U.variables).length===2&&b===0?(o(),i("span",er,V[8]||(V[8]=[e("br",null,null,-1)]))):b<Object.keys(U.variables).length-1?(o(),i("span",tr,_("Â Â "))):P("",!0)],64))),128))])])):P("",!0),d.value.includes("response")?(o(),i("td",sr,[$e(e("div",ar,null,512),[[W,x(u(U)),"apiResponse"]])])):P("",!0),d.value.includes("parsedResponse")?(o(),i("td",lr,_(c(U)),1)):P("",!0),d.value.includes("postProcessedResponse")?(o(),i("td",or,_(R(U)),1)):P("",!0),d.value.includes("length")?(o(),i("td",nr,_(n(U)),1)):P("",!0),d.value.includes("latency")?(o(),i("td",ir,[e("span",{class:se(Q(U.response?.latencyMs))},_(g(U.response?.latencyMs)),3)])):P("",!0)],10,Bi)])])]),_:1},8,["items","item-size"])):(o(),i("table",rr,[e("thead",null,[e("tr",null,[d.value.includes("status")?(o(),i("th",ur,"Status")):P("",!0),d.value.includes("configuration")?(o(),i("th",dr,"Configuration")):P("",!0),d.value.includes("repeat")&&$.value?(o(),i("th",cr,"Repeat")):P("",!0),d.value.includes("variables")?(o(),i("th",pr,"Variables")):P("",!0),d.value.includes("response")?(o(),i("th",fr,"Response")):P("",!0),d.value.includes("parsedResponse")?(o(),i("th",vr,"Parsed Response")):P("",!0),d.value.includes("postProcessedResponse")?(o(),i("th",mr,[V[10]||(V[10]=L(" Post-Processed ")),h.trial.postProcessingConfig?.enabled?(o(),i("span",gr,"âœ¨")):P("",!0)])):P("",!0),d.value.includes("length")?(o(),i("th",hr,"Length")):P("",!0),d.value.includes("latency")?(o(),i("th",_r,"Latency")):P("",!0)])]),e("tbody",null,[(o(!0),i(Z,null,te(v.value,U=>(o(),i("tr",{key:U.id,class:se(["result-row",`status-${U.status}`]),onClick:G=>a(U)},[d.value.includes("status")?(o(),i("td",br,[e("div",Tr,[e("span",{class:se(["status-tag",`status-${U.status}`])},_(U.status.toUpperCase()),3),e("span",$r,_(K(U)),1)])])):P("",!0),d.value.includes("configuration")?(o(),i("td",Cr,_(A(U.configurationIndex)),1)):P("",!0),d.value.includes("repeat")&&$.value?(o(),i("td",kr," #"+_((U.repeatIndex||0)+1),1)):P("",!0),d.value.includes("variables")?(o(),i("td",wr,[e("div",Sr,[(o(!0),i(Z,null,te(U.variables,(G,N,b)=>(o(),i(Z,{key:N},[V[12]||(V[12]=e("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(U.variables).length<=2?(o(),i("span",Ir,_(N)+": "+_(G),1)):(o(),i("span",Rr,_(G),1)),Object.keys(U.variables).length===2&&b===0?(o(),i("span",Pr,V[11]||(V[11]=[e("br",null,null,-1)]))):b<Object.keys(U.variables).length-1?(o(),i("span",Er,_("Â Â "))):P("",!0)],64))),128))])])):P("",!0),d.value.includes("response")?(o(),i("td",Vr,[$e(e("div",Ar,null,512),[[W,x(u(U)),"apiResponse"]])])):P("",!0),d.value.includes("parsedResponse")?(o(),i("td",Fr,_(c(U)),1)):P("",!0),d.value.includes("postProcessedResponse")?(o(),i("td",xr,_(R(U)),1)):P("",!0),d.value.includes("length")?(o(),i("td",Dr,_(n(U)),1)):P("",!0),d.value.includes("latency")?(o(),i("td",Lr,[e("span",{class:se(Q(U.response?.latencyMs))},_(g(U.response?.latencyMs)),3)])):P("",!0)],10,yr))),128)),v.value.length===0?(o(),i("tr",Or,[e("td",{colspan:d.value.length,class:"empty-state"},[r.value.length===0?(o(),i("div",Ur," No API calls yet. Start the trial to begin execution. ")):(o(),i("div",Nr," No results match your filters. "))],8,Mr)])):P("",!0)])]))]),m.value?(o(),Y(ci,{key:0,visible:!!m.value,"api-call":m.value,trial:h.trial,"onUpdate:visible":V[5]||(V[5]=U=>m.value=null)},null,8,["visible","api-call","trial"])):P("",!0),k.value?(o(),Y(Pi,{key:1,visible:k.value,trial:h.trial,onClose:V[6]||(V[6]=U=>k.value=!1)},null,8,["visible","trial"])):P("",!0)])}}}),Wr=ae(zr,[["__scopeId","data-v-a566786b"]]),Hr={class:"trial-analysis-view"},Br=le({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(l){const t=l;return ce(()=>{const s=performance.now();E.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${t.trial.id}`),ye(()=>{const p=performance.now();E.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(p-s).toFixed(1)}ms`)}),setTimeout(()=>{const p=performance.now();E.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(p-s).toFixed(1)}ms`)},0)}),we(()=>{E.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${t.trial.id}`)}),Se(()=>{E.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${t.trial.id}`)}),ge(()=>{E.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${t.trial.id}`)}),(s,p)=>(o(),i("div",Hr,[C(Wr,{trial:s.trial,progress:s.progress,"is-executing":s.isExecuting,"api-calls":s.apiCalls,"is-streaming":s.isStreaming,"is-loading":s.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),jr=ae(Br,[["__scopeId","data-v-602f5d5a"]]);function qr(l,t){const s=new Set,p=new Set,f=new Set;l.forEach(w=>{w.variables&&Object.keys(w.variables).forEach(y=>s.add(y)),w.variableAttributes&&Object.values(w.variableAttributes).forEach(y=>{y&&Object.keys(y).forEach(v=>p.add(v))})});const d=Array.from(s).sort(),m=Array.from(p).sort(),k=Array.from(f).sort(),S=[],r=["success","refused","parsed_response",...S,...k];return{categorical:[...d,...m,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...S].sort(),extracted:r}}function Fe(l,t,s){switch(t){case"model":return s&&l.configurationIndex<s.configurations.length&&s.configurations[l.configurationIndex].modelId||"Unknown";case"status":return l.status;case"response_time":return l.response?.latencyMs||0;case"total_tokens":if(l.response?.body?.usage){const p=l.response.body.usage;return p.total_tokens||p.prompt_tokens+p.completion_tokens||0}return 0;case"prompt_tokens":return l.response?.body?.usage?.prompt_tokens||l.response?.body?.usage?.input_tokens||0;case"completion_tokens":return l.response?.body?.usage?.completion_tokens||l.response?.body?.usage?.output_tokens||0;case"error_type":return l.result?.errorType||(l.result?.success===!1?"api_error":"success");case"success":return l.result?.success?1:0;case"refused":return l.result?.refused?1:0;case"parsed_response":if(l.result?.parsedContent!==void 0){const p=l.result.parsedContent;return typeof p=="object"?JSON.stringify(p):p}return null}if(l.variables?.[t]!==void 0)return l.variables[t];if(l.variableAttributes)for(const p of Object.keys(l.variableAttributes)){const f=l.variableAttributes[p];if(f&&f[t]!==void 0)return f[t]}return null}const Re={count:{label:"Count",calculate:l=>l.length,format:l=>l.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?t.reduce((s,p)=>s+p,0):null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},mean:{label:"Mean",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?t.reduce((s,p)=>s+p,0)/t.length:null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},median:{label:"Median",calculate:l=>{const t=l.map(f=>typeof f=="number"?f:null).filter(f=>f!==null);if(t.length===0)return null;const s=[...t].sort((f,d)=>f-d),p=Math.floor(s.length/2);return s.length%2===0?(s[p-1]+s[p])/2:s[p]},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},mode:{label:"Mode",calculate:l=>{if(l.length===0)return null;const t=new Map;l.forEach(f=>t.set(f,(t.get(f)||0)+1));let s=0,p=null;return t.forEach((f,d)=>{f>s&&(s=f,p=d)}),{value:p,count:s,total:l.length}},format:l=>l?`${l.value} (${l.count}/${l.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:l=>{const t=l.map(f=>typeof f=="number"?f:null).filter(f=>f!==null);if(t.length<=1)return null;const s=t.reduce((f,d)=>f+d,0)/t.length;return t.reduce((f,d)=>f+Math.pow(d-s,2),0)/(t.length-1)},format:l=>l?.toFixed(3)||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:l=>{const t=Re.variance.calculate(l);return t!==null?Math.sqrt(t):null},format:l=>l?.toFixed(3)||"-",needsNumeric:!0},min:{label:"Min",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?Math.min(...t):null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},max:{label:"Max",calculate:l=>{const t=l.map(s=>typeof s=="number"?s:null).filter(s=>s!==null);return t.length>0?Math.max(...t):null},format:l=>l?.toFixed(2)||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(l,t)=>{const s=t.filter(p=>p.result?.success).length;return t.length>0?s/t.length:0},format:l=>`${Math.round(l*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(l,t)=>{const s=t.filter(p=>p.result?.refused).length;return t.length>0?s/t.length:0},format:l=>`${Math.round(l*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(l,t)=>{const s=t.filter(p=>p.response?.latencyMs).map(p=>p.response.latencyMs);return s.length>0?s.reduce((p,f)=>p+f,0)/s.length:null},format:l=>l?`${Math.round(l)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function pt(l,t,s){const p=performance.now(),f=new Map,d=new Set,m=new Set,k=new Map,S=(u,c)=>{k.has(c)||k.set(c,new Map);const R=k.get(c);return R.has(u)||R.set(u,Fe(u,c,s)),R.get(u)};for(const u of l){const c=String(S(u,t.rowField)||"Unknown"),R=String(S(u,t.columnField)||"Unknown");d.add(c),m.add(R),f.has(c)||f.set(c,new Map);const n=f.get(c);n.has(R)||n.set(R,[]),n.get(R).push(u)}const r=performance.now()-p;r>50&&`${l.length}${r.toFixed(1)}`;const w=u=>u.every(R=>!isNaN(Number(R))&&R.trim()!=="")?u.sort((R,n)=>Number(R)-Number(n)):u.sort(),y=(u,c)=>(s&&(s.type,s.type),w(u)),v=t.rowSort==="original"?y(Array.from(d),t.rowField):w(Array.from(d)),I=t.columnSort==="original"?y(Array.from(m),t.columnField):w(Array.from(m)),T=Re[t.aggregation];function $(u,c=!1){const R=c?u.map(Q=>S(Q,t.valueField)):u.map(Q=>Fe(Q,t.valueField,s));if(!T||typeof T.calculate!="function")return E.error("Invalid aggregation function:",t.aggregation,T),{value:null,count:u.length,apiCalls:u,rawValues:R,error:"Invalid aggregation function"};const n={nonNumeric:0,nullUndefined:0};return T.needsNumeric&&(n.nonNumeric=R.filter(Q=>typeof Q!="number").length),n.nullUndefined=R.filter(Q=>Q==null).length,{value:T.usesApiCalls?T.calculate(R,u):T.calculate(R),count:u.length,apiCalls:u,rawValues:R,excludedCounts:n}}const D=v.map(u=>{const c=[],R=[];return I.forEach(n=>{const g=f.get(u)?.get(n)||[];c.push(g.length>0?$(g,!0):null),R.push(...g)}),{label:u,cells:c,total:$(R,!0)}}),z=I.map(u=>{const c=[];return v.forEach(R=>{const n=f.get(R)?.get(u)||[];c.push(...n)}),$(c,!0)}),A=performance.now()-p;return A>100&&`${A.toFixed(1)}${l.length}`,{rows:D,columns:I,totals:z,grandTotal:$(l,!0)}}function he(l,t){return!l||l.value===null?"-":Re[t].format(l.value)}function Gr(l){if(!l||Object.keys(l).length===0)return"";const t=[];return l.temperature!==void 0&&t.push(`T:${l.temperature}`),l.max_tokens!==void 0?t.push(`${l.max_tokens}t`):l.maxTokens!==void 0?t.push(`${l.maxTokens}t`):l.num_predict!==void 0&&t.push(`${l.num_predict}t`),l.top_p!==void 0&&t.push(`p:${l.top_p}`),l.top_k!==void 0&&t.push(`k:${l.top_k}`),t.length>0?`(${t.join(", ")})`:""}function Kr(l,t,s,p=j({}),f={}){const{debounceMs:d=100}=f,m=j({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),k=j({categorical:[],numeric:[],extracted:[]}),S=j(!1),r=j(0),w=M(()=>{const T=p.value;return Object.values(T).some(D=>D!=="")?l.value.filter(D=>{if(T.model&&T.model!==""){if(!s.value||D.configurationIndex>=s.value.configurations.length)return!1;const z=s.value.configurations[D.configurationIndex],A=z.modelId||"Unknown",u=Gr(z.parameters);if((u?`${A} ${u}`:A)!==T.model)return!1}if(T.status&&T.status!==""&&D.status!==T.status)return!1;for(const[z,A]of Object.entries(T))if(A&&A!==""&&z!=="model"&&z!=="status"&&D.variables?.[z]!==A)return!1;return!0}):l.value}),y=Ne(()=>{if(w.value.length===0){m.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}S.value=!0;const T=performance.now();try{m.value=pt(w.value,t.value,s.value);const $=performance.now()-T;r.value=$,E.debug("Pivot data computed (config change)",{apiCallCount:w.value.length,computeTimeMs:$,rowCount:m.value.rows.length,columnCount:m.value.columns.length})}catch($){E.error("Error computing pivot data",$)}finally{S.value=!1}},d),v=Ne(()=>{if(w.value.length===0){m.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}S.value=!0;const T=performance.now();try{m.value=pt(w.value,t.value,s.value);const $=performance.now()-T;r.value=$,E.debug("Pivot data computed (stream update)",{apiCallCount:w.value.length,computeTimeMs:$,rowCount:m.value.rows.length,columnCount:m.value.columns.length})}catch($){E.error("Error computing pivot data",$)}finally{S.value=!1}},100),I=Ne(()=>{k.value=qr(l.value,s.value)},200);return oe([t],()=>{y()},{deep:!0}),oe(w,(T,$)=>{const D=typeof window<"u"?window.__trialDataStoreV4?.():null;if(D&&D.activeTab?.value!=="pivot"){`${D.activeTab?.value}`;return}const z=$?.length||0,A=T.length;(z!==A||A>0)&&v()},{immediate:!0}),oe([l,s],()=>{`${l.value.length}`,I()},{immediate:!0}),I(),{pivotData:M(()=>m.value),availableFields:M(()=>k.value),isComputing:M(()=>S.value),lastComputeTime:M(()=>r.value),formatCellValue:he,extractFieldValue:Fe,aggregationFunctions:Re}}const Qr={class:"pivot-config-v3"},Jr={class:"config-row"},Yr={class:"config-group"},Xr=["value","aria-label"],Zr={label:"Categorical"},eu=["value"],tu={class:"config-group sort-group"},su=["value","aria-label"],au={class:"config-group"},lu=["value","aria-label"],ou={label:"Categorical"},nu=["value"],iu={class:"config-group sort-group"},ru=["value","aria-label"],uu={class:"config-group"},du=["value","aria-label"],cu={label:"Extracted Values"},pu=["value"],fu={label:"Numeric Fields"},vu=["value"],mu={class:"config-group"},gu=["value","aria-label"],hu=le({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(l,{emit:t}){const s=t;function p(d,m){s("update-config",d,m)}function f(d){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[d]||d.replace(/_/g," ").replace(/\b\w/g,k=>k.toUpperCase())}return(d,m)=>(o(),i("div",Qr,[e("div",Jr,[e("div",Yr,[m[6]||(m[6]=e("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),e("select",{id:"pivot-row-field",value:d.config.rowField,"aria-label":"Group rows by "+f(d.config.rowField),onChange:m[0]||(m[0]=k=>p("rowField",k.target.value))},[e("optgroup",Zr,[(o(!0),i(Z,null,te(d.availableFields.categorical,k=>(o(),i("option",{key:k,value:k},_(f(k)),9,eu))),128))])],40,Xr)]),e("div",tu,[m[8]||(m[8]=e("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),e("select",{id:"pivot-row-sort",value:d.config.rowSort||"original","aria-label":"Sort rows by "+(d.config.rowSort||"original")+" order",onChange:m[1]||(m[1]=k=>p("rowSort",k.target.value))},m[7]||(m[7]=[e("option",{value:"original"},"Original",-1),e("option",{value:"alpha"},"Alphabetical",-1)]),40,su)]),e("div",au,[m[9]||(m[9]=e("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),e("select",{id:"pivot-column-field",value:d.config.columnField,"aria-label":"Group columns by "+f(d.config.columnField),onChange:m[2]||(m[2]=k=>p("columnField",k.target.value))},[e("optgroup",ou,[(o(!0),i(Z,null,te(d.availableFields.categorical,k=>(o(),i("option",{key:k,value:k},_(f(k)),9,nu))),128))])],40,lu)]),e("div",iu,[m[11]||(m[11]=e("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),e("select",{id:"pivot-column-sort",value:d.config.columnSort||"original","aria-label":"Sort columns by "+(d.config.columnSort||"original")+" order",onChange:m[3]||(m[3]=k=>p("columnSort",k.target.value))},m[10]||(m[10]=[e("option",{value:"original"},"Original",-1),e("option",{value:"alpha"},"Alphabetical",-1)]),40,ru)]),e("div",uu,[m[12]||(m[12]=e("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),e("select",{id:"pivot-value-field",value:d.config.valueField,"aria-label":"Aggregate "+d.config.valueField+" values",onChange:m[4]||(m[4]=k=>p("valueField",k.target.value))},[e("optgroup",cu,[(o(!0),i(Z,null,te(d.availableFields.extracted,k=>(o(),i("option",{key:k,value:k},_(k),9,pu))),128))]),e("optgroup",fu,[(o(!0),i(Z,null,te(d.availableFields.numeric,k=>(o(),i("option",{key:k,value:k},_(f(k)),9,vu))),128))])],40,du)]),e("div",mu,[m[14]||(m[14]=e("label",{for:"pivot-aggregation"},"Aggregation:",-1)),e("select",{id:"pivot-aggregation",value:d.config.aggregation,"aria-label":"Aggregation method: "+d.config.aggregation,onChange:m[5]||(m[5]=k=>p("aggregation",k.target.value))},m[13]||(m[13]=[gt('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,gu)])])]))}}),_u=ae(hu,[["__scopeId","data-v-0d3a0d50"]]),yu={class:"heatmap-controls-v3"},bu={class:"color-scale-selector"},Tu=["value","aria-label"],$u={class:"gradient-mode-selector"},Cu={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},ku=["aria-pressed"],wu=["aria-pressed"],Su=["aria-pressed"],Iu=["title","aria-label"],Ru=le({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(l,{emit:t}){const s=t;function p(d){const m=d.target.value;s("update-color-scale",m)}function f(d){s("update-gradient-mode",d)}return(d,m)=>(o(),i("div",yu,[e("div",bu,[m[5]||(m[5]=e("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),e("select",{id:"heatmap-color-scale",value:d.selectedColorScale,"aria-label":"Color scale: "+d.selectedColorScale,onChange:p},m[4]||(m[4]=[gt('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,Tu)]),e("div",$u,[m[6]||(m[6]=e("label",null,"Gradient Mode:",-1)),e("div",Cu,[e("button",{type:"button",class:se(["toggle-btn",{active:d.gradientMode==="global"}]),"aria-pressed":d.gradientMode==="global",onClick:m[0]||(m[0]=k=>f("global"))}," Global ",10,ku),e("button",{type:"button",class:se(["toggle-btn",{active:d.gradientMode==="column"}]),"aria-pressed":d.gradientMode==="column",onClick:m[1]||(m[1]=k=>f("column"))}," Per Column ",10,wu),e("button",{type:"button",class:se(["toggle-btn",{active:d.gradientMode==="row"}]),"aria-pressed":d.gradientMode==="row",onClick:m[2]||(m[2]=k=>f("row"))}," Per Row ",10,Su)])]),e("button",{type:"button",class:"fullscreen-btn",title:d.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":d.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:m[3]||(m[3]=k=>d.$emit("toggle-fullscreen"))},_(d.isFullscreen?"âŠŸ":"âŠž"),9,Iu)]))}}),Pu=ae(Ru,[["__scopeId","data-v-dcb6369b"]]),Eu={class:"pivot-filters-v3"},Vu={class:"filters-row"},Au={key:0,class:"filter-group"},Fu=["value"],xu=["value"],Du=["for"],Lu=["id","value","aria-label","onChange"],Ou={value:""},Mu=["value"],Uu={key:1,class:"filter-group"},Nu=["value"],zu=["value"],Wu=le({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(l,{emit:t}){const s=l,p=t,f=j({});let d=0;const m=()=>{if(s.apiCalls.length===0){f.value={};return}const v={};s.apiCalls.forEach(T=>{if(s.trial&&T.configurationIndex<s.trial.configurations.length){const $=s.trial.configurations[T.configurationIndex],D=$.modelId||"Unknown",z=r($.parameters),A=z?`${D} ${z}`:D;v.model||(v.model=new Set),v.model.add(A)}T.status&&(v.status||(v.status=new Set),v.status.add(T.status)),T.variables&&Object.entries(T.variables).forEach(([$,D])=>{D&&String(D).trim()&&(v[$]||(v[$]=new Set),v[$].add(String(D)))})});const I={};Object.entries(v).forEach(([T,$])=>{I[T]=Array.from($).sort()}),f.value=I};oe(()=>s.apiCalls.length,v=>{(v===0||d===0||v-d>=5)&&(m(),d=v)},{immediate:!0});const k=M(()=>{const{model:v,status:I,...T}=f.value;return T}),S=M(()=>Object.values(s.activeFilters).some(v=>v!==""));function r(v){if(!v||Object.keys(v).length===0)return"";const I=[];return v.temperature!==void 0&&I.push(`T:${v.temperature}`),v.max_tokens!==void 0?I.push(`${v.max_tokens}t`):v.maxTokens!==void 0?I.push(`${v.maxTokens}t`):v.num_predict!==void 0&&I.push(`${v.num_predict}t`),v.top_p!==void 0&&I.push(`p:${v.top_p}`),v.top_k!==void 0&&I.push(`k:${v.top_k}`),I.length>0?`(${I.join(", ")})`:""}function w(v){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[v]||v.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase())}function y(v,I){const T={...s.activeFilters};I===""?delete T[v]:T[v]=I,p("update-filters",T)}return(v,I)=>(o(),i("div",Eu,[e("div",Vu,[f.value.model&&f.value.model.length>1?(o(),i("div",Au,[I[4]||(I[4]=e("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),e("select",{id:"filter-model",value:v.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:I[0]||(I[0]=T=>y("model",T.target.value))},[I[3]||(I[3]=e("option",{value:""},"All Models",-1)),(o(!0),i(Z,null,te(f.value.model,T=>(o(),i("option",{key:T,value:T},_(T),9,xu))),128))],40,Fu)])):P("",!0),(o(!0),i(Z,null,te(k.value,(T,$)=>(o(),i("div",{key:$,class:"filter-group"},[e("label",{for:`filter-${$}`,class:"filter-label"},_(w(String($)))+": ",9,Du),e("select",{id:`filter-${$}`,value:v.activeFilters[$]||"",class:"filter-select","aria-label":`Filter by ${w(String($))}`,onChange:D=>y(String($),D.target.value)},[e("option",Ou,"All "+_(w(String($))),1),(o(!0),i(Z,null,te(T,D=>(o(),i("option",{key:D,value:D},_(D),9,Mu))),128))],40,Lu)]))),128)),f.value.status&&f.value.status.length>1?(o(),i("div",Uu,[I[6]||(I[6]=e("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),e("select",{id:"filter-status",value:v.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:I[1]||(I[1]=T=>y("status",T.target.value))},[I[5]||(I[5]=e("option",{value:""},"All Statuses",-1)),(o(!0),i(Z,null,te(f.value.status,T=>(o(),i("option",{key:T,value:T},_(T),9,zu))),128))],40,Nu)])):P("",!0),S.value?(o(),i("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:I[2]||(I[2]=T=>v.$emit("clear-filters"))}," Clear Filters ")):P("",!0)])]))}}),Hu=ae(Wu,[["__scopeId","data-v-d5848163"]]),Bu={class:"collapse-icon"},ju={class:"options-content"},qu={class:"controls-row"},Gu={key:0,class:"performance-info"},Ku={class:"table-view"},Qu={key:0,class:"empty-state","data-testid":"empty-data-message"},Ju={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Yu={key:2,class:"loading-state","data-testid":"computing-state"},Xu={key:3,class:"pivot-table-container"},Zu={class:"pivot-table-grid responsive-table",role:"table"},ed={role:"row"},td={class:"corner-cell",role:"columnheader"},sd={key:0,class:"total-header",role:"columnheader"},ad={class:"row-header",role:"rowheader"},ld=["data-testid","title","aria-label","role","onClick","onKeydown"],od={key:0,class:"cell-content"},nd=["title"],id={class:"cell-value"},rd={class:"error-message"},ud={key:1},dd=le({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(l,{emit:t}){const s=l,p=t,f=j(!1),d=j("viridis"),m=j("global"),k=j(!1),S=j({rowField:s.config?.rowField||"",columnField:s.config?.columnField||"",valueField:s.config?.valueField||"",aggregation:s.config?.aggregation||"mean",rowSort:s.config?.rowSort||"original",columnSort:s.config?.columnSort||"original"});oe(()=>s.config,N=>{N&&Object.assign(S.value,N)},{deep:!0});const r=j({}),w=Ie(),y=M(()=>w.apiCalls?w.apiCalls.value||[]:s.apiCalls||[]),v=y,I=M(()=>s.trial),{pivotData:T,availableFields:$,isComputing:D,lastComputeTime:z}=Kr(v,S,I,r,{debounceMs:750});oe(T,(N,b)=>{const q=performance.now(),J=N?.rows?.length||0,ne=N?.columns?.length||0;E.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${J}x${ne} matrix`),setTimeout(()=>{const ue=performance.now();E.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(ue-q).toFixed(1)}ms`)},0)}),oe(D,N=>{N?E.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${y.value.length} API calls`):E.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${z.value.toFixed(1)}ms`)}),oe(y,(N,b)=>{const q=performance.now();E.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${b?.length||0} to ${N.length} calls`),setTimeout(()=>{const J=performance.now();E.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(J-q).toFixed(1)}ms`)},0)});const A=M(()=>T.value.rows.slice(0,s.maxTableRows)),u=M(()=>Object.values(r.value).some(b=>b!=="")?y.value.filter(b=>{if(r.value.model&&r.value.model!==""){if(!s.trial||b.configurationIndex>=s.trial.configurations.length)return!1;const q=s.trial.configurations[b.configurationIndex],J=q.modelId||"Unknown",ne=g(q.parameters);if((ne?`${J} ${ne}`:J)!==r.value.model)return!1}if(r.value.status&&r.value.status!==""&&b.status!==r.value.status)return!1;for(const[q,J]of Object.entries(r.value))if(J&&J!==""&&q!=="model"&&q!=="status"&&b.variables?.[q]!==J)return!1;return!0}).length:y.value.length),{getCellStyle:c,getSummaryStyle:R,styleKey:n}=Gs(T,d,m);function g(N){if(!N||Object.keys(N).length===0)return"";const b=[];return N.temperature!==void 0&&b.push(`T:${N.temperature}`),N.max_tokens!==void 0?b.push(`${N.max_tokens}t`):N.maxTokens!==void 0?b.push(`${N.maxTokens}t`):N.num_predict!==void 0&&b.push(`${N.num_predict}t`),N.top_p!==void 0&&b.push(`p:${N.top_p}`),N.top_k!==void 0&&b.push(`k:${N.top_k}`),b.length>0?`(${b.join(", ")})`:""}function K(N){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[N]||N.replace(/_/g," ").replace(/\b\w/g,q=>q.toUpperCase())}function Q(N,b,q){if(!q)return`${N} Ã— ${b}: No data`;const J=he(q,S.value.aggregation);let ne=`${N} Ã— ${b}: ${J} (${q.count} calls)`;if(q.excludedCounts){const ue=[];q.excludedCounts.nonNumeric>0&&ue.push(`${q.excludedCounts.nonNumeric} non-numeric responses excluded`),q.excludedCounts.nullUndefined>0&&ue.push(`${q.excludedCounts.nullUndefined} null/empty responses`),ue.length>0&&(ne+=` | ${ue.join(", ")}`)}return q.error&&(ne+=` - ERROR: ${q.error}`),ne}function x(N,b,q){if(!q)return`${N} by ${b}: No data`;const J=he(q,S.value.aggregation);return q.error?`${N} by ${b}: ${J} with data integrity error: ${q.error}`:`${N} by ${b}: ${J} from ${q.count} API calls`}function a(N,b){(N==="rowField"||N==="columnField"||N==="valueField"||N==="aggregation"||N==="rowSort"||N==="columnSort")&&(S.value[N]=b),p("config-change",{...S.value})}function h(N){r.value={...N}}function V(){r.value={}}function W(N,b,q){q&&p("cell-click",{row:N,column:b,cell:q})}function U(){k.value=!k.value}function G(){f.value=!f.value,f.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return ce(()=>{const N=performance.now();E.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${s.trial?.id||"unknown"} with ${y.value.length} calls`),ye(()=>{const b=performance.now();E.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(b-N).toFixed(1)}ms`)}),setTimeout(()=>{const b=performance.now();E.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(b-N).toFixed(1)}ms`)},0)}),we(()=>{E.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${s.trial?.id||"unknown"} with ${y.value.length} calls`)}),Se(()=>{E.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${s.trial?.id||"unknown"}`)}),ge(()=>{E.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${s.trial?.id||"unknown"}`),f.value&&(document.body.style.overflow="")}),oe([$,y],([N])=>{if(y.value.length>0&&(!S.value.rowField||S.value.rowField==="")&&N.categorical.length>0){if(S.value.rowField=N.categorical.find(b=>b!=="model"&&b!=="status"&&b!=="error_type")||N.categorical[0]||"model",S.value.columnField=S.value.columnField||"model",S.value.valueField=S.value.valueField||"parsed_response",!S.value.aggregation||S.value.aggregation===""){const b=y.value.slice(0,3).map(J=>Fe(J,S.value.valueField,s.trial)).filter(J=>J!=null),q=b.length>0&&b.every(J=>typeof J=="number");S.value.aggregation=q?"mean":"mode"}p("config-change",{...S.value})}},{immediate:!0}),(N,b)=>(o(),i("div",{class:se(["pivot-table-v3",{fullscreen:f.value}])},[e("div",{class:se(["pivot-options-container",{collapsed:k.value}])},[e("div",{class:"options-header",onClick:U},[b[3]||(b[3]=e("span",{class:"options-title"},"Pivot Table Options",-1)),e("span",Bu,_(k.value?"â–¶":"â–¼"),1)]),$e(e("div",ju,[rs([H($),S.value],()=>(o(),i("div",null,[C(_u,{config:S.value,"available-fields":H($),onUpdateConfig:a},null,8,["config","available-fields"])])),b,0),e("div",qu,[y.value.length>0?(o(),Y(Hu,{key:0,"api-calls":y.value,trial:N.trial,"active-filters":r.value,onUpdateFilters:h,onClearFilters:V},null,8,["api-calls","trial","active-filters"])):P("",!0),C(Pu,{"selected-color-scale":d.value,"gradient-mode":m.value,"is-fullscreen":f.value,onUpdateColorScale:b[1]||(b[1]=q=>d.value=q),onUpdateGradientMode:b[2]||(b[2]=q=>m.value=q),onToggleFullscreen:G},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[ht,!k.value]])],2),N.showPerformanceInfo?(o(),i("div",Gu,[e("span",null,"Computing: "+_(H(D)?"Yes":"No"),1),e("span",null,"Last Compute: "+_(H(z).toFixed(1))+"ms",1),e("span",null,"API Calls: "+_(y.value.length),1),e("span",null,"Filtered: "+_(u.value),1)])):P("",!0),e("div",Ku,[y.value.length===0?(o(),i("div",Qu,b[4]||(b[4]=[e("p",null,"No data available for pivot table analysis.",-1)]))):S.value.aggregation in H(Re)?H(D)?(o(),i("div",Yu,b[6]||(b[6]=[e("p",null,"Computing pivot table...",-1)]))):(o(),i("div",Xu,[e("table",Zu,[e("thead",null,[e("tr",ed,[e("th",td,_(K(S.value.rowField)||"Items")+" / "+_(K(S.value.columnField)||"Aggregated"),1),(o(!0),i(Z,null,te(H(T).columns,q=>(o(),i("th",{key:q,class:"column-header",role:"columnheader"},_(q),1))),128)),S.value.columnField&&N.showTotals?(o(),i("th",sd," Total ")):P("",!0)])]),e("tbody",null,[(o(!0),i(Z,null,te(A.value,q=>(o(),i("tr",{key:`${q.label}-${H(n)}`,class:"data-row",role:"row"},[e("td",ad,_(q.label),1),(o(!0),i(Z,null,te(q.cells,(J,ne)=>(o(),i("td",{key:`${ne}-${H(n)}`,class:se(["data-cell",{"error-cell":J?.error}]),"data-testid":J?.error?"pivot-cell-error":"pivot-cell",style:me(H(c)(J,q.label,ne)),title:Q(q.label,H(T).columns[ne],J),"aria-label":x(q.label,H(T).columns[ne],J),role:J?.error?"alert":"cell",tabindex:"0",onClick:ue=>W(q.label,H(T).columns[ne],J),onKeydown:[He(ue=>W(q.label,H(T).columns[ne],J),["enter"]),He(_t(ue=>W(q.label,H(T).columns[ne],J),["prevent"]),["space"])]},[J?.error?(o(),i("div",od,[e("span",{class:"error-indicator",title:J.error},"âš ï¸",8,nd),e("span",id,_(J?H(he)(J,S.value.aggregation):"-"),1),e("div",rd,_(J.error),1)])):(o(),i("span",ud,_(J?H(he)(J,S.value.aggregation):"-"),1))],46,ld))),128)),S.value.columnField&&N.showTotals?(o(),i("td",{key:0,class:"total-cell",style:me(H(R)(q.total)),role:"cell"},_(H(he)(q.total,S.value.aggregation)),5)):P("",!0)]))),128)),S.value.rowField&&N.showTotals?(o(),i("tr",{key:`totals-${H(n)}`,class:"total-row",role:"row"},[b[7]||(b[7]=e("td",{class:"row-header",role:"rowheader"},"Total",-1)),(o(!0),i(Z,null,te(H(T).totals,(q,J)=>(o(),i("td",{key:`total-${J}-${H(n)}`,class:"total-cell",style:me(H(R)(q)),role:"cell"},_(H(he)(q,S.value.aggregation)),5))),128)),S.value.columnField?(o(),i("td",{key:0,class:"grand-total-cell",style:me(H(R)(H(T).grandTotal)),role:"cell"},_(H(he)(H(T).grandTotal,S.value.aggregation)),5)):P("",!0)])):P("",!0)])])])):(o(),i("div",Ju,[e("p",null,"Invalid aggregation function: "+_(S.value.aggregation),1),b[5]||(b[5]=e("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),cd=ae(dd,[["__scopeId","data-v-2d987e50"]]),pd={class:"modal-content"},fd={class:"modal-header"},vd={class:"modal-title"},md={class:"summary-row"},gd={key:0},hd={key:0,class:"filter-row"},_d=["onUpdate:modelValue","aria-label"],yd={value:""},bd=["value"],Td={class:"table-container"},$d={class:"api-calls-table"},Cd=["title"],kd=["title"],wd=le({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(l){const t=l,s=us({}),p=M(()=>{const u=new Set;return t.apiCalls.forEach(c=>{c.variables&&Object.keys(c.variables).forEach(R=>u.add(R)),c.attributedVariables&&Object.entries(c.attributedVariables).forEach(([R,n])=>{n&&typeof n=="object"&&Object.keys(n).forEach(g=>{u.add(`${R}.${g}`)})})}),Array.from(u).sort()}),f=M(()=>p.value.map(u=>({title:u,dataIndex:`var_${u}`,key:`var_${u}`,width:150}))),d=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],m=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],k=M(()=>[...d,...f.value,...m]),S=M(()=>`${t.row} Ã— ${t.column} - ${t.apiCalls.length} API Calls`),r=M(()=>t.apiCalls.map(u=>{const c={id:u.id,status:u.status,model:u.model||"-",response:u.result?.content||u.result?.error||"-",extracted:u.extracted||"-",duration:u.duration?`${u.duration}ms`:"-",cost:u.cost||0};return p.value.forEach(R=>{if(R.includes(".")){const[n,g]=R.split("."),K=u.attributedVariables?.[n]?.[g];c[`var_${R}`]=K!==void 0?String(K):"-"}else c[`var_${R}`]=u.variables?.[R]||"-"}),c})),w=M(()=>Object.values(s).some(u=>u!==void 0&&u!=="")),y=M(()=>w.value?r.value.filter(u=>Object.entries(s).every(([c,R])=>R?u[c]===R:!0)):r.value),v=M(()=>{const u=t.apiCalls.filter(c=>c.status==="completed").length;return Math.round(u/t.apiCalls.length*100)}),I=M(()=>{const u=t.apiCalls.filter(c=>c.duration).map(c=>c.duration);return u.length===0?0:Math.round(u.reduce((c,R)=>c+R,0)/u.length)}),T=M(()=>t.apiCalls.filter(c=>c.cost).map(c=>c.cost).reduce((c,R)=>c+R,0));function $(u){switch(u){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function D(u,c){return u?u.length<=c?u:u.slice(0,c)+"...":""}function z(u){const c=new Set;return r.value.forEach(R=>{const n=R[u];n&&n!=="-"&&c.add(n)}),Array.from(c).sort()}function A(){Object.keys(s).forEach(u=>{delete s[u]})}return(u,c)=>(o(),i("div",{class:se(["pivot-cell-detail-modal-v3",{visible:u.visible}]),onClick:c[1]||(c[1]=_t(R=>u.$emit("close"),["self"]))},[e("div",pd,[e("div",fd,[e("h3",vd,_(S.value),1),e("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:c[0]||(c[0]=R=>u.$emit("close"))}," Ã— ")]),e("div",md,[e("span",null,[c[2]||(c[2]=e("b",null,"Total:",-1)),L(" "+_(u.apiCalls.length),1)]),e("span",null,[c[3]||(c[3]=e("b",null,"Success Rate:",-1)),L(" "+_(v.value)+"%",1)]),e("span",null,[c[4]||(c[4]=e("b",null,"Avg Duration:",-1)),L(" "+_(I.value)+"ms",1)]),T.value>0?(o(),i("span",gd,[c[5]||(c[5]=e("b",null,"Total Cost:",-1)),L(" $"+_(T.value),1)])):P("",!0)]),f.value.length>0?(o(),i("div",hd,[(o(!0),i(Z,null,te(f.value,R=>(o(),i("div",{key:R.key,class:"variable-filter"},[$e(e("select",{"onUpdate:modelValue":n=>s[R.key]=n,"aria-label":`Filter ${R.title}`,class:"filter-select"},[e("option",yd,"All "+_(R.title),1),(o(!0),i(Z,null,te(z(R.key),n=>(o(),i("option",{key:n,value:n},_(n),9,bd))),128))],8,_d),[[ds,s[R.key]]])]))),128)),w.value?(o(),i("button",{key:0,type:"button",class:"clear-filters-btn",onClick:A}," Clear Filters ")):P("",!0)])):P("",!0),e("div",Td,[e("table",$d,[e("thead",null,[e("tr",null,[(o(!0),i(Z,null,te(k.value,R=>(o(),i("th",{key:R.key,class:"table-header",style:me({width:R.width?`${R.width}px`:"auto"})},_(R.title),5))),128))])]),e("tbody",null,[(o(!0),i(Z,null,te(y.value,R=>(o(),i("tr",{key:R.id,class:"table-row"},[(o(!0),i(Z,null,te(k.value,n=>(o(),i("td",{key:n.key,class:se(["table-cell",{"status-cell":n.key==="status"}])},[n.key==="status"?(o(),i("span",{key:0,class:se(["status-tag",$(R.status)])},_(R.status),3)):n.key==="response"?(o(),i("span",{key:1,class:"response-cell",title:R.response},_(D(R.response,100)),9,Cd)):n.key==="cost"?(o(),i(Z,{key:2},[L(_(R.cost===0?"-":`$${R.cost.toFixed(4)}`),1)],64)):n.key.startsWith("var_")?(o(),i("span",{key:3,class:"variable-cell",title:R[n.key]},_(R[n.key]||"-"),9,kd)):(o(),i(Z,{key:4},[L(_(R[n.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),Sd=ae(wd,[["__scopeId","data-v-2738b696"]]),Id={class:"trial-tab-content"},Rd={class:"tab-pane-content"},Pd={class:"tab-pane-content"},Ed={key:0,class:"no-data-message"},Vd={class:"tab-pane-content"},ft="trial-details-active-tab",Ad=le({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(l){const t=l,s=yt(),p=xe(),f=Ie(),d=M(()=>f.apiCalls?.value||[]),m=M(()=>f.isStreaming?.value||!1);oe(d,(A,u)=>{const c=performance.now();E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${u?.length||0} to ${A.length} calls`),setTimeout(()=>{const R=performance.now();E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(R-c).toFixed(1)}ms`)},0)});const k=M(()=>!1),r=j((()=>{const A=s.query.tab;return A==="status"?"details":A&&["details","tasks","pivot"].includes(A)?A:"tasks"})()),w=j(!1);oe(r,A=>{f.setActiveTab(A)},{immediate:!0});const y=j(!1),v=j({row:"",column:"",apiCalls:[],value:null}),I=M(()=>t.executionState?.status==="executing"&&t.executionState?.currentTrialId===t.trial.id),T=M(()=>t.trial.progress.completed>0);function $(){localStorage.setItem(ft,r.value);const A={...s.query};A.tab=r.value,s.query.tab!==r.value&&(p.replace({query:A}),`${r.value}`)}function D(){const A=localStorage.getItem(ft);A==="status"?r.value="details":A&&["details","tasks","pivot"].includes(A)&&(r.value=A)}function z(A){!A.cell||!A.cell.apiCalls.length||(v.value={row:A.row,column:A.column,apiCalls:A.cell.apiCalls,value:A.cell.value},y.value=!0)}return oe(r,()=>{$()}),oe(()=>s.query.tab,A=>{if(A&&typeof A=="string"){let u=A==="status"?"details":A;["details","tasks","pivot"].includes(u)&&r.value!==u&&(r.value=u)}}),ce(()=>{const A=performance.now();if(E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${t.trial.id}`),!s.query.tab){const u={...s.query};u.tab=r.value,p.replace({query:u}),`${r.value}`}D(),setTimeout(()=>{const u=performance.now();E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(u-A).toFixed(1)}ms`)},0)}),we(()=>{E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${t.trial.id}`)}),Se(()=>{E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${t.trial.id}`)}),ge(()=>{E.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${t.trial.id}`)}),(A,u)=>{const c=Ms,R=Os;return o(),i("div",Id,[C(R,{activeKey:r.value,"onUpdate:activeKey":u[1]||(u[1]=n=>r.value=n),type:"card",class:"trial-tabs"},{default:F(()=>[C(c,{key:"tasks",tab:"Task View"},{default:F(()=>[e("div",Rd,[(o(),Y(Be,null,[C(jr,{trial:A.trial,progress:A.progress,"is-executing":I.value,"api-calls":d.value,"is-streaming":m.value,"is-loading":k.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),C(c,{key:"pivot",tab:"Pivot Table"},{default:F(()=>[e("div",Pd,[(o(),Y(Be,null,[T.value&&d.value.length>0?(o(),Y(cd,{key:0,"api-calls":d.value,trial:A.trial,"show-performance-info":!1,onCellClick:z},null,8,["api-calls","trial"])):P("",!0)],1024)),T.value&&d.value.length>0?P("",!0):(o(),i("div",Ed,u[3]||(u[3]=[e("p",null,"No completed API calls available for pivot analysis.",-1),e("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),C(c,{key:"details",tab:"Details"},{default:F(()=>[e("div",Vd,[C(No,{trial:A.trial,"is-collapsed":w.value,onToggleCollapse:u[0]||(u[0]=n=>w.value=!w.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),y.value?(o(),Y(Sd,{key:0,visible:y.value,row:v.value.row,column:v.value.column,"api-calls":v.value.apiCalls,trial:A.trial,value:v.value.value,onClose:u[2]||(u[2]=n=>y.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):P("",!0)])}}}),Fd=ae(Ad,[["__scopeId","data-v-743ec3c1"]]),xd={class:"export-content"},Dd={class:"section"},Ld={key:0,class:"section"},Od={class:"bundle-info"},Md={key:0},Ud={key:1,class:"section"},Nd={class:"field-actions"},zd={class:"field-groups"},Wd={class:"field-group"},Hd={class:"field-list"},Bd={class:"field-group"},jd={class:"field-list"},qd={class:"field-group"},Gd={class:"field-list"},Kd={class:"field-group"},Qd={class:"field-list"},Jd={class:"field-group"},Yd={class:"field-list"},Xd={key:0,class:"field-group"},Zd={class:"field-list"},ec={key:1,class:"field-group"},tc={class:"field-list"},sc={class:"section"},ac={class:"preview-info"},lc={class:"info-item"},oc={class:"value"},nc={class:"info-item"},ic={class:"value"},rc={class:"info-item"},uc={class:"value"},dc={class:"export-actions"},cc=le({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(l,{emit:t}){const s=l,p=t,f=Qe(),d=j("csv"),m=j(["order","status","configuration","prompt","response","latency"]),k=j(!1),S=j("draft"),r=j({}),w=j([]),y=j([]),v=j([]),I=["order","status","configuration","prompt","response","latency"],T=j([]),$=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],D=M(()=>{const x=s.trial.progress?.completed||0,a=s.trial.progress?.failed||0;return x+a}),z=M(()=>{const a=m.value.length*50*D.value;return a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`});function A(){T.value.length,T.value.forEach(h=>{r.value[h]=!1}),I.forEach(h=>{r.value[h]=!0});const x=y.value.map(h=>h.id),a=v.value.map(h=>h.id);x.forEach(h=>{r.value[h]=!0}),a.forEach(h=>{r.value[h]=!0}),I.length,x.length,a.length,I.length+x.length+a.length,u()}function u(){m.value=T.value.filter(x=>r.value[x])}function c(x,a){r.value[x]=a,u()}function R(){T.value.forEach(x=>{r.value[x]=!0}),u()}function n(){T.value.forEach(h=>{r.value[h]=!1}),I.forEach(h=>{r.value[h]=!0});const x=y.value.map(h=>h.id),a=v.value.map(h=>h.id);x.forEach(h=>{r.value[h]=!0}),a.forEach(h=>{r.value[h]=!0}),u()}function g(){T.value.forEach(x=>{r.value[x]=!1}),u()}function K(){p("update:visible",!1)}async function Q(){if(d.value==="bundle"){k.value=!0;try{const{trialBundleExportService:x}=await Je(async()=>{const{trialBundleExportService:V}=await import("./trial-bundle.service-BYIC7Z5S.js");return{trialBundleExportService:V}},__vite__mapDeps([0,1,2,3,4,5,6])),a=S.value==="completed",h=await x.exportTrialBundle(s.trial.id,{includeResults:a,includeApiCalls:a,format:"json"});h.ok?(X.success(`Trial bundle exported: ${h.value.filename}`),p("update:visible",!1)):X.error(`Bundle export failed: ${h.error.message}`)}catch(x){X.error(`Bundle export failed: ${x instanceof Error?x.message:"Unknown error"}`)}finally{k.value=!1}return}if(m.value.length===0){X.warning("Please select at least one field to export");return}k.value=!0;try{const x={format:d.value,fields:m.value,includeHeaders:!0,addBOM:d.value==="excel"||d.value==="csv"},a=await f.dataExport.exportTrialData(s.trial.id,x);a.ok?(X.success("Export completed successfully"),p("update:visible",!1)):X.error(`Export failed: ${a.error.message}`)}catch(x){X.error("Export failed: "+x.message)}finally{k.value=!1}}return ce(async()=>{s.trial.id;const x=await f.dataExport.getAvailableFields(s.trial.id);if(x.ok){w.value=x.value.standardFields,y.value=x.value.parameterFields,v.value=x.value.variableFields||[];const a=x.value.standardFields.map(W=>W.id).filter(W=>W!=="parameters"&&W!=="variables"),h=x.value.parameterFields.map(W=>W.id),V=(x.value.variableFields||[]).map(W=>W.id);T.value=[...a,...h,...V],x.value.standardFields.length,x.value.parameterFields.length,(x.value.variableFields||[]).length,T.value.length,x.value.parameterFields.map(W=>W.id),(x.value.variableFields||[]).map(W=>W.id),T.value}else x.error,T.value=[...$];A()}),(x,a)=>{const h=Us,V=Et,W=Vt,U=pe,G=Rt,N=be;return o(),Y(N,{visible:x.visible,"onUpdate:visible":a[46]||(a[46]=b=>x.$emit("update:visible",b)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:F(()=>[e("div",xd,[e("div",Dd,[a[53]||(a[53]=e("h4",null,"Export Format",-1)),C(V,{value:d.value,"onUpdate:value":a[0]||(a[0]=b=>d.value=b),class:"format-options"},{default:F(()=>[C(h,{value:"csv"},{default:F(()=>a[47]||(a[47]=[L("CSV")])),_:1,__:[47]}),C(h,{value:"tsv"},{default:F(()=>a[48]||(a[48]=[L("TSV")])),_:1,__:[48]}),C(h,{value:"excel"},{default:F(()=>a[49]||(a[49]=[L("Excel")])),_:1,__:[49]}),C(h,{value:"json"},{default:F(()=>a[50]||(a[50]=[L("JSON")])),_:1,__:[50]}),C(h,{value:"jsonl"},{default:F(()=>a[51]||(a[51]=[L("JSONL")])),_:1,__:[51]}),C(h,{value:"bundle"},{default:F(()=>a[52]||(a[52]=[L("Bundle ðŸ“¦")])),_:1,__:[52]})]),_:1},8,["value"])]),d.value==="bundle"?(o(),i("div",Ld,[a[62]||(a[62]=e("h4",null,"Bundle Export Options",-1)),e("div",Od,[C(V,{value:S.value,"onUpdate:value":a[1]||(a[1]=b=>S.value=b),style:{"margin-bottom":"16px"}},{default:F(()=>[C(W,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:F(()=>a[54]||(a[54]=[e("strong",null,"Export as Draft",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Configuration only - recipient can run fresh experiment ",-1)])),_:1,__:[54]}),C(W,{value:"completed",style:{display:"block"}},{default:F(()=>a[55]||(a[55]=[e("strong",null,"Export with Results",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Include all execution results for review/analysis ",-1)])),_:1,__:[55]})]),_:1},8,["value"]),a[61]||(a[61]=e("p",null,"The bundle will include:",-1)),e("ul",null,[a[56]||(a[56]=e("li",null,"âœ… Complete trial configuration",-1)),a[57]||(a[57]=e("li",null,"âœ… Template with metadata",-1)),a[58]||(a[58]=e("li",null,"âœ… All variable lists",-1)),a[59]||(a[59]=e("li",null,"âœ… Model configurations",-1)),S.value==="completed"?(o(),i("li",Md,"âœ… Execution results and API calls")):P("",!0),a[60]||(a[60]=e("li",null,"âœ… Variable index tracking for lineage",-1))]),e("p",null,[e("strong",null,_(S.value==="draft"?"Ready to run fresh experiment":"Complete historical record"),1)])])])):(o(),i("div",Ud,[a[95]||(a[95]=e("h4",null,"Fields to Export",-1)),e("div",Nd,[C(U,{size:"small",onClick:R},{default:F(()=>a[63]||(a[63]=[L("Select All")])),_:1,__:[63]}),C(U,{size:"small",onClick:n},{default:F(()=>a[64]||(a[64]=[L("Select Defaults")])),_:1,__:[64]}),C(U,{size:"small",onClick:g},{default:F(()=>a[65]||(a[65]=[L("Clear All")])),_:1,__:[65]})]),e("div",zd,[e("div",Wd,[a[71]||(a[71]=e("h5",null,"Basic Information",-1)),e("div",Hd,[C(G,{checked:r.value.id,"onUpdate:checked":a[2]||(a[2]=b=>r.value.id=b),onChange:a[3]||(a[3]=b=>c("id",b.target.checked))},{default:F(()=>a[66]||(a[66]=[L("Call ID")])),_:1,__:[66]},8,["checked"]),C(G,{checked:r.value.order,"onUpdate:checked":a[4]||(a[4]=b=>r.value.order=b),onChange:a[5]||(a[5]=b=>c("order",b.target.checked))},{default:F(()=>a[67]||(a[67]=[L("Order")])),_:1,__:[67]},8,["checked"]),C(G,{checked:r.value.status,"onUpdate:checked":a[6]||(a[6]=b=>r.value.status=b),onChange:a[7]||(a[7]=b=>c("status",b.target.checked))},{default:F(()=>a[68]||(a[68]=[L("Status")])),_:1,__:[68]},8,["checked"]),C(G,{checked:r.value.created,"onUpdate:checked":a[8]||(a[8]=b=>r.value.created=b),onChange:a[9]||(a[9]=b=>c("created",b.target.checked))},{default:F(()=>a[69]||(a[69]=[L("Created Time")])),_:1,__:[69]},8,["checked"]),C(G,{checked:r.value.completed,"onUpdate:checked":a[10]||(a[10]=b=>r.value.completed=b),onChange:a[11]||(a[11]=b=>c("completed",b.target.checked))},{default:F(()=>a[70]||(a[70]=[L("Completed Time")])),_:1,__:[70]},8,["checked"])])]),e("div",Bd,[a[76]||(a[76]=e("h5",null,"Configuration",-1)),e("div",jd,[C(G,{checked:r.value.configuration,"onUpdate:checked":a[12]||(a[12]=b=>r.value.configuration=b),onChange:a[13]||(a[13]=b=>c("configuration",b.target.checked))},{default:F(()=>a[72]||(a[72]=[L("Configuration Name")])),_:1,__:[72]},8,["checked"]),C(G,{checked:r.value.provider,"onUpdate:checked":a[14]||(a[14]=b=>r.value.provider=b),onChange:a[15]||(a[15]=b=>c("provider",b.target.checked))},{default:F(()=>a[73]||(a[73]=[L("Provider")])),_:1,__:[73]},8,["checked"]),C(G,{checked:r.value.modelId,"onUpdate:checked":a[16]||(a[16]=b=>r.value.modelId=b),onChange:a[17]||(a[17]=b=>c("modelId",b.target.checked))},{default:F(()=>a[74]||(a[74]=[L("Model ID")])),_:1,__:[74]},8,["checked"]),C(G,{checked:r.value.parameters,"onUpdate:checked":a[18]||(a[18]=b=>r.value.parameters=b),onChange:a[19]||(a[19]=b=>c("parameters",b.target.checked))},{default:F(()=>a[75]||(a[75]=[L("Parameters")])),_:1,__:[75]},8,["checked"])])]),e("div",qd,[a[81]||(a[81]=e("h5",null,"Content",-1)),e("div",Gd,[C(G,{checked:r.value.prompt,"onUpdate:checked":a[20]||(a[20]=b=>r.value.prompt=b),onChange:a[21]||(a[21]=b=>c("prompt",b.target.checked))},{default:F(()=>a[77]||(a[77]=[L("Prompt")])),_:1,__:[77]},8,["checked"]),C(G,{checked:r.value.variables,"onUpdate:checked":a[22]||(a[22]=b=>r.value.variables=b),onChange:a[23]||(a[23]=b=>c("variables",b.target.checked))},{default:F(()=>a[78]||(a[78]=[L("Variables")])),_:1,__:[78]},8,["checked"]),C(G,{checked:r.value.response,"onUpdate:checked":a[24]||(a[24]=b=>r.value.response=b),onChange:a[25]||(a[25]=b=>c("response",b.target.checked))},{default:F(()=>a[79]||(a[79]=[L("Response")])),_:1,__:[79]},8,["checked"]),C(G,{checked:r.value.parsedResponse,"onUpdate:checked":a[26]||(a[26]=b=>r.value.parsedResponse=b),onChange:a[27]||(a[27]=b=>c("parsedResponse",b.target.checked))},{default:F(()=>a[80]||(a[80]=[L("Parsed Response")])),_:1,__:[80]},8,["checked"])])]),e("div",Kd,[a[87]||(a[87]=e("h5",null,"Performance",-1)),e("div",Qd,[C(G,{checked:r.value.latency,"onUpdate:checked":a[28]||(a[28]=b=>r.value.latency=b),onChange:a[29]||(a[29]=b=>c("latency",b.target.checked))},{default:F(()=>a[82]||(a[82]=[L("Latency (ms)")])),_:1,__:[82]},8,["checked"]),C(G,{checked:r.value.promptTokens,"onUpdate:checked":a[30]||(a[30]=b=>r.value.promptTokens=b),onChange:a[31]||(a[31]=b=>c("promptTokens",b.target.checked))},{default:F(()=>a[83]||(a[83]=[L("Prompt Tokens")])),_:1,__:[83]},8,["checked"]),C(G,{checked:r.value.completionTokens,"onUpdate:checked":a[32]||(a[32]=b=>r.value.completionTokens=b),onChange:a[33]||(a[33]=b=>c("completionTokens",b.target.checked))},{default:F(()=>a[84]||(a[84]=[L("Completion Tokens")])),_:1,__:[84]},8,["checked"]),C(G,{checked:r.value.totalTokens,"onUpdate:checked":a[34]||(a[34]=b=>r.value.totalTokens=b),onChange:a[35]||(a[35]=b=>c("totalTokens",b.target.checked))},{default:F(()=>a[85]||(a[85]=[L("Total Tokens")])),_:1,__:[85]},8,["checked"]),C(G,{checked:r.value.cost,"onUpdate:checked":a[36]||(a[36]=b=>r.value.cost=b),onChange:a[37]||(a[37]=b=>c("cost",b.target.checked))},{default:F(()=>a[86]||(a[86]=[L("Cost (USD)")])),_:1,__:[86]},8,["checked"])])]),e("div",Jd,[a[92]||(a[92]=e("h5",null,"Technical Details",-1)),e("div",Yd,[C(G,{checked:r.value.request,"onUpdate:checked":a[38]||(a[38]=b=>r.value.request=b),onChange:a[39]||(a[39]=b=>c("request",b.target.checked))},{default:F(()=>a[88]||(a[88]=[L("Full Request")])),_:1,__:[88]},8,["checked"]),C(G,{checked:r.value.response_raw,"onUpdate:checked":a[40]||(a[40]=b=>r.value.response_raw=b),onChange:a[41]||(a[41]=b=>c("response_raw",b.target.checked))},{default:F(()=>a[89]||(a[89]=[L("Raw Response")])),_:1,__:[89]},8,["checked"]),C(G,{checked:r.value.error,"onUpdate:checked":a[42]||(a[42]=b=>r.value.error=b),onChange:a[43]||(a[43]=b=>c("error",b.target.checked))},{default:F(()=>a[90]||(a[90]=[L("Error Details")])),_:1,__:[90]},8,["checked"]),C(G,{checked:r.value.repeatIndex,"onUpdate:checked":a[44]||(a[44]=b=>r.value.repeatIndex=b),onChange:a[45]||(a[45]=b=>c("repeatIndex",b.target.checked))},{default:F(()=>a[91]||(a[91]=[L("Repeat Index")])),_:1,__:[91]},8,["checked"])])]),y.value.length>0?(o(),i("div",Xd,[a[93]||(a[93]=e("h5",null,"Parameters (Individual Columns)",-1)),e("div",Zd,[(o(!0),i(Z,null,te(y.value,b=>(o(),Y(G,{key:b.id,checked:r.value[b.id],"onUpdate:checked":q=>r.value[b.id]=q,onChange:q=>c(b.id,q.target.checked)},{default:F(()=>[L(_(b.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):P("",!0),v.value.length>0?(o(),i("div",ec,[a[94]||(a[94]=e("h5",null,"Attributes (Individual Columns)",-1)),e("div",tc,[(o(!0),i(Z,null,te(v.value,b=>(o(),Y(G,{key:b.id,checked:r.value[b.id],"onUpdate:checked":q=>r.value[b.id]=q,onChange:q=>c(b.id,q.target.checked)},{default:F(()=>[L(_(b.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):P("",!0)])])),e("div",sc,[a[99]||(a[99]=e("h4",null,"Export Preview",-1)),e("div",ac,[e("div",lc,[a[96]||(a[96]=e("span",{class:"label"},"Records:",-1)),e("span",oc,_(D.value),1)]),e("div",nc,[a[97]||(a[97]=e("span",{class:"label"},"Fields:",-1)),e("span",ic,_(m.value.length),1)]),e("div",rc,[a[98]||(a[98]=e("span",{class:"label"},"Estimated Size:",-1)),e("span",uc,_(z.value),1)])])]),e("div",dc,[C(U,{onClick:K},{default:F(()=>a[100]||(a[100]=[L("Cancel")])),_:1,__:[100]}),C(U,{type:"primary",onClick:Q,loading:k.value,disabled:m.value.length===0},{default:F(()=>[C(H(Ns)),a[101]||(a[101]=L(" Export "))]),_:1,__:[101]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),pc=ae(cc,[["__scopeId","data-v-34965650"]]);class fc{constructor(){re(this,"subscription",null);re(this,"progressSubscription",null);re(this,"store",Ie());re(this,"v4Control",xt());re(this,"isActive",!1);re(this,"currentTrialId",null)}async startStreaming(t){const s=performance.now();this.cleanupSubscriptions();const p=performance.now();`${(p-s).toFixed(1)}`,this.isActive=!0,`${(p-s).toFixed(1)}`,this.currentTrialId=t,this.store.setCurrentTrial(t),this.store.setStreaming(!0),`${(performance.now()-p).toFixed(1)}`;const d=performance.now();await this.loadHistoricalData(t),`${(performance.now()-d).toFixed(1)}`;const k=performance.now(),S=this.v4Control.getActiveStreams(t);if(`${(performance.now()-k).toFixed(1)}`,!S){const w=await We.trials.get(t);if(w&&w.status==="running"){let y=0;const v=5,I=setInterval(()=>{y++;const T=this.v4Control.getActiveStreams(t);T?(clearInterval(I),this.connectToTrialStream(t,T)):y>=v&&clearInterval(I)},500)}else`${w?.status||"NOT_FOUND"}`;return}this.connectToTrialStream(t,S)}connectToTrialStream(t,s){this.isActive=!0;const p=s.callsSubject||s.sharedCalls$;`${p?.constructor?.name}`,`${p?.constructor?.name}`,this.subscription=p.subscribe({next:f=>{if(f&&f.length>0){const d=performance.now();`${f.length}`;const m=this.store.apiCalls.value,k=new Map;for(const y of m)k.set(y.id,y);let S=!1;for(const y of f){const v=k.get(y.id);v&&v.status!==y.status?S=!0:v||(S=!0),k.set(y.id,y)}let r;if(S)`${k.size}`,r=Array.from(k.values()).sort((y,v)=>{const I=D=>{switch(D){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},T=I(y.status),$=I(v.status);if(T!==$)return T-$;if(y.status==="completed"&&v.status==="completed"){const D=y.completed?new Date(y.completed).getTime():0;return(v.completed?new Date(v.completed).getTime():0)-D}if(y.status==="running"&&v.status==="running"){const D=y.started?new Date(y.started).getTime():0;return(v.started?new Date(v.started).getTime():0)-D}return y.order-v.order});else{`${f.length}`;const y=[];for(const v of m){const I=k.get(v.id);I?(y.push(I),k.delete(v.id)):y.push(v)}for(const v of k.values())y.push(v);r=y}`${(performance.now()-d).toFixed(1)}${m.length}`,this.store.updateApiCalls(r)}},error:f=>{E.error("V4_STREAM_CONNECT: Stream error:",f),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(t)}}),s.sharedProgress$&&(s.sharedProgress$,this.progressSubscription=s.sharedProgress$.subscribe({next:f=>{f.type,`${f.type}`,`${f.type}${new Date().toISOString()}`,f.type==="completed"&&this.loadHistoricalData(t).then(()=>{}).catch(d=>{E.error("V4_TRIAL_COMPLETION: Failed to load final data:",d)}),this.store.updateProgress(f)},error:f=>{E.error("V4_STREAM_CONNECT: Progress stream error:",f)}}))}cleanupSubscriptions(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){`${this.currentTrialId}`,`${this.isActive}`,this.cleanupSubscriptions(),this.isActive=!1}async loadHistoricalData(t){const s=performance.now();try{`${(performance.now()-s).toFixed(1)}`,`${(performance.now()-s).toFixed(1)}`;const d=performance.now();`${(d-s).toFixed(1)}`;const m=await We.apiCalls.where("trialId").equals(t).toArray(),k=performance.now();`${m.length}${(k-d).toFixed(1)}`,`${(k-s).toFixed(1)}`;const S=performance.now();m.sort((I,T)=>{const $=A=>{switch(A){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},D=$(I.status),z=$(T.status);if(D!==z)return D-z;if(I.status==="completed"&&T.status==="completed"){const A=I.completed?new Date(I.completed).getTime():0;return(T.completed?new Date(T.completed).getTime():0)-A}if(I.status==="running"&&T.status==="running"){const A=I.started?new Date(I.started).getTime():0;return(T.started?new Date(T.started).getTime():0)-A}return I.order-T.order});const r=performance.now();`${m.length}${(r-S).toFixed(1)}`;const w=performance.now();this.store.updateApiCalls(m),this.store.setStreaming(!1),`${(performance.now()-w).toFixed(1)}`,`${this.isActive}`,`${(performance.now()-s).toFixed(1)}`}catch(p){E.error("STREAM_MGR_V4: Failed to load historical data:",p),this.store.clear()}}destroy(){this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let Ae=null;function Ut(){return Ae||(Ae=new fc),Ae}typeof window<"u"&&(window.__trialStreamManagerV4=()=>Ae);const vc={class:"trial-details-panel"},mc={key:0,class:"loading-state"},gc={key:1,class:"error-state"},hc={class:"error-actions"},_c=le({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(l){const t=l,s=xe(),p=j(!1),f=j(null),d=j(!1),m=Ut(),k=M(()=>t.executionState?.status==="executing"&&t.executionState?.currentTrialId===t.trial?.id);function S(){f.value=null}function r(){s.push("/trials")}function w(){d.value=!0}async function y(){if(t.trial){`${t.trial.id}`;try{m.isActive&&m.currentTrialId===t.trial.id&&m.stopStreaming(),await m.loadHistoricalData(t.trial.id),`${t.trial.id}`,(t.trial.status==="running"||t.trial.status==="paused")&&await m.startStreaming(t.trial.id)}catch(v){E.error("REFRESH: Failed to refresh trial data:",v)}}}return oe(()=>t.trial,(v,I)=>{v&&v.id!==I?.id&&(f.value=null,E.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${I?.id} to ${v.id}`))}),ce(()=>{const v=t.trial?.id;E.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${v}`)}),we(()=>{const v=t.trial?.id;E.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${v}`)}),Se(()=>{const v=t.trial?.id;E.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${v}`)}),ge(()=>{const v=t.trial?.id;E.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${v}`)}),(v,I)=>{const T=pe;return o(),i("div",vc,[p.value?(o(),i("div",mc,[C(H(kt),{class:"loading-spinner",spin:""}),I[9]||(I[9]=e("span",null,"Loading trial details...",-1))])):f.value?(o(),i("div",gc,[C(H(ke),{class:"error-icon"}),I[12]||(I[12]=e("h3",null,"Failed to load trial",-1)),e("p",null,_(f.value),1),e("div",hc,[C(T,{onClick:S},{default:F(()=>I[10]||(I[10]=[L("Retry")])),_:1,__:[10]}),C(T,{type:"link",onClick:r},{default:F(()=>I[11]||(I[11]=[L("Go Back")])),_:1,__:[11]})])])):v.trial?(o(),i(Z,{key:2},[C(kl,{trial:v.trial,progress:v.progress,"is-executing":k.value},null,8,["trial","progress","is-executing"]),C(El,{trial:v.trial,"is-leader":v.isLeader,"execution-state":v.executionState,onStart:I[0]||(I[0]=$=>v.$emit("start-trial")),onPause:I[1]||(I[1]=$=>v.$emit("pause-trial")),onResume:I[2]||(I[2]=$=>v.$emit("resume-trial")),onCancel:I[3]||(I[3]=$=>v.$emit("cancel-trial")),onDuplicate:I[4]||(I[4]=$=>v.$emit("duplicate-trial",v.trial.id)),onEdit:I[5]||(I[5]=$=>v.$emit("edit-trial",v.trial.id)),onDelete:I[6]||(I[6]=$=>v.$emit("delete-trial",v.trial.id)),onExportData:w,onExportPython:I[7]||(I[7]=$=>v.$emit("export-python",v.trial.id)),onRefresh:y},null,8,["trial","is-leader","execution-state"]),v.trial&&d.value?(o(),Y(pc,{key:0,visible:d.value,trial:v.trial,"onUpdate:visible":I[8]||(I[8]=$=>d.value=!1)},null,8,["visible","trial"])):P("",!0),C(Fd,{trial:v.trial,progress:v.progress,"is-leader":v.isLeader,"execution-state":v.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):P("",!0)])}}}),yc=ae(_c,[["__scopeId","data-v-081db72e"]]),bc={class:"import-content"},Tc={class:"upload-section"},$c={class:"ant-upload-drag-icon"},Cc={key:0,class:"preview-section"},kc={class:"bundle-details"},wc={class:"detail-row"},Sc={class:"value"},Ic={class:"detail-row"},Rc={class:"value"},Pc={class:"detail-row"},Ec={class:"value"},Vc={class:"detail-row"},Ac={class:"value"},Fc={key:0,style:{color:"green","margin-left":"8px"}},xc={key:1,style:{color:"orange","margin-left":"8px"}},Dc={key:0,class:"detail-row"},Lc={class:"value"},Oc={class:"detail-row"},Mc={class:"value"},Uc={class:"import-options"},Nc={key:0,style:{"margin-bottom":"12px"}},zc={key:1,style:{"margin-bottom":"12px",padding:"8px",background:"#f0f0f0","border-radius":"4px"}},Wc={key:0,class:"warnings"},Hc={class:"modal-actions"},Bc=le({__name:"ImportTrialDialog",props:{visible:{type:Boolean}},emits:["update:visible","trial-imported"],setup(l,{emit:t}){const s=l,p=t,f=xe(),d=j([]),m=j(null),k=j(!1),S=j([]),r=j({mode:"draft",namePrefix:"Imported: "}),w=M({get:()=>s.visible,set:u=>p("update:visible",u)}),y=M(()=>m.value?.execution?.apiCalls&&m.value.execution.apiCalls.length>0);function v(u){return!1}async function I(u){const c=u.file.originFileObj||u.file;if(c)try{const R=await T(c),n=JSON.parse(R);S.value=$(n),m.value=n,n.execution?.apiCalls&&n.execution.apiCalls.length>0,r.value.mode="draft"}catch{X.error("Failed to read bundle file: Invalid JSON format"),m.value=null}}function T(u){return new Promise((c,R)=>{const n=new FileReader;n.onload=g=>c(g.target?.result),n.onerror=R,n.readAsText(u)})}function $(u){const c=[];return u.version||c.push("Bundle version is missing"),u.configuration?.trial||c.push("Trial configuration is missing"),(!u.configuration?.variableLists||u.configuration.variableLists.length===0)&&c.push("No variable lists found in bundle"),u.version!=="1.0"&&c.push(`Bundle version ${u.version} may not be fully compatible`),c}function D(u){return new Date(u).toLocaleString()}function z(){d.value=[],m.value=null,S.value=[],w.value=!1}async function A(){if(!m.value){X.error("No bundle to import");return}k.value=!0;try{const{trialBundleImportService:u}=await Je(async()=>{const{trialBundleImportService:n}=await import("./trial-bundle.service-BYIC7Z5S.js");return{trialBundleImportService:n}},__vite__mapDeps([0,1,2,3,4,5,6])),c=y.value&&r.value.mode==="completed",R=await u.importTrialBundle(JSON.stringify(m.value),{importResults:c,importAsCompleted:c,namePrefix:r.value.namePrefix||void 0});R.ok?(X.success("Trial imported successfully!"),f.push(`/trials?trialId=${R.value.trialId}`),p("trial-imported",R.value.trialId),z()):X.error(`Import failed: ${R.error.message}`)}catch(u){X.error(`Import failed: ${u instanceof Error?u.message:"Unknown error"}`)}finally{k.value=!1}}return(u,c)=>{const R=zs,n=Vt,g=Et,K=It,Q=De,x=pe,a=be;return o(),Y(a,{visible:w.value,"onUpdate:visible":c[3]||(c[3]=h=>w.value=h),title:"Import Trial Bundle",width:600,footer:null,"destroy-on-close":!0,class:"import-trial-modal"},{default:F(()=>[e("div",bc,[e("div",Tc,[C(R,{fileList:d.value,"onUpdate:fileList":c[0]||(c[0]=h=>d.value=h),"before-upload":v,"max-count":1,accept:".json",onChange:I},{default:F(()=>[e("p",$c,[C(H(Ct))]),c[4]||(c[4]=e("p",{class:"ant-upload-text"},"Click or drag trial bundle file here",-1)),c[5]||(c[5]=e("p",{class:"ant-upload-hint"}," Supports .json files exported from trials ",-1))]),_:1,__:[4,5]},8,["fileList"])]),m.value?(o(),i("div",Cc,[c[17]||(c[17]=e("h3",null,"Bundle Contents",-1)),e("div",kc,[e("div",wc,[c[6]||(c[6]=e("span",{class:"label"},"Trial Name:",-1)),e("span",Sc,_(m.value.metadata.trialName),1)]),e("div",Ic,[c[7]||(c[7]=e("span",{class:"label"},"Export Date:",-1)),e("span",Rc,_(D(m.value.metadata.exportDate)),1)]),e("div",Pc,[c[8]||(c[8]=e("span",{class:"label"},"Status:",-1)),e("span",Ec,_(m.value.metadata.trialStatus),1)]),e("div",Vc,[c[9]||(c[9]=e("span",{class:"label"},"API Calls:",-1)),e("span",Ac,[L(_(m.value.metadata.apiCallCount)+" ",1),y.value?(o(),i("span",Fc," (with results) ")):(o(),i("span",xc," (configuration only) "))])]),m.value.configuration.template?(o(),i("div",Dc,[c[10]||(c[10]=e("span",{class:"label"},"Template:",-1)),e("span",Lc,_(m.value.configuration.template.name),1)])):P("",!0),e("div",Oc,[c[11]||(c[11]=e("span",{class:"label"},"Variable Lists:",-1)),e("span",Mc,_(m.value.configuration.variableLists?.length||0),1)])]),e("div",Uc,[c[16]||(c[16]=e("h4",null,"Import Options",-1)),y.value?(o(),i("div",Nc,[C(g,{value:r.value.mode,"onUpdate:value":c[1]||(c[1]=h=>r.value.mode=h),style:{display:"block"}},{default:F(()=>[C(n,{value:"draft",style:{display:"block","margin-bottom":"8px"}},{default:F(()=>c[12]||(c[12]=[e("strong",null,"Import as Draft",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Create fresh trial ready to run new experiment ",-1)])),_:1,__:[12]}),C(n,{value:"completed",style:{display:"block"}},{default:F(()=>c[13]||(c[13]=[e("strong",null,"Import as Completed",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px","margin-left":"24px"}}," Preserve historical results for review/analysis ",-1)])),_:1,__:[13]})]),_:1},8,["value"])])):(o(),i("div",zc,c[14]||(c[14]=[e("strong",null,"Draft Trial",-1),e("div",{style:{color:"var(--color-text-secondary)","font-size":"12px"}}," This bundle contains configuration only - will import as draft ready to run ",-1)]))),C(K,{value:r.value.namePrefix,"onUpdate:value":c[2]||(c[2]=h=>r.value.namePrefix=h),placeholder:"Name prefix (optional)",style:{"margin-top":"8px"}},{prefix:F(()=>c[15]||(c[15]=[L("Name:")])),_:1},8,["value"])]),S.value.length>0?(o(),i("div",Wc,[C(Q,{message:"Import Warnings",type:"warning","show-icon":""},{description:F(()=>[e("ul",null,[(o(!0),i(Z,null,te(S.value,h=>(o(),i("li",{key:h},_(h),1))),128))])]),_:1})])):P("",!0)])):P("",!0),e("div",Hc,[C(x,{onClick:z},{default:F(()=>c[18]||(c[18]=[L("Cancel")])),_:1,__:[18]}),C(x,{type:"primary",onClick:A,loading:k.value,disabled:!m.value},{default:F(()=>[C(H($t)),c[19]||(c[19]=L(" Import Trial "))]),_:1,__:[19]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),jc=ae(Bc,[["__scopeId","data-v-1d9366d6"]]),qc={class:"trials-view-v3"},Gc={key:0,class:"provider-warning-banner"},Kc={class:"banner-content"},Qc={key:1,class:"observer-mode-banner"},Jc={class:"banner-content"},Yc={key:1,class:"loading-left-pane"},Xc={key:0,class:"no-selection"},Zc={key:0,class:"observer-note"},ep=le({__name:"TrialsViewV3",setup(l){const t=xt(),{trials:s}=Bs(),{enabledModels:p}=Ks(),{duplicateTrial:f,deleteTrial:d}=js(),m=Ut(),k=Qe(),S=yt(),r=xe(),w=j(),y=j(!0),v=j(null),I=j(""),T=j("all"),$=j(-1),D=j(!1),z=j(!1),A=j(!1),u=M(()=>p.value.length>0),c=M(()=>!u.value&&!A.value),R=t.isLeader,n=t.execution,{trial:g}=qs(v),K=M(()=>{const O=g.value?.progress;return O?{trialId:v.value||"",...O,lastUpdated:new Date}:null}),Q=M(()=>{let O=s.value;if(I.value){const B=I.value.toLowerCase();O=O.filter(ee=>{const fe=ee.name.toLowerCase().includes(B),ve=ee.templateConfig?.template?.toLowerCase().includes(B),ie=ee.configurations.some(_e=>_e.modelId.toLowerCase().includes(B)||_e.provider.toLowerCase().includes(B));return fe||ve||ie})}return T.value!=="all"&&(O=O.filter(B=>B.status===T.value)),O});async function x(){const O=S.query;if(O.duplicate){const B=O.duplicate,ee=await f(B);ee.ok?await r.push({path:"/trials/create",query:{duplicate:ee.value,edit:O.edit==="true"?"true":void 0}}):X.error(`Failed to duplicate trial: ${ee.error?.message||"Unknown error"}`),await r.replace({query:{}});return}if(O.designId||O.promptSource){await r.push({path:"/trials/create",query:O});return}if(S.query.trialId){const B=S.query.trialId;h(B)}}function a(){if(v.value||s.value.length===0)return;const O=s.value.find(B=>B.status==="running");if(O){h(O.id);return}h(s.value[0].id)}async function h(O){const B=performance.now();E.info(`V4_TRIAL_SWITCH: Starting trial selection: ${O}`),v.value=O;const ee=performance.now();if(E.info(`V4_TRIAL_SWITCH: UI updated in ${(ee-B).toFixed(1)}ms`),s.value.length>0){const ie=Q.value.findIndex(_e=>_e.id===O);ie>=0&&($.value=ie)}const fe=performance.now();if(E.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${O} at ${(fe-B).toFixed(1)}ms`),m.startStreaming(O).catch(ie=>{E.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${O}`,ie)}),S.query.trialId!==O){const ie={...S.query};ie.trialId=O,ie.tab||(ie.tab="status"),r.push({path:"/trials",query:ie}),E.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${ie.tab}' at ${(performance.now()-B).toFixed(1)}ms`)}w.value&&w.value.closeMobileOverlay();const ve=performance.now();E.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(ve-B).toFixed(1)}ms`)}function V(O){I.value=O,$.value=-1}function W(O){T.value=O,$.value=-1}async function U(){X.info("Refreshing trial list...")}function G(O){const B=Q.value;if(B.length!==0){if((O.metaKey||O.ctrlKey)&&O.key==="k"){O.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(O.key==="j"||O.key==="ArrowDown")&&(O.preventDefault(),$.value=Math.min($.value+1,B.length-1),$.value>=0&&(h(B[$.value].id),N(B[$.value].id))),(O.key==="k"||O.key==="ArrowUp")&&(O.preventDefault(),$.value=Math.max($.value-1,0),h(B[$.value].id),N(B[$.value].id)),O.key==="Enter"&&v.value,O.key==="Escape"&&(I.value="",v.value=null,$.value=-1)}}function N(O){ye(()=>{const B=document.querySelector(`[data-trial-id="${O}"]`);B&&B.scrollIntoView({behavior:"smooth",block:"nearest"})})}function b(O){E.debug("Trial list panel resized",{width:O})}function q(O){E.debug("Mobile overlay changed",{visible:O})}function J(){A.value=!0}async function ne(){await r.push("/trials/create")}function ue(){z.value=!0}function de(O){U(),h(O)}async function Me(){if(v.value&&!D.value){D.value=!0,t.execution?.value,t.execution?.value?.status;try{v.value;const O=await t.startTrialWithStreaming(v.value);if(!O.ok){X.error(O.error?.message||"Unknown error");return}await m.startStreaming(v.value);const B={...S.query};B.tab="tasks",r.replace({query:B})}finally{D.value=!1}}}async function Nt(){`${v.value}`,`${t.execution.value.status}`,`${t.isLeader.value}`;const O=await t.pauseExecution();O.ok?`${t.execution.value.status}`:(O.error.message,X.error(O.error?.message||"Unknown error"))}async function zt(){if(!v.value)return;`${v.value}`,`${t.execution.value.status}`,`${t.isLeader.value}`;const O=t.execution.value?.status||"idle",B=t.execution.value?.currentTrialId;if(O==="paused"&&B===v.value){`${v.value}`;const ee=await t.resumeExecution(v.value);ee.ok||(ee.error.message,X.error(ee.error.message))}else{const ee=await t.startTrialWithStreaming(v.value);ee.ok?await m.startStreaming(v.value):(ee.error.message,X.error(ee.error?.message||"Unknown error"))}}async function Wt(){const O=await t.cancelExecution();O.ok||X.error(O.error?.message||"Unknown error")}async function Ht(O){const B=await f(O);B.ok?(X.success("Trial duplicated"),B.value&&h(B.value)):X.error(B.error?.message||"Unknown error")}async function Bt(O){await r.push({path:"/trials/create",query:{duplicate:O,edit:"true"}})}async function jt(O){const B=await d(O);B.ok?(X.success("Trial deleted"),v.value===O&&(v.value=null)):X.error(B.error?.message||"Unknown error")}async function qt(O,B){const ee=await k.dataExport.exportTrialData(O,{format:B,fields:void 0,includeHeaders:!0,addBOM:B==="excel"});ee.ok?X.success(`Exported ${ee.value.recordCount} API calls to ${ee.value.filename}`):X.error(ee.error?.message||"Unknown error")}function Gt(O){Kt(O,"minimal")}async function Kt(O,B="classic"){if(B==="bundle"){const{usePythonBundleManagement:ee}=await Je(async()=>{const{usePythonBundleManagement:ie}=await import("./python-bundle-management-Bg7X5D00.js");return{usePythonBundleManagement:ie}},__vite__mapDeps([7,1,2,3,4,5,6,0])),{exportPythonBundle:fe}=ee(),ve=await fe(O,{includeApiKeys:!0,showProgress:!0});ve.ok||X.error(ve.error?.message||"Bundle export failed")}else if(B==="minimal"){const ee=await k.pythonGeneration.generatePythonScript(O,{template:"minimal",includeComments:!0});ee.ok?X.success("Minimal Python script exported"):X.error(ee.error?.message||"Minimal export failed")}else{const ee=await k.pythonGeneration.generatePythonScript(O,{template:"minimal",includeComments:!0});ee.ok?X.success("Python script exported"):X.error(ee.error?.message||"Classic export failed")}}return oe(()=>S.query.trialId,O=>{O&&O!==v.value&&h(O)}),oe(y,(O,B)=>{const ee=performance.now();E.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${B} to ${O} at ${ee}`),O||E.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),oe(s,(O,B)=>{const ee=performance.now();E.info(`V4_TRIAL_SWITCH: trials array changed from ${B?.length||0} to ${O.length} trials at ${ee}`)},{immediate:!0}),ce(async()=>{const O=performance.now();E.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${O}`);const B=performance.now();E.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(B-O).toFixed(1)}ms`);try{await t.initialize();const Ue=performance.now();E.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(Ue-B).toFixed(1)}ms`)}catch(Ue){const Xt=performance.now();E.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(Xt-B).toFixed(1)}ms:`,Ue)}const ee=performance.now();window.addEventListener("keydown",G),E.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(ee-O).toFixed(1)}ms`);const fe=performance.now();E.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(fe-O).toFixed(1)}ms`),await ye();const ve=performance.now();E.info(`V4_TRIAL_SWITCH: nextTick completed in ${(ve-fe).toFixed(1)}ms`);const ie=performance.now();y.value=!1,E.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(ie-O).toFixed(1)}ms`);const _e=performance.now();E.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(_e-O).toFixed(1)}ms`),await x();const Qt=performance.now();E.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Qt-_e).toFixed(1)}ms`);const st=performance.now();E.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(st-O).toFixed(1)}ms`),a();const Jt=performance.now();E.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Jt-st).toFixed(1)}ms`);const Yt=performance.now();E.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(Yt-O).toFixed(1)}ms`)}),ge(()=>{window.removeEventListener("keydown",G),m.destroy()}),(O,B)=>{const ee=vt("router-link"),fe=pe;return o(),i("div",qc,[c.value?(o(),i("div",Gc,[e("div",Kc,[C(H(ke),{class:"warning-icon"}),B[2]||(B[2]=e("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),C(ee,{to:"/settings",class:"settings-link"},{default:F(()=>B[1]||(B[1]=[L("Go to Settings")])),_:1,__:[1]}),C(H(Tt),{class:"close-icon",onClick:J})]),B[3]||(B[3]=e("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):P("",!0),H(R)?P("",!0):(o(),i("div",Qc,[e("div",Jc,[C(H(St),{class:"observer-icon"}),B[4]||(B[4]=e("span",null,[e("strong",null,"Observer Mode: Multiple Tabs Detected")],-1)),B[5]||(B[5]=e("div",{class:"leader-hint"}," You can only open one Auditomatic tab at a time. Close other tabs, or refresh if this is your only tab. Your templates and trials are safely saved. ",-1))])])),C(Ys,{ref_key:"splitPanel",ref:w,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:b,onMobileOverlayChange:q},{left:F(()=>[y.value?(o(),i("div",Yc," Loading trials... ")):(o(),Y(rl,{key:0,trials:H(s),"selected-trial-id":v.value,"search-query":I.value,"filter-status":T.value,onSelectTrial:h,onCreateTrial:ne,onImportTrial:ue,onUpdateSearch:V,onUpdateFilter:W,onRefresh:U},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:F(()=>[(o(),Y(Be,{max:5},[v.value?(o(),Y(yc,{key:v.value,trial:H(g),"is-leader":H(R),"execution-state":H(n),progress:K.value,onStartTrial:Me,onPauseTrial:Nt,onResumeTrial:zt,onCancelTrial:Wt,onDuplicateTrial:Ht,onEditTrial:Bt,onDeleteTrial:jt,onExportData:qt,onExportPython:Gt},null,8,["trial","is-leader","execution-state","progress"])):P("",!0)],1024)),!v.value||!H(g)?$e((o(),i("div",Xc,[C(H(Pt),{class:"empty-icon"}),B[7]||(B[7]=e("h3",null,"Select a trial to view details",-1)),B[8]||(B[8]=e("p",null,"Choose from the list or create a new one",-1)),C(fe,{type:"primary",size:"large",disabled:!H(R),onClick:ne},{default:F(()=>B[6]||(B[6]=[L(" Create New Trial ")])),_:1,__:[6]},8,["disabled"]),H(R)?P("",!0):(o(),i("div",Zc," Close other tabs to enable trial creation "))],512)),[[ht,!y.value]]):P("",!0)]),_:1},512),C(jc,{visible:z.value,"onUpdate:visible":B[0]||(B[0]=ve=>z.value=ve),onTrialImported:de},null,8,["visible"])])}}}),vp=ae(ep,[["__scopeId","data-v-f189422f"]]);export{vp as default};

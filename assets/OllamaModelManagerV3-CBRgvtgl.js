import{_ as fe,a6 as ve,a7 as ye,aj as _e,l as Y,az as ze,T as te,aA as ke,ax as R,K as pe,aB as me,r as oe,s as he,u as ne,M as we,aC as $e,aD as Me,a9 as Ce,W as be,p as ge,z as Te,av as Se,aE as Be,t as xe,m as Oe}from"./ui-vendor-CcBzucUW.js";import{d as N,c as P,R as r,Y as s,S as v,k as y,Z as f,G as w,_ as h,F as L,W as A,V as c,u as _,$ as x,a0 as ee,B as re,f as Q,w as Ge,l as de,o as Ie}from"./vue-vendor-DPw1dQYc.js";import{j as W}from"./index-BfkoFMqp.js";import{ollamaFetch as ce,checkOllamaConnection as Pe,deleteOllamaModel as Fe,fetchOllamaModels as Qe}from"./ollama-fetch-Buz2KfBg.js";const Le={class:"search-section"},Ue={class:"search-controls"},De={class:"size-filter"},qe={class:"size-controls"},Ve={class:"size-presets"},Ee={key:0,class:"size-filter-indicator"},He={class:"quantized-filter"},Re={class:"filter-description"},je={class:"category-filters"},Ae=N({__name:"OllamaSearchFilters",props:{searchQuery:{},sortBy:{},selectedCategories:{},maxSizeGB:{},showQuantized:{type:Boolean},categories:{}},emits:["update:searchQuery","update:sortBy","update:maxSizeGB","update:showQuantized","toggle-category"],setup(q,{emit:n}){const S=q,B=n,k=P({get:()=>S.searchQuery,set:d=>B("update:searchQuery",d)}),b=P({get:()=>S.sortBy,set:d=>B("update:sortBy",d)}),T=P({get:()=>S.maxSizeGB,set:d=>B("update:maxSizeGB",d)}),G=P({get:()=>S.showQuantized,set:d=>B("update:showQuantized",d)}),p=[{label:"1GB",value:1},{label:"2GB",value:2},{label:"4GB",value:4},{label:"8GB",value:8},{label:"16GB",value:16},{label:"None",value:999}];return(d,g)=>{const U=fe,D=ye,i=ve,o=_e,a=Y,F=te;return s(),r("div",Le,[v("div",Ue,[y(U,{value:k.value,"onUpdate:value":g[0]||(g[0]=t=>k.value=t),placeholder:"Search models by name or description...","allow-clear":"",size:"large",class:"search-input"},null,8,["value"]),y(i,{value:b.value,"onUpdate:value":g[1]||(g[1]=t=>b.value=t),placeholder:"Sort by",style:{width:"180px"},size:"large"},{default:f(()=>[y(D,{value:"popularity"},{default:f(()=>g[4]||(g[4]=[w("Popularity")])),_:1,__:[4]}),y(D,{value:"lastUpdated"},{default:f(()=>g[5]||(g[5]=[w("Last Updated")])),_:1,__:[5]}),y(D,{value:"name"},{default:f(()=>g[6]||(g[6]=[w("Name")])),_:1,__:[6]}),y(D,{value:"tagCount"},{default:f(()=>g[7]||(g[7]=[w("Tag Count")])),_:1,__:[7]})]),_:1},8,["value"])]),v("div",De,[v("div",qe,[g[8]||(g[8]=v("span",{class:"filter-label"},"Filter to models smaller than:",-1)),y(o,{value:T.value,"onUpdate:value":g[2]||(g[2]=t=>T.value=t),min:1,max:999,step:1,size:"small",class:"size-input","addon-after":"GB"},null,8,["value"]),v("div",Ve,[(s(),r(L,null,A(p,t=>y(a,{key:t.value,size:"small",type:T.value===t.value?"primary":"default",onClick:e=>T.value=t.value,class:"preset-button"},{default:f(()=>[w(c(t.label),1)]),_:2},1032,["type","onClick"])),64))])]),T.value<999?(s(),r("span",Ee," â‰¤"+c(T.value)+"GB filter active ",1)):h("",!0)]),v("div",He,[y(a,{type:G.value?"default":"primary",size:"small",onClick:g[3]||(g[3]=t=>G.value=!G.value)},{icon:f(()=>[y(_(ze))]),default:f(()=>[w(" "+c(G.value?"Hide":"Show")+" Quantized Versions ",1)]),_:1},8,["type"]),v("span",Re,c(G.value?"Showing all versions":"Hiding q2_K, q3_K, q4_0, q5_1, q6_K, q8_0, fp16..."),1)]),v("div",je,[(s(!0),r(L,null,A(d.categories,t=>(s(),x(F,{key:t,color:d.selectedCategories.includes(t)?"blue":"default",checkable:!0,checked:d.selectedCategories.includes(t),onClick:e=>d.$emit("toggle-category",t),class:"category-tag"},{default:f(()=>[w(c(t),1)]),_:2},1032,["color","checked","onClick"]))),128))])])}}}),Ne=W(Ae,[["__scopeId","data-v-a03d8794"]]),We={key:0,class:"downloads-section"},Ke={class:"download-items"},Je={class:"download-info"},Ye={class:"download-tag"},Ze={class:"download-status"},Xe=N({__name:"OllamaDownloadProgress",props:{pullProgress:{}},setup(q){return(n,S)=>{const B=ke;return Object.keys(n.pullProgress).length>0?(s(),r("div",We,[S[0]||(S[0]=v("h4",null,"Active Downloads",-1)),v("div",Ke,[(s(!0),r(L,null,A(n.pullProgress,(k,b)=>(s(),r("div",{key:b,class:"download-item"},[v("div",Je,[v("code",Ye,c(b),1),v("span",Ze,c(k.message),1)]),y(B,{percent:k.percent,status:k.status==="success"?"success":"active",size:"small",class:"download-progress"},null,8,["percent","status"])]))),128))])])):h("",!0)}}}),et=W(Xe,[["__scopeId","data-v-88ba3f68"]]),tt={class:"model-info"},st={class:"model-name"},at={key:0},lt={class:"model-description"},nt={class:"model-actions"},ot={key:0,class:"button-size-info"},it={key:0,class:"tags-preview"},ut={class:"preview-tags"},rt=["onClick","title"],dt={key:1,class:"tag-actual"},ct={class:"tag-size"},pt={key:0,class:"more-tags"},mt={key:1,class:"tags-expanded"},gt={key:0,class:"tag-name"},ft={key:2},vt={key:1,class:"text-secondary"},yt=N({__name:"OllamaModelCard",props:{model:{},expanded:{type:Boolean},pullingModels:{},pullProgress:{},installedModels:{},maxSizeGB:{},showQuantized:{type:Boolean},isQuantizedTag:{type:Function},parseSizeToGB:{type:Function},getSizeClass:{type:Function},getLatestTagInfo:{type:Function}},emits:["toggle-expand","pull-model"],setup(q){const n=q,S=[{title:"Tag",key:"name",width:200},{title:"Size",key:"size",width:100,align:"right"},{title:"Context",key:"context",width:100,align:"center"},{title:"Status",key:"status",width:80,align:"center"},{title:"Action",key:"actions",width:80,align:"center"}],B=P(()=>n.installedModels.some(t=>t.startsWith(n.model.name))),k=P(()=>n.installedModels.filter(t=>t.startsWith(n.model.name+":")).length),b=P(()=>i(`${n.model.name}:latest`)||i(n.model.name)),T=P(()=>n.pullingModels.has(`${n.model.name}:latest`)),G=P(()=>n.pullProgress[`${n.model.name}:latest`]),p=P(()=>n.getLatestTagInfo(n.model)),d=P(()=>n.maxSizeGB<999||!n.showQuantized),g=P(()=>n.model.tags?Object.entries(n.model.tags).map(([t,e])=>({...e,name:t})).filter(t=>!(n.maxSizeGB<999&&n.parseSizeToGB(t.size||"0GB")>n.maxSizeGB||!n.showQuantized&&n.isQuantizedTag(t.name))).sort((t,e)=>t.name.localeCompare(e.name)):[]),U=P(()=>g.value.length),D=P(()=>g.value.sort((e,u)=>{const $=["latest","instruct","8b","7b","3b","1b"],z=$.indexOf(e.name),l=$.indexOf(u.name);return z!==-1&&l!==-1?z-l:z!==-1?-1:l!==-1?1:e.name.localeCompare(u.name)}).slice(0,5));function i(t){return n.installedModels.includes(t)}function o(t){return n.pullingModels.has(t)}function a(t){return n.pullProgress[t]}const F=P(()=>{const t=p.value;return t?{actualTag:t.actualTag||"",size:t.size||""}:null});return(t,e)=>{const u=te,$=Y,z=oe;return s(),r("div",{class:ee(["model-item",{expanded:t.expanded}])},[v("div",{class:"model-header",onClick:e[2]||(e[2]=l=>t.$emit("toggle-expand"))},[v("div",tt,[v("div",st,[v("h4",null,c(t.model.name),1),y(u,{size:"small",color:"blue"},{default:f(()=>[w(c(t.model.pullCount||"0")+" pulls",1)]),_:1}),y(u,{size:"small",color:"green"},{default:f(()=>[w(c(U.value)+" ",1),d.value?(s(),r("span",at,"/"+c(t.model.tagCount||0),1)):h("",!0),e[3]||(e[3]=w(" versions "))]),_:1,__:[3]}),B.value?(s(),x(u,{key:0,size:"small",color:"success",class:"installed-tag"},{icon:f(()=>[y(_(R))]),default:f(()=>[w(" "+c(k.value)+" installed ",1)]),_:1})):h("",!0)]),v("p",lt,c(t.model.description||"No description available"),1)]),v("div",nt,[y($,{type:b.value?"default":"primary",size:"small",onClick:e[0]||(e[0]=re(l=>t.$emit("pull-model",t.model.name,"latest"),["stop"])),loading:T.value,disabled:b.value},{default:f(()=>[G.value?(s(),r(L,{key:0},[w(c(Math.round(G.value.percent))+"% ",1)],64)):b.value?(s(),r(L,{key:1},[y(_(R)),e[4]||(e[4]=w(" Installed "))],64)):(s(),r(L,{key:2},[e[5]||(e[5]=w(" Pull Latest ")),F.value?(s(),r("span",ot," ("+c(F.value.actualTag?F.value.actualTag+", ":"")+c(F.value.size)+") ",1)):h("",!0)],64))]),_:1},8,["type","loading","disabled"]),y($,{type:"text",size:"small",onClick:e[1]||(e[1]=re(l=>t.$emit("toggle-expand"),["stop"]))},{icon:f(()=>[t.expanded?(s(),x(_(me),{key:1})):(s(),x(_(pe),{key:0}))]),default:f(()=>[w(" "+c(t.expanded?"Hide versions":"See all versions"),1)]),_:1})])]),t.expanded?h("",!0):(s(),r("div",it,[v("div",ut,[(s(!0),r(L,null,A(D.value,l=>(s(),r("span",{key:l.name,class:ee(["tag-chip",[t.getSizeClass(l.size),{installed:i(l.fullTag)}]]),onClick:C=>i(l.fullTag)?null:t.$emit("pull-model",t.model.name,l.name),title:`${l.fullTag} - ${l.size}${i(l.fullTag)?" (Installed)":""}`},[i(l.fullTag)?(s(),x(_(R),{key:0,class:"installed-icon"})):h("",!0),w(" "+c(l.name)+" ",1),l.name==="latest"&&F.value?(s(),r("span",dt," ("+c(F.value.actualTag)+") ",1)):h("",!0),v("span",ct,c(l.size),1)],10,rt))),128)),U.value>5?(s(),r("span",pt," +"+c(U.value-5)+" more versions ",1)):h("",!0)])])),t.expanded?(s(),r("div",mt,[y(z,{columns:S,"data-source":g.value,pagination:!1,size:"small",scroll:{y:300},class:"tags-table"},{bodyCell:f(({column:l,record:C})=>[l.key==="name"?(s(),r("code",gt,c(C.name),1)):h("",!0),l.key==="size"?(s(),r("span",{key:1,class:ee(["tag-size",t.getSizeClass(C.size)])},c(C.size),3)):h("",!0),l.key==="context"?(s(),r("span",ft,c(C.contextWindow),1)):h("",!0),l.key==="status"?(s(),r(L,{key:3},[i(C.fullTag)?(s(),x(u,{key:0,size:"small",color:"success"},{default:f(()=>[y(_(R)),e[6]||(e[6]=w(" Installed "))]),_:1,__:[6]})):(s(),r("span",vt,"-"))],64)):h("",!0),l.key==="actions"?(s(),x($,{key:4,type:i(C.fullTag)?"default":"primary",size:"small",onClick:V=>t.$emit("pull-model",t.model.name,C.name),loading:o(C.fullTag),disabled:i(C.fullTag)},{default:f(()=>[a(C.fullTag)?(s(),r(L,{key:0},[w(c(Math.round(a(C.fullTag).percent))+"% ",1)],64)):i(C.fullTag)?(s(),r(L,{key:1},[y(_(R)),e[7]||(e[7]=w(" Installed "))],64)):(s(),r(L,{key:2},[w(" Pull ")],64))]),_:2},1032,["type","onClick","loading","disabled"])):h("",!0)]),_:1},8,["data-source"])])):h("",!0)],2)}}}),_t=W(yt,[["__scopeId","data-v-83727817"]]),zt={class:"list-view"},kt={class:"expanded-tags-container"},ht={class:"expanded-tags-grid"},wt={class:"tag-name"},$t={key:0,class:"tag-actual"},Mt={class:"tag-size"},Ct={class:"tag-context"},bt={key:0,class:"model-name-cell"},Tt={key:1,class:"description-cell"},St={key:2,class:"stats-cell"},Bt={class:"stat-item"},xt={class:"stat-item"},Ot={key:0},Gt={key:3,class:"size-range"},It=N({__name:"OllamaModelList",props:{models:{},expandedModels:{},pullingModels:{},pullProgress:{},installedModels:{},maxSizeGB:{},showQuantized:{type:Boolean},isQuantizedTag:{type:Function},parseSizeToGB:{type:Function},getSizeClass:{type:Function},getLatestTagInfo:{type:Function},getModelSizeRange:{type:Function}},emits:["toggle-model","pull-model","expand"],setup(q){const n=q,S=[{title:"Model",key:"name",width:200,fixed:"left"},{title:"Description",key:"description",ellipsis:!0},{title:"Stats",key:"stats",width:200},{title:"Size Range",key:"sizeRange",width:120,align:"center"},{title:"Actions",key:"actions",width:220,align:"center",fixed:"right"}];function B(p){return p.tags?Object.entries(p.tags).map(([d,g])=>({...g,name:d})).filter(d=>!(n.maxSizeGB<999&&n.parseSizeToGB(d.size||"0GB")>n.maxSizeGB||!n.showQuantized&&n.isQuantizedTag(d.name))).sort((d,g)=>d.name.localeCompare(g.name)):[]}function k(p){return p.tags?Object.entries(p.tags).filter(([d,g])=>!(n.maxSizeGB<999&&n.parseSizeToGB(g.size||"0GB")>n.maxSizeGB||!n.showQuantized&&n.isQuantizedTag(d))).length:0}function b(p){return n.installedModels.some(d=>d.startsWith(p))}function T(p){return n.installedModels.includes(p)}function G(p){return n.installedModels.filter(d=>d.startsWith(p+":"))}return(p,d)=>{const g=te,U=Y,D=he,i=oe;return s(),r("div",zt,[y(i,{"data-source":p.models,columns:S,pagination:!1,"row-key":o=>o.name,size:"small",scroll:{y:"calc(100% - 48px)"},"expanded-row-keys":p.expandedModels,"expand-row-by-click":!1,onExpand:d[0]||(d[0]=(o,a)=>p.$emit("expand",o,a)),class:"models-list-table"},{expandedRowRender:f(({record:o})=>[v("div",kt,[v("div",ht,[(s(!0),r(L,null,A(B(o),a=>(s(),r("div",{key:a.fullTag,class:ee(["expanded-tag-item",p.getSizeClass(a.size)])},[v("span",wt,c(a.name),1),a.name==="latest"&&p.getLatestTagInfo(o)?(s(),r("span",$t," ("+c(p.getLatestTagInfo(o)?.actualTag)+") ",1)):h("",!0),v("span",Mt,c(a.size),1),v("span",Ct,c(a.contextWindow||"-"),1),T(a.fullTag)?(s(),x(g,{key:1,size:"small",color:"success"},{default:f(()=>[y(_(R)),d[1]||(d[1]=w(" Installed "))]),_:1,__:[1]})):(s(),x(U,{key:2,type:"primary",size:"small",loading:p.pullingModels.has(a.fullTag),onClick:F=>p.$emit("pull-model",o.name,a.name)},{default:f(()=>[p.pullProgress[a.fullTag]?(s(),r(L,{key:0},[w(c(Math.round(p.pullProgress[a.fullTag].percent))+"% ",1)],64)):(s(),r(L,{key:1},[w(" Pull ")],64))]),_:2},1032,["loading","onClick"]))],2))),128))])])]),bodyCell:f(({column:o,record:a})=>[o.key==="name"?(s(),r("div",bt,[v("code",null,c(a.name),1),b(a.name)?(s(),x(g,{key:0,size:"small",color:"success"},{default:f(()=>[y(_(R)),w(" "+c(G(a.name).length)+" installed ",1)]),_:2},1024)):h("",!0)])):h("",!0),o.key==="description"?(s(),r("span",Tt,c(a.description||"No description"),1)):h("",!0),o.key==="stats"?(s(),r("div",St,[v("span",Bt,c(a.pullCount||"0")+" pulls",1),d[3]||(d[3]=v("span",{class:"stat-divider"},"â€¢",-1)),v("span",xt,[w(c(k(a))+" ",1),p.maxSizeGB<999||!p.showQuantized?(s(),r("span",Ot,"/"+c(a.tagCount||0),1)):h("",!0),d[2]||(d[2]=w(" versions "))])])):h("",!0),o.key==="sizeRange"?(s(),r("span",Gt,c(p.getModelSizeRange(a)),1)):h("",!0),o.key==="actions"?(s(),x(D,{key:4,size:"small"},{default:f(()=>[y(U,{type:"text",size:"small",onClick:F=>p.$emit("toggle-model",a.name)},{icon:f(()=>[p.expandedModels.includes(a.name)?(s(),x(_(me),{key:1})):(s(),x(_(pe),{key:0}))]),default:f(()=>[w(" "+c(p.expandedModels.includes(a.name)?"Hide":"See")+" Versions ",1)]),_:2},1032,["onClick"]),y(U,{type:T(`${a.name}:latest`)||T(a.name)?"default":"primary",size:"small",onClick:F=>p.$emit("pull-model",a.name,"latest"),loading:p.pullingModels.has(`${a.name}:latest`),disabled:T(`${a.name}:latest`)||T(a.name)},{default:f(()=>[p.pullProgress[`${a.name}:latest`]?(s(),r(L,{key:0},[w(c(Math.round(p.pullProgress[`${a.name}:latest`].percent))+"% ",1)],64)):T(`${a.name}:latest`)||T(a.name)?(s(),x(_(R),{key:1})):(s(),r(L,{key:2},[w(" Pull Latest ")],64))]),_:2},1032,["type","onClick","loading","disabled"])]),_:2},1024)):h("",!0)]),_:1},8,["data-source","row-key","expanded-row-keys"])])}}}),Pt=W(It,[["__scopeId","data-v-7d1c26f3"]]);function Ft(){const q=Q(null),n=Q(!1),S=Q(""),B=Q(new Set),k=Q({}),b=Q([]);async function T(){n.value=!0,S.value="";try{const e=await fetch("https://ollama.models.auditomatic.org/models.json");if(!e.ok)throw new Error(`Failed to fetch models: ${e.statusText}`);q.value=await e.json(),await G()}catch(e){S.value=`Failed to load model library: ${e instanceof Error?e.message:"Unknown error"}`}finally{n.value=!1}}async function G(){try{const e=await ce("/api/tags");if(e.ok){const u=await e.json();b.value=(u.models||[]).map($=>$.name)}}catch(e){const u=e;u.type==="cors"&&u.isHttps,b.value=[]}}async function p(e,u,$){const z=u==="latest"?e:`${e}:${u}`;if(!B.value.has(z)){B.value.add(z),k.value[z]={percent:0,status:"active",message:"Starting download..."};try{const l=await ce("/api/pull",{method:"POST",body:JSON.stringify({name:z,stream:!0})});if(!l.ok)throw new Error(`Failed to pull model: ${l.statusText}`);const C=l.body?.getReader();if(!C)throw new Error("Unable to read response stream");let V=0,Z=0;for(;;){const{done:se,value:K}=await C.read();if(se)break;const X=new TextDecoder().decode(K).split(`
`).filter(J=>J.trim());for(const J of X)try{const E=JSON.parse(J);E.total&&(V=E.total),E.completed&&(Z=E.completed);const M=V>0?Math.round(Z/V*100):0;if(k.value[z]={status:E.status==="success"?"success":"active",percent:M,message:E.status||"Downloading..."},E.status==="success"){ne.success(`Successfully pulled ${z}`),await G(),$?.(),setTimeout(()=>{delete k.value[z]},3e3);return}}catch{}}}catch(l){const C=l;let V=l instanceof Error?l.message:"Unknown error";C.type==="cors"&&C.isHttps&&(V="Cannot access Ollama from HTTPS site. Please use the desktop app or run locally."),ne.error(`Failed to pull ${z}: ${V}`),k.value[z]={status:"exception",percent:0,message:"Download failed"},setTimeout(()=>{delete k.value[z]},5e3)}finally{B.value.delete(z)}}}function d(e){const u=parseFloat(e.replace(/[^\d.]/g,""))||0,$=e.replace(/[\d.]/g,"").trim().toUpperCase();return $.includes("MB")?u/1e3:$.includes("TB")?u*1e3:($.includes("GB"),u)}function g(e){return/-q\d{1,2}_|-fp\d+/.test(e)}function U(e){return b.value.some(u=>u.startsWith(e))}function D(e){return b.value.includes(e)}function i(e){return b.value.filter(u=>u.startsWith(e+":"))}function o(e){return e<1?`${Math.round(e*1e3)}MB`:`${e.toFixed(1)}GB`}function a(e){const u=d(e);return u<5?"size-small":u<20?"size-medium":"size-large"}function F(e){if(!e.tags)return"N/A";const u=Object.values(e.tags).map(l=>d(l.size||"0GB")).filter(l=>l>0);if(u.length===0)return"N/A";const $=Math.min(...u),z=Math.max(...u);return $===z?o($):`${o($)} - ${o(z)}`}function t(e){if(!e.tags||!e.tags.latest)return null;const u=e.tags.latest,$=Object.entries(e.tags).find(([z,l])=>z!=="latest"&&l.modelHash===u.modelHash);return $?{actualTag:$[0],size:$[1].size||u.size}:{actualTag:"",size:u.size}}return{modelsData:q,loading:n,error:S,pullingModels:B,pullProgress:k,installedModels:b,fetchModels:T,fetchInstalledModels:G,pullModel:p,parseSizeToGB:d,isQuantizedTag:g,isModelInstalled:U,isTagInstalled:D,getInstalledTagsForModel:i,formatSizeGB:o,getSizeClass:a,getModelSizeRange:F,getLatestTagInfo:t}}const Qt={class:"modal-content"},Lt={class:"stats-bar"},Ut={class:"view-controls"},Dt={key:0,class:"loading-text"},qt={class:"models-container"},Vt=N({__name:"OllamaModelLibraryModalV3",props:{modelValue:{type:Boolean}},emits:["update:modelValue","models-updated"],setup(q,{emit:n}){const S=q,B=n,{modelsData:k,loading:b,error:T,pullingModels:G,pullProgress:p,installedModels:d,fetchModels:g,pullModel:U,parseSizeToGB:D,isQuantizedTag:i,getSizeClass:o,getModelSizeRange:a,getLatestTagInfo:F}=Ft(),t=Q(""),e=Q("popularity"),u=Q([]),$=Q(8),z=Q(!1),l=Q("card"),C=Q(new Set),V=P({get:()=>S.modelValue,set:M=>B("update:modelValue",M)}),Z=P(()=>k.value?.totalModels||0),se=P(()=>k.value?.categories||[]),K=P(()=>{if(!k.value)return[];let M=Object.entries(k.value.models).map(([m,O])=>({...O,name:m}));if(t.value){const m=t.value.toLowerCase();M=M.filter(O=>O.name.toLowerCase().includes(m)||O.description.toLowerCase().includes(m))}switch(u.value.length>0&&(M=M.filter(m=>u.value.some(O=>(m.categories||[]).includes(O)))),$.value<999&&(M=M.filter(m=>m.tags?Object.values(m.tags).some(O=>D(O.size||"0GB")<=$.value):!0)),e.value){case"popularity":M.sort((m,O)=>{const H=m.pullCount||"0",j=O.pullCount||"0",ae=parseFloat(H.replace(/[^\d.]/g,""))||0,le=parseFloat(j.replace(/[^\d.]/g,""))||0,I=H.includes("M")?1e6:H.includes("K")?1e3:1,ue=j.includes("M")?1e6:j.includes("K")?1e3:1;return le*ue-ae*I});break;case"lastUpdated":M.sort((m,O)=>{const H=m.lastUpdated?new Date(m.lastUpdated).getTime():0;return(O.lastUpdated?new Date(O.lastUpdated).getTime():0)-H});break;case"name":M.sort((m,O)=>m.name.localeCompare(O.name));break;case"tagCount":M.sort((m,O)=>(O.tagCount||0)-(m.tagCount||0));break}return M});function ie(M){const m=u.value.indexOf(M);m===-1?u.value.push(M):u.value.splice(m,1)}function X(M){C.value.has(M)?C.value.delete(M):C.value.add(M)}function J(M,m){M?C.value.add(m.name):C.value.delete(m.name)}async function E(M,m){await U(M,m,()=>B("models-updated"))}return Ge(V,M=>{M&&!k.value&&g(),M||(C.value.clear(),t.value="",u.value=[],$.value=8,z.value=!1,T.value="")}),(M,m)=>{const O=Y,H=$e,j=be,ae=ge,le=we;return s(),x(le,{open:V.value,"onUpdate:open":m[7]||(m[7]=I=>V.value=I),title:"Ollama Model Library",width:"95vw",footer:null,destroyOnClose:!0,"wrap-class-name":"ollama-library-modal-full",class:"ollama-library-modal"},{default:f(()=>[v("div",Qt,[y(Ne,{"search-query":t.value,"onUpdate:searchQuery":m[0]||(m[0]=I=>t.value=I),"sort-by":e.value,"onUpdate:sortBy":m[1]||(m[1]=I=>e.value=I),"max-size-g-b":$.value,"onUpdate:maxSizeGB":m[2]||(m[2]=I=>$.value=I),"show-quantized":z.value,"onUpdate:showQuantized":m[3]||(m[3]=I=>z.value=I),"selected-categories":u.value,categories:se.value,onToggleCategory:ie},null,8,["search-query","sort-by","max-size-g-b","show-quantized","selected-categories","categories"]),v("div",Lt,[v("span",null,"Showing "+c(K.value.length)+" of "+c(Z.value)+" models",1),v("div",Ut,[y(H,{size:"small"},{default:f(()=>[y(O,{type:l.value==="card"?"primary":"default",onClick:m[4]||(m[4]=I=>l.value="card"),icon:de(_(Me)),title:"Card View"},null,8,["type","icon"]),y(O,{type:l.value==="list"?"primary":"default",onClick:m[5]||(m[5]=I=>l.value="list"),icon:de(_(Ce)),title:"List View"},null,8,["type","icon"])]),_:1}),_(b)?(s(),r("span",Dt,"Loading...")):h("",!0)])]),y(et,{"pull-progress":_(p)},null,8,["pull-progress"]),v("div",qt,[y(j,{spinning:_(b),size:"large"},{default:f(()=>[l.value==="card"?(s(!0),r(L,{key:0},A(K.value,I=>(s(),x(_t,{key:I.name,model:I,expanded:C.value.has(I.name),"pulling-models":_(G),"pull-progress":_(p),"installed-models":_(d),"max-size-g-b":$.value,"show-quantized":z.value,"is-quantized-tag":_(i),"parse-size-to-g-b":_(D),"get-size-class":_(o),"get-latest-tag-info":_(F),onToggleExpand:ue=>X(I.name),onPullModel:E},null,8,["model","expanded","pulling-models","pull-progress","installed-models","max-size-g-b","show-quantized","is-quantized-tag","parse-size-to-g-b","get-size-class","get-latest-tag-info","onToggleExpand"]))),128)):h("",!0),l.value==="list"?(s(),x(Pt,{key:1,models:K.value,"expanded-models":Array.from(C.value),"pulling-models":_(G),"pull-progress":_(p),"installed-models":_(d),"max-size-g-b":$.value,"show-quantized":z.value,"is-quantized-tag":_(i),"parse-size-to-g-b":_(D),"get-size-class":_(o),"get-latest-tag-info":_(F),"get-model-size-range":_(a),onToggleModel:X,onPullModel:E,onExpand:J},null,8,["models","expanded-models","pulling-models","pull-progress","installed-models","max-size-g-b","show-quantized","is-quantized-tag","parse-size-to-g-b","get-size-class","get-latest-tag-info","get-model-size-range"])):h("",!0)]),_:1},8,["spinning"])]),_(T)?(s(),x(ae,{key:0,type:"error",message:_(T),closable:"",onClose:m[6]||(m[6]=I=>T.value=""),class:"error-alert"},null,8,["message"])):h("",!0)])]),_:1},8,["open"])}}}),Et=W(Vt,[["__scopeId","data-v-96287dbe"]]),Ht={class:"ollama-model-manager"},Rt={class:"action-bar"},jt={class:"models-section"},At={key:0,class:"model-name"},Nt={key:1,class:"model-size"},Wt={key:2,class:"model-date"},Kt=N({__name:"OllamaModelManagerV3",setup(q){const n=Q([]),S=Q(!1),B=Q(new Set),k=Q(""),b=Q(!1),T=[{title:"Model Name",key:"name",width:"40%"},{title:"Size",key:"size",width:"20%",align:"right"},{title:"Modified",key:"modified",width:"25%"},{title:"Actions",key:"actions",width:"15%",align:"center"}];async function G(){const i=await Pe();return!i.available&&i.error&&(i.error.type==="cors"&&i.error.isHttps?k.value=i.error.details||"Cannot connect to Ollama from HTTPS site":k.value=i.error.message),i.available}async function p(){try{const i=await Qe();n.value=i.models||[]}catch(i){const o=i;o.type==="cors"&&o.isHttps?k.value=o.details||"Cannot access Ollama from HTTPS site":k.value=`Failed to fetch models: ${i instanceof Error?i.message:"Unknown error"}`,n.value=[]}}async function d(i){B.value.add(i),k.value="";try{await Fe(i),ne.success(`Successfully removed ${i}`),await g()}catch(o){const a=o;a.type==="cors"&&a.isHttps?k.value=a.details||"Cannot access Ollama from HTTPS site":k.value=`Failed to remove model: ${o instanceof Error?o.message:"Unknown error"}`}finally{B.value.delete(i)}}async function g(){S.value=!0,await p(),S.value=!1}function U(i){if(!i)return"0 B";const o=["B","KB","MB","GB","TB"],a=Math.floor(Math.log(i)/Math.log(1024));return`${(i/Math.pow(1024,a)).toFixed(1)} ${o[a]}`}function D(i){try{return new Date(i).toLocaleDateString()}catch{return"Unknown"}}return Ie(async()=>{await G()?await g():k.value="Cannot connect to Ollama. Make sure Ollama is running on localhost:11434"}),(i,o)=>{const a=Y,F=te,t=Be,e=oe,u=Oe,$=ge;return s(),r("div",Ht,[v("div",Rt,[y(a,{type:"primary",onClick:o[0]||(o[0]=z=>b.value=!0)},{icon:f(()=>[y(_(Te))]),default:f(()=>[o[3]||(o[3]=w(" Download Ollama Models "))]),_:1,__:[3]}),y(a,{onClick:g,loading:S.value},{icon:f(()=>[y(_(Se))]),default:f(()=>[o[4]||(o[4]=w(" Refresh "))]),_:1,__:[4]},8,["loading"])]),v("div",jt,[o[7]||(o[7]=v("h4",{class:"section-title"},"Installed Models",-1)),y(e,{columns:T,"data-source":n.value,pagination:!1,size:"small",loading:S.value,"row-key":"name",class:"models-table"},{bodyCell:f(({column:z,record:l})=>[z.key==="name"?(s(),r("div",At,[v("code",null,c(l.name),1),l.details?.family?(s(),x(F,{key:0,size:"small",color:"blue"},{default:f(()=>[w(c(l.details.family),1)]),_:2},1024)):h("",!0)])):h("",!0),z.key==="size"?(s(),r("span",Nt,c(U(l.size)),1)):h("",!0),z.key==="modified"?(s(),r("span",Wt,c(D(l.modified_at)),1)):h("",!0),z.key==="actions"?(s(),x(t,{key:3,title:"Are you sure you want to delete this model?",description:`This will permanently remove ${l.name} from your system.`,"ok-text":"Delete","cancel-text":"Cancel",onConfirm:C=>d(l.name)},{default:f(()=>[y(a,{type:"text",danger:"",size:"small",loading:B.value.has(l.name)},{icon:f(()=>[y(_(xe))]),default:f(()=>[o[5]||(o[5]=w(" Remove "))]),_:2,__:[5]},1032,["loading"])]),_:2},1032,["description","onConfirm"])):h("",!0)]),_:1},8,["data-source","loading"]),!S.value&&n.value.length===0?(s(),x(u,{key:0,description:"No Ollama models installed",class:"empty-state"},{image:f(()=>o[6]||(o[6]=[v("div",{class:"empty-icon"},"ðŸ“¦",-1)])),_:1})):h("",!0)]),k.value?(s(),x($,{key:0,type:"error",message:k.value,closable:"",onClose:o[1]||(o[1]=z=>k.value=""),class:"error-alert"},null,8,["message"])):h("",!0),y(Et,{modelValue:b.value,"onUpdate:modelValue":o[2]||(o[2]=z=>b.value=z),onModelsUpdated:g},null,8,["modelValue"])])}}}),es=W(Kt,[["__scopeId","data-v-9a88ecb1"]]);export{es as O};
